* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL517 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 06/08/94 08:12:06.
     8*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     9*                            VMOD=2.040.
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   2
* EL517.cbl
    14*DATE-COMPILED.
    15
    16*SECURITY.   *****************************************************
    17*            *                                                   *
    18*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25
    26*REMARKS.
    27*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    28*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    39* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    40*                                IS OPEN OR CNC DT < PD THRU
    41*                                ALSO ADD ALTERNATE KEY CLAUSE
    42* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    43* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    44* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    45* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    46* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    47* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    48* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    49* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    50* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    51* 061412  CR2011022800001  AJRA  NAPERSOFT
    52* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    53* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    54* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57******************************************************************
    58
    59 ENVIRONMENT DIVISION.
    60
    61 INPUT-OUTPUT SECTION.
    62
    63 FILE-CONTROL.
    64
    65     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    66
    67     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    68                             ORGANIZATION IS INDEXED
    69                             ACCESS IS DYNAMIC
    70                             RECORD KEY IS CF-CONTROL-PRIMARY
    71                             FILE STATUS IS ELCNTL-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   3
* EL517.cbl
    72
    73     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    74                             ORGANIZATION IS INDEXED
    75                             ACCESS IS SEQUENTIAL
    76                             RECORD KEY IS PB-CONTROL-PRIMARY
    77                             ALTERNATE RECORD KEY IS
    78                                 PB-CONTROL-BY-ACCOUNT
    79                             FILE STATUS IS ERPNDB-FILE-STATUS.
    80
    81     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    82                             ORGANIZATION IS INDEXED
    83                             ACCESS IS DYNAMIC
    84                             RECORD KEY IS RE-CONTROL-PRIMARY
    85                             FILE STATUS IS ERREIN-FILE-STATUS.
    86
    87     SELECT ELCERT
*                                  COPY ELCCERTS.
    88******************************************************************04/15/98
    89*                                                                *ELCCERTS
    90*                            ELCCERTS.                           *   LV002
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    92*                            VMOD=2.001                          *ELCCERTS
    93*                                                                *ELCCERTS
    94*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    95*                                                                *ELCCERTS
    96*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
    97******************************************************************ELCCERTS
    98                                                                  ELCCERTS
    99         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   100         ORGANIZATION IS INDEXED                                  ELCCERTS
   101         ACCESS IS DYNAMIC                                        ELCCERTS
   102         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   103         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   104                                                                  ELCCERTS
   105
   106     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   107                             ORGANIZATION IS INDEXED
   108                             ACCESS IS DYNAMIC
   109                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   110                             FILE STATUS IS ELMSTR-FILE-STATUS.
   111
   112     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   113                             ORGANIZATION IS INDEXED
   114                             ACCESS IS DYNAMIC
   115                             RECORD KEY IS CT-CONTROL-PRIMARY
   116                             FILE STATUS IS ERCTBL-FILE-STATUS.
   117
   118     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   119                             ORGANIZATION IS INDEXED
   120                             ACCESS IS DYNAMIC
   121                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   122                             FILE STATUS IS ERACCT-FILE-STATUS.
   123
   124     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   125                             ORGANIZATION IS INDEXED
   126                             ACCESS IS DYNAMIC
   127                             RECORD KEY IS EM-CONTROL-PRIMARY
   128                             FILE STATUS IS ELCERR-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   4
* EL517.cbl
   129
   130     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   131                             ORGANIZATION IS INDEXED
   132                             ACCESS IS DYNAMIC
   133                             RECORD KEY IS PM-CONTROL-PRIMARY
   134                             FILE STATUS IS ERPNDM-FILE-STATUS.
   135
   136     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   137                             ORGANIZATION IS INDEXED
   138                             ACCESS IS DYNAMIC
   139                             RECORD KEY IS MA-CONTROL-PRIMARY
   140                             FILE STATUS IS ERMAIL-FILE-STATUS.
   141
   142     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   143                             ORGANIZATION IS INDEXED
   144                             ACCESS IS DYNAMIC
   145                             RECORD KEY IS PL-CONTROL-PRIMARY
   146                             FILE STATUS IS ERPLAN-FILE-STATUS.
   147
   148     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   149                             ORGANIZATION IS INDEXED
   150                             ACCESS IS DYNAMIC
   151                             RECORD KEY IS FO-CONTROL-PRIMARY
   152                             FILE STATUS IS ERFORM-FILE-STATUS.
   153
   154     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   155
   156     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   157
   158     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   159                             ORGANIZATION IS INDEXED
   160                             ACCESS IS DYNAMIC
   161                             RECORD KEY IS RF-CONTROL-PRIMARY
   162                             FILE STATUS IS DTE-VSAM-FLAGS.
   163
   164     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   165                             ORGANIZATION IS INDEXED
   166                             ACCESS IS DYNAMIC
   167                             RECORD KEY IS ERRESS-PRIMARY-KEY
   168                             FILE STATUS IS ERRESS-FILE-STATUS.
   169
   170     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   171                             ORGANIZATION IS INDEXED
   172                             ACCESS IS DYNAMIC
   173                             RECORD KEY IS ERRESC-RECORD-KEY
   174                             FILE STATUS IS ERRESC-FILE-STATUS.
   175
   176     SELECT ERCOMP           ASSIGN TO             ERCOMP
   177                             ORGANIZATION IS INDEXED
   178                             ACCESS IS DYNAMIC
   179                             RECORD KEY IS CO-CONTROL-PRIMARY
   180                             FILE STATUS IS ERCOMP-FILE-STATUS.
   181
   182     SELECT ERLOFC           ASSIGN TO             ERLOFC
   183                             ORGANIZATION IS INDEXED
   184                             ACCESS IS DYNAMIC
   185                             RECORD KEY IS LO-CONTROL-PRIMARY
   186                             FILE STATUS IS ERLOFC-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   5
* EL517.cbl
   187
   188     SELECT ERBXRF           ASSIGN TO             ERBXRF
   189                             ORGANIZATION IS INDEXED
   190                             ACCESS IS DYNAMIC
   191                             RECORD KEY IS BK-CONTROL-PRIMARY
   192                             FILE STATUS IS ERBXRF-FILE-STATUS.
   193
   194     SELECT ERAGTC           ASSIGN TO             ERAGTC
   195                             ORGANIZATION IS INDEXED
   196                             ACCESS IS DYNAMIC
   197                             RECORD KEY IS AG-CONTROL-PRIMARY
   198                             FILE STATUS IS ERAGTC-FILE-STATUS.
   199
   200     SELECT ELCRTT           ASSIGN TO             ELCRTT
   201                             ORGANIZATION IS INDEXED
   202                             ACCESS IS DYNAMIC
   203                             RECORD KEY IS CS-CONTROL-PRIMARY
   204                             FILE STATUS IS ELCRTT-FILE-STATUS.
   205
   206     SELECT ERPDEF           ASSIGN TO ERPDEF
   207                             ACCESS IS DYNAMIC
   208                             ORGANIZATION IS INDEXED
   209                             FILE STATUS IS ERPDEF-FILE-STATUS
   210                             RECORD KEY IS PD-CONTROL-PRIMARY.
   211
   212     SELECT ELSTAT           ASSIGN TO ELSTAT
   213                             ACCESS IS DYNAMIC
   214                             ORGANIZATION IS INDEXED
   215                             FILE STATUS IS ELSTAT-FILE-STATUS
   216                             RECORD KEY IS SF-CONTROL-PRIMARY.
   217
   218     SELECT ELCRTO           ASSIGN TO ELCRTO
   219                             ACCESS IS DYNAMIC
   220                             ORGANIZATION IS INDEXED
   221                             FILE STATUS IS ELCRTO-FILE-STATUS
   222                             RECORD KEY IS OC-CONTROL-PRIMARY.
   223
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   6
* EL517.cbl
   225 DATA DIVISION.
   226
   227 FILE SECTION.
   228
   229 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   230******************************************************************04/15/98
   231*                                                                *ELCDTEFD
   232*                                                                *ELCDTEFD
   233*                            ELCDTEFD.                           *   LV002
   234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   235*                            VMOD=2.007                          *   CL**2
   236*                                                                *ELCDTEFD
   237******************************************************************ELCDTEFD
   238     BLOCK CONTAINS 0 RECORDS
   239     RECORDING MODE F.                                            ELCDTEFD
   240                                                                  ELCDTEFD
   241 01  DATE-DISK.                                                   ELCDTEFD
   242     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   243     12  FILLER                      PIC  X(14).                  ELCDTEFD
   244     12  DD-CR1                      PIC  9.                      ELCDTEFD
   245     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   246     12  DD-CR2                      PIC  9.                      ELCDTEFD
   247     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   248     12  FILLER                      PIC  X(20).                  ELCDTEFD
   249                                                                  ELCDTEFD
   250 01  DATE-DISK-R.                                                 ELCDTEFD
   251     12  FILLER                      PIC  X(4).                   ELCDTEFD
   252     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   253                                     PIC  X(32).                  ELCDTEFD
   254                                                                  ELCDTEFD
   255 01  DATE-DISK-T.                                                 ELCDTEFD
   256     12  FILLER                      PIC  X(4).                   ELCDTEFD
   257     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   258                                     PIC  X(48).                  ELCDTEFD
   259                                                                  ELCDTEFD
   260 01  DATE-DISK-M.                                                 ELCDTEFD
   261     12  FILLER                      PIC  X(4).                   ELCDTEFD
   262     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   263                                     PIC  X(48).                  ELCDTEFD
   264                                                                  ELCDTEFD
   265 01  DATE-DISK-P.                                                 ELCDTEFD
   266     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   267     12  DD-IDX                      PIC  99.                     ELCDTEFD
   268     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   269     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   270         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   271                                     PIC  X.                      ELCDTEFD
   272         16  FILLER                  PIC  X(46).                  ELCDTEFD
   273     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   274         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   275             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   276             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   277             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   278             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   279         16  FILLER                  PIC  X(16).                  ELCDTEFD
   280                                                                  ELCDTEFD
   281 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   282     12  FILLER                      PIC  X(4).                   ELCDTEFD
   283     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   284                                     PIC  X(4).                   ELCDTEFD
   285                                                                  ELCDTEFD
   286 01  DATE-DISK-C.                                                 ELCDTEFD
   287     12  FILLER                      PIC  X(7).                   ELCDTEFD
   288     12  DD-CARR1-SECPAY-SW          PIC  X.
   289     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   290     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   291     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   292     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   293     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   294     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   295     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   296     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   297     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   298     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   299     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   300     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   301     12  DD-CARR2-SECPAY-SW          PIC  X.
   302     12  FILLER                      PIC  X(7).                   ELCDTEFD
   303                                                                  ELCDTEFD
   304 01  DATE-DISK-OPT.                                               ELCDTEFD
   305     12  FILLER                      PIC  X(04).                  ELCDTEFD
   306     12  DD-TLR-DATA.                                             ELCDTEFD
   307         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   308                                     PIC  X(03).                  ELCDTEFD
   309     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   310         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   311                                     PIC  X(06).                  ELCDTEFD
   312     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   313         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   314                                     PIC  X(07).                  ELCDTEFD
   315         16  FILLER                  PIC  X(05).                  ELCDTEFD
   316     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   317                                     PIC  X(96).                  ELCDTEFD
   318******************************************************************ELCDTEFD
   319
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   8
* EL517.cbl
   321 FD  ELCNTL.
*  322                                 COPY ELCCNTL.
   323******************************************************************
   324*                                                                *
   325*                                                                *
   326*                            ELCCNTL.                            *
   327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   328*                            VMOD=2.059                          *
   329*                                                                *
   330*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   331*                                                                *
   332*   FILE TYPE = VSAM,KSDS                                        *
   333*   RECORD SIZE = 750  RECFORM = FIXED                           *
   334*                                                                *
   335*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   336*       ALTERNATE INDEX = NONE                                   *
   337*                                                                *
   338*   LOG = YES                                                    *
   339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   340******************************************************************
   341*                   C H A N G E   L O G
   342*
   343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   344*-----------------------------------------------------------------
   345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   346* EFFECTIVE    NUMBER
   347*-----------------------------------------------------------------
   348* 082503                   PEMA  ADD BENEFIT GROUP
   349* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   350* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   351* 092705    2005050300006  PEMA  ADD SPP LEASES
   352* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   353* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   354* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   355* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   356* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   357* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   358* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   359******************************************************************
   360*
   361 01  CONTROL-FILE.
   362     12  CF-RECORD-ID                       PIC XX.
   363         88  VALID-CF-ID                        VALUE 'CF'.
   364
   365     12  CF-CONTROL-PRIMARY.
   366         16  CF-COMPANY-ID                  PIC XXX.
   367         16  CF-RECORD-TYPE                 PIC X.
   368             88  CF-COMPANY-MASTER              VALUE '1'.
   369             88  CF-PROCESSOR-MASTER            VALUE '2'.
   370             88  CF-STATE-MASTER                VALUE '3'.
   371             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   372             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   373             88  CF-CARRIER-MASTER              VALUE '6'.
   374             88  CF-MORTALITY-MASTER            VALUE '7'.
   375             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   376             88  CF-TERMINAL-MASTER             VALUE '9'.
   377             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   378             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   9
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   379             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   380             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   381             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   382             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   383             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   384             88  CF-REMINDERS-MASTER            VALUE 'R'.
   385             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   386         16  CF-ACCESS-CD-GENL              PIC X(4).
   387         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   388             20  CF-PROCESSOR               PIC X(4).
   389         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   390             20  CF-STATE-CODE              PIC XX.
   391             20  FILLER                     PIC XX.
   392         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   393             20  FILLER                     PIC XX.
   394             20  CF-HI-BEN-IN-REC           PIC XX.
   395         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   396             20  FILLER                     PIC XXX.
   397             20  CF-CARRIER-CNTL            PIC X.
   398         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   399             20  FILLER                     PIC XX.
   400             20  CF-HI-TYPE-IN-REC          PIC 99.
   401         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   402             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   403                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   404             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   405             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   406         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   407             20  FILLER                     PIC X.
   408             20  CF-CUSTOM-REPORT-NO        PIC 999.
   409         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   410             20  FILLER                     PIC XX.
   411             20  CF-MORTGAGE-PLAN           PIC XX.
   412         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   413
   414     12  CF-LAST-MAINT-DT                   PIC XX.
   415     12  CF-LAST-MAINT-BY                   PIC X(4).
   416     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   417
   418     12  CF-RECORD-BODY                     PIC X(728).
   419
   420
   421****************************************************************
   422*             COMPANY MASTER RECORD                            *
   423****************************************************************
   424
   425     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   426         16  CF-COMPANY-ADDRESS.
   427             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   428             20  CF-CL-IN-CARE-OF           PIC X(30).
   429             20  CF-CL-ADDR-LINE-1          PIC X(30).
   430             20  CF-CL-ADDR-LINE-2          PIC X(30).
   431             20  CF-CL-CITY-STATE           PIC X(30).
   432             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   433             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   434         16  CF-COMPANY-CD                  PIC X.
   435         16  CF-COMPANY-PASSWORD            PIC X(8).
   436         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  10
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   437             88  ALL-SECURITY                   VALUE '1'.
   438             88  COMPANY-VERIFY                 VALUE '2'.
   439             88  PROCESSOR-VERIFY               VALUE '3'.
   440             88  NO-SECURITY                    VALUE '4'.
   441             88  ALL-BUT-TERM                   VALUE '5'.
   442         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   443             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   444         16  CF-LGX-INTERFACE-CNTL          PIC X.
   445             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   446         16  CF-INFORCE-LOCATION            PIC X.
   447             88  CERTS-ARE-ONLINE               VALUE '1'.
   448             88  CERTS-ARE-OFFLINE              VALUE '2'.
   449             88  NO-CERTS-AVAILABLE             VALUE '3'.
   450         16  CF-LOWER-CASE-LETTERS          PIC X.
   451         16  CF-CERT-ACCESS-CONTROL         PIC X.
   452             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   453             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   454             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   455             88  CF-ACCNT-CNTL                  VALUE '3'.
   456             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   457
   458         16  CF-FORMS-PRINTER-ID            PIC X(4).
   459         16  CF-CHECK-PRINTER-ID            PIC X(4).
   460
   461         16  CF-LGX-CREDIT-USER             PIC X.
   462             88  CO-IS-NOT-USER                 VALUE 'N'.
   463             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   464
   465         16 CF-CREDIT-CALC-CODES.
   466             20  CF-CR-REM-TERM-CALC PIC X.
   467               88  CR-EARN-AFTER-15TH           VALUE '1'.
   468               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   469               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   470               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   471               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   472               88  CR-EARN-AFTER-14TH           VALUE '6'.
   473               88  CR-EARN-AFTER-16TH           VALUE '7'.
   474             20  CF-CR-R78-METHOD           PIC X.
   475               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   476               88  DONT-USE-PLUS-ONE            VALUE '1'.
   477
   478         16  CF-CLAIM-CONTROL-COUNTS.
   479             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   480                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   481
   482             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   483                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   484
   485             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   486                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   487
   488             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   489                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   490
   491         16  CF-CURRENT-MONTH-END           PIC XX.
   492
   493         16  CF-CO-CALC-QUOTE-TOLERANCE.
   494             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  11
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   495             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   496             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   497             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   498                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   499                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   500             20  CF-CO-PREM-REJECT-SW       PIC X.
   501                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   502                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   503             20  CF-CO-REF-REJECT-SW        PIC X.
   504                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   505                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   506
   507         16  CF-CO-REPORTING-DT             PIC XX.
   508         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   509         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   510           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   511           88  CF-CO-MONTH-END                  VALUE '1'.
   512
   513         16  CF-LGX-CLAIM-USER              PIC X.
   514             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   515             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   516
   517         16  CF-CREDIT-EDIT-CONTROLS.
   518             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   519             20  CF-MIN-AGE                 PIC 99.
   520             20  CF-DEFAULT-AGE             PIC 99.
   521             20  CF-MIN-TERM                PIC S999      COMP-3.
   522             20  CF-MAX-TERM                PIC S999      COMP-3.
   523             20  CF-DEFAULT-SEX             PIC X.
   524             20  CF-JOINT-AGE-INPUT         PIC X.
   525                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   526             20  CF-BIRTH-DATE-INPUT        PIC X.
   527                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   528             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   529                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   530                 88  CF-ZERO-CARRIER            VALUE '1'.
   531                 88  CF-ZERO-GROUPING           VALUE '2'.
   532                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   533             20  CF-EDIT-SW                 PIC X.
   534                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   535             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   536             20  CF-CR-PR-METHOD            PIC X.
   537               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   538               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   539             20  FILLER                     PIC X.
   540
   541         16  CF-CREDIT-MISC-CONTROLS.
   542             20  CF-REIN-TABLE-SW           PIC X.
   543                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   544             20  CF-COMP-TABLE-SW           PIC X.
   545                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   546             20  CF-EXPERIENCE-RETENTION-AGE
   547                                            PIC S9        COMP-3.
   548             20  CF-CONVERSION-DT           PIC XX.
   549             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   550             20  CF-RUN-FREQUENCY-SW        PIC X.
   551                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   552                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  12
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   553
   554             20  CF-CR-CHECK-NO-CONTROL.
   555                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   556                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   557                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   558                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   559                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   560                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   561
   562                 24  CF-CR-CHECK-COUNT       REDEFINES
   563                     CF-CR-CHECK-COUNTER      PIC X(4).
   564
   565                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   566                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   567
   568                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   569                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   570                 24  CF-MAIL-PROCESSING       PIC X.
   571                     88  MAIL-PROCESSING          VALUE 'Y'.
   572
   573         16  CF-MISC-SYSTEM-CONTROL.
   574             20  CF-SYSTEM-C                 PIC X.
   575                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   576             20  CF-SYSTEM-D                 PIC X.
   577                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   578             20  CF-SOC-SEC-NO-SW            PIC X.
   579                 88  SOC-SEC-NO-USED             VALUE '1'.
   580             20  CF-MEMBER-NO-SW             PIC X.
   581                 88  MEMBER-NO-USED              VALUE '1'.
   582             20  CF-TAX-ID-NUMBER            PIC X(11).
   583             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   584             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   585                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   586                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   587                 88  CF-ALL-APPROVED             VALUE 'Y'.
   588                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   589             20  CF-SYSTEM-E                 PIC X.
   590                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   591
   592         16  CF-LGX-LIFE-USER               PIC X.
   593             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   594             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   595
   596         16  CF-CR-MONTH-END-DT             PIC XX.
   597
   598         16  CF-FILE-MAINT-DATES.
   599             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   600                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   601             20  CF-LAST-BATCH       REDEFINES
   602                 CF-LAST-BATCH-NO               PIC X(4).
   603             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   604             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   605             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   606             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   607             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   608             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   609             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   610             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  13
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   611             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   612             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   613
   614         16  CF-NEXT-COMPANY-ID             PIC XXX.
   615         16  FILLER                         PIC X.
   616
   617         16  CF-ALT-MORT-CODE               PIC X(4).
   618         16  CF-MEMBER-CAPTION              PIC X(10).
   619
   620         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   621             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   622             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   623             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   624             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   625             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   626
   627         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   628
   629         16  CF-LIFE-OVERRIDE-L1            PIC X.
   630         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   631         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   632         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   633
   634         16  CF-AH-OVERRIDE-L1              PIC X.
   635         16  CF-AH-OVERRIDE-L2              PIC XX.
   636         16  CF-AH-OVERRIDE-L6              PIC X(6).
   637         16  CF-AH-OVERRIDE-L12             PIC X(12).
   638
   639         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   640         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   641
   642         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   643         16  CF-AR-LAST-EL860-DT            PIC XX.
   644         16  CF-MP-MONTH-END-DT             PIC XX.
   645
   646         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   647         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   648             88  CF-CLAIM-PAID-TO               VALUE '1'.
   649
   650         16  CF-AR-MONTH-END-DT             PIC XX.
   651
   652         16  CF-CRDTCRD-USER                PIC X.
   653             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   654             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   655
   656         16  CF-CC-MONTH-END-DT             PIC XX.
   657
   658         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   659
   660         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   661             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   662             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   663             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   664         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   665         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   666         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   667         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   668             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  14
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   669             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   670         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   671         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   672         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   673             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   674         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   675
   676         16  CF-CL-ZIP-CODE.
   677             20  CF-CL-ZIP-PRIME.
   678                 24  CF-CL-ZIP-1ST          PIC X.
   679                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   680                 24  FILLER                 PIC X(4).
   681             20  CF-CL-ZIP-PLUS4            PIC X(4).
   682         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   683             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   684             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   685             20  FILLER                     PIC XXX.
   686
   687         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   688         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   689         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   690         16  CF-CO-OPTION-START-DATE        PIC XX.
   691         16  CF-REM-TRM-CALC-OPTION         PIC X.
   692           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   693                                                      '3' '4'.
   694           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   695           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   696           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   697           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   698           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   699           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   700
   701         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   702
   703         16  CF-PAYMENT-APPROVAL-LEVELS.
   704             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   705             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   706             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   707             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   708             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   709             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   710
   711         16  CF-END-USER-REPORTING-USER     PIC X.
   712             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   713             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   714
   715         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   716             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   717             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   718
   719         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   720
   721         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   722         16  FILLER                         PIC X.
   723
   724         16  CF-CREDIT-ARCHIVE-CNTL.
   725             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   726             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  15
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   727             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   728
   729         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   730
   731         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   732             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   733             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   734
   735         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   736             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   737             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   738
   739         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   740
   741         16  CF-CO-ACH-ID-CODE              PIC  X.
   742             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   743             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   744             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   745         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   746         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   747         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   748         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   749         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   750         16  CF-CO-ACH-RECV-NO              PIC X(08).
   751         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   752         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   753         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   754                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   755         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   756                 CF-CO-ACH-TRACE-NO         PIC X(4).
   757
   758         16  CF-CO-OVER-SHORT.
   759             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   760             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   761
   762*         16  FILLER                         PIC X(102).
   763         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   764             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   765             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   766
   767         16  CF-AH-APPROVAL-DAYS.
   768             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   769             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   770             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   771             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   772
   773         16  FILLER                         PIC X(82).
   774****************************************************************
   775*             PROCESSOR/USER RECORD                            *
   776****************************************************************
   777
   778     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   779         16  CF-PROCESSOR-NAME              PIC X(30).
   780         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   781         16  CF-PROCESSOR-TITLE             PIC X(26).
   782         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   783                 88  MESSAGE-YES                VALUE 'Y'.
   784                 88  MESSAGE-NO                 VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  16
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   785
   786*****************************************************
   787****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   788****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   789****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   790****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   791*****************************************************
   792
   793         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   794             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   795             20  CF-APPLICATION-FORCE       PIC X.
   796             20  CF-INDIVIDUAL-APP.
   797                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   798                     28  CF-BROWSE-APP      PIC X.
   799                     28  CF-UPDATE-APP      PIC X.
   800
   801         16  CF-CURRENT-TERM-ON             PIC X(4).
   802         16  CF-PROCESSOR-LIMITS-CLAIMS.
   803             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   804             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   805             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   806             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   807             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   808             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   809             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   810         16  CF-PROCESSOR-CARRIER           PIC X.
   811             88  NO-CARRIER-SECURITY            VALUE ' '.
   812         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   813             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   814         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   815             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   816         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   817             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   818
   819         16  CF-PROC-SYS-ACCESS-SW.
   820             20  CF-PROC-CREDIT-CLAIMS-SW.
   821                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   822                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   823                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   824                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   825             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   826                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   827                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   828             20  CF-PROC-LIFE-GNRLDGR-SW.
   829                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   830                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   831                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   832                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   833             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   834                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   835                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   836         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   837             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   838             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   839         16  CF-PROCESSOR-PRINTER               PIC X(4).
   840
   841         16  CF-APPROVAL-LEVEL                  PIC X.
   842             88  APPROVAL-LEVEL-1                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  17
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   843             88  APPROVAL-LEVEL-2                   VALUE '2'.
   844             88  APPROVAL-LEVEL-3                   VALUE '3'.
   845             88  APPROVAL-LEVEL-4                   VALUE '4'.
   846
   847         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   848
   849         16  CF-LANGUAGE-TYPE                   PIC X.
   850             88  CF-LANG-IS-ENG                     VALUE 'E'.
   851             88  CF-LANG-IS-FR                      VALUE 'F'.
   852
   853         16  CF-CSR-IND                         PIC X.
   854         16  FILLER                             PIC X(239).
   855
   856****************************************************************
   857*             PROCESSOR/REMINDERS RECORD                       *
   858****************************************************************
   859
   860     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   861         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   862             20  CF-START-REMIND-DT         PIC XX.
   863             20  CF-END-REMIND-DT           PIC XX.
   864             20  CF-REMINDER-TEXT           PIC X(50).
   865         16  FILLER                         PIC X(296).
   866
   867
   868****************************************************************
   869*             STATE MASTER RECORD                              *
   870****************************************************************
   871
   872     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   873         16  CF-STATE-ABBREVIATION          PIC XX.
   874         16  CF-STATE-NAME                  PIC X(25).
   875         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   876         16  CF-ST-CALC-QUOTE-TOLERANCE.
   877             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   878             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   879             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   880             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   881                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   882                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   883             20  CF-ST-PREM-REJECT-SW       PIC X.
   884                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   885                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   886             20  CF-ST-REF-REJECT-SW        PIC X.
   887                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   888                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   889         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   890         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   891         16  CF-ST-REFUND-RULES.
   892             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   893             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   894             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   895         16  CF-ST-FST-PMT-EXTENSION.
   896             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   897             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   898                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   899                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   900                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  18
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   901                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   902         16  CF-ST-STATE-CALL.
   903             20  CF-ST-CALL-UNEARNED        PIC X.
   904             20  CF-ST-CALL-RPT-CNTL        PIC X.
   905             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   906         16  CF-REPLACEMENT-LAW-SW          PIC X.
   907             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   908             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   909         16  CF-REPLACEMENT-LETTER          PIC X(4).
   910         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   911         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   912         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   913         16  CF-ST-SPLIT-PAYMENT            PIC X.
   914         16  FILLER                         PIC X.
   915         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   916             20  CF-ST-BENEFIT-CD           PIC XX.
   917             20  CF-ST-BENEFIT-KIND         PIC X.
   918                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   919                 88  CF-ST-AH-KIND              VALUE 'A'.
   920             20  CF-ST-REM-TERM-CALC        PIC X.
   921                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   922                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   923                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   924                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   925                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   926                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   927                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   928                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   929
   930             20  CF-ST-REFUND-CALC          PIC X.
   931                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   932                 88  ST-REFD-BY-R78             VALUE '1'.
   933                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   934                 88  ST-REFD-AS-CALIF           VALUE '3'.
   935                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   936                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   937                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   938                 88  ST-REFD-UTAH               VALUE '7'.
   939                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   940                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   941                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   942
   943             20  CF-ST-EARNING-CALC         PIC X.
   944                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   945                 88  ST-EARN-BY-R78             VALUE '1'.
   946                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   947                 88  ST-EARN-AS-CALIF           VALUE '3'.
   948                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   949                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   950                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   951                 88  ST-EARN-MEAN               VALUE '8'.
   952                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   953
   954             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   955                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   956                 88  ST-OVRD-BY-R78             VALUE '1'.
   957                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   958                 88  ST-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  19
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   959                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   960                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   961                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   962                 88  ST-OVRD-MEAN               VALUE '8'.
   963                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   964             20  FILLER                     PIC X.
   965
   966         16  CF-ST-COMMISSION-CAPS.
   967             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   968             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   969             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   970             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   971         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   972                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   973
   974         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   975
   976         16  CF-ST-STATUTORY-INTEREST.
   977             20  CF-ST-STAT-DATE-FROM       PIC X.
   978                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   979                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   980             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   981             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   982             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   983             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   984             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   985
   986         16  CF-ST-OVER-SHORT.
   987             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   988             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
   989
   990         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
   991
   992         16  CF-ST-RT-CALC                  PIC X.
   993
   994         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
   995         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
   996         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
   997         16  CF-ST-RF-LR-CALC               PIC X.
   998         16  CF-ST-RF-LL-CALC               PIC X.
   999         16  CF-ST-RF-LN-CALC               PIC X.
  1000         16  CF-ST-RF-AH-CALC               PIC X.
  1001         16  CF-ST-RF-CP-CALC               PIC X.
  1002*        16  FILLER                         PIC X(206).
  1003*CIDMOD         16  FILLER                         PIC X(192).
  1004         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1005             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1006         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1007         16  CF-ST-VFY-2ND-BENE             PIC X.
  1008         16  CF-ST-CAUSAL-STATE             PIC X.
  1009         16  FILLER                         PIC X(185).
  1010
  1011****************************************************************
  1012*             BENEFIT MASTER RECORD                            *
  1013****************************************************************
  1014
  1015     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1016         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  20
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1017             20  CF-BENEFIT-CODE            PIC XX.
  1018             20  CF-BENEFIT-NUMERIC  REDEFINES
  1019                 CF-BENEFIT-CODE            PIC XX.
  1020             20  CF-BENEFIT-ALPHA           PIC XXX.
  1021             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1022             20  CF-BENEFIT-COMMENT         PIC X(10).
  1023
  1024             20  CF-LF-COVERAGE-TYPE        PIC X.
  1025                 88  CF-REDUCING                VALUE 'R'.
  1026                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1027
  1028             20  CF-SPECIAL-CALC-CD         PIC X.
  1029                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1030                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1031                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1032                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1033                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1034                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1035                 88  CF-FARM-PLAN               VALUE 'F'.
  1036                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1037                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1038                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1039                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1040                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1041                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1042                 88  CF-PRUDENTIAL              VALUE 'P'.
  1043                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1044                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1045                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1046                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1047                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1048                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1049
  1050             20  CF-JOINT-INDICATOR         PIC X.
  1051                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1052
  1053*            20  FILLER                     PIC X(12).
  1054             20  FILLER                     PIC X(11).
  1055             20  CF-BENEFIT-CATEGORY        PIC X.
  1056             20  CF-LOAN-TYPE               PIC X(8).
  1057
  1058             20  CF-CO-REM-TERM-CALC        PIC X.
  1059                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1060                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1061                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1062                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1063                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1064
  1065             20  CF-CO-EARNINGS-CALC        PIC X.
  1066                 88  CO-EARN-BY-R78             VALUE '1'.
  1067                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1068                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1069                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1070                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1071                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1072                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1073                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1074
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  21
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1075             20  CF-CO-REFUND-CALC          PIC X.
  1076                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1077                 88  CO-REFD-BY-R78             VALUE '1'.
  1078                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1079                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1080                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1081                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1082                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1083                 88  CO-REFD-MEAN               VALUE '8'.
  1084                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1085                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1086                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1087
  1088             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1089                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1090                 88  CO-OVRD-BY-R78             VALUE '1'.
  1091                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1092                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1093                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1094                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1095                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1096                 88  CO-OVRD-MEAN               VALUE '8'.
  1097                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1098
  1099             20  CF-CO-BEN-I-G-CD           PIC X.
  1100                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1101                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1102                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1103
  1104         16  FILLER                         PIC X(304).
  1105
  1106
  1107****************************************************************
  1108*             CARRIER MASTER RECORD                            *
  1109****************************************************************
  1110
  1111     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1112         16  CF-ADDRESS-DATA.
  1113             20  CF-MAIL-TO-NAME            PIC X(30).
  1114             20  CF-IN-CARE-OF              PIC X(30).
  1115             20  CF-ADDRESS-LINE-1          PIC X(30).
  1116             20  CF-ADDRESS-LINE-2          PIC X(30).
  1117             20  CF-CITY-STATE              PIC X(30).
  1118             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1119             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1120
  1121         16  CF-CLAIM-NO-CONTROL.
  1122             20  CF-CLAIM-NO-METHOD         PIC X.
  1123                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1124                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1125                 88  CLAIM-NO-SEQ               VALUE '3'.
  1126                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1127             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1128                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1129                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1130                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1131
  1132         16  CF-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  22
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1133             20  CF-CHECK-NO-METHOD         PIC X.
  1134                 88  CHECK-NO-MANUAL            VALUE '1'.
  1135                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1136                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1137                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1138             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1139                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1140
  1141         16  CF-DOMICILE-STATE              PIC XX.
  1142
  1143         16  CF-EXPENSE-CONTROLS.
  1144             20  CF-EXPENSE-METHOD          PIC X.
  1145                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1146                 88  DOLLARS-PER-PMT            VALUE '2'.
  1147                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1148                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1149             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1150             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1151
  1152         16  CF-CORRESPONDENCE-CONTROL.
  1153             20  CF-LETTER-RESEND-OPT       PIC X.
  1154                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1155                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1156             20  FILLER                     PIC X(4).
  1157
  1158         16  CF-RESERVE-CONTROLS.
  1159             20  CF-MANUAL-SW               PIC X.
  1160                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1161             20  CF-FUTURE-SW               PIC X.
  1162                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1163             20  CF-PTC-SW                  PIC X.
  1164                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1165             20  CF-IBNR-SW                 PIC X.
  1166                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1167             20  CF-PTC-LF-SW               PIC X.
  1168                 88  CF-LF-PTC-USED             VALUE '1'.
  1169             20  CF-CDT-ACCESS-METHOD       PIC X.
  1170                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1171                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1172                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1173             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1174
  1175         16  CF-CLAIM-CALC-METHOD           PIC X.
  1176             88  360-PLUS-MONTHS                VALUE '1'.
  1177             88  365-PLUS-MONTHS                VALUE '2'.
  1178             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1179             88  360-DAILY                      VALUE '4'.
  1180             88  365-DAILY                      VALUE '5'.
  1181
  1182         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1183         16  FILLER                         PIC X(11).
  1184
  1185         16  CF-LIMIT-AMOUNTS.
  1186             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1187             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1188             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1189             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1190             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  23
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1191             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1192             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1193             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1194             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1195             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1196
  1197         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1198         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1199         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1200
  1201         16  CF-ZIP-CODE.
  1202             20  CF-ZIP-PRIME.
  1203                 24  CF-ZIP-1ST             PIC X.
  1204                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1205                 24  FILLER                 PIC X(4).
  1206             20  CF-ZIP-PLUS4               PIC X(4).
  1207         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1208             20  CF-CAN-POSTAL-1            PIC XXX.
  1209             20  CF-CAN-POSTAL-2            PIC XXX.
  1210             20  FILLER                     PIC XXX.
  1211
  1212         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1213         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1214         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1215
  1216         16  CF-RATING-SWITCH               PIC X.
  1217             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1218             88  CF-NO-RATING                   VALUE 'N'.
  1219
  1220         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1221
  1222         16  CF-CARRIER-OVER-SHORT.
  1223             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1224             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1225
  1226         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1227         16  CF-SECPAY-SWITCH               PIC X.
  1228             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1229             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1230         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1231         16  FILLER                         PIC X(448).
  1232*        16  FILLER                         PIC X(452).
  1233
  1234
  1235****************************************************************
  1236*             MORTALITY MASTER RECORD                          *
  1237****************************************************************
  1238
  1239     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1240         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1241                                INDEXED BY CF-MORT-NDX.
  1242             20  CF-MORT-TABLE              PIC X(5).
  1243             20  CF-MORT-TABLE-TYPE         PIC X.
  1244                 88  CF-MORT-JOINT              VALUE 'J'.
  1245                 88  CF-MORT-SINGLE             VALUE 'S'.
  1246                 88  CF-MORT-COMBINED           VALUE 'C'.
  1247                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1248                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  24
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1249             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1250             20  CF-MORT-AGE-METHOD         PIC XX.
  1251                 88  CF-AGE-LAST                VALUE 'AL'.
  1252                 88  CF-AGE-NEAR                VALUE 'AN'.
  1253             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1254             20  CF-MORT-ADJUSTMENT-DIRECTION
  1255                                            PIC X.
  1256                 88  CF-MINUS                   VALUE '-'.
  1257                 88  CF-PLUS                    VALUE '+'.
  1258             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1259             20  CF-MORT-JOINT-CODE         PIC X.
  1260                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1261             20  CF-MORT-PC-Q               PIC X.
  1262                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1263             20  CF-MORT-TABLE-CODE         PIC X(4).
  1264             20  CF-MORT-COMMENTS           PIC X(15).
  1265             20  FILLER                     PIC X(14).
  1266
  1267         16  FILLER                         PIC X(251).
  1268
  1269
  1270****************************************************************
  1271*             BUSSINESS TYPE MASTER RECORD                     *
  1272****************************************************************
  1273
  1274     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1275* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1276* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1277* AND RECORD 05 IS TYPES 81-99
  1278         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1279             20  CF-BUSINESS-TITLE          PIC  X(19).
  1280             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1281                                            PIC S9V9(4) COMP-3.
  1282             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1283             20  FILLER                     PIC  X.
  1284         16  FILLER                         PIC  X(248).
  1285
  1286
  1287****************************************************************
  1288*             TERMINAL MASTER RECORD                           *
  1289****************************************************************
  1290
  1291     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1292
  1293         16  CF-COMPANY-TERMINALS.
  1294             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1295                                  PIC X(4).
  1296         16  FILLER               PIC X(248).
  1297
  1298
  1299****************************************************************
  1300*             LIFE EDIT MASTER RECORD                          *
  1301****************************************************************
  1302
  1303     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1304         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1305             20  CF-LIFE-CODE-IN            PIC XX.
  1306             20  CF-LIFE-CODE-OUT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  25
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1307         16  FILLER                         PIC X(248).
  1308
  1309
  1310****************************************************************
  1311*             AH EDIT MASTER RECORD                            *
  1312****************************************************************
  1313
  1314     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1315         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1316             20  CF-AH-CODE-IN              PIC XXX.
  1317             20  CF-AH-CODE-OUT             PIC XX.
  1318         16  FILLER                         PIC X(248).
  1319
  1320
  1321****************************************************************
  1322*             CREDIBILITY TABLES                               *
  1323****************************************************************
  1324
  1325     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1326         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1327                             INDEXED BY CF-CRDB-NDX.
  1328             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1329             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1330             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1331         16  FILLER                         PIC  X(332).
  1332
  1333
  1334****************************************************************
  1335*             REPORT CUSTOMIZATION RECORD                      *
  1336****************************************************************
  1337
  1338     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1339         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1340             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1341             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1342             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1343**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1344****       A T-TRANSFER.                                   ****
  1345             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1346
  1347         16  FILLER                         PIC XX.
  1348
  1349         16  CF-CARRIER-CNTL-OPT.
  1350             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1351                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1352                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1353             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1354                                            PIC X.
  1355         16  CF-GROUP-CNTL-OPT.
  1356             20  CF-GROUP-OPT-SEQ           PIC 9.
  1357                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1358                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1359             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1360                                            PIC X(6).
  1361         16  CF-STATE-CNTL-OPT.
  1362             20  CF-STATE-OPT-SEQ           PIC 9.
  1363                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1364                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  26
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1365             20  CF-STATE-SELECT OCCURS 3 TIMES
  1366                                            PIC XX.
  1367         16  CF-ACCOUNT-CNTL-OPT.
  1368             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1369                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1370                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1371             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1372                                            PIC X(10).
  1373         16  CF-BUS-TYP-CNTL-OPT.
  1374             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1375                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1376                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1377             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1378                                            PIC XX.
  1379         16  CF-LF-TYP-CNTL-OPT.
  1380             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1381                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1382                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1383             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1384                                            PIC XX.
  1385         16  CF-AH-TYP-CNTL-OPT.
  1386             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1387                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1388                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1389             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1390                                            PIC XX.
  1391         16  CF-REPTCD1-CNTL-OPT.
  1392             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1393                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1394                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1395             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1396                                            PIC X(10).
  1397         16  CF-REPTCD2-CNTL-OPT.
  1398             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1399                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1400                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1401             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1402                                            PIC X(10).
  1403         16  CF-USER1-CNTL-OPT.
  1404             20  CF-USER1-OPT-SEQ           PIC 9.
  1405                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1406                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1407             20  CF-USER1-SELECT OCCURS 3 TIMES
  1408                                            PIC X(10).
  1409         16  CF-USER2-CNTL-OPT.
  1410             20  CF-USER2-OPT-SEQ           PIC 9.
  1411                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1412                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1413             20  CF-USER2-SELECT OCCURS 3 TIMES
  1414                                            PIC X(10).
  1415         16  CF-USER3-CNTL-OPT.
  1416             20  CF-USER3-OPT-SEQ           PIC 9.
  1417                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1418                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1419             20  CF-USER3-SELECT OCCURS 3 TIMES
  1420                                            PIC X(10).
  1421         16  CF-USER4-CNTL-OPT.
  1422             20  CF-USER4-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  27
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1423                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1424                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1425             20  CF-USER4-SELECT OCCURS 3 TIMES
  1426                                            PIC X(10).
  1427         16  CF-USER5-CNTL-OPT.
  1428             20  CF-USER5-OPT-SEQ           PIC 9.
  1429                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1430                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1431             20  CF-USER5-SELECT OCCURS 3 TIMES
  1432                                            PIC X(10).
  1433         16  CF-REINS-CNTL-OPT.
  1434             20  CF-REINS-OPT-SEQ           PIC 9.
  1435                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1436                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1437             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1438                 24  CF-REINS-PRIME         PIC XXX.
  1439                 24  CF-REINS-SUB           PIC XXX.
  1440
  1441         16  CF-AGENT-CNTL-OPT.
  1442             20  CF-AGENT-OPT-SEQ           PIC 9.
  1443                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1444                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1445             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1446                                            PIC X(10).
  1447
  1448         16  FILLER                         PIC X(43).
  1449
  1450         16  CF-LOSS-RATIO-SELECT.
  1451             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1452             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1453         16  CF-ENTRY-DATE-SELECT.
  1454             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1455             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1456         16  CF-EFFECTIVE-DATE-SELECT.
  1457             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1458             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1459
  1460         16  CF-EXCEPTION-LIST-IND          PIC X.
  1461             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1462
  1463         16  FILLER                         PIC X(318).
  1464
  1465****************************************************************
  1466*                  EXCEPTION REPORTING RECORD                  *
  1467****************************************************************
  1468
  1469     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1470         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1471             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1472
  1473         16  CF-COMBINED-LIFE-AH-OPT.
  1474             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1475             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1476             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1477             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1478
  1479         16  CF-LIFE-OPT.
  1480             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  28
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1481             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1482             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1483             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1484             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1485             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1486             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1487             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1488             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1489             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1490
  1491         16  CF-AH-OPT.
  1492             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1493             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1494             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1495             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1496             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1497             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1498             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1499             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1500             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1501             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1502
  1503         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1504             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1505             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1506             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1507
  1508         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1509
  1510         16  FILLER                         PIC X(673).
  1511
  1512
  1513****************************************************************
  1514*             MORTGAGE SYSTEM PLAN RECORD                      *
  1515****************************************************************
  1516
  1517     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1518         16  CF-PLAN-TYPE                   PIC X.
  1519             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1520             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1521             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1522         16  CF-PLAN-ABBREV                 PIC XXX.
  1523         16  CF-PLAN-DESCRIPT               PIC X(10).
  1524         16  CF-PLAN-NOTES                  PIC X(20).
  1525         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1526         16  CF-PLAN-UNDERWRITING.
  1527             20  CF-PLAN-TERM-DATA.
  1528                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1529                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1530             20  CF-PLAN-AGE-DATA.
  1531                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1532                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1533                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1534             20  CF-PLAN-BENEFIT-DATA.
  1535                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1536                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1537                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1538                                            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  29
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1539         16  CF-PLAN-POLICY-FORMS.
  1540             20  CF-POLICY-FORM             PIC X(12).
  1541             20  CF-MASTER-APPLICATION      PIC X(12).
  1542             20  CF-MASTER-POLICY           PIC X(12).
  1543         16  CF-PLAN-RATING.
  1544             20  CF-RATE-CODE               PIC X(5).
  1545             20  CF-SEX-RATING              PIC X.
  1546                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1547                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1548             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1549             20  CF-SUB-STD-TYPE            PIC X.
  1550                 88  CF-PCT-OF-PREM            VALUE '1'.
  1551                 88  CF-PCT-OF-BENE            VALUE '2'.
  1552         16  CF-PLAN-PREM-TOLERANCES.
  1553             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1554             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1555         16  CF-PLAN-PYMT-TOLERANCES.
  1556             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1557             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1558         16  CF-PLAN-MISC-DATA.
  1559             20  FILLER                     PIC X.
  1560             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1561             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1562         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1563         16  CF-PLAN-IND-GRP                PIC X.
  1564             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1565                                                     '1'.
  1566             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1567                                                     '2'.
  1568         16  CF-MIB-SEARCH-SW               PIC X.
  1569             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1570             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1571             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1572             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1573         16  CF-ALPHA-SEARCH-SW             PIC X.
  1574             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1575             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1576             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1577             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1578             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1579             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1580             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1581             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1582             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1583             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1584                                                     'A' 'B' 'C'
  1585                                                     'X' 'Y' 'Z'.
  1586         16  CF-EFF-DT-RULE-SW              PIC X.
  1587             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1588             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1589             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1590             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1591             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1592         16  FILLER                         PIC X(4).
  1593         16  CF-HEALTH-QUESTIONS            PIC X.
  1594             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1595         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1596         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  30
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1597         16  CF-PLAN-SNGL-JNT               PIC X.
  1598             88  CF-COMBINED-PLAN              VALUE 'C'.
  1599             88  CF-JNT-PLAN                   VALUE 'J'.
  1600             88  CF-SNGL-PLAN                  VALUE 'S'.
  1601         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1602         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1603         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1604         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1605         16  CF-RERATE-CNTL                 PIC  X.
  1606             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1607             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1608             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1609             88  CF-AUTO-RECALC                 VALUE '4'.
  1610         16  CF-BENEFIT-TYPE                PIC  X.
  1611             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1612             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1613         16  CF-POLICY-FEE                  PIC S999V99
  1614                                                    COMP-3.
  1615         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1616         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1617         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1618         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1619         16  FILLER                         PIC  X(32).
  1620         16  CF-TERMINATION-FORM            PIC  X(04).
  1621         16  FILLER                         PIC  X(08).
  1622         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1623                                                       COMP-3.
  1624         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1625         16  CF-ISSUE-LETTER                PIC  X(4).
  1626         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1627         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1628             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1629             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1630         16  CF-MP-REFUND-CALC              PIC X.
  1631             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1632             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1633             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1634             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1635             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1636             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1637             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1638             88  CF-MP-REFD-MEAN                VALUE '8'.
  1639         16  CF-ALT-RATE-CODE               PIC  X(5).
  1640
  1641
  1642         16  FILLER                         PIC X(498).
  1643****************************************************************
  1644*             MORTGAGE COMPANY MASTER RECORD                   *
  1645****************************************************************
  1646
  1647     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1648         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1649         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1650             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1651             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1652             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1653             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1654             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  31
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1655
  1656         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1657         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1658         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1659         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1660         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1661
  1662         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1663             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1664         16  CF-MP-RECON-USE-IND            PIC X(1).
  1665             88  CF-MP-USE-RECON             VALUE 'Y'.
  1666         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1667             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1668         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1669             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1670             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1671         16  FILLER                         PIC X(1).
  1672         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1673             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1674         16  CF-MORTG-MIB-VERSION           PIC X.
  1675             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1676             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1677             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1678         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1679             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1680                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1681             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1682                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1683             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1684                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1685             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1686                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1687             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1688                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1689             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1690                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1691         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1692         16  FILLER                         PIC X(7).
  1693         16  CF-MORTG-DESTINATION-SYMBOL.
  1694             20  CF-MORTG-MIB-COMM          PIC X(5).
  1695             20  CF-MORTG-MIB-TERM          PIC X(5).
  1696         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1697             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1698         16  FILLER                         PIC X(03).
  1699         16  CF-MP-CHECK-NO-CONTROL.
  1700             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1701                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1702                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1703                                                ' ' LOW-VALUES.
  1704                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1705                                               VALUE '3'.
  1706         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1707         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1708         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1709             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1710                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1711             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1712                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  32
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1713             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1714                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1715             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1716                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1717             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1718                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1719             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1720                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1721         16  CF-MORTG-BILLING-AREA.
  1722             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1723                                            PIC X.
  1724         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1725         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1726         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1727         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1728             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1729             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1730         16  FILLER                         PIC X.
  1731         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1732             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1733             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1734         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1735         16  FILLER                         PIC X(8).
  1736         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1737         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1738         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1739         16  CF-ACH-COMPANY-ID.
  1740             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1741                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1742                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1743                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1744             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1745         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1746             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1747         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1748             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1749             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1750         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1751         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1752         16  FILLER                         PIC X(536).
  1753
  1754****************************************************************
  1755*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1756****************************************************************
  1757
  1758     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1759         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1760             20  CF-FEMALE-HEIGHT.
  1761                 24  CF-FEMALE-FT           PIC 99.
  1762                 24  CF-FEMALE-IN           PIC 99.
  1763             20  CF-FEMALE-MIN-WT           PIC 999.
  1764             20  CF-FEMALE-MAX-WT           PIC 999.
  1765         16  FILLER                         PIC X(428).
  1766
  1767     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1768         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1769             20  CF-MALE-HEIGHT.
  1770                 24  CF-MALE-FT             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  33
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1771                 24  CF-MALE-IN             PIC 99.
  1772             20  CF-MALE-MIN-WT             PIC 999.
  1773             20  CF-MALE-MAX-WT             PIC 999.
  1774         16  FILLER                         PIC X(428).
  1775******************************************************************
  1776*             AUTOMATIC ACTIVITY RECORD                          *
  1777******************************************************************
  1778     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1779         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1780             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1781             20  CF-SYS-LETTER-ID           PIC X(04).
  1782             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1783             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1784             20  CF-SYS-RESET-SW            PIC X(01).
  1785             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1786             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1787
  1788         16  FILLER                         PIC X(50).
  1789
  1790         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1791             20  CF-USER-ACTIVE-SW          PIC X(01).
  1792             20  CF-USER-LETTER-ID          PIC X(04).
  1793             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1794             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1795             20  CF-USER-RESET-SW           PIC X(01).
  1796             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1797             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1798             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1799
  1800         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  34
* EL517.cbl
  1802 FD  ERPNDB.
* 1803                                  COPY ERCPNDB.
  1804******************************************************************
  1805*                                                                *
  1806*                                                                *
  1807*                            ERCPNDB.                            *
  1808*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1809*                            VMOD=2.025                          *
  1810*                                                                *
  1811*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1812*                                                                *
  1813******************************************************************
  1814*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1815*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*   FILE TYPE = VSAM,KSDS                                        *
  1820*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1821*                                                                *
  1822*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1823*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1824*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1825*                                                 RKP=13,LEN=36  *
  1826*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1827*                                      AND CHG-SEQ.)             *
  1828*                                                RKP=49,LEN=11   *
  1829*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1830*                                      AND CHG-SEQ.)             *
  1831*                                                RKP=60,LEN=15   *
  1832*                                                                *
  1833*   LOG = NO                                                     *
  1834*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1835******************************************************************
  1836******************************************************************
  1837*                   C H A N G E   L O G
  1838*
  1839* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1840*-----------------------------------------------------------------
  1841*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1842* EFFECTIVE    NUMBER
  1843*-----------------------------------------------------------------
  1844* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1845* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1846* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1847* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1848* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1849* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1850* 032306                   PEMA  ADD BOW LOAN NUMBER
  1851* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1852* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1853* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1854* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1855* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1856* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1857* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1858* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1859******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1860
  1861 01  PENDING-BUSINESS.
  1862     12  PB-RECORD-ID                     PIC XX.
  1863         88  VALID-PB-ID                        VALUE 'PB'.
  1864
  1865     12  PB-CONTROL-PRIMARY.
  1866         16  PB-COMPANY-CD                PIC X.
  1867         16  PB-ENTRY-BATCH               PIC X(6).
  1868         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1869         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1870
  1871     12  PB-CONTROL-BY-ACCOUNT.
  1872         16  PB-COMPANY-CD-A1             PIC X.
  1873         16  PB-CARRIER                   PIC X.
  1874         16  PB-GROUPING.
  1875             20  PB-GROUPING-PREFIX       PIC XXX.
  1876             20  PB-GROUPING-PRIME        PIC XXX.
  1877         16  PB-STATE                     PIC XX.
  1878         16  PB-ACCOUNT.
  1879             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1880             20  PB-ACCOUNT-PRIME         PIC X(6).
  1881         16  PB-CERT-EFF-DT               PIC XX.
  1882         16  PB-CERT-NO.
  1883             20  PB-CERT-PRIME            PIC X(10).
  1884             20  PB-CERT-SFX              PIC X.
  1885         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1886
  1887         16  PB-RECORD-TYPE               PIC X.
  1888             88  PB-MAILING-DATA                VALUE '0'.
  1889             88  PB-ISSUE                       VALUE '1'.
  1890             88  PB-CANCELLATION                VALUE '2'.
  1891             88  PB-BATCH-TRAILER               VALUE '9'.
  1892
  1893     12  PB-CONTROL-BY-ORIG-BATCH.
  1894         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1895         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1896         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1897         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1898
  1899     12  PB-CONTROL-BY-CSR.
  1900         16  PB-CSR-COMPANY-CD            PIC X.
  1901         16  PB-CSR-ID                    PIC X(4).
  1902         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1903         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1904         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1905******************************************************************
  1906*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1907******************************************************************
  1908
  1909     12  PB-LAST-MAINT-DT                 PIC XX.
  1910     12  PB-LAST-MAINT-BY                 PIC X(4).
  1911     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1912
  1913     12  PB-RECORD-BODY                   PIC X(375).
  1914
  1915     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1916         16  PB-CERT-ORIGIN               PIC X.
  1917             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1918         16  PB-I-NAME.
  1919             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1920             20  PB-I-INSURED-FIRST-NAME.
  1921                 24  PB-I-INSURED-1ST-INIT PIC X.
  1922                 24  FILLER                PIC X(9).
  1923             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1924         16  PB-I-AGE                     PIC S99   COMP-3.
  1925         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1926         16  PB-I-BIRTHDAY                PIC XX.
  1927         16  PB-I-INSURED-SEX             PIC X.
  1928             88  PB-SEX-MALE     VALUE 'M'.
  1929             88  PB-SEX-FEMALE   VALUE 'F'.
  1930
  1931         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1932         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1933         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1934         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1935         16  PB-I-SKIP-CODE               PIC X.
  1936             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1937             88  PB-SKIP-JULY              VALUE '1'.
  1938             88  PB-SKIP-AUGUST            VALUE '2'.
  1939             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1940             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1941             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1942             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1943             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1944             88  PB-SKIP-JUNE              VALUE '8'.
  1945             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1946             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1947             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1948         16  PB-I-TERM-TYPE               PIC X.
  1949             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1950             88  PB-PAID-WEEKLY            VALUE 'W'.
  1951             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1952             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1953             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1954         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1955         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1956         16  PB-I-DATA-ENTRY-SW           PIC X.
  1957             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1958             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1959             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1960             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1961         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1962         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1963*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1964         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1965         16  FILLER                       PIC X.
  1966
  1967         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1968             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1969             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1970                                                   '90' THRU '99'.
  1971         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1972                                          PIC XX.
  1973         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1974         16  PB-I-AMOUNT-FINANCED REDEFINES
  1975                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1976         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1977         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1978                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1979         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1980         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1981         16  PB-I-CLP-AMOUNT REDEFINES
  1982                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1983         16  PB-I-LF-CALC-FLAG            PIC X.
  1984             88 PB-COMP-LF-PREM               VALUE '?'.
  1985         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1986         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1987         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1988         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1989         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1990         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1991         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1992         16  PB-I-LF-ABBR                 PIC XXX.
  1993         16  PB-I-LF-INPUT-CD             PIC XX.
  1994
  1995         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1996             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1997             88  PB-INVALID-AH               VALUE '  ' '00'
  1998                                                   '90' THRU '99'.
  1999         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2000         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2001         16  PB-I-AH-CALC-FLAG            PIC X.
  2002             88 PB-COMP-AH-PREM                  VALUE '?'.
  2003         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2004         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2005         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2006         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2007         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2008         16  PB-I-AH-ABBR                 PIC XXX.
  2009         16  PB-I-AH-INPUT-CD             PIC XXX.
  2010
  2011         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2012         16  PB-I-REIN-TABLE              PIC XXX.
  2013         16  PB-I-BUSINESS-TYPE           PIC 99.
  2014         16  PB-I-INDV-GRP-CD             PIC X.
  2015         16  PB-I-MORT-CODE.
  2016             20  PB-I-TABLE               PIC X.
  2017             20  PB-I-INTEREST            PIC XX.
  2018             20  PB-I-MORT-TYP            PIC X.
  2019         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2020         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2021         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2022         16  PB-I-INDV-GRP-OVRD           PIC X.
  2023         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2024         16  PB-I-SIG-SW                  PIC X.
  2025             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2026         16  PB-I-RATE-CLASS              PIC XX.
  2027         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2028         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2029         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2030         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2031         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2032         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2033         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2034         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2035         16  PB-I-OB-FLAG                 PIC X.
  2036             88  PB-I-OB                      VALUE 'B'.
  2037             88  PB-I-SUMMARY                 VALUE 'Z'.
  2038         16  PB-I-ENTRY-STATUS            PIC X.
  2039             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2040                                              'M' '5' '9' '2'.
  2041             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2042             88  PB-I-POLICY-PENDING          VALUE '2'.
  2043             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2044             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2045             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2046             88  PB-I-REIN-ONLY               VALUE '9'.
  2047             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2048             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2049             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2050             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2051         16  PB-I-INT-CODE                PIC X.
  2052             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2053             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2054         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2055         16  PB-I-SOC-SEC-NO              PIC X(11).
  2056         16  PB-I-MEMBER-NO               PIC X(12).
  2057         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2058*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2059         16  PB-I-OLD-LOF                 PIC XXX.
  2060         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2061         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2062         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2063         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2064         16  PB-I-LIFE-INDICATOR          PIC X.
  2065             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2066         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2067         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2068                                          PIC S9(5)V99    COMP-3.
  2069         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2070             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2071             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2072         16  PB-I-1ST-PMT-DT              PIC XX.
  2073         16  PB-I-JOINT-INSURED.
  2074             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2075             20 PB-I-JOINT-FIRST-NAME.
  2076                24  PB-I-JOINT-FIRST-INIT PIC X.
  2077                24  FILLER                PIC X(9).
  2078             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2079*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2080         16  PB-I-BENEFICIARY-NAME.
  2081             20  PB-I-BANK-NUMBER         PIC X(10).
  2082             20  FILLER                   PIC X(15).
  2083         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2084         16  PB-I-REFERENCE               PIC X(12).
  2085         16  FILLER REDEFINES PB-I-REFERENCE.
  2086             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2087             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2088             20  PB-I-CLP-STATE           PIC XX.
  2089         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2090             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2091             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2092             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2093         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2094         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2095         16  PB-I-RESIDENT-STATE          PIC XX.
  2096         16  PB-I-RATE-CODE               PIC X(4).
  2097         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2098         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2099         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2100         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2101         16  PB-I-BANK-NOCHRGB            PIC 99.
  2102         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2103         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2104
  2105     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2106         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2107             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2108         16  PB-C-CANCEL-ORIGIN           PIC X.
  2109             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2110         16  PB-C-LF-CANCEL-DT            PIC XX.
  2111         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2112         16  PB-C-LF-CALC-REQ             PIC X.
  2113             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2114         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2115         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2116         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2117             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2118         16  PB-C-AH-CANCEL-DT            PIC XX.
  2119         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2120         16  PB-C-AH-CALC-REQ             PIC X.
  2121             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2122         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2123         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2124         16  PB-C-LAST-NAME               PIC X(15).
  2125         16  PB-C-REFUND-SW               PIC X.
  2126             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2127             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2128         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2129         16  PB-C-PAYEE-CODE              PIC X(6).
  2130         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2131         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2132         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2133         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2134         16  PB-C-REFERENCE               PIC X(12).
  2135         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2136         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2137         16  PB-C-POST-CARD-IND           PIC X.
  2138         16  PB-C-CANCEL-REASON           PIC X.
  2139         16  PB-C-REF-INTERFACE-SW        PIC X.
  2140         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2141         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2142         16  FILLER                       PIC X(01).
  2143*        16  FILLER                       PIC X(18).
  2144         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2145*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2146         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2147         16  PB-CANCELED-CERT-DATA.
  2148             20  PB-CI-INSURED-NAME.
  2149                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2150                 24  PB-CI-INITIALS       PIC XX.
  2151             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2152             20  PB-CI-INSURED-SEX        PIC X.
  2153             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2154             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2155             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2156             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2157             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2158             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2159             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2160             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2161             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2162             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2163             20  PB-CI-RATE-CLASS         PIC XX.
  2164             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2165             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2166             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2167             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2168             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2169             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2170             20  PB-CI-LF-ABBR            PIC X(3).
  2171             20  PB-CI-AH-ABBR            PIC X(3).
  2172             20  PB-CI-OB-FLAG            PIC X.
  2173                 88  PB-CI-OB                VALUE 'B'.
  2174             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2175                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2176                                           'M' '4' '5' '9' '2'.
  2177                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2178                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2179                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2180                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2181                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2182                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2183                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2184                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2185                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2186                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2187                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2188                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2189             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2190                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2191                                           'M' '4' '5' '9' '2'.
  2192                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2193                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2194                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2195                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2196                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2197                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2198                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2199                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2200                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2201                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2202                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2203                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2204             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2205             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2206             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2207             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2208             20  PB-CI-INT-CODE           PIC X.
  2209                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2210                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2211             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2212             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2213             20  PB-CI-COMP-EXCP-SW       PIC X.
  2214                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2215                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2216             20  PB-CI-ENTRY-STATUS       PIC X.
  2217             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2218             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2219             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2220             20  PB-CI-DEATH-DT           PIC XX.
  2221             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2222             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2223             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2224             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2225             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2226             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2227             20  PB-CI-ENTRY-DT              PIC XX.
  2228             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2229             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2230             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2231             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2232             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2233             20  PB-CI-OLD-LOF               PIC XXX.
  2234*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2235             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2236             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2237             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2238             20  PB-CI-INDV-GRP-CD           PIC X.
  2239             20  PB-CI-BENEFICIARY-NAME.
  2240                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2241                 24  FILLER                  PIC X(15).
  2242             20  PB-CI-NOTE-SW               PIC X.
  2243             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2244             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2245             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2246             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2247             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2248             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2249             20  PB-CI-FIRST-NAME            PIC X(10).
  2250             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2251
  2252         16  FILLER                       PIC X(13).
  2253*032306  16  FILLER                       PIC X(27).
  2254*        16  FILLER                       PIC X(46).
  2255
  2256     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2257         16  FILLER                       PIC X(10).
  2258         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2259         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2260         16  PB-M-INSURED-MID-INIT        PIC X.
  2261         16  PB-M-INSURED-AGE             PIC 99.
  2262         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2263         16  PB-M-INSURED-SEX             PIC X.
  2264         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2265         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2266         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2267         16  PB-M-INSURED-CITY-STATE.
  2268             20  PB-M-INSURED-CITY        PIC X(28).
  2269             20  PB-M-INSURED-STATE       PIC XX.
  2270         16  PB-M-INSURED-ZIP-CODE.
  2271             20  PB-M-INSURED-ZIP-PRIME.
  2272                 24  PB-M-INSURED-ZIP-1   PIC X.
  2273                     88  PB-M-CANADIAN-POST-CODE
  2274                                             VALUE 'A' THRU 'Z'.
  2275                 24  FILLER               PIC X(4).
  2276             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2277         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2278                                        PB-M-INSURED-ZIP-CODE.
  2279             20  PM-M-INS-CAN-POST1       PIC XXX.
  2280             20  PM-M-INS-CAN-POST2       PIC XXX.
  2281             20  FILLER                   PIC XXX.
  2282         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2283         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2284         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2285         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2286         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2287         16  PB-M-CRED-BENE-CITYST.
  2288             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2289             20  PB-M-CRED-BENE-STATE     PIC XX.
  2290
  2291         16  FILLER                       PIC X(92).
  2292
  2293     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2294         16  FILLER                       PIC X(10).
  2295         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2296         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2297         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2298         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2299         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2300         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2301         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2302         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2303         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2304         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2305         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2306         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2307         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2308         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2309         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2310         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2311         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2312         16  PB-ACCOUNT-NAME              PIC X(30).
  2313         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2314         16  PB-REFERENCE                 PIC X(12).
  2315         16  PB-B-RECEIVED-DT             PIC XX.
  2316         16  FILLER                       PIC X(234).
  2317
  2318     12  PB-RECORD-STATUS.
  2319         16  PB-CREDIT-SELECT-DT          PIC XX.
  2320         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2321         16  PB-BILLED-DT                 PIC XX.
  2322         16  PB-BILLING-STATUS            PIC X.
  2323             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2324             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2325             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2326         16  PB-RECORD-BILL               PIC X.
  2327             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2328             88  PB-RECORD-RETURNED           VALUE 'R'.
  2329             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2330             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2331             88  PB-OVERRIDE-AH               VALUE 'A'.
  2332             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2333         16  PB-BATCH-ENTRY               PIC X.
  2334             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2335             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2336             88  PB-REISSUED-CERT             VALUE 'E'.
  2337             88  PB-MONTHLY-CERT              VALUE 'M'.
  2338             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2339             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2340             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2341         16  PB-FORCE-CODE                PIC X.
  2342             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2343             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2344             88  PB-CANCEL-FORCE              VALUE '8'.
  2345             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2346             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2347             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2348             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2349             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2350             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2351             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2352         16  PB-FATAL-FLAG                PIC X.
  2353             88  PB-FATAL-ERRORS              VALUE 'X'.
  2354         16  PB-FORCE-ER-CD               PIC X.
  2355             88  PB-FORCE-ERRORS              VALUE 'F'.
  2356             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2357         16  PB-WARN-ER-CD                PIC X.
  2358             88  PB-WARNING-ERRORS            VALUE 'W'.
  2359         16  FILLER                       PIC X.
  2360         16  PB-OUT-BAL-CD                PIC X.
  2361             88  PB-OUT-OF-BAL                VALUE 'O'.
  2362         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2363         16  PB-AH-OVERRIDE-L1            PIC X.
  2364         16  PB-INPUT-DT                  PIC XX.
  2365         16  PB-INPUT-BY                  PIC X(4).
  2366         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2367         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2368         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2369         16  PB-LF-EARNING-METHOD         PIC X.
  2370         16  PB-AH-EARNING-METHOD         PIC X.
  2371         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2372         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2373         16  PB-REIN-CD                   PIC XXX.
  2374         16  PB-LF-REFUND-TYPE            PIC X.
  2375         16  PB-AH-REFUND-TYPE            PIC X.
  2376         16  PB-ACCT-EFF-DT               PIC XX.
  2377         16  PB-ACCT-EXP-DT               PIC XX.
  2378         16  PB-COMPANY-ID                PIC X(3).
  2379         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2380         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2381         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2382         16  PB-SV-GROUPING               PIC X(6).
  2383         16  PB-SV-STATE                  PIC XX.
  2384         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2385         16  PB-GA-BILLING-INFO.
  2386             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2387                                          PIC XX.
  2388         16  PB-SV-REMIT-TO  REDEFINES
  2389             PB-GA-BILLING-INFO           PIC X(10).
  2390         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2391         16  PB-I-LOAN-OFFICER            PIC X(5).
  2392         16  PB-I-VIN                     PIC X(17).
  2393
  2394         16  FILLER                       PIC X(04).
  2395         16  IMNET-BYPASS-SW              PIC X.
  2396
  2397******************************************************************
  2398*                COMMON EDIT ERRORS                              *
  2399******************************************************************
  2400
  2401     12  PB-COMMON-ERRORS.
  2402         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2403                                           PIC S9(4)     COMP.
  2404
  2405******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  45
* EL517.cbl
  2407 FD  ERREIN.
* 2408                                  COPY ERCREIN.
  2409******************************************************************07/27/93
  2410*                                                                *ERCREIN
  2411*                            ERCREIN                             *   LV009
  2412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2413*                            VMOD=2.010                          *   CL**9
  2414*                                                                *ERCREIN
  2415*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2416*                                                                *ERCREIN
  2417*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2418*                                                                *ERCREIN
  2419*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2420*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2421*                                                                *ERCREIN
  2422*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2423*       ALTERNATE PATH = NONE                                    *ERCREIN
  2424*                                                                *ERCREIN
  2425*   LOG = NO                                                     *ERCREIN
  2426*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2427*                                                                *ERCREIN
  2428******************************************************************ERCREIN
  2429*                   C H A N G E   L O G
  2430*
  2431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2432*-----------------------------------------------------------------
  2433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2434* EFFECTIVE    NUMBER
  2435*-----------------------------------------------------------------
  2436* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2437* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2438******************************************************************
  2439 01  REINSURANCE-RECORD.                                          ERCREIN
  2440     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2441         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2442                                                                  ERCREIN
  2443     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2444         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2445         16  RE-KEY.                                              ERCREIN
  2446             20  RE-CODE                   PIC X.                 ERCREIN
  2447                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2448                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2449             20  RE-TABLE                  PIC XXX.               ERCREIN
  2450             20  FILLER                    PIC XXX.               ERCREIN
  2451         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2452             20  FILLER                    PIC X.                 ERCREIN
  2453             20  RE-COMPANY.                                      ERCREIN
  2454                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2455                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2456                                                                  ERCREIN
  2457     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2458         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2459         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2460         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2461         16  FILLER                        PIC X(10).             ERCREIN
  2462                                                                  ERCREIN
  2463     12  RE-TABLE-DATA.                                           ERCREIN
  2464         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2465                                                                  ERCREIN
  2466         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2467             20  RE-REI-COMP-NO.                                  ERCREIN
  2468                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2469                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2470             20  RE-LF-QC                  PIC X.                 ERCREIN
  2471             20  RE-AH-QC                  PIC X.                 ERCREIN
  2472             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2473             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2474             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2475             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2476             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2477             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2478             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2479             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2480             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2481             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2482             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2483             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2484             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2485             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2486             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2487             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2488             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2489             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2490             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2491             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2492             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2493             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2494             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2495             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2496             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2497             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2498             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2499             20  RE-REMAINING              PIC X.                 ERCREIN
  2500             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2501             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2502             20  FILLER                    PIC X(19).                  000
  2503                                                                  ERCREIN
  2504         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2505         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2506         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2507         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2508             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2509                                                                  ERCREIN
  2510         16  FILLER                        PIC X(27).             ERCREIN
  2511                                                                  ERCREIN
  2512     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2513         16  RE-NAME                       PIC X(30).             ERCREIN
  2514         16  RE-LF-PE                      PIC X.                 ERCREIN
  2515         16  RE-AH-PE                      PIC X.                 ERCREIN
  2516         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2517         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2518         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2519         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2520         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2521         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2522         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2523         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2524         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2525         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2526         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2527         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2528         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2529         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2530         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2531         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2532         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2533         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2534                                                                  ERCREIN
  2535         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2536             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2537                                                                  ERCREIN
  2538         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2539             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2540                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2541                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2542                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2543                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2544             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2545                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2546                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2547                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2548                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2549                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2550                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2551                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2552                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2553             20  FILLER                    PIC XXX.               ERCREIN
  2554             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2555                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2556                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2557                                                                  ERCREIN
  2558         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2559             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2560                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2561                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2562                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2563                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2564             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2565                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2566                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2567                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2568                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2569                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2570                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2571                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2572                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2573             20  FILLER                    PIC XXX.               ERCREIN
  2574             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2575                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2576                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2577                                                                  ERCREIN
  2578         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2579                                                                  ERCREIN
  2580         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2581                                                                  ERCREIN
  2582         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2583         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2584         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2585         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2586         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2587         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2588         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2589         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2590         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2591             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2592             88  RE-CEDED                          VALUE 'C'.        CL**2
  2593             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2594             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2595                                                                  ERCREIN
  2596         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2597             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2598         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2599             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2600         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2601             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2602         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2603             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2604         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2605             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2606                                                                     CL**3
  2607         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2608                                                                     CL**5
  2609         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2610                                                                     CL**8
  2611         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2612                                                                     CL**8
  2613         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2614                                                                     CL**9
  2615         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2616             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2617             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2618
  2619         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2620             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2621                                                                     CL**9
  2622         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2623         16  FILLER                        PIC X(2281).              CL**9
  2624                                                                  ERCREIN
  2625         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2626                                                                  ERCREIN
  2627******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  49
* EL517.cbl
  2629 FD  ELCERT.
* 2630                                  COPY ELCCERT.
  2631******************************************************************04/15/98
  2632*                                                                *ELCCERT
  2633*                            ELCCERT.                            *   LV002
  2634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2635*                            VMOD=2.013                          *   CL**2
  2636*                                                                *ELCCERT
  2637*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2638*                                                                *ELCCERT
  2639*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2640*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2641*                                                                *ELCCERT
  2642*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2643*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2644*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2645*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2646*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2647*                                                                *ELCCERT
  2648*   LOG = YES                                                    *ELCCERT
  2649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2650******************************************************************
  2651*                   C H A N G E   L O G
  2652*
  2653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2654*-----------------------------------------------------------------
  2655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2656* EFFECTIVE    NUMBER
  2657*-----------------------------------------------------------------
  2658* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2659* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2660* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2661* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2662* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2663* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2664* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2665* 032612  CR2011110200001  PEMA  AHL CHANGES
  2666******************************************************************
  2667                                                                  ELCCERT
  2668 01  CERTIFICATE-MASTER.                                          ELCCERT
  2669     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2670         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2671                                                                  ELCCERT
  2672     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2673         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2674         16  CM-CARRIER                    PIC X.                 ELCCERT
  2675         16  CM-GROUPING.                                         ELCCERT
  2676             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2677             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2678         16  CM-STATE                      PIC XX.                ELCCERT
  2679         16  CM-ACCOUNT.                                          ELCCERT
  2680             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2681             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2682         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2683         16  CM-CERT-NO.                                          ELCCERT
  2684             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2685             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2686                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2687     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2688         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2689         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2690         16  CM-INSURED-INITIALS.                                 ELCCERT
  2691             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2692             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2693                                                                  ELCCERT
  2694     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2695         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2696         16  CM-SOC-SEC-NO.                                       ELCCERT
  2697             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2698             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2699             20  CM-SSN-LN3.                                      ELCCERT
  2700                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2701                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2702                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2703                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2704                                                                  ELCCERT
  2705     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2706         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2707         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2708                                                                  ELCCERT
  2709     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2710         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2711         16  CM-MEMBER-NO.                                        ELCCERT
  2712             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2713             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2714             20  CM-MEMB-LN4.                                     ELCCERT
  2715                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2716                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2717                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2718                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2719                                                                  ELCCERT
  2720     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2721         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2722             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2723             20  FILLER                    PIC X(9).              ELCCERT
  2724         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2725         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2726             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2727             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2728         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2729         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2730             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2731             20  CM-JT-FIRST-NAME.                                ELCCERT
  2732                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2733                 24  FILLER                PIC X(9).              ELCCERT
  2734             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2735                                                                  ELCCERT
  2736     12  CM-LIFE-DATA.                                            ELCCERT
  2737         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2738         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2739         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2740         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2741         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2742         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2743         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2744         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2745         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2746         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2747         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2748         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2749         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2750         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2751         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2752         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2753         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2754         16  FILLER                        PIC XX.                ELCCERT
  2755                                                                  ELCCERT
  2756     12  CM-AH-DATA.                                              ELCCERT
  2757         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2758         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2759         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2760         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2761         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2762         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2763         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2764         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2765         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2766         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2767         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2768         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2769             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2770         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2771         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2772         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2773         16  FILLER                        PIC X.                 ELCCERT
  2774                                                                  ELCCERT
  2775     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2776         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2777         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2778                                           PIC S9(5)V99  COMP-3.
  2779         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2780         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2781         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2782         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2783         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2784         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2785         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2786         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2787         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2788         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2789             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2790             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2791         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2792             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2793             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2794             20  FILLER                    PIC XX.                ELCCERT
  2795         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2796             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2797             20  FILLER                    PIC XXX.               ELCCERT
  2798         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2799         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2800             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2801         16  CM-POST-CARD-IND              PIC X.
  2802         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2803         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2804             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2805             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2806             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2807         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2808             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2809             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2810         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2811             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2812             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2813             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2814             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2815             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2816             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2817             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2818             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2819             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2820             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2821             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2822             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2823         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2824             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2825             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2826             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2827             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2828             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2829         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2830         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2831         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2832*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2833         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2834         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2835         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2836         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2837         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2838                                                                  ELCCERT
  2839     12  CM-STATUS-DATA.                                          ELCCERT
  2840         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2841         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2842                                                                  ELCCERT
  2843         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2844         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2845         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2846                                                                  ELCCERT
  2847         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2848         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2849         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2850                                                                  ELCCERT
  2851         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2852             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2853                                                'M' '4' '5' '9'.  ELCCERT
  2854             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2855             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2856             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2857             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2858             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2859             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2860             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2861             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2862             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2863             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2864             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2865             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2866                                                                  ELCCERT
  2867         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2868         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2869         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2870                                                                  ELCCERT
  2871         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2872         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2873         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2874                                                                  ELCCERT
  2875         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2876             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2877                                                'M' '4' '5' '9'.  ELCCERT
  2878             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2879             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2880             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2881             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2882             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2883             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2884             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2885             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2886             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2887             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2888             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2889             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2890                                                                  ELCCERT
  2891         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2892             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2893             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2894             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2895         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2896                                                                  ELCCERT
  2897         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2898         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2899         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2900         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2901                                                                  ELCCERT
  2902     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2903         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2904         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2905         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2906         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2907         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2908         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2909         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2910         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2911     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2912         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2913         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2914     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2915         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2916         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2917                                                                  ELCCERT
  2918*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2919     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2920     12  FILLER                            PIC X.
  2921                                                                  ELCCERT
  2922*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2923     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2924     12  FILLER                            PIC X.
  2925*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2926     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2927                                                                  ELCCERT
  2928     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2929         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2930         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2931         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2932         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2933         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2934     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2935         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2936         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2937         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2938         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2939         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2940         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2941         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2942         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2943                                                                  ELCCERT
  2944     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2945         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2946         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2947                                                                  ELCCERT
  2948     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2949     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2950     12  CM-CLP-STATE                      PIC XX.
  2951     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2952     12  CM-USER-RESERVED                  PIC XXX.
  2953     12  FILLER REDEFINES CM-USER-RESERVED.
  2954         16  CM-AH-CLASS-CD                PIC XX.
  2955         16  F                             PIC X.
  2956******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  55
* EL517.cbl
  2958 FD  ELMSTR.
* 2959                                  COPY ELCMSTR.
  2960******************************************************************04/15/98
  2961*                                                                *ELCMSTR
  2962*                            ELCMSTR.                            *   LV002
  2963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2964*                            VMOD=2.012                          *   CL**2
  2965*                                                                *ELCMSTR
  2966*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2967*                                                                *ELCMSTR
  2968*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2969*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2970*                                                                *ELCMSTR
  2971*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2972*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2973*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2974*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2975*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2976*                                                 RKP=75,LEN=21  *ELCMSTR
  2977*                                                                *ELCMSTR
  2978*   **** NOTE ****                                               *ELCMSTR
  2979*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2980*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2981*                                                                *ELCMSTR
  2982*   LOG = YES                                                    *ELCMSTR
  2983*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2984******************************************************************
  2985*                   C H A N G E   L O G
  2986*
  2987* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2988*-----------------------------------------------------------------
  2989*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2990* EFFECTIVE    NUMBER
  2991*-----------------------------------------------------------------
  2992* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2993* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2994******************************************************************ELCMSTR
  2995 01  CLAIM-MASTER.                                                ELCMSTR
  2996     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  2997         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  2998                                                                  ELCMSTR
  2999     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3000         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3001         16  CL-CARRIER              PIC X.                       ELCMSTR
  3002         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3003         16  CL-CERT-NO.                                          ELCMSTR
  3004             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3005             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3006                                                                  ELCMSTR
  3007     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3008         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3009         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3010         16  CL-INSURED-NAME.                                     ELCMSTR
  3011             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3012             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3013                                                                  ELCMSTR
  3014     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  3015         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3016         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3017             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3018             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3019             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3020                                                                  ELCMSTR
  3021     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3022         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3023         16  CL-CERT-NO-A4.                                       ELCMSTR
  3024             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3025             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3026                                                                  ELCMSTR
  3027     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3028         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3029         16  CL-CCN-A5.                                           ELCMSTR
  3030             20  CL-CCN.                                          ELCMSTR
  3031                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3032                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3033             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3034                                                                  ELCMSTR
  3035     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3036         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3037         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3038             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3039             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3040             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3041         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3042         16  FILLER                  PIC X(5).                    ELCMSTR
  3043                                                                  ELCMSTR
  3044     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3045         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3046         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3047             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3048             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3049         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3050*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3051*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3052*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3053*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3054*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3055         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3056             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3057             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3058             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3059         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3060         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3061         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3062         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3063         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3064         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3065         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3066         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3067         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3068         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3069         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3070             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3071             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3072             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  3073         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3074                                                                  ELCMSTR
  3075         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3076             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3077             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3078                                                                  ELCMSTR
  3079         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3080             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3081             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3082                                                                  ELCMSTR
  3083         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3084         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3085         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3086                                                                  ELCMSTR
  3087         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3088         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3089         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3090             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3091             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3092             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3093             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3094             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3095             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3096         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3097         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3098         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3099             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3100         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3101         16  FILLER                  PIC X.
  3102                                                                  ELCMSTR
  3103     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3104         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3105             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3106             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3107             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3108         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3109             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3110             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3111             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3112             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3113                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3114                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3115             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3116                                                                  ELCMSTR
  3117     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3118         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3119             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3120             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3121         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3122             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3123             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3124         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3125         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3126         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3127         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3128         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3129         16  FILLER                  PIC XX.                      ELCMSTR
  3130         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3131         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3132         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3133         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3134             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3135             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3136             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3137             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3138             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3139             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3140             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3141             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3142             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3143         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3144         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3145         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3146         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3147         16  CL-DENIAL-TYPE          PIC X.
  3148             88  CL-TYPE-DENIAL          VALUE '1'.
  3149             88  CL-TYPE-RESCISSION      VALUE '2'.
  3150             88  CL-TYPE-REFORMATION     VALUE '3'.
  3151             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3152             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3153         16  FILLER                  PIC X(5).                    ELCMSTR
  3154                                                                  ELCMSTR
  3155     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3156         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3157             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3158             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3159             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3160         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3161         16  FILLER                  PIC XX.                      ELCMSTR
  3162         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3163         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3164             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3165                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3166             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3167                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3168             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3169                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3170             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3171                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3172             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3173                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3174             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3175                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3176             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3177                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3178                                                                  ELCMSTR
  3179     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3180         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3181         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3182                                                                  ELCMSTR
  3183     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3184                                                                  ELCMSTR
  3185     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  3186         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3187             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3188         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3189             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3190                                                                  ELCMSTR
  3191     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3192                                                                  ELCMSTR
  3193     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3194         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3195         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3196         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3197         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3198                                                                  ELCMSTR
  3199     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3200         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3201         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3202         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3203         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3204                                                                  ELCMSTR
  3205     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3206     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3207     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3208                                                                  ELCMSTR
  3209     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3210     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3211     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3212     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3213                                                                  ELCMSTR
  3214*    12  FILLER                      PIC X(5).                    ELCMSTR
  3215     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3216     12  FILLER                      PIC X(4).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  60
* EL517.cbl
  3218 FD  ERCTBL.
* 3219                                 COPY ERCCTBL.
  3220******************************************************************04/29/98
  3221*                                                                *ERCCTBL
  3222*                                                                *ERCCTBL
  3223*                            ERCCTBL                             *   LV002
  3224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3225*                            VMOD=2.003                              CL**2
  3226*                                                                *ERCCTBL
  3227*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3228*                                                                *ERCCTBL
  3229*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3230*                                                                *ERCCTBL
  3231*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3232*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3233*                                                                *ERCCTBL
  3234*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3235*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3236*                                                                *ERCCTBL
  3237*   LOG = NO                                                     *ERCCTBL
  3238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3239*                                                                *ERCCTBL
  3240*                                                                *ERCCTBL
  3241******************************************************************ERCCTBL
  3242                                                                  ERCCTBL
  3243 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3244     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3245         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3246                                                                  ERCCTBL
  3247     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3248         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3249         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3250         16  CT-CNTRL-2.                                          ERCCTBL
  3251             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3252             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3253                                                                  ERCCTBL
  3254     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3255         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3256         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3257         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3258         16  FILLER                        PIC X(31).             ERCCTBL
  3259                                                                  ERCCTBL
  3260     12  CT-LIMITS.                                               ERCCTBL
  3261         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3262                                                                  ERCCTBL
  3263         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3264                                                                  ERCCTBL
  3265         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3266                                                                  ERCCTBL
  3267     12  CT-RATES.                                                ERCCTBL
  3268         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3269             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3270             20  CT-RT-R   REDEFINES                              ERCCTBL
  3271                 CT-RT                     PIC XXX.               ERCCTBL
  3272                                                                  ERCCTBL
  3273     12  FILLER                            PIC  X(42).            ERCCTBL
  3274                                                                  ERCCTBL
  3275******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  61
* EL517.cbl
  3276
  3277 FD  ERACCT.
* 3278                                 COPY ERCACCT.
  3279******************************************************************04/19/98
  3280*                                                                *ERCACCT
  3281*                                                                *ERCACCT
  3282*                            ERCACCT                             *   LV031
  3283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3284*                            VMOD=2.031                          *ERCACCT
  3285*                                                                *ERCACCT
  3286*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3287*                                                                *ERCACCT
  3288*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3289*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3290*                                                                *ERCACCT
  3291*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3292*                                                                *ERCACCT
  3293*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3294*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3295*                                                                *ERCACCT
  3296*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3297*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3298*                                                                *ERCACCT
  3299*   LOG = NO                                                     *ERCACCT
  3300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3301*                                                                *ERCACCT
  3302*                                                                *ERCACCT
  3303******************************************************************ERCACCT
  3304*                   C H A N G E   L O G
  3305*
  3306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3307*-----------------------------------------------------------------
  3308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3309* EFFECTIVE    NUMBER
  3310*-----------------------------------------------------------------
  3311* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3312* 092705    2005050300006  PEMA  ADD SPP LEASES
  3313* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3314* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3315* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3316* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3317* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3318******************************************************************
  3319                                                                  ERCACCT
  3320 01  ACCOUNT-MASTER.                                              ERCACCT
  3321     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3322         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3323                                                                  ERCACCT
  3324     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3325         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3326         16  AM-MSTR-CNTRL.                                       ERCACCT
  3327             20  AM-CONTROL-A.                                    ERCACCT
  3328                 24  AM-CARRIER            PIC X.                 ERCACCT
  3329                 24  AM-GROUPING.                                 ERCACCT
  3330                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3331                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3332                 24  AM-STATE              PIC XX.                ERCACCT
  3333                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3334                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3335                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3336             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3337                                           PIC X(19).             ERCACCT
  3338             20  AM-CNTRL-B.                                      ERCACCT
  3339                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3340                 24  FILLER                PIC X(4).              ERCACCT
  3341             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3342                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3343                                                                  ERCACCT
  3344     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3345         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3346         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3347         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3348         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3349         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3350         16  AM-VG-DATE.                                          ERCACCT
  3351             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3352             20  FILLER                    PIC X(4).              ERCACCT
  3353         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3354                                           PIC 9(11)      COMP-3. ERCACCT
  3355     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3356         16  FILLER                        PIC X(10).
  3357         16  AM-VG-KEY3.
  3358             20  AM-VG3-ACCOUNT            PIC X(10).
  3359             20  AM-VG3-EXP-DT             PIC XX.
  3360         16  FILLER                        PIC X(4).
  3361     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3362         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3363         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3364         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3365         16  FILLER                        PIC XX.                ERCACCT
  3366                                                                  ERCACCT
  3367     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3368     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3369                                                                  ERCACCT
  3370     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3371         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3372         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3373                                                                  ERCACCT
  3374     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3375     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3376                                                                  ERCACCT
  3377     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3378     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3379                                                                  ERCACCT
  3380     12  AM-NAME                           PIC X(30).             ERCACCT
  3381     12  AM-PERSON                         PIC X(30).             ERCACCT
  3382     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3383     12  AM-CITY.
  3384         16  AM-ADDR-CITY                  PIC X(28).
  3385         16  AM-ADDR-STATE                 PIC XX.
  3386     12  AM-ZIP.                                                  ERCACCT
  3387         16  AM-ZIP-PRIME.                                        ERCACCT
  3388             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3389                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3390             20  FILLER                    PIC X(4).              ERCACCT
  3391         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3392     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3393         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3394         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3395         16  FILLER                        PIC XXX.               ERCACCT
  3396     12  AM-TEL-NO.                                               ERCACCT
  3397         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3398         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3399         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3400     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3401         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3402         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3403                                                                  ERCACCT
  3404     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3405         16  AM-DEFN-1.                                           ERCACCT
  3406             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3407                 24  AM-AGT.                                      ERCACCT
  3408                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3409                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3410                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3411                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3412                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3413                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3414                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3415                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3416                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3417                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3418                 24  FILLER                PIC X(01).             ERCACCT
  3419         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3420             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3421                 24  FILLER                PIC X(11).             ERCACCT
  3422                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3423                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3424                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3425                 24  FILLER                PIC X(6).              ERCACCT
  3426                                                                  ERCACCT
  3427     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3428         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3429                                                                  ERCACCT
  3430     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3431                                                                  ERCACCT
  3432     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3433         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3434         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3435     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3436         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3437         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3438     12  AM-GPCD                           PIC 99.                ERCACCT
  3439     12  AM-IG                             PIC X.                 ERCACCT
  3440         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3441         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3442     12  AM-STATUS                         PIC X.                 ERCACCT
  3443         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3444         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3445         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3446         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3447         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3448         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3449     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3450     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3451                                                                  ERCACCT
  3452     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3453     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3454     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3455     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3456     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3457     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3458     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3459     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3460     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3461                                                                  ERCACCT
  3462     12  AM-USER-FIELDS.                                          ERCACCT
  3463         16  AM-FLD-1                      PIC XX.                ERCACCT
  3464         16  AM-FLD-2                      PIC XX.                ERCACCT
  3465         16  AM-FLD-3                      PIC XX.                ERCACCT
  3466         16  AM-FLD-4                      PIC XX.                ERCACCT
  3467         16  AM-FLD-5                      PIC XX.                ERCACCT
  3468                                                                  ERCACCT
  3469     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3470         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3471         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3472         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3473     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3474     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3475         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3476         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3477         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3478     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3479     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3480     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3481     12  AM-INACTIVE-DATE.                                        ERCACCT
  3482         16  AM-INA-MO                     PIC 99.                ERCACCT
  3483         16  AM-INA-DA                     PIC 99.                ERCACCT
  3484         16  AM-INA-YR                     PIC 99.                ERCACCT
  3485     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3486                                                                  ERCACCT
  3487     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3488     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3489                                                                  ERCACCT
  3490     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3491         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3492         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3493         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3494         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3495                                                                  ERCACCT
  3496     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3497         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3498         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3499                                                                  ERCACCT
  3500     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3501                                                                  ERCACCT
  3502     12  AM-OVER-SHORT.                                           ERCACCT
  3503         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3504         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3505                                                                  ERCACCT
  3506     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3507     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3508                                                                  ERCACCT
  3509     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3510     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3511                                                                  ERCACCT
  3512     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3513     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3514     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3515     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3516     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3517     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3518     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3519     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3520     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3521     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3522     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3523     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3524     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3525     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3526     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3527     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3528                                                                  ERCACCT
  3529     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3530                                                                  ERCACCT
  3531     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3532     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3533                                                                  ERCACCT
  3534     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3535     12  AM-EARN-METHODS.                                         ERCACCT
  3536         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3537             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3538             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3539             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3540             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3541         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3542             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3543             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3544             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3545             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3546         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3547             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3548             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3549             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3550             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3551             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3552             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3553                                                                  ERCACCT
  3554     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3555     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3556     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3557                                                                  ERCACCT
  3558     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3559     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3560     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3561     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3562     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3563     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3564         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3565         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3566     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3567         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3568         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3569         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3570     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3571         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3572         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3573     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3574         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3575         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3576         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3577     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3578     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3579                                                                  ERCACCT
  3580     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3581         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3582         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3583         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3584         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3585         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3586                                                                  ERCACCT
  3587     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3588                                                                  ERCACCT
  3589     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3590                                                                  ERCACCT
  3591     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3592         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3593                                                                  ERCACCT
  3594     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3595         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3596         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3597                                                                  ERCACCT
  3598     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3599         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3600                                                                  ERCACCT
  3601     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3602         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3603         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3604                                                                  ERCACCT
  3605     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3606                                                                  ERCACCT
  3607     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3608     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3609     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3610     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3611     12  AM-DCC-UEF-STATE                  PIC XX.
  3612     12  FILLER                            PIC XXX.
  3613     12  AM-REPORT-CODE-3                  PIC X(10).
  3614*    12  FILLER                            PIC X(22).             ERCACCT
  3615                                                                  ERCACCT
  3616     12  AM-RESERVE-DATE.                                         ERCACCT
  3617         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3618         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3619         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3620                                                                  ERCACCT
  3621     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3622     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3623         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3624         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3625         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3626         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3627                                                                  ERCACCT
  3628     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3629         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3630         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3631         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3632         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3633                                                                  ERCACCT
  3634     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3635         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3636             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3637             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3638             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3639             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3640             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3641             20  FILLER                    PIC XX.                ERCACCT
  3642         16  FILLER                        PIC X(80).             ERCACCT
  3643                                                                  ERCACCT
  3644     12  AM-TRANSFER-DATA.                                        ERCACCT
  3645         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3646             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3647             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3648                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3649                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3650             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3651             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3652                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3653                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3654             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3655         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3656             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3657             20  AM-TRNTO-GROUPING.                               ERCACCT
  3658                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3659                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3660             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3661             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3662                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3663                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3664             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3665         16  FILLER                        PIC X(10).             ERCACCT
  3666                                                                  ERCACCT
  3667     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3668                                                                  ERCACCT
  3669     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3670         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3671             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3672                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3673                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3674                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3675                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3676                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3677                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3678                 24  FILLER                PIC X.                 ERCACCT
  3679                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3680                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3681                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3682         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3683             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3684                 24  FILLER                PIC X(11).             ERCACCT
  3685                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3686                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3687                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3688                 24  FILLER                PIC X(6).              ERCACCT
  3689                                                                  ERCACCT
  3690     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3691         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3692            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3693            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3694            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3695                                                                  ERCACCT
  3696     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3697     12  FILLER                            PIC X(120).            ERCACCT
  3698                                                                  ERCACCT
  3699     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3700         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3701         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3702             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3703             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3704                                                          COMP-3. ERCACCT
  3705             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3706                                                          COMP-3. ERCACCT
  3707         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3708             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3709             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3710                                                          COMP-3. ERCACCT
  3711             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3712                                                          COMP-3. ERCACCT
  3713                                                                  ERCACCT
  3714     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3715         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3716         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3717         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3718         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3719             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3720                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3721                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3722             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3723                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3724                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3725             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3726                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3727                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3728         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3729             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3730                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3731                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3732                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3733             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3734                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3735                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3736             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3737                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3738                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3739                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3740     12  AM-COMMENTS.                                             ERCACCT
  3741         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3742                                                                  ERCACCT
  3743     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3744         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3745         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3746         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3747         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3748         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3749             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3750             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3751             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3752             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3753         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3754             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3755             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3756             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3757         16  FILLER                        PIC X(102).            ERCACCT
  3758                                                                  ERCACCT
  3759     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3760         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3761             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3762             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3763             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3764             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3765             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3766         16  FILLER                          PIC X(10).           ERCACCT
  3767******************************************************************ERCACCT
  3768
  3769 FD  ELCERR.
* 3770                                 COPY ELCERRS.
  3771******************************************************************04/15/98
  3772*                                                                *ELCERRS
  3773*                                                                *ELCERRS
  3774*                            ELCERRS.                            *   LV002
  3775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3776*                            VMOD 2.002                          *   CL**2
  3777*                                                                *ELCERRS
  3778*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3779*                                                                *ELCERRS
  3780*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3781*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3782*                                                                *ELCERRS
  3783*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3784*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3785*                                                                *ELCERRS
  3786*   LOG = NO                                                     *ELCERRS
  3787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3788******************************************************************ELCERRS
  3789 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3790     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3791         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3792                                                                  ELCERRS
  3793     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3794         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3795                                                                  ELCERRS
  3796     12  EM-ERROR-TEXT.                                           ELCERRS
  3797         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3798         16  FILLER                  PIC X(59).                   ELCERRS
  3799                                                                  ELCERRS
  3800     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3801         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3802         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3803         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3804         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3805                                                                  ELCERRS
  3806******************************************************************ELCERRS
  3807
  3808 FD  ERPNDM.
* 3809                                 COPY ERCPNDM.
  3810******************************************************************
  3811*                                                                *
  3812*                                                                *
  3813*                            ERCPNDM                             *
  3814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3815*                            VMOD=2.003                          *
  3816*                                                                *
  3817*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3818*                                                                *
  3819*   FILE TYPE = VSAM,KSDS                                        *
  3820*   RECORD SIZE = 374   RECFORM = FIX                            *
  3821*                                                                *
  3822*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3823*   ALTERNATE PATH    = NOT USED                                 *
  3824*                                                                *
  3825*   LOG = YES                                                    *
  3826*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3827******************************************************************
  3828*                   C H A N G E   L O G
  3829*
  3830* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3831*-----------------------------------------------------------------
  3832*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3833* EFFECTIVE    NUMBER
  3834*-----------------------------------------------------------------
  3835* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3836* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3837* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3838******************************************************************
  3839
  3840 01  PENDING-MAILING-DATA.
  3841     12  PM-RECORD-ID                      PIC XX.
  3842         88  VALID-MA-ID                       VALUE 'PM'.
  3843
  3844     12  PM-CONTROL-PRIMARY.
  3845         16  PM-COMPANY-CD                 PIC X.
  3846         16  PM-ENTRY-BATCH                PIC X(6).
  3847         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3848         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3849
  3850     12  FILLER                            PIC X(14).
  3851
  3852     12  PM-ACCESS-CONTROL.
  3853         16  PM-SOURCE-SYSTEM              PIC XX.
  3854             88  PM-FROM-CREDIT                VALUE 'CR'.
  3855             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3856             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3857             88  PM-FROM-OTHER                 VALUE 'OT'.
  3858         16  PM-RECORD-ADD-DT              PIC XX.
  3859         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3860         16  PM-LAST-MAINT-DT              PIC XX.
  3861         16  PM-LAST-MAINT-BY              PIC XXXX.
  3862         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3863
  3864     12  PM-PROFILE-INFO.
  3865         16  PM-QUALIFY-CODE-1             PIC XX.
  3866         16  PM-QUALIFY-CODE-2             PIC XX.
  3867         16  PM-QUALIFY-CODE-3             PIC XX.
  3868         16  PM-QUALIFY-CODE-4             PIC XX.
  3869         16  PM-QUALIFY-CODE-5             PIC XX.
  3870
  3871         16  PM-INSURED-LAST-NAME          PIC X(15).
  3872         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3873         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3874         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3875         16  PM-INSURED-BIRTH-DT           PIC XX.
  3876         16  PM-INSURED-SEX                PIC X.
  3877             88  PM-SEX-MALE                   VALUE 'M'.
  3878             88  PM-SEX-FEMALE                 VALUE 'F'.
  3879         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3880
  3881         16  PM-ADDRESS-CORRECTED          PIC X.
  3882         16  PM-JOINT-BIRTH-DT             PIC XX.
  3883*        16  FILLER                        PIC X(12).
  3884
  3885         16  PM-ADDRESS-LINE-1             PIC X(30).
  3886         16  PM-ADDRESS-LINE-2             PIC X(30).
  3887         16  PM-CITY-STATE.
  3888             20  PM-CITY                   PIC X(28).
  3889             20  PM-STATE                  PIC XX.
  3890         16  PM-ZIP.
  3891             20  PM-ZIP-CODE.
  3892                 24  PM-ZIP-1              PIC X.
  3893                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3894                 24  FILLER                PIC X(4).
  3895             20  PM-ZIP-PLUS4              PIC X(4).
  3896         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3897             20  PM-CAN-POST1              PIC XXX.
  3898             20  PM-CAN-POST2              PIC XXX.
  3899             20  FILLER                    PIC XXX.
  3900
  3901         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3902
  3903         16  FILLER                        PIC X(03).
  3904
  3905     12  PM-CRED-BENE-INFO.
  3906         16  PM-CRED-BENE-NAME             PIC X(25).
  3907         16  PM-CRED-BENE-ADDR             PIC X(30).
  3908         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3909         16  PM-CRED-BENE-CTYST.
  3910             20  PM-CRED-BENE-CITY         PIC X(28).
  3911             20  PM-CRED-BENE-STATE        PIC XX.
  3912         16  PM-CRED-BENE-ZIP.
  3913             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3914                 24  PM-CB-ZIP-1           PIC X.
  3915                     88  PM-CB-CANADIAN-POST-CODE
  3916                                  VALUE 'A' THRU 'Z'.
  3917                 24  FILLER                PIC X(4).
  3918             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3919         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3920             20  PM-CB-CAN-POST1           PIC XXX.
  3921             20  PM-CB-CAN-POST2           PIC XXX.
  3922             20  FILLER                    PIC XXX.
  3923     12  PM-POST-CARD-MAIL-DATA.
  3924         16  PM-MAIL-DATA OCCURS 7.
  3925             20  PM-MAIL-TYPE              PIC X.
  3926                 88  PM-12MO-MAILING           VALUE '1'.
  3927                 88  PM-EXP-MAILING            VALUE '2'.
  3928             20  PM-MAIL-STATUS            PIC X.
  3929                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3930                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3931                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3932             20  PM-MAIL-DATE              PIC XX.
  3933     12  FILLER                            PIC XX.
  3934     12  FILLER                            PIC X(12).
  3935*    12  FILLER                            PIC X(30).
  3936
  3937******************************************************************
  3938
  3939 FD  ERMAIL.
* 3940                                 COPY ERCMAIL.
  3941******************************************************************
  3942*                                                                *
  3943*                                                                *
  3944*                            ERCMAIL                             *
  3945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3946*                            VMOD=2.003                          *
  3947*                                                                *
  3948*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3949*                                                                *
  3950*   FILE TYPE = VSAM,KSDS                                        *
  3951*   RECORD SIZE = 374   RECFORM = FIX                            *
  3952*                                                                *
  3953*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3954*   ALTERNATE PATH    = NOT USED                                 *
  3955*                                                                *
  3956*   LOG = YES                                                    *
  3957*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3958******************************************************************
  3959*                   C H A N G E   L O G
  3960*
  3961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3962*-----------------------------------------------------------------
  3963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3964* EFFECTIVE    NUMBER
  3965*-----------------------------------------------------------------
  3966* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3967* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3968* 111108                   PEMA  ADD CRED BENE ADDR2
  3969******************************************************************
  3970
  3971 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3972     12  MA-RECORD-ID                      PIC XX.
  3973         88  VALID-MA-ID                       VALUE 'MA'.
  3974
  3975     12  MA-CONTROL-PRIMARY.
  3976         16  MA-COMPANY-CD                 PIC X.
  3977         16  MA-CARRIER                    PIC X.
  3978         16  MA-GROUPING.
  3979             20  MA-GROUPING-PREFIX        PIC XXX.
  3980             20  MA-GROUPING-PRIME         PIC XXX.
  3981         16  MA-STATE                      PIC XX.
  3982         16  MA-ACCOUNT.
  3983             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3984             20  MA-ACCOUNT-PRIME          PIC X(6).
  3985         16  MA-CERT-EFF-DT                PIC XX.
  3986         16  MA-CERT-NO.
  3987             20  MA-CERT-PRIME             PIC X(10).
  3988             20  MA-CERT-SFX               PIC X.
  3989
  3990     12  FILLER                            PIC XX.
  3991
  3992     12  MA-ACCESS-CONTROL.
  3993         16  MA-SOURCE-SYSTEM              PIC XX.
  3994             88  MA-FROM-CREDIT                VALUE 'CR'.
  3995             88  MA-FROM-VSI                   VALUE 'VS'.
  3996             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3997             88  MA-FROM-OTHER                 VALUE 'OT'.
  3998         16  MA-RECORD-ADD-DT              PIC XX.
  3999         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4000         16  MA-LAST-MAINT-DT              PIC XX.
  4001         16  MA-LAST-MAINT-BY              PIC XXXX.
  4002         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4003
  4004     12  MA-PROFILE-INFO.
  4005         16  MA-QUALIFY-CODE-1             PIC XX.
  4006         16  MA-QUALIFY-CODE-2             PIC XX.
  4007         16  MA-QUALIFY-CODE-3             PIC XX.
  4008         16  MA-QUALIFY-CODE-4             PIC XX.
  4009         16  MA-QUALIFY-CODE-5             PIC XX.
  4010
  4011         16  MA-INSURED-LAST-NAME          PIC X(15).
  4012         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4013         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4014         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4015         16  MA-INSURED-BIRTH-DT           PIC XX.
  4016         16  MA-INSURED-SEX                PIC X.
  4017             88  MA-SEX-MALE                   VALUE 'M'.
  4018             88  MA-SEX-FEMALE                 VALUE 'F'.
  4019         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4020
  4021         16  MA-ADDRESS-CORRECTED          PIC X.
  4022         16  MA-JOINT-BIRTH-DT             PIC XX.
  4023*        16  FILLER                        PIC X(12).
  4024
  4025         16  MA-ADDRESS-LINE-1             PIC X(30).
  4026         16  MA-ADDRESS-LINE-2             PIC X(30).
  4027         16  MA-CITY-STATE.
  4028             20  MA-CITY                   PIC X(28).
  4029             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4030         16  MA-ZIP.
  4031             20  MA-ZIP-CODE.
  4032                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4033                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4034                 24  FILLER                PIC X(4).
  4035             20  MA-ZIP-PLUS4              PIC X(4).
  4036         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4037             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4038             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4039             20  FILLER                    PIC X(3).
  4040
  4041         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4042
  4043         16  FILLER                        PIC XXX.
  4044*        16  FILLER                        PIC X(10).
  4045
  4046
  4047     12  MA-CRED-BENE-INFO.
  4048         16  MA-CRED-BENE-NAME                 PIC X(25).
  4049         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4050         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4051         16  MA-CRED-BENE-CTYST.
  4052             20  MA-CRED-BENE-CITY             PIC X(28).
  4053             20  MA-CRED-BENE-STATE            PIC XX.
  4054         16  MA-CRED-BENE-ZIP.
  4055             20  MA-CB-ZIP-CODE.
  4056                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4057                     88  MA-CB-CANADIAN-POST-CODE
  4058                                           VALUE 'A' THRU 'Z'.
  4059                 24  FILLER                    PIC X(4).
  4060             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4061         16  MA-CB-CANADIAN-POSTAL-CODE
  4062                            REDEFINES MA-CRED-BENE-ZIP.
  4063             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4064             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4065             20  FILLER                        PIC X(3).
  4066     12  MA-POST-CARD-MAIL-DATA.
  4067         16  MA-MAIL-DATA OCCURS 7.
  4068             20  MA-MAIL-TYPE              PIC X.
  4069                 88  MA-12MO-MAILING           VALUE '1'.
  4070                 88  MA-EXP-MAILING            VALUE '2'.
  4071             20  MA-MAIL-STATUS            PIC X.
  4072                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4073                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4074                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4075             20  MA-MAIL-DATE              PIC XX.
  4076     12  FILLER                            PIC XX.
  4077     12  FILLER                            PIC XX.
  4078*    12  FILLER                            PIC X(30).
  4079******************************************************************
  4080
  4081 FD  ERPLAN.
* 4082                                 COPY ERCPLAN.
  4083******************************************************************04/29/98
  4084*                                                                *ERCPLAN
  4085*                                                                *ERCPLAN
  4086*                            ERCPLAN                             *   LV003
  4087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4088*                            VMOD=2.003                          *   CL**2
  4089*                                                                *ERCPLAN
  4090*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4091*                                                                *ERCPLAN
  4092*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4093*   PLAN MASTER                                                  *ERCPLAN
  4094*                                                                *ERCPLAN
  4095*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4096*                                                                *ERCPLAN
  4097*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4098*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4099*                                                                *ERCPLAN
  4100*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4101*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4102*                                                                *ERCPLAN
  4103*   LOG = NO                                                     *ERCPLAN
  4104*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4105*                                                                *ERCPLAN
  4106*                                                                *ERCPLAN
  4107******************************************************************ERCPLAN
  4108                                                                  ERCPLAN
  4109 01  PLAN-MASTER.                                                 ERCPLAN
  4110     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4111         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4112                                                                  ERCPLAN
  4113     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4114         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4115         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4116             20  PL-CONTROL-A.                                    ERCPLAN
  4117                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4118                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4119                 24  PL-STATE              PIC XX.                ERCPLAN
  4120                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4121             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4122             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4123             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4124                                                                  ERCPLAN
  4125     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4126         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4127         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4128         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4129         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4130         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4131         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4132         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4133         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4134                                                                  ERCPLAN
  4135     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4136         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4137         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4138         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4139         16  FILLER                        PIC XX.                ERCPLAN
  4140                                                                  ERCPLAN
  4141     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4142         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4143         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4144             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4145             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4146             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4147             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4148                                                                  ERCPLAN
  4149     12  FILLER                            PIC X(30).             ERCPLAN
  4150                                                                  ERCPLAN
  4151     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4152         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4153         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4154         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4155     12  FILLER                            PIC X(24).             ERCPLAN
  4156     12  PL-TOLERANCES.                                           ERCPLAN
  4157         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4158         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4159         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4160         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4161         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4162         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4163     12  PL-OVER-SHORT.                                           ERCPLAN
  4164         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4165         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4166     12  FILLER                            PIC X(24).             ERCPLAN
  4167     12  PLAN-MISC.                                               ERCPLAN
  4168         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4169         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4170         16  PL-IG                         PIC X.                 ERCPLAN
  4171         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4172         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4173         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4174         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4175         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4176         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4177         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4178         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4179                                                                  ERCPLAN
  4180         16  FILLER                        PIC X(99).             ERCPLAN
  4181******************************************************************ERCPLAN
  4182 FD  ERFORM.
* 4183                                 COPY ERCFORM.
  4184******************************************************************04/29/98
  4185*                                                                *ERCFORM
  4186*                                                                *ERCFORM
  4187*                            ERCFORM.                            *   LV002
  4188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4189*                            VMOD=2.003                          *   CL**2
  4190*                                                                *ERCFORM
  4191*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4192*                                                                *ERCFORM
  4193*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4194*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4195*                                                                *ERCFORM
  4196*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4197*                                                                *ERCFORM
  4198*    LOG = YES                                                   *ERCFORM
  4199*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4200******************************************************************ERCFORM
  4201 01  FORM-MASTER.                                                 ERCFORM
  4202    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4203        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4204                                                                  ERCFORM
  4205    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4206        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4207        16  FO-STATE                 PIC X(02).                   ERCFORM
  4208        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4209        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4210                                                                  ERCFORM
  4211    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4212        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4213        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4214        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4215        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4216        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4217        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4218        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4219        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4220        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4221        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4222        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4223        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4224        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4225        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4226        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4227        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4228                                                                  ERCFORM
  4229    12  FILLER                       PIC X(29).                   ERCFORM
  4230                                                                  ERCFORM
  4231    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4232        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4233            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4234            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4235            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4236            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4237                                     PIC X.                       ERCFORM
  4238                                                                  ERCFORM
  4239    12  FILLER                       PIC X(30).                   ERCFORM
  4240                                                                  ERCFORM
  4241    12  FO-COMMENTS-AREA.                                         ERCFORM
  4242        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4243                                                                  ERCFORM
  4244    12  FILLER                       PIC X(20).                   ERCFORM
  4245                                                                  ERCFORM
  4246    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4247        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4248        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4249        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4250
  4251 FD  PRINT-FILE
* 4252                                 COPY ELCPRTFD.
  4253******************************************************************04/15/98
  4254*                                                                *ELCPRTFD
  4255*                                                                *ELCPRTFD
  4256*                            ELCPRTFD.                           *   LV003
  4257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4258*                            VMOD=2.006                          *ELCPRTFD
  4259******************************************************************ELCPRTFD
  4260     RECORDING MODE F                                             ELCPRTFD
  4261     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4262     BLOCK CONTAINS 0 RECORDS
  4263     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4264 01  PRT.                                                         ELCPRTFD
  4265     12  P-CTL               PIC  X.                                 CL**2
  4266     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4267******************************************************************ELCPRTFD
  4268 FD  FICH
* 4269                                 COPY ELCFCHFD.
  4270******************************************************************04/15/98
  4271*                                                                *ELCFCHFD
  4272*                            ELCFCHFD.                           *   LV003
  4273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4274*                            VMOD=2.004                          *   CL**3
  4275*                                                                *ELCFCHFD
  4276******************************************************************ELCFCHFD
  4277     BLOCK CONTAINS 0 RECORDS
  4278     RECORDING MODE F.                                            ELCFCHFD
  4279                                                                  ELCFCHFD
  4280 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4281******************************************************************ELCFCHFD
  4282
  4283 FD  ELREPT.
* 4284                                 COPY ELCREPT.
  4285******************************************************************04/15/98
  4286*                                                                *ELCREPT
  4287*                                                                *ELCREPT
  4288*                            ELCREPT.                            *   LV002
  4289*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4290*                            VMOD=2.002                          *   CL**2
  4291*                                                                *ELCREPT
  4292*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4293*                                                                *ELCREPT
  4294*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4295*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4296*                                                                *ELCREPT
  4297*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4298*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4299*                                                                *ELCREPT
  4300*   LOG = NO                                                     *ELCREPT
  4301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4302******************************************************************ELCREPT
  4303 01  REPORT-SAVE-FILE.                                            ELCREPT
  4304     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4305         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4306                                                                  ELCREPT
  4307     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4308         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4309         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4310             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4311             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4312         16  RF-REPORT-ID.                                        ELCREPT
  4313             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4314                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4315                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4316             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4317         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4318     12  RF-REPORT-LINE-133.                                      ELCREPT
  4319         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4320         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4321         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4322             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4323             20  FILLER              PIC X(52).                   ELCREPT
  4324         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4325             20  FILLER              PIC X(53).                   ELCREPT
  4326             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4327     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4328         16  FILLER                  PIC X.                       ELCREPT
  4329         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4330         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4331         16  FILLER                  PIC X(115).                  ELCREPT
  4332         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4333******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  80
* EL517.cbl
  4335
  4336 FD  ERRESS.
* 4337                                 COPY ERCRESS.
  4338******************************************************************04/29/98
  4339*                                                                *ERCRESS
  4340*                            ERCRESS                             *   LV002
  4341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4342*                            VMOD=2.002                          *   CL**2
  4343*                                                                *ERCRESS
  4344*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4345*                                                                *ERCRESS
  4346*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4347*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4348*                                                                *ERCRESS
  4349*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4350*                                                                *ERCRESS
  4351*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4352*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4353*                                                                *ERCRESS
  4354*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4355*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4356*                                                                *ERCRESS
  4357*   LOG = NO                                                     *ERCRESS
  4358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4359*                                                                *ERCRESS
  4360*                                                                *ERCRESS
  4361******************************************************************ERCRESS
  4362                                                                  ERCRESS
  4363 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4364                                                                  ERCRESS
  4365     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4366         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4367         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4368         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4369         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4370*                                      YYYYMMDD                   ERCRESS
  4371*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4372                                                                  ERCRESS
  4373     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4374                                                                  ERCRESS
  4375         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4376         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4377         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4378         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4379                                                                  ERCRESS
  4380     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4381         88 RECALC                VALUE 'Y'.                      ERCRESS
  4382         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4383     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4384     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4385     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4386*                                      YYYYMMDD                   ERCRESS
  4387
  4388 FD  ERRESC.
* 4389                                 COPY ERCRESC.
  4390******************************************************************04/29/98
  4391*                                                                *ERCRESC
  4392*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4394*                            VMOD=2.003                          *   CL**2
  4395*                                                                *ERCRESC
  4396*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4397*                                                                *ERCRESC
  4398*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4399*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4400*                                                                *ERCRESC
  4401*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4402*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4403*                                                                *ERCRESC
  4404*   LOG = NO                                                     *ERCRESC
  4405*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4406*                                                                *ERCRESC
  4407******************************************************************ERCRESC
  4408                                                                  ERCRESC
  4409 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4410                                                                  ERCRESC
  4411     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4412         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4413         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4414         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4415         15  RESC-STATE                PIC   XX.                  ERCRESC
  4416         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4417         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4418         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4419         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4420*                                           YYYYMMDD              ERCRESC
  4421     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4422                                                                  ERCRESC
  4423     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4424         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4425             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4426             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4427             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4428                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4429                                                                  ERCRESC
  4430     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4431     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4432     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4433*                                          YYYYMMDD               ERCRESC
  4434
  4435 FD  ERCOMP.
* 4436                                 COPY ERCCOMP.
  4437******************************************************************
  4438*                                                                *
  4439*                                                                *
  4440*                            ERCCOMP                             *
  4441*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4442*                            VMOD=2.019                          *
  4443*                                                                *
  4444*   ONLINE CREDIT SYSTEM                                         *
  4445*                                                                *
  4446*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4447*                                                                *
  4448*   FILE TYPE = VSAM,KSDS                                        *
  4449*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4450*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4451*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4452*       ALTERNATE PATH = NONE                                    *
  4453*                                                                *
  4454*   LOG = NO                                                     *
  4455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4456*                                                                *
  4457******************************************************************
  4458*                   C H A N G E   L O G
  4459*
  4460* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4461*-----------------------------------------------------------------
  4462*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4463* EFFECTIVE    NUMBER
  4464*-----------------------------------------------------------------
  4465* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4466* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4467* 092205    2005050300006  PEMA  ADD LEASE FEE
  4468* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4469* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4470* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4471* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4472* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4473* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4474******************************************************************
  4475
  4476 01  COMPENSATION-MASTER.
  4477     12  CO-RECORD-ID                          PIC XX.
  4478         88  VALID-CO-ID                          VALUE 'CO'.
  4479
  4480     12  CO-CONTROL-PRIMARY.
  4481         16  CO-COMPANY-CD                     PIC X.
  4482         16  CO-CONTROL.
  4483             20  CO-CTL-1.
  4484                 24  CO-CARR-GROUP.
  4485                     28  CO-CARRIER            PIC X.
  4486                     28  CO-GROUPING.
  4487                         32  CO-GROUP-PREFIX   PIC XXX.
  4488                         32  CO-GROUP-PRIME    PIC XXX.
  4489                 24  CO-RESP-NO.
  4490                     28  CO-RESP-PREFIX        PIC X(4).
  4491                     28  CO-RESP-PRIME         PIC X(6).
  4492             20  CO-CTL-2.
  4493                 24  CO-ACCOUNT.
  4494                     28  CO-ACCT-PREFIX        PIC X(4).
  4495                     28  CO-ACCT-PRIME         PIC X(6).
  4496         16  CO-TYPE                           PIC X.
  4497             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4498             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4499             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4500
  4501     12  CO-MAINT-INFORMATION.
  4502         16  CO-LAST-MAINT-DT                  PIC XX.
  4503         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4504         16  CO-LAST-MAINT-USER                PIC X(4).
  4505     12  FILLER                                PIC XX.
  4506     12  CO-STMT-TYPE                          PIC XXX.
  4507     12  CO-COMP-TYPE                          PIC X.
  4508         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4509     12  CO-STMT-OWNER                         PIC X(4).
  4510     12  CO-BALANCE-CONTROL                    PIC X.
  4511         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4512         88  CO-NO-BALANCE                        VALUE 'N'.
  4513
  4514     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4515         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4516         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4517         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4518
  4519     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4520         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4521         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4522
  4523     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4524     12  CO-GA-DIRECT-DEP                      PIC X.
  4525     12  CO-FUTURE-SPACE                       PIC X.
  4526         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4527
  4528     12  CO-ACCT-NAME                          PIC X(30).
  4529     12  CO-MAIL-NAME                          PIC X(30).
  4530     12  CO-ADDR-1                             PIC X(30).
  4531     12  CO-ADDR-2                             PIC X(30).
  4532     12  CO-ADDR-3.
  4533         16  CO-ADDR-CITY                      PIC X(27).
  4534         16  CO-ADDR-STATE                     PIC XX.
  4535     12  CO-CSO-1099                           PIC X.
  4536     12  CO-ZIP.
  4537         16  CO-ZIP-PRIME.
  4538             20  CO-ZIP-PRI-1ST                PIC X.
  4539                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4540             20  FILLER                        PIC X(4).
  4541         16  CO-ZIP-PLUS4                      PIC X(4).
  4542     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4543         16  CO-CAN-POSTAL-1                   PIC XXX.
  4544         16  CO-CAN-POSTAL-2                   PIC XXX.
  4545         16  FILLER                            PIC XXX.
  4546     12  CO-SOC-SEC                            PIC X(13).
  4547     12  CO-TELEPHONE.
  4548         16  CO-AREA-CODE                      PIC XXX.
  4549         16  CO-PREFIX                         PIC XXX.
  4550         16  CO-PHONE                          PIC X(4).
  4551
  4552     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4553
  4554     12  CO-AR-BAL-LEVEL                       PIC X.
  4555         88  CO-AR-REF-LVL                        VALUE '1'.
  4556         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4557         88  CO-AR-BILL-LVL                       VALUE '2'.
  4558         88  CO-AR-AGT-LVL                        VALUE '3'.
  4559         88  CO-AR-FR-LVL                         VALUE '4'.
  4560
  4561     12  CO-AR-NORMAL-PRINT                    PIC X.
  4562         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4563         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4564
  4565     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4566
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4567     12  CO-AR-REPORTING                       PIC X.
  4568         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4569         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4570
  4571     12  CO-AR-PULL-CHECK                      PIC X.
  4572         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4573         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4574
  4575     12  CO-AR-BALANCE-PRINT                   PIC X.
  4576         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4577
  4578     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4579         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4580         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4581         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4582
  4583     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4584
  4585     12  CO-USER-CODE                          PIC X.
  4586     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4587
  4588******************************************************************
  4589*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4590*    THE LAST MONTH END RUN.
  4591******************************************************************
  4592
  4593     12  CO-LAST-ACTIVITY-DATE.
  4594         16  CO-ACT-YEAR                       PIC 99.
  4595         16  CO-ACT-MONTH                      PIC 99.
  4596         16  CO-ACT-DAY                        PIC 99.
  4597
  4598     12  CO-LAST-STMT-DT.
  4599         16  CO-LAST-STMT-YEAR                 PIC 99.
  4600         16  CO-LAST-STMT-MONTH                PIC 99.
  4601         16  CO-LAST-STMT-DAY                  PIC 99.
  4602
  4603     12  CO-MO-END-TOTALS.
  4604         16  CO-MONTHLY-TOTALS.
  4605             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4606             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4607             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4608             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4609             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4610
  4611         16  CO-AGING-TOTALS.
  4612             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4613             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4614             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4615             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4616
  4617         16  CO-YTD-TOTALS.
  4618             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4619             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4620
  4621         16  CO-OVER-UNDER-TOTALS.
  4622             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4623             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4624
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4625     12  CO-MISCELLANEOUS-TOTALS.
  4626         16  CO-FICA-TOTALS.
  4627             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4628             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4629
  4630         16  CO-CLAIM-TOTALS.
  4631             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4632             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4633
  4634******************************************************************
  4635*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4636*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4637******************************************************************
  4638
  4639     12  CO-CURRENT-TOTALS.
  4640         16  CO-CURRENT-LAST-STMT-DT.
  4641             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4642             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4643             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4644
  4645         16  CO-CURRENT-MONTHLY-TOTALS.
  4646             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4647             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4648             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4649             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4650             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4651
  4652         16  CO-CURRENT-AGING-TOTALS.
  4653             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4654             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4655             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4656             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4657
  4658         16  CO-CURRENT-YTD-TOTALS.
  4659             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4660             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4661
  4662     12  CO-PAID-COMM-TOTALS.
  4663         16  CO-YTD-PAID-COMMS.
  4664             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4665             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4666
  4667     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4668         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4669         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4670
  4671     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4672         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4673         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4674         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4675         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4676         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4677         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4678         88  CO-FINAL-LETTER                  VALUE 'F'.
  4679         88  CO-RECONCILING                   VALUE 'R'.
  4680         88  CO-PHONE-CALL                    VALUE 'P'.
  4681         88  CO-LEGAL                         VALUE 'L'.
  4682         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4683         88  CO-WRITE-OFF                     VALUE 'W'.
  4684         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4685
  4686     12  CO-CSR-CODE                       PIC X(4).
  4687
  4688     12  CO-GA-STATUS-INFO.
  4689         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4690         16  CO-GA-TERMINATION-DT          PIC XX.
  4691         16  CO-GA-STATUS-CODE             PIC X.
  4692             88  CO-GA-ACTIVE                 VALUE 'A'.
  4693             88  CO-GA-INACTIVE               VALUE 'I'.
  4694             88  CO-GA-PENDING                VALUE 'P'.
  4695         16  CO-GA-COMMENTS.
  4696             20  CO-GA-COMMENT-1           PIC X(40).
  4697             20  CO-GA-COMMENT-2           PIC X(40).
  4698             20  CO-GA-COMMENT-3           PIC X(40).
  4699             20  CO-GA-COMMENT-4           PIC X(40).
  4700
  4701     12  CO-RPTCD2                         PIC X(10).
  4702     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4703         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4704         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4705
  4706     12  CO-TYPE-AGENT                     PIC X(01).
  4707         88  CO-CORPORATION                   VALUE 'C'.
  4708         88  CO-PARTNERSHIP                   VALUE 'P'.
  4709         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4710         88  CO-TRUST                         VALUE 'T'.
  4711         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4712
  4713     12  CO-FAXNO.
  4714         16  CO-FAX-AREA-CODE                  PIC XXX.
  4715         16  CO-FAX-PREFIX                     PIC XXX.
  4716         16  CO-FAX-PHONE                      PIC X(4).
  4717
  4718     12  CO-BANK-INFORMATION.
  4719         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4720         16  CO-BANK-TRANSIT-NON REDEFINES
  4721             CO-BANK-TRANSIT-NO                PIC 9(8).
  4722
  4723         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4724     12  CO-MISC-DEDUCT-INFO REDEFINES
  4725                  CO-BANK-INFORMATION.
  4726         16  CO-MD-GL-ACCT                     PIC X(10).
  4727         16  CO-MD-DIV                         PIC XX.
  4728         16  CO-MD-CENTER                      PIC X(4).
  4729         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4730         16  CO-CREATE-AP-CHECK                PIC X.
  4731         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4732         16  FILLER                            PIC XXX.
  4733     12  CO-ACH-STATUS                         PIC X.
  4734         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4735         88  CO-ACH-PENDING                        VALUE 'P'.
  4736
  4737     12  CO-BILL-SW                            PIC X.
  4738     12  CO-CONTROL-NAME                       PIC X(30).
  4739     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4740     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4741     12  CO-CLP-STATE                          PIC XX.
  4742     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4743     12  CO-SPP-REFUND-EDIT                    PIC X.
  4744
  4745******************************************************************
  4746
  4747 FD  ERLOFC.
* 4748                                 COPY ERCLOFC.
  4749******************************************************************12/04/92
  4750*                                                                *ERCLOFC
  4751*                                                                *ERCLOFC
  4752*                            ERCLOFC                             *   LV002
  4753*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4754*                            VMOD=2.003                          *   CL**2
  4755*                                                                *ERCLOFC
  4756*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4757*                                                                *ERCLOFC
  4758*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4759*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4760*                                                                *ERCLOFC
  4761*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4762*                                                                *ERCLOFC
  4763*   LOG = YES                                                    *ERCLOFC
  4764*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4765*                                                                *ERCLOFC
  4766******************************************************************ERCLOFC
  4767                                                                  ERCLOFC
  4768 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4769     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4770         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4771                                                                  ERCLOFC
  4772     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4773         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4774         16  LO-CARRIER              PIC X.                       ERCLOFC
  4775         16  LO-GROUPING.                                         ERCLOFC
  4776             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4777             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4778         16  LO-STATE                PIC XX.                      ERCLOFC
  4779         16  LO-ACCOUNT.                                          ERCLOFC
  4780             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4781             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4782         16  LO-OFFICER-CODE         PIC X(5).
  4783                                                                  ERCLOFC
  4784     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4785                                                                  ERCLOFC
  4786     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4787     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4788     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4789                                                                  ERCLOFC
  4790     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4791             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4792             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4793     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4794             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4795             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4796                                                                  ERCLOFC
  4797     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4798     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4799     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4800                                                                  ERCLOFC
  4801     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4802     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4803                                                                  ERCLOFC
  4804     12  LO-OFFICER-INFO.                                         ERCLOFC
  4805         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4806             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4807             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4808             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4809             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4810             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4811             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4812             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4813             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4814     12  FILLER                      PIC X(198).
  4815******************************************************************ERCLOFC
  4816
  4817 FD  ERBXRF.
* 4818                                 COPY ERCBXRF.
  4819******************************************************************04/29/98
  4820*                                                                *ERCBXRF
  4821*                                                                *ERCBXRF
  4822*                            ERCBXRF                             *   LV002
  4823*                                                                *ERCBXRF
  4824*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4825*                                                                *ERCBXRF
  4826*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4827*                                                                *ERCBXRF
  4828*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4829*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4830*                                                                *ERCBXRF
  4831*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4832*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4833*                                                                *ERCBXRF
  4834*   LOG = NO                                                     *ERCBXRF
  4835*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4836*                                                                *ERCBXRF
  4837******************************************************************ERCBXRF
  4838                                                                  ERCBXRF
  4839 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4840     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4841         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4842                                                                  ERCBXRF
  4843     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4844         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4845         16  BK-CARRIER              PIC X.                       ERCBXRF
  4846         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4847         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4848                                                                  ERCBXRF
  4849     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4850         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4851         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4852         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4853         16  FILLER                  PIC X(9).                    ERCBXRF
  4854                                                                  ERCBXRF
  4855     12  FILLER                      PIC X(37).                   ERCBXRF
  4856                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4857     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4858                                                                  ERCBXRF
  4859     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4860                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4861         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4862         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4863         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4864         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4865         16  FILLER                  PIC X(20).                   ERCBXRF
  4866                                                                  ERCBXRF
  4867******************************************************************ERCBXRF
  4868
  4869 FD  ERAGTC.
* 4870                                 COPY ERCAGTC.
  4871******************************************************************
  4872*                                                                *
  4873*                                                                *
  4874*                            ERCAGTC                             *
  4875*                            VMOD=2.001                          *
  4876*                                                                *
  4877*   ONLINE CREDIT SYSTEM                                         *
  4878*                                                                *
  4879*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4880*                                                                *
  4881*   FILE TYPE = VSAM,KSDS                                        *
  4882*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4883*                                                                *
  4884*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4885*       ALTERNATE PATH = NONE                                    *
  4886*                                                                *
  4887*   LOG = NO                                                     *
  4888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4889*                                                                *
  4890******************************************************************
  4891*                   C H A N G E   L O G
  4892*
  4893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4894*-----------------------------------------------------------------
  4895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4896* EFFECTIVE    NUMBER
  4897*-----------------------------------------------------------------
  4898* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4899* 111004                         NEW FILE AND COPYBOOK
  4900* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4901******************************************************************
  4902
  4903 01  AGENT-COMMISSIONS.
  4904     12  AG-RECORD-ID                          PIC XX.
  4905         88  VALID-CO-ID                          VALUE 'AG'.
  4906
  4907     12  AG-CONTROL-PRIMARY.
  4908         16  AG-COMPANY-CD                     PIC X.
  4909         16  AG-CONTROL.
  4910             20  AG-CTL-1.
  4911                 24  AG-CARR-GROUP.
  4912                     28  AG-CARRIER            PIC X.
  4913                     28  AG-GROUPING           PIC X(6).
  4914                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4915             20  AG-CTL-2.
  4916                 24  AG-EXP-DT                 PIC XX.
  4917         16  AG-TYPE                           PIC X.
  4918             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4919             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4920
  4921     12  AG-MAINT-INFORMATION.
  4922         16  AG-LAST-MAINT-DT                  PIC XX.
  4923         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4924         16  AG-LAST-MAINT-USER                PIC X(4).
  4925         16  FILLER                            PIC X(10).
  4926
  4927     12  AG-EFF-DT                             PIC XX.
  4928     12  AG-COMM-STRUCTURE.
  4929         16  AG-AGT-COMMS OCCURS 10.
  4930             20  AG-AGT                PIC X(10).
  4931             20  AG-COM-TYP            PIC X.
  4932             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4933             20  AG-RECALC-LV-INDIC    PIC X.
  4934             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4935             20  AG-LRCALC-LV-INDIC    PIC X.
  4936             20  FILLER                PIC X(05).
  4937
  4938     12  FILLER                  PIC X(145).
  4939******************************************************************
  4940
  4941 FD  ELCRTT.
* 4942                                 COPY ELCCRTT.
  4943******************************************************************
  4944*                                                                *ELCCRTT
  4945*                            ELCCRTT.                            *
  4946*                                                                *ELCCRTT
  4947*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4948*                                                                *ELCCRTT
  4949*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4950*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4951*                                                                *ELCCRTT
  4952*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4953*                                                                *ELCCRTT
  4954*   LOG = YES                                                    *ELCCRTT
  4955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4956******************************************************************
  4957*                   C H A N G E   L O G
  4958*
  4959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4960*-----------------------------------------------------------------
  4961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4962* EFFECTIVE    NUMBER
  4963*-----------------------------------------------------------------
  4964* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4965* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4966* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4967* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4968******************************************************************
  4969                                                                  ELCCRTT
  4970 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4971     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  4972         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4973                                                                  ELCCRTT
  4974     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  4975         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  4976         16  CS-CARRIER                    PIC X.                 ELCCRTT
  4977         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  4978         16  CS-STATE                      PIC XX.                ELCCRTT
  4979         16  CS-ACCOUNT                    PIC X(10).
  4980         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  4981         16  CS-CERT-NO.                                          ELCCRTT
  4982             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  4983             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  4984         16  CS-TRAILER-TYPE               PIC X.
  4985             88  COMM-TRLR           VALUE 'A'.
  4986             88  FUTURE-TRLR         VALUE 'B'.
  4987             88  CERT-DATA-TRLR      VALUE 'C'.
  4988                                                                  ELCCRTT
  4989     12  CS-DATA-AREA                      PIC X(516).
  4990
  4991     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4992         16  CS-BANK-COMMISSION-AREA.
  4993             20  CS-BANK-COMMS       OCCURS 10.
  4994                 24  CS-AGT                PIC X(10).
  4995                 24  CS-COM-TYP            PIC X.
  4996                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4997                 24  CS-RECALC-LV-INDIC    PIC X.
  4998                 24  FILLER                PIC X(10).
  4999
  5000         16  FILLER                        PIC X(256).
  5001
  5002     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5003         16  CS-VIN-NUMBER                 PIC X(17).
  5004         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5005         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5006         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5007         16  FILLER                        PIC X(496).
  5008
  5009******************************************************************ELCCRTT
  5010
  5011 FD  ERPDEF.
  5012
* 5013                                 COPY ERCPDEF.
  5014******************************************************************
  5015*                                                                *
  5016*                                                                *
  5017*                            ERCPDEF.                            *
  5018*                                                                *
  5019*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5020*                                                                *
  5021*    FILE TYPE = VSAM,KSDS                                       *
  5022*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5023*                                                                *
  5024*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5025*                                                                *
  5026*    LOG = YES                                                   *
  5027*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5028******************************************************************
  5029 01  PRODUCT-MASTER.
  5030    12  PD-RECORD-ID                 PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  92
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5031        88  VALID-PD-ID                  VALUE 'PD'.
  5032
  5033    12  PD-CONTROL-PRIMARY.
  5034        16  PD-COMPANY-CD            PIC X.
  5035        16  PD-STATE                 PIC XX.
  5036        16  PD-PRODUCT-CD            PIC XXX.
  5037        16  PD-FILLER                PIC X(7).
  5038        16  PD-BEN-TYPE              PIC X.
  5039        16  PD-BEN-CODE              PIC XX.
  5040        16  PD-PROD-EXP-DT           PIC XX.
  5041
  5042    12  FILLER                       PIC X(50).
  5043
  5044    12  PD-PRODUCT-DATA OCCURS 8.
  5045        16  PD-PROD-CODE             PIC X.
  5046            88  PD-PROD-LIFE           VALUE 'L'.
  5047            88  PD-PROD-PROP           VALUE 'P'.
  5048            88  PD-PROD-AH             VALUE 'A'.
  5049            88  PD-PROD-IU             VALUE 'I'.
  5050            88  PD-PROD-GAP            VALUE 'G'.
  5051        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5052        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5053        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5054        16  PD-MAX-TERM              PIC S999        COMP-3.
  5055        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5056        16  FILLER                   PIC X.
  5057        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5058        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5059        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5060        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5061        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5062        16  PD-REC-CRIT-PERIOD       PIC X.
  5063        16  PD-RTW-MOS               PIC 99.
  5064        16  FILLER                   PIC X(5).
  5065
  5066    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5067
  5068    12  PD-TERM-LIMITS OCCURS 15.
  5069        16  PD-LOW-TERM              PIC S999        COMP-3.
  5070        16  PD-HI-TERM               PIC S999        COMP-3.
  5071
  5072*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5073    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5074        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5075        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5076
  5077    12  PD-EARN-FACTORS.
  5078        16  FILLER OCCURS 15.
  5079            20  FILLER OCCURS 15.
  5080                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5081
  5082    12  PD-PRODUCT-DESC              PIC X(80).
  5083    12  PD-TRUNCATED                 PIC X.
  5084    12  FILLER                       PIC X(59).
  5085
  5086    12  PD-MAINT-INFORMATION.
  5087        16  PD-LAST-MAINT-DT         PIC X(02).
  5088        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  93
* EL517.cbl
  5089        16  PD-LAST-MAINT-BY         PIC X(04).
  5090
  5091 FD  ELSTAT.
  5092
* 5093                                 COPY ELCSTATE.
  5094******************************************************************
  5095*                                                                *
  5096*                                                                *
  5097*                            ELCSTATE.                           *
  5098*                                                                *
  5099*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5100*                                                                *
  5101*   FILE TYPE = VSAM,KSDS                                        *
  5102*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5103*                                                                *
  5104*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5105*       ALTERNATE INDEX = NONE                                   *
  5106*                                                                *
  5107*   LOG = YES                                                    *
  5108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5109******************************************************************
  5110*                   C H A N G E   L O G
  5111*
  5112* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5113*-----------------------------------------------------------------
  5114*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5115* EFFECTIVE    NUMBER
  5116*-----------------------------------------------------------------
  5117* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5118******************************************************************
  5119*
  5120 01  STATE-FILE.
  5121     12  SF-RECORD-ID                       PIC XX.
  5122         88  VALID-CF-ID                        VALUE 'SF'.
  5123
  5124     12  SF-CONTROL-PRIMARY.
  5125         16  SF-COMPANY-ID                  PIC XXX.
  5126         16  SF-CARRIER-CODE                PIC X.
  5127         16  SF-GROUPING                    PIC X(6).
  5128         16  SF-STATE-CODE                  PIC XX.
  5129         16  SF-EXPIRE-DATE                 PIC 9(8).
  5130
  5131****************************************************************
  5132*             STATE CONTROLS
  5133****************************************************************
  5134
  5135     12  SF-LAST-MAINT-DT                   PIC XX.
  5136     12  SF-LAST-MAINT-BY                   PIC X(4).
  5137     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5138
  5139     12  SF-STATE-RT-CONTROLS.
  5140         16  SF-ST-RT-CALC                  PIC X.
  5141
  5142     12  SF-ST-TAX-CONTROLS.
  5143         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5144         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5145         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5146
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5147     12  SF-ST-REFUND-OPTIONS.
  5148         16  SF-ST-RF-LR-CALC               PIC X.
  5149         16  SF-ST-RF-LL-CALC               PIC X.
  5150         16  SF-ST-RF-LN-CALC               PIC X.
  5151         16  SF-ST-RF-AH-CALC               PIC X.
  5152         16  SF-ST-RF-CP-CALC               PIC X.
  5153
  5154     12  SF-ST-UNEARN-PREM-OPTIONS.
  5155         16  SF-ST-LUEP-R78                 PIC X.
  5156         16  SF-ST-LUEP-PRO                 PIC X.
  5157         16  SF-ST-LUEP-ST                  PIC X.
  5158         16  SF-ST-LUEP-DOM                 PIC X.
  5159         16  SF-ST-AUEP-R78                 PIC X.
  5160         16  SF-ST-AUEP-PRO                 PIC X.
  5161         16  SF-ST-AUEP-ST                  PIC X.
  5162         16  SF-ST-AUEP-DOM                 PIC X.
  5163         16  SF-ST-CUEP-R78                 PIC X.
  5164         16  SF-ST-CUEP-PRO                 PIC X.
  5165         16  SF-ST-CUEP-ST                  PIC X.
  5166         16  SF-ST-CUEP-DOM                 PIC X.
  5167
  5168     12  SF-ST-EARN-PREM-OPTIONS.
  5169         16  SF-ST-LEP-R78                  PIC X.
  5170         16  SF-ST-LEP-PRO                  PIC X.
  5171         16  SF-ST-LEP-ST                   PIC X.
  5172         16  SF-ST-LEP-DOM                  PIC X.
  5173         16  SF-ST-AEP-R78                  PIC X.
  5174         16  SF-ST-AEP-PRO                  PIC X.
  5175         16  SF-ST-AEP-ST                   PIC X.
  5176         16  SF-ST-AEP-DOM                  PIC X.
  5177         16  SF-ST-CEP-R78                  PIC X.
  5178         16  SF-ST-CEP-PRO                  PIC X.
  5179         16  SF-ST-CEP-ST                   PIC X.
  5180         16  SF-ST-CEP-DOM                  PIC X.
  5181
  5182     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5183
  5184 FD  ELCRTO.
  5185
* 5186                                 COPY ELCCRTO.
  5187******************************************************************
  5188*                                                                *
  5189*                            ELCCRTO.                            *
  5190*                                                                *
  5191*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5192*                                                                *
  5193*   FILE TYPE = VSAM,KSDS                                        *
  5194*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5195*                                                                *
  5196*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5197*                                                                *
  5198*   LOG = YES                                                    *
  5199*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5200******************************************************************
  5201*                   C H A N G E   L O G
  5202*
  5203* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5204*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5205*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5206* EFFECTIVE    NUMBER
  5207*-----------------------------------------------------------------
  5208* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5209* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5210* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5211* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5212* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5213******************************************************************
  5214
  5215 01  ORIGINAL-CERTIFICATE.
  5216     12  OC-RECORD-ID                      PIC XX.
  5217         88  VALID-OC-ID                      VALUE 'OC'.
  5218
  5219     12  OC-CONTROL-PRIMARY.
  5220         16  OC-COMPANY-CD                 PIC X.
  5221         16  OC-CARRIER                    PIC X.
  5222         16  OC-GROUPING                   PIC X(6).
  5223         16  OC-STATE                      PIC XX.
  5224         16  OC-ACCOUNT                    PIC X(10).
  5225         16  OC-CERT-EFF-DT                PIC XX.
  5226         16  OC-CERT-NO.
  5227             20  OC-CERT-PRIME             PIC X(10).
  5228             20  OC-CERT-SFX               PIC X.
  5229         16  OC-RECORD-TYPE                PIC X.
  5230         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5231
  5232     12  OC-LAST-MAINT-DT                  PIC XX.
  5233     12  OC-LAST-MAINT-BY                  PIC X(4).
  5234     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5235
  5236     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5237     12  FILLER                            PIC X(49).
  5238
  5239     12  OC-ORIG-REC.
  5240         16  OC-INS-LAST-NAME              PIC X(15).
  5241         16  OC-INS-FIRST-NAME             PIC X(10).
  5242         16  OC-INS-MIDDLE-INIT            PIC X.
  5243         16  OC-INS-AGE                    PIC S999     COMP-3.
  5244         16  OC-JNT-LAST-NAME              PIC X(15).
  5245         16  OC-JNT-FIRST-NAME             PIC X(10).
  5246         16  OC-JNT-MIDDLE-INIT            PIC X.
  5247         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5248         16  OC-LF-BENCD                   PIC XX.
  5249         16  OC-LF-TERM                    PIC S999      COMP-3.
  5250         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5251         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5252         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5253         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5254         16  OC-LF-EXP-DT                  PIC XX.
  5255         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5256         16  OC-LF-CANCEL-DT               PIC XX.
  5257         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5258         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5259         16  OC-AH-BENCD                   PIC XX.
  5260         16  OC-AH-TERM                    PIC S999      COMP-3.
  5261         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5262         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5263         16  OC-AH-EXP-DT                  PIC XX.
  5264         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5265         16  OC-AH-CP                      PIC 99.
  5266         16  OC-AH-CANCEL-DT               PIC XX.
  5267         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5268         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5269         16  OC-CRED-BENE-NAME             PIC X(25).
  5270         16  OC-1ST-PMT-DT                 PIC XX.
  5271         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5272         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5273         16  OC-ISSUE-TRAN-IND             PIC X.
  5274         16  OC-CANCEL-TRAN-IND            PIC X.
  5275         16  FILLER                        PIC X(211).
  5276
  5277     12  FILLER                            PIC X(50).
  5278
  5279******************************************************************
  5280
  5281 WORKING-STORAGE SECTION.
  5282 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5283 77  FILLER   PIC X(32) VALUE '********************************'.
  5284 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5285 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5286
  5287 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5288 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5289 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5290 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5291
  5292 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5293 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5294 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5295 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5296 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5297 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5298 77  X                      PIC X                  VALUE ' '.
  5299 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5300
  5301 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5302 01  TRAN-CX REDEFINES TRAN-CT.
  5303     12  FILLER             PIC XX.
  5304     12  TCX                PIC 999.
  5305 01  SEQ-NO                 PIC 9999               VALUE 0.
  5306 01  RPND                   PIC 9(5)               VALUE 0.
  5307 01  WPND                   PIC 9(5)               VALUE 0.
  5308 01  RREI                   PIC 9(5)               VALUE 0.
  5309 01  RCTB                   PIC 9(5)               VALUE 0.
  5310 01  RACC                   PIC 9(5)               VALUE 0.
  5311 01  RCER                   PIC 9(5)               VALUE 0.
  5312 01  RCNT                   PIC 9(5)               VALUE 0.
  5313 01  WCER                   PIC 9(5)               VALUE 0.
  5314 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5315 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5316 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5317 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5318 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5319 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5320 01  EMSG.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  97
* EL517.cbl
  5321     12  WS-FILE-ERROR-MESSAGE.
  5322         16  FILLER              PIC X(24)   VALUE
  5323             'ERROR OCCURED OPENING - '.
  5324         16  WS-FEM-FILE-NAME    PIC X(8).
  5325
  5326 01  CMSG.
  5327     12  WS-FILE-ERROR-MESSAGE.
  5328         16  FILLER              PIC X(24)   VALUE
  5329             'ERROR OCCURED CLOSING - '.
  5330         16  WS-CEM-FILE-NAME    PIC X(8).
  5331
  5332 01  RMSG.
  5333     12  WS-FILE-ERROR-MESSAGE.
  5334         16  FILLER              PIC X(24)   VALUE
  5335             'ERROR OCCURED READING - '.
  5336         16  WS-REM-FILE-NAME    PIC X(8).
  5337
  5338 01  HDG1.
  5339     12  FILLER                  PIC X(50)       VALUE ' '.
  5340     12  FILLER                  PIC X(28)       VALUE
  5341                   'PENDING BUSINESS FILE EDIT '.
  5342     12  ER-ONLY                 PIC X(47)       VALUE
  5343          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5344     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5345
  5346 01  HDG2.
  5347     12  FILLER              PIC X(52)              VALUE SPACE.
  5348     12  H2-COMP             PIC X(30).
  5349     12  FILLER              PIC X(42)              VALUE SPACE.
  5350     12  H2-DATE             PIC X(8).
  5351
  5352 01  HDG3.
  5353     12  FILLER              PIC X(54)              VALUE SPACE.
  5354     12  H3-DATE             PIC X(18).
  5355     12  FILLER              PIC X(49)              VALUE SPACE.
  5356
  5357 01  SUM1.
  5358     12  FILLER              PIC XX                 VALUE ' '.
  5359     12  SUM-TOT             PIC ZZ,ZZZ.
  5360     12  FILLER              PIC X(3)               VALUE SPACE.
  5361     12  FILLER              PIC X(30)              VALUE
  5362          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  98
* EL517.cbl
  5364
  5365 01  WX-AREA.
  5366     12  PH-COBOL            PIC X.
  5367     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5368
  5369 01  STATUS-SWITCH.
  5370     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5371     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5372     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5373     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5374     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5375     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5376     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5377     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5378     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5379     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5380     12  ERACCT-FILE-STATUS.
  5381         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5382         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5383     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5384     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5385     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5386     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5387     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5388     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5389     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5390     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5391     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5392     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5393     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5394
  5395     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5396     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5397     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5398     12  WS-SW-1                  PIC X  VALUE ' '.
  5399     12  WS-SW-2                  PIC X  VALUE ' '.
  5400
  5401     12  WS-COMPUTED-TOTALS      COMP-3.
  5402         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5403         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5404         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5405         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5406         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5407         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5408         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5409         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5410         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5411         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5412     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5413         88  CO-HAS-CLAIMS                     VALUE '2'.
  5414
  5415     12  EIBDATE                 PIC S9(7)     COMP-3.
  5416
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  99
* EL517.cbl
  5418
  5419* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5420     COPY ELC50W1.
  5421******************************************************************04/19/98
  5422*                                                                *ELC50W1
  5423*                                                                *ELC50W1
  5424*                             ELC50W1                            *   LV005
  5425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5426*                            VMOD=2.004                          *   CL**5
  5427*                                                                *ELC50W1
  5428*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5429*                                                                *ELC50W1
  5430*                                                                *ELC50W1
  5431******************************************************************ELC50W1
  5432                                                                  ELC50W1
  5433     12  WK-WORK-AREA.                                            ELC50W1
  5434         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5435         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5436         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5437         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5438         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5439         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5440         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5441         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5442         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5443         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5444         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5445         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5446         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5447         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5448         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5449         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5450             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5451             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5452             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5453             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5454             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5455             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5456         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5457         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5458             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5459             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5460             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5461         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5462             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5463         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5464         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5465     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5466         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5467         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5468         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5469         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5470         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5471         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5472         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5473         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5474     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5475         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 100
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5476         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5477         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5478             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5479         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5480
  5481         16  WK-CONV-GREG.
  5482             24  WCG-CENT             PIC XX.
  5483             24  WCG-REST             PIC X(4).
  5484         16  WORK-GREGORIAN-DATE.
  5485             24  WK-GREG-CENT         PIC XX.
  5486             24  WK-GREG-DATE-YYMMDD.
  5487                 28  WK-GREG-YYMM     PIC X(4).
  5488                 28  WK-GREG-DD       PIC XX.
  5489
  5490         16  WORK-SELECT-DATE.
  5491             24  WK-SELECT-CENT           PIC XX.
  5492             24  WK-SELECT-DATE-YYMMDD.
  5493                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5494                 28  FILLER               PIC XX.
  5495
  5496         16  WK-FORM-NO.
  5497             24  WK-FORM-BANK-ID       PIC X(5).
  5498             24  WK-FORM-UNDRWRTR      PIC X(1).
  5499             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5500
  5501         16  WK-MEMBER-NO.
  5502             24  WK-MEMBER-1-6        PIC X(6).
  5503             24  WK-MEMBER-7-12       PIC X(6).
  5504
  5505         16  WK-FULL-CERT-NO.
  5506             24  WK-CERT-POS-1-2      PIC X(2).
  5507             24  WK-CERT-POS-3        PIC X(1).
  5508             24  WK-CERT-POS-4        PIC X(1).
  5509             24  WK-CERT-POS-5-6      PIC X(2).
  5510             24  WK-CERT-POS-7        PIC X(1).
  5511             24  WK-CERT-POS-8-11     PIC X(4).
  5512
  5513         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5514             88  VALID-RATE-CODE     VALUE 'Y'.
  5515             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5516
  5517     12  WK-BATCH-NO.
  5518         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5519         16  FILLER                   PIC XXX       VALUE SPACES.
  5520
* 5521                                  COPY ELCEDITC.
  5522******************************************************************04/15/98
  5523*                                                                *ELCEDITC
  5524*                                                                *ELCEDITC
  5525*                            ELCEDITC                            *   LV002
  5526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5527*                            VMOD=2.012                          *   CL**2
  5528*                                                                *ELCEDITC
  5529*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5530*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5531*                                                                *ELCEDITC
  5532******************************************************************ELCEDITC
  5533******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5534*                   C H A N G E   L O G
  5535*
  5536* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5537*-----------------------------------------------------------------
  5538*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5539* EFFECTIVE    NUMBER
  5540*-----------------------------------------------------------------
  5541* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5542******************************************************************
  5543                                                                  ELCEDITC
  5544     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5545         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5546         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5547         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5548         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5549         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5550         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5551         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5552         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5553         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5554         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5555               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5556               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5557               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5558               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5559                                                                  ELCEDITC
  5560         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5561               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5562               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5563               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5564               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5565               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5566               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5567               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5568               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5569               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5570               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5571                                                                  ELCEDITC
  5572         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5573               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5574               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5575               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5576               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5577               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5578               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5579               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5580               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5581                                                                  ELCEDITC
  5582         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5583                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5584                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5585                                                                  ELCEDITC
  5586         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5587                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5588                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5589                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5590                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5591                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5592                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5593                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5594                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5595                                                                  ELCEDITC
  5596         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5597               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5598               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5599                                                                  ELCEDITC
  5600         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5601         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5602         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5603         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5604         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5605                                                                  ELCEDITC
  5606         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5607               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5608               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5609               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5610               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5611                                                                  ELCEDITC
  5612         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5613               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5614               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5615               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5616               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5617                                                                  ELCEDITC
  5618         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5619                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5620                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5621                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5622                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5623                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5624                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5625                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5626                                                                  ELCEDITC
  5627         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5628                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5629                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5630                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5631                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5632                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5633                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5634                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5635                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5636                                                                  ELCEDITC
  5637         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5638                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5639                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5640                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5641                                                                  ELCEDITC
  5642         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5643                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5644                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5645                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5646                                                                  ELCEDITC
  5647         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5648         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5649         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5650         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5651                                                                  ELCEDITC
  5652         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5653         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5654                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5655                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5656                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5657                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5658                                                                  ELCEDITC
  5659         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5660               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5661               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5662               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5663               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5664               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5665                                                                  ELCEDITC
  5666         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5667               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5668               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5669               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5670               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5671               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5672                                                                  ELCEDITC
  5673         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5674                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5675                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5676                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5677                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5678                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5679                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5680                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5681                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5682                                                                  ELCEDITC
  5683         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5684                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5685                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5686                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5687                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5688                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5689                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5690                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5691                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5692                                                                  ELCEDITC
  5693         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5694         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5695         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5696         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5697         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5698         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5699         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5700         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5701         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5702         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5703         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5704         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5705                                                                  ELCEDITC
  5706         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5707                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5708                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5709                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5710                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5711                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5712                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5713                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5714                                                                  ELCEDITC
  5715         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5716                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5717                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5718                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5719                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5720                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5721                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5722                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5723                                                                  ELCEDITC
  5724         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5725                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5726                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5727                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5728                                                                  ELCEDITC
  5729         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5730         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5731         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5732         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5733         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5734         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5735         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5736         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5737         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5738                                                                  ELCEDITC
  5739         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5740         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5741         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5742         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5743         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5744         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5745         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5746         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5747         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5748         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5749         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5750         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5751         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5752         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5753         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5754                                                                  ELCEDITC
  5755         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5756             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5757                                             'M' '5' '9' '2'.     ELCEDITC
  5758             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5759             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5760             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5761             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5762             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5763             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5764             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5765             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5766             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5767             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5768                                                                  ELCEDITC
  5769         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5770             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5771                                             'M' '5' '9' '2'.     ELCEDITC
  5772             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5773             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5774             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5775             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5776             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5777             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5778             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5779             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5780             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5781             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5782                                                                  ELCEDITC
  5783         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5784         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5785         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5786         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5787         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5788                                                                  ELCEDITC
  5789*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5790*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5791         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5792                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5793                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5794                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5795                                                                  ELCEDITC
  5796         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5797         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5798         16  FILLER                    PIC X.                     ELCEDITC
  5799*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5800         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5801             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5802             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5803             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5804             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5805             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5806             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5807             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5808             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5809             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5810         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 106
* EL517.cbl
* 5812                                  COPY ELC50WS.
  5813*****************************************************************
  5814*                                                               *
  5815*                            ELC50WS.                           *
  5816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5817*                            VMOD=2.061.                        *
  5818*                                                               *
  5819*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5820*                                   EL517                       *
  5821*****************************************************************
  5822******************************************************************
  5823*                   C H A N G E   L O G
  5824*
  5825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5826*-----------------------------------------------------------------
  5827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5828* EFFECTIVE    NUMBER
  5829*-----------------------------------------------------------------
  5830* 123102                   PEMA  ADD DCC PROCESSING
  5831* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5832* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5833* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5834* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5835* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5836* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5837* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5838* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5839* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5840* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5841* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5842* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5843* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5844* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5845* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5846* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5847* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5848* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5849* 030309  CR2009021700001  PEMA  ADD ER-2883
  5850* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5851* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5852* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5853* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5854* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5855* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5856* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5857* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5858* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5859* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5860* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5861* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5862* 061412  CR2011022800001  AJRA  NAPERSOFT
  5863* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5864* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5865*-----------------------------------------------------------------
  5866
  5867 01  WORK-AREAS.
  5868
  5869*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 107
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5870*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5871*****************************************************************
  5872
  5873     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5874     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5875     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5876     12  WS-NAME-EDIT-WORK-AREA.
  5877         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5878         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5879             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5880         16  WS-WORK-NAME.
  5881             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5882             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5883             20  FILLER           PIC X(10)     VALUE SPACES.
  5884         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5885             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5886
  5887*****************************************************************
  5888*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5889*****************************************************************
  5890
  5891     12  WS-ERRESC-KEY.
  5892         16 WS-ERRESC-SEARCH-KEY.
  5893             20  WS-ERRESC-COMPANY-CD PIC  X.
  5894             20  WS-ERRESC-CARRIER    PIC  X.
  5895             20  WS-ERRESC-GROUP      PIC X(6).
  5896             20  WS-ERRESC-STATE      PIC XX.
  5897             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5898         16 WS-ERRESC-RESIDUAL-KEY.
  5899             20  WS-ERRESC-AGENT      PIC X(10).
  5900             20  WS-ERRESC-RES-STATE  PIC XX.
  5901             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5902*                                          YYYYMMDD
  5903     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5904     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5905
  5906*RESIDENT STATE TAX MASTER(ERRESS)
  5907*
  5908     12  WS-ERRESS-KEY.
  5909         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5910         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5911         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5912         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5913*                                          YYYYMMDD
  5914
  5915     12  WS-CONTRACT-DATE              PIC 9(8).
  5916*                                          YYYYMMDD
  5917     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5918     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5919         16 WS-YEAR-YY                 PIC   9999.
  5920         16 FILLER                     PIC 9(4).
  5921*                                          YYYYMMDD
  5922     12  WS-SAVE-ERRESS-KEY            PIC X(9).
  5923     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5924     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5925     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5926
  5927     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 108
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5928         88  DPRB-1ST-TIME                      VALUE ' '.
  5929
  5930*****************************************************************
  5931*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5932*****************************************************************
  5933
  5934     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5935     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5936     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5937     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5938     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5939     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5940     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5941     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5942     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5943     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5944         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5945         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5946     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5947         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5948         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5949     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5950
  5951     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5952     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  5953
  5954     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  5955     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  5956     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5957     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5958     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5959     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5960     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5961     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5962     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5963     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5964     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5965     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5966     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  5967     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  5968     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  5969     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  5970     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  5971     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  5972     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  5973     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  5974     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  5975     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  5976     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  5977     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  5978     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  5979     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  5980     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  5981     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  5982     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  5983     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  5984     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  5985     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 109
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5986     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  5987     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  5988     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  5989     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  5990     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  5991     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  5992     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  5993     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  5994     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  5995     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  5996     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  5997     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  5998     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  5999     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6000     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6001     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6002     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6003     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6004     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6005     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6006     12  WS-2671-SW               PIC X         VALUE SPACE.
  6007     12  WS-2672-SW               PIC X         VALUE SPACE.
  6008     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6009         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6010     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6011         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6012     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6013
  6014     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6015         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6016         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6017         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6018         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6019
  6020     12  WS-CREDIT-EDIT-CONTROLS.
  6021         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6022         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6023         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6024         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6025         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6026         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6027
  6028     12  WS-AGE-FIELDS.
  6029         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6030         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6031         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6032         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6033
  6034     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6035         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6036         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6037         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6038         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
  6039         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6040         16  FILLER                      PIC XX.
  6041
  6042     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
  6043     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 110
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6044     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6045     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6046     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6047     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6048     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6049     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6050     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6051     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6052
  6053     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6054     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6055     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6056     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6057     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6058     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6059     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6060     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6061         88  WS-REDUCING              VALUE 'R'.
  6062         88  WS-LEVEL                 VALUE 'L' 'P'.
  6063     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6064
  6065     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6066     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6067     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6068     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6069     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6070     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6071     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6072     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6073     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6074
  6075     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6076     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6077     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6078     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6079     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6080     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6081     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6082     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6083     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6084     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6085     12  WS-ACCT-SIG-SW.
  6086         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6087         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6088     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6089     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6090     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6091     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6092     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6093     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6094     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6095     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6096     12  WS-INITIALS.
  6097         16  WS-INIT-1            PIC X         VALUE SPACES.
  6098         16  WS-INIT-2            PIC X         VALUE SPACES.
  6099
  6100     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
  6101     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 111
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6102     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6103     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6104     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6105*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6106     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6107     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6108     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6109     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6110     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6111     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6112     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6113     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6114     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6115     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6116     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6117     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6118     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6119     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6120     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6121     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6122     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6123     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6124     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6125     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6126     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6127     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6128******** FLA
  6129     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6130     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6131     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6132     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6133     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6134********
  6135     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6136     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6137     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6138     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6139     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6140     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6141     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6142     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6143     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6144     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6145
  6146     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6147         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6148                                         '0' THRU '9'.
  6149
  6150     12  NUMBER-OF-MONTHS.
  6151         16  SK-MO OCCURS 12 TIMES PIC X.
  6152
  6153     12  WS-WORK-DATE.
  6154         16  WS-YEAR            PIC 99    VALUE 00.
  6155         16  WS-MONTH           PIC 99    VALUE 00.
  6156         16  WS-DAY             PIC 99    VALUE 00.
  6157
  6158     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
  6159     12  WS-WORK-CRIT-DEV       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 112
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6160         WS-WORK-LF-CRIT-PER    PIC X(03).
  6161
  6162     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6163     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6164
  6165     12  WS-WORK-DATE-FROM.
  6166         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6167         16  FILLER             PIC X  VALUE SPACE.
  6168         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6169         16  FILLER             PIC X         VALUE SPACE.
  6170         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6171
  6172     12  WS-WORK-DATE-THRU.
  6173         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6174         16  FILLER             PIC X         VALUE SPACE.
  6175         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6176         16  FILLER             PIC X         VALUE SPACE.
  6177         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6178
  6179     12  WS-LF-INPUT-CD.
  6180         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6181         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6182
  6183     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6184     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6185         16  WS-AH-INPUT-CD-1   PIC X.
  6186         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6187
  6188     12  WS-SWITCHES.
  6189         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6190         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6191             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6192         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6193             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6194         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6195             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6196         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6197             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6198         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6199             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6200         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6201             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6202         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6203             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6204         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6205             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6206         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6207             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6208         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6209             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6210         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6211             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6212         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
  6213             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6214         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6215             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6216         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
  6217             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 113
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6218         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6219             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6220         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6221             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6222         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6223             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6224         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6225             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6226         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6227             88  AH-BENEFIT-FOUND         VALUE ' '.
  6228             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6229         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6230             88  LF-BENEFIT-FOUND         VALUE ' '.
  6231             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6232         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6233             88  NO-STATE-RECORD          VALUE '1'.
  6234         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6235             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6236         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6237             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6238         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6239             88  CERT-WAS-FOUND           VALUE ' '.
  6240             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6241         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6242             88  BROWSE-STARTED           VALUE 'Y'.
  6243         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6244             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6245         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6246             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6247         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6248             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6249         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6250             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6251         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6252             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6253         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6254             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6255         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6256             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6257             88  FIRST-TIME-THROUGH       VALUE '1'.
  6258             88  CTBL-NOT-FOUND           VALUE '2'.
  6259
  6260         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6261             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6262
  6263         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6264             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6265
  6266********FLA
  6267     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6268     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6269********
  6270     12  RC-SW-1                  PIC X           VALUE '0'.
  6271     12  RC-SW-2                  PIC X           VALUE '0'.
  6272     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6273     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6274     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
  6275     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 114
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6276     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6277     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6278     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6279     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6280     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6281     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6282     12  LIT-SPACES               PIC X           VALUE SPACES.
  6283     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6284     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6285     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6286     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6287     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6288     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6289     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6290         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6291         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6292     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6293         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6294
  6295 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6296     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6297     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6298 01  WS-CRI-SSN-WORK-AREA.
  6299     05  WS-CRI-SOC-SEC-NO.
  6300         10  WS-SS-REPT-CD       PIC X(5).
  6301         10  WS-SS-LAST-NAME     PIC X(5).
  6302         10  WS-SS-INITIAL       PIC X.
  6303
  6304     05  WS-CRI-REPORT-CODE.
  6305         10  FILLER              PIC X(5).
  6306         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6307
  6308     05  WS-CRI-LAST-NAME.
  6309         10  WS-CRI-NAME-MOVE    PIC X(5).
  6310         10  FILLER              PIC X(10).
  6311
  6312 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6313     '12345678012345070923456789'.
  6314 01  FILLER REDEFINES WS-NUM-TABLE.
  6315     05  WS-NUM OCCURS 26        PIC 9.
  6316 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6317 01  V1                          PIC S999 COMP-3.
  6318 01  V2                          PIC S999 COMP-3.
  6319 01  V3                          PIC S999 COMP-3.
  6320 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6321 01  FILLER REDEFINES WS-WORK-VIN.
  6322     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6323 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6324 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6325 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6326 01  WS-HEX-WORK.
  6327     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6328     05  WS-HEX-BYTE             PIC X.
  6329 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6330 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6331
  6332 01  WS-WORK-HIN-ROW-B.
  6333     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 115
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6334
  6335 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6336 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6337     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6338 01  WS-ROW-D-TABLE.
  6339     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6340
  6341 01  WS-HIN-TABLE-B.
  6342     05  F                       PIC XX VALUE 'A2'.
  6343     05  F                       PIC XX VALUE 'B3'.
  6344     05  F                       PIC XX VALUE 'C4'.
  6345     05  F                       PIC XX VALUE 'D5'.
  6346     05  F                       PIC XX VALUE 'E6'.
  6347     05  F                       PIC XX VALUE 'F7'.
  6348     05  F                       PIC XX VALUE 'G8'.
  6349     05  F                       PIC XX VALUE 'H9'.
  6350     05  F                       PIC XX VALUE 'I1'.
  6351     05  F                       PIC XX VALUE 'J2'.
  6352     05  F                       PIC XX VALUE 'K3'.
  6353     05  F                       PIC XX VALUE 'L4'.
  6354     05  F                       PIC XX VALUE 'M5'.
  6355     05  F                       PIC XX VALUE 'N6'.
  6356     05  F                       PIC XX VALUE 'O0'.
  6357     05  F                       PIC XX VALUE 'P7'.
  6358     05  F                       PIC XX VALUE 'Q0'.
  6359     05  F                       PIC XX VALUE 'R8'.
  6360     05  F                       PIC XX VALUE 'S9'.
  6361     05  F                       PIC XX VALUE 'T2'.
  6362     05  F                       PIC XX VALUE 'U3'.
  6363     05  F                       PIC XX VALUE 'V4'.
  6364     05  F                       PIC XX VALUE 'W5'.
  6365     05  F                       PIC XX VALUE 'X6'.
  6366     05  F                       PIC XX VALUE 'Y7'.
  6367     05  F                       PIC XX VALUE 'Z8'.
  6368 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6369     05  WS-VAL-IN               PIC X.
  6370     05  WS-VAL-OUT              PIC 9.
  6371 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6372
  6373 01  WS-COMPARE-BINARY-DATES.
  6374     05  WS-971231                PIC XX VALUE X'92FF'.
  6375     05  WS-931231                PIC XX VALUE X'8CFF'.
  6376     05  WS-791231                PIC XX VALUE X'77FF'.
  6377     05  WS-771001                PIC XX VALUE X'74A1'.
  6378     05  WS-820301                PIC XX VALUE X'7B41'.
  6379     05  WS-831031                PIC XX VALUE X'7DBF'.
  6380     05  WS-831231                PIC XX VALUE X'7DFF'.
  6381     05  WS-810831                PIC XX VALUE X'7A7F'.
  6382     05  WS-830901                PIC XX VALUE X'7D81'.
  6383
  6384 01  FILE-ACCESS-IDS.
  6385     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6386     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6387     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6388     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6389     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6390     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
  6391     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 116
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6392     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6393     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6394     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6395     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6396     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6397     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6398     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6399     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6400     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6401     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6402
  6403 01  DD-IU-SW                    PIC X   VALUE ' '.
  6404     88  DD-IU-PRESENT                 VALUE 'Y'.
  6405
  6406 01  ACCESS-KEYS.
  6407     12  ELMSTR-KEY.
  6408         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6409         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6410     12  W-CLAIM-KEY.
  6411         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6412         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6413
  6414     12  ELCNTL-KEY.
  6415         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6416         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6417         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6418         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6419
  6420     12  ELCERT-KEY.
  6421         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6422         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6423         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6424         16  CERT-STATE           PIC XX      VALUE SPACES.
  6425         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6426         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6427         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6428
  6429     12  ELCERT2-KEY.
  6430         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6431         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6432
  6433     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6434
  6435     12  ELCERT-SAVE.
  6436         16  FILLER                      PIC XX    VALUE SPACES.
  6437
  6438         16  WCS-CONTROL-PRIMARY.
  6439             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6440             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6441             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6442             20  WCS-STATE               PIC XX    VALUE SPACES.
  6443             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6444             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6445             20  WCS-CERT-NO.
  6446                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6447                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6448
  6449         16  CS-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 117
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6450             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6451             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6452             20  CS-INSURED-INITIALS.
  6453                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6454                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6455
  6456         16  CS-CONTROL-BY-SSN.
  6457             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6458             20  CS-SOC-SEC-NO.
  6459                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6460                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6461                 24  CS-SSN-LN3.
  6462                     28 CS-INSURED-INITIALS-A2   PIC XX
  6463                                     VALUE SPACES.
  6464                     28 CS-PART-LAST-NAME-A2     PIC X
  6465                                     VALUE SPACE.
  6466
  6467         16  CS-CONTROL-BY-CERT-NO.
  6468             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6469             20  CS-CERT-NO-A4           PIC X(11)
  6470                                     VALUE SPACES.
  6471
  6472         16  CS-CONTROL-BY-MEMB.
  6473             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6474             20  CS-MEMBER-NO.
  6475                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6476                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6477                 24  CS-MEMB-LN4.
  6478                     28 CS-INSURED-INITIALS-A5   PIC XX
  6479                                      VALUE SPACES.
  6480                     28 CS-PART-LAST-NAME-A5     PIC XX
  6481                                      VALUE SPACES.
  6482
  6483         16  FILLER              PIC X(360) VALUE SPACES.
  6484
  6485     12  ERACCT-KEY.
  6486         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6487         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6488         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6489         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6490         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6491         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6492
  6493     12  ERCOMP-KEY.
  6494         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6495         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6496         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6497         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6498         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6499         16  COMP-TYPE            PIC X     VALUE SPACES.
  6500
  6501     12  ERLOFC-KEY.
  6502         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6503         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6504         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6505         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6506         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
  6507         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 118
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6508
  6509     12  WS-ELCRTT-KEY.
  6510         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6511         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6512
  6513     12  ERBXRF-KEY.
  6514         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6515         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6516         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6517         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6518
  6519     12  ERAGTC-KEY.
  6520         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6521         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6522         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6523         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6524         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6525         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6526
  6527     12  ERPLAN-KEY.
  6528         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6529         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6530         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6531         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6532         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6533         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6534         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6535         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6536
  6537     12  ERFORM-KEY.
  6538         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6539         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6540         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6541         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6542
  6543     12  ERREIN-KEY.
  6544         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6545         16  REIN-TYPE            PIC X     VALUE SPACES.
  6546         16  REIN-TABLE-CO.
  6547             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6548             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6549             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6550         16  FILLER               PIC X(3)  VALUE SPACES.
  6551
  6552     12  ERCTBL-KEY.
  6553         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6554         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6555         16  CTBL-CNTRL-2.
  6556             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6557             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6558
  6559     12  ELCRTO-KEY.
  6560         16  ELCRTO-COMPANY-CD       PIC X.
  6561         16  ELCRTO-CARRIER          PIC X.
  6562         16  ELCRTO-GROUPING         PIC X(6).
  6563         16  ELCRTO-STATE            PIC XX.
  6564         16  ELCRTO-ACCOUNT          PIC X(10).
  6565         16  ELCRTO-CERT-EFF-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 119
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6566         16  ELCRTO-CERT-NO.
  6567             20  ELCRTO-CERT-PRIME   PIC X(10).
  6568             20  ELCRTO-CERT-SFX     PIC X.
  6569         16  ELCRTO-RECORD-TYPE      PIC X.
  6570         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6571
  6572
  6573     12  WS-ACCESS.
  6574         16  FILLER               PIC XX    VALUE SPACES.
  6575         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6576
  6577     12  WS-CARR-ACCESS.
  6578         16  FILLER               PIC X(3)  VALUE SPACES.
  6579         16  WS-CARR              PIC X     VALUE SPACE.
  6580*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6581*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6582     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6583         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6584         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6585         88  WS-DMD-NO-RATING   VALUE 'N'.
  6586
  6587
  6588     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6589         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6590                                         'NJ' 'NL'
  6591                                         'PJ' 'PL'
  6592                                         'SJ' 'SL'.
  6593     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6594         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6595                                         'NI' 'NJ' 'NL' 'NU'
  6596                                         'PJ' 'PL' 'PI' 'PU'
  6597                                         'SI' 'SJ' 'SL' 'SU'
  6598                                         'MX' 'MY' 'MZ'.
  6599
  6600 01  ERPDEF-KEY-SAVE             PIC X(18).
  6601 01  ERPDEF-KEY.
  6602     12  ERPDEF-COMPANY-CD       PIC X.
  6603     12  ERPDEF-STATE            PIC XX.
  6604     12  ERPDEF-PROD-CD          PIC XXX.
  6605     12  F                       PIC X(7).
  6606     12  ERPDEF-BEN-TYPE         PIC X.
  6607     12  ERPDEF-BEN-CODE         PIC XX.
  6608     12  ERPDEF-EXP-DT           PIC XX.
  6609
  6610 01  ELSTAT-KEY-SAVE             PIC X(20).
  6611 01  ELSTAT-KEY.
  6612     12  ELSTAT-COMPANY-ID       PIC XXX.
  6613     12  ELSTAT-CARRIER          PIC X.
  6614     12  ELSTAT-GROUP            PIC X(6).
  6615     12  ELSTAT-STATE            PIC XX.
  6616     12  ELSTAT-EXP-DT           PIC 9(8).
  6617
  6618 01  WS-ERROR-VALUES.
  6619     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6620     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6621     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6622     12  ER-1891                     PIC S9(4)   VALUE +1891.
  6623     12  ER-1892                     PIC S9(4)   VALUE +1892.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 120
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6624     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6625     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6626     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6627     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6628     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6629     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6630     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6631     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6632     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6633     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6634     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6635     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6636     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6637     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6638     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6639     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6640     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6641     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6642     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6643     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6644     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6645     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6646     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6647     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6648     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6649     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6650     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6651     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6652     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6653     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6654     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6655     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6656     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6657     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6658     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6659     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6660     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6661     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6662     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6663     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6664     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6665     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6666     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6667     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6668     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6669     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6670     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6671     12  ER-2612                     PIC S9(4)   VALUE +2612.
  6672     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6673     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6674     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6675     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6676     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6677     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6678     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6679     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6680     12  ER-2621                     PIC S9(4)   VALUE +2621.
  6681     12  ER-2622                     PIC S9(4)   VALUE +2622.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 121
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6682     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6683     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6684     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6685     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6686     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6687     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6688     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6689     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6690     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6691     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6692     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6693     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6694     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6695     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6696     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6697     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6698     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6699     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6700     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6701     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6702     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6703     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6704     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6705     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6706     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6707     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6708     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6709     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6710     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6711     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6712     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6713     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6714     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6715     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6716     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6717     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6718     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6719     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6720     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6721     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6722     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6723     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6724     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6725     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6726     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6727     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6728     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6729     12  ER-2670                     PIC S9(4)   VALUE +2670.
  6730     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6731     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6732     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6733     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6734     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6735     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6736     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6737     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6738     12  ER-2679                     PIC S9(4)   VALUE +2679.
  6739     12  ER-2680                     PIC S9(4)   VALUE +2680.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 122
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6740     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6741     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6742     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6743     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6744     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6745     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6746     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6747     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6748     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6749     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6750     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6751     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6752     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6753     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6754     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6755     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6756     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6757     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6758     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6759     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6760     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6761     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6762     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6763     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6764     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6765     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6766     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6767     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6768     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6769     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6770     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6771     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6772     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6773     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6774     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6775     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6776     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6777     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6778     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6779     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6780     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6781     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6782     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6783     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6784     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6785     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6786     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6787     12  ER-2738                     PIC S9(4)   VALUE +2738.
  6788     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6789     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6790     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6791     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6792     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6793     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6794     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6795     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6796     12  ER-2747                     PIC S9(4)   VALUE +2747.
  6797     12  ER-2748                     PIC S9(4)   VALUE +2748.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 123
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6798     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6799     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6800     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6801     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6802     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6803     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6804     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6805     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6806     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6807     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6808     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6809     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6810     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6811     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6812     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6813     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6814     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6815     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6816     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6817     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6818     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6819     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6820     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6821     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6822     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6823     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6824     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6825     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6826     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6827     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6828     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6829     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6830     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6831     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6832     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6833     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6834     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6835     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6836     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6837     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6838     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6839     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6840     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6841     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6842     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6843     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6844     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6845     12  ER-2879                     PIC S9(4)   VALUE +2879.
  6846     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6847     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6848     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6849     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6850     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6851     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6852     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6853     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6854     12  ER-2889                     PIC S9(4)   VALUE +2889.
  6855     12  ER-2890                     PIC S9(4)   VALUE +2890.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 124
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6856     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6857     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6858     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6859     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6860     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6861     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6862     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6863     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6864     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6865     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6866     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6867     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6868     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6869     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6870     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6871     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6872     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6873     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6874     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6875     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6876     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6877     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6878     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6879     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6880     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6881     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6882     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6883     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6884     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6885     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6886     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6887     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6888     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6889     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6890     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6891     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6892     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6893     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6894     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6895     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6896     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6897     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6898     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6899     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6900     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6901     12  ER-8067                     PIC S9(4)   VALUE +8067.
  6902     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6903     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6904     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6905     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6906     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6907     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6908     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6909     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6910     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6911     12  ER-8078                     PIC S9(4)   VALUE +8078.
  6912     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6913     12  ER-8080                     PIC S9(4)   VALUE +8080.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 125
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6914     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6915     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6916     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6917     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6918     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6919     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6920     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6921     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6922     12  ER-8089                     PIC S9(4)   VALUE +8089.
  6923     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6924     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6925     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6926     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6927     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6928     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6929     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6930     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6931     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6932     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6933     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6934     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6935     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6936     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6937     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6938     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6939     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6940     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6941     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6942     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6943     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6944     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6945     12  ER-8303                     PIC S9(4)   VALUE +8303.
  6946     12  ER-8304                     PIC S9(4)   VALUE +8304.
  6947     12  ER-8310                     PIC S9(4)   VALUE +8310.
  6948     12  ER-8311                     PIC S9(4)   VALUE +8311.
  6949     12  ER-8312                     PIC S9(4)   VALUE +8312.
  6950     12  ER-8313                     PIC S9(4)   VALUE +8313.
  6951     12  ER-8314                     PIC S9(4)   VALUE +8314.
  6952     12  ER-8315                     PIC S9(4)   VALUE +8315.
  6953     12  ER-8316                     PIC S9(4)   VALUE +8316.
  6954     12  ER-8317                     PIC S9(4)   VALUE +8317.
  6955     12  ER-9236                     PIC S9(4)   VALUE +9236.
  6956     12  ER-9501                     PIC S9(4)   VALUE +9501.
  6957     12  ER-9503                     PIC S9(4)   VALUE +9503.
  6958     12  ER-9263                     PIC S9(4)   VALUE +9263.
  6959     12  ER-9999                     PIC S9(4)   VALUE +9999.
  6960******************************************************************
  6961***************   END OF ELC50WS     ****************************
  6962******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 126
* EL517.cbl
  6964 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 127
* EL517.cbl
  6966*DLB001
  6967 01  WS-DLB-MASTER-POLICY-FORM.
  6968     12  DMPF-PROCESS-TYPE         PIC X.
  6969         88  DMPF-OPEN-FILES                   VALUE 'O'.
  6970         88  DMPF-REG-PROCESS                  VALUE 'P'.
  6971         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  6972     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  6973     12  DMPF-RETURN-CODE          PIC XX.
  6974         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  6975         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  6976         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  6977         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  6978         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  6979         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  6980         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  6981
  6982*DLB002
  6983 01  WS-DLB-INTERNAL-POLICY-FORM.
  6984     12  DIPF-PROCESS-TYPE         PIC X.
  6985         88  DIPF-OPEN-FILES                   VALUE 'O'.
  6986         88  DIPF-REG-PROCESS                  VALUE 'P'.
  6987         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  6988     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  6989     12  DIPF-RETURN-CODE          PIC XX.
  6990         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  6991         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  6992         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  6993         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  6994         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  6995         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  6996         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  6997
  6998*DLB003
  6999 01  WS-DLB-VALID-BANK-ID.
  7000     12  DVBI-PROCESS-TYPE         PIC X.
  7001         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7002         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7003         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7004     12  DVBI-BANK-ID              PIC X(5).
  7005     12  DVBI-BANK-ID-TYPE         PIC X.
  7006         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7007         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7008         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7009         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7010         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7011     12  DVBI-RETURN-CODE          PIC XX.
  7012         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7013         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7014         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7015         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7016         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7017         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7018         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7019         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7020         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7021         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7022
  7023*DLB007
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 128
* EL517.cbl
  7024 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7025     12  DCUA-PROCESS-TYPE         PIC X.
  7026         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7027         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7028         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7029     12  DCUA-RES-STATE            PIC XX.
  7030     12  DCUA-BEN-TYPE             PIC XX.
  7031     12  DCUA-SYS-IDENT            PIC X.
  7032         88  DCUA-CLAIM                        VALUE 'C'.
  7033         88  DCUA-PREMIUM                      VALUE 'P'.
  7034     12  DCUA-COVERAGE-RULE        PIC X.
  7035     12  DCUA-CLIENT-ID            PIC X(10).
  7036     12  DCUA-EFF-DATE             PIC X(8).
  7037     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7038     12  DCUA-RETURN-CODE          PIC XX.
  7039         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7040         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7041         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7042     12  DCUA-CERT-NUMBER          PIC X(11).
  7043     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7044     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7045
  7046*DLB011
  7047 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7048     12  DPRB-PROCESS-TYPE         PIC X.
  7049         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7050         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7051         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7052     12  DPRB-RATE-CODE            PIC X(4).
  7053     12  DPRB-COVERAGE-CATEG       PIC X.
  7054     12  DPRB-RETURN-CODE          PIC XX.
  7055         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7056         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7057         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7058         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7059         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7060         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7061         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7062         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7063     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7064     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7065     12  DPRB-BEN-TYPE             PIC XX.
  7066
  7067*DLB017
  7068 01  WS-DLB-VALID-RATE-CODE.
  7069     12  DVRC-PROCESS-TYPE         PIC X.
  7070         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7071         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7072         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7073     12  DVRC-RATE-CODE            PIC X(4).
  7074     12  DVRC-RETURN-CODE          PIC XX.
  7075         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7076         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7077         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7078         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7079         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7080         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7081         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 129
* EL517.cbl
  7082
  7083*DLB019
  7084 01  WS-DLB-ORIG-COV-CAT.
  7085     12  DOCC-PROCESS-TYPE         PIC X.
  7086         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7087         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7088         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7089     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7090     12  DOCC-RETURN-CODE          PIC XX.
  7091     12  DOCC-ORIG-COV-CAT         PIC X.
  7092     12  DOCC-UNDERWRITER          PIC XX.
  7093     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7094     12  DOCC-CREDIT-IND           PIC X.
  7095     12  DOCC-PRODUCT-CD           PIC XX.
  7096     12  DOCC-TERM                 PIC XXX.
  7097
  7098*DLB021
  7099 01  WS-DLB-VALID-LOAN-OFFICER.
  7100     12  DVLO-LOAN-OFFICER         PIC X(3).
  7101     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7102         16  DVLO-BILL-TYPE        PIC X.
  7103         16  DVLO-BILL-SOURCE      PIC X.
  7104         16  DVLO-BATCH-TYPE       PIC X.
  7105     12  DVLO-RETURN-CODE          PIC XX.
  7106         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7107         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7108         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7109         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7110         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7111         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7112
  7113*DLB022
  7114 01  WS-DLB-VALID-STATE-CODE.
  7115     12  DVSC-PROCESS-TYPE         PIC X.
  7116         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7117         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7118         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7119     12  DVSC-STATE-CODE           PIC XX.
  7120     12  DVSC-RETURN-CODE          PIC XX.
  7121         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7122         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7123         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7124         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7125         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7126         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7127         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7128
  7129*DLB023
  7130 01  WS-DLB-VALID-CODE-VALUES.
  7131     12  DVCV-PROCESS-TYPE         PIC X.
  7132         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7133         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7134         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7135     12  DVCV-SYSTEM-ID            PIC XX.
  7136         88  DVCV-CLAIMS                       VALUE 'CL'.
  7137         88  DVCV-CREDIT                       VALUE 'CR'.
  7138     12  DVCV-RECORD-TYPE          PIC XX.
  7139         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 130
* EL517.cbl
  7140         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7141         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7142         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7143         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7144         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7145         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7146         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7147     12  DVCV-RECORD-KEY           PIC X(6).
  7148     12  DVCV-RETURN-CODE          PIC XX.
  7149         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7150         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7151         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7152         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7153         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7154         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7155         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7156         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7157         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7158         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7159     12  DVCV-CODE-DESC            PIC X(60).
  7160     12  DVCV-GEN-DESC-1           PIC X(20).
  7161     12  DVCV-GEN-DESC-2           PIC X(20).
  7162     12  DVCV-GEN-DESC-3           PIC X(20).
  7163
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 131
* EL517.cbl
  7165
  7166 01  PARMLIST.
  7167     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7168     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7169     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7170**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7171**
  7172**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7173     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7174
  7175 01  PLAN-RECORDS.
  7176     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7177     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7178
* 7179                                  COPY ELCDATE.
  7180******************************************************************06/11/98
  7181*                                                                *ELCDATE
  7182*                                                                *ELCDATE
  7183*                            ELCDATE.                            *   LV023
  7184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7185*                            VMOD=2.003                           ELCDATE
  7186*                                                                *ELCDATE
  7187*                                                                *ELCDATE
  7188*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7189*                 LENGTH = 200                                   *   CL*19
  7190******************************************************************ELCDATE
  7191                                                                  ELCDATE
  7192 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7193     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7194     12  DC-OPTION-CODE                PIC X.                        CL*15
  7195         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7196         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7197         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7198         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7199         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7200         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7201         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7202         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7203         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7204         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7205         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7206         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7207         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7208         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7209         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7210         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7211         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7212         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7213         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7214         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7215         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7216         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7217         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7218         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7219         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7220         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7221         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7222         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 132
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7223         88  THREE-CHARACTER-BIN                                  ELCDATE
  7224                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7225         88  GREGORIAN-TO-BIN                                        CL**2
  7226                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7227         88  BIN-TO-GREGORIAN                                        CL**2
  7228                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7229         88  JULIAN-TO-BINARY                                        CL**2
  7230                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7231     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7232         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7233         88  DATE-CONVERSION-ERROR                                ELCDATE
  7234                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7235         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7236         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7237         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7238         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7239         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7240         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7241         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7242         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7243         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7244         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7245     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7246         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7247     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7248         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7249         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7250         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7251     12  FILLER                        PIC X.                        CL*15
  7252     12  DC-CONVERSION-DATES.                                        CL*15
  7253         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7254         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7255         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7256         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7257                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7258             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7259             20  SLASH1-1              PIC X.                        CL*15
  7260             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7261             20  SLASH1-2              PIC X.                        CL*15
  7262             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7263         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7264         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7265                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7266             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7267             20  SLASH2-1              PIC X.                        CL*15
  7268             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7269             20  SLASH2-2              PIC X.                        CL*15
  7270             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7271         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7272         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7273                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7274             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7275             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7276             20  DC-YMD-DAY            PIC 99.                       CL*15
  7277         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7278         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7279                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7280             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 133
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7281             20  DC-MDY-DAY            PIC 99.                       CL*15
  7282             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7283         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7284             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7285             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7286             20  FILLER                PIC XX.                       CL*15
  7287             20  DC-ALPHA-CENTURY.                                   CL*15
  7288                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7289             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7290         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7291         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7292         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7293         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7294         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7295                                       PIC 9(05).                    CL*20
  7296         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7297             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7298             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7299         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7300         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7301         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7302     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7303         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7304         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7305             20  FILLER                PIC 9(3).                     CL*15
  7306             20  HOLD-CEN-1-CCYY.                                    CL*15
  7307                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7308                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7309             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7310             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7311         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7312             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7313             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7314             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7315                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7316                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7317             20  FILLER                PIC 9(3).                     CL*15
  7318         16  HOLD-CENTURY-1-X.                                       CL*15
  7319             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7320             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7321                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7322                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7323             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7324             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7325         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7326             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7327             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7328             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7329                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7330                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7331             20  FILLER                PIC XXX.                      CL*23
  7332         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7333         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7334         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7335         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7336             20  DC-JULIAN-1-CCYY.                                   CL*15
  7337                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7338                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7339             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7340         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7341         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7342             20  DC-JULIAN-2-CCYY.                                   CL*15
  7343                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7344                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7345             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7346         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7347             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7348             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7349             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7350             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7351             20  DC-EDITA-CCYY.                                      CL*15
  7352                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7353                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7354         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7355             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7356             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7357             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7358             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7359             20  DC-EDITB-CCYY.                                      CL*15
  7360                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7361                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7362         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7363         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7364                              DC-GREG-DATE-CYMD.                  ELCDATE
  7365             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7366             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7367             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7368             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7369         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7370         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7371                              DC-GREG-DATE-MDCY.                  ELCDATE
  7372             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7373             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7374             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7375             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7376    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7377        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7378    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7379    12  FILLER                         PIC X(28).                    CL*26
  7380
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 135
* EL517.cbl
* 7382                                  COPY ELCCALC.
  7383******************************************************************04/15/98
  7384*                                                                *ELCCALC
  7385*                           ELCCALC.                            *    LV003
  7386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7387*                            VMOD=2.025                          *   CL**3
  7388*                                                                *   CL**2
  7389*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7390*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7391*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7392*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7393*                                                                *   CL**2
  7394*  PASSED TO ELRTRM                                              *   CL**2
  7395*  -----------------                                             *   CL**2
  7396*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7397*  ORIGINAL TERM                                                 *   CL**2
  7398*  BEGINNING DATE                                                *   CL**2
  7399*  ENDING DATE                                                   *   CL**2
  7400*  COMPANY I.D.                                                  *   CL**2
  7401*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7402*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7403*  FREE LOOK DAYS                                                *   CL**2
  7404*                                                                *   CL**2
  7405*  RETURNED FROM ELRTRM                                          *   CL**2
  7406*  ---------------------                                         *   CL**2
  7407*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7408*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7409*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7410*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7411*----------------------------------------------------------------*   CL**2
  7412*  PASSED TO ELRAMT                                              *   CL**2
  7413*  ----------------                                              *   CL**2
  7414*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7415*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7416*  ORIGINAL AMOUNT                                               *   CL**2
  7417*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7418*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7419*  METHOD                                                            CL**2
  7420*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7421*  COMPANY I.D.                                                  *   CL**2
  7422*  BENEFIT TYPE                                                  *   CL**2
  7423*                                                                *   CL**2
  7424*  RETURNED FROM ELRAMT                                          *   CL**2
  7425*  --------------------                                          *   CL**2
  7426*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7427*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7428*  REMAINING AMOUNT FACTOR                                           CL**2
  7429*----------------------------------------------------------------*   CL**2
  7430*  PASSED TO ELRESV                                              *   CL**2
  7431*  -----------------                                             *   CL**2
  7432*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7433*  VALUATION DATE                                                *   CL**2
  7434*  PAID THRU DATE                                                *   CL**2
  7435*  BENEFIT                                                       *   CL**2
  7436*  INCURRED DATE                                                 *   CL**2
  7437*  REPORTED DATE                                                 *   CL**2
  7438*  ISSUE AGE                                                     *   CL**2
  7439*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7440*  CDT PERCENT                                                   *   CL**2
  7441*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7442* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7443* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7444* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7445*                                                                *   CL**2
  7446*  RETURNED FROM ELRESV                                          *   CL**2
  7447*  --------------------                                          *   CL**2
  7448*  CDT TABLE USED                                                *   CL**2
  7449*  CDT FACTOR USED                                               *   CL**2
  7450*  PAY TO CURRENT RESERVE                                        *   CL**2
  7451*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7452*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7453*----------------------------------------------------------------*   CL**2
  7454*  PASSED TO ELRATE                                              *   CL**2
  7455*  ----------------                                              *   CL**2
  7456*  CERT ISSUE DATE                                               *   CL**2
  7457*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7458*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7459*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7460*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7461*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7462*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7463*  DEVIATION CODE                                                *   CL**2
  7464*  ISSUE AGE                                                     *   CL**2
  7465*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7466*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7467*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7468*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7469*  A.P.R.                                                        *   CL**2
  7470*  METHOD                                                            CL**2
  7471*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7472*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7473*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7474*  BENEFIT CODE                                                  *   CL**2
  7475*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7476*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7477*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7478*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7479*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7480*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7481*                                                                *   CL**2
  7482*  RETURNED FROM ELRATE                                          *   CL**2
  7483*  --------------------                                          *   CL**2
  7484*  CALCULATED PREMIUM                                            *   CL**2
  7485*  PREMIUM RATE                                                  *   CL**2
  7486*  MORTALITY CODE                                                *   CL**2
  7487*  MAX ATTAINED AGE                                              *   CL**2
  7488*  MAX AGE                                                       *   CL**2
  7489*  MAX TERM                                                      *   CL**2
  7490*  MAX MONTHLY BENEFIT                                           *   CL**2
  7491*  MAX TOTAL BENIFIT                                             *   CL**2
  7492*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7493*----------------------------------------------------------------*   CL**2
  7494*  PASSED TO ELRFND                                              *   CL**2
  7495*  ----------------                                              *   CL**2
  7496*  CERT ISSUE DATE                                               *   CL**2
  7497*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 137
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7498*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7499*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7500*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7501*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7502*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7503*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7504*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7505*  DEVIATION CODE                                                *   CL**2
  7506*  ISSUE AGE                                                     *   CL**2
  7507*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7508*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7509*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7510*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7511*  A.P.R.                                                        *   CL**2
  7512*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7513*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7514*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7515*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7516*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7517*  BENEFIT CODE                                                  *   CL**2
  7518*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7519*                                                                *   CL**2
  7520*  RETURNED FROM ELRFND                                          *   CL**2
  7521*  --------------------                                          *   CL**2
  7522*  CALCULATED REFUND                                             *   CL**2
  7523*----------------------------------------------------------------*   CL**2
  7524*  PASSED TO ELEARN                                              *   CL**2
  7525*  ----------------                                              *   CL**2
  7526*  CERT ISSUE DATE                                               *   CL**2
  7527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7528*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7529*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7530*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7531*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7532*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7533*  DEVIATION CODE                                                *   CL**2
  7534*  ISSUE AGE                                                     *   CL**2
  7535*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7536*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7537*  A.P.R.                                                        *   CL**2
  7538*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7539*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7540*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7541*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7542*  BENEFIT CODE                                                  *   CL**2
  7543*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7544*                                                                *   CL**2
  7545*  RETURNED FROM ELEARN                                          *   CL**2
  7546*  --------------------                                          *   CL**2
  7547*  INDICATED  EARNINGS                                           *   CL**2
  7548*----------------------------------------------------------------*   CL**2
  7549*                 LENGTH = 450                                   *   CL**2
  7550*                                                                *   CL**2
  7551******************************************************************   CL**2
  7552******************************************************************
  7553*                   C H A N G E   L O G
  7554*
  7555* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7556*-----------------------------------------------------------------
  7557*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7558* EFFECTIVE    NUMBER
  7559*-----------------------------------------------------------------
  7560* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7561* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7562* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7563* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7564* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7565* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7566* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7567* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7568* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7569******************************************************************
  7570                                                                     CL**2
  7571 01  CALCULATION-PASS-AREA.                                          CL**2
  7572     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7573                                     COMP.                           CL**2
  7574                                                                     CL**2
  7575     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7576       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7577       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7578                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7579       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7580       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7581       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7582       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7583       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7584       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7585       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7586       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7587       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7588       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7589       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7590       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7591       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7592       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7593       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7594       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7595       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7596                                                                     CL**2
  7597     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7598       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7599***********************  INPUT AREAS ****************************    CL**2
  7600                                                                     CL**2
  7601     12  CP-CALCULATION-AREA.                                        CL**2
  7602         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7603         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7604         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7605         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7606         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7607           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7608                                                   'I' 'U'.          CL**2
  7609           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7610           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7611         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7612         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7613         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7614         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7615         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7616                                     COMP-3.                         CL**2
  7617         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7618                                     COMP-3.                         CL**2
  7619         16  CP-CDT-METHOD         PIC X.                            CL**2
  7620           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7621           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7622           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7623         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7624           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7625           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7626         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7627                                     COMP-3.                         CL**2
  7628         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7629                                     COMP-3.                         CL**2
  7630         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7631                                     COMP-3.                         CL**2
  7632         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7633                                     COMP-3.                         CL**2
  7634         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7635                                     COMP-3.                         CL**2
  7636         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7637                                     COMP-3.                         CL**2
  7638         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7639                                     COMP-3.                         CL**2
  7640         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7641           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7642           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7643           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7644           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7645           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7646           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7647           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7648         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7649           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7650           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7651           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7652           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7653           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7654           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7655           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7656           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7657           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7658           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7659           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7660           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7661           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7662           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7663         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7664           88  CP-CLAIM                            VALUE '1'.        CL**2
  7665           88  CP-CANCEL                           VALUE '2'.        CL**2
  7666           88  CP-ISSUE                            VALUE '3'.        CL**2
  7667         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7668           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7669           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7670           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7671           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7672           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7673           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7674           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7675           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7676           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7677           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7678           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7679           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7680           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7681           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7682           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7683           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7684           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7685           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7686                                                     'W' 'X'.        CL**2
  7687           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7688           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7689           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7690           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7691           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7692           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7693           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7694           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7695           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7696           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7697           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7698           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7699           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7700                                                                     CL**2
  7701         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7702                                     COMP-3.                         CL**2
  7703         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7704         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7705         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7706         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7707         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7708           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7709               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7710         16  CP-R78-OPTION         PIC X.                            CL**2
  7711           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7712           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7713                                                                     CL**2
  7714         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7715         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7716         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7717         16  CP-RATE-FILE          PIC X.                            CL**2
  7718         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7719                                     COMP-3.                         CL**2
  7720                                                                     CL**2
  7721         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7722         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7723                                                                     CL**2
  7724         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7725                                     COMP-3.
  7726         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7727                                   PIC S9(5)V99 COMP-3.
  7728         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7729                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7730         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7731                                     COMP-3.                         CL**2
  7732         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7733                                     COMP-3.
  7734         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7735                                  PIC S9(7)V99 COMP-3.
  7736                                                                     CL**2
  7737         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7738         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7739         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7740           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7741           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7742           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7743           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7744         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7745         16  CP-CARRIER            PIC X.                            CL**2
  7746         16  CP-REIN-FLAG          PIC X.                            CL**2
  7747         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7748           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7749                      '2' '3' '4' '5'.                               CL**2
  7750           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7751           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7752           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7753           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7754           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7755           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7756           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7757           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7758         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7759         16  CP-RATING-METHOD      PIC X.                            CL**2
  7760           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7761           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7762           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7763           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7764           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7765           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7766           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7767           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7768           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7769         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7770                                     COMP-3.                         CL**2
  7771         16  CP-BEN-CATEGORY       PIC X.
  7772         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7773         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7774                                   PIC S99V9(5) COMP-3.
  7775         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7776         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7777                                   PIC S99V9(5) COMP-3.
  7778         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7779         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7780         16  CP-EXPIRE-DT          PIC XX.
  7781         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7782         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7783         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7784         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7785         16  CP-DDF-SPEC-CALC      PIC X.
  7786             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7787             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7788         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7789         16  CP-CANCEL-REASON      PIC X.
  7790         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7791         16  CP-PMT-MODE           PIC X.
  7792         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7793         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7794         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7795         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7796         16  FILLER                PIC X.
  7797                                                                     CL**2
  7798***************    OUTPUT FROM ELRESV   ************************     CL**2
  7799                                                                     CL**2
  7800         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7801                                                                     CL**2
  7802         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7803                                     COMP-3.                         CL**2
  7804         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7805                                     COMP-3.                         CL**2
  7806         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7807                                     COMP-3.                         CL**2
  7808         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7809                                     COMP-3.                         CL**2
  7810         16  FILLER                PIC X(09).                        CL**2
  7811***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7812                                                                     CL**2
  7813         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7814                                     COMP-3.                         CL**2
  7815         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7816                                     COMP-3.                         CL**2
  7817         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7818                                     COMP-3.                         CL**2
  7819         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7820                                     COMP-3.                         CL**2
  7821         16  FILLER                PIC X(12).                        CL**2
  7822                                                                     CL**2
  7823***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7824                                                                     CL**2
  7825         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7826                                     COMP-3.                         CL**2
  7827         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7828                                     COMP-3.                         CL**2
  7829         16  FILLER                PIC X(12).                        CL**2
  7830                                                                     CL**2
  7831***************    OUTPUT FROM ELRATE   *************************    CL**2
  7832                                                                     CL**2
  7833         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7834                                     COMP-3.                         CL**2
  7835         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7836                                     COMP-3.                         CL**2
  7837         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7838         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7839             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7840         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7841                                     COMP-3.                         CL**2
  7842         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7843         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7844         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7845                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7846         16  FILLER                PIC X(07).                        CL**2
  7847                                                                     CL**2
  7848***************    OUTPUT FROM ELRFND   *************************    CL**2
  7849                                                                     CL**2
  7850         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7851                                     COMP-3.                         CL**2
  7852         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7853           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7854           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7855           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7856           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7857           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7858           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7859           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7860           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7861           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7862           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7863           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7864           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7865           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7866           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7867         16  FILLER                PIC X(12).                        CL**2
  7868                                                                     CL**2
  7869***************    OUTPUT FROM ELEARN   *************************    CL**2
  7870                                                                     CL**2
  7871         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7872                                     COMP-3.                         CL**2
  7873         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7874                                     COMP-3.                         CL**2
  7875         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7876                                     COMP-3.                         CL**2
  7877         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7878                                     COMP-3.                         CL**2
  7879         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7880                                     COMP-3.                         CL**2
  7881         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7882                                     COMP-3.                         CL**2
  7883         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7884           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7885           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7886           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7887           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7888           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7889           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7890           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7891           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7892           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7893         16  FILLER                PIC X(12).                        CL**2
  7894                                                                     CL**2
  7895***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7896                                                                     CL**2
  7897         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7898                                     COMP-3.                         CL**2
  7899         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7900                                     COMP-3.                         CL**2
  7901         16  FILLER                PIC X(12).                        CL**2
  7902                                                                     CL**2
  7903***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7904         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7905                                     COMP-3.                         CL**2
  7906         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7907                                     COMP-3.                         CL**2
  7908         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7909                                     COMP-3.                         CL**2
  7910         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7911                                     COMP-3.                         CL**2
  7912         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7913                                     COMP-3.                         CL**2
  7914         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7915                                     COMP-3.                         CL**2
  7916         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7917             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7918             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7919             88  IO-ERROR                         VALUE 'E'.         CL**2
  7920                                                                     CL**2
  7921         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7922                                                                     CL**2
  7923         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7924                                                                     CL**2
  7925         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7926                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7927                                     COMP-3.                         CL**2
  7928                                                                     CL**2
  7929         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7930                                                                     CL**2
  7931         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7932                                     COMP-3.                         CL**2
  7933                                                                     CL**2
  7934         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7935                                     COMP-3.                         CL**2
  7936                                                                     CL**2
  7937         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7938                                     COMP-3.                         CL**2
  7939                                                                     CL**2
  7940         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7941                                     COMP-3.                         CL**2
  7942                                                                     CL**2
  7943         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7944                                     COMP-3.                         CL**2
  7945                                                                     CL**2
  7946         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  7947                                     COMP-3.                         CL**2
  7948                                                                     CL**2
  7949         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  7950                                     COMP-3.                         CL**2
  7951                                                                     CL**2
  7952         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  7953             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  7954                                                                     CL**2
  7955         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  7956                                     COMP-3.                         CL**2
  7957         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  7958                                     COMP-3.
  7959         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  7960         16  FILLER                PIC X(15).                        CL**2
  7961******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 145
* EL517.cbl
  7962
* 7963                                  COPY ELCDTECX.
  7964******************************************************************06/05/98
  7965*                                                                *ELCDTECX
  7966*                            ELCDTECX.                           *   LV005
  7967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7968*                            VMOD=2.015                          *ELCDTECX
  7969*                                                                *ELCDTECX
  7970*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  7971*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  7972*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  7973*                                                                *ELCDTECX
  7974******************************************************************ELCDTECX
  7975******************************************************************
  7976*                   C H A N G E   L O G
  7977*
  7978* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7979*-----------------------------------------------------------------
  7980*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7981* EFFECTIVE    NUMBER
  7982*-----------------------------------------------------------------
  7983* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  7984*                                  BENEFIT CODES FROM 300 TO 900
  7985* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  7986* 051304    2003080800002  SMVA  ADD REFUND METHOD
  7987******************************************************************
  7988 01  DATE-CARD.                                                   ELCDTECX
  7989     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  7990     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  7991     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  7992     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  7993     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  7994     12  EP-SW                       PIC  X.                      ELCDTECX
  7995         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  7996     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  7997         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  7998     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  7999     12  RUN-CENTURY.                                             ELCDTECX
  8000         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8001     12  FILLER                      PIC  X.                         CL**4
  8002     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8003     12  FILLER                      PIC  XXX.                    ELCDTECX
  8004     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8005                                                                  ELCDTECX
  8006 01  FILLER                          PIC  X(7)                       CL**6
  8007                                          VALUE 'OPTIONS'.        ELCDTECX
  8008 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8009     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8010     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8011     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8012         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8013         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8014     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8015     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8016     12  FILLER                      PIC  X.                      ELCDTECX
  8017     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8018     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8019     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8020     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8021     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8022     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8023     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8024     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8025     12  FILLER                      PIC  X.                      ELCDTECX
  8026     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8027     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8028     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8029     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8030     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8031     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8032     12  FILLER                      PIC  X.                      ELCDTECX
  8033     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8034     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8035     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8036     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8037     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8038     12  DTE-R78                     PIC  X.                      ELCDTECX
  8039     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8040     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8041     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8042     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8043     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8044     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8045     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8046                                     PIC  X.                      ELCDTECX
  8047         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8048                                                 ' '.             ELCDTECX
  8049         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8050         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8051     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8052         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8053         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8054     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8055     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8056                                     PIC  9.                         CL**4
  8057     12  DTE-SYSTEM.                                              ELCDTECX
  8058         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8059         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8060         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8061         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8062         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8063         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8064         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8065         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8066         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8067         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8068         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8069         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8070         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8071         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8072         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8073         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8074         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8075         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8076         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8077         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 147
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8078         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8079         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8080         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8081         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8082         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8083         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8084     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8085         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8086                                     PIC  X.                      ELCDTECX
  8087     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8088                                                                  ELCDTECX
  8089 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8090     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8091     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8092     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8093*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8094     12  FILLER                      PIC  X.                      ELCDTECX
  8095     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8096     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8097     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8098     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8099     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8100     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8101     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8102                                                                  ELCDTECX
  8103     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8104     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8105     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8106     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8107                                                                  ELCDTECX
  8108     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8109     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8110     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8111     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8112                                                                  ELCDTECX
  8113     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8114     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8115                                                                  ELCDTECX
  8116     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8117     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8118                                                                  ELCDTECX
  8119     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8120                                                                  ELCDTECX
  8121 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8122     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8123     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8124     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8125     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8126     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8127     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8128     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8129                                                                  ELCDTECX
  8130 01  FILLER                          PIC  X(12)                   ELCDTECX
  8131                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8132 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8133     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8134         16  CNT-ID                  PIC  X.                      ELCDTECX
  8135         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8136                                                                  ELCDTECX
  8137 01  FILLER                          PIC  X(11)                   ELCDTECX
  8138                                          VALUE 'STATE NAMES'.    ELCDTECX
  8139 01  STATE-NAMES.                                                 ELCDTECX
  8140     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8141         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8142         16  STATE-PIC1.                                          ELCDTECX
  8143             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8144             20  FILLER              PIC  XXX.                    ELCDTECX
  8145             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8146             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8147             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8148             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8149                                                                  ELCDTECX
  8150 01  FILLER                          PIC  X(13)                   ELCDTECX
  8151                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8152 01  CARRIER-NAMES.                                               ELCDTECX
  8153     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8154         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8155         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8156         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8157         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8158         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8159         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8160*        16  FILLER                  PIC  X.                      ELCDTECX
  8161         16  CARRIER-SEC-PAY         PIC  X.
  8162             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8163                                                                  ELCDTECX
  8164 01  FILLER                          PIC  X(9)                       CL**6
  8165                                          VALUE 'INS TYPES'.      ELCDTECX
  8166 01  CLAS-INS-TYPES.                                              ELCDTECX
  8167*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8168     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8169         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8170         16  CLAS-I-AB3.                                          ELCDTECX
  8171             20  FILLER              PIC  X.                      ELCDTECX
  8172             20  CLAS-I-AB2.                                      ELCDTECX
  8173                 24  FILLER          PIC  X.                      ELCDTECX
  8174                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8175         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8176             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8177             20  FILLER              PIC  X.                         CL**4
  8178         16  CLAS-I-AB10.                                         ELCDTECX
  8179             20  FILLER              PIC  X(9).                   ELCDTECX
  8180             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8181         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8182         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8183         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8184         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8185             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8186         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8187         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8188         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8189         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8190         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8191         16  FILLER                  PIC  X(05).
  8192                                                                  ELCDTECX
  8193 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8194                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8195 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8196     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8197                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8198         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8199         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8200         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8201         16  CLAS-MORT-DESC.                                      ELCDTECX
  8202             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8203             20  FILLER              PIC  XX.                        CL**5
  8204             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8205             20  FILLER              PIC  X.                         CL**5
  8206             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8207             20  FILLER              PIC  X.                         CL**5
  8208             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8209             20  FILLER              PIC  X.                         CL**5
  8210             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8211             20  FILLER              PIC  X(5).                      CL**6
  8212                                                                  ELCDTECX
  8213 01  FILLER                          PIC  X(15)                   ELCDTECX
  8214                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8215 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8216     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8217         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8218         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8219         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8220         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8221         16  FILLER                  PIC  X(4).                      CL**6
  8222                                                                  ELCDTECX
  8223 01  FILLER                          PIC  X(7)                       CL**6
  8224                                     VALUE 'INDEXES'.             ELCDTECX
  8225 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8226     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8227     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8228     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8229     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8230     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8231     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8232     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8233     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8234     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8235     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8236     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8237     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8238     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8239     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8240     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8241     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8242     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8243                                                                  ELCDTECX
  8244 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8245     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8246     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8247     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8248     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8249     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8250     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8251     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8252     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8253     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8254     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8255     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8256                                                                  ELCDTECX
  8257 01  FILLER                          PIC  X(13)                   ELCDTECX
  8258                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8259 01  CLAS-MISC.                                                   ELCDTECX
  8260     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8261         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8262         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8263         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8264     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8265     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8266     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8267     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8268     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8269     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8270     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8271     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8272     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8273     12  STATE-L                     PIC  XX.                     ELCDTECX
  8274     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8275     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8276     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8277         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8278         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8279     12  DTE-ABEND-WORK.                                          ELCDTECX
  8280         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8281         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8282                                                                  ELCDTECX
  8283 01  FILLER                          PIC  X(12)                   ELCDTECX
  8284                                     VALUE 'WORKING DATE'.        ELCDTECX
  8285 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8286     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8287         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8288         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8289         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8290     12  WS-CURRENT-DATE.                                         ELCDTECX
  8291         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8292         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8293         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8294         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8295         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8296     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8297         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8298         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8299                                                                  ELCDTECX
  8300 01  FILLER                          PIC  X(12)                   ELCDTECX
  8301                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8302 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8303     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8304         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8305         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8306         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8307                                                                  ELCDTECX
  8308 01  FILLER                          PIC  X(10)                   ELCDTECX
  8309                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8310 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8311     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8312         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8313         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8314                                                                  ELCDTECX
  8315 01  FILLER                          PIC  X(13)                   ELCDTECX
  8316                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8317 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8318     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8319         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8320                                                                  ELCDTECX
  8321 01  FILLER                          PIC  X(13)                   ELCDTECX
  8322                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8323 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8324     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8325     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8326     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8327                                     PIC  X.                         CL**5
  8328     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8329     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8330     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8331     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8332     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8333     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8334     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8335     12  FILLER                      PIC  X(75).                  ELCDTECX
  8336******************************************************************ELCDTECX
  8337*01  MISC-CARR-PCT-DATA.                                          00001521
  8338*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8339*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8340*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8341*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8342*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8343*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8344******************************************************************ELCDTECX
  8345
* 8346                                  COPY ELCDTEVR.
  8347***************************************************************** 04/15/98
  8348*                                                                *ELCDTEVR
  8349*                                                                *ELCDTEVR
  8350*                            ELCDTEVR.                           *   LV003
  8351*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8352*                            VMOD=2.001                          *   CL**2
  8353*                                                                *ELCDTEVR
  8354*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8355*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8356*                                                                *ELCDTEVR
  8357******************************************************************ELCDTEVR
  8358 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8359     05  WS-RUN-DATE.                                             ELCDTEVR
  8360         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8361         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8362         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8363             15  RUN-CC              PIC  99.                     ELCDTEVR
  8364             15  RUN-YR              PIC  99.                     ELCDTEVR
  8365         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8366         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8367     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8368            WS-RUN-DATE              PIC 9(11).                      CL**2
  8369     05  WS-EP-DT.                                                ELCDTEVR
  8370         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8371         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8372         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8373             15  EP-CC               PIC  99.                     ELCDTEVR
  8374             15  EP-YR               PIC  99.                     ELCDTEVR
  8375         10  EP-MO                   PIC  99.                     ELCDTEVR
  8376         10  EP-DA                   PIC  99.                     ELCDTEVR
  8377     05  WS-EP-DT-N REDEFINES                                        CL**2
  8378            WS-EP-DT                 PIC 9(11).                      CL**2
  8379     05  WS-DTE-CONV-DT.                                             CL**4
  8380         10  FILLER                  PIC  9(03).                     CL**4
  8381         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8382         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8383             15  DTE-CONV-CC         PIC  99.                        CL**4
  8384             15  DTE-CONV-YR         PIC  99.                        CL**4
  8385         10  DTE-CONV-MO             PIC  99.                        CL**4
  8386         10  DTE-CONV-DA             PIC  99.                        CL**4
  8387     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8388            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8389 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8390     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8391         10  FILLER                            PIC 999.           ELCDTEVR
  8392         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8393         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8394             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8395             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8396         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8397         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8398     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8399            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8400     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8401         10  FILLER                            PIC 999.           ELCDTEVR
  8402         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8403         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8404         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8405         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8406     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8407            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8408 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8409     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8410         10  FILLER                            PIC 999.           ELCDTEVR
  8411         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8412         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8413             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8414             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8415         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8416         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8417     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8418            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8419     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8420         10  FILLER                            PIC 999.           ELCDTEVR
  8421         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8422         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8423             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8424             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8425         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8426         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8427     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8428            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8429     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8430         10  FILLER                            PIC 999.           ELCDTEVR
  8431         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8432         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8433             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8434             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8435         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8436         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8437     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8438            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8439 01  WS-RATE-RECORD.                                              ELCDTEVR
  8440         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8441             10  FILLER                        PIC 999.           ELCDTEVR
  8442             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8443             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8444                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8445                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8446             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8447             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8448         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8449                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8450
* 8451                                  COPY ELCREINV.
  8452******************************************************************04/18/98
  8453*                                                                *ELCREINV
  8454*                                                                *ELCREINV
  8455*                            ELCREINV                            *   LV003
  8456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8457*                            VMOD=2.001                          *ELCREINV
  8458*                                                                *ELCREINV
  8459*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8460*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8461*                                                                *ELCREINV
  8462******************************************************************ELCREINV
  8463                                                                  ELCREINV
  8464 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8465     05  WS-RE-LO-DATE.                                              CL**3
  8466         10 FILLER                     PIC 999.                      CL**3
  8467         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8468         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8469            15 RE-LO-CC                PIC 99.                       CL**3
  8470            15 RE-LO-YR                PIC 99.                       CL**3
  8471         10 RE-LO-MO                   PIC 99.                       CL**3
  8472         10 RE-LO-DA                   PIC 99.                       CL**3
  8473     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8474            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8475     05  WS-RE-HI-DATE.                                              CL**3
  8476         10 FILLER                     PIC 999.                      CL**3
  8477         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8478         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8479            15 RE-HI-CC                PIC 99.                       CL**3
  8480            15 RE-HI-YR                PIC 99.                       CL**3
  8481         10 RE-HI-MO                   PIC 99.                       CL**3
  8482         10 RE-HI-DA                   PIC 99.                       CL**3
  8483     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8484            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8485     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8486         10 FILLER                     PIC 999.                   ELCREINV
  8487         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8488         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8489            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8490            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8491         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8492         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8493     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8494            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8495     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8496         10  FILLER                    PIC 999.                   ELCREINV
  8497         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8498         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8499             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8500             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8501         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8502         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8503     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8504            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8505     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8506         10  FILLER                    PIC 999.                   ELCREINV
  8507         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8508         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8509             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8510             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8511         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8512         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8513     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8514            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8515
* 8516                                  COPY ELCACCTV.
  8517******************************************************************04/14/98
  8518*                                                                *ELCACCTV
  8519*                            ELCACCTV                            *   LV002
  8520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8521*                            VMOD=2.001                          *ELCACCTV
  8522*                                                                *ELCACCTV
  8523*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8524*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8525*                                                                *ELCACCTV
  8526*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8527*                                                                *ELCACCTV
  8528******************************************************************ELCACCTV
  8529                                                                  ELCACCTV
  8530 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8531                                                                  ELCACCTV
  8532     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8533         10  FILLER            PIC 999.                           ELCACCTV
  8534         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8535         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8536             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8537             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8538         10  AM-EXP-MO         PIC 99.                               CL**5
  8539         10  AM-EXP-DA         PIC 99.                               CL**5
  8540     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8541            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8542     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8543         10  FILLER                    PIC 999.                   ELCACCTV
  8544         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8545         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8546             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8547             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8548         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8549         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8550     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8551            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8552     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8553         10  FILLER                    PIC 999.                   ELCACCTV
  8554         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8555         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8556             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8557             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8558         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8559         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8560     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8561            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8562     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8563         10 FILLER                     PIC 999.                   ELCACCTV
  8564         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8565         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8566            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8567            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8568         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8569         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8570     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8571            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8572     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8573         10 FILLER                     PIC 999.                   ELCACCTV
  8574         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8575         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8576            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8577            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8578         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8579         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8580     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8581            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8582     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8583         10  FILLER                    PIC 999.                   ELCACCTV
  8584         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8585         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8586             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8587             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8588         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8589         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8590     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8591            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8592     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8593         10  FILLER                    PIC 999.                   ELCACCTV
  8594         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8595         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8596             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8597             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8598         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8599         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8600     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8601            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8602     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8603         10  FILLER                    PIC 999.                   ELCACCTV
  8604         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8605         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8606             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8607             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8608         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8609         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8610     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8611            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8612     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8613         10  FILLER                    PIC 999.                   ELCACCTV
  8614         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8615         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8616             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8617             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8618         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8619         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8620     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8621            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 157
* EL517.cbl
* 8623                                  COPY ELCDIFRD.
  8624******************************************************************04/15/98
  8625*                                                                *ELCDIFRD
  8626*                                                                *ELCDIFRD
  8627*                            ELCDIFRD.                           *   LV003
  8628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8629*                            VMOD=2.004                          *   CL**3
  8630*                                                                *ELCDIFRD
  8631*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8632*                                                                *ELCDIFRD
  8633******************************************************************ELCDIFRD
  8634*                                                                 ELCDIFRD
  8635  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8636        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8637        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8638        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8639        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8640        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8641        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8642        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8643        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8644        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8645        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8646        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 158
* EL517.cbl
* 8648                                  COPY ELCERRWS.
  8649******************************************************************04/15/98
  8650*                                                                *ELCERRWS
  8651*                                                                *ELCERRWS
  8652*                            ELCERRWS                            *   LV002
  8653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8654*                            VMOD=2.005                          *   CL**2
  8655*                                                                *ELCERRWS
  8656*                                                                *ELCERRWS
  8657*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8658*                                                                *ELCERRWS
  8659******************************************************************ELCERRWS
  8660                                                                  ELCERRWS
  8661 01  W-ERROR-WORK.                                                ELCERRWS
  8662     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8663     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8664     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8665     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8666     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8667     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8668     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8669     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8670     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8671     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8672     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8673     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8674     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8675     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8676     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8677     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8678     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8679                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 159
* EL517.cbl
  8681
  8682 PROCEDURE DIVISION.
  8683
  8684 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8685******************************************************************04/15/98
  8686*                                                                *ELCDTERX
  8687*                                                                *ELCDTERX
  8688*                            ELCDTERX.                           *   LV002
  8689*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8690*                            VMOD=2.007                          *ELCDTERX
  8691*                                                                *ELCDTERX
  8692*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8693*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8694*      = ELCDTEFD)                                               *ELCDTERX
  8695*                                                                *ELCDTERX
  8696******************************************************************ELCDTERX
  8697                                                                  ELCDTERX
  8698     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8699                                                                  ELCDTERX
  8700     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8701     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8702     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8703                                                                  ELCDTERX
  8704     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8705                                                                  ELCDTERX
  8706******************************************************************ELCDTERX
  8707*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8708*          WARNING MESSAGES.                                      ELCDTERX
  8709******************************************************************ELCDTERX
  8710     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8711         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8712                                                                  ELCDTERX
  8713     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8714                                                                  ELCDTERX
  8715     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8716                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8717                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8718                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8719                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8720                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8721                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8722                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8723                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8724                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8725                                                                  ELCDTERX
  8726     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8727                                                                  ELCDTERX
  8728     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8729                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8730                                                                  ELCDTERX
  8731     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8732     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8733     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8734     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8735                                                                  ELCDTERX
  8736     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8737         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 160
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8738     ELSE                                                         ELCDTERX
  8739         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8740                                                                  ELCDTERX
  8741     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8742         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8743     ELSE                                                         ELCDTERX
  8744         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8745                                                                  ELCDTERX
  8746 0005-READ--CARD.                                                 ELCDTERX
  8747     READ DISK-DATE                                               ELCDTERX
  8748         AT END CLOSE DISK-DATE                                   ELCDTERX
  8749             GO TO 0060-READ--TEST.                               ELCDTERX
  8750                                                                  ELCDTERX
  8751     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8752                                                                  ELCDTERX
  8753     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8754         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8755         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8756         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8757         GO TO 0005-READ--CARD.                                   ELCDTERX
  8758                                                                  ELCDTERX
  8759     IF DD-ID = 'CLAD'                                            ELCDTERX
  8760         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8761         GO TO 0005-READ--CARD.                                   ELCDTERX
  8762                                                                  ELCDTERX
  8763     IF DD-ID = 'CLAX'                                            ELCDTERX
  8764         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8765         GO TO 0005-READ--CARD.                                   ELCDTERX
  8766                                                                  ELCDTERX
  8767     IF DD-ID = 'CLAF'                                            ELCDTERX
  8768         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8769         GO TO 0005-READ--CARD.                                   ELCDTERX
  8770                                                                  ELCDTERX
  8771     IF DD-ID = 'CLAC'                                            ELCDTERX
  8772         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8773                                                                  ELCDTERX
  8774     IF DD-ID = 'CARR'                                            ELCDTERX
  8775         GO TO 0015-READ--CARR.                                   ELCDTERX
  8776                                                                  ELCDTERX
  8777     IF DD-ID = 'STAT'                                            ELCDTERX
  8778         GO TO 0020-READ--STAT.                                   ELCDTERX
  8779                                                                  ELCDTERX
  8780     IF DD-ID = 'BUSC'                                            ELCDTERX
  8781         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8782                                                                  ELCDTERX
  8783     IF DD-ID = 'MORT'                                            ELCDTERX
  8784         GO TO 0030-READ--MORT.                                   ELCDTERX
  8785                                                                  ELCDTERX
  8786     IF DD-ID = 'CLAI'                                            ELCDTERX
  8787         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8788                                                                  ELCDTERX
  8789     IF DD-ID = 'COLC'                                            ELCDTERX
  8790         GO TO 0065-READ--COLC.                                   ELCDTERX
  8791                                                                  ELCDTERX
  8792     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8793        DD-IDA = 'CL'                                             ELCDTERX
  8794         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8795                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 161
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8796     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8797        DD-IDA = 'PO'                                             ELCDTERX
  8798         GO TO 0050-READ--POXX.                                   ELCDTERX
  8799                                                                  ELCDTERX
  8800     IF DD-ID = 'OPCA'                                            ELCDTERX
  8801         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8802                                                                  ELCDTERX
  8803     IF DD-ID = 'OPST'                                            ELCDTERX
  8804         GO TO 0072-READ--OPST.                                   ELCDTERX
  8805                                                                  ELCDTERX
  8806     IF DD-ID = 'OPBS'                                            ELCDTERX
  8807         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8808                                                                  ELCDTERX
  8809     IF DD-ID = 'OPMS'                                            ELCDTERX
  8810         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8811                                                                  ELCDTERX
  8812     GO TO 0005-READ--CARD.                                       ELCDTERX
  8813                                                                  ELCDTERX
  8814 0010-READ--CLAC.                                                 ELCDTERX
  8815     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8816     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8817     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8818     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8819     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8820     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8821     GO TO 0005-READ--CARD.                                       ELCDTERX
  8822                                                                  ELCDTERX
  8823 0015-READ--CARR.                                                 ELCDTERX
  8824     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8825     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8826        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8827        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8828        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8829        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8830        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8831        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8832        MOVE DD-CARR1-SECPAY-SW
  8833                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8834     END-IF
  8835                                                                  ELCDTERX
  8836     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8837     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8838        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8839        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8840        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8841        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8842        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8843        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8844        MOVE DD-CARR2-SECPAY-SW
  8845                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8846     END-IF
  8847                                                                  ELCDTERX
  8848                                                                  ELCDTERX
  8849     GO TO 0005-READ--CARD.                                       ELCDTERX
  8850                                                                  ELCDTERX
  8851 0020-READ--STAT.                                                 ELCDTERX
  8852     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8853     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8854        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8855         GO TO 0005-READ--CARD.                                   ELCDTERX
  8856                                                                  ELCDTERX
  8857     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8858     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8859     GO TO 0020-READ--STAT.                                       ELCDTERX
  8860                                                                  ELCDTERX
  8861 0025-READ--BUSC.                                                 ELCDTERX
  8862     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8863     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8864        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8865         GO TO 0005-READ--CARD.                                   ELCDTERX
  8866                                                                  ELCDTERX
  8867     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8868     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8869     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8870                                                                  ELCDTERX
  8871 0030-READ--MORT.                                                 ELCDTERX
  8872     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8873     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8874        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8875         GO TO 0005-READ--CARD.                                   ELCDTERX
  8876                                                                  ELCDTERX
  8877     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8878     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8879     GO TO 0030-READ--MORT.                                       ELCDTERX
  8880                                                                  ELCDTERX
  8881 0035-READ--CLXX.                                                 ELCDTERX
  8882     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8883          GO TO 0005-READ--CARD.                                  ELCDTERX
  8884                                                                  ELCDTERX
  8885     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8886         DISPLAY '***********************************************'ELCDTERX
  8887         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8888         DISPLAY '***********************************************'ELCDTERX
  8889         GO TO 0055-READ--STOP.                                   ELCDTERX
  8890                                                                  ELCDTERX
  8891     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8892        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8893         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8894                                                                  ELCDTERX
  8895     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8896        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8897         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8898                                                                  ELCDTERX
  8899*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8900     GO TO 0005-READ--CARD.                                       ELCDTERX
  8901                                                                  ELCDTERX
  8902 0040-READ--CLAI.                                                 ELCDTERX
  8903     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8904     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8905        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8906         GO TO 0005-READ--CARD.                                   ELCDTERX
  8907                                                                  ELCDTERX
  8908     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8909     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8910     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8911                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8912 0045-READ--DUMP.                                                 ELCDTERX
  8913     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8914     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8915                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8916     PERFORM ABEND-PGM.                                           ELCDTERX
  8917                                                                  ELCDTERX
  8918 0050-READ--POXX.                                                 ELCDTERX
  8919     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8920         GO TO 0005-READ--CARD.                                   ELCDTERX
  8921                                                                  ELCDTERX
  8922     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8923         DISPLAY '***********************************************'ELCDTERX
  8924         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8925         DISPLAY '***********************************************'ELCDTERX
  8926         GO TO 0055-READ--STOP.                                   ELCDTERX
  8927                                                                  ELCDTERX
  8928     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8929     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8930     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8931     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8932                                                                  ELCDTERX
  8933     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8934         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8935     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8936         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8937                                                                  ELCDTERX
  8938     GO TO 0005-READ--CARD.                                       ELCDTERX
  8939                                                                  ELCDTERX
  8940 0055-READ--STOP.                                                 ELCDTERX
  8941     GOBACK.                                                      ELCDTERX
  8942                                                                  ELCDTERX
  8943 0060-READ--TEST.                                                 ELCDTERX
  8944     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8945        CLAX-ID         = SPACE  OR                               ELCDTERX
  8946        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  8947         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8948                                                                  ELCDTERX
  8949     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  8950     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8951                                                                  ELCDTERX
  8952 0065-READ--COLC.                                                 ELCDTERX
  8953     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8954     GO TO 0005-READ--CARD.                                       ELCDTERX
  8955                                                                  ELCDTERX
  8956 0070-READ--OPCA.                                                 ELCDTERX
  8957                                                                  ELCDTERX
  8958     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8959                                                                  ELCDTERX
  8960     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8961             OR                                                   ELCDTERX
  8962         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8963         GO TO 0005-READ--CARD.                                   ELCDTERX
  8964                                                                  ELCDTERX
  8965     ADD 1                       TO INDEXCA.                      ELCDTERX
  8966     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8967                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8968     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8969                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8970 0072-READ--OPST.                                                 ELCDTERX
  8971                                                                  ELCDTERX
  8972     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8973                                                                  ELCDTERX
  8974     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8975             OR                                                   ELCDTERX
  8976         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8977         GO TO 0005-READ--CARD.                                   ELCDTERX
  8978                                                                  ELCDTERX
  8979     ADD 1                       TO INDEXST.                      ELCDTERX
  8980     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8981                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8982     GO TO 0072-READ--OPST.                                       ELCDTERX
  8983                                                                  ELCDTERX
  8984 0074-READ--OPBS.                                                 ELCDTERX
  8985                                                                  ELCDTERX
  8986     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8987                                                                  ELCDTERX
  8988     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8989             OR                                                   ELCDTERX
  8990         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8991         GO TO 0005-READ--CARD.                                   ELCDTERX
  8992                                                                  ELCDTERX
  8993     ADD 1                       TO INDEXBS.                      ELCDTERX
  8994     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8995     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8996                                                                  ELCDTERX
  8997 0079-READ--EXIT.                                                 ELCDTERX
  8998*    EXIT.                                                        ELCDTERX
  8999******************************************************************ELCDTERX
  9000
  9001     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9002
  9003     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9004     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9005     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9006
  9007     MOVE 4                      TO DC-OPTION-CODE.
  9008     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9009     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9010     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9011     MOVE WORK-AREAS             TO HOLD-WORK.
  9012
  9013     IF DTE-PRC-OPT = '2'
  9014         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9015
  9016     OPEN INPUT ELCNTL.
  9017     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9018         NEXT SENTENCE
  9019       ELSE
  9020         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9021         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9022         MOVE EMSG               TO WS-ABEND-MESSAGE
  9023         GO TO ABEND-PGM.
  9024
  9025     OPEN  I-O ERPNDB.
  9026     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9027         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 165
* EL517.cbl
  9028       ELSE
  9029         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9030         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9031         MOVE EMSG               TO WS-ABEND-MESSAGE
  9032         GO TO ABEND-PGM.
  9033
  9034     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9035     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9036
  9037     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9038
  9039     IF ERPNDB-FILE-STATUS NOT = '00'
  9040         GO TO 9999-DONE.
  9041
  9042     OPEN INPUT ERREIN.
  9043     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9044         NEXT SENTENCE
  9045       ELSE
  9046         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9047         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9048         MOVE EMSG               TO WS-ABEND-MESSAGE
  9049         GO TO ABEND-PGM.
  9050
  9051     IF DTE-CLIENT = 'DCC'
  9052        OPEN INPUT ERPDEF ELSTAT
  9053        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9054           CONTINUE
  9055        ELSE
  9056           MOVE ERPDEF-FILE-STATUS
  9057                                 TO WS-ABEND-FILE-STATUS
  9058           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9059           MOVE EMSG             TO WS-ABEND-MESSAGE
  9060           GO TO ABEND-PGM
  9061        END-IF
  9062        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9063           CONTINUE
  9064        ELSE
  9065           MOVE ELSTAT-FILE-STATUS
  9066                                 TO WS-ABEND-FILE-STATUS
  9067           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9068           MOVE EMSG             TO WS-ABEND-MESSAGE
  9069           GO TO ABEND-PGM
  9070        END-IF
  9071     END-IF
  9072
  9073     OPEN I-O   ELCERT.
  9074******************************************************************
  9075*                                                                *
  9076*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9077*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9078*                                                                *
  9079*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9080*                                                                *
  9081*               EL631 - EL6311 - EL6312 - EL6313                 *
  9082*                                                                *
  9083******************************************************************
  9084
  9085     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 166
* EL517.cbl
  9086         NEXT SENTENCE
  9087       ELSE
  9088         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9089         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9090         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9091         GO TO ABEND-PGM.
  9092
  9093     OPEN INPUT ERCTBL.
  9094     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9095         NEXT SENTENCE
  9096       ELSE
  9097         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9098         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9099         MOVE EMSG               TO WS-ABEND-MESSAGE
  9100         GO TO ABEND-PGM.
  9101
  9102     OPEN INPUT ERACCT.
  9103     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9104         NEXT SENTENCE
  9105       ELSE
  9106         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9107         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9108         MOVE EMSG               TO WS-ABEND-MESSAGE
  9109         GO TO ABEND-PGM.
  9110
  9111     OPEN INPUT ERCOMP.
  9112     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9113         NEXT SENTENCE
  9114       ELSE
  9115         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9116         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9117         MOVE EMSG               TO WS-ABEND-MESSAGE
  9118         GO TO ABEND-PGM.
  9119
  9120     OPEN INPUT ERLOFC
  9121     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9122        CONTINUE
  9123     ELSE
  9124        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9125        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9126        MOVE EMSG                TO WS-ABEND-MESSAGE
  9127        GO TO ABEND-PGM
  9128     END-IF
  9129
  9130     OPEN INPUT ERBXRF.
  9131     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9132         NEXT SENTENCE
  9133       ELSE
  9134         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9135         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9136         MOVE EMSG               TO WS-ABEND-MESSAGE
  9137         GO TO ABEND-PGM.
  9138
  9139     OPEN INPUT ERAGTC.
  9140     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9141         NEXT SENTENCE
  9142       ELSE
  9143         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 167
* EL517.cbl
  9144         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9145         MOVE EMSG               TO WS-ABEND-MESSAGE
  9146         GO TO ABEND-PGM.
  9147
  9148     OPEN INPUT ERPLAN.
  9149     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9150        NEXT SENTENCE
  9151     ELSE
  9152        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9153        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9154        MOVE EMSG                TO WS-ABEND-MESSAGE
  9155        GO TO ABEND-PGM.
  9156
  9157     OPEN INPUT ERFORM.
  9158     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9159        OR '9%'
  9160        NEXT SENTENCE
  9161     ELSE
  9162        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9163        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9164        MOVE EMSG                TO WS-ABEND-MESSAGE
  9165        GO TO ABEND-PGM.
  9166
  9167     OPEN INPUT ELCERR.
  9168     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9169         NEXT SENTENCE
  9170       ELSE
  9171         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9172         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9173         MOVE EMSG               TO WS-ABEND-MESSAGE
  9174         GO TO ABEND-PGM.
  9175
  9176     MOVE 'R'                     TO CP-RATE-FILE.
  9177     MOVE 'O'                     TO CP-IO-FUNCTION.
  9178     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9179
  9180     IF IO-ERROR
  9181        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9182        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9183        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9184        GO TO ABEND-PGM.
  9185
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 168
* EL517.cbl
  9187*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9188*
  9189     IF DTE-CLIENT NOT = 'DMD'
  9190         GO TO 0100-READ-PENDING.
  9191
  9192     OPEN INPUT ERRESS ERRESC.
  9193
  9194     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9195         NEXT SENTENCE
  9196     ELSE
  9197         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9198         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9199         MOVE EMSG               TO WS-ABEND-MESSAGE
  9200         GO TO ABEND-PGM.
  9201
  9202     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9203         NEXT SENTENCE
  9204     ELSE
  9205         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9206         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9207         MOVE EMSG               TO WS-ABEND-MESSAGE
  9208         GO TO ABEND-PGM.
  9209
  9210     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9211     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9212     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9213     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9214         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9215         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9216         MOVE EMSG               TO WS-ABEND-MESSAGE
  9217         GO TO ABEND-PGM.
  9218
  9219     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9220     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9221     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9222     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9223         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9224         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9225         MOVE EMSG               TO WS-ABEND-MESSAGE
  9226         GO TO ABEND-PGM.
  9227
  9228     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9229     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9230     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9231     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9232         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9233         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9234         MOVE EMSG               TO WS-ABEND-MESSAGE
  9235         GO TO ABEND-PGM.
  9236
  9237     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9238     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9239     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9240     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9241         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9242         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9243         MOVE EMSG               TO WS-ABEND-MESSAGE
  9244         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 169
* EL517.cbl
  9245
  9246     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9247     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9248     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9249     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9250         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9251         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9252         MOVE EMSG               TO WS-ABEND-MESSAGE
  9253         GO TO ABEND-PGM.
  9254
  9255     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9256     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9257     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9258     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9259         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9260         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9261         MOVE EMSG               TO WS-ABEND-MESSAGE
  9262         GO TO ABEND-PGM.
  9263
  9264     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9265     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9266     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9267     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9268         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9269         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9270         MOVE EMSG               TO WS-ABEND-MESSAGE
  9271         GO TO ABEND-PGM.
  9272
  9273*
  9274*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9275*
  9276 0100-READ-PENDING.
  9277
  9278     MOVE HOLD-WORK TO WORK-AREAS.
  9279
  9280     MOVE ZEROS                  TO EMI-WARNING-CTR
  9281                                    EMI-FORCABLE-CTR
  9282                                    EMI-FATAL-CTR.
  9283 0101-READ-PENDING.
  9284     READ ERPNDB.
  9285     ADD 1 TO RPND.
  9286
  9287     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9288         GO TO 9999-DONE.
  9289
  9290     IF ERPNDB-FILE-STATUS NOT = '00'
  9291         GO TO 9999-DONE.
  9292
  9293     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9294     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9295     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9296
  9297     IF PB-BATCH-TRAILER
  9298         GO TO 9999-REWRITE-RECORD.
  9299
  9300     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9301        GO TO 0100-READ-PENDING.
  9302
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 170
* EL517.cbl
  9303     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9304        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9305        GO TO 0100-READ-PENDING.
  9306
  9307     IF WK-BATCH-PREFIX = '#CL'
  9308        GO TO 0100-READ-PENDING.
  9309
  9310     IF DTE-PRC-OPT = '2'
  9311         NEXT SENTENCE
  9312     ELSE
  9313         IF NOT PB-FATAL-ERRORS
  9314             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9315             GO TO 0100-READ-PENDING.
  9316
  9317     ADD 1 TO TRAN-CT.
  9318
  9320 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 171
* EL517.cbl
*                           COPY ELC50PD.
  9321******************************************************************04/22/98
  9322*                                                                *ELC50PD
  9323*                            ELC50PD                             *   LV012
  9324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9325*                            VMOD=2.188                          *   CL**7
  9326*                                                                *ELC50PD
  9327******************************************************************
  9328*                   C H A N G E   L O G
  9329*
  9330* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9331*-----------------------------------------------------------------
  9332*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9333* EFFECTIVE    NUMBER
  9334*-----------------------------------------------------------------
  9335* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9336* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9337* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9338*                             2709 AND 2718
  9339* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9340* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9341* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9342* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9343* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9344*                                IS OPEN OR CNC DT < PD THRU
  9345* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9346* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9347* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9348* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9349* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9350* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9351* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9352* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9353* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9354* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9355* 020906                   PEMA  EXPAND LOAN OFFICER
  9356* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9357* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9358* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9359* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9360* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9361* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9362* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9363* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9364* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9365* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9366* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9367* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9368* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9369* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9370* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9371* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9372* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9373* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9374* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9375* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9376* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9377* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 172
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9378* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9379* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9380* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9381*                                UPDATE VIN ON CERT TRAILER
  9382* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9383* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9384* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9385* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9386* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9387* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9388* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9389* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9390* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9391* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9392* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9393* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9394* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9395* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9396* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9397* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9398* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9399* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9400* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9401* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9402* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9403* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9404* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9405* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9406* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9407* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9408* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9409* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9410* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9411* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9412* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9413* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9414* 032912  CR2011110200001  PEMA  AHL CHANGES
  9415* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9416* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9417* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9418* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9419* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9420* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9421* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9422* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9423* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9424* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9425* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9426******************************************************************ELC50PD
  9427************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9428******************************************************************ELC50PD
  9429                                                                  ELC50PD
  9430     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9431                                                                  ELC50PD
  9432     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9433                                    PB-FORCE-ER-CD                ELC50PD
  9434                                    PB-WARN-ER-CD                 ELC50PD
  9435                                    PB-OUT-BAL-CD.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 173
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9436                                                                  ELC50PD
  9437     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9438                                    WS-IG-OVRD-LF                 ELC50PD
  9439                                    WS-IG-OVRD-AM                 ELC50PD
  9440                                    WS-IG-OVRD                    ELC50PD
  9441                                    WS-IG-OVRD-AH-PL              ELC50PD
  9442                                    WS-IG-OVRD-LF-PL              ELC50PD
  9443                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9444                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9445                                                                  ELC50PD
  9446******************************************************************ELC50PD
  9447*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9448******************************************************************ELC50PD
  9449                                                                  ELC50PD
  9450     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9451     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9452                                                                  ELC50PD
  9453******************************************************************ELC50PD
  9454                                                                  ELC50PD
  9455     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9456     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9457*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9458     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9459     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9460                                                                  ELC50PD
  9461     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9462                                                                  ELC50PD
  9463 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9464                                                                  ELC50PD
  9465     ADD +1                      TO  SUB4.                        ELC50PD
  9466                                                                  ELC50PD
  9467     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9468         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9469                                                                  ELC50PD
  9470     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9471         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9472                                                                  ELC50PD
  9473     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9474                                                                  ELC50PD
  9475 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9476                                                                  ELC50PD
  9477     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9478        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9479                                         WS-AH-REM-TERM-CALC      ELC50PD
  9480                                         EC-CO-REM-TERM-CALC      ELC50PD
  9481        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9482        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9483        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9484                                         WS-TOL-AH-CLAIM          ELC50PD
  9485        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9486                                         WS-TOL-AH-PREM           ELC50PD
  9487                                         EC-CO-TOL-PREM           ELC50PD
  9488        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9489                                         WS-TOL-AH-REFUND         ELC50PD
  9490                                         EC-CO-TOL-REFUND         ELC50PD
  9491        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9492                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9493                                         EC-CO-OVR-SHT-AMT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9494        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9495                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9496                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9497        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9498                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9499                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9500        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9501                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9502                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9503        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9504        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9505        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9506        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9507        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9508        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9509        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9510        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9511        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9512        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9513        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9514        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9515                                         EC-CO-MONTH-END-DT       ELC50PD
  9516        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9517          GO TO 0100-READ-ACCT.                                   ELC50PD
  9518                                                                  ELC50PD
  9519     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9520     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9521     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9522     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9523                                                                  ELC50PD
  9524     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9525     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9526     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9527         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9528                                   WK-CO-TOL-CLAIM                ELC50PD
  9529                                   WK-CO-TOL-REFUND               ELC50PD
  9530                                   WK-REFUND-OVS-AMT              ELC50PD
  9531                                   WK-REFUND-OVS-PCT              ELC50PD
  9532                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9533                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9534                                   WK-DEFAULT-APR                 ELC50PD
  9535                                   WK-CO-MAX-CAP                  ELC50PD
  9536        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9537                                   WK-CR-R78-METHOD               ELC50PD
  9538                                   WK-CO-REF-REJECT-SW            ELC50PD
  9539                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9540                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9541                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9542                                   WK-JOINT-AGE-INPUT             ELC50PD
  9543        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9544        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9545        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9546        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9547          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9548                                                                  ELC50PD
  9549     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9550        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9551     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9552        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9553     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9554        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9555     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9556        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9557                                                                  ELC50PD
  9558     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9559     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9560     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9561     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9562     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9563     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9564     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9565     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9566     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9567     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9568     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9569     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9570                                                                  ELC50PD
  9571     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9572          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9573        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9574                                                                  ELC50PD
  9575     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9576          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9577        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9578                                                                  ELC50PD
  9579     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9580         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9581     ELSE                                                         ELC50PD
  9582         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9583                                                                  ELC50PD
  9584     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9585     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9586     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9587     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9588                                                                  ELC50PD
  9589     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9590                                                                  ELC50PD
  9591 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9592                                                                  ELC50PD
  9593     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9594     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9595                                                                  ELC50PD
  9596 0100-READ-ACCT.                                                  ELC50PD
  9597                                                                  ELC50PD
  9598     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9599                                                                  ELC50PD
  9600     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9601        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9602                                                                  ELC50PD
  9603     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9604     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9605     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9606                                                                  ELC50PD
  9607     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9608        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9609        GO TO 0105-READ-ACCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9610     END-IF
  9611                                                                  ELC50PD
  9612     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9613        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9614           GO TO 0105-READ-ACCT.                                  ELC50PD
  9615                                                                  ELC50PD
  9616     IF PB-STATE NOT = SPACES                                     ELC50PD
  9617        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9618           GO TO 0105-READ-ACCT.                                  ELC50PD
  9619                                                                  ELC50PD
  9620     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9621        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9622           GO TO 0105-READ-ACCT.                                  ELC50PD
  9623                                                                  ELC50PD
  9624     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9625                                                                  ELC50PD
  9626     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9627        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9628        GO TO 0105-READ-ACCT.                                     ELC50PD
  9629                                                                  ELC50PD
  9630     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9631        GO TO 0105-READ-ACCT.                                     ELC50PD
  9632                                                                  ELC50PD
  9633     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9634                                                                  ELC50PD
  9635 0102-ACCT-GETMAIN.                                               ELC50PD
  9636     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9637     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9638                                                                  ELC50PD
  9639 0105-READ-ACCT.                                                  ELC50PD
  9640     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9641     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9642     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9643     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9644     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9645     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9646                                                                  ELC50PD
  9647     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9648                                                                  ELC50PD
  9649     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9650                                                                  ELC50PD
  9651 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9652
  9653     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9654                                                                  ELC50PD
  9655     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9656        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9657        GO TO 0199-ACCT-NOT-FOUND
  9658     END-IF
  9659     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9660        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9661           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9662                                                                  ELC50PD
  9663     IF PB-STATE NOT = SPACES                                     ELC50PD
  9664        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9665           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9666                                                                  ELC50PD
  9667     IF PB-GROUPING NOT = SPACES                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9668        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9669           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9670                                                                  ELC50PD
  9671     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9672                                                                  ELC50PD
  9673     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9674        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9675        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9676                                                                  ELC50PD
  9677     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9678        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9679                                                                  ELC50PD
  9680 0180-ACCOUNT-FOUND.                                              ELC50PD
  9681
  9682     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9683     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9684     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9685     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9686                                                                  ELC50PD
  9687     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9688        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9689                                                                  ELC50PD
  9690     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9691        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9692                                                                  ELC50PD
  9693     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9694        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9695                                                                  ELC50PD
  9696     IF AM-CLP-TOL-PCT NOT NUMERIC
  9697        MOVE +0                  TO AM-CLP-TOL-PCT
  9698     END-IF
  9699     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9700        MOVE +0                  TO AM-SPP-LEASE-COMM
  9701     END-IF
  9702     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9703        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9704        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9705                                                                  ELC50PD
  9706     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9707        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9709                                                                  ELC50PD
  9710     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9711        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9712        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9713        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9714         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9715                                                                  ELC50PD
  9716     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9717     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9718     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9719     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9720     IF AM-CLP-TOL-PCT NOT = ZEROS
  9721        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9722     END-IF
  9723     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9724        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9725     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9726
  9727
  9728
  9729
  9730*    IF PB-COMPANY-ID = 'DCC'
  9731*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9732*                                   WS-ADMIN-FEES
  9733*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9734*          (SUB5 > +10)
  9735*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9736*             AND (AM-A-COM (SUB5) NUMERIC)
  9737*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9738*                + (AM-A-COM (SUB5) * 1000)
  9739*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9740*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9741*                + (AM-A-COM (SUB5) * 1000)
  9742*             END-IF
  9743*             IF AM-COM-TYP (SUB5) = 'N'
  9744*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9745*                + (AM-A-COM (SUB5) * 1000)
  9746*             END-IF
  9747*          END-IF
  9748*       END-PERFORM
  9749*    END-IF
  9750
  9751     IF (PB-COMPANY-ID = 'DCC')
  9752        AND (PB-ISSUE)
  9753        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9754        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9755           (SUB5 > +10)
  9756           MOVE +0 TO WS-WK-RATE
  9757           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9758              IF (AM-A-COM (SUB5) NUMERIC)
  9759                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9760                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9761              ELSE
  9762                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9763                 IF PB-ISSUE
  9764                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9765                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9766                 ELSE
  9767                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9768                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9769                 END-IF
  9770                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9771                 MOVE ZEROS             TO WS-SUB1
  9772                                           WS-COMMISSION
  9773                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9774                 MOVE '0530'               TO CTBL-SW
  9775                 MOVE ' '                  TO WS-CTBL-READ-SW
  9776                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9777                 IF FIRST-TIME-THROUGH
  9778                    MOVE 'AA'              TO CTBL-BEN-CODE
  9779                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9780                 END-IF
  9781                 IF CTBL-TABLE-FOUND
  9782                    IF PB-ISSUE
  9783                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9784                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9785                    ELSE
  9786                       COMPUTE WS-COMM-CK-AMT =
  9787                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9788                    END-IF
  9789                    PERFORM 8800-GET-COMP-RATE
  9790                              THRU 8800-EXIT
  9791                 END-IF
  9792              END-IF
  9793              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9794                + (WS-WK-RATE * 1000)
  9795           END-IF
  9796        END-PERFORM
  9797     END-IF
  9798
  9799     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9800         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9801                                                                  ELC50PD
  9802     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9803         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9804     END-IF
  9805                                                                  ELC50PD
  9806     GO TO 0200-READ-CERT.                                        ELC50PD
  9807                                                                  ELC50PD
  9808 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9809                                                                  ELC50PD
  9810     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9811                                                                  ELC50PD
  9812     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9813        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9814        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9815     ELSE                                                         ELC50PD
  9816        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9818                                                                  ELC50PD
  9819     GO TO 9990-RETURN.                                           ELC50PD
  9820                                                                  ELC50PD
  9821 0200-READ-CERT.                                                  ELC50PD
  9822                                                                  ELC50PD
  9823     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9824     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9825     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9826     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9827     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9828     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9829     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9830                                                                  ELC50PD
  9831     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9832                                                                  ELC50PD
  9833     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9834        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9835                                                                  ELC50PD
  9836     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9837        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9839        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9840                                                                  ELC50PD
  9841     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9842         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9844         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9845                                                                  ELC50PD
  9846     IF PB-ISSUE                                                  ELC50PD
  9847        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9848           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9849              NEXT SENTENCE                                       ELC50PD
  9850            ELSE                                                  ELC50PD
  9851              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9852              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9853              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9854                                                                  ELC50PD
  9855     IF NOT PB-CANCELLATION                                       ELC50PD
  9856        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9857                                                                  ELC50PD
  9858     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9859     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9860     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9861     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9862     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9863     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9864                                                                  ELC50PD
  9865     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9866     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9867     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9868     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9869     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9870     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9871     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9872     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9873     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9874                                                                  ELC50PD
  9875     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9876     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9877     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9878     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9879     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9880     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9881     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9882                                                                  ELC50PD
  9883     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9884     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9885                                                                  ELC50PD
  9886     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9887                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9888     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9889                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9890                                                                  ELC50PD
  9891     IF CM-O-B-COVERAGE                                           ELC50PD
  9892         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9893                                                                  ELC50PD
  9894     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9895         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9896                                                                  ELC50PD
  9897     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9898         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9899                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9900     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9901         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9902         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9903         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9904         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9905         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9906         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9907         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9908*The next line causes a problem with my change  I dont think it is needed
  9909*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9910                                                                  ELC50PD
  9911     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9912     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9913     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9914     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9915     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9916     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9917                                                                  ELC50PD
  9918     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9919     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9920     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9921     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9922                                                                  ELC50PD
  9923     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9924         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9925     ELSE                                                         ELC50PD
  9926         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9927                                                                  ELC50PD
  9928     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9929         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9930     ELSE                                                         ELC50PD
  9931         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9932                                                                  ELC50PD
  9933     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9934                                                                  ELC50PD
  9935     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
  9936           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
  9937                                                                  ELC50PD
  9938     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
  9939           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
  9940                                                                  ELC50PD
  9941     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
  9942           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
  9943                                                                  ELC50PD
  9944     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
  9945           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
  9946                                                                  ELC50PD
  9947     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
  9948           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
  9949                                                                  ELC50PD
  9950     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
  9951     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
  9952     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
  9953     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
  9954     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
  9955     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
  9956     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
  9957     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9958     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
  9959     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
  9960     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
  9961     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
  9962                                                                  ELC50PD
  9963     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
  9964         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
  9965                                                                  ELC50PD
  9966     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
  9967         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
  9968                                                                  ELC50PD
  9969     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
  9970                                                                  ELC50PD
  9971     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  9972        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  9973        IF CM-ADDL-CLP NOT NUMERIC
  9974           MOVE +0               TO CM-ADDL-CLP
  9975        END-IF
  9976        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  9977        IF AM-DCC-PRODUCT-CODE = 'DDF'
  9978           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  9979        END-IF
  9980     END-IF
  9981
  9982     IF PB-COMPANY-ID = 'DCC'
  9983        MOVE +0                  TO WS-ADMIN-FEES
  9984                                    WS-CSO-ADMIN-FEE
  9985                                    WS-COMM-AND-MFEE
  9986                                    WS-1ST-YR-ALLOW
  9987        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9988           (SUB5 > +10)
  9989           MOVE +0 TO WS-WK-RATE
  9990           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9991              IF (AM-A-COM (SUB5) NUMERIC)
  9992                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9993                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9994              ELSE
  9995                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9996                 IF PB-ISSUE
  9997                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9998                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9999                 ELSE
 10000                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10001                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10002                 END-IF
 10003                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10004                 MOVE ZEROS             TO WS-SUB1
 10005                                           WS-COMMISSION
 10006                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10007                 MOVE '0530'               TO CTBL-SW
 10008                 MOVE ' '                  TO WS-CTBL-READ-SW
 10009                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10010                 IF FIRST-TIME-THROUGH
 10011                    MOVE 'AA'              TO CTBL-BEN-CODE
 10012                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10013                 END-IF
 10014                 IF CTBL-TABLE-FOUND
 10015                    IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10016                       COMPUTE WS-COMM-CK-AMT =
 10017                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10018                    ELSE
 10019                       COMPUTE WS-COMM-CK-AMT =
 10020                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10021                    END-IF
 10022                    PERFORM 8800-GET-COMP-RATE
 10023                              THRU 8800-EXIT
 10024                 END-IF
 10025              END-IF
 10026              IF AM-COM-TYP (SUB5) = 'I'
 10027                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10028                   + (WS-WK-RATE * 1000)
 10029              END-IF
 10030              IF AM-COM-TYP (SUB5) = 'N'
 10031                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10032                   + (WS-WK-RATE * 1000)
 10033              END-IF
 10034              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10035                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10036                   + (WS-WK-RATE * 1000)
 10037              END-IF
 10038              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10039                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10040                   + (WS-WK-RATE * 1000)
 10041              END-IF
 10042           END-IF
 10043        END-PERFORM
 10044     END-IF
 10045
 10046     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10047                                                                  ELC50PD
 10048 0298-UNLOCK-RETURN.                                              ELC50PD
 10049      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10050      GO TO 9990-RETURN.                                          ELC50PD
 10051                                                                  ELC50PD
 10052 0299-CERT-NOT-FOUND.                                             ELC50PD
 10053                                                                  ELC50PD
 10054     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10055                                                                  ELC50PD
 10056     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10057         IF WS-ERROR = ER-2799                                    ELC50PD
 10058             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10059                                                                  ELC50PD
 10060     IF NOT PB-CANCELLATION                                       ELC50PD
 10061         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10062                                                                  ELC50PD
 10063     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10064     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10065     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10066     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10067                                    PB-CI-LF-TERM                 ELC50PD
 10068                                    PB-C-LF-REM-TERM              ELC50PD
 10069                                    PB-CI-AH-TERM                 ELC50PD
 10070                                    PB-C-AH-REM-TERM              ELC50PD
 10071                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10072                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10073                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10074                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10075                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10076                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10077                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10078                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10079                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10080                                    PB-CI-LOAN-APR                ELC50PD
 10081                                    PB-CI-LOAN-TERM               ELC50PD
 10082                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10083                                    PB-CI-AH-COMMISSION           ELC50PD
 10084                                    PB-CI-CURR-SEQ                ELC50PD
 10085                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10086                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10087                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10088                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10089                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10090                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10091                                    PB-CI-LIVES                   ELC50PD
 10092                                    PB-CI-LF-CRIT-PER             ELC50PD
 10093                                    PB-CI-AH-CRIT-PER
 10094                                    PB-CI-ADDL-CLP
 10095                                    PB-CI-DDF-IU-RATE-UP.
 10096                                                                  ELC50PD
 10097     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10098                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10099                                    PB-CI-DEATH-DT                ELC50PD
 10100                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10101                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10102                                    PB-CI-ENTRY-DT                ELC50PD
 10103                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10104                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10105                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10106                                                                  ELC50PD
 10107     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10108        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10109        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10110                                                                  ELC50PD
 10111     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 10112                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10114                                                                  ELC50PD
 10115 0300-CONTINUE-EDIT.                                              ELC50PD
 10116                                                                  ELC50PD
 10117     IF PB-ISSUE                                                  ELC50PD
 10118        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10119            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10120                                                                  ELC50PD
 10121     IF PB-ISSUE                                                  ELC50PD
 10122        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10123            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10124                                                                  ELC50PD
 10125     IF PB-ISSUE                                                  ELC50PD
 10126       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10127          (AM-NO-AH-ONLY)                                         ELC50PD
 10128           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10129               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10130                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10131                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10132                                                                  ELC50PD
 10133     IF PB-ISSUE                                                  ELC50PD
 10134        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10135        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10136        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10137     ELSE                                                         ELC50PD
 10138        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10139        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10140        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10141                                                                  ELC50PD
 10142     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10143                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10144                                    FORM-MASTER-SW                ELC50PD
 10145                                    WS-APP-CERT-SW.               ELC50PD
 10146                                                                  ELC50PD
 10147     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10148                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10149                                    WS-PL-REF-OVS-AMT             ELC50PD
 10150                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10151                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10152                                    WS-PL-REF-OVS-PCT             ELC50PD
 10153                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10154                                                                  ELC50PD
 10155     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10156       IF PB-ISSUE                                                ELC50PD
 10157         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10158             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10159             IF FORM-MASTER-FOUND                                 ELC50PD
 10160                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10161                                                                  ELC50PD
 10162     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10163        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10164                                                                  ELC50PD
 10165********************** MON CODE **********************            ELC50PD
 10166     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10167     IF PB-ISSUE                                                  ELC50PD
 10168     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10169        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10170             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10171               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10172******************************************************            ELC50PD
 10173                                                                  ELC50PD
 10174     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10175       IF PB-ISSUE                                                ELC50PD
 10176           IF FORM-MASTER-FOUND                                   ELC50PD
 10177             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10178                AM-DISMBR-COVERAGE                                ELC50PD
 10179                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10180                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10181                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10182                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10183                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10184                                                                  ELC50PD
 10185     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10186                                                                  ELC50PD
 10187     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10188         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10189         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10190         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10191         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10192         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10193           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10194             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10195         ELSE                                                     ELC50PD
 10196             NEXT SENTENCE                                        ELC50PD
 10197     ELSE                                                         ELC50PD
 10198         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10199                                                                  ELC50PD
 10200     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10201     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10202     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10203     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10204                                                                  ELC50PD
 10205     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10206     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10207                                                                  ELC50PD
 10208     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10209        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10210         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10211                                                                  ELC50PD
 10212     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10213                                                                  ELC50PD
 10214 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10215                                                                  ELC50PD
 10216     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10217                                                                  ELC50PD
 10218     IF NO-BENEFIT-FOUND                                          ELC50PD
 10219        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10220                                                                  ELC50PD
 10221     IF WS-BEN-CD = '99'                                          ELC50PD
 10222        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10223                                                                  ELC50PD
 10224     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10225         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10226             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10227                                                                  ELC50PD
 10228     MOVE +1                     TO SUB5.                         ELC50PD
 10229     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10230                                                                  ELC50PD
 10231* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10232* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10233     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10234         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10235                                                                  ELC50PD
 10236 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10237                                                                  ELC50PD
 10238     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10239        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10240           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10241                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10242           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10243                                                                  ELC50PD
 10244     IF SUB5 LESS THAN +20                                        ELC50PD
 10245        ADD +1                   TO SUB5                          ELC50PD
 10246        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10247                                                                  ELC50PD
 10248     MOVE +1                     TO SUB5.                         ELC50PD
 10249                                                                  ELC50PD
 10250     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10251        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10252                                                                  ELC50PD
 10253 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10254                                                                  ELC50PD
 10255     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10256        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10257           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10258                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10259           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10260                                                                  ELC50PD
 10261     IF SUB5 LESS THAN +30                                        ELC50PD
 10262        ADD +1                   TO SUB5                          ELC50PD
 10263        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10264                                                                  ELC50PD
 10265     MOVE +1                     TO SUB5.                         ELC50PD
 10266                                                                  ELC50PD
 10267 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10268                                                                  ELC50PD
 10269***************************************************************   ELC50PD
 10270*                                                             *   ELC50PD
 10271*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10272*                                                             *   ELC50PD
 10273*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10274*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10275*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10276*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10277*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10278*           BENEFIT CONTROLS.                                 *   ELC50PD
 10279*      99 = ALL BENEFITS                                      *   ELC50PD
 10280*                                                             *   ELC50PD
 10281***************************************************************   ELC50PD
 10282                                                                  ELC50PD
 10283     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10284                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10285                                                                  ELC50PD
 10286     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10287       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10288        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10289        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10290                                                                  ELC50PD
 10291     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10292       AND                                                        ELC50PD
 10293        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10294        IF CF-REDUCING (SUB3)                                     ELC50PD
 10295           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10296              OR                                                  ELC50PD
 10297           ((AM-IG = '1') AND                                     ELC50PD
 10298           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10299              OR                                                  ELC50PD
 10300           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10301           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10302           (AM-IG NOT = '2'))                                     ELC50PD
 10303              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10304                                                                  ELC50PD
 10305     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10306       AND                                                        ELC50PD
 10307        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10308        IF CF-REDUCING (SUB3)                                     ELC50PD
 10309           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10310              OR                                                  ELC50PD
 10311           ((AM-IG = '2') AND                                     ELC50PD
 10312           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10313              OR                                                  ELC50PD
 10314           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10315           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10316           (AM-IG NOT = '1'))                                     ELC50PD
 10317              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10318                                                                  ELC50PD
 10319     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10320       AND                                                        ELC50PD
 10321        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10322        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10323           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10324              OR                                                  ELC50PD
 10325           ((AM-IG = '1') AND                                     ELC50PD
 10326           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10327              OR                                                  ELC50PD
 10328           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10329           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10330            (AM-IG NOT = '2'))                                    ELC50PD
 10331              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10332                                                                  ELC50PD
 10333     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10334       AND                                                        ELC50PD
 10335        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10336        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10337           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10338              OR                                                  ELC50PD
 10339           ((AM-IG = '2') AND                                     ELC50PD
 10340           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10341              OR                                                  ELC50PD
 10342           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10343           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10344           (AM-IG NOT = '1'))                                     ELC50PD
 10345              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10346                                                                  ELC50PD
 10347     IF SUB5 LESS THAN +20                                        ELC50PD
 10348        ADD +1                   TO SUB5                          ELC50PD
 10349        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10350                                                                  ELC50PD
 10351     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10352                                                                  ELC50PD
 10353     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10354        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10355                                                                  ELC50PD
 10356     MOVE +1                     TO SUB5.                         ELC50PD
 10357                                                                  ELC50PD
 10358 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10359                                                                  ELC50PD
 10360     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10361                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10362                                                                  ELC50PD
 10363     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10364       AND                                                        ELC50PD
 10365        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10366        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10367                                                                  ELC50PD
 10368     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10369       AND                                                        ELC50PD
 10370        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10371        IF CF-REDUCING (SUB3)                                     ELC50PD
 10372           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10373              OR                                                  ELC50PD
 10374           ((AM-IG = '1') AND                                     ELC50PD
 10375           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10376              OR                                                  ELC50PD
 10377           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10378           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10379           (AM-IG NOT = '2'))                                     ELC50PD
 10380              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10381                                                                  ELC50PD
 10382     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10383       AND                                                        ELC50PD
 10384        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10385        IF CF-REDUCING (SUB3)                                     ELC50PD
 10386           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10387              OR                                                  ELC50PD
 10388           ((AM-IG = '2') AND                                     ELC50PD
 10389           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10390              OR                                                  ELC50PD
 10391           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10392           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10393           (AM-IG NOT = '1'))                                     ELC50PD
 10394              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10395                                                                  ELC50PD
 10396     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10397       AND                                                        ELC50PD
 10398        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10399        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10400           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10401              OR                                                  ELC50PD
 10402           ((AM-IG = '1') AND                                     ELC50PD
 10403           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10404              OR                                                  ELC50PD
 10405           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10406           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10407            (AM-IG NOT = '2'))                                    ELC50PD
 10408              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10409                                                                  ELC50PD
 10410     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10411       AND                                                        ELC50PD
 10412        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10413        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10414           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10415              OR                                                  ELC50PD
 10416           ((AM-IG = '2') AND                                     ELC50PD
 10417           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10418              OR                                                  ELC50PD
 10419           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10420           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10421           (AM-IG NOT = '1'))                                     ELC50PD
 10422              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10423                                                                  ELC50PD
 10424     IF SUB5 LESS THAN +30                                        ELC50PD
 10425        ADD +1                   TO SUB5                          ELC50PD
 10426        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10427                                                                  ELC50PD
 10428     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10429                                                                  ELC50PD
 10430 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10431                                                                  ELC50PD
 10432     MOVE +99                    TO SUB5.                         ELC50PD
 10433                                                                  ELC50PD
 10434     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10435        IF PB-ISSUE                                               ELC50PD
 10436           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10437           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10438                                                                  ELC50PD
 10439     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10440                                                                  ELC50PD
 10441 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10442                                                                  ELC50PD
 10443     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10444        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10445                                                                  ELC50PD
 10446     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10447     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10448     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10449     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10450     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10451                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10452     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10453                                                                  ELC50PD
 10454 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10455                                                                  ELC50PD
 10456     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10457     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10458                                                                  ELC50PD
 10459 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10460                                                                  ELC50PD
 10461     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10462     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10463     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10464     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10465     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10466     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10467     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10468     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10469                                 TO PLAN-REVISION-NO.             ELC50PD
 10470                                                                  ELC50PD
 10471     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10472     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10473                                                                  ELC50PD
 10474     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10475       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10476         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10477            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10478             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10479             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10480             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10481                                                                  ELC50PD
 10482     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10483        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10484                                                                  ELC50PD
 10485 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10486                                                                  ELC50PD
 10487     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10488        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10489        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10490        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10491        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10492        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10493        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10494        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10495        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10496          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10497                                                                  ELC50PD
 10498     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10499                                                                  ELC50PD
 10500     IF  PB-CANCELLATION                                          ELC50PD
 10501         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10502                                                                  ELC50PD
 10503     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10504        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10505           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10506           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10507              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10508              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10509           ELSE                                                   ELC50PD
 10510              NEXT SENTENCE                                       ELC50PD
 10511        ELSE                                                      ELC50PD
 10512           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10513              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10514                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10515                                                                  ELC50PD
 10516 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10517                                                                  ELC50PD
 10518     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10519                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10520     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10521        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10522                                                                  ELC50PD
 10523     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10524        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10525        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10526                                                                  ELC50PD
 10527     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10528        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10529                                                                  ELC50PD
 10530     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10531        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10532                                                                  ELC50PD
 10533     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10534        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10535                                                                  ELC50PD
 10536     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10537        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10538                                                                  ELC50PD
 10539     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10540        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10541                                                                  ELC50PD
 10542     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10543                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10544        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10545                                                                  ELC50PD
 10546     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10547                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10548        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10549                                                                  ELC50PD
 10550     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10551                          PL-SALES-TAX > +0                       ELC50PD
 10552         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10553                                                                  ELC50PD
 10554     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10555        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10556                                    WS-IG-OVRD-AM.                ELC50PD
 10557                                                                  ELC50PD
 10558 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10559                                                                  ELC50PD
 10560     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10561                                                                  ELC50PD
 10562     IF PB-ISSUE                                                  ELC50PD
 10563        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10564     ELSE                                                         ELC50PD
 10565        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10566                                                                  ELC50PD
 10567     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10568     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10569     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10570     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10571     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10572                                         WS-LF-REFUND-CALC.       ELC50PD
 10573                                                                  ELC50PD
 10574     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10575        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10576                                                                  ELC50PD
 10577     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10578        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10579
 10580     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10581                                                                  ELC50PD
 10582     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10583     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10584     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10585     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10586     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10587     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10588                                                                  ELC50PD
 10589     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10590        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10591         NEXT SENTENCE                                            ELC50PD
 10592     ELSE                                                         ELC50PD
 10593         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10594            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10595               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10596                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10597                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10598                                                                  ELC50PD
 10599     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10600     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10601                                                                  ELC50PD
 10602     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10603                                                                  ELC50PD
 10604 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10605                                                                  ELC50PD
 10606     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10607     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10609                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10611                                                                  ELC50PD
 10612 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10613                                                                  ELC50PD
 10614     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10615                                    PLAN-MASTER-AH-SW.            ELC50PD
 10616                                                                  ELC50PD
 10617     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10618                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10619                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10620                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10621                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10622                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10623                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10624     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10625                                                                  ELC50PD
 10626                                                                  ELC50PD
 10627     if pb-issue
 10628        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10629           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10630        end-if
 10631        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10632           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10633           GO TO 0399-BENEFIT-NOT-FOUND
 10634        end-if
 10635     end-if
 10636                                                                  ELC50PD
 10637     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10638        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10639                                                                  ELC50PD
 10640     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10641                                                                  ELC50PD
 10642     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10643         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10644         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10645         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10646         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10647           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10648             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10649         ELSE                                                     ELC50PD
 10650             NEXT SENTENCE                                        ELC50PD
 10651     ELSE                                                         ELC50PD
 10652         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10653                                                                  ELC50PD
 10654     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10655     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10656     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10657     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10658                                                                  ELC50PD
 10659     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10660     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10661                                                                  ELC50PD
 10662     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10663        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10664          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10665                                                                  ELC50PD
 10666     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10667                                                                  ELC50PD
 10668 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10669                                                                  ELC50PD
 10670     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10671                                                                  ELC50PD
 10672     IF NO-BENEFIT-FOUND                                          ELC50PD
 10673         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10674                                                                  ELC50PD
 10675     IF WS-BEN-CD = '99'                                          ELC50PD
 10676        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10677                                                                  ELC50PD
 10678     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10679         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10680             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10681                                                                  ELC50PD
 10682     MOVE +1                     TO SUB5.                         ELC50PD
 10683     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10684                                                                  ELC50PD
 10685* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10686* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10687     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10688         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10689                                                                  ELC50PD
 10690 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10691                                                                  ELC50PD
 10692     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10693        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10694           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10695                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10696           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10697                                                                  ELC50PD
 10698     IF SUB5 LESS THAN +20                                        ELC50PD
 10699        ADD +1                   TO SUB5                          ELC50PD
 10700        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10701                                                                  ELC50PD
 10702     MOVE +1                     TO SUB5.                         ELC50PD
 10703                                                                  ELC50PD
 10704     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10705        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10706                                                                  ELC50PD
 10707 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10708                                                                  ELC50PD
 10709     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10710        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10711           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10712                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10713           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10714                                                                  ELC50PD
 10715     IF SUB5 LESS THAN +30                                        ELC50PD
 10716        ADD +1                   TO SUB5                          ELC50PD
 10717        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10718                                                                  ELC50PD
 10719     MOVE +1                     TO SUB5.                         ELC50PD
 10720                                                                  ELC50PD
 10721 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10722                                                                  ELC50PD
 10723***************************************************************   ELC50PD
 10724*                                                             *   ELC50PD
 10725*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10726*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10727*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10728*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10729*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10730*           BENEFIT CONTROLS.                                 *   ELC50PD
 10731*      99 = ALL BENEFITS.                                     *   ELC50PD
 10732*                                                             *   ELC50PD
 10733***************************************************************   ELC50PD
 10734                                                                  ELC50PD
 10735     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10736                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10737                                                                  ELC50PD
 10738     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10739       AND                                                        ELC50PD
 10740        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10741        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10742                                                                  ELC50PD
 10743     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10744       AND                                                        ELC50PD
 10745        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10746           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10747              OR                                                  ELC50PD
 10748           ((AM-IG = '1') AND                                     ELC50PD
 10749           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10750              OR                                                  ELC50PD
 10751           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10752           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10753           (AM-IG NOT = '2'))                                     ELC50PD
 10754              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10755                                                                  ELC50PD
 10756     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10757       AND                                                        ELC50PD
 10758        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10759           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10760              OR                                                  ELC50PD
 10761           ((AM-IG = '2') AND                                     ELC50PD
 10762           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10763              OR                                                  ELC50PD
 10764           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10765           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10766           (AM-IG NOT = '1'))                                     ELC50PD
 10767              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10768                                                                  ELC50PD
 10769     IF SUB5 LESS THAN +20                                        ELC50PD
 10770        ADD +1                   TO SUB5                          ELC50PD
 10771        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10772                                                                  ELC50PD
 10773     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10774        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10775                                                                  ELC50PD
 10776     MOVE +1                    TO SUB5.                          ELC50PD
 10777                                                                  ELC50PD
 10778 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10779                                                                  ELC50PD
 10780     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10781                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10782                                                                  ELC50PD
 10783     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10784       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10785        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10786        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10787                                                                  ELC50PD
 10788     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10789       AND                                                        ELC50PD
 10790        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10791           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10792              OR                                                  ELC50PD
 10793           ((AM-IG = '1') AND                                     ELC50PD
 10794           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10795              OR                                                  ELC50PD
 10796           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10797           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10798           (AM-IG NOT = '2'))                                     ELC50PD
 10799              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10800                                                                  ELC50PD
 10801     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10802       AND                                                        ELC50PD
 10803        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10804           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10805              OR                                                  ELC50PD
 10806           ((AM-IG = '2') AND                                     ELC50PD
 10807           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10808              OR                                                  ELC50PD
 10809           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10810           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10811           (AM-IG NOT = '1'))                                     ELC50PD
 10812              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10813                                                                  ELC50PD
 10814     IF SUB5 LESS THAN +30                                        ELC50PD
 10815        ADD +1                   TO SUB5                          ELC50PD
 10816        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10817                                                                  ELC50PD
 10818 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10819                                                                  ELC50PD
 10820     MOVE +99                    TO SUB5.                         ELC50PD
 10821                                                                  ELC50PD
 10822     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10823                                                                  ELC50PD
 10824     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10825        IF PB-ISSUE                                               ELC50PD
 10826           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10827           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10828                                                                  ELC50PD
 10829     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10830                                                                  ELC50PD
 10831 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10832                                                                  ELC50PD
 10833     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10834         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10835                                                                  ELC50PD
 10836     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10837     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10838     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10839     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10840     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10841                                    PLAN-MASTER-AH-SW.            ELC50PD
 10842*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10843     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10844                                                                  ELC50PD
 10845 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10846                                                                  ELC50PD
 10847     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10848     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10849                                                                  ELC50PD
 10850 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10851                                                                  ELC50PD
 10852     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10853     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10854     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10855     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10856     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10857     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10858     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10859     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10860                                 TO PLAN-REVISION-NO.             ELC50PD
 10861                                                                  ELC50PD
 10862     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10863     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10864                                                                  ELC50PD
 10865     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10866       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10867         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10868            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10869             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10870             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10871             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10872                                                                  ELC50PD
 10873     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10874        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10875                                                                  ELC50PD
 10876 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10877                                                                  ELC50PD
 10878     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10879        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10880        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10881        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10882        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10883        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10884        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10885        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10886        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10887          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10888                                                                  ELC50PD
 10889     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10890                                                                  ELC50PD
 10891     IF  PB-CANCELLATION                                          ELC50PD
 10892         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10893                                                                  ELC50PD
 10894     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10895       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10896          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10897          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10898             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10899             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10900          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10901             NEXT SENTENCE                                        ELC50PD
 10902       ELSE                                                       ELC50PD
 10903          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10904             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10905                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10906                                                                  ELC50PD
 10907 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10908                                                                  ELC50PD
 10909     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10910                                                                  ELC50PD
 10911     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10912        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10913                                                                  ELC50PD
 10914     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10915        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10916        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10917                                                                  ELC50PD
 10918     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10919        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10920                                                                  ELC50PD
 10921     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10922        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10923                                                                  ELC50PD
 10924     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10925        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10926                                                                  ELC50PD
 10927     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10928        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10929                                                                  ELC50PD
 10930     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10931        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10932                                                                  ELC50PD
 10933     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 10934                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10935        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 10936                                                                  ELC50PD
 10937     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 10938                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10939        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 10940                                                                  ELC50PD
 10941     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10942        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 10943        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 10944            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 10945                                                                  ELC50PD
 10946 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 10947                                                                  ELC50PD
 10948     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 10949                                                                  ELC50PD
 10950     IF PB-ISSUE                                                  ELC50PD
 10951        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 10952       ELSE                                                       ELC50PD
 10953        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 10954                                                                  ELC50PD
 10955     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 10956     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 10957     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 10958     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10959                                         WS-AH-REFUND-CALC.       ELC50PD
 10960                                                                  ELC50PD
 10961     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10962        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 10963                                                                  ELC50PD
 10964     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10965        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 10966
 10967     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 10968                                                                  ELC50PD
 10969     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 10970     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 10971     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 10972     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 10973     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 10974     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 10975                                                                  ELC50PD
 10976     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10977        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10978         NEXT SENTENCE                                            ELC50PD
 10979     ELSE                                                         ELC50PD
 10980         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10981            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 10982                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 10983                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 10984                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 10985                                                                  ELC50PD
 10986     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 10987     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 10988                                                                  ELC50PD
 10989     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 10990                                                                  ELC50PD
 10991 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 10992                                                                  ELC50PD
 10993     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 10994     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 10995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10996                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10998                                                                  ELC50PD
 10999 0400-FIND-CARRIER.                                               ELC50PD
 11000                                                                  ELC50PD
 11001     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11002                                                                  ELC50PD
 11003     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11004     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11005     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11006     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11007                                                                  ELC50PD
 11008*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11009     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11010                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11011                                                                  ELC50PD
 11012     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11013     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11014                                                                  ELC50PD
 11015     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11016        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11017                                                                  ELC50PD
 11018 0400-BUILD-CARR-TOL.                                             ELC50PD
 11019                                                                  ELC50PD
 11020     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11021        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11022        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11023                                    WS-TOL-AH-PREM.               ELC50PD
 11024                                                                  ELC50PD
 11025     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11026        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11027        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11028                                    WS-TOL-AH-REFUND.             ELC50PD
 11029                                                                  ELC50PD
 11030     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11031        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11032        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11033                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11034                                                                  ELC50PD
 11035     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11036        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11037        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11038                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11039                                                                  ELC50PD
 11040     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11041        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11042        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11043                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11044                                                                  ELC50PD
 11045     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11046        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11047        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11048                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11049                                                                  ELC50PD
 11050     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11051         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11052                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11053                                                                  ELC50PD
 11054     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11055     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11056        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11057     END-IF
 11058     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11059        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11060     END-IF
 11061     IF WS-TOL-CLP-PCT = ZEROS
 11062        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11063     END-IF
 11064
 11065     IF WS-SPP-LEASE-COMM = ZEROS
 11066        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11067     END-IF
 11068
 11069     GO TO 0400-FIND-ERPDEF.
 11070                                                                  ELC50PD
 11071 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11072                                                                  ELC50PD
 11073     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11074     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11075                                                                  ELC50PD
 11076 0400-FIND-ERPDEF.
 11077
 11078     IF PB-COMPANY-ID = 'DCC'
 11079        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11080        CONTINUE
 11081     ELSE
 11082        GO TO 0400-FIND-ERCOMP
 11083     END-IF
 11084
 11085     MOVE ' '                    TO PDEF-MASTER-SW
 11086     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11087     MOVE PB-STATE               TO ERPDEF-STATE
 11088     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11089     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11090     IF PB-ISSUE
 11091        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11092     ELSE
 11093        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11094     END-IF
 11095     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11096     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11097     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11098     IF PDEF-MASTER-FOUND
 11099        MOVE 'N'                 TO PDEF-MASTER-SW
 11100        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11101        IF PDEF-MASTER-FOUND
 11102           IF (ERPDEF-KEY-SAVE (1:16) =
 11103                        PD-CONTROL-PRIMARY (1:16))
 11104              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11105              CONTINUE
 11106           ELSE
 11107              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11108              IF (ERPDEF-KEY-SAVE (1:16) =
 11109                        PD-CONTROL-PRIMARY (1:16))
 11110                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11111                 CONTINUE
 11112              ELSE
 11113                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11114              END-IF
 11115           END-IF
 11116        END-IF
 11117        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11118     END-IF
 11119     IF PDEF-MASTER-FOUND
 11120        IF PD-TRUNCATED = 'Y'
 11121           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11122        END-IF
 11123     END-IF
 11124
 11125     .
 11126 0400-FIND-ERCOMP.
 11127
 11128     IF PB-COMPANY-ID = 'DCC'
 11129        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11130           (WS-SUB1 > +10)
 11131           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11132                 OR 'A' OR 'N'
 11133              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11134              MOVE PB-CARRIER    TO COMP-CARRIER
 11135              MOVE PB-GROUPING   TO COMP-GROUPING
 11136              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11137              MOVE AM-AGT (WS-SUB1)
 11138                                 TO COMP-FIN-RESP
 11139              MOVE 'G'           TO COMP-TYPE
 11140              PERFORM 8582-READ-COMPENSATION-MASTER
 11141                                 THRU 8582-EXIT
 11142              IF COMP-MASTER-FOUND
 11143                 IF CO-GA-INACTIVE
 11144                    MOVE ER-2763 TO WS-ERROR
 11145                    PERFORM 9900-ERROR-FORMAT
 11146                                 THRU 9900-EXIT
 11147                    MOVE +11     TO WS-SUB1
 11148                 END-IF
 11149                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11150                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11151                    MOVE ER-2788 TO WS-ERROR
 11152                    PERFORM 9900-ERROR-FORMAT
 11153                                 THRU 9900-EXIT
 11154                    MOVE +11     TO WS-SUB1
 11155                 END-IF
 11156              END-IF
 11157           END-IF
 11158        END-PERFORM
 11159     END-IF
 11160
 11161     IF PB-COMPANY-ID = 'DCC'
 11162        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11163           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11164                                    WS-CLP-STATE
 11165        ELSE
 11166           MOVE SPACES           TO PB-I-CLP-STATE
 11167                                    WS-CLP-STATE
 11168        END-IF
 11169     END-IF
 11170
 11171     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11172        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11173        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11174        CONTINUE
 11175     ELSE
 11176        GO TO 0400-FIND-STATE-RECORD
 11177     END-IF
 11178
 11179     MOVE SPACES                 TO WS-CLP-STATE
 11180     MOVE +0                     TO WS-BANK-FEE
 11181                                    WS-BANK-LFEE
 11182                                    WS-BANK-NOCHRGB
 11183
 11184     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11185
 11186     IF (PB-ISSUE)
 11187        AND (PB-I-BANK-NUMBER NOT =
 11188            SPACES AND ZEROS AND LOW-VALUES)
 11189        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11190     ELSE
 11191        IF (PB-CANCELLATION)
 11192           AND (PB-CI-BANK-NUMBER NOT =
 11193                SPACES AND ZEROS AND LOW-VALUES)
 11194           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11195        END-IF
 11196     END-IF
 11197
 11198     IF COMP-FIN-RESP NOT = LOW-VALUES
 11199        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11200        MOVE PB-CARRIER          TO COMP-CARRIER
 11201        MOVE PB-GROUPING         TO COMP-GROUPING
 11202        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11203        MOVE 'B'                 TO COMP-TYPE
 11204        PERFORM 8582-READ-COMPENSATION-MASTER
 11205                                 THRU 8582-EXIT
 11206        IF COMP-MASTER-FOUND
 11207           IF CO-MAX-BANK-FEE NOT NUMERIC
 11208              MOVE +0            TO CO-MAX-BANK-FEE
 11209           END-IF
 11210           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11211              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11212           END-IF
 11213           IF CO-GA-INACTIVE
 11214              MOVE ER-2763       TO WS-ERROR
 11215              PERFORM 9900-ERROR-FORMAT
 11216                                 THRU 9900-EXIT
 11217           END-IF
 11218           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11219              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11220              MOVE ER-2788 TO WS-ERROR
 11221              PERFORM 9900-ERROR-FORMAT
 11222                                 THRU 9900-EXIT
 11223              MOVE +11     TO WS-SUB1
 11224           END-IF
 11225           IF WS-AH-BEN-CATEGORY = 'G'
 11226              MOVE CO-MAX-BANK-FEE
 11227                                 TO WS-BANK-FEE
 11228                                    PB-I-BANK-FEE
 11229           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11230              MOVE CO-MAX-BANK-FEE-LEASE
 11231                                 TO WS-BANK-LFEE
 11232                                    PB-I-BANK-FEE
 11233           END-IF
 11234           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11235              AND (WS-AH-REFUND-CALC = 'G'))
 11236                        OR
 11237              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11238              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11239              CONTINUE
 11240           ELSE
 11241              MOVE ER-2789 TO WS-ERROR
 11242              PERFORM 9900-ERROR-FORMAT
 11243                                 THRU 9900-EXIT
 11244           END-IF
 11245           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11246                                    PB-I-CLP-STATE
 11247           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11248           MOVE CO-CARRIER       TO BXRF-CARRIER
 11249           MOVE CO-GROUPING      TO BXRF-GROUPING
 11250           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11251           MOVE BXRF-MAX-REC-LENGTH
 11252                                 TO BXRF-REC-LENGTH
 11253           PERFORM 8584-READ-BANK-CROSS-REF
 11254                                 THRU 8584-EXIT
 11255           IF BXRF-MASTER-FOUND
 11256              MOVE ' '           TO BANK-ACCT-SW
 11257              MOVE BK-BANK-POINTER-CNT
 11258                                 TO BK-BANK-POINTER-CNT
 11259              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11260                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11261                 OR (BANK-ACCT-FOUND)
 11262                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11263                    AND (BK-AM-EXP-DT (WS-SUB1)
 11264                                 > PB-CERT-EFF-DT)
 11265                    AND (BK-AM-EFF-DT (WS-SUB1)
 11266                                 NOT > PB-CERT-EFF-DT)
 11267                    SET BANK-ACCT-FOUND TO TRUE
 11268                 END-IF
 11269              END-PERFORM
 11270              IF NOT BANK-ACCT-FOUND
 11271                 MOVE ZEROS      TO WS-BANK-FEE
 11272                                    WS-BANK-LFEE
 11273                 MOVE ER-2869    TO WS-ERROR
 11274                 PERFORM 9900-ERROR-FORMAT
 11275                                 THRU 9900-EXIT
 11276              ELSE
 11277                 PERFORM 5000-PROCESS-REPS
 11278                                 THRU 5000-EXIT
 11279                 IF AGENT-MASTER-FOUND
 11280                    MOVE +0      TO WS-BANK-FEE
 11281                                    WS-BANK-LFEE
 11282*                   MOVE AG-SPP-FEES (1)
 11283*                                TO PB-I-BANK-FEE
 11284*                                   WS-BANK-FEE
 11285                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11286                       (WS-SUB1 > +10)
 11287                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11288                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11289                       END-IF
 11290                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11291                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11292                       END-IF
 11293                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11294                          AG-SPP-FEES (WS-SUB1)
 11295                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11296                          AG-SPP-LFEES (WS-SUB1)
 11297                    END-PERFORM
 11298                    IF WS-AH-BEN-CATEGORY = 'G'
 11299                       MOVE WS-BANK-FEE
 11300                                 TO PB-I-BANK-FEE
 11301                    ELSE
 11302                       MOVE WS-BANK-LFEE
 11303                                 TO PB-I-BANK-FEE
 11304                    END-IF
 11305                 END-IF
 11306              END-IF
 11307           END-IF
 11308        ELSE
 11309           MOVE ER-2879          TO WS-ERROR
 11310           PERFORM 9900-ERROR-FORMAT
 11311                                 THRU 9900-EXIT
 11312        END-IF
 11313     ELSE
 11314        MOVE ER-2879             TO WS-ERROR
 11315        PERFORM 9900-ERROR-FORMAT
 11316                                 THRU 9900-EXIT
 11317     END-IF
 11318
 11319     IF WS-AH-BEN-CATEGORY = 'G'
 11320        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11321        + WS-BANK-FEE
 11322     ELSE
 11323        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11324        + WS-BANK-LFEE
 11325     END-IF
 11326
 11327     .
 11328 0400-FIND-STATE-RECORD.                                          ELC50PD
 11329                                                                  ELC50PD
 11330     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11331         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11332         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11333         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11334         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11335         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11336             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11337         ELSE                                                     ELC50PD
 11338             NEXT SENTENCE                                        ELC50PD
 11339     ELSE                                                         ELC50PD
 11340         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11341                                                                  ELC50PD
 11342     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11343     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11344     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11345     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11346                                                                  ELC50PD
 11347     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11348     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11349                                                                  ELC50PD
 11350     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11351        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11352        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11353        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11354                                    WS-TOL-AH-CLAIM               ELC50PD
 11355                                    WS-MINIMUM-REFUND             ELC50PD
 11356                                    WS-TOL-LF-PREM                ELC50PD
 11357                                    WS-TOL-AH-PREM                ELC50PD
 11358                                    WS-TOL-LF-REFUND              ELC50PD
 11359                                    WS-TOL-AH-REFUND              ELC50PD
 11360                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11361                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11362                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11363                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11364                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11365                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11366                                    EC-ST-TOL-PREM                ELC50PD
 11367                                    EC-ST-TOL-REFUND              ELC50PD
 11368                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11369                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11370                                    WS-ST-LF-PREM-TAX
 11371                                    WS-ST-AH-PREM-TAX-I
 11372                                    WS-ST-AH-PREM-TAX-G
 11373                                    WS-BANK-FEE
 11374                                    WS-BANK-LFEE
 11375                                    WS-TOL-CLP-PCT
 11376                                    WS-SPP-LEASE-COMM
 11377        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11378                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11379                                    WS-LF-REM-TERM-CALC           ELC50PD
 11380                                    WS-LF-REFUND-CALC             ELC50PD
 11381                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11382                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11383                                    WS-AH-REM-TERM-CALC           ELC50PD
 11384                                    WS-AH-REFUND-CALC
 11385                                    WS-LF-BEN-CATEGORY
 11386                                    WS-AH-BEN-CATEGORY
 11387                                    WS-CLP-STATE
 11388                                    WS-ST-REFUND-CLAIM-FLAG
 11389                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11390                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11391          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11392                                                                  ELC50PD
 11393     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11394                                                                  ELC50PD
 11395 0405-CONTINUE-EDIT.                                              ELC50PD
 11396
 11397     if pb-company-id = 'AHL'
 11398        continue
 11399     else
 11400        IF PB-CERT-PRIME NOT NUMERIC
 11401           MOVE ER-2722          TO WS-ERROR
 11402           PERFORM 9900-ERROR-FORMAT
 11403                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11404        end-if
 11405     END-IF
 11406
 11407*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11408*       MOVE +0                  TO SUB3
 11409*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11410*       IF SUB3 > +0
 11411*          MOVE ER-2722          TO WS-ERROR
 11412*          PERFORM 9900-ERROR-FORMAT
 11413*                                THRU 9900-EXIT
 11414*       END-IF
 11415*    END-IF
 11416
 11417
 11418*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11419*       IF PB-CERT-PRIME NOT NUMERIC
 11420*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11421*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11422*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11423*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11424*
 11425*          MOVE ER-2722          TO WS-ERROR
 11426*          PERFORM 9900-ERROR-FORMAT
 11427*                                THRU 9900-EXIT
 11428*       END-IF
 11429*    END-IF
 11430
 11431     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11432                                                                  ELC50PD
 11433     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11434        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11435                                    WS-TOL-AH-CLAIM.              ELC50PD
 11436                                                                  ELC50PD
 11437     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11438        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11439                                                                  ELC50PD
 11440     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11441        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11442                                                                  ELC50PD
 11443     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11444        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11445                                    WS-TOL-AH-PREM                ELC50PD
 11446        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11447                                                                  ELC50PD
 11448     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11449        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11450                                    WS-TOL-AH-REFUND              ELC50PD
 11451        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11452                                                                  ELC50PD
 11453     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11454        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11455        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11456                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11457                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11458                                                                  ELC50PD
 11459     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11460        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11461        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11462                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11463                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11464                                                                  ELC50PD
 11465     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11466        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11467        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11468                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11469                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11470                                                                  ELC50PD
 11471     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11472        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11473        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11474                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11475                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11476                                                                  ELC50PD
 11477     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11478     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11479                                                                  ELC50PD
 11480     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11481          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11482                                                                  ELC50PD
 11483     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11484     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11485
 11486     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11487                                                                  ELC50PD
 11488     IF CF-ST-LF-PREM-TAX NUMERIC
 11489        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11490     END-IF
 11491     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11492        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11493     END-IF
 11494     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11495        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11496     END-IF
 11497
 11498     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11499         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11500     END-IF.
 11501
 11502     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11503        GO TO 0410-CHECK-AH.                                      ELC50PD
 11504                                                                  ELC50PD
 11505     IF CF-ST-RT-CALC NOT = SPACES
 11506        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11507                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11508     END-IF
 11509
 11510     IF WS-LF-COVERAGE-TYPE = 'R'
 11511        IF WS-LF-EARNINGS-CALC = '5'
 11512           IF CF-ST-RF-LN-CALC > '0'
 11513              MOVE CF-ST-RF-LN-CALC
 11514                                 TO WS-LF-REFUND-CALC
 11515                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11516           END-IF
 11517        ELSE
 11518           IF CF-ST-RF-LR-CALC > '0'
 11519              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11520                                 TO WS-LF-REFUND-CALC
 11521                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11522           END-IF
 11523        END-IF
 11524     ELSE
 11525        IF CF-ST-RF-LL-CALC > '0'
 11526           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11527                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11528        END-IF
 11529     END-IF
 11530
 11531     IF CF-ST-RT-CALC NOT = SPACES
 11532        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11533                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11534     END-IF
 11535
 11536     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11537     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11538                                                                  ELC50PD
 11539     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11540                                                                  ELC50PD
 11541     IF NO-BENEFIT-FOUND                                          ELC50PD
 11542        GO TO 0410-CHECK-AH.                                      ELC50PD
 11543                                                                  ELC50PD
 11544     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11545        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11546                                 TO EC-ST-LF-REM-TERM-CALC
 11547                                    WS-LF-REM-TERM-CALC           ELC50PD
 11548     END-IF
 11549                                                                  ELC50PD
 11550     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11551        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11552                                 TO WS-LF-REFUND-CALC             ELC50PD
 11553                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11554     END-IF
 11555*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11556                                                                  ELC50PD
 11557     .                                                            ELC50PD
 11558 0410-CHECK-AH.                                                   ELC50PD
 11559                                                                  ELC50PD
 11560     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11561        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11562                                                                  ELC50PD
 11563     IF CF-ST-RT-CALC NOT = SPACES
 11564        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11565                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11566     END-IF
 11567
 11568     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11569        IF CF-ST-RF-CP-CALC > '0'
 11570           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11571                                    EC-ST-AH-REFUND-CALC
 11572        END-IF
 11573     ELSE
 11574        IF CF-ST-RF-AH-CALC > '0'
 11575           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11576                                    EC-ST-AH-REFUND-CALC
 11577        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11578     END-IF
 11579     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11580     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11581                                                                  ELC50PD
 11582     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11583                                                                  ELC50PD
 11584     IF NO-BENEFIT-FOUND                                          ELC50PD
 11585        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11586                                                                  ELC50PD
 11587     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11588        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11589                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11590                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11591     END-IF
 11592                                                                  ELC50PD
 11593     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11594        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11595                                 TO WS-AH-REFUND-CALC             ELC50PD
 11596                                    EC-ST-AH-REFUND-CALC
 11597     END-IF
 11598                                                                  ELC50PD
 11599*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11600                                                                  ELC50PD
 11601     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11602                                                                  ELC50PD
 11603 0499-STATE-NOT-FOUND.                                            ELC50PD
 11604                                                                  ELC50PD
 11605     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11606     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11607                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11609                                                                  ELC50PD
 11610 0500-SET-ACCOUNT.                                                ELC50PD
 11611
 11612*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11613
 11614     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11615        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11616        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11617        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11618        MOVE '3'                 TO CNTL-REC-TYPE
 11619        MOVE +0                  TO CNTL-SEQ-NO
 11620
 11621        MOVE '3'                 TO RC-SW-2
 11622        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11623
 11624        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11625           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11626           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11627           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11628                                    WS-ST-AH-PREM-TAX-I
 11629                                    WS-ST-AH-PREM-TAX-G
 11630        ELSE
 11631           IF CF-ST-LF-PREM-TAX NUMERIC
 11632              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11633           END-IF
 11634           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11635              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11636           END-IF
 11637           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11638              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11639           END-IF
 11640        END-IF
 11641        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11642     END-IF
 11643
 11644*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11645*  FOR DCC ONLY
 11646
 11647     IF PB-COMPANY-ID = 'DCC'
 11648
 11649     MOVE ' '                    TO STAT-MASTER-SW
 11650     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11651     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11652     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11653     MOVE PB-STATE               TO ELSTAT-STATE
 11654     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11655        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11656     END-IF
 11657
 11658     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11659     SET BIN-TO-GREG             TO TRUE
 11660     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11661     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11662     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11663
 11664     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11665     IF STAT-MASTER-FOUND
 11666        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11667        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11668        IF STAT-MASTER-FOUND
 11669           IF (ELSTAT-KEY-SAVE (1:12) =
 11670                        SF-CONTROL-PRIMARY (1:12))
 11671              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11672                 MOVE 'F'        TO STAT-MASTER-SW
 11673              ELSE
 11674                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11675                 IF (STAT-MASTER-FOUND)
 11676                    AND (ELSTAT-KEY-SAVE (1:12) =
 11677                        SF-CONTROL-PRIMARY (1:12))
 11678                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11679                    MOVE 'F'     TO STAT-MASTER-SW
 11680                 END-IF
 11681              END-IF
 11682           END-IF
 11683        END-IF
 11684     END-IF
 11685
 11686     IF STAT-MASTER-SW = 'F'
 11687        IF SF-ST-LF-PREM-TAX NUMERIC
 11688           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11689        END-IF
 11690        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11691           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11692        END-IF
 11693        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11694           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11695        END-IF
 11696     END-IF
 11697
 11698     END-IF
 11699
 11700     IF (PB-COMPANY-ID = 'DCC')
 11701        AND (PB-ISSUE)
 11702        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11703        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11704        AND (AM-GPCD = 06)
 11705        MOVE 'Y'                 TO WS-GOOD-HIN
 11706        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11707           MOVE PB-I-VIN         TO WS-WORK-VIN
 11708           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11709              (V1 > 16)
 11710              IF WS-WORK-VIN (V1:1) NUMERIC
 11711                 MOVE WS-WORK-VIN-N (V1)
 11712                                 TO WS-ROW-B-VAL (V1)
 11713              ELSE
 11714                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11715                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11716                    OR (V2 > 26)
 11717                 END-PERFORM
 11718                 IF V2 < 27
 11719                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11720                 ELSE
 11721                    MOVE 'N'     TO WS-GOOD-HIN
 11722                 END-IF
 11723              END-IF
 11724              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11725                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11726              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11727                 WS-ROW-D-VAL (V1)
 11728           END-PERFORM
 11729           MOVE ZEROS            TO WS-VIN-REMAINDER
 11730           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11731             REMAINDER WS-VIN-REMAINDER
 11732           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11733              CONTINUE
 11734           ELSE
 11735              MOVE 'N'           TO WS-GOOD-HIN
 11736           END-IF
 11737        ELSE
 11738           MOVE 'N'              TO WS-GOOD-HIN
 11739        END-IF
 11740        IF WS-GOOD-HIN NOT = 'Y'
 11741           MOVE ER-3826           TO WS-ERROR
 11742           PERFORM 9900-ERROR-FORMAT
 11743                                 THRU 9900-EXIT
 11744        END-IF
 11745     END-IF
 11746
 11747     IF (PB-COMPANY-ID = 'DCC')
 11748        AND (PB-ISSUE)
 11749        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11750        AND (AM-GPCD NOT = 06)
 11751        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11752          MOVE PB-I-VIN          TO WS-WORK-VIN
 11753          MOVE +8                TO V2
 11754          MOVE ZEROS             TO WS-VIN-TOTAL
 11755          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11756           (V1 > 17)
 11757             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11758                MOVE ER-3825     TO WS-ERROR
 11759                PERFORM 9900-ERROR-FORMAT
 11760                                 THRU 9900-EXIT
 11761             ELSE
 11762                IF V1 = 8
 11763                   MOVE 10       TO V2
 11764                END-IF
 11765                IF V1 = 9
 11766                   MOVE 0        TO V2
 11767                END-IF
 11768                IF V1 = 10
 11769                   MOVE 9        TO V2
 11770                END-IF
 11771                IF WS-WORK-VIN (V1:1) NUMERIC
 11772                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11773                    + (WS-WORK-VIN-N (V1) * V2)
 11774                ELSE
 11775                   MOVE WS-WORK-VIN (V1:1)
 11776                                 TO WS-HEX-BYTE
 11777                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11778                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11779                    + (WS-NUM (V3) * V2)
 11780                END-IF
 11781                COMPUTE V2 = V2 - 1
 11782             END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11783          END-PERFORM
 11784          MOVE ZEROS TO WS-VIN-REMAINDER
 11785          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11786             REMAINDER WS-VIN-REMAINDER
 11787          IF ((WS-WORK-VIN (9:1) = 'X')
 11788             AND (WS-VIN-REMAINDER = 10))
 11789                     OR
 11790             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11791             CONTINUE
 11792          ELSE
 11793             MOVE ER-3826        TO WS-ERROR
 11794             PERFORM 9900-ERROR-FORMAT
 11795                                 THRU 9900-EXIT
 11796          END-IF
 11797        ELSE
 11798          MOVE ER-3826           TO WS-ERROR
 11799          PERFORM 9900-ERROR-FORMAT
 11800                                 THRU 9900-EXIT
 11801        END-IF
 11802     END-IF
 11803
 11804
 11805
 11806******************************************************************ELC50PD
 11807******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11808******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11809******* METHODS.                                                  ELC50PD
 11810******************************************************************ELC50PD
 11811     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11812        IF PB-CANCELLATION                                        ELC50PD
 11813           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11814              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11815                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11816                IF FORM-MASTER-FOUND                              ELC50PD
 11817                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11818******************************************************************ELC50PD
 11819                                                                  ELC50PD
 11820     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11821     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11822                                                                  ELC50PD
 11823     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11824     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11825     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11826     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11827                                                                  ELC50PD
 11828                                                                  ELC50PD
 11829     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11830     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11831     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11832                                                                  ELC50PD
 11833     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11834         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11835                                                                  ELC50PD
 11836     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11837         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11838                                                                  ELC50PD
 11839     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11840         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11841                                                                  ELC50PD
 11842     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11843         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11844     ELSE                                                         ELC50PD
 11845         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11846                                                                  ELC50PD
 11847     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11848                                                                  ELC50PD
 11849     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11850         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11851                                                                  ELC50PD
 11852     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11853         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11854                                       WS-IG-OVRD                 ELC50PD
 11855     ELSE                                                         ELC50PD
 11856         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11857             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11858                                       WS-IG-OVRD                 ELC50PD
 11859         ELSE                                                     ELC50PD
 11860             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11861                                       WS-IG-OVRD.                ELC50PD
 11862                                                                  ELC50PD
 11863     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11864         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11865                                       WS-IG-OVRD                 ELC50PD
 11866     ELSE                                                         ELC50PD
 11867         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11868             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11869                                       WS-IG-OVRD                 ELC50PD
 11870         ELSE                                                     ELC50PD
 11871             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11872                                       WS-IG-OVRD.                ELC50PD
 11873                                                                  ELC50PD
 11874     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11875     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11876     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11877     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11878     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11879                                                                  ELC50PD
 11880     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11881     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11882     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11883     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11884                                                                  ELC50PD
 11885     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11886     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11887     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11888     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11889     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11890     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11891     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11892                                                                  ELC50PD
 11893     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11894        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11895     ELSE                                                         ELC50PD
 11896        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11897                                                                  ELC50PD
 11898     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11899        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11900     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11901        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11902                                                                  ELC50PD
 11903        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11904            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11905                                        WS-LF-REFUND-CALC.        ELC50PD
 11906                                                                  ELC50PD
 11907        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11908            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11909                                        WS-LF-REFUND-CALC.        ELC50PD
 11910                                                                  ELC50PD
 11911     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11912         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11913            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11914                                    WS-LF-REFUND-CALC.            ELC50PD
 11915     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11916         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11917            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11918                                    WS-LF-REFUND-CALC.            ELC50PD
 11919     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11920         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11921            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11922                                    WS-LF-REFUND-CALC.            ELC50PD
 11923     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11924         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11925            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11926                                    WS-LF-REFUND-CALC.            ELC50PD
 11927     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11928         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11929            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11930                                    WS-LF-REFUND-CALC.            ELC50PD
 11931     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11932         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11933            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11934                                    WS-LF-REFUND-CALC.            ELC50PD
 11935     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11936         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 11937            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11938                                    WS-LF-REFUND-CALC.            ELC50PD
 11939     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11940         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 11941            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11942                                    WS-LF-REFUND-CALC.            ELC50PD
 11943                                                                  ELC50PD
 11944     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 11945        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11946                                    WS-AH-REFUND-CALC.            ELC50PD
 11947     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 11948        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11949                                    WS-AH-REFUND-CALC.            ELC50PD
 11950     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 11951        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11952                                    WS-AH-REFUND-CALC.            ELC50PD
 11953     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 11954        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11955                                    WS-AH-REFUND-CALC.            ELC50PD
 11956     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11957        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11958                                    WS-AH-REFUND-CALC.            ELC50PD
 11959     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 11960        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11961                                    WS-AH-REFUND-CALC.            ELC50PD
 11962     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 11963        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11964                                    WS-AH-REFUND-CALC.            ELC50PD
 11965                                                                  ELC50PD
 11966     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 11967        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 11968                                    WS-TOL-AH-PREM.               ELC50PD
 11969                                                                  ELC50PD
 11970     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 11971                  AM-OVR-SHT-AMT > 0                              ELC50PD
 11972        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11973                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 11974                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11975                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 11976                                                                  ELC50PD
 11977     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 11978                    AM-OVR-SHT-PCT > 0                            ELC50PD
 11979        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11980                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 11981                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11982                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 11983                                                                  ELC50PD
 11984     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 11985                  AM-TOL-REF-PCT > 0                              ELC50PD
 11986        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 11987                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11988                                                                  ELC50PD
 11989     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 11990                  AM-TOL-REF NUMERIC                              ELC50PD
 11991        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 11992                                    EC-AM-LF-TOL-REFUND           ELC50PD
 11993                                    WS-TOL-AH-REFUND              ELC50PD
 11994                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 11995                                                                  ELC50PD
 11996     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 11997        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 11998                                    WS-TOL-AH-CLAIM.              ELC50PD
 11999                                                                  ELC50PD
 12000     IF AM-CLP-TOL-PCT NOT NUMERIC
 12001        MOVE +0                  TO AM-CLP-TOL-PCT
 12002     END-IF
 12003
 12004     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12005        MOVE +0                  TO AM-SPP-LEASE-COMM
 12006     END-IF
 12007
 12008     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12009        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12010                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12011                                                                  ELC50PD
 12012     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12013        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12014                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12015                                                                  ELC50PD
 12016     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12017        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12018                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12019                                                                  ELC50PD
 12020     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12021        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12022                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12023                                                                  ELC50PD
 12024     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12025        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12026                                                                  ELC50PD
 12027     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12028        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12029                                                                  ELC50PD
 12030     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12031        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12032     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12033        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12034     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12035        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12036     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12037        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12038     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12039        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12040     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12041        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12042                                                                  ELC50PD
 12043     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12044        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12045                                                                  ELC50PD
 12046     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12047        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12048                                                                  ELC50PD
 12049     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12050     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12051                                                                  ELC50PD
 12052     IF PB-CANCELLATION                                           ELC50PD
 12053        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12054                                                                  ELC50PD
 12055     MOVE +1 TO SUB1.                                             ELC50PD
 12056     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12057     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12058                                                                  ELC50PD
 12059     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12060       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12061         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12062        ELSE                                                      ELC50PD
 12063         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12064                                                                  ELC50PD
 12065  0525-FIND-ACCT-COMM.                                            ELC50PD
 12066     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12067        NEXT SENTENCE                                             ELC50PD
 12068      ELSE                                                        ELC50PD
 12069         ADD +1 TO SUB1                                           ELC50PD
 12070         IF SUB1 LESS +11                                         ELC50PD
 12071            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12072          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12073             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12074                                                                  ELC50PD
 12075     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12076     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12077                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12078***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12079     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12080         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12081                                                                  ELC50PD
 12082     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12083     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12084                                                                  ELC50PD
 12085                                                                  ELC50PD
 12086 0530-GET-AH-COMP.                                                ELC50PD
 12087     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12088        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12089           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12090                                                                  ELC50PD
 12091     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12092        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12093         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12094         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12095         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12096         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12097     ELSE                                                         ELC50PD
 12098          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12099          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12100          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12101          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12102                                    WS-COMMISSION                 ELC50PD
 12103          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12104          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12105          IF WS-COMMISSION > ZEROS                                ELC50PD
 12106             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12107             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12108          END-IF                                                  ELC50PD
 12109          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12110          IF CTBL-TABLE-FOUND                                     ELC50PD
 12111             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12112                                        PB-I-AH-TERM              ELC50PD
 12113             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12114             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12115             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12116          ELSE                                                    ELC50PD
 12117             IF FIRST-TIME-THROUGH                                ELC50PD
 12118                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12119             ELSE                                                 ELC50PD
 12120                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12121                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12122                                                                  ELC50PD
 12123 0540-NEXT-READ-STEP.                                             ELC50PD
 12124     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12125     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12126                                                                  ELC50PD
 12127 0540-GET-LF-COMP.                                                ELC50PD
 12128     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12129        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12130           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12131                                                                  ELC50PD
 12132     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12133        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12134           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12135           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12136           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12137           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12138           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12139        ELSE                                                      ELC50PD
 12140           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12141           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12142           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12143           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12144                                        WS-COMMISSION             ELC50PD
 12145           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12146           IF WS-COMMISSION > ZEROS                               ELC50PD
 12147              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12148              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12149           END-IF                                                 ELC50PD
 12150           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12151           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12152           IF CTBL-TABLE-FOUND                                    ELC50PD
 12153              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12154              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12155              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12156              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12157           ELSE                                                   ELC50PD
 12158              IF FIRST-TIME-THROUGH                               ELC50PD
 12159                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12160              ELSE                                                ELC50PD
 12161                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12162                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12163                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12164                                                                  ELC50PD
 12165     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12166        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12167           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12168           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12169           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12170           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12171           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12172        ELSE                                                      ELC50PD
 12173           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12174           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12175           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12176           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12177                                        WS-COMMISSION             ELC50PD
 12178           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12179           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12180              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12181              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12182           END-IF                                                 ELC50PD
 12183           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12184           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12185           IF CTBL-TABLE-FOUND                                    ELC50PD
 12186              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12187              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12188              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12189              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12190           ELSE                                                   ELC50PD
 12191              IF FIRST-TIME-THROUGH                               ELC50PD
 12192                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12193              ELSE                                                ELC50PD
 12194                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12195                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12196                                                                  ELC50PD
 12197*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12198                                                                  ELC50PD
 12199 0560-EDIT-CONTINUE.                                              ELC50PD
 12200
 12201     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12202                                    WS-AH-PMF-COMM
 12203*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12204*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12205
 12206     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12207        (SUB1 > +10)
 12208        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12209           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12210           MOVE '0530'           TO CTBL-SW
 12211           MOVE ' '              TO WS-CTBL-READ-SW
 12212           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12213           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12214           MOVE '0540'           TO CTBL-SW
 12215           MOVE ' '              TO WS-CTBL-READ-SW
 12216           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12217        END-IF
 12218     END-PERFORM
 12219
 12220     GO TO 0564-EDIT-CONTINUE
 12221
 12222     .
 12223 0561-CHECK-AH.
 12224
 12225     IF (NO-AH-COVERAGE)
 12226        OR (NO-AH-BENEFIT-MATCH)
 12227        CONTINUE
 12228     ELSE
 12229        IF (AM-A-COM (SUB1) NUMERIC)
 12230           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12231           IF (AM-COM-TYP (SUB1) = 'A')
 12232              AND (WS-AH-PMF-COMM = ZEROS)
 12233              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12234           END-IF
 12235           CONTINUE
 12236        ELSE
 12237           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12238           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12239           MOVE PB-AH-OVERRIDE-L1
 12240                                 TO CTBL-BEN-TYPE
 12241           MOVE ZEROS            TO WS-SUB1
 12242                                    WS-COMMISSION
 12243           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12244           PERFORM 8300-READ-CTBL-TABLE
 12245                                 THRU 8300-EXIT
 12246           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12247              IF (AM-COM-TYP (SUB1) = 'A')
 12248                 AND (WS-AH-PMF-COMM = ZEROS)
 12249                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12250                                        PB-I-AH-TERM
 12251                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12252                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12253              END-IF
 12254              CONTINUE
 12255           ELSE
 12256              IF FIRST-TIME-THROUGH
 12257                 GO TO 0561-CHECK-AH
 12258              ELSE
 12259                 MOVE ER-2609    TO WS-ERROR
 12260                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12261              END-IF
 12262           END-IF
 12263        END-IF
 12264     END-IF
 12265
 12266     .
 12267 0561-EXIT.
 12268     EXIT.
 12269
 12270 0563-CHECK-LF.
 12271
 12272     IF (NO-LIFE-COVERAGE)
 12273        OR (NO-LF-BENEFIT-MATCH)
 12274        CONTINUE
 12275     ELSE
 12276        IF WS-LF-JOINT-INDICATOR = 'J'
 12277           IF AM-J-COM (SUB1) NUMERIC
 12278              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12279              IF (AM-COM-TYP (SUB1) = 'A')
 12280                 AND (WS-LF-PMF-COMM = ZEROS)
 12281                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12282              END-IF
 12283              CONTINUE
 12284           ELSE
 12285              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12286              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12287              MOVE PB-LIFE-OVERRIDE-L1
 12288                                 TO CTBL-BEN-TYPE
 12289              MOVE ZEROS         TO WS-SUB1
 12290                                    WS-COMMISSION
 12291              MOVE AM-J-COMA (SUB1)
 12292                                 TO CTBL-TABLE
 12293              PERFORM 8300-READ-CTBL-TABLE
 12294                                 THRU 8300-EXIT
 12295              IF CTBL-TABLE-FOUND
 12296                 IF (AM-COM-TYP (SUB1) = 'A')
 12297                    AND (WS-LF-PMF-COMM = ZEROS)
 12298                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12299                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12300                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12301                 END-IF
 12302                 CONTINUE
 12303              ELSE
 12304                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12305                    GO TO 0563-CHECK-LF
 12306                 ELSE
 12307                    MOVE ER-2609 TO WS-ERROR
 12308                    PERFORM 9900-ERROR-FORMAT
 12309                                 THRU 9900-EXIT
 12310*                   GO TO 0560-EDIT-CONTINUE
 12311                 END-IF
 12312              END-IF
 12313           END-IF
 12314        ELSE
 12315           IF AM-L-COM (SUB1) NUMERIC
 12316              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12317              IF (AM-COM-TYP (SUB1) = 'A')
 12318                 AND (WS-LF-PMF-COMM = ZEROS)
 12319                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12320              END-IF
 12321              CONTINUE
 12322           ELSE
 12323              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12324              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12325              MOVE PB-LIFE-OVERRIDE-L1
 12326                                 TO CTBL-BEN-TYPE
 12327              MOVE ZEROS         TO WS-SUB1
 12328                                    WS-COMMISSION
 12329              MOVE AM-L-COMA (SUB1)
 12330                                 TO CTBL-TABLE
 12331              PERFORM 8300-READ-CTBL-TABLE
 12332                                 THRU 8300-EXIT
 12333              IF CTBL-TABLE-FOUND
 12334                 CONTINUE
 12335              ELSE
 12336                 IF FIRST-TIME-THROUGH
 12337                    GO TO 0563-CHECK-LF
 12338                 ELSE
 12339                    MOVE ER-2609 TO WS-ERROR
 12340                    PERFORM 9900-ERROR-FORMAT
 12341                                 THRU 9900-EXIT
 12342                 END-IF
 12343              END-IF
 12344           END-IF
 12345        END-IF
 12346     END-IF
 12347
 12348     .
 12349 0563-EXIT.
 12350     EXIT.
 12351
 12352 0564-EDIT-CONTINUE.
 12353                                                                  ELC50PD
 12354     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12355         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12356            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12357            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12358                                                                  ELC50PD
 12359*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12360*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12361*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12362*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12363*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12364*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12365*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12366*         ELSE                                                    ELC50PD
 12367*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12368*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12369
 12370     IF PB-I-BIRTHDAY > LOW-VALUES
 12371        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12372        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12373        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12374        PERFORM 8500-DATE-CONVERT
 12375                                 THRU 8500-EXIT
 12376        IF NO-CONVERSION-ERROR
 12377           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12378           IF PB-I-AGE > ZEROS
 12379              IF WS-WORK-AGE NOT = PB-I-AGE
 12380                 MOVE ER-9501    TO WS-ERROR
 12381                 PERFORM 9900-ERROR-FORMAT
 12382                                 THRU 9900-EXIT
 12383              END-IF
 12384           ELSE
 12385              MOVE WS-WORK-AGE   TO PB-I-AGE
 12386           END-IF
 12387        END-IF
 12388     END-IF
 12389
 12390     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12391                                   WS-INS-AGE-SET
 12392     IF PB-I-AGE = ZEROS                                          ELC50PD
 12393        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12394           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12395                                   WS-INS-AGE-SET
 12396           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12397                                                                  ELC50PD
 12398     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12399                                   WS-AH-EDIT-AGE.                ELC50PD
 12400                                                                  ELC50PD
 12401     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12402        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12403        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12404        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12405        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12406        IF NO-CONVERSION-ERROR
 12407           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12408           IF PB-I-JOINT-AGE > 0
 12409              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12410                 MOVE ER-9503    TO WS-ERROR
 12411                 PERFORM 9900-ERROR-FORMAT
 12412                                 THRU 9900-EXIT
 12413              END-IF
 12414           ELSE
 12415              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12416           END-IF
 12417        ELSE
 12418           MOVE ZEROS            TO PB-I-JOINT-AGE
 12419        END-IF
 12420     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12421
 12422     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12423        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12424                                                                  ELC50PD
 12425     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12426                                   WS-JNT-AGE-SET
 12427     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12428        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12429           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12430           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12431               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12432                                          WS-JNT-AGE-SET
 12433               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12434           END-IF
 12435        END-IF
 12436     END-IF
 12437                                                                  ELC50PD
 12438     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12439     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12440        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12441        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12442            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12443                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12444                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12445            ELSE                                                  ELC50PD
 12446                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12447                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12448                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12449                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12450                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12451                                                                  ELC50PD
 12452     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12453        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12454            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12455                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12456                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12457            ELSE                                                  ELC50PD
 12458                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12459                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12460                                           WS-EDIT-AGE
 12461                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12462                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12463                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12464                                                                  ELC50PD
 12465******************************************************************ELC50PD
 12466*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12467******************************************************************ELC50PD
 12468                                                                  ELC50PD
 12469     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12470        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12471        NEXT SENTENCE                                             ELC50PD
 12472     ELSE                                                         ELC50PD
 12473        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12474          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12475           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12476            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12477           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12478            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12479            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12480                                                                  ELC50PD
 12481     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12482        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12483         NEXT SENTENCE                                            ELC50PD
 12484     ELSE                                                         ELC50PD
 12485         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12486            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12487             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12488                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12489                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12490                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12491                                                                  ELC50PD
 12492     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12493        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12494           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12495           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12496               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12497                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12498                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12499                                                                  ELC50PD
 12500     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12501        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12502           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12503            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12504                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12505                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12506                                                                  ELC50PD
 12507     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12508        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12509           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12510              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12511              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12512              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12513                                                                  ELC50PD
 12514     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12515        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12516           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12517              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12518              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12519              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12520                                                                  ELC50PD
 12521     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12522         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12523            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12524              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12525              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12526
 12527     IF (WS-LF-JOINT-INDICATOR = 'J')
 12528        AND (WS-AH-JOINT-INDICATOR = 'J')
 12529        AND (PB-I-LF-TERM > 120)
 12530        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12531        MOVE ER-2783             TO WS-ERROR
 12532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12533     END-IF
 12534
 12535     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12536                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12537     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12538        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12540        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12541                                                                  ELC50PD
 12542     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12543        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12545        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12546                                                                  ELC50PD
 12547     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12548        NEXT SENTENCE                                             ELC50PD
 12549     ELSE                                                         ELC50PD
 12550        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12551                                                                  ELC50PD
 12552     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12553        IF WS-ERROR = ER-2666                                     ELC50PD
 12554           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12555           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12556
 12557     IF PB-COMPANY-ID = 'CID'
 12558        IF PB-STATE = 'UT' OR 'MO'
 12559           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12560                 OR '76' OR '77')
 12561                      OR
 12562               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12563                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12564                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12565                   OR '2K' OR '2L'))
 12566              AND PB-I-INDV-GRP-CD = 'I'
 12567              MOVE ER-2721             TO WS-ERROR
 12568              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12569           END-IF
 12570        END-IF
 12571     END-IF
 12572                                                                  ELC50PD
 12573     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12574     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12575        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12576     ELSE
 12577        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12578     END-IF
 12579
 12580*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12581*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12582     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12583                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12584                                                                  ELC50PD
 12585     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12586        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12587        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12588        PB-POLICY-IS-VOIDED                                       ELC50PD
 12589*       OR PB-MONTHLY-CERT
 12590         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12591                                                                  ELC50PD
 12592     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12593        IF WS-EDIT-AGE           > +65
 12594           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12595           PERFORM 9900-ERROR-FORMAT
 12596                                 THRU 9900-EXIT
 12597        ELSE
 12598           IF WS-EDIT-AGE        > +55
 12599              MOVE ER-2718       TO WS-ERROR
 12600              PERFORM 9900-ERROR-FORMAT
 12601                                 THRU 9900-EXIT
 12602           END-IF
 12603        END-IF
 12604
 12605     IF PB-COMPANY-ID = 'DCC'
 12606        IF WS-EDIT-AGE           > +65
 12607           MOVE ER-2709          TO WS-ERROR
 12608           PERFORM 9900-ERROR-FORMAT
 12609                                 THRU 9900-EXIT
 12610        END-IF
 12611     END-IF
 12612     .
 12613
 12614 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12615                                                                  ELC50PD
 12616     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12617        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12618                                    EC-AM-LF-MAX-TOT-BEN
 12619        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12620                                                                  ELC50PD
 12621     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12622                                                                  ELC50PD
 12623     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12624         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12625             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12626                                                                  ELC50PD
 12627     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12628        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12629        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12630        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12631                                                                  ELC50PD
 12632     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12633     MOVE +1                     TO SUB2.                         ELC50PD
 12634                                                                  ELC50PD
 12635     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12636        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12637           MOVE +5   TO SUB2                                      ELC50PD
 12638           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12639              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12640              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12641              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12642              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12643                                                                  ELC50PD
 12644     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12645                                                                  ELC50PD
 12646     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12647                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12648                                                                  ELC50PD
 12649 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12650                                                                  ELC50PD
 12651
 12652     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12653        PL-ATT-AGE > +0
 12654        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12655     END-IF
 12656
 12657
 12658
 12659*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12660*       PL-ATT-AGE > +0
 12661*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12662*       IF PB-I-BIRTHDAY > LOW-VALUES
 12663*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12664*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12665*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12666*          SET BIN-PLUS-ELAPSED  TO TRUE
 12667*          PERFORM 8500-DATE-CONVERT
 12668*                                THRU 8500-EXIT
 12669*          IF NO-CONVERSION-ERROR
 12670*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12671*             MOVE ER-2669       TO WS-ERROR
 12672*             PERFORM 9900-ERROR-FORMAT
 12673*                                THRU 9900-EXIT
 12674*          END-IF
 12675*       ELSE
 12676*          IF WS-ATT-AGE >= PL-ATT-AGE
 12677*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12678*             PERFORM 9900-ERROR-FORMAT
 12679*                                THRU 9900-EXIT
 12680*          END-IF
 12681*       END-IF
 12682*    END-IF
 12683
 12684     .
 12685 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12686                                                                  ELC50PD
 12687     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12688        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12689           IF SUB2 GREATER THAN +4                                ELC50PD
 12690              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12691              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12692              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12693                                                                  ELC50PD
 12694     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12695        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12696            SUB2 GREATER THAN +8                                  ELC50PD
 12697             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12698             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12699             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12700             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12701                                                                  ELC50PD
 12702     IF SUB2 > +8
 12703        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12704           AND (PB-I-SIG-SW = 'Y')
 12705           CONTINUE
 12706        ELSE
 12707           MOVE ER-2637          TO WS-ERROR
 12708           PERFORM 9900-ERROR-FORMAT
 12709                                 THRU 9900-EXIT
 12710        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12711        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12712     END-IF
 12713
 12714     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12715     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12716     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12717                                                                  ELC50PD
 12718     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12719        ADD +1  TO SUB2                                           ELC50PD
 12720        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12721                                                                  ELC50PD
 12722     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12723         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12724                                                                  ELC50PD
 12725     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12726        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12727        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12728           AND (PB-I-SIG-SW = 'Y')
 12729           CONTINUE
 12730        ELSE
 12731           MOVE ER-2637          TO WS-ERROR
 12732           PERFORM 9900-ERROR-FORMAT
 12733                                 THRU 9900-EXIT
 12734        END-IF
 12735     END-IF
 12736
 12737     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12738                                                                  ELC50PD
 12739                                                                  ELC50PD
 12740 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12741                                                                  ELC50PD
 12742     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12743        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12744         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12745                                                                  ELC50PD
 12746     IF APP-CERT-USED                                             ELC50PD
 12747         IF SUB2  LESS THAN  +5                                   ELC50PD
 12748             MOVE +5          TO SUB2                             ELC50PD
 12749             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12750                                                                  ELC50PD
 12751     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12752     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12753                                                                  ELC50PD
 12754     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12755                                                                  ELC50PD
 12756 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12757                                                                  ELC50PD
 12758     IF NOT APP-CERT-USED                                         ELC50PD
 12759         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12760                                                                  ELC50PD
 12761     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12762        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12763        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12764        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12765         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12766                                                                  ELC50PD
 12767     IF SUB2 GREATER THAN +4                                      ELC50PD
 12768         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12769            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12770            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12771            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12772             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12773             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12774             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12775         ELSE                                                     ELC50PD
 12776             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12777                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12778                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12779                                                                  ELC50PD
 12780     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12781       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12782          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12783           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12784           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12785           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12786                                                                  ELC50PD
 12787                                                                  ELC50PD
 12788 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12789                                                                  ELC50PD
 12790     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12791        IF PB-I-AH-BENEFIT-AMT > +1250
 12792           MOVE ER-2702          TO WS-ERROR
 12793           PERFORM 9900-ERROR-FORMAT
 12794                                 THRU 9900-EXIT
 12795        END-IF
 12796     END-IF
 12797
 12798     IF (PB-COMPANY-ID = 'DCC')
 12799        AND (PB-MONTHLY-CERT)
 12800        IF PB-I-AH-BENEFIT-AMT > +3000
 12801           MOVE ER-2881          TO WS-ERROR
 12802           PERFORM 9900-ERROR-FORMAT
 12803                                 THRU 9900-EXIT
 12804        END-IF
 12805     END-IF
 12806
 12807     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12808        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12809        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12810                                                                  ELC50PD
 12811     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12812                                                                  ELC50PD
 12813     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12814         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12815             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12816                                                                  ELC50PD
 12817     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12818        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12819        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12820        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12821                                                                  ELC50PD
 12822     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12823     MOVE +1                     TO SUB2.                         ELC50PD
 12824                                                                  ELC50PD
 12825     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12826        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12827           MOVE +5 TO SUB2                                        ELC50PD
 12828           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12829              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12830              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12831              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12832              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12833              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12834                                                                  ELC50PD
 12835     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12836                                                                  ELC50PD
 12837 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12838                                                                  ELC50PD
 12839     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12840        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12841        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12842     END-IF
 12843*       IF WS-ATT-AGE >= PL-ATT-AGE
 12844*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12845*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12846     .
 12847 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12848                                                                  ELC50PD
 12849     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12850        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12851           IF SUB2 GREATER THAN +4                                ELC50PD
 12852              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12853              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12854              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12855                                                                  ELC50PD
 12856     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12857        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12858            SUB2 GREATER THAN +8                                  ELC50PD
 12859             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12860             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12861             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12862             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12863                                                                  ELC50PD
 12864     IF SUB2 > +8
 12865        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12866           AND (PB-I-SIG-SW = 'Y')
 12867           CONTINUE
 12868        ELSE
 12869           MOVE ER-2638          TO WS-ERROR
 12870           PERFORM 9900-ERROR-FORMAT
 12871                                 THRU 9900-EXIT
 12872        END-IF
 12873        GO TO 3000-CONTINUE-EDIT
 12874     END-IF
 12875                                                                  ELC50PD
 12876     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12877        IF WS-ERROR = ER-2638                                     ELC50PD
 12878           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12879                                                                  ELC50PD
 12880     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12881     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12882     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12883     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12884                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12885     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12886        ADD +1                   TO SUB2                          ELC50PD
 12887        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12888                                                                  ELC50PD
 12889     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12890         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12891                                                                  ELC50PD
 12892     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12893        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12894        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12895                                 > PL-LM-AMT (SUB2))
 12896        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12897           AND (PB-I-SIG-SW = 'Y')
 12898           CONTINUE
 12899        ELSE
 12900           MOVE ER-2638          TO WS-ERROR
 12901           PERFORM 9900-ERROR-FORMAT
 12902                                 THRU 9900-EXIT
 12903        END-IF
 12904     END-IF
 12905                                                                  ELC50PD
 12906     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12907         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12908             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12909                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12910                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12911                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12912                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12913                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12914                                                                  ELC50PD
 12915     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12916        IF WS-ERROR = ER-2638                                     ELC50PD
 12917            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12918            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12919            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12920                                                                  ELC50PD
 12921     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12922                                                                  ELC50PD
 12923 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12924                                                                  ELC50PD
 12925     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12926        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12927        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12928                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12929         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12930                                                                  ELC50PD
 12931     IF APP-CERT-USED                                             ELC50PD
 12932         IF SUB2  LESS THAN  +5                                   ELC50PD
 12933             MOVE +5             TO SUB2                          ELC50PD
 12934             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 12935                                                                  ELC50PD
 12936     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 12937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12938                                                                  ELC50PD
 12939     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 12940                                                                  ELC50PD
 12941 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12942                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12943     IF NOT APP-CERT-USED                                         ELC50PD
 12944         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12945                                                                  ELC50PD
 12946     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12947        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12948        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12949        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12950         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12951                                                                  ELC50PD
 12952     IF SUB2 GREATER THAN +4                                      ELC50PD
 12953         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 12954            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12955            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12956            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12957             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12958             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12959             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 12960         ELSE                                                     ELC50PD
 12961             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12962                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12963                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12964                                                                  ELC50PD
 12965     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12966       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12967          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12968           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12969           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12970           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12971                                                                  ELC50PD
 12972******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12974                                                                  ELC50PD
 12975 3000-CONTINUE-EDIT.                                              ELC50PD
 12976                                                                  ELC50PD
 12977     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 12978     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 12979     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 12980     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 12981     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 12982                                                                  ELC50PD
 12983     IF BROWSE-STARTED                                            ELC50PD
 12984        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 12985        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 12986                                                                  ELC50PD
 12987     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 12988        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 12989        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 12990        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 12991*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 12992        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 12993        IF DATE-CONVERSION-ERROR                                  ELC50PD
 12994           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 12995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 12996        ELSE                                                      ELC50PD
 12997           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 12998              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 12999              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13000           ELSE                                                   ELC50PD
 13001              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13002              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13003                                                                  ELC50PD
 13004     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13005     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13006     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13007*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13008     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13009     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13010        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13011     ELSE                                                         ELC50PD
 13012        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13013           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13014           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13015        ELSE                                                      ELC50PD
 13016           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13017              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13018              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13019           ELSE                                                   ELC50PD
 13020             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13021                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13022                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13023                                                                  ELC50PD
 13024 3005-EDIT-CONTINUE.                                              ELC50PD
 13025                                                                  ELC50PD
 13026     IF PB-CANCELLATION                                           ELC50PD
 13027         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13028                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13030******************************************************************ELC50PD
 13031*                  E D I T   I S S U E                           *ELC50PD
 13032******************************************************************ELC50PD
 13033                                                                  ELC50PD
 13034 3020-EDIT-ISSUE.                                                 ELC50PD
 13035                                                                  ELC50PD
 13036      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13037      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13038      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13039      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13040      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13041                                                                  ELC50PD
 13042     IF PB-ISSUE-FORCE
 13043        OR PB-ISSUE-DATE-FORCED
 13044        OR PB-FORCE-OFF
 13045        OR PB-OVERCHARGE-FORCE
 13046        CONTINUE
 13047     ELSE
 13048        MOVE ER-2670             TO WS-ERROR
 13049        PERFORM 9900-ERROR-FORMAT
 13050                                 THRU 9900-EXIT
 13051     END-IF
 13052
 13053     .
 13054 3022-SET-POLICY-STATUS.                                          ELC50PD
 13055                                                                  ELC50PD
 13056     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13057                                                                  ELC50PD
 13058     IF (PB-REISSUED-CERT)
 13059             OR
 13060        ((PB-COMPANY-ID NOT = 'DCC')
 13061         AND (PB-MONTHLY-CERT))
 13062         MOVE '5'                TO PB-I-ENTRY-STATUS
 13063         MOVE 'E'                TO PB-BATCH-ENTRY
 13064     END-IF
 13065
 13066     IF PB-COMPANY-ID = 'DCC'
 13067        IF PB-MONTHLY-CERT
 13068           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13069        END-IF
 13070     END-IF
 13071     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13072         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13073     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13074         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13075     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13076         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13077     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13078         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13079     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13080         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13081                                                                  ELC50PD
 13082     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13083                                                                  ELC50PD
 13084     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13085         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13086         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13087         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13088                                                                  ELC50PD
 13089     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13090        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13091           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13092                                                                  ELC50PD
 13093     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13094        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13095           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13096                                                                  ELC50PD
 13097     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13098         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13099         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13100         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13101         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13102         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13103         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13104         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13105     END-IF
 13106                                                                  ELC50PD
 13107     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13108        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13109         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13110                                                                  ELC50PD
 13111     IF (ACCOUNT-MAST-FOUND)
 13112        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13113        IF PB-REISSUED-CERT
 13114           CONTINUE
 13115        ELSE
 13116           MOVE ER-2608          TO WS-ERROR
 13117           PERFORM 9900-ERROR-FORMAT
 13118                                 THRU 9900-EXIT
 13119         END-IF
 13120     END-IF
 13121                                                                  ELC50PD
 13122     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13123        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13124        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13125                                                                  ELC50PD
 13126**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13127 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13128     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13129        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13130                                                                  ELC50PD
 13131*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13132*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13133*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13134                                                                  ELC50PD
 13135     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13136     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13137     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13138     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13139**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13140                                                                  ELC50PD
 13141     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13142     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13143     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13144     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13145**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13146                                                                  ELC50PD
 13147     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13148        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13150                                                                  ELC50PD
 13151     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13152                                                                  ELC50PD
 13153     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13154                                      WK-FULL-CERT-NO.            ELC50PD
 13155     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13156                                                                  ELC50PD
 13157     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13158                                                                  ELC50PD
 13159     IF PB-VALID-LIFE                                             ELC50PD
 13160        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13161     ELSE                                                         ELC50PD
 13162        IF PB-VALID-AH                                            ELC50PD
 13163          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13164                                                                  ELC50PD
 13165                                                                  ELC50PD
 13166     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13167     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13168     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13169                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13170                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13171                                      DCUA-RETURN-CODE.           ELC50PD
 13172                                                                  ELC50PD
 13173****************************************************************  ELC50PD
 13174*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13175***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13176***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13177***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13178***   TO THIS RECORD.                                        ***  ELC50PD
 13179****************************************************************  ELC50PD
 13180     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13181     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13182     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13183        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13184                                                                  ELC50PD
 13185     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13186        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13187        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13189        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13190                                                                  ELC50PD
 13191     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13192        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13193        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13195        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13196                                                                  ELC50PD
 13197     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13198        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13199        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13201        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13202                                                                  ELC50PD
 13203     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13204        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13205        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13207        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13208                                                                  ELC50PD
 13209     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13210        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13211        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13213        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13214                                                                  ELC50PD
 13215     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13216        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13217        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13219        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13220                                                                  ELC50PD
 13221     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13222        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13223        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13225        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13226                                                                  ELC50PD
 13227     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13228        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13229        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13231        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13232                                                                  ELC50PD
 13233     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13234        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13235        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13236        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13237        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13238                                                                  ELC50PD
 13239     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13240        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13241        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13243        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13244                                                                  ELC50PD
 13245     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13246        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13247        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13249        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13250                                                                  ELC50PD
 13251     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13252        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13253        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13255        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13256                                                                  ELC50PD
 13257     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13258        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13259        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13261        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13262                                                                  ELC50PD
 13263     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13264        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13265        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13267        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13268                                                                  ELC50PD
 13269     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13270        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13271        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13273        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13274                                                                  ELC50PD
 13275     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13276     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13277     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13278     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13279                                                                  ELC50PD
 13280 3024-EDIT-DL7-CONT.                                              ELC50PD
 13281                                                                  ELC50PD
 13282     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13283     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13284     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13285        NEXT SENTENCE                                             ELC50PD
 13286     ELSE                                                         ELC50PD
 13287        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13289                                                                  ELC50PD
 13290******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13291******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13292     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13293        NEXT SENTENCE                                             ELC50PD
 13294     ELSE                                                         ELC50PD
 13295        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13297                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13299****************************************************************  ELC50PD
 13300*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13301****************************************************************  ELC50PD
 13302     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13303     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13304                                                                  ELC50PD
 13305     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13306     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13307        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13308                                                                  ELC50PD
 13309     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13310        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13312        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13313                                                                  ELC50PD
 13314     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13315        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13316        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13317        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13318                                                                  ELC50PD
 13319     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13320        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13322        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13323                                                                  ELC50PD
 13324     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13325        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13327        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13328                                                                  ELC50PD
 13329     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13330     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13331                                                                  ELC50PD
 13332 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13334****************************************************************  ELC50PD
 13335*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13336****************************************************************  ELC50PD
 13337                                                                  ELC50PD
 13338     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13339     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13340     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13341     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13342        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13343                                                                  ELC50PD
 13344     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13345        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13347        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13348                                                                  ELC50PD
 13349     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13350        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13352        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13353                                                                  ELC50PD
 13354     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13355        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13357        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13358                                                                  ELC50PD
 13359     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13360        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13362        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13363                                                                  ELC50PD
 13364     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13365        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13367        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13368                                                                  ELC50PD
 13369     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13370     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13371     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13372                                                                  ELC50PD
 13373 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13375                                                                  ELC50PD
 13376****************************************************************  ELC50PD
 13377*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13378****************************************************************  ELC50PD
 13379                                                                  ELC50PD
 13380     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13381     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13382     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13383     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13384     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13385        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13386                                                                  ELC50PD
 13387     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13388        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13390        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13391                                                                  ELC50PD
 13392     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13393        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13395        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13396                                                                  ELC50PD
 13397     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13398        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13400        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13401                                                                  ELC50PD
 13402     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13403     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13404     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13405                                                                  ELC50PD
 13406 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13408                                                                  ELC50PD
 13409****************************************************************  ELC50PD
 13410*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13411****************************************************************  ELC50PD
 13412                                                                  ELC50PD
 13413     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13414     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13415     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13416        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13418                                                                  ELC50PD
 13419     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13420     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13421     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13422     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13423     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13424     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13425        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13426                                                                  ELC50PD
 13427     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13428        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13430        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13431                                                                  ELC50PD
 13432     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13433        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13435        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13436                                                                  ELC50PD
 13437     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13438        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13440        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13441                                                                  ELC50PD
 13442     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13443        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13445        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13446                                                                  ELC50PD
 13447     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13448        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13450        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13451                                                                  ELC50PD
 13452     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13453        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13455        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13456                                                                  ELC50PD
 13457     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13458     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13459     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13460                                                                  ELC50PD
 13461 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13463                                                                  ELC50PD
 13464     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13465        NEXT SENTENCE                                             ELC50PD
 13466     ELSE                                                         ELC50PD
 13467        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13469                                                                  ELC50PD
 13470     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13471     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13472     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13473                                                                  ELC50PD
 13474     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13475        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13477        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13478                                                                  ELC50PD
 13479     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13480        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13482        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13483                                                                  ELC50PD
 13484     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13485        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13487        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13488                                                                  ELC50PD
 13489     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13490        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13492        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13493                                                                  ELC50PD
 13494     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13495        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13497        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13498                                                                  ELC50PD
 13499     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13500        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13502                                                                  ELC50PD
 13503 3024-EDIT-DL01-CONT.                                             ELC50PD
 13504******************************************************************ELC50PD
 13505***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13506******************************************************************ELC50PD
 13507                                                                  ELC50PD
 13508      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13509      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13510      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13511      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13512        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13513        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13514                                                                  ELC50PD
 13515      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13516                                                                  ELC50PD
 13517      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13518         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13519         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13520         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13521                                                                  ELC50PD
 13522      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13523         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13525         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13526                                                                  ELC50PD
 13527      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13528         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13530         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13531                                                                  ELC50PD
 13532       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13533       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13534       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13535                                                                  ELC50PD
 13536******************************************************************ELC50PD
 13537***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13538******************************************************************ELC50PD
 13539                                                                  ELC50PD
 13540 3024-CHECK-VALID-RATE.                                           ELC50PD
 13541                                                                  ELC50PD
 13542     IF VALID-RATE-CODE                                           ELC50PD
 13543        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13544        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13545        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13546        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13547     ELSE                                                         ELC50PD
 13548         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13549                                                                  ELC50PD
 13550      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13551         IF PB-VALID-LIFE                                         ELC50PD
 13552             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13553             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13554         ELSE                                                     ELC50PD
 13555             IF PB-VALID-AH                                       ELC50PD
 13556                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13557                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13558                                                                  ELC50PD
 13559      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13560         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13562         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13563                                                                  ELC50PD
 13564      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13565         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13567         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13568                                                                  ELC50PD
 13569      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13570         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13572         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13573                                                                  ELC50PD
 13574      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13575         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13576            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13577            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13578            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13579          ELSE                                                    ELC50PD
 13580         IF PB-VALID-LIFE                                         ELC50PD
 13581            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13582          ELSE                                                    ELC50PD
 13583            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13584         END-IF                                                   ELC50PD
 13585         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13586         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13587         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13588         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13589             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13590             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13591           ELSE                                                   ELC50PD
 13592             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13593             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13594             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13595                                                                  ELC50PD
 13596       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13597       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13598       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13599                                                                  ELC50PD
 13600**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13601                                                                  ELC50PD
 13602 3025-EDIT-REINSURANCE.                                           ELC50PD
 13603     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13604         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13605                                                                  ELC50PD
 13606     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13607     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13608     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13609                                      REIN-CODE-2                 ELC50PD
 13610                                      REIN-CODE-3.                ELC50PD
 13611     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13612                                                                  ELC50PD
 13613     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13614                                                                  ELC50PD
 13615     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13616     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13617                                                                  ELC50PD
 13618     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13619     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13620         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13621                                                                  ELC50PD
 13622     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13623     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13624                                   WS-NSP-ST-CD-LF.               ELC50PD
 13625     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13626                                   WS-NSP-ST-CD-AH.               ELC50PD
 13627                                                                  ELC50PD
 13628     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13629                                                                  ELC50PD
 13630 3026-NO-SPEC-TABLE.                                              ELC50PD
 13631                                                                  ELC50PD
 13632     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13633     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13634     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13635                                                                  ELC50PD
 13636 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13637                                                                  ELC50PD
 13638     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13639       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13640                                                                  ELC50PD
 13641     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13642          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13643          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13644           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13645                                                                  ELC50PD
 13646     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13647     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13648     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13649     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13650                                                                  ELC50PD
 13651     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13652     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13653                                                                  ELC50PD
 13654     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13655     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13656         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13657                                                                  ELC50PD
 13658     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13659     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13660                                   WS-NSP-ST-CD-LF.               ELC50PD
 13661     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13662                                   WS-NSP-ST-CD-AH.               ELC50PD
 13663                                                                  ELC50PD
 13664     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13665                                                                  ELC50PD
 13666 3028-NO-REIN-TABLE.                                              ELC50PD
 13667                                                                  ELC50PD
 13668     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13669     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13670     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13671                                                                  ELC50PD
 13672 3040-EDIT-CONTINUE.                                              ELC50PD
 13673                                                                  ELC50PD
 13674     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13675         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13676                                                                  ELC50PD
 13677     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13678         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13679                                                                  ELC50PD
 13680     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13681        AND (NOT PB-MONTHLY-CERT)
 13682        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13683            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13684            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13685                                                                  ELC50PD
 13686     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13687        AND (NOT PB-MONTHLY-CERT)
 13688        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13689            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13690            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13691                                                                  ELC50PD
 13692 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13693
 13694     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13695     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13696         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13697                                                                  ELC50PD
 13698******************************************************************ELC50PD
 13699*                                                                *ELC50PD
 13700*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13701*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13702*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13703*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13704*                                                                *ELC50PD
 13705******************************************************************ELC50PD
 13706                                                                  ELC50PD
 13707     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13708        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13709                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13710                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13711        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13712        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13713        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13714        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13715        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13716*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13717        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13718        IF NO-CONVERSION-ERROR                                    ELC50PD
 13719           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13720                                                                  ELC50PD
 13721******************************************************************ELC50PD
 13722*                                                                *ELC50PD
 13723*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13724*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13725*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13726*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13727*                                                                *ELC50PD
 13728******************************************************************ELC50PD
 13729                                                                  ELC50PD
 13730     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13731          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13732                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13733                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13734          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13735          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13736          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13737          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13738          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13739*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13740          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13741          IF NO-CONVERSION-ERROR                                  ELC50PD
 13742             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13743                                                                  ELC50PD
 13744******************************************************************ELC50PD
 13745*                                                                *ELC50PD
 13746*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13747*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13748*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13749*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13750*                                                                *ELC50PD
 13751******************************************************************ELC50PD
 13752                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13753     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13754        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13755           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13756              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13757              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13758           ELSE                                                   ELC50PD
 13759              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13760              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13761        ELSE                                                      ELC50PD
 13762           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13763              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13764              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13765           ELSE                                                   ELC50PD
 13766              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13767              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13768                                                                  ELC50PD
 13769     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13770        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13771        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13772        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13773        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13774                                    DC-ODD-DAYS-OVER              ELC50PD
 13775          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13776          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13777*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13778          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13779          IF NO-CONVERSION-ERROR                                  ELC50PD
 13780             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13781                                                                  ELC50PD
 13782******************************************************************ELC50PD
 13783*                                                                *ELC50PD
 13784*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13785*                                                                *ELC50PD
 13786******************************************************************ELC50PD
 13787                                                                  ELC50PD
 13788     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13789        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13790                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13791        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13792                                                                  ELC50PD
 13793     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13794         NEXT SENTENCE                                            ELC50PD
 13795     ELSE                                                         ELC50PD
 13796         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13798         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13799                                                                  ELC50PD
 13800     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13801     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13802     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13803*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13804     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13805                                    DC-ELAPSED-DAYS               ELC50PD
 13806                                    DC-ODD-DAYS-OVER.             ELC50PD
 13807                                                                  ELC50PD
 13808     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13809                                                                  ELC50PD
 13810     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13811        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13812                                                                  ELC50PD
 13813     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13814
 13815     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13816        AND (WS-LF-COVERAGE-TYPE = 'L')
 13817        IF (DC-ELAPSED-MONTHS > 1)
 13818                      OR
 13819           ((DC-ELAPSED-MONTHS = 1)
 13820           AND (DC-ODD-DAYS-OVER > 0))
 13821           MOVE ER-2882          TO WS-ERROR
 13822           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13823        END-IF
 13824     END-IF
 13825
 13826     if dc-elapsed-months > 0
 13827        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13828        + dc-odd-days-over
 13829     end-if
 13830
 13831     IF PB-EXT-DAYS-PROCESSING
 13832        CONTINUE
 13833     ELSE
 13834        IF DC-ELAPSED-MONTHS = +0
 13835           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13836        ELSE
 13837           IF (WS-LF-EARNINGS-CALC = '4')
 13838              AND (DC-ELAPSED-MONTHS > ZERO)
 13839              AND (DC-ELAPSED-DAYS > ZERO)
 13840              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13841           ELSE
 13842              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13843                                 THRU 6499-EXIT
 13844              MOVE WS-ODD-DAYS-OVER
 13845                                 TO PB-I-EXTENTION-DAYS
 13846           END-IF
 13847        END-IF
 13848     END-IF
 13849
 13850******************************************************************ELC50PD
 13851*                                                                *ELC50PD
 13852*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13853*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13854*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13855*            AND ANY ODD DAYS.                                   *ELC50PD
 13856*                                                                *ELC50PD
 13857******************************************************************ELC50PD
 13858                                                                  ELC50PD
 13859     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13860                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13861     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13862        IF DC-ELAPSED-DAYS > ZEROS
 13863           MOVE ER-2681          TO WS-ERROR
 13864           PERFORM 9900-ERROR-FORMAT
 13865                                 THRU 9900-EXIT
 13866        END-IF
 13867     END-IF
 13868                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13869     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13870        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13871           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13872           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13873                                                                  ELC50PD
 13874     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13875        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13876         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13877          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13878          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13879          IF WS-LF-EARNINGS-CALC = '4'
 13880             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13881             PB-I-PAY-FREQUENCY
 13882          END-IF
 13883          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13884                                    DC-ODD-DAYS-OVER              ELC50PD
 13885          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13886          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13887*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13888          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13889          IF NO-CONVERSION-ERROR                                  ELC50PD
 13890             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13891             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13892                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13893                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13894                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13895                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13896                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13897*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13898                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13899                  IF NO-CONVERSION-ERROR                          ELC50PD
 13900                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13901                                                                  ELC50PD
 13902* okay, i had to move the new att age edit down here because the
 13903* expiration date could get recalculated and i need the exp date
 13904
 13905
 13906     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13907        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13908        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13909        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13910           AND ZEROS
 13911           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13912           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13913           SET ELAPSED-BETWEEN-BIN TO TRUE
 13914           PERFORM 8500-DATE-CONVERT
 13915                                 THRU 8500-EXIT
 13916           IF NO-CONVERSION-ERROR
 13917              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13918                 MOVE ER-2669       TO WS-ERROR
 13919*                PERFORM 9900-ERROR-FORMAT
 13920*                                THRU 9900-EXIT
 13921              END-IF
 13922           END-IF
 13923        ELSE
 13924           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13925           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13926              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13927*             PERFORM 9900-ERROR-FORMAT
 13928*                                THRU 9900-EXIT
 13929           ELSE
 13930              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13931                 MOVE ER-1570    TO WS-ERROR
 13932                 PERFORM 9900-ERROR-FORMAT
 13933                                 THRU 9900-EXIT
 13934              END-IF
 13935           END-IF
 13936        END-IF
 13937
 13938        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13939           AND ZEROS
 13940           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 13941           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13942           SET ELAPSED-BETWEEN-BIN TO TRUE
 13943           PERFORM 8500-DATE-CONVERT
 13944                                 THRU 8500-EXIT
 13945           IF NO-CONVERSION-ERROR
 13946              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13947                 MOVE ER-2669       TO WS-ERROR
 13948*                PERFORM 9900-ERROR-FORMAT
 13949*                                THRU 9900-EXIT
 13950              END-IF
 13951           END-IF
 13952        ELSE
 13953           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13954             (PB-I-LF-TERM / 12)
 13955           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13956              MOVE ER-2669       TO WS-ERROR
 13957*             PERFORM 9900-ERROR-FORMAT
 13958*                                THRU 9900-EXIT
 13959           ELSE
 13960              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13961                 MOVE ER-1571    TO WS-ERROR
 13962                 PERFORM 9900-ERROR-FORMAT
 13963                                 THRU 9900-EXIT
 13964              END-IF
 13965           END-IF
 13966        END-IF
 13967        IF WS-ERROR = ER-2669
 13968           PERFORM 9900-ERROR-FORMAT
 13969                                 THRU 9900-EXIT
 13970        END-IF
 13971
 13972     END-IF
 13973
 13974     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13975        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 13976         NOT NO-AH-COVERAGE                                       ELC50PD
 13977          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 13978             AND (PB-COMPANY-ID = 'DCC')
 13979             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 13980             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 13981          ELSE
 13982             IF WS-LF-EARNINGS-CALC = '4'
 13983                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 13984                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13985                PB-I-PAY-FREQUENCY
 13986             ELSE
 13987                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 13988                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 13989             END-IF
 13990          END-IF
 13991          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13992                                         DC-ODD-DAYS-OVER         ELC50PD
 13993          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 13994          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13995*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13996          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13997          IF NO-CONVERSION-ERROR                                  ELC50PD
 13998             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 13999
 14000     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14001        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14002        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14003        IF PB-I-BIRTHDAY > LOW-VALUES
 14004           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14005           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14006           SET ELAPSED-BETWEEN-BIN TO TRUE
 14007           PERFORM 8500-DATE-CONVERT
 14008                                 THRU 8500-EXIT
 14009           IF NO-CONVERSION-ERROR
 14010              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14011                 MOVE ER-3054       TO WS-ERROR
 14012*                PERFORM 9900-ERROR-FORMAT
 14013*                                THRU 9900-EXIT
 14014              END-IF
 14015           END-IF
 14016        ELSE
 14017           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14018           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14019              MOVE ER-3054       TO WS-ERROR
 14020*             PERFORM 9900-ERROR-FORMAT
 14021*                                THRU 9900-EXIT
 14022           END-IF
 14023        END-IF
 14024
 14025        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14026           AND ZEROS
 14027           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14028           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14029           SET ELAPSED-BETWEEN-BIN TO TRUE
 14030           PERFORM 8500-DATE-CONVERT
 14031                                 THRU 8500-EXIT
 14032           IF NO-CONVERSION-ERROR
 14033              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14034                 MOVE ER-3054       TO WS-ERROR
 14035*                PERFORM 9900-ERROR-FORMAT
 14036*                                THRU 9900-EXIT
 14037              END-IF
 14038           END-IF
 14039        ELSE
 14040           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14041             (PB-I-AH-TERM / 12)
 14042           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14043              MOVE ER-3054       TO WS-ERROR
 14044*             PERFORM 9900-ERROR-FORMAT
 14045*                                THRU 9900-EXIT
 14046           END-IF
 14047        END-IF
 14048        IF WS-ERROR = ER-3054
 14049           PERFORM 9900-ERROR-FORMAT
 14050                                 THRU 9900-EXIT
 14051        END-IF
 14052
 14053     END-IF
 14054
 14055     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14056                                                                  ELC50PD
 14057     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14058        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14059                                                                     CL**6
 14060     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14061       AND                                                        ELC50PD
 14062        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14063        NEXT SENTENCE                                             ELC50PD
 14064     ELSE                                                            CL**6
 14065        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14066                                                                     CL**6
 14067     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14068        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14069        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14070     ELSE                                                         ELC50PD
 14071        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14072        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14073                                                                  ELC50PD
 14074     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14075*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14076     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14077     IF (NO-CONVERSION-ERROR)
 14078        AND (DC-ELAPSED-MONTHS > +1)
 14079        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14080        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14081        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14082                                                                  ELC50PD
 14083 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14084                                                                  ELC50PD
 14085     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14086        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14087         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14088     ELSE                                                         ELC50PD
 14089         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14090                                                                  ELC50PD
 14091     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14092         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14093     ELSE                                                         ELC50PD
 14094        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14095           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14096           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14098                                                                  ELC50PD
 14099     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14100        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14101        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14102         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14103                                                                  ELC50PD
 14104     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14105                                                                  ELC50PD
 14106 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14107                                                                  ELC50PD
 14108     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14109                                                                  ELC50PD
 14110     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14111         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14112     ELSE                                                         ELC50PD
 14113         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14114            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14115            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14116                                                                  ELC50PD
 14117     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14118                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14119     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14120         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14121                                                                  ELC50PD
 14122     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14123         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14124         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14125                                                                  ELC50PD
 14126                                                                  ELC50PD
 14127 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14128                                                                  ELC50PD
 14129******************************************************************ELC50PD
 14130*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14131******************************************************************ELC50PD
 14132                                                                  ELC50PD
 14133     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14134        NEXT SENTENCE                                             ELC50PD
 14135     ELSE                                                         ELC50PD
 14136        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14137           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14138              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14139              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14140              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14141                  NEXT SENTENCE                                   ELC50PD
 14142           ELSE                                                   ELC50PD
 14143              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14144              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14145                                                                  ELC50PD
 14146     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14147         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14148            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14149            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14150            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14151             NEXT SENTENCE                                        ELC50PD
 14152          ELSE                                                    ELC50PD
 14153              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14154              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14155                                                                  ELC50PD
 14156     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14157        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14158                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14159     IF POLICY-HAS-AH                                             ELC50PD
 14160       AND                                                        ELC50PD
 14161        POLICY-HAS-LIFE                                           ELC50PD
 14162       AND                                                        ELC50PD
 14163        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14164       AND                                                        ELC50PD
 14165        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14166        NEXT SENTENCE                                             ELC50PD
 14167     ELSE                                                         ELC50PD
 14168        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14169                                                                  ELC50PD
 14170     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14171     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14172        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14173                                                                  ELC50PD
 14174     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14175        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14176        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14177                                                                  ELC50PD
 14178 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14179                                                                  ELC50PD
 14180     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14181         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14182            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14183
 14184*    IF PB-COMPANY-ID NOT = 'DCC'
 14185*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14186*          AND 'V' AND 'W' AND 'X'
 14187*          GO TO 3125-EDIT-PMT-FREQ
 14188*       END-IF
 14189*    ELSE
 14190*       IF WS-AH-DCC-TRUNC = 'T'
 14191*          CONTINUE
 14192*       ELSE
 14193*          GO TO 3125-EDIT-PMT-FREQ
 14194*       END-IF
 14195*    END-IF
 14196
 14197
 14198
 14199     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14200                    OR
 14201        ((PB-COMPANY-ID = 'DCC')
 14202        AND (WS-AH-DCC-TRUNC = 'T'))
 14203        CONTINUE
 14204     ELSE
 14205        GO TO 3125-EDIT-PMT-FREQ
 14206     END-IF
 14207
 14208     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14209         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14210                                                                  ELC50PD
 14211     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14212        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14213*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14214        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14215         NEXT SENTENCE                                            ELC50PD
 14216     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14217         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14219                                                                  ELC50PD
 14220     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14221        MOVE ER-3058             TO WS-ERROR
 14222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14223     end-if
 14224                                                                  ELC50PD
 14225     IF WS-STATE-ABBREVIATION = 'NC'
 14226        IF PB-I-LOAN-TERM > +59
 14227           CONTINUE
 14228        ELSE
 14229           MOVE ER-2792          TO WS-ERROR
 14230           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14231        END-IF
 14232     END-IF
 14233                                                                  ELC50PD
 14234     .
 14235 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14236
 14237     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14238         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14239            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14240
 14241     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14242                    OR
 14243        ((PB-COMPANY-ID = 'DCC')
 14244        AND (WS-AH-DCC-TRUNC = 'T'))
 14245                    OR
 14246         (PB-COMPANY-ID = 'AHL')
 14247        CONTINUE
 14248     ELSE
 14249        IF (PB-I-LOAN-TERM > ZEROS)
 14250           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14251           MOVE ER-1575          TO WS-ERROR
 14252           PERFORM 9900-ERROR-FORMAT
 14253                                 THRU 9900-EXIT
 14254        END-IF
 14255     END-IF
 14256
 14257     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14258         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14259            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14260            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14261            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14262         ELSE                                                     ELC50PD
 14263            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14264                                                                  ELC50PD
 14265     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14266         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14268         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14269                                                                  ELC50PD
 14270     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14271         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14273         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14274                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14275     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14276         GIVING WS-TEX-FACT-2                                     ELC50PD
 14277             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14278                                                                  ELC50PD
 14279*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14280*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14281*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14282                                                                  ELC50PD
 14283                                                                  ELC50PD
 14284 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14285                                                                  ELC50PD
 14286     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14287        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14288           MOVE ER-2690          TO WS-ERROR
 14289           PERFORM 9900-ERROR-FORMAT
 14290                                 THRU 9900-EXIT
 14291        ELSE
 14292           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14293           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14294           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14295           MOVE PB-SV-STATE      TO LOFC-STATE
 14296           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14297           MOVE PB-I-LOAN-OFFICER
 14298                                 TO LOFC-CODE
 14299           PERFORM 8586-READ-LOAN-OFFICER
 14300                                 THRU 8586-EXIT
 14301           IF (NOT LOFC-MASTER-FOUND)
 14302              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14303              MOVE ER-3006       TO WS-ERROR
 14304              PERFORM 9900-ERROR-FORMAT
 14305                                 THRU 9900-EXIT
 14306           END-IF
 14307        END-IF
 14308     END-IF
 14309
 14310     .
 14311 3129-EDIT-APR.                                                   ELC50PD
 14312                                                                  ELC50PD
 14313     IF (WS-LF-BENEFIT-CD = ZERO)
 14314        OR (NO-LF-BENEFIT-MATCH)
 14315        IF PB-COMPANY-ID NOT = 'DCC'
 14316           GO TO 3130-EDIT-AGE
 14317*       ELSE
 14318*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14319*             GO TO 3130-EDIT-AGE
 14320*          END-IF
 14321        END-IF
 14322     END-IF
 14323                                                                  ELC50PD
 14324     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14325         AND (PB-I-RATE-CLASS NOT = 'L ')
 14326         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14327         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14328         GO TO 3129-APR-CONT.                                     ELC50PD
 14329                                                                  ELC50PD
 14330     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14331         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14332         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14333         GO TO 3129-APR-CONT.                                     ELC50PD
 14334                                                                  ELC50PD
 14335     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14336         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14337         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14338         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14339         GO TO 3129-APR-CONT.                                     ELC50PD
 14340                                                                  ELC50PD
 14341     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14342        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14343           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14344              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14345              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14346              GO TO 3130-EDIT-AGE.                                ELC50PD
 14347                                                                  ELC50PD
 14348     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14349        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14350        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14351        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14352        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14353        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14354         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14355                                                                  ELC50PD
 14356 3129-APR-CONT.                                                   ELC50PD
 14357     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14358         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14359         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14360                                                                  ELC50PD
 14361     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14362         WS-AH-BENEFIT-CD (1:1) = 'S')
 14363        AND (PB-COMPANY-ID = 'DCC')
 14364        AND (PB-I-LOAN-APR = ZERO)
 14365        MOVE ER-2657             TO WS-ERROR
 14366        PERFORM 9900-ERROR-FORMAT
 14367                                 THRU 9900-EXIT
 14368        GO TO 3130-EDIT-AGE
 14369     END-IF
 14370
 14371     IF PB-I-LOAN-APR = ZERO
 14372        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14373     END-IF
 14374                                                                  ELC50PD
 14375     IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14376        MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14378        GO TO 3130-EDIT-AGE.                                      ELC50PD
 14379                                                                  ELC50PD
 14380*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14381     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000            ELC50PD
 14382        MOVE ER-2657             TO WS-ERROR                      ELC50PD
 14383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14384                                                                  ELC50PD
 14385 3130-EDIT-AGE.                                                   ELC50PD
 14386                                                                  ELC50PD
 14387******************************************************************ELC50PD
 14388*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14389******************************************************************ELC50PD
 14390                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14391     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14392        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14393           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14394               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14395               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14396                                                                  ELC50PD
 14397     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14398        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14399           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14400               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14401               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14402                                                                  ELC50PD
 14403 3133-SEX-CODE.                                                   ELC50PD
 14404     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14405         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14406             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14407          ELSE                                                    ELC50PD
 14408             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14409             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14410                                                                  ELC50PD
 14411     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14412         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14413                                                                  ELC50PD
 14414     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14415         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14416                                                                  ELC50PD
 14417 3134-SIG-SW-EDIT.                                                ELC50PD
 14418     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14419         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14420                                                                  ELC50PD
 14421     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14422         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14423             NEXT SENTENCE                                        ELC50PD
 14424         ELSE                                                     ELC50PD
 14425             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14427     ELSE                                                         ELC50PD
 14428     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14429         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14430             NEXT SENTENCE                                        ELC50PD
 14431         ELSE                                                     ELC50PD
 14432             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14433             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14434     ELSE                                                         ELC50PD
 14435     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14436         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
 14437             NEXT SENTENCE                                        ELC50PD
 14438         ELSE                                                     ELC50PD
 14439             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14440             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14441     ELSE                                                         ELC50PD
 14442         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14443             NEXT SENTENCE                                        ELC50PD
 14444         ELSE                                                     ELC50PD
 14445             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14446             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14447                                                                  ELC50PD
 14448     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14449         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14450             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14451            PB-I-SIG-SW = 'N'                                     ELC50PD
 14452            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14453            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14454                                                                  ELC50PD
 14455 3135-NAME-EDIT.                                                  ELC50PD
 14456                                                                  ELC50PD
 14457     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14458        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14459        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14460           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14461                                 TO PB-I-JOINT-FIRST-NAME
 14462        END-PERFORM
 14463     END-IF
 14464
 14465     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14466        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14467        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14468           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14469                                 TO PB-I-JOINT-LAST-NAME
 14470        END-PERFORM
 14471     END-IF
 14472
 14473     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14474        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14475        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14476           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14477                                 TO PB-I-INSURED-FIRST-NAME
 14478        END-PERFORM
 14479     END-IF
 14480
 14481     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14482        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14483        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14484           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14485                                 TO PB-I-INSURED-LAST-NAME
 14486        END-PERFORM
 14487     END-IF
 14488
 14489     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14490       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14491       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14492           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14493           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14494                                                                  ELC50PD
 14495 3136-EDIT-SEX.                                                   ELC50PD
 14496                                                                  ELC50PD
 14497******************************************************************ELC50PD
 14498*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14499******************************************************************ELC50PD
 14500                                                                  ELC50PD
 14501     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14502        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14503        NEXT SENTENCE                                             ELC50PD
 14504     ELSE                                                         ELC50PD
 14505        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14506           NEXT SENTENCE                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14507        ELSE                                                      ELC50PD
 14508           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14509           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14510                                                                  ELC50PD
 14511 3137-EDIT-EFF-DATE.                                              ELC50PD
 14512                                                                  ELC50PD
 14513     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14514        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14515        PB-POLICY-IS-VOIDED                                       ELC50PD
 14516         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14517                                                                  ELC50PD
 14518     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14519                                    WS-2672-SW.                   ELC50PD
 14520                                                                  ELC50PD
 14521     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14522         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14523             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14524             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14525             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14526                                                                  ELC50PD
 14527     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14528         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14529                                                                  ELC50PD
 14530     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14531     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14532*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14533     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14534     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14535                                    DC-ELAPSED-DAYS.              ELC50PD
 14536     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14537                                                                  ELC50PD
 14538     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14539         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14540                                                                  ELC50PD
 14541     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14542         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14543         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14544         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14545     END-IF
 14546                                                                  ELC50PD
 14547     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14548        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14549        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14550        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14551        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14552                                                                  ELC50PD
 14553     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14554      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14555         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14556         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14558         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14559                                    WS-2672-SW.                   ELC50PD
 14560                                                                  ELC50PD
 14561     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14562         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14563             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14564             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14565         ELSE                                                     ELC50PD
 14566             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14567             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14568                                                                  ELC50PD
 14569                                                                  ELC50PD
 14570 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14571                                                                  ELC50PD
 14572     if pb-company-id not = 'AHL'
 14573        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14574           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14575           MOVE ER-2787          TO WS-ERROR
 14576           PERFORM 9900-ERROR-FORMAT
 14577                                 THRU 9900-EXIT
 14578        END-IF
 14579     end-if
 14580
 14581     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14582        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14583                                 > 250000.00
 14584           MOVE ER-2719          TO WS-ERROR
 14585           PERFORM 9900-ERROR-FORMAT
 14586                                 THRU 9900-EXIT
 14587        END-IF
 14588     END-IF
 14589
 14590     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14591        PB-POLICY-IS-VOIDED                                       ELC50PD
 14592         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14593                                                                  ELC50PD
 14594     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14595        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14596         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14598                                                                  ELC50PD
 14599     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14600        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14601        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14602         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14603                                                                  ELC50PD
 14604     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14605        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14606        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14607         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14608                                                                  ELC50PD
 14609     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14610        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14611        MOVE ER-2631             TO WS-ERROR
 14612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14613     END-IF
 14614                                                                  ELC50PD
 14615                                                                  ELC50PD
 14616******************************************************************ELC50PD
 14617*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14618******************************************************************ELC50PD
 14619                                                                  ELC50PD
 14620     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14621        NEXT SENTENCE                                             ELC50PD
 14622     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14623        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14624           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14625           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14626                                                                  ELC50PD
 14627                                                                  ELC50PD
 14628******************************************************************ELC50PD
 14629*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14630******************************************************************ELC50PD
 14631                                                                  ELC50PD
 14632     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14633        CONTINUE                                                  ELC50PD
 14634     ELSE                                                         ELC50PD
 14635        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14636           IF (NOT PB-COMP-LF-PREM)
 14637              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14638              MOVE ER-2633       TO WS-ERROR
 14639              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14640           END-IF
 14641        END-IF
 14642     END-IF
 14643
 14644     .                                                            ELC50PD
 14645 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14646                                                                  ELC50PD
 14647     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14648        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14649        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14650         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14651                                                                  ELC50PD
 14652     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14653        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14654        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14655        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14656         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14657                                                                  ELC50PD
 14658     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14659        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14660        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14661         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14662                                                                  ELC50PD
 14663     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14664         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14665         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14666                                                                  ELC50PD
 14667******************************************************************ELC50PD
 14668*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14669******************************************************************ELC50PD
 14670                                                                  ELC50PD
 14671     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14672        NEXT SENTENCE                                             ELC50PD
 14673     ELSE                                                         ELC50PD
 14674        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14675           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14676           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14677                                                                  ELC50PD
 14678******************************************************************ELC50PD
 14679*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14680******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14681                                                                  ELC50PD
 14682     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14683        NEXT SENTENCE                                             ELC50PD
 14684     ELSE                                                         ELC50PD
 14685        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14686            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14687                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14688                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14689                                                                  ELC50PD
 14690                                                                  ELC50PD
 14691 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14692* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14693     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14694                                     WS-RES-MUNI-TAX              ELC50PD
 14695                                     PB-I-STATE-TAX               ELC50PD
 14696                                     PB-I-MUNI-TAX.               ELC50PD
 14697                                                                  ELC50PD
 14698     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14699                                                                  ELC50PD
 14700     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14701        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14702                                                                  ELC50PD
 14703     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14704        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14705                                                                  ELC50PD
 14706     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14707        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14708                                                                  ELC50PD
 14709     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14710                             OR 'RIC')                            ELC50PD
 14711        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14712                                                                  ELC50PD
 14713     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14714        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14715            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14716        ELSE                                                      ELC50PD
 14717           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14718               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14719                                                                  ELC50PD
 14720     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14721        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14722                                                                  ELC50PD
 14723     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14724        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14725                                                                  ELC50PD
 14726     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
 14727        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14728           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14729             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14730           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14731           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14732              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14733              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14734              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14735           ELSE                                                   ELC50PD
 14736              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14737                                                                  ELC50PD
 14738 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14739                                                                  ELC50PD
 14740* DMD RATING TEST                                                 ELC50PD
 14741     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14742         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14743         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14744         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14745         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14746         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14747         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14748                                                                  ELC50PD
 14749     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14750         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14751             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14752                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14753                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14754                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14755                                                                  ELC50PD
 14756     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14757         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14758             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14759                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14760                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14761                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14762                                                                  ELC50PD
 14763     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14764        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14765            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14766              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14767                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14768                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14769                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14770                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14771                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14772                                                                  ELC50PD
 14773     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14774        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14775            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14776               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14777               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14778               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14779                                                                  ELC50PD
 14780     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14781        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14782            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14783                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14784                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14785                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14786                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14787                                                                  ELC50PD
 14788     IF WS-ERROR = ER-2693                                        ELC50PD
 14789        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14790           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14791           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14792           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14793                                                                  ELC50PD
 14794     IF WS-ERROR = ER-2693                                        ELC50PD
 14795        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14796           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14797           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14798           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14799                                                                  ELC50PD
 14800     IF WS-ERROR = ER-2693                                        ELC50PD
 14801        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14802           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14803           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14804           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14805                                                                  ELC50PD
 14806     IF WS-ERROR = ER-2693                                        ELC50PD
 14807        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14808           IF WS-LEVEL                                            ELC50PD
 14809              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14810              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14811                                                                  ELC50PD
 14812     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14813         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14814         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14815       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14816             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14817             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14818         NEXT SENTENCE                                            ELC50PD
 14819     ELSE                                                         ELC50PD
 14820         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14821                                                                  ELC50PD
 14822     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14823        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14824           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14825           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14826           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14827                                                                  ELC50PD
 14828     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14829        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14830           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14831           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14832           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14833                                                                  ELC50PD
 14834     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14835                                                                  ELC50PD
 14836     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14837         NEXT SENTENCE                                            ELC50PD
 14838     ELSE                                                         ELC50PD
 14839         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14840             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14841                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14842                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14843                                                                  ELC50PD
 14844     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14845       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14846         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14847         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14848         IF WS-ERROR = ER-2675                                    ELC50PD
 14849            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14850            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14851            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14852         ELSE                                                     ELC50PD
 14853            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14854            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14855                                                                  ELC50PD
 14856                                                                  ELC50PD
 14857     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14858         NEXT SENTENCE                                            ELC50PD
 14859     ELSE                                                         ELC50PD
 14860       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14861            NEXT SENTENCE
 14862       ELSE
 14863         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14864             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14865                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14866                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14867                                                                  ELC50PD
 14868     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14869       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14870         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14871         IF WS-ERROR = ER-2676                                    ELC50PD
 14872            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14873            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14874            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14875         ELSE                                                     ELC50PD
 14876            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14877            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14878                                                                  ELC50PD
 14879     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14880         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14881            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14882     ELSE                                                         ELC50PD
 14883         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14884             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14885                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14886                                                                  ELC50PD
 14887     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14888         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14889            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14890     ELSE                                                         ELC50PD
 14891         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14892             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14893                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14894                                                                  ELC50PD
 14895     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14896                                                                  ELC50PD
 14897     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14898                                                                  ELC50PD
 14899                                                                  ELC50PD
 14900 3215-EDIT-RATES.                                                 ELC50PD
 14901     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14902         NEXT SENTENCE                                            ELC50PD
 14903     ELSE                                                         ELC50PD
 14904         GO TO 3999-END-EDIT.                                     ELC50PD
 14905                                                                  ELC50PD
 14906 3220-CHECK-LF-RATES.                                             ELC50PD
 14907                                                                  ELC50PD
 14908     IF PB-COMPANY-ID = 'DCC'
 14909        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14910        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14911        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14912           AND (NOT WS-LF-CASH))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14913                           OR
 14914           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14915           AND (NOT WS-AH-CASH)))
 14916                       AND
 14917           (PB-I-ENTRY-STATUS NOT = '5')
 14918           MOVE 'M'              TO PB-BATCH-ENTRY
 14919                                    PB-I-ENTRY-STATUS
 14920        END-IF
 14921     END-IF
 14922
 14923
 14924
 14925     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 14926                                    PB-I-AH-PREM-CALC             ELC50PD
 14927                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 14928                                    PB-I-LF-ALT-RATE              ELC50PD
 14929                                    PB-I-LF-REI-RATE              ELC50PD
 14930                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 14931                                    PB-I-AH-REI-RATE
 14932                                    PB-I-TOT-FEES-CALC.
 14933                                                                  ELC50PD
 14934     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 14935        NEXT SENTENCE                                             ELC50PD
 14936     ELSE                                                         ELC50PD
 14937        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 14938                                    PB-I-AH-RATE.                 ELC50PD
 14939                                                                  ELC50PD
 14940     IF PB-I-TOT-FEES NOT NUMERIC
 14941        MOVE ZEROS               TO PB-I-TOT-FEES
 14942     END-IF
 14943
 14944     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 14945         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 14946                                                                  ELC50PD
 14947     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 14948         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 14949                                                                  ELC50PD
 14950     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 14951        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 14952     END-IF
 14953                                                                  ELC50PD
 14954     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 14955        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 14956     END-IF
 14957                                                                  ELC50PD
 14958     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
 14959        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 14960            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 14961     ELSE                                                         ELC50PD
 14962            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 14963                                                                  ELC50PD
 14964     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 14965         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 14966                                                                  ELC50PD
 14967     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 14968         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 14969                                                                  ELC50PD
 14970     MOVE SPACES                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14971     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 14972        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 14973        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 14974             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 14975        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 14976             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 14977        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 14978             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 14979        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 14980           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 14981           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 14982        ELSE                                                      ELC50PD
 14983           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 14984              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 14985               AM-MAX-TOT-BEN                                     ELC50PD
 14986               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 14987           ELSE                                                   ELC50PD
 14988              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 14989                 AM-MAX-TOT-BEN) AND                              ELC50PD
 14990                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 14991                 AM-MAX-TOT-BEN)                                  ELC50PD
 14992                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 14993              ELSE                                                ELC50PD
 14994                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 14995                                                                  ELC50PD
 14996     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 14997         NEXT SENTENCE                                            ELC50PD
 14998     ELSE                                                         ELC50PD
 14999         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15000                                                                  ELC50PD
 15001*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15002                                                                  ELC50PD
 15003     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15004        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15005              OR                                                  ELC50PD
 15006           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15007           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15009           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15010                                                                  ELC50PD
 15011     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15012           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15013                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15014                                                                  ELC50PD
 15015     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15016         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15018         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15019         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15020         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15021                                                                  ELC50PD
 15022     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15023        IF PB-I-LIVES = ZERO                                      ELC50PD
 15024           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15025           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15026                                                                  ELC50PD
 15027     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15028                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15029     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15030     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15031     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15032     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15033     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15034     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15035     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15036     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15037     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15038     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15039                                                                  ELC50PD
 15040******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15041     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15042         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15043            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15044             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15045                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15046*******                                                           ELC50PD
 15047                                                                  ELC50PD
 15048     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15049     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15050     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15051     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15052     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15053     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15054                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15055     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15056         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15057                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15058     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15059     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15060     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15061     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15062     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15063     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15064     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15065     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15066     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15067                                    CP-REMAINING-TERM             ELC50PD
 15068                                    CP-LOAN-TERM.                 ELC50PD
 15069                                                                  ELC50PD
 15070     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15071         NEXT SENTENCE                                            ELC50PD
 15072     ELSE                                                         ELC50PD
 15073         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15074             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15075                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15076                                                                  ELC50PD
 15077     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15078        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15079           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15080                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15081                                                                  ELC50PD
 15082     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15083         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15084            CP-EARN-AS-NET-PAY                                    ELC50PD
 15085             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15086                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15087                                                                  ELC50PD
 15088     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15089        or ((pb-company-id = 'AHL')
 15090           and (pb-i-loan-term > pb-i-lf-term))
 15091        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15092                                                                  ELC50PD
 15093     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15094        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15095                                                                  ELC50PD
 15096     IF CP-TERM-IS-DAYS                                           ELC50PD
 15097         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15098     ELSE                                                         ELC50PD
 15099         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15100
 15101     IF PB-COMPANY-ID = 'DCC'
 15102        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15103        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15104        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15105        IF WS-LF-BEN-CATEGORY = 'D'
 15106           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15107           MOVE PB-I-LIFE-COMMISSION
 15108                                 TO CP-DCC-ACT-COMM
 15109           MOVE WS-LF-BEN-CATEGORY
 15110                                 TO CP-BEN-CATEGORY
 15111        END-IF
 15112        IF (CP-BENEFIT-CD (1:1) = 'P')
 15113           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15114           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15115           add pb-i-ah-premium-amt to cp-original-premium
 15116        END-IF
 15117     END-IF
 15118
 15119     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15120         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15121         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15122         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15123                                                                  ELC50PD
 15124     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15125        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15126                                                                  ELC50PD
 15127     IF (CP-SPECIAL-CALC-CD = 'H')
 15128        OR (PB-COMPANY-ID = 'DCC')
 15129         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15130                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15131         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15132                                                                  ELC50PD
 15133     IF (PB-COMPANY-ID = 'CID')
 15134        AND (WS-LF-EARNINGS-CALC = 'B')
 15135        AND (CP-STATE-STD-ABBRV = 'MN')
 15136        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15137                                 TO CP-ALTERNATE-BENEFIT
 15138        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15139     END-IF
 15140
 15141     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15142     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15143     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15144                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15145     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15146        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15148        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15149                                                                  ELC50PD
 15150     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15151        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15152           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15153              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15154              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15155                                                                  ELC50PD
 15156
 15157******************************************************************ELC50PD
 15158*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15159*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15160******************************************************************ELC50PD
 15161                                                                  ELC50PD
 15162* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15163                                                                  00031343
 15164     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15165          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15166                                                                  00031346
 15167*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15168*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15169*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15170*        MOVE ER-2709        TO WS-ERROR                          00031349
 15171*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15172*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15173                                                                  00031352
 15174*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15175*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15176*        MOVE ER-2718        TO WS-ERROR                          00031349
 15177*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15178*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15179                                                                  00031352
 15180* CALC A & H AGE AT EXPIRATION.                                   00031353
 15181                                                                  00031354
 15182     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15183          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15184                                                                  00031357
 15185*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15186*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15187*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15188*        MOVE ER-2709        TO WS-ERROR                          00031349
 15189*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15190*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15191                                                                  00031352
 15192*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15193*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15194*        MOVE ER-2718        TO WS-ERROR                          00031360
 15195*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15196*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15197
 15198     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15199        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15200                                                                  ELC50PD
 15201     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
 15202        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15203                                                                  ELC50PD
 15204     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15205        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15206                                                                  ELC50PD
 15207     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15208         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15209         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15211                                                                  ELC50PD
 15212                                                                  00031363
 15213******************************************************************ELC50PD
 15214*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15215******************************************************************ELC50PD
 15216                                                                  ELC50PD
 15217 PREMIUM-EDITING-IS-BYPASSED.
 15218
 15219     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15220        AND (CP-R-MAX-ATT-AGE > +0)
 15221        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15222        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15223           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15224           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15225           MOVE '1'              TO DC-OPTION-CODE
 15226           PERFORM 8500-DATE-CONVERT
 15227                                 THRU 8500-EXIT
 15228           IF NO-CONVERSION-ERROR
 15229              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15230                 MOVE ER-2661       TO WS-ERROR
 15231*                PERFORM 9900-ERROR-FORMAT
 15232*                                THRU 9900-EXIT
 15233              END-IF
 15234           END-IF
 15235        ELSE
 15236           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15237           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15238              MOVE ER-2661       TO WS-ERROR
 15239*             PERFORM 9900-ERROR-FORMAT
 15240*                                THRU 9900-EXIT
 15241           ELSE
 15242              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15243                 MOVE ER-1570    TO WS-ERROR
 15244                 PERFORM 9900-ERROR-FORMAT
 15245                                 THRU 9900-EXIT
 15246              END-IF
 15247           END-IF
 15248        END-IF
 15249
 15250        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15251           MOVE PB-I-JOINT-BIRTHDAY
 15252                                 TO DC-BIN-DATE-1
 15253           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15254           MOVE '1'              TO DC-OPTION-CODE
 15255           PERFORM 8500-DATE-CONVERT
 15256                                 THRU 8500-EXIT
 15257           IF NO-CONVERSION-ERROR
 15258              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15259                 MOVE ER-2661       TO WS-ERROR
 15260*                PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15261*                                THRU 9900-EXIT
 15262              END-IF
 15263           ELSE
 15264              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15265           END-IF
 15266        ELSE
 15267           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15268             (PB-I-LF-TERM / 12)
 15269           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15270              MOVE ER-2661       TO WS-ERROR
 15271*             PERFORM 9900-ERROR-FORMAT
 15272*                                THRU 9900-EXIT
 15273           ELSE
 15274              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15275                 MOVE ER-1571    TO WS-ERROR
 15276                 PERFORM 9900-ERROR-FORMAT
 15277                                 THRU 9900-EXIT
 15278              END-IF
 15279           END-IF
 15280        END-IF
 15281        IF WS-ERROR = ER-2661
 15282           PERFORM 9900-ERROR-FORMAT
 15283                                 THRU 9900-EXIT
 15284        END-IF
 15285     END-IF
 15286
 15287*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15288*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15289*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15290                                                                  ELC50PD
 15291     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15292        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15294                                                                  ELC50PD
 15295     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15296        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15298                                                                  ELC50PD
 15299     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15300        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15302                                                                  ELC50PD
 15303 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15304                                                                  ELC50PD
 15305     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15306         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15307                                                                  ELC50PD
 15308     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15309        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15310     END-IF
 15311
 15312     .
 15313 3221-CONTINUE.                                                   ELC50PD
 15314     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15315                                    WS-DCC-AH-RATE
 15316
 15317     IF PB-COMPANY-ID = 'DCC'
 15318        IF WS-LF-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15319           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15320              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15321        END-IF
 15322     END-IF
 15323
 15324     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15325
 15326*   X'A4FF' = 12/31/2009
 15327     IF (PB-COMPANY-ID = 'CID')
 15328        AND (WS-LF-EARNINGS-CALC = 'B')
 15329        AND (CP-STATE-STD-ABBRV = 'MN')
 15330        AND (PB-CERT-EFF-DT > X'A4FF')
 15331        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15332     END-IF
 15333
 15334     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15335                                                                  ELC50PD
 15336     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15337     IF (PB-COMPANY-ID = 'DCC')
 15338        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15339        AND (PB-I-POLICY-IS-MONTHLY)
 15340        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15341        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15342     END-IF
 15343     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15344     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15345     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15346     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15347
 15348     IF (PB-COMPANY-ID = 'DCC')
 15349        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15350        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15351        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15352        MOVE ER-2786             TO WS-ERROR
 15353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15354     END-IF
 15355                                                                  ELC50PD
 15356     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15357                                                                  ELC50PD
 15358******************************************************************ELC50PD
 15359*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15360******************************************************************ELC50PD
 15361     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15362        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
 15363                                                                  ELC50PD
 15364     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15365        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15366     ELSE                                                         ELC50PD
 15367       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15368          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15369          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15370                                                                  ELC50PD
 15371 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15372                                                                  ELC50PD
 15373     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15374        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15375        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15376         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15377                                                                  ELC50PD
 15378     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15379         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15380             AND PB-COMPANY-ID NOT = 'DCC')
 15381                   OR
 15382
 15383              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15384              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15385              AND PB-COMPANY-ID NOT = 'DCC')
 15386             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15387             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15388             GO TO 3225-RATING-CONT                               ELC50PD
 15389         ELSE                                                     ELC50PD
 15390             GO TO 3225-RATING-CONT.                              ELC50PD
 15391
 15392     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15393        AND (AM-GPCD = 01 OR 06 OR 15)
 15394        MOVE ER-2798             TO WS-ERROR
 15395        PERFORM 9900-ERROR-FORMAT
 15396                                 THRU 9900-EXIT
 15397*       GO TO 3225-RATING-CONT
 15398     END-IF
 15399
 15400     IF (PB-COMPANY-ID = 'CID')
 15401        AND (WS-LF-EARNINGS-CALC = 'B')
 15402        AND (CP-STATE-STD-ABBRV = 'MN')
 15403        AND (PB-CERT-EFF-DT > X'A4FF')
 15404        GO TO 3225-RATING-CONT
 15405     END-IF
 15406
 15407     IF PB-COMPANY-ID = 'DCC'
 15408        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15409           AND (PB-I-POLICY-IS-MONTHLY)
 15410           GO TO 3225-RATING-CONT
 15411        END-IF
 15412     END-IF
 15413
 15414     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15415        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15416        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15417        NEXT SENTENCE                                             ELC50PD
 15418     ELSE                                                         ELC50PD
 15419        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15420                                                                  ELC50PD
 15421 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15422                                                                  ELC50PD
 15423     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15424                                                                  ELC50PD
 15425     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15426        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15427        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15428         NEXT SENTENCE                                            ELC50PD
 15429     ELSE                                                         ELC50PD
 15430         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15431                                                                  ELC50PD
 15432     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15433     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15434     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15435                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15436     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15437         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15438                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15439
 15440     IF PB-COMPANY-ID = 'DCC'
 15441        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15442     END-IF
 15443
 15444     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15445     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15446     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15447                                    CP-REMAINING-TERM             ELC50PD
 15448                                    CP-LOAN-TERM.                 ELC50PD
 15449     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15450        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15451                                    CP-REMAINING-TERM             ELC50PD
 15452                                    CP-LOAN-TERM.                 ELC50PD
 15453                                                                  ELC50PD
 15454     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15455     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15456                                                                  ELC50PD
 15457     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15458         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15460         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15461                                                                  ELC50PD
 15462     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15463     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15464                                                                  ELC50PD
 15465     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15466         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15467                                                                  ELC50PD
 15468     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15469                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15470                                                                  ELC50PD
 15471     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15472        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15473        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')                    ELC50PD
 15474        GO TO 3225-CONTINUE.                                      ELC50PD
 15475                                                                  ELC50PD
 15476     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15477        GO TO 3225-CONTINUE.                                      ELC50PD
 15478                                                                  ELC50PD
 15479     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15480                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15481        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15482        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15484                                                                  ELC50PD
 15485 3225-CONTINUE.                                                   ELC50PD
 15486     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15487         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15489                                                                  ELC50PD
 15490     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15491        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
 15492        MOVE ER-2698             TO WS-ERROR                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15494                                                                  ELC50PD
 15495 3225-RATING-CONT.                                                ELC50PD
 15496                                                                  ELC50PD
 15497     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15498         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15499         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15500         IF (PB-COMPANY-ID = 'DCC')
 15501            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15502            CONTINUE
 15503         ELSE
 15504            MOVE ER-2687         TO WS-ERROR
 15505            PERFORM 9900-ERROR-FORMAT
 15506                                 THRU 9900-EXIT
 15507         END-IF
 15508         GO TO 3290-EDIT-LF-REIN-RATE
 15509     END-IF
 15510                                                                  ELC50PD
 15511* DMD RATING TEST                                                 ELC50PD
 15512     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15513         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15514         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15515         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15517         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15518                                                                  ELC50PD
 15519 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15520                                                                  ELC50PD
 15521     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15522     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15523*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15524     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15525     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15526                                                                  ELC50PD
 15527 C-POS-3230-MORT-CD.                                              ELC50PD
 15528     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15529        PB-SV-CARRIER = '2'                                       ELC50PD
 15530         NEXT SENTENCE                                            ELC50PD
 15531     ELSE                                                         ELC50PD
 15532         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15533                                                                  ELC50PD
 15534     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15535        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15536         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
 15537      ELSE                                                        ELC50PD
 15538         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15539                                                                  ELC50PD
 15540                                                                  ELC50PD
 15541 C-POS-3240-MORT-CD.                                              ELC50PD
 15542     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15543        PB-SV-CARRIER = '1'                                       ELC50PD
 15544         NEXT SENTENCE                                            ELC50PD
 15545     ELSE                                                         ELC50PD
 15546         GO TO 3230-CONTINUE.                                     ELC50PD
 15547                                                                  ELC50PD
 15548     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15549        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
 15550         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15551     ELSE                                                         ELC50PD
 15552         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15553                                                                  ELC50PD
 15554 3230-CONTINUE.                                                   ELC50PD
 15555
 15556     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15557        GO TO 3240-CONTINUE                                       00033065
 15558     END-IF
 15559
 15560     IF PB-CERT-EFF-DT > WS-971231
 15561        GO TO 3240-CONTINUE                                       00033065
 15562     END-IF
 15563
 15564     IF LF-BENEFIT-FOUND AND                                      00033066
 15565        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15566         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15567     ELSE                                                         00033069
 15568         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15569             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15570         ELSE                                                     00033072
 15571             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15572         END-IF
 15573     END-IF
 15574                                                                  00033074
 15575     .
 15576 3240-CONTINUE.                                                   ELC50PD
 15577
 15578     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15579         GO TO 3256-CONTINUE.                                     ELC50PD
 15580                                                                  ELC50PD
 15581     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15582         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15583     ELSE                                                         ELC50PD
 15584         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15585                                                                  ELC50PD
 15586 3256-CONTINUE.                                                   ELC50PD
 15587     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15588         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15589                                                                  ELC50PD
 15590     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15591         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15592     ELSE                                                         ELC50PD
 15593         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15594                                                                  ELC50PD
 15595 3260-EDIT-CONTINUE.                                              ELC50PD
 15596     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15597                                                                  ELC50PD
 15598 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15599     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15600         GO TO 3290-RATING-CONT.                                  ELC50PD
 15601                                                                  ELC50PD
 15602     IF PB-COMPANY-ID = 'DCC'
 15603        GO TO 3290-RATING-CONT.
 15604
 15605     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15606     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15607     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
 15608     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15609     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15610                                                                  ELC50PD
 15611******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15612     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15613         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15614            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15615             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15616*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15617             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15618             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15619***  Y2K PROJ 7744                                                   CL*11
 15620             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15621                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15622***  Y2K PROJ 7744                                                   CL*11
 15623*******                                                           ELC50PD
 15624                                                                  ELC50PD
 15625     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15626     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15627     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15628     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15629                                   CP-RATE-DEV-PCT.               ELC50PD
 15630     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15631     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15632                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15633                                                                  ELC50PD
 15634************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15635     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15636         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15637            CP-EARN-AS-NET-PAY                                    ELC50PD
 15638             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15639                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15640************                                                      ELC50PD
 15641                                                                  ELC50PD
 15642     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15643         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15644                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15645     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15646     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15647     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15648     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15649     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15650     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15651     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15652     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
 15653                                   CP-REMAINING-TERM              ELC50PD
 15654                                   CP-LOAN-TERM.                  ELC50PD
 15655     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15656        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15657                                                                  ELC50PD
 15658     IF CP-TERM-IS-DAYS                                           ELC50PD
 15659         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15660     ELSE                                                         ELC50PD
 15661         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15662                                                                  ELC50PD
 15663
 15664     IF PB-COMPANY-ID = 'DCC'
 15665        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15666     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15667
 15668     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15669          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15670                                                                  ELC50PD
 15671     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15672                                                                  ELC50PD
 15673     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15674     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15675                                                                  ELC50PD
 15676     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15677        IF PB-I-OB                                                ELC50PD
 15678           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15679           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15680           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15681        ELSE                                                      ELC50PD
 15682           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15684           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15685                                                                  ELC50PD
 15686     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15687                                                                  ELC50PD
 15688     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15689     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15690                                                                  ELC50PD
 15691     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15692         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15694                                                                  ELC50PD
 15695 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15696                                                                  ELC50PD
 15697     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15698        GO TO 3290-RATING-CONT.                                   ELC50PD
 15699                                                                  ELC50PD
 15700     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15701     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15702     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15703     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15704     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15705     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15706                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15707     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15708         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15709                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15710
 15711     IF PB-COMPANY-ID = 'DCC'
 15712        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15713     END-IF
 15714
 15715     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15716     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15717     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15718                                    CP-REMAINING-TERM             ELC50PD
 15719                                    CP-LOAN-TERM.                 ELC50PD
 15720     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15721        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15722                                    CP-REMAINING-TERM             ELC50PD
 15723                                    CP-LOAN-TERM.                 ELC50PD
 15724                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15725     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15726     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15727                                                                  ELC50PD
 15728     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15729                                                                  ELC50PD
 15730     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15731         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15732         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15733                                                                  ELC50PD
 15734 3290-RATING-CONT.                                                ELC50PD
 15735                                                                  ELC50PD
 15736     IF PB-I-OB                                                   ELC50PD
 15737*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15738        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15739                                                                  ELC50PD
 15740 3299-EDIT-CONTINUE.                                              ELC50PD
 15741                                                                  ELC50PD
 15742     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15743         NEXT SENTENCE                                            ELC50PD
 15744     ELSE                                                         ELC50PD
 15745         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15747                                                                  ELC50PD
 15748 3300-CHECK-AH-RATES.                                             ELC50PD
 15749     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15750         NEXT SENTENCE                                            ELC50PD
 15751     ELSE                                                         ELC50PD
 15752         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15753                                                                  ELC50PD
 15754     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15755        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15756                (NO-DMD-RATING))                                  ELC50PD
 15757         IF (PB-COMPANY-ID = 'DCC')
 15758            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15759            CONTINUE
 15760         ELSE
 15761            MOVE ER-2687         TO WS-ERROR
 15762            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15763         END-IF
 15764         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15765         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15766     END-IF
 15767                                                                  ELC50PD
 15768     IF PB-I-OB                                                   ELC50PD
 15769        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15770                                                                  ELC50PD
 15771     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15772         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15774         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15775         GO TO 3999-END-EDIT.                                     ELC50PD
 15776                                                                  ELC50PD
 15777*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15778                                                                  ELC50PD
 15779     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15780        IF PB-I-AH-CRIT-PER = ZERO
 15781           IF PB-COMPANY-ID = 'DCC'
 15782              AND AM-DCC-PRODUCT-CODE = 'DDF'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15783              CONTINUE
 15784           ELSE
 15785              MOVE ER-2618       TO WS-ERROR
 15786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15787              GO TO 3999-END-EDIT
 15788           END-IF
 15789        END-IF
 15790     END-IF
 15791
 15792     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15793     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15794     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15795     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15796     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15797     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15798     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15799     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15800     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15801*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15802     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15803     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15804     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15805     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15806                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15807     IF PB-COMPANY-ID = 'CID'
 15808               OR
 15809        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15810         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15811                                         PB-I-AH-TERM.            ELC50PD
 15812     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15813        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15814           AND (PB-I-POLICY-IS-MONTHLY)
 15815           MOVE PB-I-LF-BENEFIT-AMT
 15816                                 TO CP-NET-BENEFIT-AMT
 15817           move pb-i-ah-premium-amt to cp-original-premium
 15818           add pb-i-lf-premium-amt to cp-original-premium
 15819        END-IF
 15820     END-IF
 15821
 15822     MOVE SPACES                 TO CP-BEN-CATEGORY
 15823
 15824     IF PB-COMPANY-ID = 'DCC'
 15825        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15826        EVALUATE TRUE
 15827           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15828              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15829              MOVE PB-I-LF-BENEFIT-AMT
 15830                                 TO CP-RATING-BENEFIT-AMT
 15831              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15832           WHEN WS-AH-BEN-CATEGORY = 'G'
 15833              MOVE PB-I-UNPAID-CASH-PRICE
 15834                                 TO CP-RATING-BENEFIT-AMT
 15835           WHEN WS-AH-BEN-CATEGORY = 'D'
 15836              MOVE WS-AH-PMF-COMM
 15837                                 TO CP-DCC-PMF-COMM
 15838              MOVE PB-I-AH-COMMISSION
 15839                                 TO CP-DCC-ACT-COMM
 15840        END-EVALUATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15841     END-IF
 15842
 15843     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15844     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15845     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15846     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15847     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15848     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15849     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15850                                    CP-REMAINING-TERM             ELC50PD
 15851                                    WS-WORK-TERM.                 ELC50PD
 15852     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15853                                                                  ELC50PD
 15854     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15855     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15856*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15857     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15858     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15859                                                                  ELC50PD
 15860     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15861     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15862         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15864         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15865                                                                  ELC50PD
 15866     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15867         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15868                                                                  ELC50PD
 15869     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15870                                                                  ELC50PD
 15871     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15872         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15873     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15874         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15875     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15876         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15877     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15878         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15879     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15880         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15881                                                                  ELC50PD
 15882     MOVE 1                      TO SUB2.                         ELC50PD
 15883     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15884     MOVE WS-MONTH               TO SUB1.                         ELC50PD
 15885     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15886     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15887                                                                  ELC50PD
 15888 3310-GET-SKIP-MO.                                                ELC50PD
 15889     IF SUB1 = 13                                                 ELC50PD
 15890         MOVE 1                  TO SUB1.                         ELC50PD
 15891                                                                  ELC50PD
 15892     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15893         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15894                                                                  ELC50PD
 15895     ADD 1 TO SUB2                                                ELC50PD
 15896              SUB1.                                               ELC50PD
 15897                                                                  ELC50PD
 15898 3320-RATE-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15899                                                                  ELC50PD
 15900     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15901         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15902                                                                  ELC50PD
 15903     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15904                                    CP-LOAN-TERM.                 ELC50PD
 15905                                                                  ELC50PD
 15906     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15907         NEXT SENTENCE                                            ELC50PD
 15908     ELSE                                                         ELC50PD
 15909         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15910                                    PB-I-AH-REI-RATE.             ELC50PD
 15911                                                                  ELC50PD
 15912                                                                  ELC50PD
 15913     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15914        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15915                                                                  ELC50PD
 15916     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15917         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15918         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15919         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15920         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 15921                                                                  ELC50PD
 15922     IF PB-COMPANY-ID = 'DCC'
 15923        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15924           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15925              PB-I-RATE-DEV-PCT-LF
 15926        END-IF
 15927        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15928                                 TO CP-ALTERNATE-BENEFIT
 15929        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15930        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15931        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15932     END-IF
 15933
 15934     IF (PB-COMPANY-ID = 'CID')
 15935        AND (WS-LF-EARNINGS-CALC = 'B')
 15936        AND (CP-STATE-STD-ABBRV = 'MN')
 15937        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 15938     ELSE
 15939        MOVE ' '                 TO CP-AH-BALLOON-SW
 15940     END-IF
 15941
 15942     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 15943     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15944     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15945                                                                  ELC50PD
 15946     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15947        IF PB-I-OB                                                ELC50PD
 15948           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 15949           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15950           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 15951        ELSE                                                      ELC50PD
 15952          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15953              NEXT SENTENCE
 15954          ELSE
 15955           MOVE ER-2642          TO WS-ERROR                      ELC50PD
 15956           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15957           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 15958                                                                  ELC50PD
 15959     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 15960        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 15961           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 15962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15963                                                                  ELC50PD
 15964     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15965        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15966           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 15967              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 15968              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15969                                                                  ELC50PD
 15970     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 15971        NEXT SENTENCE                                             ELC50PD
 15972     ELSE                                                         ELC50PD
 15973       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 15974          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 15975          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15976                                                                  ELC50PD
 15977     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 15978         IF WS-ERROR = ER-2640                                    ELC50PD
 15979             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 15980
 15981     IF ACCOUNT-AH-CHECKED
 15982        CONTINUE
 15983     ELSE
 15984        IF (CP-R-MAX-ATT-AGE NUMERIC)
 15985           AND (CP-R-MAX-ATT-AGE > +0)
 15986           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 15987           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 15988              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 15989              MOVE PB-I-AH-EXPIRE-DT
 15990                                 TO DC-BIN-DATE-2
 15991              MOVE '1'           TO DC-OPTION-CODE
 15992              PERFORM 8500-DATE-CONVERT
 15993                                 THRU 8500-EXIT
 15994              IF NO-CONVERSION-ERROR
 15995                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15996                    MOVE ER-2661       TO WS-ERROR
 15997*                   PERFORM 9900-ERROR-FORMAT
 15998*                                THRU 9900-EXIT
 15999                 END-IF
 16000              END-IF
 16001           ELSE
 16002              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16003              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16004                 MOVE ER-2661    TO WS-ERROR
 16005*                PERFORM 9900-ERROR-FORMAT
 16006*                                THRU 9900-EXIT
 16007              ELSE
 16008                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16009                    MOVE ER-1570 TO WS-ERROR
 16010                    PERFORM 9900-ERROR-FORMAT
 16011                                 THRU 9900-EXIT
 16012                 END-IF
 16013              END-IF
 16014           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16015
 16016           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16017              MOVE PB-I-JOINT-BIRTHDAY
 16018                                    TO DC-BIN-DATE-1
 16019              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16020              MOVE '1'              TO DC-OPTION-CODE
 16021              PERFORM 8500-DATE-CONVERT
 16022                                    THRU 8500-EXIT
 16023              IF NO-CONVERSION-ERROR
 16024                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16025                    MOVE ER-2661       TO WS-ERROR
 16026*                   PERFORM 9900-ERROR-FORMAT
 16027*                                   THRU 9900-EXIT
 16028                 END-IF
 16029              END-IF
 16030           ELSE
 16031              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16032                (PB-I-AH-TERM / 12)
 16033              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16034                 MOVE ER-2661       TO WS-ERROR
 16035*                PERFORM 9900-ERROR-FORMAT
 16036*                                   THRU 9900-EXIT
 16037              ELSE
 16038                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16039                    MOVE ER-1571 TO WS-ERROR
 16040                    PERFORM 9900-ERROR-FORMAT
 16041                                 THRU 9900-EXIT
 16042                 END-IF
 16043              END-IF
 16044           END-IF
 16045           IF WS-ERROR = ER-2661
 16046              PERFORM 9900-ERROR-FORMAT
 16047                                    THRU 9900-EXIT
 16048           END-IF
 16049        END-IF
 16050     END-IF
 16051
 16052*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16053*       NEXT SENTENCE                                             ELC50PD
 16054*    ELSE                                                         ELC50PD
 16055*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16056*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16057*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16058                                                                  ELC50PD
 16059     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16060        NEXT SENTENCE                                             ELC50PD
 16061     ELSE                                                         ELC50PD
 16062        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16063           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16064           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16065                                                                  ELC50PD
 16066     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16067        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16068         PB-POLICY-IS-VOIDED                                      ELC50PD
 16069        NEXT SENTENCE                                             ELC50PD
 16070     ELSE                                                         ELC50PD
 16071        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
 16072           MOVE ER-2667            TO WS-ERROR                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16073           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16074                                                                  ELC50PD
 16075     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16076         IF WS-ERROR = ER-2667                                    ELC50PD
 16077             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16078                                                                  ELC50PD
 16079     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16080        NEXT SENTENCE                                             ELC50PD
 16081     ELSE                                                         ELC50PD
 16082        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16083           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16085                                                                  ELC50PD
 16086     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16087         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16088                                                                  ELC50PD
 16089 3321-CONTINUE.                                                   ELC50PD
 16090     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16091     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16092
 16093     IF (PB-COMPANY-ID = 'DCC')
 16094        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16095        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16096                                    PB-I-LF-ALT-PREM-CALC
 16097        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16098        IF WS-AH-BEN-CATEGORY = 'G'
 16099           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16100           + PB-I-ADDL-CLP)
 16101           * (1 + WS-TOL-CLP-PCT)
 16102*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16103        ELSE
 16104           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16105           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16106*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16107        END-IF
 16108        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16109                                 TO PB-I-AH-PREM-CALC
 16110        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16111           MOVE ER-8152          TO WS-ERROR
 16112           PERFORM 9900-ERROR-FORMAT
 16113                                 THRU 9900-EXIT
 16114        ELSE
 16115           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16116                 PB-I-ADDL-CLP)
 16117              MOVE ER-8148       TO WS-ERROR
 16118              PERFORM 9900-ERROR-FORMAT
 16119                                 THRU 9900-EXIT
 16120           END-IF
 16121        END-IF
 16122     END-IF
 16123     IF (PB-COMPANY-ID = 'DCC')
 16124        AND (PB-I-POLICY-IS-MONTHLY)
 16125        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16126        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16127        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16128           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16129        END-IF
 16130     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16131
 16132     IF (PB-COMPANY-ID = 'DCC')
 16133        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16134        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16135        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16136        MOVE ER-2786             TO WS-ERROR
 16137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16138     END-IF
 16139
 16140     MOVE +0                     TO PB-I-AH-CLP
 16141     IF PB-COMPANY-ID = 'DCC'
 16142        IF WS-AH-BEN-CATEGORY = 'D'
 16143           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16144              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16145        ELSE
 16146           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16147              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16148           END-IF
 16149        END-IF
 16150     END-IF
 16151
 16152     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16153                                                                  ELC50PD
 16154     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16155         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16156                                                                  ELC50PD
 16157     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16158         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16159                                                                  ELC50PD
 16160     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16161         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16162            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16163             NEXT SENTENCE                                        ELC50PD
 16164         ELSE                                                     ELC50PD
 16165             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16166                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16167                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16168             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16169                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16170                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16171                                                                  ELC50PD
 16172     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16173       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16174           NEXT SENTENCE
 16175       ELSE
 16176         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16178                                                                  ELC50PD
 16179     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16180     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16181     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16182     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16183     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16184     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16185                                                                  ELC50PD
 16186     IF (PB-COMPANY-ID = 'DCC')
 16187        AND (WS-AH-BEN-CATEGORY = 'G')
 16188        AND (AM-DCC-PRODUCT-CODE = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16189        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16190        IF CP-DEVIATION-CODE NOT = '000'
 16191           MOVE '000'            TO CP-DEVIATION-CODE
 16192           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16193           IF NO-CP-ERROR
 16194              COMPUTE PB-I-DDF-IU-RATE-UP =
 16195              PB-I-AH-CLP - CP-CALC-PREMIUM
 16196           ELSE
 16197              MOVE ER-3057        TO WS-ERROR
 16198              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16199           END-IF
 16200        END-IF
 16201     END-IF
 16202
 16203     .
 16204 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16205     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16206         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16207                                                                  ELC50PD
 16208     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16209     IF PB-COMPANY-ID = 'DCC'
 16210         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16211
 16212     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16213     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16214     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16215     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16216     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16217     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16218                                    CP-RATE-DEV-PCT.              ELC50PD
 16219*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16220     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16221     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16222     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16223     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16224                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16225     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16226         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16227                                         PB-I-AH-TERM.            ELC50PD
 16228     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16229     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16230     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16231     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16232     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16233     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16234                                    CP-REMAINING-TERM             ELC50PD
 16235                                    WS-WORK-TERM.                 ELC50PD
 16236     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16237
 16238     IF PB-COMPANY-ID = 'DCC'
 16239        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16240     END-IF
 16241
 16242     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16243         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16244            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16245                                                                  ELC50PD
 16246     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16247          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16248                                                                  ELC50PD
 16249     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16250                                                                  ELC50PD
 16251     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16252                                                                  ELC50PD
 16253     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16254                                                                  ELC50PD
 16255     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16256     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16257                                                                  ELC50PD
 16258     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16259         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16261         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16262                                                                  ELC50PD
 16263     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16264                                                                  ELC50PD
 16265     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16266     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16267                                                                  ELC50PD
 16268     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16269         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16271                                                                  ELC50PD
 16272                                                                  ELC50PD
 16273 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16274                                                                  ELC50PD
 16275     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16276         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16277             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16278             GO TO 3999-END-EDIT.                                 ELC50PD
 16279                                                                  ELC50PD
 16280     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16281                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16282                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16283                         OR 'AHL'
 16284         NEXT SENTENCE                                            ELC50PD
 16285     ELSE                                                         ELC50PD
 16286         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16287             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16288                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16289                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16290                                     PB-I-LF-PREM-CALC * .90      ELC50PD
 16291                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16292                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16293                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16294                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16295                                                                  ELC50PD
 16296     IF PB-COMP-LF-PREM                                           ELC50PD
 16297        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16298        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16299                                                                  ELC50PD
 16300     IF PB-COMP-AH-PREM                                           ELC50PD
 16301        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16302                                                                  ELC50PD
 16303 3340-CHECK-DCC-TOT-FEES.
 16304
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16305     IF (PB-COMPANY-ID = 'DCC')
 16306        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16307        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16308        AND (PB-I-POLICY-IS-MONTHLY)
 16309        CONTINUE
 16310     ELSE
 16311        GO TO 3340-EDIT-LF-AH-TOL
 16312     END-IF
 16313
 16314     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16315     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16316
 16317     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16318        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16319           PB-I-RATE-DEV-PCT-LF
 16320     END-IF
 16321     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16322        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16323           PB-I-RATE-DEV-PCT-AH
 16324     END-IF
 16325     MOVE 'N'                    TO CP-BEN-CATEGORY
 16326
 16327     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16328                                                                  ELC50PD
 16329     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16330     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16331     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16332     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16333     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16334     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16335     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16336     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16337     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16338     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16339                                                                  ELC50PD
 16340     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16341     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16342     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16343     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16344     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16345     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16346                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16347     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16348         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 16349                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16350     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16351     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16352     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16353     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16354     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16355     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16356     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16357     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16358     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16359                                    CP-REMAINING-TERM             ELC50PD
 16360                                    CP-LOAN-TERM.                 ELC50PD
 16361                                                                  ELC50PD
 16362     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16363         NEXT SENTENCE                                            ELC50PD
 16364     ELSE                                                         ELC50PD
 16365         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 16366             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 16367                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 16368                                                                  ELC50PD
 16369     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16370        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16371                                                                  ELC50PD
 16372     IF CP-TERM-IS-DAYS                                           ELC50PD
 16373         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16374     ELSE                                                         ELC50PD
 16375         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16376                                                                  ELC50PD
 16377
 16378     IF PB-COMPANY-ID = 'DCC'
 16379        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16380     END-IF
 16381
 16382     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16383         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16384                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16385         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16386
 16387     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16388     MOVE 'R'                    TO CP-RATE-FILE
 16389     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16390
 16391     IF NOT CP-ERROR-RATE-NOT-FOUND
 16392        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16393        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16394           AND (CP-BENEFIT-CD (1:1) = 'S')
 16395           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16396                                    PB-I-LF-PREMIUM-AMT
 16397        END-IF
 16398     ELSE
 16399        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16400     END-IF
 16401
 16402     .
 16403 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16404                                                                  ELC50PD
 16405***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16406***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16407***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16408***                                                               ELC50PD
 16409     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16410         PB-I-AH-PREMIUM-AMT                                      ELC50PD
 16411          GIVING WS-CALC-WORK.                                    ELC50PD
 16412                                                                  ELC50PD
 16413     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16414        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16415         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16417                                                                  ELC50PD
 16418     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16419             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16420                 GIVING WS-UNSIGN-WRK1.                              CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16421                                                                     CL**2
 16422     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16423             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16424                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16425                                                                     CL**2
 16426     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16427                                + WS-UNSIGN-WRK4.                    CL**2
 16428                                                                     CL**2
 16429     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16430             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16431                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16432                                                                  ELC50PD
 16433******************************************************************ELC50PD
 16434*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16435******************************************************************ELC50PD
 16436                                                                  ELC50PD
 16437     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16438         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16439                                                                  ELC50PD
 16440     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16441         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16442                                                                  ELC50PD
 16443     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16444             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16445                                                                  ELC50PD
 16446 3342-CONTINUE.                                                   ELC50PD
 16447                                                                  ELC50PD
 16448     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16449         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16450         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16451            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16452              NEXT SENTENCE                                       ELC50PD
 16453         ELSE                                                     ELC50PD
 16454             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16455                                                                  ELC50PD
 16456     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16457         NEXT SENTENCE                                            ELC50PD
 16458     ELSE                                                         ELC50PD
 16459     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16460        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16461           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16462               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16463               PB-POLICY-IS-VOIDED)                               ELC50PD
 16464              NEXT SENTENCE                                       ELC50PD
 16465           ELSE                                                   ELC50PD
 16466              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16467                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16468                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16469                 GO TO 3344-CHECK-AH                              ELC50PD
 16470              ELSE                                                ELC50PD
 16471                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16472                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16473                 GO TO 3344-CHECK-AH.                             ELC50PD
 16474                                                                  ELC50PD
 16475***                                                               ELC50PD
 16476***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16477***                                                               ELC50PD
 16478                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16479     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16480         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16481            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16482             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16483         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16484            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16485             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16486     ELSE                                                         ELC50PD
 16487         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT      ELC50PD
 16488         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 16489                                                                  ELC50PD
 16490***                                                               ELC50PD
 16491***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16492***                                                               ELC50PD
 16493                                                                  ELC50PD
 16494     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16495         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16496          WS-TOL-LF-PREM.                                         ELC50PD
 16497                                                                  ELC50PD
 16498     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16499         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16500          WS-TOL-LF-PREM.                                         ELC50PD
 16501                                                                  ELC50PD
 16502     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16503        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16504                                                                  ELC50PD
 16505     IF (PB-REISSUED-CERT        OR                               ELC50PD
 16506         PB-POLICY-IS-DECLINED   OR                               ELC50PD
 16507         PB-POLICY-IS-VOIDED)                                     ELC50PD
 16508        NEXT SENTENCE                                             ELC50PD
 16509     ELSE                                                         ELC50PD
 16510     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)         ELC50PD
 16511           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)                 ELC50PD
 16512       OR                                                         ELC50PD
 16513        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)          ELC50PD
 16514           LESS THAN WS-TOL-LF-LOW-PREM-AMT))                     ELC50PD
 16515       AND
 16516        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)         ELC50PD
 16517           GREATER WS-TOL-LF-HIGH-PREM-PCT)                       ELC50PD
 16518         OR                                                       ELC50PD
 16519          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)        ELC50PD
 16520           LESS WS-TOL-LF-LOW-PREM-PCT))                          ELC50PD
 16521              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE              ELC50PD
 16522                  MOVE ER-2652   TO  WS-ERROR                     ELC50PD
 16523                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 16524              ELSE                                                ELC50PD
 16525                  MOVE ER-2650   TO  WS-ERROR                     ELC50PD
 16526                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16527                                                                  ELC50PD
 16528*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16529*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16530*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16531*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16532                                                                  ELC50PD
 16533     IF WS-ERROR  =  ER-2650  OR  ER-2652
 16534        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16535                      OR
 16536           ((PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16537           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 16538           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16539           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16540        END-IF
 16541     END-IF
 16542                                                                  ELC50PD
 16543     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16544        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16545           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16546              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16547                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16548                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16549                 NEXT SENTENCE                                    ELC50PD
 16550              ELSE                                                ELC50PD
 16551                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16552                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16553                                                                  ELC50PD
 16554 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16555                                                                  ELC50PD
 16556      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16557          GO TO 3344-CHECK-AH.                                    ELC50PD
 16558                                                                  ELC50PD
 16559      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16560          GO TO 3344-CHECK-AH.                                    ELC50PD
 16561                                                                  ELC50PD
 16562      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16563                                     WS-UNSIGN-WRK6.              ELC50PD
 16564                                                                  ELC50PD
 16565      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16566          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16567                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16568                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16569                                                                  ELC50PD
 16570      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16571          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16572                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16573                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16574                                                                  ELC50PD
 16575      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16576          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16577              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16578                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16580              ELSE                                                ELC50PD
 16581                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16582                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16583                                                                  ELC50PD
 16584      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16585          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16586              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16587                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16588                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16589              ELSE                                                ELC50PD
 16590                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16591                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16592                                                                  ELC50PD
 16593 3344-CHECK-AH.                                                   ELC50PD
 16594                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16595****************************************************************  ELC50PD
 16596***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16597***                                                               ELC50PD
 16598                                                                  ELC50PD
 16599     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16600         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16601             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16602         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16603             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16604     ELSE                                                         ELC50PD
 16605         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT      ELC50PD
 16606         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 16607                                                                  ELC50PD
 16608***                                                               ELC50PD
 16609***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16610***                                                               ELC50PD
 16611                                                                  ELC50PD
 16612     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16613         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16614                                                                  ELC50PD
 16615     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16616         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16617                                                                  ELC50PD
 16618     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16619        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16620                                                                  ELC50PD
 16621     IF (PB-REISSUED-CERT)
 16622        OR (PB-POLICY-IS-DECLINED)
 16623        OR (PB-POLICY-IS-VOIDED)
 16624        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16625        CONTINUE
 16626     ELSE
 16627        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16628            OR
 16629           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16630           AND
 16631           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16632           OR
 16633           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16634           IF WS-PREM-REJECT-SW = SPACE
 16635              MOVE ER-3052       TO WS-ERROR
 16636              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16637           ELSE
 16638              MOVE ER-3050       TO WS-ERROR
 16639              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16640           END-IF
 16641        END-IF
 16642     END-IF
 16643                                                                  ELC50PD
 16644     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16645         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16646             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16647             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16648                                                                  ELC50PD
 16649     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16650        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16651           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16652              IF (PB-REISSUED-CERT         OR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16653                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16654                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16655                 NEXT SENTENCE                                    ELC50PD
 16656              ELSE                                                ELC50PD
 16657                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16658                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16659                                                                  ELC50PD
 16660     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16661        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16662           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16663                                                                  ELC50PD
 16664     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16665        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16666           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
 16667           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16668                                                                  ELC50PD
 16669 3345-EDIT-CONTINUE.                                              ELC50PD
 16670                                                                  ELC50PD
 16671*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16672*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16673*          IF PB-ISSUE                                            ELC50PD
 16674*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16675*          ELSE                                                   ELC50PD
 16676*              IF PB-CANCELLATION                                 ELC50PD
 16677*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16678                                                                  ELC50PD
 16679*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16680*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16681*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16682*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16683*        ELSE                                                     ELC50PD
 16684*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16685*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16686                                                                  ELC50PD
 16687     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16688        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16689           PB-REISSUED-CERT  OR                                   ELC50PD
 16690           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16691           PB-POLICY-IS-VOIDED                                    ELC50PD
 16692            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16693            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16694        ELSE                                                      ELC50PD
 16695            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16696            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16697                                                                  ELC50PD
 16698     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16699        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16700           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16701           PB-POLICY-IS-VOIDED                                    ELC50PD
 16702            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16703            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16704        ELSE                                                      ELC50PD
 16705            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16706                                      PB-I-ENTRY-STATUS.          ELC50PD
 16707                                                                  ELC50PD
 16708     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16709        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16710           PB-REISSUED-CERT  OR                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16711           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16712           PB-POLICY-IS-VOIDED                                    ELC50PD
 16713            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16714            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16715        ELSE                                                      ELC50PD
 16716            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16717                                      PB-I-ENTRY-STATUS.          ELC50PD
 16718                                                                  ELC50PD
 16719     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16720        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16721        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16722
 16723     IF PB-COMPANY-ID = 'DCC'
 16724        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 16725        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16726        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16727           AND (NOT WS-LF-CASH))
 16728                           OR
 16729           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16730           AND (NOT WS-AH-CASH)))
 16731                       AND
 16732           (PB-I-ENTRY-STATUS NOT = '5')
 16733           MOVE 'M'              TO PB-BATCH-ENTRY
 16734                                    PB-I-ENTRY-STATUS
 16735        END-IF
 16736     END-IF
 16737
 16738     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16739         GO TO 3999-END-EDIT.                                     ELC50PD
 16740                                                                  ELC50PD
 16741     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16742        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16743        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16744        PB-I-OB                                                   ELC50PD
 16745         GO TO 3999-END-EDIT.                                     ELC50PD
 16746                                                                  ELC50PD
 16747     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16748         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16749         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16750         GO TO 3999-END-EDIT.                                     ELC50PD
 16751                                                                  ELC50PD
 16752     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16753     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16754                                                                  ELC50PD
 16755     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16756         GO TO 3999-END-EDIT.                                     ELC50PD
 16757                                                                  ELC50PD
 16758     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16759                                      FORM-MASTER-AH-SW.          ELC50PD
 16760                                                                  ELC50PD
 16761     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16762         MOVE  +1                 TO SUB6                         ELC50PD
 16763         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16764                                                                  ELC50PD
 16765     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16766         MOVE  +1                 TO SUB6                         ELC50PD
 16767         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16768                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16769     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16770        AH-FORM-MASTER-FOUND                                      ELC50PD
 16771         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16772     ELSE                                                         ELC50PD
 16773         GO TO 3999-END-EDIT.                                     ELC50PD
 16774                                                                  ELC50PD
 16775******************************************************************ELC50PD
 16776*                  3350-GET-ERFORM                               *ELC50PD
 16777*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16778*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16779******************************************************************ELC50PD
 16780                                                                  ELC50PD
 16781 3350-GET-ERFORM.                                                 ELC50PD
 16782                                                                  ELC50PD
 16783     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16784         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16785                                                                  ELC50PD
 16786     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16787     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16788     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16789     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16790                                                                  ELC50PD
 16791     IF PB-CANCELLATION                                           ELC50PD
 16792         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16793            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16794            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16795              GO TO 3350-EXIT                                     ELC50PD
 16796         ELSE                                                     ELC50PD
 16797             NEXT SENTENCE                                        ELC50PD
 16798     ELSE                                                         ELC50PD
 16799         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16800            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16801            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16802              GO TO 3350-EXIT.                                    ELC50PD
 16803                                                                  ELC50PD
 16804 3350-ERFORM-GETMAIN.                                             ELC50PD
 16805                                                                  ELC50PD
 16806     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16807     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16808                                                                  ELC50PD
 16809 3350-ERFORM-READ.                                                ELC50PD
 16810                                                                  ELC50PD
 16811     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16812     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16813     IF PB-CANCELLATION                                           ELC50PD
 16814         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16815     ELSE                                                         ELC50PD
 16816         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16817     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16818                                                                  ELC50PD
 16819     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16820                                                                  ELC50PD
 16821     IF FORM-MASTER-FOUND                                         ELC50PD
 16822       IF PB-CANCELLATION                                         ELC50PD
 16823          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16824             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16825             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16826              GO  TO 3350-EXIT                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16827          ELSE                                                    ELC50PD
 16828              NEXT SENTENCE                                       ELC50PD
 16829       ELSE                                                       ELC50PD
 16830          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16831             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16832             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16833              GO  TO 3350-EXIT.                                   ELC50PD
 16834                                                                  ELC50PD
 16835     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16836     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16837     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16838                                                                  ELC50PD
 16839 3350-EXIT.                                                       ELC50PD
 16840      EXIT.                                                       ELC50PD
 16841                                                                  ELC50PD
 16842******************************************************************ELC50PD
 16843*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16844*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16845*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16846******************************************************************ELC50PD
 16847                                                                  ELC50PD
 16848 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16849                                                                  ELC50PD
 16850     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
 16851        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16852         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16853         GO TO   3355-EXIT.                                       ELC50PD
 16854                                                                  ELC50PD
 16855     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16856         ADD  +1      TO  SUB6                                    ELC50PD
 16857         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16858                                                                  ELC50PD
 16859     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16860     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16861                                                                  ELC50PD
 16862 3355-EXIT.                                                       ELC50PD
 16863      EXIT.                                                       ELC50PD
 16864                                                                  ELC50PD
 16865******************************************************************ELC50PD
 16866*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16867*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16868*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16869******************************************************************ELC50PD
 16870                                                                  ELC50PD
 16871 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16872                                                                  ELC50PD
 16873     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16874        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16875         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16876         GO TO  3356-EXIT.                                        ELC50PD
 16877                                                                  ELC50PD
 16878      IF  SUB6    LESS THAN     +40                               ELC50PD
 16879          ADD  +1      TO  SUB6                                   ELC50PD
 16880          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16881                                                                  ELC50PD
 16882     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16883     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16884                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16885 3356-EXIT.                                                       ELC50PD
 16886      EXIT.                                                       ELC50PD
 16887                                                                  ELC50PD
 16888******************************************************************ELC50PD
 16889*                  3357-BENEFIT-SEARCH                           *ELC50PD
 16890*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 16891*   CANCELLATIONS ONLY.                                          *ELC50PD
 16892******************************************************************ELC50PD
 16893 3357-BENEFIT-SEARCH.                                             ELC50PD
 16894     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16895         MOVE +1                          TO SUB6                 ELC50PD
 16896         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 16897                                                                  ELC50PD
 16898     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16899         MOVE +1                          TO SUB6                 ELC50PD
 16900         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 16901                                                                  ELC50PD
 16902 3357-EXIT.                                                       ELC50PD
 16903     EXIT.                                                        ELC50PD
 16904                                                                  ELC50PD
 16905******************************************************************ELC50PD
 16906*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 16907*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16908*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 16909*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16910******************************************************************ELC50PD
 16911 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 16912     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 16913       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 16914         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16915           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16916              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16917                     IS GREATER THAN SPACES                       ELC50PD
 16918                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16919                                          WS-LF-REFUND-CALC       ELC50PD
 16920                 GO TO 3358-EXIT.                                 ELC50PD
 16921                                                                  ELC50PD
 16922     IF SUB6 LESS THAN +40                                        ELC50PD
 16923         ADD +1                 TO SUB6                           ELC50PD
 16924         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 16925                                                                  ELC50PD
 16926 3358-EXIT.                                                       ELC50PD
 16927     EXIT.                                                        ELC50PD
 16928******************************************************************ELC50PD
 16929*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 16930*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16931*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 16932*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16933******************************************************************ELC50PD
 16934 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 16935     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 16936       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 16937         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16938           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16939              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16940                      IS GREATER THAN SPACES                      ELC50PD
 16941                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16942                                          WS-AH-REFUND-CALC       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16943                 GO TO 3359-EXIT.                                 ELC50PD
 16944                                                                  ELC50PD
 16945     IF SUB6 LESS THAN +40                                        ELC50PD
 16946         ADD +1                 TO SUB6                           ELC50PD
 16947         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 16948                                                                  ELC50PD
 16949 3359-EXIT.                                                       ELC50PD
 16950     EXIT.                                                        ELC50PD
 16951                                                                  ELC50PD
 16952******************************************************************ELC50PD
 16953*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 16954*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 16955*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 16956******************************************************************ELC50PD
 16957                                                                  ELC50PD
 16958 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 16959                                                                  ELC50PD
 16960     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 16961         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 16962                                                                  ELC50PD
 16963     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 16964         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 16965                                                                  ELC50PD
 16966 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
 16967                                                                  ELC50PD
 16968     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 16969       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 16970        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 16971        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 16972         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 16973            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 16974            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16975         ELSE                                                     ELC50PD
 16976            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 16977            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 16978                                                                  ELC50PD
 16979 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 16980                                                                  ELC50PD
 16981     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 16982                                                                  ELC50PD
 16983     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 16984         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 16985         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 16986            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 16987                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 16988                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 16989            ELSE                                                  ELC50PD
 16990                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 16991                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 16992                                                                  ELC50PD
 16993 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 16994                                                                  ELC50PD
 16995     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 16996         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 16997         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 16998            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 16999                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17000                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17001            ELSE                                                  ELC50PD
 17002                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17003                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17004                                                                  ELC50PD
 17005 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17006                                                                  ELC50PD
 17007     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17008         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17009         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17010           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17011               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17012               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17013           ELSE                                                   ELC50PD
 17014               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
 17015               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17016                                                                  ELC50PD
 17017     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17018                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17019                                                                  ELC50PD
 17020     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17021         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17022         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17023             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17024                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
 17025                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17026             ELSE                                                 ELC50PD
 17027                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17028                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17029                                                                  ELC50PD
 17030******************************************************************ELC50PD
 17031*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17032*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17033*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17034******************************************************************ELC50PD
 17035                                                                  ELC50PD
 17036 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17037                                                                  ELC50PD
 17038     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17039         GO TO 3999-END-EDIT.                                     ELC50PD
 17040                                                                  ELC50PD
 17041 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17042                                                                  ELC50PD
 17043     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17044       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17045        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17046        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17047         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17048            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17049            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17050         ELSE                                                     ELC50PD
 17051            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17052            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17053                                                                  ELC50PD
 17054 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17055                                                                  ELC50PD
 17056     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17057                                                                  ELC50PD
 17058     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17059         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17060         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17061            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17062                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17063                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17064            ELSE                                                  ELC50PD
 17065                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17066                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17067                                                                  ELC50PD
 17068 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17069                                                                  ELC50PD
 17070     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17071         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17072         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
 17073            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17074                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17075                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17076            ELSE                                                  ELC50PD
 17077                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17078                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17079                                                                  ELC50PD
 17080 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17081                                                                  ELC50PD
 17082     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
 17083         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17084         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17085             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17086                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17087                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17088             ELSE                                                 ELC50PD
 17089                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17090                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17091                                                                  ELC50PD
 17092     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17093         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17094         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17095             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17096                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17097                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17098             ELSE                                                 ELC50PD
 17099                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17100                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17101                                                                  ELC50PD
 17102     GO TO 3999-END-EDIT.                                         ELC50PD
 17103                                                                  ELC50PD
 17104******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17106******************************************************************ELC50PD
 17107*                  E D I T   C A N C E L                         *ELC50PD
 17108******************************************************************ELC50PD
 17109                                                                  ELC50PD
 17110 3700-EDIT-CANCEL.                                                ELC50PD
 17111     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17112         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17113                                         WS-RES-MUNI-TAX          ELC50PD
 17114                                         PB-CI-STATE-TAX          ELC50PD
 17115                                         PB-CI-MUNI-TAX           ELC50PD
 17116         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17117                                                                  ELC50PD
 17118*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17119*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17120*          IF PB-CANCELLATION                                     ELC50PD
 17121*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17122*          ELSE                                                   ELC50PD
 17123*             IF PB-ISSUE                                         ELC50PD
 17124*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17125                                                                  ELC50PD
 17126     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17127        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17128     END-IF
 17129
 17130*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17131*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17132                                                                  ELC50PD
 17133     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17134        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17135        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17136        GO TO 3999-END-EDIT.                                      ELC50PD
 17137                                                                  ELC50PD
 17138     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17139        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17141        GO TO 3999-END-EDIT.                                      ELC50PD
 17142                                                                  ELC50PD
 17143     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17144        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17146                                                                  ELC50PD
 17147***************************************************************   ELC50PD
 17148*                                                             *   ELC50PD
 17149*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17150*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17151*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17152*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17153*                                                             *   ELC50PD
 17154***************************************************************   ELC50PD
 17155                                                                  ELC50PD
 17156     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17157                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17158                                                                  ELC50PD
 17159     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17160        NEXT SENTENCE                                             ELC50PD
 17161     ELSE                                                         ELC50PD
 17162        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17163           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17164           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17165               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17166               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17167               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17168                                                                  ELC50PD
 17169     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17170        NEXT SENTENCE                                             ELC50PD
 17171     ELSE                                                         ELC50PD
 17172        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17173           AND                                                    ELC50PD
 17174           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17175               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17176               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17177               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17178                                                                  ELC50PD
 17179     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17180        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17181                                                                  ELC50PD
 17182     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17183     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17184     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17185     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17186     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17187     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17188                                                                  ELC50PD
 17189     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17190                                      PB-C-AH-REF-CALC.           ELC50PD
 17191     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17192                                                                  ELC50PD
 17193******************************************************************ELC50PD
 17194*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17195*             TO VALIDATE COVERAGE.                              *ELC50PD
 17196******************************************************************ELC50PD
 17197                                                                  ELC50PD
 17198     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17199        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17200          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17201      ELSE                                                        ELC50PD
 17202          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17203                                                                  ELC50PD
 17204     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17205        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17206          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17207      ELSE                                                        ELC50PD
 17208          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17209                                                                  ELC50PD
 17210     EVALUATE TRUE                                                ELC50PD
 17211         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17212              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17213              PB-FORCE-OFF                                        ELC50PD
 17214                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17215                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17216                  END-IF                                          ELC50PD
 17217         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17218               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17219              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17220                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17221         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17222              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17223                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17224              ELSE                                                ELC50PD
 17225                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17226              END-IF                                              ELC50PD
 17227              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17228     END-EVALUATE.                                                ELC50PD
 17229                                                                  ELC50PD
 17230                                                                  ELC50PD
 17231*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17232*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17233*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17234*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17235*        ELSE                                                     ELC50PD
 17236*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17237                                                                  ELC50PD
 17238     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17239     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17240        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17241     ELSE
 17242        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17243     END-IF
 17244     .
 17245 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17246                                                                  ELC50PD
 17247     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17248        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17249         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17250         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17251                                 TO DC-BIN-DATE-2                 ELC50PD
 17252         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17253*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17254         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17255         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17256            NEXT SENTENCE                                         ELC50PD
 17257          ELSE                                                    ELC50PD
 17258             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17259                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17260                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17261                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17262                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17263                 ELSE                                             ELC50PD
 17264                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17265                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17266                                                                  ELC50PD
 17267     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17268        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17269         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17270         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17271                                 TO DC-BIN-DATE-2                 ELC50PD
 17272         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17273*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17274         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17275         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17276            NEXT SENTENCE                                         ELC50PD
 17277          ELSE                                                    ELC50PD
 17278             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17279                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17280                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17281                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17282                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17283                 ELSE                                             ELC50PD
 17284                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17285                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17286                                                                  ELC50PD
 17287     IF WS-ERROR = ER-2752                                        ELC50PD
 17288        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17289         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17290         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17291         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17292         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17293         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17294         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17295         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17296         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17297         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17298         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17299         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17300         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17301         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17302         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17303            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17304            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17305            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17306                                                                  ELC50PD
 17307     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17308        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17309        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17310             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17312                                                                  ELC50PD
 17313     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17314        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17315        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17316              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17317              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17318                                                                  ELC50PD
 17319     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17320        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17321        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17322           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17323            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17324              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17325               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17326               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17327                                                                  ELC50PD
 17328     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17329         GO TO 3999-END-EDIT.                                     ELC50PD
 17330                                                                  ELC50PD
 17331     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17332        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17333           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17334            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17335            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17336                                 TO DC-BIN-DATE-2                 ELC50PD
 17337            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17338*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17339            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17340            IF DATE-CONVERSION-ERROR                              ELC50PD
 17341               NEXT SENTENCE                                      ELC50PD
 17342             ELSE                                                 ELC50PD
 17343                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17344                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17345                                                                  ELC50PD
 17346     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17347        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17348           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17349            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17350            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17351                                 TO DC-BIN-DATE-2                 ELC50PD
 17352            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17353                                    DC-ELAPSED-MONTHS             ELC50PD
 17354            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17355*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17356            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17357            IF DATE-CONVERSION-ERROR                              ELC50PD
 17358               NEXT SENTENCE                                      ELC50PD
 17359             ELSE                                                 ELC50PD
 17360                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17361                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17362                                                                  ELC50PD
 17363     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17364                                    DC-ELAPSED-MONTHS.            ELC50PD
 17365                                                                  ELC50PD
 17366     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17367        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17368          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17369          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17370          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17371          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17372          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17373          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17374        ELSE                                                      ELC50PD
 17375          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17376                                     PB-C-LIVES                   ELC50PD
 17377          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17378             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17379                                                                  ELC50PD
 17380     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17381         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17382     ELSE                                                         ELC50PD
 17383         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17384                                                                  ELC50PD
 17385     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17386        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17387            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17388            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17389                                                                  ELC50PD
 17390     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17391        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17392         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17393            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17394               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17395               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17396                                                                  ELC50PD
 17397     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17398        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17399         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17400            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17401               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17402               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17403                                                                  ELC50PD
 17404     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17405        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17406         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17407            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17408            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17409                                                                  ELC50PD
 17410     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17411        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17412         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17413            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17414            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17415                                                                  ELC50PD
 17416     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17417        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17418         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17419         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17420         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17421*        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17422         SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17423         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17424         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17425            NEXT SENTENCE                                         ELC50PD
 17426          ELSE                                                    ELC50PD
 17427            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17428              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17429                             OR  'FIA'                            ELC50PD
 17430                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17431               ELSE                                               ELC50PD
 17432                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17433                MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17434                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17435                                                                  ELC50PD
 17436 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17437                                                                  ELC50PD
 17438     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17439        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17440         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17441         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17442         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17443*        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17444         SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17445         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17446         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17447            NEXT SENTENCE                                         ELC50PD
 17448          ELSE                                                    ELC50PD
 17449            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17450              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17451                              OR 'FIA'                            ELC50PD
 17452                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
 17453              ELSE                                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17454               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17455               MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17456               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17457                                                                  ELC50PD
 17458 3705-EDIT-CONTINUED.                                             ELC50PD
 17459                                                                  ELC50PD
 17460*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17461*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17462*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17463*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17464*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17465*                                                                 ELC50PD
 17466*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17467*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17468*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17469*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17470*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17471*        ELSE                                                     ELC50PD
 17472*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17473*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17474*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17475                                                                  ELC50PD
 17476     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17477       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17478         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17479           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17480              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17481              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17482                                                                  ELC50PD
 17483     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17484        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17485            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17486            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17487            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17488                                                                  ELC50PD
 17489     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17490            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17491            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17492                                                                  ELC50PD
 17493     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17494         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17495            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17496            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17497                                                                  ELC50PD
 17498 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17499                                                                  ELC50PD
 17500     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17501         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17502             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17503                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17504                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17505                                                                  ELC50PD
 17506     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17507         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17508             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17509                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17510                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17511                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17512 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17513                                                                  ELC50PD
 17514*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17515*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17516*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17517*           (NOT PB-CI-OB)                                        ELC50PD
 17518*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17519*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17520*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17521*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17522*                                                                 ELC50PD
 17523*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17524*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17525*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17526*           (NOT PB-CI-OB)                                        ELC50PD
 17527*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17528*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17529*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17530*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17531                                                                  ELC50PD
 17532     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17533         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17534            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17535             NEXT SENTENCE                                        ELC50PD
 17536         ELSE                                                     ELC50PD
 17537           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17538              NEXT SENTENCE                                       ELC50PD
 17539           ELSE                                                   ELC50PD
 17540              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17541              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17542                                                                  ELC50PD
 17543     IF CANCEL-FUTURE-DT                                          ELC50PD
 17544         GO TO 3999-END-EDIT.                                     ELC50PD
 17545                                                                  ELC50PD
 17546 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17547                                                                  ELC50PD
 17548     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17549        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17550        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17551                                                                  ELC50PD
 17552     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17553     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17554     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17555     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17556     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17557     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17558     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17559     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17560     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17561     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17562     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17563     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17564
 17565     IF (PB-COMPANY-ID = 'CID')
 17566        AND (CP-STATE-STD-ABBRV = 'WI')
 17567        MOVE '7'                 TO CP-REM-TERM-METHOD
 17568        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17569     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17570        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17571        MOVE WS-REM-TRM-CALC-OPTION
 17572                                 TO CP-REM-TRM-CALC-OPTION
 17573     END-IF
 17574
 17575**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17576     IF (PB-COMPANY-ID = 'CID')
 17577        AND (CP-STATE-STD-ABBRV = 'MO')
 17578        AND (PB-CERT-EFF-DT >= X'9B41')
 17579        AND (PB-CERT-EFF-DT <= X'A2FB')
 17580        MOVE '7'                 TO CP-REM-TERM-METHOD
 17581        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17582     END-IF
 17583
 17584     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17585                                    CP-LOAN-TERM.                 ELC50PD
 17586     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17587        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17588                                                                  ELC50PD
 17589     IF CP-TERM-IS-DAYS                                           ELC50PD
 17590         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17591     ELSE                                                         ELC50PD
 17592         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17593                                                                  ELC50PD
 17594     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17595                                                                  ELC50PD
 17596     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17597                                                                  ELC50PD
 17598     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17599        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17600        NEXT SENTENCE                                             ELC50PD
 17601      ELSE                                                        ELC50PD
 17602          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17603                                                                  ELC50PD
 17604 3720-GET-LF-REFUND.                                              ELC50PD
 17605                                                                  ELC50PD
 17606     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17607        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17608        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17609                                                                  ELC50PD
 17610     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17611         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17612         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17613         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17614                                                                  ELC50PD
 17615     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17616        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17617         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17619         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17620         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17621         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17622                                                                  ELC50PD
 17623     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17624                                                                     CL**2
 17625     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17626     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17627     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17628     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17629     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17630     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17631
 17632     IF (PB-COMPANY-ID = 'DCC')
 17633        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17634
 17635        IF PDEF-MASTER-FOUND
 17636           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17637              (V1 > +8)
 17638              OR (PD-PROD-CODE (V1) = 'L')
 17639           END-PERFORM
 17640           IF V1 < +9
 17641              MOVE PD-MAX-AMT (V1)
 17642                           TO CP-R-MAX-TOT-BEN
 17643                              EC-AM-LF-MAX-TOT-BEN
 17644           END-IF
 17645        ELSE
 17646
 17647        MOVE ' '                 TO PDEF-MASTER-SW
 17648        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17649        MOVE PB-STATE            TO ERPDEF-STATE
 17650        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17651        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17652        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17653        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17654        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17655        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17656        IF PDEF-MASTER-FOUND
 17657           MOVE 'N'              TO PDEF-MASTER-SW
 17658           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17659           IF PDEF-MASTER-FOUND
 17660              IF (ERPDEF-KEY-SAVE (1:16) =
 17661                           PD-CONTROL-PRIMARY (1:16))
 17662                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17663                 CONTINUE
 17664              ELSE
 17665                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17666                 IF (ERPDEF-KEY-SAVE (1:16) =
 17667                           PD-CONTROL-PRIMARY (1:16))
 17668                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17669                    CONTINUE
 17670                 ELSE
 17671                    MOVE 'N'     TO PDEF-MASTER-SW
 17672                 END-IF
 17673              END-IF
 17674              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17675
 17676              IF PDEF-MASTER-FOUND
 17677                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17678                    (V1 > +8)
 17679                    OR (PD-PROD-CODE (V1) = 'L')
 17680                 END-PERFORM
 17681                 IF V1 < +9
 17682                    MOVE PD-MAX-AMT (V1)
 17683                                 TO CP-R-MAX-TOT-BEN
 17684                                    EC-AM-LF-MAX-TOT-BEN
 17685                 END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17686              END-IF
 17687           END-IF
 17688           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17689        END-IF
 17690        END-IF
 17691     END-IF
 17692
 17693     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17694                                                                  ELC50PD
 17695     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17696                                                                  ELC50PD
 17697     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17698                                    PB-C-LF-REM-TERM.                CL**2
 17699                                                                     CL**2
 17700     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17701     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17702                                                                  ELC50PD
 17703     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17704        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17705           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17706           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17707                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17708                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17709           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17710              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17711              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17712           ELSE                                                   ELC50PD
 17713              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17714                                                                  ELC50PD
 17715     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17716                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17717                            OR '9' OR 'G'
 17718        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17719                                 TO CP-EARNING-METHOD.            ELC50PD
 17720                                                                  ELC50PD
 17721     if pb-company-id = 'AHL'
 17722        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17723        if cp-class-code = spaces
 17724           move zeros            to cp-class-code
 17725        end-if
 17726     ELSE
 17727        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17728     END-IF
 17729
 17730*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17731     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17732     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17733                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17734     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17735         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17736                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17737     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17738     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
 17739     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17740     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17741     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17742     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17743     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17744     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17745         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17746                                                                  ELC50PD
 17747****   N O T E   ****
 17748*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17749*      THE OH HARD CODING IN ELCRFNDP
 17750
 17751     IF PB-COMPANY-ID = 'CID'
 17752        IF CP-STATE-STD-ABBRV = 'OH'
 17753           MOVE WS-LF-EARNINGS-CALC
 17754                                 TO CP-EARNING-METHOD
 17755        END-IF
 17756     END-IF
 17757
 17758****   N O T E   ****
 17759
 17760     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17761         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17762            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17763                MOVE WS-DEFAULT-APR                               ELC50PD
 17764                                 TO  CP-LOAN-APR                  ELC50PD
 17765                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17766                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17767            ELSE                                                  ELC50PD
 17768                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17769                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17770
 17771     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17772
 17773     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17774                                                                  ELC50PD
 17775     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17776         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17777                                                                  ELC50PD
 17778     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17779        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17780        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17782                                                                  ELC50PD
 17783     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17784        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17786                                                                  ELC50PD
 17787     IF PB-COMPANY-ID = 'DCC'
 17788        AND PB-CI-ENTRY-STATUS = 'M'
 17789        MOVE +0                  TO PB-C-LF-REF-CALC
 17790     ELSE
 17791        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17792     END-IF
 17793                                                                  ELC50PD
 17794     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17795         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17796                                                                  ELC50PD
 17797*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17798*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17799*                                   CP-REMAINING-TERM             ELC50PD
 17800*                                   CP-ORIGINAL-TERM.             ELC50PD
 17801                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17802     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17803     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17804                                    CP-RATING-METHOD.             ELC50PD
 17805
 17806     IF PB-COMPANY-ID = 'CID'
 17807        IF (CP-STATE-STD-ABBRV = 'MN')
 17808           AND (PB-CERT-EFF-DT > X'A4FF')
 17809           AND (WS-LF-EARNINGS-CALC = 'B')
 17810           MOVE '5'              TO CP-EARNING-METHOD
 17811           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17812        END-IF
 17813     END-IF
 17814
 17815     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17816                                        CP-REMAINING-BENEFIT      ELC50PD
 17817                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17818     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17819         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17820                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17821     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17822     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17823                                                                  ELC50PD
 17824     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17825                                                                  ELC50PD
 17826     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17827        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17828        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17830                                                                  ELC50PD
 17831     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17832        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17834                                                                  ELC50PD
 17835     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 17836                                                                  ELC50PD
 17837******************************************************************ELC50PD
 17838                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17840 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 17841     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 17842        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 17843         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17844                                                                  ELC50PD
 17845     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 17846         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 17847            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 17848             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 17849                                                                  ELC50PD
 17850     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 17851     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17852     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17853     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17854     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17855     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17856     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 17857     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17858     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17859     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17860     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17861     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17862
 17863     IF (PB-COMPANY-ID = 'CID')
 17864        AND (CP-STATE-STD-ABBRV = 'WI')
 17865        MOVE '7'                 TO CP-REM-TERM-METHOD
 17866        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17867     ELSE
 17868        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17869        MOVE WS-REM-TRM-CALC-OPTION
 17870                                 TO CP-REM-TRM-CALC-OPTION
 17871     END-IF
 17872
 17873     IF (PB-COMPANY-ID = 'CID')
 17874        AND (CP-STATE-STD-ABBRV = 'MO')
 17875        AND (PB-CERT-EFF-DT >= X'9B41')
 17876        AND (PB-CERT-EFF-DT <= X'A2FB')
 17877        MOVE '7'                 TO CP-REM-TERM-METHOD
 17878        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17879     END-IF
 17880
 17881     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17882                                    CP-LOAN-TERM.                 ELC50PD
 17883     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 17884         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17885                                                                  ELC50PD
 17886     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 17887                                                                  ELC50PD
 17888     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17889                                                                  ELC50PD
 17890     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17891        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17892        NEXT SENTENCE                                             ELC50PD
 17893      ELSE                                                        ELC50PD
 17894         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17895                                                                  ELC50PD
 17896 3740-GET-AH-REFUND.                                              ELC50PD
 17897                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17898     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17899        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17900        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17901                                                                  ELC50PD
 17902     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 17903         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17904         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17905                                                                  ELC50PD
 17906     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 17907*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 17908     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 17909     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 17910     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 17911                                    PB-C-AH-REM-TERM.             ELC50PD
 17912     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17913     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17914                                                                  ELC50PD
 17915     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17916        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17917           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 17918           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 17919                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 17920           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 17921              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 17922              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 17923           ELSE                                                   ELC50PD
 17924              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 17925                                                                  ELC50PD
 17926     IF PB-COMPANY-ID = 'DCC'
 17927        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17928            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 17929           MOVE 'S'              TO CP-EARNING-METHOD
 17930        END-IF
 17931     END-IF
 17932
 17933     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17934                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17935                            OR '9' OR 'G' OR 'S'
 17936        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 17937                                 TO CP-EARNING-METHOD.            ELC50PD
 17938                                                                  ELC50PD
 17939     if pb-company-id = 'AHL'
 17940        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 17941        if cp-class-code = spaces
 17942           move zeros            to cp-class-code
 17943        end-if
 17944     ELSE
 17945        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17946     END-IF
 17947*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17948     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17949     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17950                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17951     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17952         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 17953                                         PB-CI-AH-TERM.           ELC50PD
 17954     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17955     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17956     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17957     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 17958     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 17959     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17960                                                                  ELC50PD
 17961     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 17962        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 17963                                AND 'CID' AND 'DCC' AND 'AHL')
 17964           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 17965              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 17966              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 17967              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 17968           END-IF
 17969        END-IF
 17970        IF PB-COMPANY-ID = 'CID'
 17971           IF NO-LIFE-COVERAGE
 17972              IF CP-CRITICAL-PERIOD
 17973                 MOVE '2'       TO CP-EARNING-METHOD
 17974              ELSE
 17975                 MOVE '6'       TO CP-EARNING-METHOD
 17976              END-IF
 17977           ELSE
 17978              IF WS-LF-COVERAGE-TYPE = 'L'
 17979                 MOVE '2'       TO CP-EARNING-METHOD
 17980              ELSE
 17981                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 17982                    (WS-LF-EARNINGS-CALC = '5')
 17983                    IF CP-CRITICAL-PERIOD
 17984                       MOVE '2'  TO CP-EARNING-METHOD
 17985                    ELSE
 17986                       MOVE '6'  TO CP-EARNING-METHOD
 17987                    END-IF
 17988                 ELSE
 17989                    MOVE '1'     TO CP-EARNING-METHOD
 17990                 END-IF
 17991              END-IF
 17992           END-IF
 17993        END-IF
 17994     END-IF
 17995                                                                  ELC50PD
 17996*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 17997*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 17998*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 17999*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18000*          ELSE                                                   ELC50PD
 18001*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18002                                                                  ELC50PD
 18003     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18004         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18005                                                                  ELC50PD
 18006     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18007         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18008            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18009                MOVE WS-DEFAULT-APR                               ELC50PD
 18010                                 TO  CP-LOAN-APR                  ELC50PD
 18011                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18012                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18013            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18014                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18015                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18016
 18017     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18018
 18019
 18020     IF PB-COMPANY-ID = 'DCC'
 18021        AND CP-CANCEL-REASON = 'R'
 18022        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18023        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18024     END-IF
 18025
 18026     IF PB-COMPANY-ID = 'DCC'
 18027        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18028        AND (CP-EARNING-METHOD = 'D')
 18029        AND (CP-CANCEL-REASON NOT = 'R')
 18030        CONTINUE
 18031     ELSE
 18032        GO TO 3750-CONTINUE
 18033     END-IF
 18034
 18035     MOVE ' '                    TO DD-IU-SW
 18036     IF NOT PDEF-MASTER-FOUND
 18037        MOVE ' '                 TO PDEF-MASTER-SW
 18038        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18039        MOVE PB-STATE            TO ERPDEF-STATE
 18040        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18041        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18042        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18043        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18044        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18045        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18046        IF PDEF-MASTER-FOUND
 18047           MOVE 'N'              TO PDEF-MASTER-SW
 18048           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18049           IF PDEF-MASTER-FOUND
 18050              IF (ERPDEF-KEY-SAVE (1:16) =
 18051                           PD-CONTROL-PRIMARY (1:16))
 18052                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18053                 CONTINUE
 18054              ELSE
 18055                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18056                 IF (ERPDEF-KEY-SAVE (1:16) =
 18057                           PD-CONTROL-PRIMARY (1:16))
 18058                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18059                    CONTINUE
 18060                 ELSE
 18061                    MOVE ER-2740 TO WS-ERROR
 18062                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18063                    GO TO 3770-CHECK-REFUNDS
 18064                 END-IF
 18065              END-IF
 18066           END-IF
 18067           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18068        END-IF
 18069     END-IF
 18070
 18071     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18072        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18073           (V1 > +8)
 18074           OR (PD-PROD-CODE (V1) = 'I')
 18075        END-PERFORM
 18076        IF V1 < +9
 18077           SET DD-IU-PRESENT        TO TRUE
 18078        END-IF
 18079        IF WS-AH-DCC-TRUNC = 'T'
 18080           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18081        ELSE
 18082           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18083        END-IF
 18084        EVALUATE TRUE
 18085           WHEN WS-TERM > +168
 18086              MOVE 15               TO V1
 18087           WHEN WS-TERM > +156
 18088              MOVE 14               TO V1
 18089           WHEN WS-TERM > +144
 18090              MOVE 13               TO V1
 18091           WHEN WS-TERM > +132
 18092              MOVE 12               TO V1
 18093           WHEN WS-TERM > +120
 18094              MOVE 11               TO V1
 18095           WHEN WS-TERM > +108
 18096              MOVE 10               TO V1
 18097           WHEN WS-TERM > +96
 18098              MOVE 9                TO V1
 18099           WHEN WS-TERM > +84
 18100              MOVE 8                TO V1
 18101           WHEN WS-TERM > +72
 18102              MOVE 7                TO V1
 18103           WHEN WS-TERM > +60
 18104              MOVE 6                TO V1
 18105           WHEN WS-TERM > +48
 18106              MOVE 5                TO V1
 18107           WHEN WS-TERM > +36
 18108              MOVE 4                TO V1
 18109           WHEN WS-TERM > +24
 18110              MOVE 3                TO V1
 18111           WHEN WS-TERM > +12
 18112              MOVE 2                TO V1
 18113           WHEN OTHER
 18114              MOVE 1                TO V1
 18115        END-EVALUATE
 18116
 18117        EVALUATE TRUE
 18118*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18119*             < +13)
 18120*             AND (DD-IU-PRESENT)
 18121*             MOVE 2                TO V2
 18122*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18123*             MOVE 1                TO V2
 18124           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18125              MOVE 2                TO V2
 18126           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18127              MOVE 3                TO V2
 18128           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18129              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18130           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18131              MOVE 5                TO V2
 18132           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18133              MOVE 6                TO V2
 18134           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18135              MOVE 7                TO V2
 18136           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18137              MOVE 8                TO V2
 18138           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18139              MOVE 9                TO V2
 18140           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18141              MOVE 10               TO V2
 18142           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18143              MOVE 11               TO V2
 18144           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18145              MOVE 12               TO V2
 18146           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18147              MOVE 13               TO V2
 18148           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18149              MOVE 14               TO V2
 18150           WHEN OTHER
 18151              MOVE 15               TO V2
 18152        END-EVALUATE
 18153
 18154        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18155                                 TO CP-DDF-LO-FACT
 18156        MOVE PD-UEP-FACTOR (V1 V2)
 18157                                 TO CP-DDF-HI-FACT
 18158
 18159        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18160        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18161
 18162        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18163           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18164        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18165        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18166
 18167        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18168           + PD-1ST-YR-ADMIN-ALLOW
 18169
 18170        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18171*       IF PI-CLP-YN = 'Y'
 18172*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18173*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18174*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18175*       END-IF
 18176
 18177        IF DD-IU-PRESENT
 18178           MOVE 'I'              TO CP-EARNING-METHOD
 18179        END-IF
 18180        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18181                                     CP-CLP-RATE-UP
 18182        IF CP-IU-RATE-UP NOT = ZEROS
 18183           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18184              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18185           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18186              / (1 - WS-WORK-FACT)
 18187        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18188     END-IF
 18189
 18190     .
 18191 3750-CONTINUE.
 18192
 18193     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18194                                                                  ELC50PD
 18195     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18196         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18197                                                                  ELC50PD
 18198     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18199        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18200        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18202                                                                  ELC50PD
 18203     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18204        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18206
 18207     IF PB-COMPANY-ID = 'DCC'
 18208        AND PB-CI-ENTRY-STATUS = 'M'
 18209        MOVE +0                  TO PB-C-AH-REF-CALC
 18210     ELSE
 18211        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18212     END-IF
 18213
 18214     IF PB-COMPANY-ID = 'DCC'
 18215        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18216        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18217        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18218        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18219        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18220        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18221        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18222        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18223        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18224     END-IF
 18225
 18226     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18228                                                                  ELC50PD
 18229 3770-CHECK-REFUNDS.                                              ELC50PD
 18230                                                                  ELC50PD
 18231     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18232        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18233           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18235           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18236           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18237              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18238                                                                  ELC50PD
 18239     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18240        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18241           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18242           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18243           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18244           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18245              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18246                                                                  ELC50PD
 18247     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18248        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18249        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18250           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18251              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18252                                                                  ELC50PD
 18253     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18254        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18255        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18256           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18257              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18258                                                                  ELC50PD
 18259     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18260             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18261     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18262             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18263                                                                  ELC50PD
 18264     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18265         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18266                                                                  ELC50PD
 18267     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18268         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18269                                                                  ELC50PD
 18270     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18271                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18273                                                                  ELC50PD
 18274 3772-CONTINUE.                                                   ELC50PD
 18275                                                                  ELC50PD
 18276**********************************                                ELC50PD
 18277*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18278*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18279*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18280***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18281**********************************                                ELC50PD
 18282     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18283     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18284         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18285             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18287           ELSE                                                   ELC50PD
 18288             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18289             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18290**********************************                                ELC50PD
 18291                                                                  ELC50PD
 18292 3773-CONTINUE.                                                   ELC50PD
 18293                                                                  ELC50PD
 18294     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18295        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18296           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18297           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18298                                                                  ELC50PD
 18299     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18300        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18301           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18302           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18303                                                                  ELC50PD
 18304     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18305         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18306             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18307     ELSE                                                         ELC50PD
 18308         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18309                                                                  ELC50PD
 18310     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18311         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18312             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18313     ELSE                                                         ELC50PD
 18314         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18315                                                                  ELC50PD
 18316     IF (PB-COMPANY-ID = 'DCC')
 18317        AND (PB-CI-ENTRY-STATUS = 'M')
 18318        AND (PB-C-LF-CANCEL-AMT > +0)
 18319        MOVE ER-3843             TO WS-ERROR
 18320        PERFORM 9900-ERROR-FORMAT
 18321                                 THRU 9900-EXIT
 18322     END-IF
 18323     EVALUATE TRUE                                                ELC50PD
 18324        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18325           CONTINUE                                               ELC50PD
 18326        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18327                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18328           CONTINUE                                               ELC50PD
 18329        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18330                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18331           CONTINUE                                               ELC50PD
 18332        WHEN OTHER                                                ELC50PD
 18333           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18334              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18335           END-IF                                                 ELC50PD
 18336           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18337                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18338                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18339              CONTINUE                                            ELC50PD
 18340           ELSE                                                   ELC50PD
 18341              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18342                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18343              END-IF                                              ELC50PD
 18344              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18345                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18346                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18347                 CONTINUE                                         ELC50PD
 18348              ELSE                                                ELC50PD
 18349                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18350                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18351                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18352                 ELSE                                             ELC50PD
 18353                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18354                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18355                 END-IF                                           ELC50PD
 18356              END-IF                                              ELC50PD
 18357           END-IF                                                 ELC50PD
 18358     END-EVALUATE.                                                ELC50PD
 18359                                                                  ELC50PD
 18360     EVALUATE TRUE                                                ELC50PD
 18361        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18362           CONTINUE                                               ELC50PD
 18363        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18364                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18365           CONTINUE                                               ELC50PD
 18366        WHEN OTHER                                                ELC50PD
 18367           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18368               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18369              CONTINUE                                            ELC50PD
 18370           ELSE                                                   ELC50PD
 18371              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18372               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18373                CONTINUE                                          ELC50PD
 18374              ELSE                                                ELC50PD
 18375                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18376                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18377                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18378                 ELSE                                             ELC50PD
 18379                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18380                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18381                 END-IF                                           ELC50PD
 18382              END-IF                                              ELC50PD
 18383           END-IF                                                 ELC50PD
 18384     END-EVALUATE.                                                ELC50PD
 18385                                                                  ELC50PD
 18386     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18387         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18388             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18389     ELSE                                                         ELC50PD
 18390         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18391                                                                  ELC50PD
 18392     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18393         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18394             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18395     ELSE                                                         ELC50PD
 18396         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18397                                                                  ELC50PD
 18398     IF (PB-COMPANY-ID = 'DCC')
 18399        AND (PB-CI-ENTRY-STATUS = 'M')
 18400        AND (PB-C-AH-CANCEL-AMT > +0)
 18401        MOVE ER-3843             TO WS-ERROR
 18402        PERFORM 9900-ERROR-FORMAT
 18403                                 THRU 9900-EXIT
 18404     END-IF
 18405     EVALUATE TRUE                                                ELC50PD
 18406        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18407           CONTINUE                                               ELC50PD
 18408*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18409*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18410        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18411                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18412           CONTINUE                                               ELC50PD
 18413        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18414                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18415           CONTINUE                                               ELC50PD
 18416        WHEN OTHER                                                ELC50PD
 18417           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18418              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18419           END-IF                                                 ELC50PD
 18420           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18421               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18422                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18423              CONTINUE                                            ELC50PD
 18424           ELSE                                                   ELC50PD
 18425              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18426                 MOVE +9999999.99 TO                              ELC50PD
 18427                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18428              END-IF                                              ELC50PD
 18429              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18430                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18431                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18432                 CONTINUE                                         ELC50PD
 18433              ELSE                                                ELC50PD
 18434                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18435                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18436                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18437                 ELSE                                             ELC50PD
 18438                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18439                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18440                 END-IF                                           ELC50PD
 18441              END-IF                                              ELC50PD
 18442           END-IF                                                 ELC50PD
 18443     END-EVALUATE.                                                ELC50PD
 18444                                                                  ELC50PD
 18445     EVALUATE TRUE                                                ELC50PD
 18446        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18447           CONTINUE                                               ELC50PD
 18448*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18449*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18450        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18451                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18452           CONTINUE                                               ELC50PD
 18453        WHEN OTHER                                                ELC50PD
 18454           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18455               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18456              CONTINUE                                            ELC50PD
 18457           ELSE                                                   ELC50PD
 18458              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18459                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18460                 CONTINUE                                         ELC50PD
 18461              ELSE                                                ELC50PD
 18462                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18463                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18464                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18465                 ELSE                                             ELC50PD
 18466                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18467                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18468                 END-IF                                           ELC50PD
 18469              END-IF                                              ELC50PD
 18470           END-IF                                                 ELC50PD
 18471     END-EVALUATE.                                                ELC50PD
 18472                                                                  ELC50PD
 18473     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18474        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18475        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18476           AND  PB-C-LF-REF-CALC < +1.00
 18477           AND  PB-C-AH-REF-CALC < +1.00
 18478           CONTINUE
 18479        ELSE
 18480           IF (PB-COMPANY-ID = 'DCC')
 18481              AND (PB-CI-ENTRY-STATUS = 'M')
 18482              CONTINUE
 18483           ELSE
 18484              MOVE ER-2741       TO WS-ERROR
 18485              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18486           END-IF
 18487        END-IF
 18488     END-IF
 18489                                                                  ELC50PD
 18490     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18491        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18492        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18493        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18494        OR                                                        ELC50PD
 18495        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18496        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18497        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18498             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18499                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18500                NEXT SENTENCE                                     ELC50PD
 18501             ELSE                                                 ELC50PD
 18502                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18503                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18504                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18505     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18506        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18507        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18508        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18509        OR                                                        ELC50PD
 18510        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18511        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18512        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18513             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18514                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18515                NEXT SENTENCE                                     ELC50PD
 18516             ELSE                                                 ELC50PD
 18517                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18518                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18519                                                                  ELC50PD
 18520 3775-OVER-REF-CHK.                                               ELC50PD
 18521                                                                  ELC50PD
 18522     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18523        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18524                                                                  ELC50PD
 18525     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18526                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18527                                                                  ELC50PD
 18528     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18529        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18530                                 PB-C-LF-REF-CALC                 ELC50PD
 18531      ELSE                                                        ELC50PD
 18532        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18533                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18534                                                                  ELC50PD
 18535     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18536        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18538                                                                  ELC50PD
 18539     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18540                                                                  ELC50PD
 18541     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18542        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18543                                 PB-C-AH-REF-CALC                 ELC50PD
 18544      ELSE                                                        ELC50PD
 18545        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18546                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18547                                                                  ELC50PD
 18548     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18549        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18551                                                                  ELC50PD
 18552     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18553        NEXT SENTENCE                                             ELC50PD
 18554       ELSE                                                       ELC50PD
 18555         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18556            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18557            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18558                                                                  ELC50PD
 18559 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18560                                                                  ELC50PD
 18561     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18562        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18564                                                                  ELC50PD
 18565     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18566         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18568                                                                  ELC50PD
 18569     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18570         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18571                                                                  ELC50PD
 18572     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18573         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18574                                                                  ELC50PD
 18575     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18576       AND                                                        ELC50PD
 18577        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18578       AND                                                        ELC50PD
 18579        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18580       AND                                                        ELC50PD
 18581        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18582            NEXT SENTENCE                                         ELC50PD
 18583       ELSE                                                       ELC50PD
 18584        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18585          AND                                                     ELC50PD
 18586***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18587***       AND                                                     ELC50PD
 18588           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18589            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18590               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18591               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18592               GO TO 3999-END-EDIT                                ELC50PD
 18593            ELSE                                                  ELC50PD
 18594               GO TO 3999-END-EDIT                                ELC50PD
 18595        ELSE                                                      ELC50PD
 18596            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18597               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18598               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18599               GO TO 3785-CHECK-NH.
 18600*              GO TO 3999-END-EDIT.                               ELC50PD
 18601                                                                  ELC50PD
 18602 3780-UPDATE-CONT-1.                                              ELC50PD
 18603     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18604                                                                  ELC50PD
 18605     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18606         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18607                                                                  ELC50PD
 18608     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18609         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18610
 18611     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18612                                                                  ELC50PD
 18613     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18614       AND                                                        ELC50PD
 18615        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18616       AND                                                        ELC50PD
 18617        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18618       AND                                                        ELC50PD
 18619        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18620            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18621       ELSE                                                       ELC50PD
 18622        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18623          AND                                                     ELC50PD
 18624***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18625***       AND                                                     ELC50PD
 18626           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18627           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18628            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18629               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18630               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18631               GO TO 3999-END-EDIT                                ELC50PD
 18632            ELSE                                                  ELC50PD
 18633               GO TO 3999-END-EDIT                                ELC50PD
 18634            END-IF
 18635           ELSE
 18636             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18637                MOVE ER-2890 TO WS-ERROR
 18638                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18639                GO TO 3999-END-EDIT
 18640             ELSE
 18641                GO TO 3785-CHECK-NH
 18642             END-IF
 18643           END-IF
 18644          ELSE                                                    ELC50PD
 18645            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18646              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18647                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18648                   MOVE ER-2890 TO WS-ERROR
 18649                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18650                   GO TO 3999-END-EDIT
 18651                ELSE
 18652                   MOVE ER-2765 TO WS-ERROR
 18653                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18654                   GO TO 3785-CHECK-NH
 18655                END-IF
 18656              ELSE
 18657               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18658               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18659               GO TO 3785-CHECK-NH.
 18660*              GO TO 3999-END-EDIT.                               ELC50PD
 18661                                                                  ELC50PD
 18662 3780-UPDATE-CONT-2.                                              ELC50PD
 18663                                                                  ELC50PD
 18664     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18665        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18666           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18667           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18668                                                                  ELC50PD
 18669     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18670        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18671           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18672           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18673                                                                  ELC50PD
 18674     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18675        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18676        AND                                                       ELC50PD
 18677        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18678         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18679           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18680           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18681                                                                  ELC50PD
 18682     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18683       AND                                                        ELC50PD
 18684        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18685             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18686             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18687                                                                  ELC50PD
 18688     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18689       AND                                                        ELC50PD
 18690        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18691             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18692             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18693                                                                  ELC50PD
 18694     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18695         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18696             OR 'CID' OR 'DCC' OR 'AHL'
 18697             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18698         ELSE                                                     ELC50PD
 18699             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18700                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18701                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18702             ELSE                                                 ELC50PD
 18703                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18705                                                                  ELC50PD
 18706     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18707        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18709
 18710 3785-CHECK-NH.
 18711
 18712     IF PB-STATE NOT = 'NH'
 18713        GO TO 3999-END-EDIT
 18714     END-IF
 18715
 18716     MOVE ER-2796                TO WS-ERROR
 18717     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18718
 18719     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18720        OR (CM-NH-INTERFACE-SW = 'Y')
 18721        MOVE ER-2793             TO WS-ERROR
 18722        PERFORM 9900-ERROR-FORMAT
 18723                                 THRU 9900-EXIT
 18724     END-IF
 18725
 18726     MOVE +0                     TO WS-PAYMENT-AMT
 18727     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18728        GO TO 3999-END-EDIT
 18729     END-IF
 18730
 18731     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18732        GO TO 3999-END-EDIT
 18733     END-IF
 18734
 18735     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18736     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18737
 18738     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18739        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18740     END-IF
 18741     MOVE '1'                    TO DC-OPTION-CODE
 18742     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18743     IF NO-CONVERSION-ERROR
 18744        IF DC-ELAPSED-DAYS < +16
 18745           GO TO 3999-END-EDIT
 18746        END-IF
 18747     END-IF
 18748
 18749     MOVE +0                     TO DC-ELAPSED-DAYS
 18750     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18751     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18752     MOVE '1'                    TO DC-OPTION-CODE
 18753     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18754     IF NO-CONVERSION-ERROR
 18755        IF DC-ELAPSED-DAYS > +30
 18756           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18757        ELSE
 18758           GO TO 3999-END-EDIT
 18759        END-IF
 18760     ELSE
 18761        GO TO 3999-END-EDIT
 18762     END-IF
 18763
 18764     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18765        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18766           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18767
 18768     IF WS-PAYMENT-AMT < 600.00
 18769        GO TO 3999-END-EDIT
 18770     END-IF
 18771
 18772     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18773                                                                  ELC50PD
 18774     IF (ERMAIL-FOUND = ' ')
 18775         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18776         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18777        GO TO 3999-END-EDIT
 18778     END-IF
 18779
 18780     MOVE ER-2795                TO WS-ERROR
 18781     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18782                                                                  ELC50PD
 18783     GO TO 3999-END-EDIT.                                         ELC50PD
 18784******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18786 3990-FILES-NOT-OPEN.                                             ELC50PD
 18787                                                                  ELC50PD
 18788     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18790     GO TO 9990-RETURN.                                           ELC50PD
 18791                                                                  ELC50PD
 18792 3999-END-EDIT.                                                   ELC50PD
 18793
 18794                                                                  ELC50PD
 18795     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18796                                                                  ELC50PD
 18797     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18798         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18799         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18800             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18801             GO TO 9990-RETURN                                    ELC50PD
 18802          ELSE                                                    ELC50PD
 18803             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18804             GO TO 9990-RETURN.                                   ELC50PD
 18805                                                                  ELC50PD
 18806     IF PB-CANCELLATION                                           ELC50PD
 18807          GO TO 9990-RETURN.                                      ELC50PD
 18808                                                                  ELC50PD
 18809     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18810        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18811                                                                  ELC50PD
 18812     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18813                                                                  ELC50PD
 18814     IF CERT-WAS-FOUND                                            ELC50PD
 18815         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18816             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18817          ELSE                                                    ELC50PD
 18818            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18819      ELSE                                                        ELC50PD
 18820         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18821
 18822     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18823        IF PB-COMPANY-ID = 'DCC' AND
 18824           (PB-CARRIER = '2' OR '4' OR '6')
 18825              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18826        END-IF
 18827     END-IF.
 18828
 18829     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 18830         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 18831     END-IF.
 18832                                                                  ELC50PD
 18833     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18834     IF ((PB-COMPANY-ID = 'DCC')
 18835        AND (WS-NO-SECURE-PAY))
 18836                  OR
 18837        (WS-LF-SPECIAL-CALC-CD = 'O'
 18838        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18839        SET SKIP-ADDR-EDIT       TO TRUE
 18840     END-IF
 18841
 18842     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18843        AND (NOT SKIP-ADDR-EDIT)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18844        MOVE ER-2963             TO WS-ERROR
 18845        PERFORM 9900-ERROR-FORMAT
 18846                                 THRU 9900-EXIT
 18847        GO TO 9990-RETURN
 18848     END-IF
 18849
 18850     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 18851
 18852     IF ERPNDM-FOUND NOT = 'X'
 18853        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18854           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 18855           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 18856           AND (NOT SKIP-ADDR-EDIT)
 18857           MOVE ER-2694          TO WS-ERROR
 18858           PERFORM 9900-ERROR-FORMAT
 18859                                 THRU 9900-EXIT
 18860        END-IF
 18861        MOVE ' '                 TO STATE-RECORD-ERROR
 18862        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18863        MOVE PM-STATE            TO CNTL-ACCESS
 18864        MOVE '3'                 TO CNTL-REC-TYPE
 18865        MOVE +0                  TO CNTL-SEQ-NO
 18866        MOVE '0'                 TO RC-SW-2
 18867        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18868        IF (NO-STATE-RECORD)
 18869           OR (CF-RECORD-TYPE NOT = '3')
 18870           OR (PM-STATE NOT = CF-STATE-CODE)
 18871           IF (PM-STATE = SPACES)
 18872              AND (SKIP-ADDR-EDIT)
 18873              CONTINUE
 18874           ELSE
 18875              MOVE ER-2963       TO WS-ERROR
 18876              PERFORM 9900-ERROR-FORMAT
 18877                                 THRU 9900-EXIT
 18878           END-IF
 18879        END-IF
 18880        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18881           MOVE ER-2883          TO WS-ERROR
 18882           PERFORM 9900-ERROR-FORMAT
 18883                                 THRU 9900-EXIT
 18884        END-IF
 18885        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18886           MOVE ' '                 TO STATE-RECORD-ERROR
 18887           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18888           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18889           MOVE '3'                 TO CNTL-REC-TYPE
 18890           MOVE +0                  TO CNTL-SEQ-NO
 18891           MOVE '0'                 TO RC-SW-2
 18892           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18893           IF NO-STATE-RECORD
 18894              OR (CF-RECORD-TYPE NOT = '3')
 18895              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18896              MOVE ER-2964          TO WS-ERROR
 18897              PERFORM 9900-ERROR-FORMAT
 18898                                    THRU 9900-EXIT
 18899           END-IF
 18900        END-IF
 18901     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18902        IF NOT SKIP-ADDR-EDIT
 18903           MOVE ER-2393          TO WS-ERROR
 18904           PERFORM 9900-ERROR-FORMAT
 18905                                 THRU 9900-EXIT
 18906        END-IF
 18907     END-IF
 18908                                                                  ELC50PD
 18909     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18910                                                                  ELC50PD
 18911     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 18912        ERPNDM-FOUND = ' ')                                       ELC50PD
 18913        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 18914           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18915           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18916          OR                                                      ELC50PD
 18917           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 18918          OR                                                      ELC50PD
 18919           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 18920           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 18921           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 18922                                                                  ELC50PD
 18923
 18924     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 18925        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 18926                                                                  ELC50PD
 18927     IF PM-INSURED-LAST-NAME      = SPACES
 18928        AND PM-INSURED-FIRST-NAME = SPACES
 18929        AND PM-ADDRESS-LINE-1     = SPACES
 18930        AND PM-ADDRESS-LINE-2     = SPACES
 18931        AND PM-CITY-STATE         = SPACES
 18932        AND PM-CRED-BENE-NAME     = SPACES
 18933        AND PM-CRED-BENE-ADDR     = SPACES
 18934        AND PM-CRED-BENE-CTYST    = SPACES
 18935        GO TO 3999-UNLOCK-ERMAIL
 18936     END-IF
 18937                                                                  ELC50PD
 18938     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 18939                                                                  ELC50PD
 18940     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 18941     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 18942     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 18943     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 18944     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 18945     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 18946     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18947     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18948                                                                  ELC50PD
 18949     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 18950     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 18951                                                                  ELC50PD
 18952     IF ERMAIL-FOUND = ' '                                        ELC50PD
 18953        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 18954     ELSE                                                         ELC50PD
 18955        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 18956        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 18957        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 18958                                                                  ELC50PD
 18959
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18960     GO TO 9990-RETURN.                                           ELC50PD
 18961                                                                  ELC50PD
 18962 3999-UNLOCK-ERMAIL.                                              ELC50PD
 18963     IF ERMAIL-FOUND = ' '                                        ELC50PD
 18964        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 18965                                                                  ELC50PD
 18966     GO TO 9990-RETURN.                                           ELC50PD
 18967******************************************************************ELC50PD
 18968                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18970 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 18971     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18972        GO TO 4299-EXIT.                                          ELC50PD
 18973                                                                  ELC50PD
 18974*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 18975
 18976     IF PB-C-NH-INT-ON-REFS > ZEROS
 18977        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 18978     END-IF
 18979     IF PB-C-REF-INTERFACE-SW = 'Y'
 18980        MOVE PB-C-REF-INTERFACE-SW
 18981                                 TO CM-NH-INTERFACE-SW
 18982     END-IF
 18983
 18984     IF PB-C-POST-CARD-IND = 'Y'
 18985        MOVE +8                  TO SUB
 18986        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18987        IF ERMAIL-FOUND = ' '
 18988           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18989              (SUB > +7)
 18990              OR (MA-MAIL-STATUS (SUB) = '1')
 18991           END-PERFORM
 18992        END-IF
 18993        IF (SUB > +7)
 18994           OR (ERMAIL-FOUND = 'X')
 18995           MOVE ER-3789          TO WS-ERROR
 18996           PERFORM 9900-ERROR-FORMAT
 18997                                 THRU 9900-EXIT
 18998        END-IF
 18999     ELSE
 19000        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19001     END-IF
 19002
 19003     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19004                                                                  ELC50PD
 19005     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19006        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19007                                                                  ELC50PD
 19008     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19009         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19010     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19011         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19012                                                                  ELC50PD
 19013 4100-APPLY-LF-CANCEL.                                            ELC50PD
 19014                                                                  ELC50PD
 19015     MOVE +0                     TO WS-SUB.                       ELC50PD
 19016                                                                  ELC50PD
 19017 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19018                                                                  ELC50PD
 19019     ADD +1                       TO WS-SUB.                      ELC50PD
 19020                                                                  ELC50PD
 19021     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19022        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19023           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19024        ELSE                                                      ELC50PD
 19025           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19026                                                                  ELC50PD
 19027     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19028                                   ER-2729 OR                     ELC50PD
 19029                                   ER-2730 OR                     ELC50PD
 19030                                   ER-2731 OR                     ELC50PD
 19031                                   ER-2732 OR                     ELC50PD
 19032                                   ER-2737 OR                     ELC50PD
 19033                                   ER-2740 OR                     ELC50PD
 19034                                   ER-2743 OR                     ELC50PD
 19035                                   ER-2749 OR                     ELC50PD
 19036                                   ER-2750 OR                     ELC50PD
 19037                                   ER-2755 OR                     ELC50PD
 19038                                   ER-2757 OR                     ELC50PD
 19039                                   ER-2760 OR                     ELC50PD
 19040                                   ER-2772 OR                     ELC50PD
 19041                                   ER-2774 OR                     ELC50PD
 19042                                   ER-2776 OR                     ELC50PD
 19043                                   ER-2794                        ELC50PD
 19044        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19045                                                                  ELC50PD
 19046     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19047                                                                  ELC50PD
 19048 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19049                                                                  ELC50PD
 19050     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19051     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19052     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19053        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19054     END-IF
 19055     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19056                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19057     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19058         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19059                                                                  ELC50PD
 19060     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19061         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19062                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19063                                                                  ELC50PD
 19064     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19065                                                                  ELC50PD
 19066 4100-LF-CANCEL-CONT.                                             ELC50PD
 19067     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19068         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19069                                                                  ELC50PD
 19070     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19071         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19072                                                                  ELC50PD
 19073     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19074        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19075           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19076        ELSE                                                      ELC50PD
 19077           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19078                                                                  ELC50PD
 19079     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19080     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19081                                                                  ELC50PD
 19082     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19083         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19084                                                                  ELC50PD
 19085     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19086        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19087         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19088         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19089                                                                  ELC50PD
 19090     IF PB-RECORD-RETURNED                                        ELC50PD
 19091        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19092      ELSE                                                        ELC50PD
 19093        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19094                                                                  ELC50PD
 19095 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19096                                                                  ELC50PD
 19097     MOVE +0                      TO WS-SUB.                      ELC50PD
 19098                                                                  ELC50PD
 19099 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19100                                                                  ELC50PD
 19101     ADD +1                       TO WS-SUB.                      ELC50PD
 19102                                                                  ELC50PD
 19103     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19104        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19105           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19106        ELSE                                                      ELC50PD
 19107           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19108                                                                  ELC50PD
 19109     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19110                                   ER-2729 OR                     ELC50PD
 19111                                   ER-2732 OR                     ELC50PD
 19112                                   ER-2737 OR                     ELC50PD
 19113                                   ER-2740 OR                     ELC50PD
 19114                                   ER-2744 OR                     ELC50PD
 19115                                   ER-2749 OR                     ELC50PD
 19116                                   ER-2750 OR                     ELC50PD
 19117                                   ER-2755 OR                     ELC50PD
 19118                                   ER-2757 OR                     ELC50PD
 19119                                   ER-2760 OR                     ELC50PD
 19120                                   ER-2771 OR                     ELC50PD
 19121                                   ER-2772 OR                     ELC50PD
 19122                                   ER-2773 OR                     ELC50PD
 19123                                   ER-2775 OR                     ELC50PD
 19124                                   ER-2777 OR                     ELC50PD
 19125                                   ER-2794                        ELC50PD
 19126        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19127                                                                  ELC50PD
 19128     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19129                                                                  ELC50PD
 19130 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19131                                                                  ELC50PD
 19132     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19133     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19134     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19135     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19136                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19137     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19138         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19139                                                                  ELC50PD
 19140     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19141         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19142                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19143                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19144     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19145         IF PB-RECORD-RETURNED                                    ELC50PD
 19146              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19147          ELSE                                                    ELC50PD
 19148              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19149                                                                  ELC50PD
 19150     GO TO 4299-EXIT.                                             ELC50PD
 19151                                                                  ELC50PD
 19152 4100-AH-CANCEL-CONT.                                             ELC50PD
 19153     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19154         GO TO 4299-EXIT.                                         ELC50PD
 19155                                                                  ELC50PD
 19156     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19157         GO TO 4299-EXIT.                                         ELC50PD
 19158                                                                  ELC50PD
 19159     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19160        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19161           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19162        ELSE                                                      ELC50PD
 19163           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19164                                                                  ELC50PD
 19165     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19166     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19167                                                                  ELC50PD
 19168     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19169         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19170                                                                  ELC50PD
 19171     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19172         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19173         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19174                                                                  ELC50PD
 19175     IF PB-RECORD-RETURNED                                        ELC50PD
 19176        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19177      ELSE                                                        ELC50PD
 19178        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19179                                                                  ELC50PD
 19180     GO TO 4299-EXIT.                                             ELC50PD
 19181                                                                  ELC50PD
 19182 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19183     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19184                                                                  ELC50PD
 19185     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19186        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19187                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19188     ELSE                                                         ELC50PD
 19189        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19190                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19191                                                                  ELC50PD
 19192     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19193        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19194                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19195     ELSE                                                         ELC50PD
 19196        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19197                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19198                                                                  ELC50PD
 19199     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19200        NEXT SENTENCE                                             ELC50PD
 19201     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19202        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19203                                                                  ELC50PD
 19204     GO TO 4299-EXIT.                                             ELC50PD
 19205                                                                  ELC50PD
 19206 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19207     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19208                                                                  ELC50PD
 19209     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19210        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19211        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19212        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19213                                                                  ELC50PD
 19214     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19215                                                                  ELC50PD
 19216     IF PB-RECORD-RETURNED                                        ELC50PD
 19217        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19218       ELSE                                                       ELC50PD
 19219        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19220                                                                  ELC50PD
 19221 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19222       EXIT.                                                      ELC50PD
 19223                                                                  ELC50PD
 19224 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19225     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19226                                                                  ELC50PD
 19227     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19228        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19229        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19230        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19231                                                                  ELC50PD
 19232     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19233                                                                  ELC50PD
 19234     IF PB-RECORD-RETURNED                                        ELC50PD
 19235        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19236       ELSE                                                       ELC50PD
 19237        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19238                                                                  ELC50PD
 19239 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19240       EXIT.                                                      ELC50PD
 19241                                                                  ELC50PD
 19242 4299-EXIT.                                                       ELC50PD
 19243       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19245                                                                  ELC50PD
 19246 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19247     IF CERT-WAS-FOUND                                            ELC50PD
 19248         NEXT SENTENCE                                            ELC50PD
 19249       ELSE                                                       ELC50PD
 19250         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19251                                                                  ELC50PD
 19252     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19253         GO TO 4999-EXIT.                                         ELC50PD
 19254                                                                  ELC50PD
 19255     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19256         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19257                                                                  ELC50PD
 19258     IF CERT-ADDED-BATCH                                          ELC50PD
 19259        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19260            GO TO 4999-EXIT.                                      ELC50PD
 19261                                                                  ELC50PD
 19262 4520-BUILD-NEW-KEY.                                              ELC50PD
 19263* BUILD CONTROL PRIMARY                                           ELC50PD
 19264                                                                  ELC50PD
 19265     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19266                                       CM-COMPANY-CD-A1           ELC50PD
 19267                                       CM-COMPANY-CD-A2           ELC50PD
 19268                                       CM-COMPANY-CD-A4           ELC50PD
 19269                                       CM-COMPANY-CD-A5.          ELC50PD
 19270                                                                  ELC50PD
 19271     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19272     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19273     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19274     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19275     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19276     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19277     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19278                                                                  ELC50PD
 19279     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19280                                                                  ELC50PD
 19281     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19282     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19283     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19284     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19285                                                                  ELC50PD
 19286     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19287        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19288                                                                  ELC50PD
 19289     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19290         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19291         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19292         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19293         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19294     ELSE                                                         ELC50PD
 19295         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19296                                                                  ELC50PD
 19297     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19298         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19299         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19300         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19301         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19302         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19303                                                                  ELC50PD
 19304     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19305        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19306         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19307                                                                  ELC50PD
 19308     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19309        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19310            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19311                                           PB-I-MEMBER-NO         ELC50PD
 19312            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19313                                                                  ELC50PD
 19314     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19315        NEXT SENTENCE                                             ELC50PD
 19316     ELSE                                                         ELC50PD
 19317        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19318                                                                  ELC50PD
 19319******************************************************************ELC50PD
 19320*                                                                *ELC50PD
 19321*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19322*    FOR 'MON'.                                                  *ELC50PD
 19323*                                                                *ELC50PD
 19324******************************************************************ELC50PD
 19325                                                                  ELC50PD
 19326     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19327     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19328     MOVE +1                     TO WS-SUB1                       ELC50PD
 19329                                    WS-SUB2.                      ELC50PD
 19330                                                                  ELC50PD
 19331 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19332                                                                  ELC50PD
 19333     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19334        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19335        ADD +1                       TO WS-SUB2.                  ELC50PD
 19336                                                                  ELC50PD
 19337     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19338        ADD +1                       TO WS-SUB1                   ELC50PD
 19339        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19340                                                                  ELC50PD
 19341     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19342     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19343     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19344*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19345     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19346     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19347     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19348                                                                  ELC50PD
 19349     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19350                                                                  ELC50PD
 19351******************************************************************ELC50PD
 19352*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19353******************************************************************ELC50PD
 19354                                                                  ELC50PD
 19355 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19356                                                                  ELC50PD
 19357     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19358         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19359         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19360         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19361         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19362     ELSE                                                         ELC50PD
 19363         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19364                                                                  ELC50PD
 19365     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19366        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19367         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19368                                                                  ELC50PD
 19369 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19370                                                                  ELC50PD
 19371*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19372*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19373*    ELSE                                                         ELC50PD
 19374*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19375                                                                  ELC50PD
 19376     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19377        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19378        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19379                                                                  ELC50PD
 19380     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19381        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19382        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19383                                                                  ELC50PD
 19384     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19385     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19386                                                                  ELC50PD
 19387     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19388        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19389        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19390     ELSE                                                         ELC50PD
 19391        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19392        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19393                                                                  ELC50PD
 19394     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19395     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19396     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19397     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19398     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19399     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19400     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19401                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19402                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19403                                      CM-AH-ITD-AH-PMT            ELC50PD
 19404                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19405                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19406                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19407                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19408*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19409*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19410     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.                ELC50PD
 19411     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19412     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19413     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19414     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
 19415     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19416     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19417     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19418     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19419     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19420     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19421     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19422                                                                  ELC50PD
 19423     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19424         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19425                                                                  ELC50PD
 19426     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19427         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19428                                                                  ELC50PD
 19429     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19430     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19431                                                                  ELC50PD
 19432     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19433         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19434         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19435                                                                  ELC50PD
 19436     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19437     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19438     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19439     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19440     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19441     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19442                                                                  ELC50PD
 19443     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19444        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19445     ELSE                                                         ELC50PD
 19446        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19447                                                                  ELC50PD
 19448     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19449        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19450        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19451     ELSE                                                         ELC50PD
 19452        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19453                                                                  ELC50PD
 19454     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19455     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19456     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19457     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19458     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19459     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19460     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19461     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19462     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19463                                                                  ELC50PD
 19464     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19465        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19466     ELSE                                                         ELC50PD
 19467        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19468                                                                  ELC50PD
 19469     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19470        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19471     ELSE                                                         ELC50PD
 19472        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
 19473                                                                  ELC50PD
 19474     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19475     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19476                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19477     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19478                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19479                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19480                                                                  ELC50PD
 19481*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19482*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19483*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19484*                       'NCL'                                     ELC50PD
 19485     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19486                                                                  ELC50PD
 19487     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19488         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19489            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19490                                                                  ELC50PD
 19491     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19492         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19493            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19494                                                                  ELC50PD
 19495     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19496         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19497     ELSE                                                         ELC50PD
 19498         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19499         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19500                                                                  ELC50PD
 19501     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19502     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19503     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19504     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19505     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19506     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19507     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19508     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19509                                                                  ELC50PD
 19510     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19511         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19512     ELSE                                                         ELC50PD
 19513         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19514                                                                  ELC50PD
 19515     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19516     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19517                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19518                                                                  ELC50PD
 19519     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19520     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19521                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19522                                                                  ELC50PD
 19523     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19524                                                                  ELC50PD
 19525     IF PB-REISSUED-CERT                                          ELC50PD
 19526        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19527                                                                  ELC50PD
 19528     IF PB-MONTHLY-CERT                                           ELC50PD
 19529        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19530                                                                  ELC50PD
 19531     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19532     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19533     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19534        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19535                                                                  ELC50PD
 19536     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19537        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19538                                                                  ELC50PD
 19539     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19540        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19541                                                                  ELC50PD
 19542     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19543        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19544                                                                  ELC50PD
 19545     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19546         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19547     ELSE                                                         ELC50PD
 19548         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19549                                                                  ELC50PD
 19550     IF PB-RECORD-RETURNED                                        ELC50PD
 19551        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19552      ELSE                                                        ELC50PD
 19553        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19554                                                                  ELC50PD
 19555     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19556        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19557                                                                  ELC50PD
 19558     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19559                                       CM-ENTRY-DT.               ELC50PD
 19560                                                                  ELC50PD
 19561 4999-EXIT.                                                       ELC50PD
 19562     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19564                                                                  ELC50PD
 19565 5000-PROCESS-REPS.
 19566
 19567     MOVE ' '                    TO AGTC-MASTER-SW
 19568     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19569     MOVE CO-TYPE                TO AGTC-TYPE
 19570     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19571     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19572
 19573     IF (AGTC-MASTER-SW NOT = 'N')
 19574        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19575        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19576        PERFORM 8583-READ-ERAGTC-NEXT
 19577                                 THRU 8583-EXIT
 19578     END-IF
 19579
 19580     IF AGTC-MASTER-SW = 'N'
 19581        CONTINUE
 19582     ELSE
 19583        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19584           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19585              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19586              MOVE 'Y'           TO AGTC-MASTER-SW
 19587           END-IF
 19588        END-IF
 19589     END-IF
 19590
 19591     .
 19592 5000-EXIT.
 19593     EXIT.
 19594
 19595
 19596 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19597     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19598        MOVE +1                  TO SUB                           ELC50PD
 19599        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19600        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19601        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19602        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19603        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19604                                                                  ELC50PD
 19605     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19606                                                                  ELC50PD
 19607     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19608     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19609*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19610     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19611     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19612     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19613     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19614                                                                  ELC50PD
 19615     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19616        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19617        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19618                                                                  ELC50PD
 19619     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19620     MOVE +1                     TO SUB.                          ELC50PD
 19621                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19622 6370-SEARCH-LOOP.                                                ELC50PD
 19623     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19624         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19625                                                                  ELC50PD
 19626     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19627         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD        ELC50PD
 19628         GO TO 6370-HER-NET-PAY-CHECK.                            ELC50PD
 19629                                                                  ELC50PD
 19630     ADD 1   TO SUB.                                              ELC50PD
 19631*    IF SUB GREATER 120                                           ELC50PD
 19632     IF SUB GREATER 200                                           ELC50PD
 19633         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19634                                                                  ELC50PD
 19635     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19636                                                                  ELC50PD
 19637 6370-NO-LF-FOUND.                                                ELC50PD
 19638                                                                  ELC50PD
 19639     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19640                                                                  ELC50PD
 19641 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19642                                                                  ELC50PD
 19643     IF PB-COMPANY-ID = 'CID'
 19644        IF PB-SV-STATE = 'CA' OR 'MN'
 19645           IF PB-I-LF-BENEFIT-CD = '02'
 19646              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19647           ELSE
 19648              IF PB-I-LF-BENEFIT-CD = '04'
 19649                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19650              END-IF
 19651           END-IF
 19652        END-IF
 19653     END-IF
 19654
 19655     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19656         GO TO 6370-EXIT.                                         ELC50PD
 19657                                                                  ELC50PD
 19658     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19659         GO TO 6370-EXIT.                                         ELC50PD
 19660                                                                  ELC50PD
 19661     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19662         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19663                                                                  ELC50PD
 19664     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19665         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19666                                                                  ELC50PD
 19667     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19668         GO TO 6370-EXIT.                                         ELC50PD
 19669                                                                  ELC50PD
 19670     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
 19671         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19672                                                                  ELC50PD
 19673     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19674         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19675                                                                  ELC50PD
 19676 6370-EXIT.                                                       ELC50PD
 19677     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19679                                                                  ELC50PD
 19680 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19681     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19682        MOVE +1                  TO SUB                           ELC50PD
 19683        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19684        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19685        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19686        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19687        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19688                                                                  ELC50PD
 19689     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19690                                                                  ELC50PD
 19691     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19692     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19693     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19694*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19695     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19696     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19697     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19698                                                                  ELC50PD
 19699     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19700        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19701        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19702                                                                  ELC50PD
 19703     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19704     MOVE +1 TO SUB.                                              ELC50PD
 19705                                                                  ELC50PD
 19706 6380-SEARCH-LOOP.                                                ELC50PD
 19707     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19708         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19709                                                                  ELC50PD
 19710     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19711         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19712         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19713                                                                  ELC50PD
 19714     ADD 1   TO SUB.                                              ELC50PD
 19715     IF SUB GREATER THAN 96                                       ELC50PD
 19716*    IF SUB GREATER THAN 300                                      ELC50PD
 19717         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19718                                                                  ELC50PD
 19719     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19720                                                                  ELC50PD
 19721 6380-NO-AH-FOUND.                                                ELC50PD
 19722                                                                  ELC50PD
 19723     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19724                                                                  ELC50PD
 19725     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19726         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19727     ELSE                                                         ELC50PD
 19728         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19729                                                                  ELC50PD
 19730 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19731                                                                  ELC50PD
 19732     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19733        NEXT SENTENCE                                             ELC50PD
 19734      ELSE                                                        ELC50PD
 19735        GO TO 6380-EXIT.                                          ELC50PD
 19736                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19737     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19738         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19739                                                                  ELC50PD
 19740                                                                  00041198
 19741     GO TO 6380-EXIT                                              00041198
 19742     .
 19743 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19744                                                                  00041203
 19745                                                                  ELC50PD
 19746     .                                                            ELC50PD
 19747 6380-EXIT.                                                       ELC50PD
 19748     EXIT.                                                        ELC50PD
 19749                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19751                                                                  ELC50PD
 19752 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19753                                                                  ELC50PD
 19754******************************************************************ELC50PD
 19755*                                                                *ELC50PD
 19756*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19757*                                                                *ELC50PD
 19758*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19759*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19760*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19761*    THE EXTENSION DAYS.                                         *ELC50PD
 19762*                                                                *ELC50PD
 19763******************************************************************ELC50PD
 19764                                                                  ELC50PD
 19765     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19766     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19767                                                                  ELC50PD
 19768******************************************************************ELC50PD
 19769*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19770*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19771******************************************************************ELC50PD
 19772                                                                  ELC50PD
 19773     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19774        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19775               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19776     ELSE                                                         ELC50PD
 19777        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19778                                                                  ELC50PD
 19779     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 19780           GO TO 6499-EXIT                                        ELC50PD
 19781     ELSE                                                         ELC50PD
 19782        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 19783           IF WS-WDF-MONTH = 02                                   ELC50PD
 19784              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 19785              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 19786              GO TO 6499-EXIT                                     ELC50PD
 19787           ELSE                                                   ELC50PD
 19788              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 19789                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 19790                 GO TO 6499-EXIT                                  ELC50PD
 19791               ELSE                                               ELC50PD
 19792                 GO TO 6499-EXIT                                  ELC50PD
 19793        ELSE                                                      ELC50PD
 19794           GO TO 6499-EXIT.                                       ELC50PD
 19795                                                                  ELC50PD
 19796 6412-CHECK-TO-DAY.                                               ELC50PD
 19797                                                                  ELC50PD
 19798        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 19799           IF WS-WDT-DAY = 28                                     ELC50PD
 19800              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 19801           ELSE                                                   ELC50PD
 19802              IF WS-WDT-DAY = 29                                  ELC50PD
 19803                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 19804              ELSE                                                ELC50PD
 19805                 NEXT SENTENCE                                    ELC50PD
 19806        ELSE                                                      ELC50PD
 19807           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 19808              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19809                                                                  ELC50PD
 19810     GO TO 6499-EXIT.                                             ELC50PD
 19811                                                                  ELC50PD
 19812                                                                  ELC50PD
 19813 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 19814                                                                  ELC50PD
 19815     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 19816        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 19817                                                                  ELC50PD
 19818 6415-EXIT.                                                       ELC50PD
 19819     EXIT.                                                        ELC50PD
 19820                                                                  ELC50PD
 19821 6499-EXIT.                                                       ELC50PD
 19822      EXIT.                                                       ELC50PD
 19823                                                                  ELC50PD
 19824 6500-END.                                                        ELC50PD
 19825     EXIT.
 19826
 19827                                                                  ELC50PD
 19828******************************************************************ELC50PD
 19829************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 19830********************** ELC50PD END *******************************ELC50PD
 19831                                                                  ELC50PD
 19832*
 19833*
 19834**START***********************************************************
 19835*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 19836*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 19837******************************************************************
 19838*
 19839 6600-GET-STATE-MUNICIPAL-TAX.
 19840
 19841     IF PB-COMPANY-ID NOT = 'DMD'
 19842         GO TO 6640-EXIT.
 19843
 19844     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19845     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19846     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19847
 19848*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19849     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19850     MOVE SPACES TO DC-ALPHA-CENTURY.
 19851     SET BIN-TO-GREG          TO TRUE.
 19852     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19853
 19854     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 19855     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 19856
 19857     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19858     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 19859                                 WS-SAVE-ERRESS-KEY.
 19860
 19861*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 19862*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 19863
 19864     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 19865
 19866     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 360
* EL517.cbl
 19867         MOVE ER-8002        TO WS-ERROR
 19868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19869         GO TO 6640-EXIT.
 19870
 19871*GET RECORD WHERE POSITIONED
 19872
 19873 6600-READ-ERRESS-NEXT.
 19874     READ ERRESS NEXT RECORD.
 19875
 19876     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 19877         MOVE ER-8002        TO WS-ERROR
 19878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19879         GO TO 6640-EXIT.
 19880
 19881*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 19882
 19883     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 19884        NEXT SENTENCE
 19885     ELSE
 19886        MOVE ER-8002        TO WS-ERROR
 19887        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19888        GO TO 6640-EXIT.
 19889
 19890     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 19891        NEXT SENTENCE
 19892     ELSE
 19893        GO TO 6600-READ-ERRESS-NEXT.
 19894
 19895*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19896*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 19897
 19898     MOVE +2                     TO WS-SUB1.
 19899
 19900     IF PB-CANCELLATION
 19901        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19902           MOVE +1               TO WS-SUB1.
 19903
 19904     IF PB-ISSUE
 19905        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19906           MOVE +1               TO WS-SUB1.
 19907
 19908*
 19909*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19910*
 19911     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 19912     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 19913     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 19914     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 19915
 19916
 19917*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19918*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19919*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 19920
 19921     ADD 1                    TO WS-YEAR-YY.
 19922
 19923     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19924         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 361
* EL517.cbl
 19925                              TO WS-RES-STATE-TAX
 19926         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 19927                              TO WS-RES-MUNI-TAX
 19928     ELSE
 19929         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19930                              TO WS-RES-STATE-TAX
 19931         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19932                              TO WS-RES-MUNI-TAX.
 19933
 19934*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19935
 19936     IF PB-CANCELLATION
 19937         GO TO 6640-CANCEL-TAX.
 19938
 19939     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19940          COMPUTE PB-I-STATE-TAX ROUNDED =
 19941                                    PB-I-LF-PREMIUM-AMT
 19942                                  * WS-RES-STATE-TAX
 19943          COMPUTE PB-I-MUNI-TAX ROUNDED =
 19944                                    PB-I-LF-PREMIUM-AMT
 19945                                  * WS-RES-MUNI-TAX
 19946     ELSE
 19947     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19948          COMPUTE PB-I-STATE-TAX ROUNDED =
 19949                                    PB-I-AH-PREMIUM-AMT
 19950                                  * WS-RES-STATE-TAX
 19951          COMPUTE PB-I-MUNI-TAX ROUNDED =
 19952                                    PB-I-AH-PREMIUM-AMT
 19953                                  * WS-RES-MUNI-TAX.
 19954
 19955     GO TO 6640-EXIT.
 19956
 19957 6640-CANCEL-TAX.
 19958     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19959
 19960     IF PB-C-LF-CANCEL-AMT > ZEROS
 19961          COMPUTE PB-CI-STATE-TAX ROUNDED =
 19962                                    PB-C-LF-CANCEL-AMT
 19963                                  * WS-RES-STATE-TAX
 19964          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19965                                    PB-C-LF-CANCEL-AMT
 19966                                  * WS-RES-MUNI-TAX
 19967     ELSE
 19968     IF PB-C-AH-CANCEL-AMT > ZEROS
 19969          COMPUTE PB-CI-STATE-TAX ROUNDED =
 19970                                    PB-C-AH-CANCEL-AMT
 19971                                  * WS-RES-STATE-TAX
 19972          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19973                                    PB-C-AH-CANCEL-AMT
 19974                                  * WS-RES-MUNI-TAX.
 19975
 19976 6640-EXIT.
 19977     EXIT.
 19978
 19979 6650-GET-RES-STATE-COMM.
 19980
 19981     IF PB-COMPANY-ID NOT = 'DMD'
 19982         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 362
* EL517.cbl
 19983
 19984     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19985     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19986     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19987     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19988     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19989     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19990     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19991
 19992*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19993
 19994     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19995     MOVE SPACES              TO DC-ALPHA-CENTURY.
 19996     SET BIN-TO-GREG          TO TRUE.
 19997     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19998
 19999     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20000     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20001
 20002     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20003
 20004*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20005*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20006*VALUE OF PB-CERT-EFF-DT
 20007
 20008     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20009     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20010
 20011     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20012         GO TO 6700-COMM-EXIT.
 20013
 20014*GET RECORD WHERE POSITIONED
 20015
 20016 6650-READ-ERRESC-NEXT.
 20017     READ ERRESC NEXT RECORD.
 20018
 20019     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20020         GO TO 6700-COMM-EXIT.
 20021
 20022     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20023        NEXT SENTENCE
 20024     ELSE
 20025         GO TO 6700-COMM-EXIT.
 20026
 20027     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20028         NEXT SENTENCE
 20029       ELSE
 20030         GO TO 6650-READ-ERRESC-NEXT.
 20031
 20032*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20033*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20034
 20035     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20036         GO TO 6700-COMM-EXIT.
 20037
 20038* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20039
 20040     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 363
* EL517.cbl
 20041
 20042     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20043
 20044     IF WS-SUB1 > ZERO
 20045         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20046             PERFORM 6680-SET-COMMISSION
 20047         ELSE
 20048             PERFORM 6680-SET-TABLE-CODE.
 20049
 20050     GO TO 6700-COMM-EXIT.
 20051
 20052 6680-SET-TABLE-CODE.
 20053     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20054        MOVE ZEROS             TO WS-SUB1
 20055     ELSE
 20056* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20057* TO COMPUTE AH COMMISSION.
 20058        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20059        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20060        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20061        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20062        PERFORM 6680-READ-CTBL-TABLE
 20063        IF ERCTBL-FILE-STATUS NOT = '00'
 20064           MOVE ZEROS          TO WS-SUB1.
 20065
 20066 6680-READ-CTBL-TABLE.
 20067*
 20068* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20069* TO COMPUTE LIFE COMMISSION
 20070
 20071     IF CTBL-SW = '0540'
 20072        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20073        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20074        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20075
 20076     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20077
 20078     IF CTBL-TABLE-FOUND
 20079        IF CTBL-SW = '0530'
 20080             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20081                                        PB-I-AH-TERM
 20082             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20083             MOVE WS-WK-RATE        TO WS-COMMISSION
 20084                                       PB-I-AH-COMMISSION
 20085        ELSE
 20086             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20087             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20088             MOVE WS-WK-RATE        TO WS-COMMISSION
 20089                                       PB-I-LIFE-COMMISSION
 20090     ELSE
 20091        IF FIRST-TIME-THROUGH
 20092            GO TO 6680-READ-CTBL-TABLE
 20093        ELSE
 20094            MOVE ZEROS         TO WS-SUB1.
 20095
 20096 6680-SET-COMMISSION.
 20097     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20098           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 364
* EL517.cbl
 20099       ELSE
 20100           MOVE RESC-COMMISSION-PER (WS-SUB)
 20101                             TO WS-COMMISSION
 20102           IF CTBL-SW = '0540'
 20103               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20104           ELSE
 20105               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20106
 20107 6680-SEARCH-CATEGORY.
 20108     ADD +1                   TO WS-SUB.
 20109     IF WS-SUB > +12
 20110         GO TO 6680-EXIT.
 20111
 20112     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20113          MOVE WS-SUB         TO WS-SUB1
 20114          GO TO 6680-EXIT.
 20115
 20116     GO TO 6680-SEARCH-CATEGORY.
 20117
 20118 6680-EXIT.
 20119     EXIT.
 20120
 20121 6700-COMM-EXIT.
 20122     EXIT.
 20123**END*************************************************************
 20124*      CUSTOM CODING FOR CLIENT "DMD"
 20125******************************************************************
 20126*
 20127 7000-GET-RATE.
 20128     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20129
 20130 7000-EXIT.
 20131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 365
* EL517.cbl
 20133
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 366
* EL517.cbl
 20135 7100-FIND-BENEFIT-IN-STATE.
 20136     MOVE 'N'                    TO BEN-SEARCH-SW.
 20137
 20138     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20139         VARYING SUB3 FROM 1 BY 1 UNTIL
 20140            ((SUB3 GREATER 50) OR
 20141              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20142               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20143
 20144     IF SUB3 NOT = 51
 20145         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20146             MOVE 'Y'            TO BEN-SEARCH-SW.
 20147
 20148     GO TO 7199-EXIT.
 20149
 20150 7100-BENEFIT-DUMMY.
 20151
 20152 7100-DUMMY-EXIT.
 20153     EXIT.
 20154
 20155 7199-EXIT.
 20156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 367
* EL517.cbl
 20158 7200-FIND-BENEFIT.
 20159     MOVE 'N'                    TO BEN-SEARCH-SW.
 20160
 20161     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20162         VARYING SUB3 FROM 1 BY 1 UNTIL
 20163            ((SUB3 GREATER 8) OR
 20164            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20165
 20166     IF SUB3 NOT = 9
 20167         MOVE 'Y'                TO BEN-SEARCH-SW.
 20168
 20169     GO TO 7200-EXIT.
 20170
 20171 7200-BENEFIT-DUMMY.
 20172
 20173     EXIT.
 20174 7200-DUMMY-EXIT.
 20175     EXIT.
 20176
 20177 7200-EXIT.
 20178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 368
* EL517.cbl
 20180 7250-LOOK-FOR-RESCINDED-CLAIM.
 20181
 20182     IF ELMSTR-OPEN = ' '
 20183         OPEN INPUT ELMSTR
 20184         MOVE 'X'                TO ELMSTR-OPEN
 20185         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20186             NEXT SENTENCE
 20187         ELSE
 20188             MOVE ELMSTR-FILE-STATUS
 20189                                 TO WS-ABEND-FILE-STATUS
 20190             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20191             MOVE EMSG           TO WS-ABEND-MESSAGE
 20192             GO TO ABEND-PGM.
 20193
 20194     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20195                                    W-CL-COMP-CD.
 20196     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20197                                    W-CL-CERT-NO.
 20198     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20199
 20200     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20201
 20202     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20203         GO TO 7250-EXIT.
 20204
 20205     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20206         GO TO 7250-CLAIMS-ERROR.
 20207
 20208 7250-NEXT-CLAIM.
 20209
 20210     READ ELMSTR NEXT.
 20211
 20212     IF ELMSTR-FILE-STATUS = '10'
 20213         GO TO 7250-EXIT.
 20214
 20215     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20216         GO TO 7250-CLAIMS-ERROR.
 20217
 20218     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20219        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20220         GO TO 7250-EXIT.
 20221
 20222     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20223        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20224        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20225        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20226        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20227         GO TO 7250-NEXT-CLAIM.
 20228
 20229     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20230        OR (CL-CLAIM-TYPE = 'I')
 20231        OR (CL-CLAIM-TYPE = 'G')
 20232          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20233              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20234              GO TO 7250-EXIT
 20235          END-IF
 20236     END-IF.
 20237
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 369
* EL517.cbl
 20238     GO TO 7250-NEXT-CLAIM.
 20239
 20240 7250-CLAIMS-ERROR.
 20241
 20242     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20243     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20244     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20245     GO TO ABEND-PGM.
 20246
 20247 7250-EXIT.
 20248     EXIT.
 20249 7300-CHECK-FOR-OPEN-CLMS.
 20250
 20251     IF ELMSTR-OPEN = ' '
 20252         OPEN INPUT ELMSTR
 20253         MOVE 'X'                TO ELMSTR-OPEN
 20254         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20255             NEXT SENTENCE
 20256         ELSE
 20257             MOVE ELMSTR-FILE-STATUS
 20258                                 TO WS-ABEND-FILE-STATUS
 20259             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20260             MOVE EMSG           TO WS-ABEND-MESSAGE
 20261             GO TO ABEND-PGM.
 20262
 20263     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20264                                    W-CL-COMP-CD.
 20265     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20266                                    W-CL-CERT-NO.
 20267     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20268
 20269     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20270
 20271     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20272         GO TO 7300-EXIT.
 20273
 20274     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20275         GO TO 7300-CLAIMS-ERROR.
 20276
 20277     MOVE 'Y'                    TO W-BROWSE-SW.
 20278
 20279 7300-NEXT-CLAIM.
 20280
 20281     READ ELMSTR NEXT.
 20282
 20283     IF ELMSTR-FILE-STATUS = '10'
 20284         GO TO 7300-EXIT.
 20285
 20286     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20287         GO TO 7300-CLAIMS-ERROR.
 20288
 20289     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20290        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20291         GO TO 7300-EXIT.
 20292
 20293     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20294        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20295        PB-SV-STATE    NOT = CL-CERT-STATE    OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 370
* EL517.cbl
 20296        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20297        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20298         GO TO 7300-NEXT-CLAIM.
 20299
 20300     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20301        OR 'I' OR 'G'
 20302        IF CLAIM-IS-OPEN
 20303           EVALUATE TRUE
 20304             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20305                 MOVE ER-2884      TO WS-ERROR
 20306             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20307                 MOVE ER-2887      TO WS-ERROR
 20308             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20309                 MOVE ER-2886      TO WS-ERROR
 20310             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20311                 MOVE ER-2888      TO WS-ERROR
 20312             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20313                 MOVE ER-2885      TO WS-ERROR
 20314             WHEN OTHER
 20315                 MOVE ER-2768      TO WS-ERROR
 20316           END-EVALUATE
 20317           IF PB-C-AH-CANCEL-VOIDED OR
 20318              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20319                NOT AH-COVERAGE-CANCELLED)
 20320               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20321               MOVE ER-2768      TO WS-ERROR
 20322           END-IF
 20323           PERFORM 9900-ERROR-FORMAT
 20324                                 THRU 9900-EXIT
 20325           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20326              PB-FORCE-CODE NOT EQUAL '8'
 20327               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20328           END-IF
 20329           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20330           GO TO 7300-EXIT
 20331        ELSE
 20332           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20333*****THIS IS A RESCISSION OR REFORMATION
 20334              IF (AH-COVERAGE-CANCELLED AND
 20335                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20336                    MOVE ER-2890 TO WS-ERROR
 20337                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20338                    GO TO 7300-EXIT
 20339              END-IF
 20340           ELSE
 20341              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20342               AND PB-C-AH-CANCEL-DT > SPACES
 20343                 MOVE ER-2756       TO WS-ERROR
 20344                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20345                 GO TO 7300-EXIT
 20346              END-IF
 20347           END-IF
 20348        END-IF
 20349     ELSE
 20350        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20351           IF CLAIM-IS-OPEN
 20352              MOVE ER-2889    TO WS-ERROR
 20353              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 371
* EL517.cbl
 20354              GO TO 7300-EXIT
 20355           ELSE
 20356              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20357*****THIS IS A RESCISSION OR REFORMATION
 20358                 IF (LF-COVERAGE-CANCELLED AND
 20359                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20360                       MOVE ER-2890 TO WS-ERROR
 20361                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20362                       GO TO 7300-EXIT
 20363                 END-IF
 20364              ELSE
 20365                 IF (AH-COVERAGE-CANCELLED AND
 20366                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20367                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20368                    (LF-COVERAGE-CANCELLED AND
 20369                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20370                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20371                       MOVE ER-2965 TO WS-ERROR
 20372                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20373                       GO TO 7300-EXIT
 20374                 END-IF
 20375                 IF LF-COVERAGE-CANCELLED
 20376                  IF CL-TOTAL-PAID-AMT > 0
 20377                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20378                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20379                        MOVE ER-2891 TO WS-ERROR
 20380                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20381                        GO TO 7300-EXIT
 20382                      END-IF
 20383                    ELSE
 20384                      MOVE ER-2892 TO WS-ERROR
 20385                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20386                      GO TO 7300-EXIT
 20387                    END-IF
 20388                  END-IF
 20389                 END-IF
 20390              END-IF
 20391           END-IF
 20392        END-IF
 20393     END-IF
 20394
 20395     GO TO 7300-NEXT-CLAIM.
 20396
 20397 7300-CLAIMS-ERROR.
 20398
 20399     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20400     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20401     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20402     GO TO ABEND-PGM.
 20403
 20404 7300-EXIT.
 20405     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 372
* EL517.cbl
 20407
 20408 7400-GET-REMAIN-TERM.
 20409     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20410
 20411 7400-EXIT.
 20412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 373
* EL517.cbl
 20414
 20415 7500-GET-REMAIN-AMOUNT.
 20416     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20417
 20418 7500-EXIT.
 20419     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 374
* EL517.cbl
 20421
 20422 7600-GET-REFUND.
 20423     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20424
 20425 7600-EXIT.
 20426     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 375
* EL517.cbl
 20428
 20429 7700-CALL-DL1.
 20430     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20431     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20432
 20433 7700-EXIT.
 20434     EXIT.
 20435
 20436 7710-CALL-DL2.
 20437     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20438     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20439
 20440 7710-EXIT.
 20441     EXIT.
 20442
 20443 7720-CALL-DL3.
 20444     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20445     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20446
 20447 7720-EXIT.
 20448     EXIT.
 20449
 20450 7730-CALL-DL7.
 20451     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20452     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20453
 20454 7730-EXIT.
 20455     EXIT.
 20456
 20457 7740-CALL-DL11.
 20458     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20459     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20460
 20461 7740-EXIT.
 20462     EXIT.
 20463
 20464 7750-CALL-DL17.
 20465     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20466     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20467
 20468 7750-EXIT.
 20469     EXIT.
 20470
 20471 7755-CALL-DL19.
 20472     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20473     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20474
 20475 7755-EXIT.
 20476     EXIT.
 20477
 20478 7760-CALL-DL21.
 20479     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20480
 20481 7760-EXIT.
 20482     EXIT.
 20483
 20484 7770-CALL-DL22.
 20485     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 376
* EL517.cbl
 20486     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20487
 20488 7770-EXIT.
 20489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 377
* EL517.cbl
 20491
 20492 7800-REWRITE-CERT.
 20493     REWRITE CERTIFICATE-MASTER.
 20494     ADD 1 TO WCER.
 20495
 20496 7800-EXIT.
 20497      EXIT.
 20498     EXIT.
 20499
 20500 8000-WRITE-CERT.
 20501
 20502     WRITE CERTIFICATE-MASTER.
 20503     ADD 1 TO WCER.
 20504     IF ELCERT-FILE-STATUS NOT = '00'
 20505         GO TO 8000-FREE-MAIN.
 20506
 20507 8000-FREE-MAIN.
 20508
 20509 8000-EXIT.
 20510     EXIT.
 20511      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 378
* EL517.cbl
 20513
 20514 8100-READ-ERPNDM.
 20515     IF ERPNDM-OPEN = ' '
 20516        OPEN INPUT ERPNDM
 20517        MOVE 'X' TO ERPNDM-OPEN
 20518        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20519           NEXT SENTENCE
 20520        ELSE
 20521           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20522           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20523           MOVE EMSG TO WS-ABEND-MESSAGE
 20524           GO TO ABEND-PGM.
 20525
 20526     MOVE SPACES                 TO ERPNDM-FOUND.
 20527     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20528     READ ERPNDM.
 20529
 20530     IF ERPNDM-FILE-STATUS  = '00'
 20531        CONTINUE
 20532     ELSE
 20533        MOVE 'X'                 TO ERPNDM-FOUND
 20534        MOVE ER-2694             TO WS-ERROR
 20535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20536        MOVE ER-2883             TO WS-ERROR
 20537        PERFORM 9900-ERROR-FORMAT
 20538                                 THRU 9900-EXIT
 20539     END-IF
 20540
 20541     .
 20542 8100-EXIT.
 20543     EXIT.
 20544
 20545 8110-READ-ERMAIL.
 20546     IF ERMAIL-OPEN = ' '
 20547        OPEN  I-O ERMAIL
 20548        MOVE 'X' TO ERMAIL-OPEN
 20549        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20550           NEXT SENTENCE
 20551        ELSE
 20552            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20553            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20554            MOVE EMSG TO WS-ABEND-MESSAGE
 20555            GO TO ABEND-PGM.
 20556
 20557     MOVE SPACES                 TO ERMAIL-FOUND.
 20558     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20559     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20560     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20561     MOVE PB-SV-STATE            TO MA-STATE.
 20562
 20563     READ ERMAIL.
 20564
 20565     IF ERMAIL-FILE-STATUS  = '00'
 20566         NEXT SENTENCE
 20567       ELSE
 20568        MOVE 'X'                 TO ERMAIL-FOUND.
 20569
 20570 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 379
* EL517.cbl
 20571     EXIT.
 20572
 20573 8120-REWRITE-ERMAIL.
 20574     REWRITE MAILING-DATA.
 20575
 20576 8120-EXIT.
 20577     EXIT.
 20578
 20579 8130-WRITE-ERMAIL.
 20580     WRITE MAILING-DATA.
 20581
 20582 8130-EXIT.
 20583     EXIT.
 20584
 20585 8140-UNLOCK-ERMAIL.
 20586     MOVE SPACES                 TO ERMAIL-FOUND.
 20587
 20588 8140-EXIT.
 20589     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 380
* EL517.cbl
 20591
 20592 8180-UPDATE-VIN-NUMBER.
 20593
 20594     IF ELCRTT-OPEN = ' '
 20595         OPEN I-O ELCRTT
 20596         MOVE 'X' TO ELCRTT-OPEN
 20597         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20598             NEXT SENTENCE
 20599         ELSE
 20600             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20601             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20602             MOVE EMSG               TO WS-ABEND-MESSAGE
 20603             GO TO ABEND-PGM
 20604         END-IF
 20605     END-IF.
 20606
 20607     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20608     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20609     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20610
 20611     READ ELCRTT.
 20612
 20613     IF ELCRTT-FILE-STATUS  = '00'
 20614        CONTINUE
 20615     ELSE
 20616        GO TO 8180-NOTFND
 20617     END-IF.
 20618
 20619     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20620         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20621         REWRITE CERTIFICATE-TRAILERS
 20622     END-IF.
 20623
 20624     GO TO 8180-EXIT.
 20625
 20626 8180-NOTFND.
 20627
 20628     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20629     MOVE 'CS'         TO CS-RECORD-ID.
 20630     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20631     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20632     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20633     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20634     WRITE CERTIFICATE-TRAILERS.
 20635
 20636 8180-EXIT.
 20637     EXIT.
 20638
 20639 8190-UPDATE-REFUND-CLAIM-FLAG.
 20640
 20641     IF ELCRTT-OPEN = ' '
 20642         OPEN I-O ELCRTT
 20643         MOVE 'X' TO ELCRTT-OPEN
 20644         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20645             NEXT SENTENCE
 20646         ELSE
 20647             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20648             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 381
* EL517.cbl
 20649             MOVE EMSG               TO WS-ABEND-MESSAGE
 20650             GO TO ABEND-PGM
 20651         END-IF
 20652     END-IF.
 20653
 20654     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20655     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20656     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20657
 20658     READ ELCRTT.
 20659
 20660     IF ELCRTT-FILE-STATUS  = '00'
 20661        CONTINUE
 20662     ELSE
 20663        GO TO 8190-NOTFND
 20664     END-IF.
 20665
 20666     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20667     REWRITE CERTIFICATE-TRAILERS.
 20668
 20669     GO TO 8190-EXIT.
 20670
 20671 8190-NOTFND.
 20672
 20673     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20674     MOVE 'CS'         TO CS-RECORD-ID.
 20675     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20676     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20677     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20678     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20679     WRITE CERTIFICATE-TRAILERS.
 20680
 20681 8190-EXIT.
 20682     EXIT.
 20683
 20684 8195-UPDATE-AGE-FLAGS.
 20685     IF ELCRTT-OPEN = ' '
 20686         OPEN I-O ELCRTT
 20687         MOVE 'X' TO ELCRTT-OPEN
 20688         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20689             NEXT SENTENCE
 20690         ELSE
 20691             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20692             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20693             MOVE EMSG               TO WS-ABEND-MESSAGE
 20694             GO TO ABEND-PGM
 20695         END-IF
 20696     END-IF.
 20697
 20698     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20699     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20700     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20701
 20702     READ ELCRTT.
 20703
 20704     IF ELCRTT-FILE-STATUS  = '00'
 20705        CONTINUE
 20706     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 382
* EL517.cbl
 20707        GO TO 8195-NOTFND
 20708     END-IF.
 20709
 20710     IF WS-INS-AGE-SET = 'Y'
 20711        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20712     END-IF
 20713     IF WS-JNT-AGE-SET = 'Y'
 20714        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20715     END-IF
 20716
 20717     REWRITE CERTIFICATE-TRAILERS.
 20718
 20719     GO TO 8195-EXIT.
 20720
 20721 8195-NOTFND.
 20722
 20723     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20724     MOVE 'CS'         TO CS-RECORD-ID.
 20725     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20726     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20727     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20728     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20729     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20730     WRITE CERTIFICATE-TRAILERS.
 20731
 20732 8195-EXIT.
 20733     EXIT.
 20734
 20735 8200-READ-REIN-TABLE.
 20736     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 20737     READ ERREIN.
 20738     ADD 1 TO RREI.
 20739
 20740     IF RE-CODE NOT = 'A'
 20741        PERFORM REIN-DATE-LOAD.
 20742
 20743     IF ERREIN-FILE-STATUS NOT = '00'
 20744          GO TO 8200-NOTFND.
 20745
 20746     GO TO 8200-EXIT.
 20747
 20748 8200-NOTFND.
 20749     MOVE 'N'                TO WS-REIN-READ-SW.
 20750
 20751 8200-EXIT.
 20752     EXIT.
 20753      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 383
* EL517.cbl
 20755
 20756 8300-READ-CTBL-TABLE.
 20757     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 20758     READ ERCTBL.
 20759     ADD 1 TO RCTB.
 20760
 20761     IF ERCTBL-FILE-STATUS NOT = '00'
 20762         GO TO 8300-NOTFND.
 20763
 20764     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20765
 20766     GO TO 8300-EXIT.
 20767
 20768 8300-NOTFND.
 20769     IF CTBL-SW = '0530'
 20770         MOVE 'AA'                     TO WS-AH-COMP-CD
 20771         MOVE '0550'                   TO CTBL-SW
 20772         MOVE '1'                      TO WS-CTBL-READ-SW
 20773         GO TO 8300-EXIT.
 20774
 20775     IF CTBL-SW = '0540'
 20776         MOVE 'AA'                     TO WS-LF-COMP-CD
 20777         MOVE '0550'                   TO CTBL-SW
 20778         MOVE '1'                      TO WS-CTBL-READ-SW
 20779         GO TO 8300-EXIT.
 20780
 20781     IF CTBL-SW = '0550'
 20782         MOVE '2'                      TO WS-CTBL-READ-SW
 20783         GO TO 8300-EXIT.
 20784
 20785 8300-EXIT.
 20786      EXIT.
 20787     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 384
* EL517.cbl
 20789
 20790 8400-GETMAIN-ERFORM.
 20791*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20792     EXIT.
 20793 8400-EXIT.
 20794     EXIT.
 20795
 20796 8450-READ-FORM-MASTER.
 20797
 20798     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 20799
 20800     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 20801
 20802     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20803        GO TO 8450-FORM-NOT-FOUND.
 20804
 20805     READ ERFORM NEXT.
 20806
 20807     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20808        GO TO 8450-FORM-NOT-FOUND.
 20809
 20810     MOVE 'Y'                    TO FORM-MASTER-SW.
 20811     GO TO 8450-EXIT.
 20812
 20813 8450-FORM-NOT-FOUND.
 20814
 20815     MOVE 'N'                    TO FORM-MASTER-SW.
 20816
 20817 8450-EXIT.
 20818     EXIT.
 20819
 20820 8500-DATE-CONVERT.
 20821     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20822
 20823 8500-EXIT.
 20824     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 385
* EL517.cbl
 20826
 20827 8555-RELOAD-CONTROL-FILE.
 20828     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 20829
 20830 8555-EXIT.
 20831     EXIT.
 20832
 20833 8557-GETMAIN-ERPLAN.
 20834*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20835     EXIT.
 20836 8557-EXIT.
 20837     EXIT.
 20838
 20839 8560-GETMAIN.
 20840      MOVE 999 TO ERACCT-POINTER.
 20841
 20842 8560-EXIT.
 20843     EXIT.
 20844
 20845 8570-START-ACCOUNT-MASTER.
 20846     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20847
 20848 8570-EXIT.
 20849     EXIT.
 20850
 20851 8580-READ-ACCOUNT-MASTER.
 20852     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20853
 20854     IF WS-BROWSE-STARTED-SW = 'Y'
 20855         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 20856
 20857     IF ERACCT-FILE-STATUS = '23'
 20858         MOVE HIGH-VALUE TO ERACCT-KEY
 20859         GO TO 8580-EXIT.
 20860
 20861     IF ERACCT-FILE-STAT-1 = '9'
 20862         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20863         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 20864         MOVE RMSG TO WS-ABEND-MESSAGE
 20865         GO TO ABEND-PGM.
 20866
 20867     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 20868
 20869     READ ERACCT NEXT.
 20870     ADD 1 TO RACC.
 20871
*20872     COPY ELCACCTI.
 20873******************************************************************04/14/98
 20874*                                                                *ELCACCTI
 20875*                            ELCACCTI                            *   LV003
 20876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 20877*                            VMOD=2.001                          *ELCACCTI
 20878*                                                                *ELCACCTI
 20879*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 20880*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 20881*                                                                *ELCACCTI
 20882*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 20883*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 386
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 20884******************************************************************ELCACCTI
 20885     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 20886     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 20887     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 20888     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 20889     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 20890     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 20891     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 20892     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 20893     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 20894
 20895     IF ERACCT-FILE-STAT-1 = '9'
 20896         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20897         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 20898         MOVE RMSG TO WS-ABEND-MESSAGE
 20899         GO TO ABEND-PGM.
 20900
 20901     IF ERACCT-FILE-STATUS NOT = '00'
 20902         MOVE HIGH-VALUE TO ERACCT-KEY
 20903         GO TO 8580-EXIT.
 20904
 20905     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 20906
 20907 8580-EXIT.
 20908     EXIT.
 20909
 20910 8582-READ-COMPENSATION-MASTER.
 20911     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 20912
 20913     READ ERCOMP
 20914
 20915     IF ERCOMP-FILE-STATUS NOT = '00'
 20916        GO TO 8582-COMP-NOT-FOUND
 20917     END-IF
 20918
 20919     MOVE 'Y'                    TO COMP-MASTER-SW.
 20920     GO TO 8582-EXIT
 20921     .
 20922 8582-COMP-NOT-FOUND.
 20923
 20924     MOVE 'N'                    TO COMP-MASTER-SW.
 20925
 20926 8582-EXIT.
 20927     EXIT.
 20928
 20929 8583-READ-ERAGTC.
 20930
 20931     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 20932
 20933     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 20934
 20935     IF ERAGTC-FILE-STATUS NOT = '00'
 20936        GO TO 8583-AGTC-NOT-FOUND
 20937     END-IF
 20938
 20939     .
 20940 8583-READ-ERAGTC-NEXT.
 20941
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 387
* EL517.cbl
 20942     READ ERAGTC NEXT RECORD
 20943
 20944     IF ERAGTC-FILE-STATUS NOT = '00'
 20945        GO TO 8583-AGTC-NOT-FOUND
 20946     END-IF
 20947
 20948*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 20949     GO TO 8583-EXIT
 20950     .
 20951 8583-AGTC-NOT-FOUND.
 20952
 20953     MOVE 'N'                    TO AGTC-MASTER-SW.
 20954
 20955 8583-EXIT.
 20956     EXIT.
 20957
 20958 8584-READ-BANK-CROSS-REF.
 20959     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 20960
 20961     READ ERBXRF
 20962
 20963     IF ERBXRF-FILE-STATUS NOT = '00'
 20964        GO TO 8584-BXRF-NOT-FOUND
 20965     END-IF
 20966
 20967     MOVE 'Y'                    TO BXRF-MASTER-SW.
 20968     GO TO 8584-EXIT
 20969     .
 20970 8584-BXRF-NOT-FOUND.
 20971
 20972     MOVE 'N'                    TO BXRF-MASTER-SW.
 20973
 20974 8584-EXIT.
 20975     EXIT.
 20976
 20977 8585-READ-PLAN-MASTER.
 20978
 20979     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 20980
 20981     READ ERPLAN.
 20982
 20983     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 20984        GO TO 8585-PLAN-NOT-FOUND.
 20985
 20986     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20987     GO TO 8585-EXIT.
 20988
 20989 8585-PLAN-NOT-FOUND.
 20990
 20991     MOVE 'N'                    TO PLAN-MASTER-SW.
 20992
 20993 8585-EXIT.
 20994     EXIT.
 20995
 20996 8586-READ-LOAN-OFFICER.
 20997
 20998     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 20999
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 388
* EL517.cbl
 21000     READ ERLOFC
 21001
 21002     IF ERLOFC-FILE-STATUS NOT = '00'
 21003        MOVE 'N'                 TO LOFC-MASTER-SW
 21004     ELSE
 21005        MOVE 'Y'                 TO LOFC-MASTER-SW
 21006     END-IF
 21007
 21008     .
 21009 8586-EXIT.
 21010     EXIT.
 21011
 21012
 21013 8587-START-ERPDEF.
 21014
 21015     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21016
 21017     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21018     IF ERPDEF-FILE-STATUS NOT = '00'
 21019        MOVE 'N'                 TO PDEF-MASTER-SW
 21020     ELSE
 21021        MOVE 'Y'                 TO PDEF-MASTER-SW
 21022     END-IF
 21023
 21024
 21025     .
 21026 8587-EXIT.
 21027     EXIT.
 21028
 21029 8588-READ-ERPDEF.
 21030
 21031     READ ERPDEF NEXT RECORD
 21032
 21033     IF ERPDEF-FILE-STATUS NOT = '00'
 21034        MOVE 'N'                 TO PDEF-MASTER-SW
 21035     ELSE
 21036        MOVE 'Y'                 TO PDEF-MASTER-SW
 21037     END-IF
 21038
 21039     .
 21040 8588-EXIT.
 21041     EXIT.
 21042
 21043 8589-ENDBR-ERPDEF.
 21044
 21045     .
 21046 8589-EXIT.
 21047     EXIT.
 21048
 21049 8590-READ-CERT-MASTER.
 21050     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21051     READ ELCERT.
 21052     ADD 1 TO RCER.
 21053
 21054     IF ELCERT-FILE-STATUS NOT = '00'
 21055         NEXT SENTENCE
 21056     ELSE
 21057         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 389
* EL517.cbl
 21058
 21059     MOVE '1'                     TO CERT-STATUS-SW.
 21060
 21061     IF PB-COMPANY-ID = 'UCL'
 21062         IF WS-ERROR = ER-2799
 21063             GO TO 8590-EXIT.
 21064
 21065     IF PB-CANCELLATION
 21066        MOVE ER-2726              TO  WS-ERROR
 21067        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21068        IF ACCOUNT-MAST-FOUND
 21069           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21070           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21071           GO TO 8590-EXIT
 21072        ELSE
 21073           GO TO 8590-EXIT.
 21074
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 390
* EL517.cbl
 21076
 21077 8590-EXIT.
 21078     EXIT.
 21079
 21080 8750-START-ELSTAT.
 21081
 21082     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21083
 21084     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21085     IF ELSTAT-FILE-STATUS NOT = '00'
 21086        MOVE 'N'                 TO STAT-MASTER-SW
 21087     ELSE
 21088        MOVE 'Y'                 TO STAT-MASTER-SW
 21089     END-IF
 21090
 21091     .
 21092 8750-EXIT.
 21093     EXIT.
 21094
 21095 8752-READ-ELSTAT.
 21096
 21097     READ ELSTAT NEXT RECORD
 21098
 21099     IF ELSTAT-FILE-STATUS NOT = '00'
 21100        MOVE 'N'                 TO STAT-MASTER-SW
 21101     ELSE
 21102        MOVE 'Y'                 TO STAT-MASTER-SW
 21103     END-IF
 21104
 21105     .
 21106 8752-EXIT.
 21107     EXIT.
 21108
 21109 8800-GET-COMP-RATE.
 21110     MOVE +1 TO IB.
 21111     IF WS-COMM-CK-AMT > CT-TBF (1)
 21112         ADD +9 TO IB
 21113         IF WS-COMM-CK-AMT > CT-TBF (2)
 21114             ADD +9 TO IB
 21115             IF WS-COMM-CK-AMT > CT-TBF (3)
 21116                MOVE ZEROS       TO WS-WK-RATE
 21117                GO TO 8800-EXIT.
 21118
 21119     IF PB-I-AGE > CT-AGE (1)
 21120         ADD +3 TO IB
 21121         IF PB-I-AGE > CT-AGE (2)
 21122             ADD +3 TO IB
 21123             IF PB-I-AGE > CT-AGE (3)
 21124                MOVE ZEROS       TO WS-WK-RATE
 21125                GO TO 8800-EXIT.
 21126
 21127     IF WS-WORK-TERM > CT-TRM (1)
 21128         ADD +1 TO IB
 21129         IF WS-WORK-TERM > CT-TRM (2)
 21130             ADD +1 TO IB
 21131             IF WS-WORK-TERM > CT-TRM (3)
 21132                MOVE ZEROS       TO WS-WK-RATE
 21133                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 391
* EL517.cbl
 21134
 21135     IF CT-RT (IB) NOT NUMERIC
 21136         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21137         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21138         GO TO 8800-GET-COMP-RATE.
 21139
 21140     MOVE CT-RT (IB) TO WS-WK-RATE.
 21141
 21142 8800-EXIT.
 21143     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 392
* EL517.cbl
 21145
 21146 8900-ADDRESS-FILE.
 21147     EXIT.
 21148 8900-ADDRESS-EXIT.
 21149     EXIT.
 21150
 21151 9000-READ-CONTROL.
 21152     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21153     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21154
 21155     IF ELCNTL-FILE-STATUS NOT = '00'
 21156         GO TO 9000-NOTFND.
 21157
 21158     READ ELCNTL NEXT.
 21159     ADD 1 TO RCNT.
 21160
 21161     IF ELCNTL-FILE-STATUS NOT = '00'
 21162         GO TO 9000-NOTFND.
 21163
 21164     IF CNTL-REC-TYPE = '1'
 21165         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21166         MOVE 1            TO ELCNTL-POINTER.
 21167
 21168     IF CNTL-REC-TYPE = '6'
 21169         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21170         MOVE 6            TO ELCNTL-POINTER.
 21171
 21172     GO TO 9000-EXIT.
 21173
 21174 9000-NOTFND.
 21175     IF RC-SW-1 = '1'
 21176         MOVE ER-2616             TO WS-ERROR
 21177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21178         GO TO 9000-EXIT.
 21179
 21180     IF RC-SW-1 = '2'
 21181         MOVE ER-2602             TO WS-ERROR
 21182         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21183         GO TO 9000-EXIT.
 21184
 21185     GO TO 9000-EXIT.
 21186
 21187 9000-EXIT.
 21188     EXIT.
 21189      EXIT.
 21190
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 393
* EL517.cbl
 21192 9100-READ-CONTROL.
 21193     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21194     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21195
 21196     IF ELCNTL-FILE-STATUS NOT = '00'
 21197         GO TO 9100-NOTFND.
 21198
 21199     READ ELCNTL NEXT.
 21200     ADD 1 TO RCNT.
 21201
 21202     IF ELCNTL-FILE-STATUS NOT = '00'
 21203         GO TO 9100-NOTFND.
 21204
 21205     IF CNTL-REC-TYPE = '3'
 21206         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21207         MOVE 3            TO ELCNTL-POINTER
 21208         GO TO 9100-EXIT.
 21209
 21210     IF CNTL-REC-TYPE = '4'
 21211         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21212         MOVE 4            TO ELCNTL-POINTER
 21213         GO TO 9100-EXIT.
 21214
 21215     IF CNTL-REC-TYPE = '5'
 21216         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21217         MOVE 5            TO ELCNTL-POINTER
 21218         GO TO 9100-EXIT.
 21219
 21220     IF CNTL-REC-TYPE = 'L'
 21221         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21222         MOVE 10           TO ELCNTL-POINTER
 21223         GO TO 9100-EXIT.
 21224
 21225     IF CNTL-REC-TYPE = 'A'
 21226         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21227         MOVE 11           TO ELCNTL-POINTER
 21228         GO TO 9100-EXIT.
 21229
 21230 9100-NOTFND.
 21231     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21232
 21233     IF RC-SW-2 = '1'
 21234        MOVE '1'                 TO LF-BENEFIT-ERROR
 21235        MOVE ER-2604             TO WS-ERROR
 21236        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21237        GO TO 9100-EXIT.
 21238
 21239     IF RC-SW-2 = '2'
 21240        MOVE '1'                 TO AH-BENEFIT-ERROR
 21241        MOVE ER-2605             TO WS-ERROR
 21242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21243        GO TO 9100-EXIT.
 21244
 21245     IF RC-SW-2 = '3'
 21246        MOVE ER-2603             TO WS-ERROR
 21247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21248        GO TO 9100-EXIT.
 21249
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 394
* EL517.cbl
 21250     IF RC-SW-2 = '4'
 21251         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21252         GO TO 9100-EXIT.
 21253
 21254     IF RC-SW-2 = '5'
 21255         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21256         IF WS-AH-INPUT-CD-1 = SPACE
 21257             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21258         ELSE
 21259             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21260
 21261 9100-EXIT.
 21262     EXIT.
 21263      EXIT.
 21264
 21265 9200-CONTROL-GETMAIN.
 21266*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21267     EXIT.
 21268 9200-EXIT.
 21269     EXIT.
 21270
 21271 9250-UNLOCK-RETURN.
 21272*  DUMMIED IN THE BATCH EL517 ....
 21273     EXIT.
 21274 9250-UNLOCK-EXIT.
 21275     EXIT.
 21276      EXIT.
 21277
 21278 9300-ACCUM-BATCH-TOTALS.
 21279         IF PB-ISSUE
 21280             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21281             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21282             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21283             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21284             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21285             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21286             ADD 1                       TO WS-ISSUE-CNT
 21287         ELSE
 21288             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21289             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21290             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21291             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21292             ADD 1                       TO WS-CANCEL-CNT.
 21293
 21294 9400-EXIT.
 21295     EXIT.
 21296
 21297 9990-RETURN.
 21298*    END BROUSE OF ACCOUNT FILE
 21299     EXIT.
 21300
 21301 9990-EXIT.
 21302     EXIT.
 21303
 21304
 21305****Check for CRTO record, add one if not found.
 21306 9991-CHECK-FOR-ELCRTO.
 21307     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 395
* EL517.cbl
 21308         OPEN I-O ELCRTO
 21309         MOVE 'X' TO ELCRTO-OPEN
 21310         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21311             NEXT SENTENCE
 21312         ELSE
 21313             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21314             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21315             MOVE EMSG               TO WS-ABEND-MESSAGE
 21316             GO TO ABEND-PGM
 21317         END-IF
 21318     END-IF.
 21319     IF ELCRTT-OPEN = ' '
 21320         OPEN I-O ELCRTT
 21321         MOVE 'X' TO ELCRTT-OPEN
 21322         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21323             NEXT SENTENCE
 21324         ELSE
 21325             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21326             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21327             MOVE EMSG               TO WS-ABEND-MESSAGE
 21328             GO TO ABEND-PGM
 21329         END-IF
 21330     END-IF.
 21331     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21332     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21333     MOVE +0                     TO ELCRTO-SEQ-NO
 21334     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21335
 21336     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21337
 21338     IF ELCRTO-FILE-STATUS NOT = '00'
 21339         GO TO 9991-CRTO-NOT-FOUND
 21340     END-IF.
 21341
 21342     READ ELCRTO NEXT.
 21343     IF ELCRTO-FILE-STATUS = '00'
 21344        AND (OC-CONTROL-PRIMARY (1:33) =
 21345                 PB-CONTROL-BY-ACCOUNT (1:33))
 21346        AND (OC-RECORD-TYPE = 'I')
 21347           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21348               GO TO 9991-CHECK-INDICATORS
 21349           ELSE
 21350               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21351               GO TO 9991-CRTO-ADD-REC
 21352           END-IF
 21353     END-IF.
 21354
 21355 9991-CRTO-NOT-FOUND.
 21356
 21357     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21358     MOVE 'OC'                TO OC-RECORD-ID
 21359     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21360                              TO OC-CONTROL-PRIMARY (1:33)
 21361     MOVE +4096               TO OC-KEY-SEQ-NO.
 21362
 21363 9991-CRTO-ADD-REC.
 21364
 21365     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 396
* EL517.cbl
 21366     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21367     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21368     MOVE 'I'                 TO OC-RECORD-TYPE
 21369     IF PB-ISSUE
 21370         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21371         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21372         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21373         MOVE PB-I-AGE               TO OC-INS-AGE
 21374         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21375         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21376         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21377         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21378         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21379         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21380         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21381         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21382         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21383         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21384         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21385         IF PB-I-JOINT-COMMISSION > +0
 21386             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21387         ELSE
 21388             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21389         END-IF
 21390         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21391         MOVE +0                     TO OC-LF-CANCEL-AMT
 21392                                        OC-LF-ITD-CANCEL-AMT
 21393         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21394         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21395         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21396         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21397         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21398         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21399         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21400         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21401         MOVE +0                     TO OC-AH-CANCEL-AMT
 21402                                        OC-AH-ITD-CANCEL-AMT
 21403         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21404         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21405         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21406     ELSE
 21407         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21408         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21409         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21410         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21411         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21412         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21413         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21414         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21415         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21416          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21417             MOVE SPACES             TO OC-LF-BENCD
 21418             MOVE ZEROS              TO OC-LF-TERM
 21419                                        OC-LF-BEN-AMT
 21420                                        OC-LF-PRM-AMT
 21421                                        OC-LF-ALT-BEN-AMT
 21422                                        OC-LF-ALT-PRM-AMT
 21423                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 397
* EL517.cbl
 21424                                        OC-LF-CANCEL-AMT
 21425             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21426             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21427         ELSE
 21428             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21429             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21430             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21431             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21432             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21433             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21434             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21435             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21436             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21437             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21438         END-IF
 21439         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21440         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21441          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21442             MOVE SPACES             TO OC-AH-BENCD
 21443             MOVE ZEROS              TO OC-AH-TERM
 21444                                        OC-AH-BEN-AMT
 21445                                        OC-AH-PRM-AMT
 21446                                        OC-AH-COMM-PCT
 21447                                        OC-AH-CANCEL-AMT
 21448                                        OC-AH-CP
 21449             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21450             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21451         ELSE
 21452             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21453             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21454             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21455             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21456             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21457             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21458             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21459             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21460             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21461         END-IF
 21462         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21463         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21464         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21465         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21466     END-IF
 21467     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21468
 21469     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21470     IF ERMAIL-FOUND = ' '
 21471         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21472     END-IF.
 21473
 21474     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21475     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21476     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21477
 21478     READ ELCRTT
 21479
 21480     IF ELCRTT-FILE-STATUS  = '00'
 21481         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 398
* EL517.cbl
 21482         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21483     END-IF.
 21484
 21485     WRITE ORIGINAL-CERTIFICATE.
 21486
 21487     GO TO 9991-EXIT.
 21488
 21489 9991-CHECK-INDICATORS.
 21490
 21491     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21492         GO TO 9991-EXIT
 21493     END-IF.
 21494
 21495     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21496         GO TO 9991-EXIT
 21497     END-IF.
 21498
 21499     IF PB-ISSUE
 21500        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21501        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21502        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21503        MOVE PB-I-AGE               TO OC-INS-AGE
 21504        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21505        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21506        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21507        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21508        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21509        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21510        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21511        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21512        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21513        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21514        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21515        IF PB-I-JOINT-COMMISSION > +0
 21516            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21517        ELSE
 21518            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21519        END-IF
 21520        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21521        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21522        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21523        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21524        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21525        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21526        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21527        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21528        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21529
 21530        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21531        IF ERMAIL-FOUND = ' '
 21532           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21533        END-IF
 21534
 21535        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21536        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21537        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21538        READ ELCRTT
 21539        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 399
* EL517.cbl
 21540           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21541           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21542        END-IF
 21543
 21544     ELSE
 21545        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21546           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21547           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21548           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21549        END-IF
 21550        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21551           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21552           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21553           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21554        END-IF
 21555        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21556     END-IF
 21557
 21558     REWRITE ORIGINAL-CERTIFICATE.
 21559
 21560 9991-EXIT.
 21561     EXIT.
 21562
 21563
 21564 9999-SET-PNDB-ERROR-FLAGS.
 21565
 21566     IF PB-BATCH-TRAILER
 21567        GO TO 9999-REWRITE-RECORD.
 21568
 21569     IF PB-COMMON-ERRORS = LOW-VALUES
 21570        GO TO 9999-SET-ERROR-FLAGS.
 21571
 21572 9999-FORMAT-ERRORS.
 21573
 21574     MOVE +0                     TO SUB1.
 21575
 21576 9999-ERROR-LOOP.
 21577
 21578     ADD +1                      TO SUB1.
 21579
 21580     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21581        GO TO 9999-SET-ERROR-FLAGS.
 21582
 21583     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21584
 21585     READ ELCERR.
 21586
 21587     IF ELCERR-FILE-STATUS NOT = '00'
 21588        ADD +1                       TO EMI-FATAL-CTR
 21589        GO TO  9999-ERROR-LOOP.
 21590
*21591                                 COPY ELCERRPD.
 21592******************************************************************04/15/98
 21593*                                                                *ELCERRPD
 21594*                                                                *ELCERRPD
 21595*                            ELCERRPD                            *   LV002
 21596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21597*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 400
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21598*                                                                *ELCERRPD
 21599*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21600*                                                                *ELCERRPD
 21601******************************************************************ELCERRPD
 21602                                                                  ELCERRPD
 21603     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21604         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21605                                                                  ELCERRPD
 21606     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21607                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21608        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21609            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21610                                                                  ELCERRPD
 21611     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21612        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21613            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21614                                                                  ELCERRPD
 21615     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21616        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21617            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21618                                                                  ELCERRPD
 21619     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21620        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21621            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21622                                                                  ELCERRPD
 21623     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21624        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21625            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21626                                                                  ELCERRPD
 21627     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21628        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21629            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21630                                                                  ELCERRPD
 21631     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21632        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21633            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21634                                                                  ELCERRPD
 21635     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21636        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21637            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21638                                                                  ELCERRPD
 21639     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21640        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21641            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21642                                                                  ELCERRPD
 21643     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21644        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21645            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21646                                                                  ELCERRPD
 21647     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21648             OR                                                   ELCERRPD
 21649         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21650                                                                  ELCERRPD
 21651         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21652             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21653                                                                  ELCERRPD
 21654     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21655         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 401
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21656             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21657
 21658     IF E-CLIENT-ID = CLIENT-DCC
 21659        IF EM-MESSAGE-NUMBER = 2719
 21660           MOVE 'W'              TO EM-ERROR-SEVERITY
 21661        END-IF
 21662     END-IF
 21663
 21664     .
 21665
 21666     IF EM-ERROR-SEVERITY = 'W'
 21667        ADD +1                   TO EMI-WARNING-CTR
 21668        GO TO  9999-ERROR-LOOP.
 21669
 21670     IF EM-ERROR-SEVERITY = 'F'
 21671        ADD +1                   TO EMI-FORCABLE-CTR
 21672        GO TO  9999-ERROR-LOOP.
 21673
 21674     IF EM-ERROR-SEVERITY = 'X'
 21675        ADD +1                   TO EMI-FATAL-CTR.
 21676
 21677     GO TO 9999-ERROR-LOOP.
 21678
 21679 9999-SET-ERROR-FLAGS.
 21680
 21681     IF EMI-FATAL-CTR NOT = ZEROS
 21682        MOVE 'X'                 TO PB-FATAL-FLAG
 21683        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21684
 21685     IF EMI-FORCABLE-CTR NOT = ZEROS
 21686        IF PB-ISSUE
 21687           IF PB-ISSUE-FORCE
 21688              MOVE 'F'           TO PB-FORCE-ER-CD
 21689             ELSE
 21690              MOVE 'X'           TO PB-FORCE-ER-CD
 21691          ELSE
 21692           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21693              MOVE 'F'           TO PB-FORCE-ER-CD
 21694             ELSE
 21695              MOVE 'X'           TO PB-FORCE-ER-CD.
 21696
 21697 9999-CONT-SET-ERROR-FLAGS.
 21698
 21699     IF EMI-WARNING-CTR NOT = ZEROS
 21700        MOVE 'W'                 TO PB-WARN-ER-CD.
 21701
 21702     IF PB-UNFORCED-ERRORS OR
 21703        PB-FATAL-ERRORS    OR
 21704        PB-RECORD-ON-HOLD  OR
 21705        PB-RECORD-RETURNED
 21706*        OR
 21707*       PB-CANCELLATION
 21708          NEXT SENTENCE
 21709        ELSE
 21710          GO TO 9999-REWRITE-RECORD.
 21711
 21712     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21713     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 402
* EL517.cbl
 21714     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21715     MOVE PB-SV-STATE            TO CERT-STATE.
 21716
 21717     READ ELCERT.
 21718
 21719     IF PB-ISSUE
 21720     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21721        GO TO 9999-REWRITE-CERT-MASTER.
 21722
 21723     IF PB-ISSUE
 21724        IF PB-RECORD-RETURNED
 21725            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21726        ELSE
 21727             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21728
 21729     IF PB-CANCELLATION
 21730        IF PB-RECORD-RETURNED
 21731            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 21732        ELSE
 21733            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 21734               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 21735            ELSE
 21736               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 21737
 21738 9999-REWRITE-CERT-MASTER.
 21739
 21740     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 21741        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 21742        GO TO 9999-REWRITE-RECORD.
 21743
 21744     REWRITE CERTIFICATE-MASTER.
 21745     ADD 1 TO WCER.
 21746
 21747 9999-REWRITE-RECORD.
 21748     IF NOT PB-BATCH-TRAILER
 21749         IF PB-ISSUE
 21750             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21751             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21752             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21753             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21754             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 21755             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 21756             ADD 1                   TO WS-ISSUE-CNT
 21757         ELSE
 21758             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 21759             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 21760             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 21761             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 21762             ADD 1                   TO WS-CANCEL-CNT
 21763     ELSE
 21764         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 21765         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 21766         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 21767         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 21768         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 21769         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 21770         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 21771         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 403
* EL517.cbl
 21772         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 21773         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 21774         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 21775                                        WS-LF-ISS-ENTERED
 21776                                        WS-AH-ISS-COMPUTED
 21777                                        WS-AH-ISS-ENTERED
 21778                                        WS-LF-CAN-COMPUTED
 21779                                        WS-LF-CAN-ENTERED
 21780                                        WS-AH-CAN-COMPUTED
 21781                                        WS-AH-CAN-ENTERED
 21782                                        WS-ISSUE-CNT
 21783                                        WS-CANCEL-CNT
 21784         MOVE SPACE                  TO PB-FATAL-FLAG.
 21785
 21786     IF PB-BATCH-TRAILER
 21787         IF PB-B-LF-ISS-PRM-REMITTED =
 21788            PB-B-LF-ISS-PRM-ENTERED   AND
 21789            PB-B-LF-CAN-PRM-REMITTED =
 21790            PB-B-LF-CAN-PRM-ENTERED   AND
 21791            PB-B-AH-ISS-PRM-REMITTED =
 21792            PB-B-AH-ISS-PRM-ENTERED   AND
 21793            PB-B-AH-CAN-PRM-REMITTED =
 21794            PB-B-AH-CAN-PRM-ENTERED   AND
 21795            PB-B-ISSUE-CNT-REMITTED  =
 21796            PB-B-ISSUE-CNT-ENTERED    AND
 21797            PB-B-CANCEL-CNT-REMITTED =
 21798            PB-B-CANCEL-CNT-ENTERED
 21799             MOVE SPACE          TO PB-OUT-BAL-CD
 21800           ELSE
 21801             MOVE 'O'            TO PB-OUT-BAL-CD.
 21802
 21803     REWRITE PENDING-BUSINESS.
 21804
 21805     ADD 1 TO WPND.
 21806
 21807     GO TO 0100-READ-PENDING.
 21808
 21809 9999-EXIT.
 21810     EXIT.
 21811
 21812******************************************************************
 21813*                                                                *
 21814*            E R R O R   F O R M A T   R O U T I N E             *
 21815*                                                                *
 21816******************************************************************
 21817
 21818 9900-ERROR-FORMAT.
 21819
 21820     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 21821                   PB-COMMON-ERROR (2)  OR
 21822                   PB-COMMON-ERROR (3)  OR
 21823                   PB-COMMON-ERROR (4)  OR
 21824                   PB-COMMON-ERROR (5)  OR
 21825                   PB-COMMON-ERROR (6)  OR
 21826                   PB-COMMON-ERROR (7)  OR
 21827                   PB-COMMON-ERROR (8)  OR
 21828                   PB-COMMON-ERROR (9)  OR
 21829                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 404
* EL517.cbl
 21830        GO TO 9900-EXIT.
 21831
 21832     IF PB-NO-OF-ERRORS = +10
 21833        GO TO 9900-EXIT.
 21834
 21835     ADD +1                      TO PB-NO-OF-ERRORS.
 21836     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21837                                       (PB-NO-OF-ERRORS).
 21838
 21839
 21840 9900-EXIT.
 21841     EXIT.
 21842
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 405
* EL517.cbl
 21844 9999-DONE.
 21845*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 21846
 21847     IF DTE-CLIENT NOT EQUAL 'DMD'
 21848          GO TO 9999-DONE-CONT.
 21849
 21850     CLOSE ERRESS
 21851           ERRESC.
 21852
 21853     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 21854     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 21855     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 21856     IF DMPF-RETURN-CODE EQUAL 'Z3'
 21857         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21858         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 21859         MOVE CMSG               TO WS-ABEND-MESSAGE
 21860         GO TO ABEND-PGM.
 21861
 21862     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 21863     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 21864     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 21865     IF DIPF-RETURN-CODE EQUAL 'Z3'
 21866         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21867         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 21868         MOVE CMSG               TO WS-ABEND-MESSAGE
 21869         GO TO ABEND-PGM.
 21870
 21871     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 21872     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 21873     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 21874     IF DIPF-RETURN-CODE EQUAL 'Z3'
 21875         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21876         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 21877         MOVE CMSG               TO WS-ABEND-MESSAGE
 21878         GO TO ABEND-PGM.
 21879
 21880     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 21881     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 21882     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 21883     IF DCUA-RETURN-CODE EQUAL 'Z3'
 21884         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21885         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 21886         MOVE CMSG               TO WS-ABEND-MESSAGE
 21887         GO TO ABEND-PGM.
 21888
 21889     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 21890     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 21891     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 21892     IF DPRB-RETURN-CODE EQUAL 'Z3'
 21893         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21894         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 21895         MOVE CMSG               TO WS-ABEND-MESSAGE
 21896         GO TO ABEND-PGM.
 21897
 21898     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 21899     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 21900     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 21901     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 406
* EL517.cbl
 21902         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21903         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 21904         MOVE CMSG               TO WS-ABEND-MESSAGE
 21905         GO TO ABEND-PGM.
 21906
 21907     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 21908     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 21909     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 21910     IF DVSC-RETURN-CODE EQUAL 'Z3'
 21911         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21912         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 21913         MOVE CMSG               TO WS-ABEND-MESSAGE
 21914         GO TO ABEND-PGM.
 21915
 21916*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 21917
 21918 9999-DONE-CONT.
 21919
 21920     IF ERPNDM-OPEN = 'X'
 21921        CLOSE ERPNDM.
 21922
 21923     IF ERMAIL-OPEN = 'X'
 21924        CLOSE ERMAIL.
 21925
 21926     IF ELMSTR-OPEN = 'X'
 21927        CLOSE ELMSTR.
 21928
 21929     IF ELCRTT-OPEN = 'X'
 21930        CLOSE ELCRTT
 21931     END-IF.
 21932
 21933     IF ELCRTO-OPEN = 'X'
 21934        CLOSE ELCRTO
 21935     END-IF.
 21936
 21937     CLOSE      ELCNTL
 21938                ELCERR
 21939                ERPNDB
 21940                ERREIN
 21941                ELCERT
 21942                ERCTBL
 21943                ERPLAN
 21944                ERACCT
 21945                ERBXRF
 21946                ERAGTC
 21947                ERCOMP.
 21948
 21949     IF DTE-CLIENT = 'DCC'
 21950        CLOSE ERPDEF ELSTAT
 21951        IF ERPDEF-FILE-STATUS NOT = '00'
 21952            MOVE ERPDEF-FILE-STATUS
 21953                                 TO WS-ABEND-FILE-STATUS
 21954            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 21955            MOVE CMSG            TO WS-ABEND-MESSAGE
 21956            GO TO ABEND-PGM
 21957        END-IF
 21958        IF ELSTAT-FILE-STATUS NOT = '00'
 21959            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 407
* EL517.cbl
 21960                                 TO WS-ABEND-FILE-STATUS
 21961            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 21962            MOVE CMSG            TO WS-ABEND-MESSAGE
 21963            GO TO ABEND-PGM
 21964        END-IF
 21965     END-IF
 21966
 21967     IF ELCNTL-FILE-STATUS NOT = '00'
 21968         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21969         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 21970         MOVE CMSG TO WS-ABEND-MESSAGE
 21971         GO TO ABEND-PGM.
 21972
 21973     IF ERPNDB-FILE-STATUS NOT = '00'
 21974         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21975         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 21976         MOVE CMSG TO WS-ABEND-MESSAGE
 21977         GO TO ABEND-PGM.
 21978
 21979     IF ERREIN-FILE-STATUS NOT = '00'
 21980         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21981         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 21982         MOVE CMSG TO WS-ABEND-MESSAGE
 21983         GO TO ABEND-PGM.
 21984
 21985     IF ELCERT-FILE-STATUS NOT = '00'
 21986         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21987         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 21988         MOVE CMSG TO WS-ABEND-MESSAGE
 21989         GO TO ABEND-PGM.
 21990
 21991     IF ERMAIL-OPEN   = 'X'
 21992       IF ERMAIL-FILE-STATUS NOT = '00'
 21993           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21994           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 21995           MOVE CMSG TO WS-ABEND-MESSAGE
 21996           GO TO ABEND-PGM.
 21997
 21998     IF ERPNDM-OPEN   = 'X'
 21999       IF ERPNDM-FILE-STATUS NOT = '00'
 22000            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22001            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22002            MOVE CMSG TO WS-ABEND-MESSAGE
 22003            GO TO ABEND-PGM.
 22004
 22005     IF ELCRTT-OPEN = 'X'
 22006         IF ELCRTT-FILE-STATUS NOT = '00'
 22007             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22008             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22009             MOVE CMSG TO WS-ABEND-MESSAGE
 22010             GO TO ABEND-PGM
 22011         END-IF
 22012     END-IF.
 22013
 22014     IF ELCRTO-OPEN = 'X'
 22015         IF ELCRTO-FILE-STATUS NOT = '00'
 22016             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22017             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 408
* EL517.cbl
 22018             MOVE CMSG TO WS-ABEND-MESSAGE
 22019             GO TO ABEND-PGM
 22020         END-IF
 22021     END-IF.
 22022
 22023     IF ERCTBL-FILE-STATUS NOT = '00'
 22024         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22025         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22026         MOVE CMSG TO WS-ABEND-MESSAGE
 22027         GO TO ABEND-PGM.
 22028
 22029     IF ERPLAN-FILE-STATUS NOT = '00'
 22030        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22031        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22032        MOVE CMSG TO WS-ABEND-MESSAGE
 22033        GO TO ABEND-PGM.
 22034
 22035     IF ERACCT-FILE-STATUS NOT = '00'
 22036         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22037         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22038         MOVE CMSG TO WS-ABEND-MESSAGE
 22039         GO TO ABEND-PGM.
 22040
 22041     IF ERCOMP-FILE-STATUS NOT = '00'
 22042         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22043         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22044         MOVE CMSG TO WS-ABEND-MESSAGE
 22045         GO TO ABEND-PGM.
 22046
 22047     IF ERBXRF-FILE-STATUS NOT = '00'
 22048         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22049         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22050         MOVE CMSG TO WS-ABEND-MESSAGE
 22051         GO TO ABEND-PGM.
 22052
 22053     IF ERAGTC-FILE-STATUS NOT = '00'
 22054         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22055         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22056         MOVE CMSG TO WS-ABEND-MESSAGE
 22057         GO TO ABEND-PGM.
 22058
 22059     IF ELCERR-FILE-STATUS NOT = '00'
 22060         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22061         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22062         MOVE CMSG TO WS-ABEND-MESSAGE
 22063         GO TO ABEND-PGM.
 22064
 22065     MOVE 'C'                     TO CP-IO-FUNCTION.
 22066     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22067
 22068     IF IO-ERROR
 22069        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22070        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22071        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22072        GO TO ABEND-PGM.
 22073
 22074     OPEN OUTPUT PRINT-FILE.
 22075
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 409
* EL517.cbl
 22076     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22077     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22078     MOVE ALPH-DATE              TO H3-DATE.
 22079     MOVE TRAN-CT                TO SUM-TOT.
 22080
 22081 7000-PRT-HDG.
 22082     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22083     PERFORM 7000-PRINT-LINE.
 22084     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22085     PERFORM 7000-PRINT-LINE.
 22086     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22087     PERFORM 7000-PRINT-LINE.
 22088     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22089     PERFORM 7000-PRINT-LINE.
 22090     GO TO 9999-END-JOB.
 22091
 22092 7000-HDG-XIT.
 22093     EXIT.
 22094
 22095 7000-PRINT-LINE.
*22096                     COPY ELCPRT2X.
 22097******************************************************************04/15/98
 22098*                                                                *ELCPRT2X
 22099*                                                                *ELCPRT2X
 22100*                            ELCPRT2X.                           *   LV002
 22101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22102*                            VMOD=2.002                          *   CL**2
 22103*                                                                *ELCPRT2X
 22104*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22105*                                                                *ELCPRT2X
 22106*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22107*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22108*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22109*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22110*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22111*                                                                *ELCPRT2X
 22112*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22113*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22114******************************************************************ELCPRT2X
 22115                                                                  ELCPRT2X
 22116     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22117         FICH-OPEN   = SPACE                                      ELCPRT2X
 22118         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22119         OPEN OUTPUT FICH.                                        ELCPRT2X
 22120                                                                  ELCPRT2X
 22121     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22122         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22123             OPEN I-O ELREPT                                      ELCPRT2X
 22124             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22125                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22126                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22127                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22128                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22129                 GO TO ABEND-PGM                                  ELCPRT2X
 22130             ELSE                                                 ELCPRT2X
 22131                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22132                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22133                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 410
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22134                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22135                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22136                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22137                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22138                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22139                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22140                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22141                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22142                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22143                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22144                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22145                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22146                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22147                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22148                                                                  ELCPRT2X
 22149     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22150        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22151         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22152         GO TO ABEND-PGM.                                         ELCPRT2X
 22153                                                                  ELCPRT2X
 22154     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22155         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22156         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22157             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22158                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22159                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22160                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22161                     INVALID KEY                                  ELCPRT2X
 22162                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22163                         CLOSE ELREPT                             ELCPRT2X
 22164                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22165                                                                  ELCPRT2X
 22166     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22167         MOVE X                      TO  P-CTL                    ELCPRT2X
 22168         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22169                                                                  ELCPRT2X
 22170     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22171       MOVE X                        TO  P-CTL                    ELCPRT2X
 22172       IF P-CTL = ' '                                             ELCPRT2X
 22173         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22174       ELSE                                                       ELCPRT2X
 22175         IF P-CTL = '0'                                           ELCPRT2X
 22176           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22177         ELSE                                                     ELCPRT2X
 22178           IF P-CTL = '-'                                         ELCPRT2X
 22179             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22180           ELSE                                                   ELCPRT2X
 22181             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22182                                                                  ELCPRT2X
 22183     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22184                                                                  ELCPRT2X
 22185 DTE-REPORT-DELETE.                                               ELCPRT2X
 22186     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22187         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22188         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22189                                                                  ELCPRT2X
 22190     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22191           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 411
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22192                                                                  ELCPRT2X
 22193     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22194        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22195         DELETE ELREPT RECORD                                     ELCPRT2X
 22196         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22197                                                                  ELCPRT2X
 22198 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22199     EXIT.                                                        ELCPRT2X
 22200                                                                  ELCPRT2X
 22201 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22202     EXIT.                                                        ELCPRT2X
 22203******************************************************************ELCPRT2X
 22204
 22205 REIN-DATE-LOAD.
*22206     COPY ELCRENM1.
 22207******************************************************************04/15/98
 22208*                                                                *ELCRENM1
 22209*                                                                *ELCRENM1
 22210*                            ELCRENM1                            *   LV002
 22211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22212*                            VMOD=2.001                          *ELCRENM1
 22213*                                                                *ELCRENM1
 22214*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22215*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22216*                                                                *ELCRENM1
 22217******************************************************************ELCRENM1
 22218     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22219     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22220     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22221                                                                  ELCRENM1
 22222
 22223 7000-PRINT-LINE-XIT.
 22224      EXIT.
 22225
 22226 9999-END-JOB.
 22227     CLOSE PRINT-FILE.
*22228             COPY ELCPRTCX.
 22229******************************************************************04/15/98
 22230*                                                                *ELCPRTCX
 22231*                                                                *ELCPRTCX
 22232*                            ELCPRTCX.                           *   LV003
 22233*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22234*                            VMOD=2.003                          *   CL**3
 22235*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22236*                                                                *ELCPRTCX
 22237* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22238******************************************************************ELCPRTCX
 22239                                                                  ELCPRTCX
 22240      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22241          CLOSE FICH.                                             ELCPRTCX
 22242                                                                  ELCPRTCX
 22243      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22244          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22245          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22246          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22247          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22248          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22249          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 412
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22250          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22251          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22252              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22253              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22254              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22255                  UPON CONSOLE                                    ELCPRTCX
 22256              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22257                  UPON CONSOLE                                    ELCPRTCX
 22258            ELSE                                                  ELCPRTCX
 22259              DISPLAY '***************************************'   ELCPRTCX
 22260              DISPLAY '***************************************'   ELCPRTCX
 22261              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22262              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22263              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22264              DISPLAY '**                                   **'   ELCPRTCX
 22265              DISPLAY '***************************************'   ELCPRTCX
 22266              DISPLAY '***************************************'   ELCPRTCX
 22267              CLOSE ELREPT.                                       ELCPRTCX
 22268                                                                  ELCPRTCX
 22269      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22270          DISPLAY '***************************************'       ELCPRTCX
 22271          DISPLAY '***************************************'       ELCPRTCX
 22272          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22273          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22274          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22275          DISPLAY '**                                   **'       ELCPRTCX
 22276          DISPLAY '***************************************'       ELCPRTCX
 22277          DISPLAY '***************************************'       ELCPRTCX
 22278          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22279                                                                  ELCPRTCX
 22280      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22281          DISPLAY '***************************************'       ELCPRTCX
 22282          DISPLAY '***************************************'       ELCPRTCX
 22283          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22284          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22285          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22286          DISPLAY '**                                   **'       ELCPRTCX
 22287          DISPLAY '***************************************'       ELCPRTCX
 22288          DISPLAY '***************************************'       ELCPRTCX
 22289          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22290                                                                  ELCPRTCX
 22291                                                                  ELCPRTCX
 22292******************************************************************ELCPRTCX
 22293
 22294     GOBACK.
 22295
 22296 ABEND-PGM.
*                   COPY ELCABEND.
 22297***************************************************************** 04/14/98
 22298*                                                               * ELCABEND
 22299*                            ELCABEND.                          *    LV003
 22300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22301*                            VMOD 2.002                              CL**2
 22302*                                                               * ELCABEND
 22303*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22304*            AND THEN ABENDS.                                   * ELCABEND
 22305*                                                               * ELCABEND
 22306*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 413
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22307*                                                               * ELCABEND
 22308***************************************************************** ELCABEND
 22309*APS-010.                                                         ELCABEND
 22310     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22311     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22312                                                                  ELCABEND
 22313     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22314         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22315         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22316                                 UPON CONSOLE.                    ELCABEND
 22317                                                                  ELCABEND
 22318     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22319         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22320         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22321                                 UPON CONSOLE.                    ELCABEND
 22322                                                                  ELCABEND
 22323     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22324     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22325                                 UPON CONSOLE.                    ELCABEND
 22326                                                                  ELCABEND
 22327     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22328     CALL 'ABORTME'.
 22329                                                                  ELCABEND
 22330 APS-EXIT.                                                        ELCABEND
 22331     EXIT.                                                        ELCABEND
 22332
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116640     Code:       90860
