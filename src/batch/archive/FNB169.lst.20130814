* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* FNB169.cbl
* Options: int("FNB169.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB169.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB169.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB169.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB169.
     3
     4******************************************************************
     5*                                                                *
     6*            FREEDOM INTERFACE FOR DCC CONTRACT FEES             *
     7*                                                                *
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* FNB169.cbl
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
    16* 050704    2003080800002  SMVA  NEW PROGRAM FOR SECURE PAY
    17* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
    18* 021009  IR2009020900001  PEMA  ADD AGT TYPE J AS INCENTIVE
    19* 022009    2008050500001  AJRA  ADD PROCESSING FOR CCC
    20* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    21* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    22* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    23* 080212  IR2012080100002  PEMA  CORRECT AGT TYPE N
    24* 082912  IR2012080700001  PEMA  CORRECT REF ADMIN FEE
    25******************************************************************
    26
    27 ENVIRONMENT DIVISION.
    28 INPUT-OUTPUT SECTION.
    29 FILE-CONTROL.
    30
    31     SELECT DETEXTR              ASSIGN TO SYS010
    32                                 FILE STATUS IS DETEXT-STATUS.
    33     SELECT FREEDOM-EXTRACT      ASSIGN TO SYS011
    34                                 ORGANIZATION IS LINE SEQUENTIAL.
    35
    36     SELECT CSI-FREEDOM-EXTRACT  ASSIGN TO SYS012
    37                                 ORGANIZATION IS LINE SEQUENTIAL.
    38
    39     SELECT CCC-FREEDOM-EXTRACT  ASSIGN TO SYS013
    40                                 ORGANIZATION IS LINE SEQUENTIAL.
    41
    42     SELECT ERACCT               ASSIGN TO ERACCT
    43                                 ORGANIZATION IS INDEXED
    44                                 ACCESS IS DYNAMIC
    45                                 RECORD KEY IS AM-CONTROL-PRIMARY
    46                                 FILE STATUS IS ERACCT-STATUS.
    47
    48     SELECT ERPDEF           ASSIGN TO ERPDEF
    49                             ACCESS IS DYNAMIC
    50                             ORGANIZATION IS INDEXED
    51                             FILE STATUS IS ERPDEF-FILE-STATUS
    52                             RECORD KEY IS PD-CONTROL-PRIMARY.
    53
    54     SELECT DISK-DATE            ASSIGN TO SYS019.
    55
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* FNB169.cbl
    57 DATA DIVISION.
    58 FILE SECTION.
    59
    60 FD  DETEXTR
    61     LABEL RECORDS ARE STANDARD
    62     RECORDING MODE IS F
    63     RECORD CONTAINS 510 CHARACTERS
    64     BLOCK CONTAINS 0 RECORDS.
*   65     COPY ECSEXT01.
    66******************************************************************04/29/98
    67*                                                                *ECSEXT01
    68*                            ECSEXT01                            *   LV015
    69*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    70*                            VMOD=2.015                          *ECSEXT01
    71*                                                                *ECSEXT01
    72*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    73*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    74*                                                                *ECSEXT01
    75*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    76*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    77*                                                                *ECSEXT01
    78*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    79*                                                                *ECSEXT01
    80******************************************************************ECSEXT01
    81******************************************************************
    82*                   C H A N G E   L O G
    83*
    84* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    85*-----------------------------------------------------------------
    86*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    87* EFFECTIVE    NUMBER
    88*-----------------------------------------------------------------
    89* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    90* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    91* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    92* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    93* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    94* 032612  CR2011110200001  PEMA  AHL CHANGES
    95******************************************************************
    96                                                                  ECSEXT01
    97 01  DETAIL-EXTRACT.                                              ECSEXT01
    98     02 DETAIL-FILE.                                              ECSEXT01
    99     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
   100         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
   101                                                                  ECSEXT01
   102     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
   103                                                                  ECSEXT01
   104     12  DE-REIN                           PIC X.                 ECSEXT01
   105                                                                  ECSEXT01
   106     12  DE-CONTROL.                                              ECSEXT01
   107         16  DE-CNTRL1.                                           ECSEXT01
   108             20  DE-CARRIER                PIC X.                 ECSEXT01
   109             20  DE-GROUPING.                                     ECSEXT01
   110                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   111                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   112             20  DE-STATE                  PIC XX.                ECSEXT01
   113             20  DE-ACCOUNT.                                      ECSEXT01
   114                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   115                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   116         16  DE-CNTRL2.                                           ECSEXT01
   117             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   118             20  DE-CERT.                                         ECSEXT01
   119                 24 DE-CERT-NO.                                   ECSEXT01
   120                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   121                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   122                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   123                                                                  ECSEXT01
   124     12  DE-TRANS                          PIC X.                 ECSEXT01
   125         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   126         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   127         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   128         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   129         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   130         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   131         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   132         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   133         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   134         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   135                                                                  ECSEXT01
   136     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   137     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   138                                                                  ECSEXT01
   139     12  DE-NAME.                                                 ECSEXT01
   140         16  DE-LNAME                      PIC X(15).             ECSEXT01
   141         16  DE-FNAME.                                            ECSEXT01
   142             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   143             20  FILLER                    PIC X(9).              ECSEXT01
   144         16  DE-INIT                       PIC X.                 ECSEXT01
   145     12  DE-AGE                            PIC 99.                ECSEXT01
   146     12  DE-SEX                            PIC X.                 ECSEXT01
   147     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   148                                                                  ECSEXT01
   149     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   150     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   151     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   152     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   153     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   154     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   155     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   156     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   157     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   158                                                                  ECSEXT01
   159     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   160     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   161     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   162     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   163                                                                  ECSEXT01
   164     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   165     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   166     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   167     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   168     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   169                                                                  ECSEXT01
   170     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   171     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   172     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   173     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   174                                                                  ECSEXT01
   175     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   176     12  DE-ADDL-CLP REDEFINES DE-LIVES
   177                                           PIC S9(5)V99   COMP-3.
   178     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   179     12  FILLER REDEFINES DE-NUM-BILLED.
   180         16  DE-CLP-STATE                  PIC XX.
   181         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   182     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   183     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   184                                                                  ECSEXT01
   185     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   186     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   187     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   188     12  DE-IG                             PIC X.                 ECSEXT01
   189     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   190*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   191     12  DE-MEMBER-NO.                                            ECSEXT01
   192         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   193         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   194         16  FILLER                        PIC X(03).             ECSEXT01
   195     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   196                                                                  ECSEXT01
   197     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
   198         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   199                                                                  ECSEXT01
   200     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   201     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   202                                                                  ECSEXT01
   203     12  DE-REI-AREA.                                             ECSEXT01
   204         16  DE-REI-COMP.                                         ECSEXT01
   205             20  DE-REINCO                 PIC XXX.               ECSEXT01
   206             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   207         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   208         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   209         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   210         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   211         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   212         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   213         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   214                                                                  ECSEXT01
   215     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   216     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   217         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   218         16  F                             PIC X.
   219*    12  FILLER                            PIC X(5).              ECSEXT01
   220                                                                  ECSEXT01
   221     12  DE-BILLED-AREA.                                          ECSEXT01
   222         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   223             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   224                                                                  ECSEXT01
   225         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   226             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   227             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   228             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   229             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   230             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   231             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   232                                                                  ECSEXT01
   233         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   234             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   235                                                                  ECSEXT01
   236         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   237         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   238         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   239         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   240                                                                  ECSEXT01
   241         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   242*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   243*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   244                                                                  ECSEXT01
   245     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   246         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   247         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   248         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   249                                                                  ECSEXT01
   250     12  DE-REVERSE-REASONS.                                      ECSEXT01
   251         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   252         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   253     12  DE-CANCEL-REASON                  PIC X.
   254                                                                  ECSEXT01
   255     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
   256     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   257                                                                  ECSEXT01
   258     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   259         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   260             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   261         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   262             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   263                                                                  ECSEXT01
   264     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   265         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   266                                                                  ECSEXT01
   267     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   268     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   269         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   270         16  FILLER                        PIC X.
   271                                                                  ECSEXT01
   272****************************************************************  ECSEXT01
   273**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   274****************************************************************  ECSEXT01
   275     12  DE-COMM-LEVELS.                                          ECSEXT01
   276         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   277             20  DE-AGT.                                          ECSEXT01
   278                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   279                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   280             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   281             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   282             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   283                                                                  ECSEXT01
   284     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   285****************************************************************  ECSEXT01
   286*******                 CLAIM EXTRACT                      *****  ECSEXT01
   287****************************************************************  ECSEXT01
   288     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   289     12  FILLER                            PIC X(334).            ECSEXT01
   290     12  DE-TYPE                           PIC X.                 ECSEXT01
   291         88  DE-DTH                           VALUE '1'.          ECSEXT01
   292         88  DE-AH                            VALUE '2'.          ECSEXT01
   293         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   294         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   295         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   296         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   297                                                                  ECSEXT01
   298     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   299     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   300                                                                  ECSEXT01
   301     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   302     12  DE-REPORTED.                                             ECSEXT01
   303         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   304         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   305         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   306     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   307     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   308                                                                  ECSEXT01
   309     12  DE-CNUM                           PIC X(7).              ECSEXT01
   310     12  DE-CHECK                          PIC X(7).              ECSEXT01
   311     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   312     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   313     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
   314     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   315         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   316         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   317         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   318         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   319         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   320         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   321         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   322                                                                  ECSEXT01
   323     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   324                                                                  ECSEXT01
   325     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   326     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   327     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   328     12  FILLER                            PIC XX.                ECSEXT01
   329     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   330                                                                  ECSEXT01
   331     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   332     12  DE-BENEFICIARY                    PIC X(10).
   333     12  filler redefines de-beneficiary.
   334         16  de-birth-date                 pic 9(11)  comp-3.
   335         16  f                             pic x(4).
   336     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   337     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   338     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   339     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   340     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   341     12  DE-CLM-CLASS                      PIC XX.
   342     12  DE-CLM-DEV                        PIC XXX.
   343     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   344     12  de-xycor-cert-seq                 pic x(3).
   345     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   346     12  DE-XYCOR-ACTION-CD                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   347     12  DE-XYCOR-STATUS                   PIC X.
   348     12  FILLER                            PIC X(4).              ECSEXT01
   349                                                                  ECSEXT01
   350     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   351                                                                  ECSEXT01
   352****************************************************************  ECSEXT01
   353*******               RESERVE EXTRACT                      *****  ECSEXT01
   354****************************************************************  ECSEXT01
   355     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   356     12  FILLER                            PIC X(334).            ECSEXT01
   357                                                                  ECSEXT01
   358     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   359         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   360         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   361                                                                  ECSEXT01
   362     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   363     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   364     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   365                                                                  ECSEXT01
   366     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   367                                                                  ECSEXT01
   368     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   369     12  DE-RSV-REPORTED.                                         ECSEXT01
   370         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   371         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
   372         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   373     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   374                                                                  ECSEXT01
   375     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   376     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   377     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   378                                                                  ECSEXT01
   379     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   380     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   381     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   382                                                                  ECSEXT01
   383     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   384                                                                  ECSEXT01
   385     12  DE-RATE-CLASS                     PIC XX.
   386     12  DE-DEV-CODE                       PIC XXX.
   387     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   388     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   389     12  FILLER                            PIC X(58).             ECSEXT01
   390                                                                  ECSEXT01
   391     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   392******************************************************************ECSEXT01
   393
   394 FD  FREEDOM-EXTRACT
   395     LABEL RECORDS ARE STANDARD
   396     RECORDING MODE IS F
   397     BLOCK CONTAINS 0 RECORDS.
   398 01  EXTRACT-RECORD      PIC X(250).
   399
   400 FD  CSI-FREEDOM-EXTRACT
   401     LABEL RECORDS ARE STANDARD
   402     RECORDING MODE IS F
   403     BLOCK CONTAINS 0 RECORDS.
   404 01  CSI-EXTRACT-RECORD          PIC X(250).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* FNB169.cbl
   405
   406 FD  CCC-FREEDOM-EXTRACT
   407     LABEL RECORDS ARE STANDARD
   408     RECORDING MODE IS F
   409     BLOCK CONTAINS 0 RECORDS.
   410 01  CCC-EXTRACT-RECORD          PIC X(250).
   411
   412 FD  ERACCT.
*  413     COPY ERCACCT.
   414******************************************************************04/19/98
   415*                                                                *ERCACCT
   416*                                                                *ERCACCT
   417*                            ERCACCT                             *   LV031
   418*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   419*                            VMOD=2.031                          *ERCACCT
   420*                                                                *ERCACCT
   421*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   422*                                                                *ERCACCT
   423*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   424*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   425*                                                                *ERCACCT
   426*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   427*                                                                *ERCACCT
   428*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   429*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   430*                                                                *ERCACCT
   431*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   432*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   433*                                                                *ERCACCT
   434*   LOG = NO                                                     *ERCACCT
   435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   436*                                                                *ERCACCT
   437*                                                                *ERCACCT
   438******************************************************************ERCACCT
   439*                   C H A N G E   L O G
   440*
   441* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   442*-----------------------------------------------------------------
   443*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   444* EFFECTIVE    NUMBER
   445*-----------------------------------------------------------------
   446* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   447* 092705    2005050300006  PEMA  ADD SPP LEASES
   448* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   449* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   450* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   451* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   452* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   453******************************************************************
   454                                                                  ERCACCT
   455 01  ACCOUNT-MASTER.                                              ERCACCT
   456     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   457         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   458                                                                  ERCACCT
   459     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   460         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   461         16  AM-MSTR-CNTRL.                                       ERCACCT
   462             20  AM-CONTROL-A.                                    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   463                 24  AM-CARRIER            PIC X.                 ERCACCT
   464                 24  AM-GROUPING.                                 ERCACCT
   465                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   466                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   467                 24  AM-STATE              PIC XX.                ERCACCT
   468                 24  AM-ACCOUNT.                                  ERCACCT
   469                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   470                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   471             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   472                                           PIC X(19).             ERCACCT
   473             20  AM-CNTRL-B.                                      ERCACCT
   474                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   475                 24  FILLER                PIC X(4).              ERCACCT
   476             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   477                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   478                                                                  ERCACCT
   479     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   480         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   481         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   482         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   483         16  AM-VG-STATE                   PIC XX.                ERCACCT
   484         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   485         16  AM-VG-DATE.                                          ERCACCT
   486             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   487             20  FILLER                    PIC X(4).              ERCACCT
   488         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   489                                           PIC 9(11)      COMP-3. ERCACCT
   490     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   491         16  FILLER                        PIC X(10).
   492         16  AM-VG-KEY3.
   493             20  AM-VG3-ACCOUNT            PIC X(10).
   494             20  AM-VG3-EXP-DT             PIC XX.
   495         16  FILLER                        PIC X(4).
   496     12  AM-MAINT-INFORMATION.                                    ERCACCT
   497         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   498         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   499         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   500         16  FILLER                        PIC XX.                ERCACCT
   501                                                                  ERCACCT
   502     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   503     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   504                                                                  ERCACCT
   505     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   506         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   507         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   508                                                                  ERCACCT
   509     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   510     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   511                                                                  ERCACCT
   512     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   513     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   514                                                                  ERCACCT
   515     12  AM-NAME                           PIC X(30).             ERCACCT
   516     12  AM-PERSON                         PIC X(30).             ERCACCT
   517     12  AM-ADDRS                          PIC X(30).             ERCACCT
   518     12  AM-CITY.
   519         16  AM-ADDR-CITY                  PIC X(28).
   520         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   521     12  AM-ZIP.                                                  ERCACCT
   522         16  AM-ZIP-PRIME.                                        ERCACCT
   523             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   524                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   525             20  FILLER                    PIC X(4).              ERCACCT
   526         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   527     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   528         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   529         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   530         16  FILLER                        PIC XXX.               ERCACCT
   531     12  AM-TEL-NO.                                               ERCACCT
   532         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   533         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   534         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   535     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   536         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   537         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   538                                                                  ERCACCT
   539     12  AM-COMM-STRUCTURE.                                       ERCACCT
   540         16  AM-DEFN-1.                                           ERCACCT
   541             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   542                 24  AM-AGT.                                      ERCACCT
   543                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   544                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   545                 24  AM-COM-TYP            PIC X.                 ERCACCT
   546                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   547                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   548                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   549                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   550                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   551                 24  AM-GL-CODES           PIC X.                 ERCACCT
   552                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   553                 24  FILLER                PIC X(01).             ERCACCT
   554         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   555             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   556                 24  FILLER                PIC X(11).             ERCACCT
   557                 24  AM-L-COMA             PIC XXX.               ERCACCT
   558                 24  AM-J-COMA             PIC XXX.               ERCACCT
   559                 24  AM-A-COMA             PIC XXX.               ERCACCT
   560                 24  FILLER                PIC X(6).              ERCACCT
   561                                                                  ERCACCT
   562     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   563         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   564                                                                  ERCACCT
   565     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   566                                                                  ERCACCT
   567     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   568         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   569         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   570     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   571         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   572         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   573     12  AM-GPCD                           PIC 99.                ERCACCT
   574     12  AM-IG                             PIC X.                 ERCACCT
   575         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   576         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   577     12  AM-STATUS                         PIC X.                 ERCACCT
   578         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   579         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   580         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   581         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   582         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   583         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   584     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   585     12  AM-ID-NO                          PIC X(11).             ERCACCT
   586                                                                  ERCACCT
   587     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   588     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   589     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   590     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   591     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   592     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   593     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   594     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   595     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   596                                                                  ERCACCT
   597     12  AM-USER-FIELDS.                                          ERCACCT
   598         16  AM-FLD-1                      PIC XX.                ERCACCT
   599         16  AM-FLD-2                      PIC XX.                ERCACCT
   600         16  AM-FLD-3                      PIC XX.                ERCACCT
   601         16  AM-FLD-4                      PIC XX.                ERCACCT
   602         16  AM-FLD-5                      PIC XX.                ERCACCT
   603                                                                  ERCACCT
   604     12  AM-1ST-PROD-DATE.                                        ERCACCT
   605         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   606         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   607         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   608     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   609     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   610         16  AM-PUR-YR                     PIC XX.                ERCACCT
   611         16  AM-PUR-MO                     PIC XX.                ERCACCT
   612         16  AM-PUR-DA                     PIC XX.                ERCACCT
   613     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   614     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   615     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   616     12  AM-INACTIVE-DATE.                                        ERCACCT
   617         16  AM-INA-MO                     PIC 99.                ERCACCT
   618         16  AM-INA-DA                     PIC 99.                ERCACCT
   619         16  AM-INA-YR                     PIC 99.                ERCACCT
   620     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   621                                                                  ERCACCT
   622     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   623     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   624                                                                  ERCACCT
   625     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   626         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   627         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   628         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   629         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   630                                                                  ERCACCT
   631     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   632         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   633         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   634                                                                  ERCACCT
   635     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   636                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   637     12  AM-OVER-SHORT.                                           ERCACCT
   638         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   639         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   640                                                                  ERCACCT
   641     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   642     12  AM-DCC-CLP-STATE                  PIC XX.
   643                                                                  ERCACCT
   644     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   645     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   646                                                                  ERCACCT
   647     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   648     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   649     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   650     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   651     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   652     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   653     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   654     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   655     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   656     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   657     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   658     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   659     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   660     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   661     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   662     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   663                                                                  ERCACCT
   664     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   665                                                                  ERCACCT
   666     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   667     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   668                                                                  ERCACCT
   669     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   670     12  AM-EARN-METHODS.                                         ERCACCT
   671         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   672             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   673             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   674             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   675             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   676         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   677             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   678             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   679             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   680             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   681         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   682             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   683             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   684             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   685             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   686             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   687             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   688                                                                  ERCACCT
   689     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   690     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   691     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   692                                                                  ERCACCT
   693     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   694     12  AM-RET-P-E                        PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   695     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   696     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   697     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   698     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   699         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   700         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   701     12  AM-RETRO-EARNINGS.                                       ERCACCT
   702         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   703         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   704         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   705     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   706         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   707         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   708     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   709         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   710         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   711         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   712     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   713     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   714                                                                  ERCACCT
   715     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   716         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   717         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   718         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   719         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   720         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   721                                                                  ERCACCT
   722     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   723                                                                  ERCACCT
   724     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   725                                                                  ERCACCT
   726     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   727         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   728                                                                  ERCACCT
   729     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   730         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   731         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   732                                                                  ERCACCT
   733     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   734         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   735                                                                  ERCACCT
   736     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   737         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   738         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   739                                                                  ERCACCT
   740     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   741                                                                  ERCACCT
   742     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   743     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   744     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   745     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   746     12  AM-DCC-UEF-STATE                  PIC XX.
   747     12  FILLER                            PIC XXX.
   748     12  AM-REPORT-CODE-3                  PIC X(10).
   749*    12  FILLER                            PIC X(22).             ERCACCT
   750                                                                  ERCACCT
   751     12  AM-RESERVE-DATE.                                         ERCACCT
   752         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   753         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   754         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   755                                                                  ERCACCT
   756     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   757     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   758         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   759         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   760         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   761         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   762                                                                  ERCACCT
   763     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   764         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   765         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   766         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   767         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   768                                                                  ERCACCT
   769     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   770         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   771             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   772             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   773             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   774             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   775             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   776             20  FILLER                    PIC XX.                ERCACCT
   777         16  FILLER                        PIC X(80).             ERCACCT
   778                                                                  ERCACCT
   779     12  AM-TRANSFER-DATA.                                        ERCACCT
   780         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   781             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   782             20  AM-TRNFROM-GROUPING.                             ERCACCT
   783                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   784                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   785             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   786             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   787                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   788                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   789             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   790         16  AM-TRANSFERRED-TO.                                   ERCACCT
   791             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   792             20  AM-TRNTO-GROUPING.                               ERCACCT
   793                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   794                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   795             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   796             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   797                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   798                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   799             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   800         16  FILLER                        PIC X(10).             ERCACCT
   801                                                                  ERCACCT
   802     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   803                                                                  ERCACCT
   804     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   805         16  AM-DEFN-1-SAVED.                                     ERCACCT
   806             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   807                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   808                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   809                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   810                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   811                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   812                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   813                 24  FILLER                PIC X.                 ERCACCT
   814                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   815                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   816                 24  FILLER                PIC X.                 ERCACCT
   817         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   818             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   819                 24  FILLER                PIC X(11).             ERCACCT
   820                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   821                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   822                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   823                 24  FILLER                PIC X(6).              ERCACCT
   824                                                                  ERCACCT
   825     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   826         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   827            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   828            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   829            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   830                                                                  ERCACCT
   831     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   832     12  FILLER                            PIC X(120).            ERCACCT
   833                                                                  ERCACCT
   834     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   835         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   836         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   837             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   838             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   839                                                          COMP-3. ERCACCT
   840             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   841                                                          COMP-3. ERCACCT
   842         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   843             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   844             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   845                                                          COMP-3. ERCACCT
   846             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   847                                                          COMP-3. ERCACCT
   848                                                                  ERCACCT
   849     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   850         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   851         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   852         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   853         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   854             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   855                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   856                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   857             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   858                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   859                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   860             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   861                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   862                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   863         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   864             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   865                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   866                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   867                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   868             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   869                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   870                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   871             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   872                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   873                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   874                                                                  ERCACCT
   875     12  AM-COMMENTS.                                             ERCACCT
   876         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   877                                                                  ERCACCT
   878     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   879         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   880         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   881         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   882         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   883         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   884             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   885             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   886             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   887             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   888         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   889             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   890             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   891             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   892         16  FILLER                        PIC X(102).            ERCACCT
   893                                                                  ERCACCT
   894     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   895         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   896             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   897             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   898             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   899             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   900             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   901         16  FILLER                          PIC X(10).           ERCACCT
   902******************************************************************ERCACCT
   903
   904 FD  ERPDEF.
   905
*  906                             COPY ERCPDEF.
   907******************************************************************
   908*                                                                *
   909*                                                                *
   910*                            ERCPDEF.                            *
   911*                                                                *
   912*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   913*                                                                *
   914*    FILE TYPE = VSAM,KSDS                                       *
   915*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   916*                                                                *
   917*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   918*                                                                *
   919*    LOG = YES                                                   *
   920*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   921******************************************************************
   922 01  PRODUCT-MASTER.
   923    12  PD-RECORD-ID                 PIC X(02).
   924        88  VALID-PD-ID                  VALUE 'PD'.
   925
   926    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* FNB169.cbl (/apps/prod/cid1p/copy/ERCPDEF)
   927        16  PD-COMPANY-CD            PIC X.
   928        16  PD-STATE                 PIC XX.
   929        16  PD-PRODUCT-CD            PIC XXX.
   930        16  PD-FILLER                PIC X(7).
   931        16  PD-BEN-TYPE              PIC X.
   932        16  PD-BEN-CODE              PIC XX.
   933        16  PD-PROD-EXP-DT           PIC XX.
   934
   935    12  FILLER                       PIC X(50).
   936
   937    12  PD-PRODUCT-DATA OCCURS 8.
   938        16  PD-PROD-CODE             PIC X.
   939            88  PD-PROD-LIFE           VALUE 'L'.
   940            88  PD-PROD-PROP           VALUE 'P'.
   941            88  PD-PROD-AH             VALUE 'A'.
   942            88  PD-PROD-IU             VALUE 'I'.
   943            88  PD-PROD-GAP            VALUE 'G'.
   944        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   945        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   946        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   947        16  PD-MAX-TERM              PIC S999        COMP-3.
   948        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   949        16  FILLER                   PIC X.
   950        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   951        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   952        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   953        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   954        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   955        16  PD-REC-CRIT-PERIOD       PIC X.
   956        16  PD-RTW-MOS               PIC 99.
   957        16  FILLER                   PIC X(5).
   958
   959    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   960
   961    12  PD-TERM-LIMITS OCCURS 15.
   962        16  PD-LOW-TERM              PIC S999        COMP-3.
   963        16  PD-HI-TERM               PIC S999        COMP-3.
   964
   965*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   966    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   967        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   968        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   969
   970    12  PD-EARN-FACTORS.
   971        16  FILLER OCCURS 15.
   972            20  FILLER OCCURS 15.
   973                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   974
   975    12  PD-PRODUCT-DESC              PIC X(80).
   976    12  PD-TRUNCATED                 PIC X.
   977    12  FILLER                       PIC X(59).
   978
   979    12  PD-MAINT-INFORMATION.
   980        16  PD-LAST-MAINT-DT         PIC X(02).
   981        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   982        16  PD-LAST-MAINT-BY         PIC X(04).
   983
   984 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* FNB169.cbl
*  985     COPY ELCDTEFD.
   986******************************************************************04/15/98
   987*                                                                *ELCDTEFD
   988*                                                                *ELCDTEFD
   989*                            ELCDTEFD.                           *   LV002
   990*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   991*                            VMOD=2.007                          *   CL**2
   992*                                                                *ELCDTEFD
   993******************************************************************ELCDTEFD
   994     BLOCK CONTAINS 0 RECORDS
   995     RECORDING MODE F.                                            ELCDTEFD
   996                                                                  ELCDTEFD
   997 01  DATE-DISK.                                                   ELCDTEFD
   998     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   999     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1000     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1001     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1002     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1003     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1004     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1005                                                                  ELCDTEFD
  1006 01  DATE-DISK-R.                                                 ELCDTEFD
  1007     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1008     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1009                                     PIC  X(32).                  ELCDTEFD
  1010                                                                  ELCDTEFD
  1011 01  DATE-DISK-T.                                                 ELCDTEFD
  1012     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1013     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1014                                     PIC  X(48).                  ELCDTEFD
  1015                                                                  ELCDTEFD
  1016 01  DATE-DISK-M.                                                 ELCDTEFD
  1017     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1018     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1019                                     PIC  X(48).                  ELCDTEFD
  1020                                                                  ELCDTEFD
  1021 01  DATE-DISK-P.                                                 ELCDTEFD
  1022     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1023     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1024     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1025     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1026         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1027                                     PIC  X.                      ELCDTEFD
  1028         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1029     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1030         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1031             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1032             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1033             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1034             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1035         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1036                                                                  ELCDTEFD
  1037 01  DATE-DISK-E.                                                 ELCDTEFD
  1038     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1039     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1040                                     PIC  X(4).                   ELCDTEFD
  1041                                                                  ELCDTEFD
  1042 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1043     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1044     12  DD-CARR1-SECPAY-SW          PIC  X.
  1045     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1046     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1047     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1048     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1049     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1050     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1051     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1052     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1053     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1054     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1055     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1056     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1057     12  DD-CARR2-SECPAY-SW          PIC  X.
  1058     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1059                                                                  ELCDTEFD
  1060 01  DATE-DISK-OPT.                                               ELCDTEFD
  1061     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1062     12  DD-TLR-DATA.                                             ELCDTEFD
  1063         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1064                                     PIC  X(03).                  ELCDTEFD
  1065     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1066         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1067                                     PIC  X(06).                  ELCDTEFD
  1068     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1069         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1070                                     PIC  X(07).                  ELCDTEFD
  1071         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1072     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1073                                     PIC  X(96).                  ELCDTEFD
  1074******************************************************************ELCDTEFD
  1075
  1076
  1077 WORKING-STORAGE SECTION.
  1078
  1079 77  B-SUB                   PIC S9(4)   COMP.
  1080 77  D1                      PIC S999 COMP-3 VALUE +0.
  1081 77  P1                      PIC S999 COMP-3 VALUE +0.
  1082 77  P2                      PIC S999 COMP-3 VALUE +0.
  1083 77  CNC-WK                  PIC S9(7)V99 COMP-3 VALUE +0.
  1084 77  WS-MONTH                PIC S999     COMP-3 VALUE +0.
  1085 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  1086 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  1087 77  DD-IU-SW                    PIC X   VALUE ' '.
  1088     88  DD-IU-PRESENT                 VALUE 'Y'.
  1089 77  WS-FACT-CERT            PIC X(11) VALUE SPACES.
  1090 77  A-OW                        PIC S9(7)V99 COMP-3 VALUE +0.
  1091 77  W-FACTOR            PIC S9(09)V9(08) COMP-3 VALUE +0.
  1092 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  1093 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  1094 77  WS-DDF-TERM             PIC S999 COMP-3 VALUE +0.
  1095
  1096 01  WS-DCC-PRODUCT-CODE         PIC XXX  VALUE SPACES.
  1097 01  AGT-LEVEL                 COMP   PIC 9(04).
  1098 01  WS-CNC-FACT               COMP-3 PIC S9(03)V9(07) VALUE +0.
  1099 01  WS-LF-CNC-FACT            COMP-3 PIC S9(03)V9(07) VALUE +0.
  1100 01  WS-WORK-AMT               COMP-3 PIC S9(7)V99 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* FNB169.cbl
  1101 01  WS-LF-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1102 01  WS-AH-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1103 01  TEST-DISP-FX-AMT PIC ZZZZZZZZ9.99.
  1104 01  TEST-DISP-L-PC PIC ZZ.ZZZZZ.
  1105 01  TEST-DISP-A-PC PIC ZZ.ZZZZZ.
  1106 01  FILLER.
  1107     05  WS-ZERO               COMP-3 PIC S9(03) VALUE +0.
  1108     05  WS-ABEND-MESSAGE             PIC X(80)  VALUE SPACES.
  1109     05  PGM-SUB               COMP   PIC S9(04) VALUE +310.
  1110     05  WS-RETURN-CODE        COMP-3 PIC S9(03) VALUE +0.
  1111
  1112     05  DETEXT-STATUS                PIC X(02)  VALUE '00'.
  1113         88  EOF-DETEXT                          VALUE '10'.
  1114
  1115     05  DATE-SW                      PIC X(01)  VALUE ' '.
  1116         88  VALID-DATE                          VALUE 'V'.
  1117
  1118     05  VALID-RECORD-SW              PIC X(01)  VALUE '0'.
  1119         88  VALID-RECORD                        VALUE '1'.
  1120
  1121     05  END-OF-SEARCH-SW             PIC X(01)  VALUE '0'.
  1122         88  END-OF-SEARCH                       VALUE '1'.
  1123
  1124     05  ERACCT-STATUS                PIC X(02)  VALUE '00'.
  1125     05  ERPDEF-FILE-STATUS           PIC XX     VALUE '00'.
  1126
  1127
  1128 01  DCC-DDF-WORK-AREA.
  1129     05  F OCCURS 800.
  1130         10  DD-STATE                 PIC XX.
  1131         10  DD-PRODUCT-CD            PIC XXX.
  1132         10  DD-FILLER                PIC X(7).
  1133         10  DD-BEN-TYPE              PIC X.
  1134         10  DD-BEN-CODE              PIC XX.
  1135         10  DD-PROD-EXP-DT           PIC XX.
  1136         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  1137         10  DD-PROD-DATA OCCURS 8.
  1138             15  DD-PROD-CODE         PIC X.
  1139         10  DD-EARN-FACTORS.
  1140             15  F OCCURS 15.
  1141                 20  F OCCURS 15.
  1142                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1143         10  DD-TRUNCATED             PIC X.
  1144
  1145 01  WS-EXTRACT-RECORD.
* 1146     COPY FNC022.
  1147     05  FX-COMMON-SECTION.                                       00010001
  1148         10  FX-SYSTEM             PIC X(10).                     00020001
  1149         10  FX-SOURCE-CODE        PIC X(6).                      00030001
  1150         10  FX-DIVISION           PIC X(2).                      00040001
  1151         10  FX-TRAN-TYPE          PIC X(2).                      00050001
  1152         10  FX-SUB-TYPE           PIC X(2).                      00060001
  1153         10  FX-CLM-RES            PIC X(2).                      00070001
  1154         10  FX-ANN-STMT           PIC X(3).                      00080001
  1155         10  FX-PLAN-CODE          PIC X(6).                      00090001
  1156         10  FX-FORM               PIC X(3).                      00091001
  1157         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
  1158         10  FX-POSTING-DATE       PIC X(8).                      00093001
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* FNB169.cbl (/apps/prod/cid1p/copy/FNC022)
  1159         10  FX-POLICY-NO          PIC X(10).                     00094001
  1160         10  FX-CITY               PIC X(30).                     00095002
  1161         10  FX-STATE              PIC X(2).                      00095102
  1162         10  FX-ZIP-CODE           PIC X(9).                      00096001
  1163         10  FX-LOC-CODE           PIC X.                         00096102
  1164         10  FX-FY-REN             PIC X.                         00097001
  1165         10  FX-AGENT-01           PIC X(9).                      00098001
  1166         10  FX-AGENT-50           PIC X(9).                      00099001
  1167         10  FX-COST-CENTER        PIC X(4).                      00100001
  1168         10  FX-TAXABLE            PIC X.                         00110004
  1169         10  FX-DISTR              PIC X(2).                      00120001
  1170         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
  1171         10  FX-DESCRIPTION        PIC X(30).                     00140001
  1172         10  FX-REFERENCE          PIC X(10).                     00150001
  1173         10  FX-SUSPENSE           PIC X(15).                     00151002
  1174         10  FX-AMOUNT             PIC S9(10)V99                  00160001
  1175                                   SIGN IS TRAILING SEPARATE.     00170001
  1176                                                                  00180001
  1177     05  FX-CLAIM-SECTION.                                        00190001
  1178         10  FX-CLAIM-NO           PIC X(10).                     00200001
  1179         10  FX-CLAIM-TYPE         PIC X.                         00210001
  1180         10  FX-DRAFT-NO           PIC X(10).                     00220001
  1181         10  FX-DRAFT-STATUS       PIC X.                         00230001
  1182         10  FX-TAX-ID             PIC X(10).                     00240001
  1183         10  FILLER                PIC X(10).                     00250003
  1184                                                                  00290001
  1185
  1186
  1187 01  FNX001-PARMS.
  1188     05  FNX001-DATA                  PIC X(50).
  1189     05  FNX001-CITY                  PIC X(30).
  1190     05  FNX001-STATE                 PIC X(02).
  1191     05  FNX001-ZIP                   PIC X(09).
  1192
  1193 01  SYSTEM-DATE.
  1194     05  SYS-MO                       PIC 9(02).
  1195     05  SYS-DA                       PIC 9(02).
  1196     05  SYS-CCYY                     PIC 9(04).
  1197
  1198***** FUNCTION-DATE COPYBOOK
* 1199 COPY ELCFUNDT.
  1200***************************************************************** 12/03/98
  1201*                                                               * ELCFUNDT
  1202*                            ELCFUNDT.                          *    LV004
  1203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1204*                            VMOD=2.001                         * ELCFUNDT
  1205*                                                               * ELCFUNDT
  1206*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1207*                                                               * ELCFUNDT
  1208***************************************************************** ELCFUNDT
  1209                                                                  ELCFUNDT
  1210                                                                  ELCFUNDT
  1211 01  FUNCTION-DATE.                                                  CL**2
  1212     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  1213     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  1214         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  1215         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  1216             15  WS-FN-CC          PIC 99.                           CL**3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* FNB169.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
  1217             15  WS-FN-YR          PIC 99.                           CL**3
  1218         10  WS-FN-MO              PIC 99.                           CL**3
  1219         10  WS-FN-DA              PIC 99.                           CL**3
  1220     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  1221     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  1222     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  1223     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  1224     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  1225         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  1226         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  1227         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  1228     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  1229     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  1230
  1231
  1232***** STATE EDIT TABLE
* 1233 COPY FNC018.
  1234***************************************************************** 00020002
  1235*                                                               * 00030002
  1236*                     STATE CODE TABLE                          * 00040002
  1237*                                                               * 00050002
  1238*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
  1239*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
  1240*                                                               * 00080002
  1241***************************************************************** 00090002
  1242*                                                                 00100002
  1243 01  STATE-VALUES.                                                00110002
  1244     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
  1245     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
  1246     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
  1247     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
  1248     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
  1249     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
  1250     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
  1251     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
  1252     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
  1253     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
  1254     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
  1255     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
  1256     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
  1257     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
  1258     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
  1259     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
  1260     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
  1261     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
  1262     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
  1263     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
  1264     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
  1265     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
  1266     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
  1267     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
  1268     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
  1269     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
  1270     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
  1271     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
  1272     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
  1273     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
  1274     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* FNB169.cbl (/apps/prod/cid1p/copy/FNC018)
  1275     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
  1276     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
  1277     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
  1278     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
  1279     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
  1280     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
  1281     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
  1282     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
  1283     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
  1284     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
  1285     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
  1286     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
  1287     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
  1288     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
  1289     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
  1290     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
  1291     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
  1292     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
  1293     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
  1294     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
  1295     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
  1296     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
  1297     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
  1298     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
  1299     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
  1300     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
  1301     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
  1302     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
  1303     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
  1304                                                                  00720002
  1305 01  FILLER REDEFINES STATE-VALUES.                               00730002
  1306     05  STATE-TABLE                                              00740002
  1307             OCCURS 60 TIMES                                      00750002
  1308             ASCENDING KEY IS ST-STATE                            00760002
  1309             INDEXED BY ST-INDEX.                                 00770002
  1310         10  ST-STATE          PIC XX.                            00780002
  1311         10  ST-ALT-STATE      PIC XX.                            00790002
  1312         10  ST-NAME           PIC X(20).                         00800002
  1313                                                                  00810002
  1315
* 1316 COPY ELCDTECX.
  1317******************************************************************06/05/98
  1318*                                                                *ELCDTECX
  1319*                            ELCDTECX.                           *   LV005
  1320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1321*                            VMOD=2.015                          *ELCDTECX
  1322*                                                                *ELCDTECX
  1323*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1324*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1325*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1326*                                                                *ELCDTECX
  1327******************************************************************ELCDTECX
  1328******************************************************************
  1329*                   C H A N G E   L O G
  1330*
  1331* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1332*-----------------------------------------------------------------
  1333*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1334* EFFECTIVE    NUMBER
  1335*-----------------------------------------------------------------
  1336* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1337*                                  BENEFIT CODES FROM 300 TO 900
  1338* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1339* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1340******************************************************************
  1341 01  DATE-CARD.                                                   ELCDTECX
  1342     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1343     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1344     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1345     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1346     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1347     12  EP-SW                       PIC  X.                      ELCDTECX
  1348         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1349     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1350         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1351     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1352     12  RUN-CENTURY.                                             ELCDTECX
  1353         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1354     12  FILLER                      PIC  X.                         CL**4
  1355     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1356     12  FILLER                      PIC  XXX.                    ELCDTECX
  1357     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1358                                                                  ELCDTECX
  1359 01  FILLER                          PIC  X(7)                       CL**6
  1360                                          VALUE 'OPTIONS'.        ELCDTECX
  1361 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1362     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1363     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1364     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1365         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1366         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1367     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1368     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1369     12  FILLER                      PIC  X.                      ELCDTECX
  1370     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1371     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1372     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1373     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1374     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1375     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1376     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1377     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1378     12  FILLER                      PIC  X.                      ELCDTECX
  1379     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1380     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1381     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1382     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1383     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1384     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1385     12  FILLER                      PIC  X.                      ELCDTECX
  1386     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1387     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1388     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1389     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1390     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1391     12  DTE-R78                     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1392     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1393     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1394     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1395     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1396     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1397     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1398     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1399                                     PIC  X.                      ELCDTECX
  1400         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1401                                                 ' '.             ELCDTECX
  1402         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1403         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1404     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1405         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1406         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1407     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1408     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1409                                     PIC  9.                         CL**4
  1410     12  DTE-SYSTEM.                                              ELCDTECX
  1411         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1412         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1413         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1414         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1415         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1416         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1417         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1418         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1419         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1420         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1421         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1422         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1423         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1424         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1425         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1426         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1427         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1428         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1429         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1430         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1431         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1432         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1433         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1434         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1435         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1436         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1437     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1438         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1439                                     PIC  X.                      ELCDTECX
  1440     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1441                                                                  ELCDTECX
  1442 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1443     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1444     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1445     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1446*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1447     12  FILLER                      PIC  X.                      ELCDTECX
  1448     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1449     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1450     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1451     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1452     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1453     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1454     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1455                                                                  ELCDTECX
  1456     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1457     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1458     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1459     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1460                                                                  ELCDTECX
  1461     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1462     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1463     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1464     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1465                                                                  ELCDTECX
  1466     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1467     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1468                                                                  ELCDTECX
  1469     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1470     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1471                                                                  ELCDTECX
  1472     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1473                                                                  ELCDTECX
  1474 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1475     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1476     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1477     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1478     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1479     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1480     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1481     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1482                                                                  ELCDTECX
  1483 01  FILLER                          PIC  X(12)                   ELCDTECX
  1484                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1485 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1486     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1487         16  CNT-ID                  PIC  X.                      ELCDTECX
  1488         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1489                                                                  ELCDTECX
  1490 01  FILLER                          PIC  X(11)                   ELCDTECX
  1491                                          VALUE 'STATE NAMES'.    ELCDTECX
  1492 01  STATE-NAMES.                                                 ELCDTECX
  1493     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1494         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1495         16  STATE-PIC1.                                          ELCDTECX
  1496             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1497             20  FILLER              PIC  XXX.                    ELCDTECX
  1498             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1499             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1500             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1501             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1502                                                                  ELCDTECX
  1503 01  FILLER                          PIC  X(13)                   ELCDTECX
  1504                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1505 01  CARRIER-NAMES.                                               ELCDTECX
  1506     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1507         16  CARRIER-SUB             PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1508         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1509         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1510         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1511         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1512         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1513*        16  FILLER                  PIC  X.                      ELCDTECX
  1514         16  CARRIER-SEC-PAY         PIC  X.
  1515             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1516                                                                  ELCDTECX
  1517 01  FILLER                          PIC  X(9)                       CL**6
  1518                                          VALUE 'INS TYPES'.      ELCDTECX
  1519 01  CLAS-INS-TYPES.                                              ELCDTECX
  1520*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1521     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1522         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1523         16  CLAS-I-AB3.                                          ELCDTECX
  1524             20  FILLER              PIC  X.                      ELCDTECX
  1525             20  CLAS-I-AB2.                                      ELCDTECX
  1526                 24  FILLER          PIC  X.                      ELCDTECX
  1527                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1528         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1529             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1530             20  FILLER              PIC  X.                         CL**4
  1531         16  CLAS-I-AB10.                                         ELCDTECX
  1532             20  FILLER              PIC  X(9).                   ELCDTECX
  1533             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1534         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1535         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1536         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1537         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1538             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1539         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1540         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1541         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1542         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1543         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1544         16  FILLER                  PIC  X(05).
  1545                                                                  ELCDTECX
  1546 01  FILLER                          PIC  X(16)                   ELCDTECX
  1547                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1548 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1549     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1550                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1551         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1552         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1553         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1554         16  CLAS-MORT-DESC.                                      ELCDTECX
  1555             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1556             20  FILLER              PIC  XX.                        CL**5
  1557             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1558             20  FILLER              PIC  X.                         CL**5
  1559             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1560             20  FILLER              PIC  X.                         CL**5
  1561             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1562             20  FILLER              PIC  X.                         CL**5
  1563             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1564             20  FILLER              PIC  X(5).                      CL**6
  1565                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1566 01  FILLER                          PIC  X(15)                   ELCDTECX
  1567                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1568 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1569     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1570         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1571         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1572         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1573         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1574         16  FILLER                  PIC  X(4).                      CL**6
  1575                                                                  ELCDTECX
  1576 01  FILLER                          PIC  X(7)                       CL**6
  1577                                     VALUE 'INDEXES'.             ELCDTECX
  1578 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1579     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1580     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1581     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1582     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1583     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1584     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1585     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1586     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1587     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1588     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1589     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1590     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1591     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1592     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1593     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1594     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1595     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1596                                                                  ELCDTECX
  1597 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1598     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1599     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1600     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1601     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1602     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1603     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1604     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1605     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1606     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1607     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1608     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1609                                                                  ELCDTECX
  1610 01  FILLER                          PIC  X(13)                   ELCDTECX
  1611                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1612 01  CLAS-MISC.                                                   ELCDTECX
  1613     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1614         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1615         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1616         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1617     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1618     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1619     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1620     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1621     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1622     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1623     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1624     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1625     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1626     12  STATE-L                     PIC  XX.                     ELCDTECX
  1627     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1628     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1629     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1630         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1631         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1632     12  DTE-ABEND-WORK.                                          ELCDTECX
  1633         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1634         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1635                                                                  ELCDTECX
  1636 01  FILLER                          PIC  X(12)                   ELCDTECX
  1637                                     VALUE 'WORKING DATE'.        ELCDTECX
  1638 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1639     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1640         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1641         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1642         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1643     12  WS-CURRENT-DATE.                                         ELCDTECX
  1644         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1645         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1646         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1647         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1648         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1649     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1650         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1651         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1652                                                                  ELCDTECX
  1653 01  FILLER                          PIC  X(12)                   ELCDTECX
  1654                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1655 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1656     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1657         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1658         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1659         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1660                                                                  ELCDTECX
  1661 01  FILLER                          PIC  X(10)                   ELCDTECX
  1662                                     VALUE 'STATE TLRS'.          ELCDTECX
  1663 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1664     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1665         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1666         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1667                                                                  ELCDTECX
  1668 01  FILLER                          PIC  X(13)                   ELCDTECX
  1669                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1670 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1671     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1672         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1673                                                                  ELCDTECX
  1674 01  FILLER                          PIC  X(13)                   ELCDTECX
  1675                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1676 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1677     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1678     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1679     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1680                                     PIC  X.                         CL**5
  1681     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1682     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1683     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1684     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1685     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1686     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1687     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1688     12  FILLER                      PIC  X(75).                  ELCDTECX
  1689******************************************************************ELCDTECX
  1690*01  MISC-CARR-PCT-DATA.                                          00001521
  1691*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1692*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1693*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1694*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1695*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1696*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1697******************************************************************ELCDTECX
* 1698 COPY ELCDTEVR.
  1699***************************************************************** 04/15/98
  1700*                                                                *ELCDTEVR
  1701*                                                                *ELCDTEVR
  1702*                            ELCDTEVR.                           *   LV003
  1703*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1704*                            VMOD=2.001                          *   CL**2
  1705*                                                                *ELCDTEVR
  1706*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1707*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1708*                                                                *ELCDTEVR
  1709******************************************************************ELCDTEVR
  1710 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1711     05  WS-RUN-DATE.                                             ELCDTEVR
  1712         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1713         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1714         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1715             15  RUN-CC              PIC  99.                     ELCDTEVR
  1716             15  RUN-YR              PIC  99.                     ELCDTEVR
  1717         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1718         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1719     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1720            WS-RUN-DATE              PIC 9(11).                      CL**2
  1721     05  WS-EP-DT.                                                ELCDTEVR
  1722         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1723         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1724         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1725             15  EP-CC               PIC  99.                     ELCDTEVR
  1726             15  EP-YR               PIC  99.                     ELCDTEVR
  1727         10  EP-MO                   PIC  99.                     ELCDTEVR
  1728         10  EP-DA                   PIC  99.                     ELCDTEVR
  1729     05  WS-EP-DT-N REDEFINES                                        CL**2
  1730            WS-EP-DT                 PIC 9(11).                      CL**2
  1731     05  WS-DTE-CONV-DT.                                             CL**4
  1732         10  FILLER                  PIC  9(03).                     CL**4
  1733         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1734         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1735             15  DTE-CONV-CC         PIC  99.                        CL**4
  1736             15  DTE-CONV-YR         PIC  99.                        CL**4
  1737         10  DTE-CONV-MO             PIC  99.                        CL**4
  1738         10  DTE-CONV-DA             PIC  99.                        CL**4
  1739     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1740            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1741 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1742     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1743         10  FILLER                            PIC 999.           ELCDTEVR
  1744         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1745         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1746             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1747             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1748         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1749         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1750     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1751            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1752     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1753         10  FILLER                            PIC 999.           ELCDTEVR
  1754         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1755         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1756         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1757         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1758     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1759            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1760 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1761     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1762         10  FILLER                            PIC 999.           ELCDTEVR
  1763         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1764         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1765             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1766             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1767         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1768         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1769     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1770            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1771     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1772         10  FILLER                            PIC 999.           ELCDTEVR
  1773         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1774         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1775             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1776             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1777         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1778         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1779     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1780            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1781     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1782         10  FILLER                            PIC 999.           ELCDTEVR
  1783         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1784         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1785             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1786             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1787         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1788         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1789     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1790            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1791 01  WS-RATE-RECORD.                                              ELCDTEVR
  1792         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1793             10  FILLER                        PIC 999.           ELCDTEVR
  1794             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1795             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1796                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1797                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1798             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1799             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1800         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1801                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1802
  1803 LINKAGE SECTION.
  1804
  1805 01  PARM.
  1806     05  PARM-LENGTH                  PIC S9(04) COMP.
  1807     05  CYCLE-DATE                   PIC X(08).
  1808
  1809
  1810
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* FNB169.cbl
  1812
  1813 PROCEDURE DIVISION USING PARM.
  1814
  1815*************************************************************
* 1816 COPY ELCDTERX.
  1817******************************************************************04/15/98
  1818*                                                                *ELCDTERX
  1819*                                                                *ELCDTERX
  1820*                            ELCDTERX.                           *   LV002
  1821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1822*                            VMOD=2.007                          *ELCDTERX
  1823*                                                                *ELCDTERX
  1824*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1825*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1826*      = ELCDTEFD)                                               *ELCDTERX
  1827*                                                                *ELCDTERX
  1828******************************************************************ELCDTERX
  1829                                                                  ELCDTERX
  1830     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1831                                                                  ELCDTERX
  1832     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1833     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1834     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1835                                                                  ELCDTERX
  1836     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1837                                                                  ELCDTERX
  1838******************************************************************ELCDTERX
  1839*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1840*          WARNING MESSAGES.                                      ELCDTERX
  1841******************************************************************ELCDTERX
  1842     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1843         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1844                                                                  ELCDTERX
  1845     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1846                                                                  ELCDTERX
  1847     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1848                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1849                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1850                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1851                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1852                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1853                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1854                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1855                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1856                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1857                                                                  ELCDTERX
  1858     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1859                                                                  ELCDTERX
  1860     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1861                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1862                                                                  ELCDTERX
  1863     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1864     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1865     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1866     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1867                                                                  ELCDTERX
  1868     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1869         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1870     ELSE                                                         ELCDTERX
  1871         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1872                                                                  ELCDTERX
  1873     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1874         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1875     ELSE                                                         ELCDTERX
  1876         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1877                                                                  ELCDTERX
  1878 0005-READ--CARD.                                                 ELCDTERX
  1879     READ DISK-DATE                                               ELCDTERX
  1880         AT END CLOSE DISK-DATE                                   ELCDTERX
  1881             GO TO 0060-READ--TEST.                               ELCDTERX
  1882                                                                  ELCDTERX
  1883     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1884                                                                  ELCDTERX
  1885     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1886         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1887         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1888         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1889         GO TO 0005-READ--CARD.                                   ELCDTERX
  1890                                                                  ELCDTERX
  1891     IF DD-ID = 'CLAD'                                            ELCDTERX
  1892         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1893         GO TO 0005-READ--CARD.                                   ELCDTERX
  1894                                                                  ELCDTERX
  1895     IF DD-ID = 'CLAX'                                            ELCDTERX
  1896         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1897         GO TO 0005-READ--CARD.                                   ELCDTERX
  1898                                                                  ELCDTERX
  1899     IF DD-ID = 'CLAF'                                            ELCDTERX
  1900         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1901         GO TO 0005-READ--CARD.                                   ELCDTERX
  1902                                                                  ELCDTERX
  1903     IF DD-ID = 'CLAC'                                            ELCDTERX
  1904         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1905                                                                  ELCDTERX
  1906     IF DD-ID = 'CARR'                                            ELCDTERX
  1907         GO TO 0015-READ--CARR.                                   ELCDTERX
  1908                                                                  ELCDTERX
  1909     IF DD-ID = 'STAT'                                            ELCDTERX
  1910         GO TO 0020-READ--STAT.                                   ELCDTERX
  1911                                                                  ELCDTERX
  1912     IF DD-ID = 'BUSC'                                            ELCDTERX
  1913         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1914                                                                  ELCDTERX
  1915     IF DD-ID = 'MORT'                                            ELCDTERX
  1916         GO TO 0030-READ--MORT.                                   ELCDTERX
  1917                                                                  ELCDTERX
  1918     IF DD-ID = 'CLAI'                                            ELCDTERX
  1919         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1920                                                                  ELCDTERX
  1921     IF DD-ID = 'COLC'                                            ELCDTERX
  1922         GO TO 0065-READ--COLC.                                   ELCDTERX
  1923                                                                  ELCDTERX
  1924     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1925        DD-IDA = 'CL'                                             ELCDTERX
  1926         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1927                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1928     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1929        DD-IDA = 'PO'                                             ELCDTERX
  1930         GO TO 0050-READ--POXX.                                   ELCDTERX
  1931                                                                  ELCDTERX
  1932     IF DD-ID = 'OPCA'                                            ELCDTERX
  1933         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1934                                                                  ELCDTERX
  1935     IF DD-ID = 'OPST'                                            ELCDTERX
  1936         GO TO 0072-READ--OPST.                                   ELCDTERX
  1937                                                                  ELCDTERX
  1938     IF DD-ID = 'OPBS'                                            ELCDTERX
  1939         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1940                                                                  ELCDTERX
  1941     IF DD-ID = 'OPMS'                                            ELCDTERX
  1942         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1943                                                                  ELCDTERX
  1944     GO TO 0005-READ--CARD.                                       ELCDTERX
  1945                                                                  ELCDTERX
  1946 0010-READ--CLAC.                                                 ELCDTERX
  1947     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1948     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1949     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1950     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1951     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1952     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1953     GO TO 0005-READ--CARD.                                       ELCDTERX
  1954                                                                  ELCDTERX
  1955 0015-READ--CARR.                                                 ELCDTERX
  1956     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1957     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1958        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1959        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1960        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1961        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1962        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1963        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1964        MOVE DD-CARR1-SECPAY-SW
  1965                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1966     END-IF
  1967                                                                  ELCDTERX
  1968     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1969     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1970        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1971        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1972        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1973        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1974        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1975        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1976        MOVE DD-CARR2-SECPAY-SW
  1977                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1978     END-IF
  1979                                                                  ELCDTERX
  1980                                                                  ELCDTERX
  1981     GO TO 0005-READ--CARD.                                       ELCDTERX
  1982                                                                  ELCDTERX
  1983 0020-READ--STAT.                                                 ELCDTERX
  1984     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1985     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1986        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1987         GO TO 0005-READ--CARD.                                   ELCDTERX
  1988                                                                  ELCDTERX
  1989     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1990     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1991     GO TO 0020-READ--STAT.                                       ELCDTERX
  1992                                                                  ELCDTERX
  1993 0025-READ--BUSC.                                                 ELCDTERX
  1994     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1995     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1996        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1997         GO TO 0005-READ--CARD.                                   ELCDTERX
  1998                                                                  ELCDTERX
  1999     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2000     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2001     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2002                                                                  ELCDTERX
  2003 0030-READ--MORT.                                                 ELCDTERX
  2004     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2005     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2006        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2007         GO TO 0005-READ--CARD.                                   ELCDTERX
  2008                                                                  ELCDTERX
  2009     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2010     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2011     GO TO 0030-READ--MORT.                                       ELCDTERX
  2012                                                                  ELCDTERX
  2013 0035-READ--CLXX.                                                 ELCDTERX
  2014     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2015          GO TO 0005-READ--CARD.                                  ELCDTERX
  2016                                                                  ELCDTERX
  2017     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2018         DISPLAY '***********************************************'ELCDTERX
  2019         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2020         DISPLAY '***********************************************'ELCDTERX
  2021         GO TO 0055-READ--STOP.                                   ELCDTERX
  2022                                                                  ELCDTERX
  2023     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2024        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2025         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2026                                                                  ELCDTERX
  2027     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2028        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2029         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2030                                                                  ELCDTERX
  2031*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2032     GO TO 0005-READ--CARD.                                       ELCDTERX
  2033                                                                  ELCDTERX
  2034 0040-READ--CLAI.                                                 ELCDTERX
  2035     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2036     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2037        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2038         GO TO 0005-READ--CARD.                                   ELCDTERX
  2039                                                                  ELCDTERX
  2040     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2041     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2042     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2043                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2044 0045-READ--DUMP.                                                 ELCDTERX
  2045     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2046     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2047                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2048     PERFORM ABEND-PGM.                                           ELCDTERX
  2049                                                                  ELCDTERX
  2050 0050-READ--POXX.                                                 ELCDTERX
  2051     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2052         GO TO 0005-READ--CARD.                                   ELCDTERX
  2053                                                                  ELCDTERX
  2054     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2055         DISPLAY '***********************************************'ELCDTERX
  2056         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2057         DISPLAY '***********************************************'ELCDTERX
  2058         GO TO 0055-READ--STOP.                                   ELCDTERX
  2059                                                                  ELCDTERX
  2060     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2061     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2062     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2063     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2064                                                                  ELCDTERX
  2065     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2066         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2067     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2068         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2069                                                                  ELCDTERX
  2070     GO TO 0005-READ--CARD.                                       ELCDTERX
  2071                                                                  ELCDTERX
  2072 0055-READ--STOP.                                                 ELCDTERX
  2073     GOBACK.                                                      ELCDTERX
  2074                                                                  ELCDTERX
  2075 0060-READ--TEST.                                                 ELCDTERX
  2076     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2077        CLAX-ID         = SPACE  OR                               ELCDTERX
  2078        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2079         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2080                                                                  ELCDTERX
  2081     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2082     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2083                                                                  ELCDTERX
  2084 0065-READ--COLC.                                                 ELCDTERX
  2085     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2086     GO TO 0005-READ--CARD.                                       ELCDTERX
  2087                                                                  ELCDTERX
  2088 0070-READ--OPCA.                                                 ELCDTERX
  2089                                                                  ELCDTERX
  2090     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2091                                                                  ELCDTERX
  2092     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2093             OR                                                   ELCDTERX
  2094         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2095         GO TO 0005-READ--CARD.                                   ELCDTERX
  2096                                                                  ELCDTERX
  2097     ADD 1                       TO INDEXCA.                      ELCDTERX
  2098     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2099                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2100     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2101                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2102 0072-READ--OPST.                                                 ELCDTERX
  2103                                                                  ELCDTERX
  2104     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2105                                                                  ELCDTERX
  2106     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2107             OR                                                   ELCDTERX
  2108         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2109         GO TO 0005-READ--CARD.                                   ELCDTERX
  2110                                                                  ELCDTERX
  2111     ADD 1                       TO INDEXST.                      ELCDTERX
  2112     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2113                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2114     GO TO 0072-READ--OPST.                                       ELCDTERX
  2115                                                                  ELCDTERX
  2116 0074-READ--OPBS.                                                 ELCDTERX
  2117                                                                  ELCDTERX
  2118     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2119                                                                  ELCDTERX
  2120     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2121             OR                                                   ELCDTERX
  2122         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2123         GO TO 0005-READ--CARD.                                   ELCDTERX
  2124                                                                  ELCDTERX
  2125     ADD 1                       TO INDEXBS.                      ELCDTERX
  2126     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2127     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2128                                                                  ELCDTERX
  2129 0079-READ--EXIT.                                                 ELCDTERX
  2130*    EXIT.                                                        ELCDTERX
  2131******************************************************************ELCDTERX
  2132*************************************************************
  2133     PERFORM 0000-HOUSEKEEPING       THRU 0000-EXIT
  2134
  2135     PERFORM 1000-PROCESS            THRU 1000-EXIT
  2136         UNTIL EOF-DETEXT
  2137
  2138     CLOSE DETEXTR
  2139           FREEDOM-EXTRACT
  2140           CSI-FREEDOM-EXTRACT
  2141           CCC-FREEDOM-EXTRACT
  2142           ERACCT
  2143     GOBACK.
  2144
  2145
  2146 1000-PROCESS.
  2147
  2148     PERFORM 1100-GET-LOGIC-RECORD   THRU 1100-EXIT
  2149          WITH TEST AFTER
  2150              UNTIL VALID-RECORD OR EOF-DETEXT
  2151
  2152     IF EOF-DETEXT
  2153         GO TO 1000-EXIT
  2154     END-IF
  2155
  2156*    IF DE-ADDL-CLP = +0
  2157*        GO TO 1000-EXIT
  2158*    END-IF
  2159
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* FNB169.cbl
  2160     MOVE SPACES                     TO WS-EXTRACT-RECORD
  2161
  2162     MOVE 'LOGIC '                   TO FX-SOURCE-CODE
  2163     MOVE '11'                       TO FX-DIVISION
  2164     MOVE ' '                        TO FX-FY-REN
  2165
  2166     MOVE CYCLE-DATE                 TO FX-POSTING-DATE
  2167     MOVE DE-CERT                    TO FX-POLICY-NO
  2168
  2169     IF DE-CLP-STATE = SPACES
  2170        MOVE DE-STATE                TO DE-CLP-STATE
  2171     END-IF
  2172     MOVE DE-CLP-STATE               TO FX-STATE
  2173*    MOVE DE-STATE                   TO FX-STATE
  2174     MOVE 'Y'                        TO FX-LOC-CODE
  2175
  2176     PERFORM 1300-GET-ADDR           THRU 1300-EXIT
  2177
  2178*    DISPLAY ' CARRIER = ' DE-CARRIER
  2179*    MOVE '3'                    TO DE-CARRIER
  2180
  2181     IF DE-CARRIER = '3' OR '4'
  2182        MOVE 'CSIDCCFEES'        TO FX-SYSTEM
  2183     ELSE
  2184       IF DE-CARRIER = '5' OR '6'
  2185          MOVE 'CCCDCCFEES'      TO FX-SYSTEM
  2186          MOVE '50'              TO FX-DIVISION
  2187       ELSE
  2188        MOVE 'LPAC LOGIC'        TO FX-SYSTEM
  2189       END-IF
  2190     END-IF
  2191
  2192     MOVE DE-ACCT-PRIME              TO FX-AGENT-01
  2193     MOVE '6211'                     TO FX-COST-CENTER
  2194     MOVE ' '                        TO FX-DISTR
  2195     MOVE ' '                        TO FX-SOURCE-ACCT
  2196     MOVE ' '                        TO FX-REFERENCE
  2197
  2198     MOVE +1                         TO AGT-LEVEL
  2199
  2200
  2201     PERFORM UNTIL AGT-LEVEL > +10
  2202
  2203*    DISPLAY 'DE CERT ' DE-CERT
  2204*    DISPLAY 'AGT LEVEL ' AGT-LEVEL
  2205*    DISPLAY 'DE-AGT ' DE-AGT (AGT-LEVEL)
  2206*    DISPLAY 'DE-AGT-TYPE ' DE-AGT-TYPE (AGT-LEVEL)
  2207*    DISPLAY 'DE-TRAN ' DE-TRANS
  2208     MOVE DE-L-PC (AGT-LEVEL) TO TEST-DISP-L-PC
  2209*    DISPLAY 'DE-L-PC ' TEST-DISP-L-PC
  2210     MOVE DE-A-PC (AGT-LEVEL) TO TEST-DISP-A-PC
  2211*    DISPLAY 'DE-A-PC ' TEST-DISP-A-PC
  2212
  2213         EVALUATE DE-TRANS
  2214          WHEN 'I'
  2215            EVALUATE TRUE
  2216              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2217                MOVE 'ISSUE INCENTIVE'     TO FX-DESCRIPTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* FNB169.cbl
  2218                MOVE '01'                  TO FX-SUB-TYPE
  2219                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2220                                    * -1
  2221                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2222                MOVE '70'                  TO FX-TRAN-TYPE
  2223                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2224                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2225                MOVE '90'                  TO FX-TRAN-TYPE
  2226                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2227
  2228              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2229                MOVE 'ISSUE LMBA FEE'      TO FX-DESCRIPTION
  2230                MOVE '01'                  TO FX-SUB-TYPE
  2231                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2232                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2233                                    * -1
  2234                ELSE
  2235                   COMPUTE WS-LF-WORK ROUNDED = DE-REI-LFPRM *
  2236                      DE-L-PC (AGT-LEVEL)
  2237                   COMPUTE WS-AH-WORK ROUNDED = DE-REI-AHPRM *
  2238                      DE-A-PC (AGT-LEVEL)
  2239                   COMPUTE FX-AMOUNT ROUNDED = (WS-LF-WORK +
  2240                      WS-AH-WORK) * -1
  2241                END-IF
  2242                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2243                MOVE '75'                  TO FX-TRAN-TYPE
  2244                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2245                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2246                MOVE '95'                  TO FX-TRAN-TYPE
  2247                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2248
  2249              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2250                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2251                MOVE 'ISSUE CONTRACT FEE'  TO FX-DESCRIPTION
  2252                MOVE '01'                  TO FX-SUB-TYPE
  2253                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2254                                    * -1
  2255                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2256                MOVE '72'                  TO FX-TRAN-TYPE
  2257                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2258                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2259                MOVE '92'                  TO FX-TRAN-TYPE
  2260                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2261
  2262              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2263                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2264                MOVE 'ISSUE CSO ADMIN FEE'  TO FX-DESCRIPTION
  2265                MOVE '01'                  TO FX-SUB-TYPE
  2266                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2267                                    * -1
  2268                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2269                MOVE '77'                  TO FX-TRAN-TYPE
  2270                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2271                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2272                MOVE '97'                  TO FX-TRAN-TYPE
  2273                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2274            END-EVALUATE
  2275          WHEN '8'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* FNB169.cbl
  2276            EVALUATE TRUE
  2277              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2278                MOVE 'ISSUE RC-L INCENTIVE'
  2279                                           TO FX-DESCRIPTION
  2280                MOVE '01'                  TO FX-SUB-TYPE
  2281                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2282                                    * -1
  2283                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2284                MOVE '70'                  TO FX-TRAN-TYPE
  2285                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2286                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2287                MOVE '90'                  TO FX-TRAN-TYPE
  2288                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2289
  2290              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2291                MOVE 'ISSUE RC-L LMBA FEE' TO FX-DESCRIPTION
  2292                MOVE '01'                  TO FX-SUB-TYPE
  2293                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2294                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2295                                    * -1
  2296                ELSE
  2297                   COMPUTE FX-AMOUNT ROUNDED = ((DE-REI-LFPRM
  2298                      * DE-L-PC (AGT-LEVEL)) + (DE-REI-AHPRM
  2299                      * DE-A-PC (AGT-LEVEL))) * -1
  2300                END-IF
  2301                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2302                MOVE '75'                  TO FX-TRAN-TYPE
  2303                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2304                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2305                MOVE '95'                  TO FX-TRAN-TYPE
  2306                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2307
  2308              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2309                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2310                MOVE 'ISSUE RC-L CONTRACT FEE'
  2311                                           TO FX-DESCRIPTION
  2312                MOVE '01'                  TO FX-SUB-TYPE
  2313                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2314                                    * -1
  2315                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2316                MOVE '72'                  TO FX-TRAN-TYPE
  2317                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2318                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2319                MOVE '92'                  TO FX-TRAN-TYPE
  2320                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2321
  2322            END-EVALUATE
  2323          WHEN 'C'
  2324            EVALUATE TRUE
  2325              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I'
  2326                MOVE 'CANCEL MGT FEE  '    TO FX-DESCRIPTION
  2327                MOVE '01'                  TO FX-SUB-TYPE
  2328                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2329                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2330                move cnc-wk to fx-amount
  2331                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2332                MOVE '70'                  TO FX-TRAN-TYPE
  2333                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* FNB169.cbl
  2334                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2335                MOVE '90'                  TO FX-TRAN-TYPE
  2336                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2337              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'J'
  2338                MOVE 'CANCEL SLS MKT  '    TO FX-DESCRIPTION
  2339                MOVE '01'                  TO FX-SUB-TYPE
  2340                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2341                IF DE-CANCEL-REASON = 'R'
  2342                   MOVE +1      TO WS-CNC-FACT
  2343                END-IF
  2344                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2345                                    * WS-CNC-FACT
  2346                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2347                MOVE '70'                  TO FX-TRAN-TYPE
  2348                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2349                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2350                MOVE '90'                  TO FX-TRAN-TYPE
  2351                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2352
  2353              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2354                MOVE 'CANCEL LMBA FEE'     TO FX-DESCRIPTION
  2355                MOVE '01'                  TO FX-SUB-TYPE
  2356                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2357                   IF DE-AH-PRM NOT = ZEROS
  2358                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2359                         DE-AH-PRM
  2360                      IF DE-CANCEL-REASON = 'R'
  2361                         MOVE +1 TO WS-CNC-FACT
  2362                      END-IF
  2363                      COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL)
  2364                         * 1000 * WS-CNC-FACT
  2365                   END-IF
  2366                ELSE
  2367                   MOVE ZEROS   TO WS-WORK-AMT
  2368                   IF DE-LF-PRM NOT = ZEROS
  2369                      COMPUTE WS-CNC-FACT ROUNDED = DE-LF-RFND /
  2370                         DE-LF-PRM
  2371                      COMPUTE WS-WORK-AMT ROUNDED =
  2372                        (DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2373                          * WS-CNC-FACT
  2374                   END-IF
  2375                   IF DE-AH-PRM NOT = ZEROS
  2376                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2377                         DE-AH-PRM
  2378                      COMPUTE WS-WORK-AMT ROUNDED = WS-WORK-AMT +
  2379                     ((DE-A-PC (AGT-LEVEL) * DE-REI-AHPRM)
  2380                        * WS-CNC-FACT)
  2381                   END-IF
  2382                   MOVE WS-WORK-AMT TO FX-AMOUNT
  2383                END-IF
  2384                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2385                MOVE '75'                  TO FX-TRAN-TYPE
  2386                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2387                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2388                MOVE '95'                  TO FX-TRAN-TYPE
  2389                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2390
  2391              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* FNB169.cbl
  2392                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2393                MOVE 'CANCEL CONTRACT FEE' TO FX-DESCRIPTION
  2394                MOVE '01'                  TO FX-SUB-TYPE
  2395                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2396                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2397                                    * WS-CNC-FACT
  2398                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2399                MOVE '72'                  TO FX-TRAN-TYPE
  2400                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2401                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2402                MOVE '92'                  TO FX-TRAN-TYPE
  2403                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2404
  2405              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2406                AND (DE-A-PC (AGT-LEVEL) NOT = ZEROS)
  2407                MOVE 'CANCEL CSO ADMIN FEE' TO FX-DESCRIPTION
  2408                MOVE '01'                  TO FX-SUB-TYPE
  2409
  2410                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2411                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2412
  2413                MOVE CNC-WK      TO FX-AMOUNT
  2414                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2415                MOVE '77'                  TO FX-TRAN-TYPE
  2416                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2417                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2418                MOVE '97'                  TO FX-TRAN-TYPE
  2419                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2420
  2421            END-EVALUATE
  2422          WHEN '7'
  2423            EVALUATE TRUE
  2424              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2425                MOVE 'CANCEL RC-L INCENTIVE'
  2426                                           TO FX-DESCRIPTION
  2427                MOVE '01'                  TO FX-SUB-TYPE
  2428                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2429                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2430                                    * WS-CNC-FACT
  2431                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2432                MOVE '70'                  TO FX-TRAN-TYPE
  2433                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2434                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2435                MOVE '90'                  TO FX-TRAN-TYPE
  2436                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2437
  2438              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2439                MOVE 'CANCEL RC-L LMBA FEE'
  2440                                           TO FX-DESCRIPTION
  2441                MOVE '01'                  TO FX-SUB-TYPE
  2442                IF DE-AH-PRM NOT = ZEROS
  2443                   COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2444                ELSE
  2445                   MOVE ZEROS   TO WS-CNC-FACT
  2446                END-IF
  2447                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2448                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2449                                    * WS-CNC-FACT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* FNB169.cbl
  2450                ELSE
  2451                   COMPUTE WS-WORK-AMT = (DE-A-PC (AGT-LEVEL) *
  2452                      DE-REI-AHPRM)  * WS-CNC-FACT
  2453                   IF DE-LF-PRM NOT = ZEROS
  2454                      COMPUTE WS-LF-CNC-FACT = DE-LF-RFND /
  2455                         DE-LF-PRM
  2456                      COMPUTE FX-AMOUNT ROUNDED = WS-WORK-AMT +
  2457                       ((DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2458                          * WS-LF-CNC-FACT)
  2459                   END-IF
  2460                END-IF
  2461                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2462                MOVE '75'                  TO FX-TRAN-TYPE
  2463                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2464                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2465                MOVE '95'                  TO FX-TRAN-TYPE
  2466                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2467
  2468              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2469                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2470                MOVE 'CANCEL RC-L CONTRACT FEE'
  2471                                           TO FX-DESCRIPTION
  2472                MOVE '01'                  TO FX-SUB-TYPE
  2473                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2474                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2475                                    * WS-CNC-FACT
  2476                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2477                MOVE '72'                  TO FX-TRAN-TYPE
  2478                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2479                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2480                MOVE '92'                  TO FX-TRAN-TYPE
  2481                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2482            END-EVALUATE
  2483         END-EVALUATE
  2484         MOVE FX-AMOUNT TO TEST-DISP-FX-AMT
  2485*        DISPLAY 'FX AMT ' TEST-DISP-FX-AMT
  2486*        DISPLAY ' '
  2487
  2488         ADD +1                      TO AGT-LEVEL
  2489     END-PERFORM
  2490
  2491     .
  2492 1000-EXIT.
  2493     EXIT.
  2494
  2495 1010-WRITE-EXTRACT.
  2496
  2497     IF DE-CARRIER = '3' OR '4'
  2498        WRITE CSI-EXTRACT-RECORD
  2499                     FROM WS-EXTRACT-RECORD
  2500     ELSE
  2501       IF DE-CARRIER = '5' OR '6'
  2502          WRITE CCC-EXTRACT-RECORD FROM
  2503                WS-EXTRACT-RECORD
  2504       ELSE
  2505        WRITE EXTRACT-RECORD
  2506                     FROM WS-EXTRACT-RECORD
  2507       END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* FNB169.cbl
  2508     END-IF
  2509
  2510     .
  2511 1010-EXIT.
  2512     EXIT.
  2513
  2514 1100-GET-LOGIC-RECORD.
  2515
  2516     MOVE '0'                        TO VALID-RECORD-SW
  2517     READ DETEXTR
  2518         AT END GO TO 1100-EXIT
  2519     END-READ
  2520
  2521     IF DE-REIN NOT = SPACE
  2522         GO TO 1100-EXIT
  2523     END-IF
  2524
  2525     IF DE-TRANS = 'I' OR 'C' OR '7' OR '8'
  2526         CONTINUE
  2527     ELSE
  2528         GO TO 1100-EXIT
  2529     END-IF
  2530
  2531     IF DE-ENTRY-STATUS = 'M'
  2532        GO TO 1100-EXIT
  2533     END-IF
  2534
  2535     IF (DE-TRANS = 'I' OR '8')
  2536       AND (DE-ENTRY-STATUS = '3' OR '5')
  2537         GO TO 1100-EXIT
  2538     END-IF
  2539
  2540     IF (DE-LF-TYPE = ZERO)  AND
  2541        (DE-AH-TYPE = ZERO)
  2542           GO TO 1100-EXIT
  2543     END-IF
  2544
  2545     SET VALID-RECORD TO TRUE
  2546
  2547     .
  2548 1100-EXIT.
  2549     EXIT.
  2550
  2551
  2552 1300-GET-ADDR.
  2553
  2554     MOVE DE-COMPANY-CD          TO AM-COMPANY-CD
  2555     MOVE DE-CNTRL1              TO AM-CNTRL-1
  2556     MOVE DE-EFF                 TO AM-EXPIRE-DT
  2557
  2558     START ERACCT KEY >= AM-CONTROL-PRIMARY
  2559
  2560     IF ERACCT-STATUS NOT = '00'
  2561         DISPLAY 'ERROR ON ERACCT START ' ERACCT-STATUS
  2562         GO TO 1300-EXIT
  2563     END-IF
  2564
  2565     MOVE '0' TO END-OF-SEARCH-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* FNB169.cbl
  2566     MOVE ' '                    TO WS-DCC-PRODUCT-CODE
  2567
  2568     PERFORM UNTIL END-OF-SEARCH
  2569        READ ERACCT NEXT
  2570
  2571        IF ERACCT-STATUS = '00'
  2572           IF (AM-COMPANY-CD = DE-COMPANY-CD)
  2573              AND (AM-CNTRL-1 = DE-CNTRL1)
  2574              MOVE SPACES        TO FX-CITY
  2575              STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  2576                DELIMITED BY '  ' INTO FX-CITY
  2577              END-STRING
  2578              MOVE AM-ZIP        TO FX-ZIP-CODE
  2579              IF (DE-EFF >= AM-EFFECT-DT)
  2580                 AND (DE-EFF < AM-EXPIRE-DT)
  2581                 MOVE AM-DCC-PRODUCT-CODE
  2582                                 TO WS-DCC-PRODUCT-CODE
  2583              END-IF
  2584           ELSE
  2585              SET END-OF-SEARCH  TO TRUE
  2586           END-IF
  2587        ELSE
  2588           DISPLAY 'ERACCT READ NEXT STATUS ' ERACCT-STATUS
  2589           SET END-OF-SEARCH     TO TRUE
  2590        END-IF
  2591     END-PERFORM
  2592
  2593     MOVE FX-CITY                    TO FNX001-DATA
  2594     CALL 'FNX001' USING FNX001-PARMS
  2595     MOVE FNX001-CITY                TO FX-CITY
  2596
  2597     .
  2598 1300-EXIT.
  2599     EXIT.
  2600
  2601
  2602 1400-OTHER-FX-DATA.
  2603
  2604     IF FX-STATE NOT= SPACES
  2605         SEARCH ALL STATE-TABLE
  2606             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  2607             WHEN ST-STATE (ST-INDEX) = FX-STATE
  2608                 MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  2609         END-SEARCH
  2610     END-IF
  2611
  2612     MOVE SYSTEM-DATE                TO FX-JOURNAL-DATE
  2613
  2614**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  2615**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  2616     MOVE '*'                        TO WS-EXTRACT-RECORD(250:1)
  2617
  2618     .
  2619 1400-EXIT.
  2620     EXIT.
  2621
  2622 2520-REF-CSO-ADMIN-FEE.
  2623
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* FNB169.cbl
  2624     IF DE-CERT-NO = WS-FACT-CERT
  2625        CONTINUE
  2626     ELSE
  2627        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2628     END-IF
  2629
  2630     MOVE ZEROS                  TO CNC-WK
  2631
  2632     EVALUATE TRUE
  2633        WHEN (DE-DCC-DDF-REM-TRM3 = 0)
  2634           OR (DE-CANCEL-REASON = 'R')
  2635           DISPLAY ' REM TERM = 0 OR REPO'
  2636           MOVE 0                TO CNC-WK
  2637
  2638        when de-ah-rfnd = de-ah-prm
  2639           display ' full refund '
  2640           move a-ow             to cnc-wk
  2641        WHEN DE-DCC-DDF-REM-TRM3 = DE-AH-TERM
  2642           DISPLAY ' REM TERM  = ORIG TERM '
  2643           MOVE A-OW             TO CNC-WK
  2644
  2645        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4
  2646           DISPLAY ' ORIG TERM - REM TRM < 4 '
  2647           COMPUTE W-FACTOR ROUNDED = A-OW -
  2648              (DD-1ST-YR-ALLOW (D1)
  2649              * WS-MONTH / 3) - (A-OW - DD-1ST-YR-ALLOW (D1))
  2650              * (1 - WS-HI-UEF) * WS-MONTH / 12
  2651           COMPUTE CNC-WK = W-FACTOR * 1
  2652
  2653**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
  2654
  2655        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2656           DISPLAY ' ORIG TERM - REM TRM < 13 '
  2657           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2658              DD-1ST-YR-ALLOW (D1))
  2659              - (a-ow - DD-1ST-YR-ALLOW (D1))
  2660              * (1 - WS-hi-UEF) * ws-MONTH / 12
  2661           COMPUTE CNC-WK = W-FACTOR * 1
  2662
  2663****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
  2664
  2665        WHEN OTHER
  2666           DISPLAY ' OTHER '
  2667           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2668              DD-1ST-YR-ALLOW (D1))
  2669              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
  2670              * ws-MONTH / 12)
  2671           COMPUTE CNC-WK = W-FACTOR * 1
  2672     END-EVALUATE
  2673
  2674     .
  2675 2520-EXIT.
  2676     EXIT.
  2677
  2678 2530-CALC-DDF-FEES.
  2679
  2680*****   THIS PARA IS ONLY FOR COMM TYPES N AND I
  2681*****   DCC DDF REFUNDS ONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* FNB169.cbl
  2682
  2683     IF DE-CERT-NO = WS-FACT-CERT
  2684        CONTINUE
  2685     ELSE
  2686        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2687     END-IF
  2688
  2689     COMPUTE WS-MONTH =
  2690        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2691     IF WS-MONTH = 0
  2692        MOVE 12 TO WS-MONTH
  2693     END-IF
  2694     DISPLAY ' WS MONTH ' WS-MONTH
  2695
  2696     EVALUATE TRUE
  2697        WHEN DE-AGT-TYPE (AGT-LEVEL) = 'N'
  2698           PERFORM 2520-REF-CSO-ADMIN-FEE
  2699                                 THRU 2520-EXIT
  2700        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2701           AND (DE-CANCEL-REASON = 'R')
  2702              MOVE A-OW TO CNC-WK
  2703        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2704           EVALUATE TRUE
  2705              WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2706                 OR (NOT DD-IU-PRESENT)
  2707                 COMPUTE WS-CNC-FACT = DE-REI-AHRFND /
  2708                   DE-REI-AHPRM
  2709                 COMPUTE CNC-WK ROUNDED = WS-CNC-FACT * A-OW
  2710               WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13)
  2711                  AND (DD-IU-PRESENT)
  2712                  COMPUTE WS-CLP-MO3 = DE-REI-AHPRM -
  2713                     (DE-REI-AHPRM -
  2714                     DE-IU-RATE-UP) * (WS-HI-UEF -
  2715                     WS-LO-UEF) * 3 / 12
  2716                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2717                  COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2718                  COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT
  2719                   * A-OW
  2720                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
  2721                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2722                    A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2723              WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2724                 COMPUTE CNC-WK = A-OW *
  2725                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
  2726                    WS-MONTH / 12)
  2727           END-EVALUATE
  2728           DISPLAY ' CSO REF MGT FEE ' DE-CERT-NO ' ' CNC-WK
  2729     END-EVALUATE
  2730
  2731     .
  2732 2530-EXIT.
  2733     EXIT.
  2734
  2735 2540-CALC-DDF-COMM.
  2736
  2737     IF DE-CERT-NO = WS-FACT-CERT
  2738        DISPLAY ' FACTORS ALREADY BUILT IN 2540 ' DE-CERT-NO
  2739     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* FNB169.cbl
  2740        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2741     END-IF
  2742
  2743     COMPUTE WS-MONTH =
  2744        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2745     IF WS-MONTH = 0
  2746        MOVE 12 TO WS-MONTH
  2747     END-IF
  2748     DISPLAY ' WS MONTH ' WS-MONTH
  2749
  2750     EVALUATE TRUE
  2751        WHEN DE-CANCEL-REASON = 'R'
  2752           MOVE A-OW             TO CNC-WK
  2753        WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2754           OR (NOT DD-IU-PRESENT)
  2755              COMPUTE WS-CNC-FACT = DE-REI-AHRFND / DE-REI-AHPRM
  2756              COMPUTE CNC-WK = WS-CNC-FACT * A-OW
  2757        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2758            COMPUTE WS-CLP-MO3 = DE-REI-AHPRM - (DE-REI-AHPRM -
  2759               DE-IU-RATE-UP) * (WS-HI-UEF -
  2760               WS-LO-UEF) * 3 / 12
  2761            DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2762            COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2763            COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT * A-OW
  2764            DISPLAY ' UECOMMO3 ' WS-COMM-MO3
  2765            COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2766              A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2767        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2768           COMPUTE CNC-WK = a-ow * (WS-HI-UEF - (WS-HI-UEF -
  2769              WS-LO-UEF) * ws-MONTH / 12)
  2770     END-EVALUATE
  2771
  2772     DISPLAY ' CSO REF comm    ' DE-CERT-NO ' ' CNC-WK
  2773
  2774     .
  2775 2540-EXIT.
  2776     EXIT.
  2777
  2778 2550-GET-DDF-FACTORS.
  2779
  2780     MOVE ZEROS                  TO CNC-WK
  2781                                    WS-LO-UEF WS-HI-UEF
  2782     move ' '                    to dd-iu-sw
  2783
  2784     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
  2785        ((DE-STATE = DD-STATE (D1))
  2786        and (WS-DCC-PRODUCT-CODE = dd-product-cd (d1))
  2787*       AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
  2788        AND ('A'           = DD-BEN-TYPE   (D1))
  2789        AND (DE-AH-TYPE    = DD-BEN-CODE   (D1))
  2790        AND (DE-EFF        < DD-PROD-EXP-DT (D1)))
  2791                        OR
  2792        D1 > +800
  2793     END-PERFORM
  2794     IF D1 > +800
  2795        DISPLAY ' COULD NOT FIND UEP FACTORS '
  2796        GO TO 2550-EXIT
  2797     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* FNB169.cbl
  2798
  2799     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  2800        (P1 > +8)
  2801        OR (DD-PROD-CODE (D1 P1) = 'I')
  2802     END-PERFORM
  2803     IF P1 < +9
  2804        display ' setting iu present to true '
  2805        SET DD-IU-PRESENT        TO TRUE
  2806     END-IF
  2807
  2808     MOVE DE-AH-TERM             TO WS-DDF-TERM
  2809     IF (DE-LOAN-TERM > WS-DDF-TERM)
  2810        AND (DD-TRUNCATED (D1) = 'Y')
  2811        MOVE DE-LOAN-TERM        TO WS-DDF-TERM
  2812        DISPLAY ' FOUND TRUNCATED ' DE-CERT-NO
  2813     END-IF
  2814
  2815     EVALUATE TRUE
  2816        WHEN WS-DDF-TERM > +168
  2817           MOVE 15               TO P1
  2818        WHEN WS-DDF-TERM > +156
  2819           MOVE 14               TO P1
  2820        WHEN WS-DDF-TERM > +144
  2821           MOVE 13               TO P1
  2822        WHEN WS-DDF-TERM > +132
  2823           MOVE 12               TO P1
  2824        WHEN WS-DDF-TERM > +120
  2825           MOVE 11               TO P1
  2826        WHEN WS-DDF-TERM > +108
  2827           MOVE 10               TO P1
  2828        WHEN WS-DDF-TERM > +96
  2829           MOVE 9                TO P1
  2830        WHEN WS-DDF-TERM > +84
  2831           MOVE 8                TO P1
  2832        WHEN WS-DDF-TERM > +72
  2833           MOVE 7                TO P1
  2834        WHEN WS-DDF-TERM > +60
  2835           MOVE 6                TO P1
  2836        WHEN WS-DDF-TERM > +48
  2837           MOVE 5                TO P1
  2838        WHEN WS-DDF-TERM > +36
  2839           MOVE 4                TO P1
  2840        WHEN WS-DDF-TERM > +24
  2841           MOVE 3                TO P1
  2842        WHEN WS-DDF-TERM > +12
  2843           MOVE 2                TO P1
  2844        WHEN OTHER
  2845           MOVE 1                TO P1
  2846     END-EVALUATE
  2847
  2848     EVALUATE TRUE
  2849*       WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13)
  2850*          and (dd-iu-present)
  2851*          MOVE 2                TO P2
  2852*       WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13
  2853*          MOVE 1                TO P2
  2854        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +25
  2855           MOVE 2                TO P2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* FNB169.cbl
  2856        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +37
  2857           MOVE 3                TO P2
  2858        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +49
  2859           MOVE 4                TO P2
  2860        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +61
  2861           MOVE 5                TO P2
  2862        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +73
  2863           MOVE 6                TO P2
  2864        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +85
  2865           MOVE 7                TO P2
  2866        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +97
  2867           MOVE 8                TO P2
  2868        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +109
  2869           MOVE 9                TO P2
  2870        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +121
  2871           MOVE 10               TO P2
  2872        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +133
  2873           MOVE 11               TO P2
  2874        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +145
  2875           MOVE 12               TO P2
  2876        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +157
  2877           MOVE 13               TO P2
  2878        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +169
  2879           MOVE 14               TO P2
  2880        WHEN OTHER
  2881           MOVE 15               TO P2
  2882     END-EVALUATE
  2883
  2884     MOVE DE-CERT-NO             TO WS-FACT-CERT
  2885     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
  2886                                 TO WS-LO-UEF
  2887     MOVE DD-UEP-FACTOR (D1 P1 P2)
  2888                                 TO WS-HI-UEF
  2889
  2890     .
  2891 2550-EXIT.
  2892     EXIT.
  2893
  2894 0000-HOUSEKEEPING.
  2895
  2896     CALL 'DATEEDIT' USING CYCLE-DATE,  DATE-SW
  2897     IF NOT VALID-DATE
  2898         DISPLAY 'INVALID DATE PARAMETER: ' CYCLE-DATE
  2899         PERFORM ABEND-PGM           THRU ABEND-EXIT
  2900     END-IF
  2901
  2902     MOVE FUNCTION CURRENT-DATE      TO FUNCTION-DATE
  2903     MOVE WS-FN-MO                   TO SYS-MO
  2904     MOVE WS-FN-DA                   TO SYS-DA
  2905     MOVE WS-FN-CCYR                 TO SYS-CCYY
  2906
  2907     OPEN INPUT  ERACCT ERPDEF
  2908                 DETEXTR
  2909          OUTPUT FREEDOM-EXTRACT CSI-FREEDOM-EXTRACT
  2910                 CCC-FREEDOM-EXTRACT
  2911
  2912     IF ERACCT-STATUS = '00' OR '97'
  2913         CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* FNB169.cbl
  2914     ELSE
  2915         DISPLAY 'OPEN ERROR ' ERACCT-STATUS ' ON ERACCT'
  2916     END-IF
  2917
  2918     IF ERPDEF-FILE-STATUS = '00' OR '97'
  2919         CONTINUE
  2920     ELSE
  2921         DISPLAY 'OPEN ERROR ' ERPDEF-FILE-STATUS ' ON ERPDEF'
  2922     END-IF
  2923
  2924     IF DTE-CLIENT = 'DCC'
  2925        MOVE 0 TO B-SUB
  2926        MOVE DTE-CLASIC-COMPANY-CD
  2927                                 TO PD-CONTROL-PRIMARY
  2928        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  2929        IF ERPDEF-FILE-STATUS = '00'
  2930           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  2931              READ ERPDEF NEXT RECORD
  2932              IF ERPDEF-FILE-STATUS = '00'
  2933                 ADD 1 TO B-SUB
  2934                 IF B-SUB > 800
  2935                    DISPLAY ' DDF UEP TABLE BLEW '
  2936                    GO TO ABEND-PGM
  2937                 END-IF
  2938                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  2939                 MOVE PD-PRODUCT-CD
  2940                                 TO DD-PRODUCT-CD (B-SUB)
  2941                 MOVE PD-BEN-TYPE
  2942                                 TO DD-BEN-TYPE (B-SUB)
  2943                 MOVE PD-BEN-CODE
  2944                                 TO DD-BEN-CODE (B-SUB)
  2945                 MOVE PD-PROD-EXP-DT
  2946                                 TO DD-PROD-EXP-DT (B-SUB)
  2947                 MOVE PD-1ST-YR-ADMIN-ALLOW
  2948                                 TO DD-1ST-YR-ALLOW (B-SUB)
  2949                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  2950                    P2 > +8
  2951                    MOVE PD-PROD-CODE (P2)
  2952                                 TO DD-PROD-CODE (B-SUB P2)
  2953                 END-PERFORM
  2954                 MOVE PD-EARN-FACTORS
  2955                                 TO DD-EARN-FACTORS (B-SUB)
  2956              END-IF
  2957           END-PERFORM
  2958        DISPLAY ' DCC PRODUCT DEF TABLE LOADED SUCCESSFULLY '
  2959        END-IF
  2960        CLOSE ERPDEF
  2961     END-IF
  2962
  2963     .
  2964 0000-EXIT.
  2965     EXIT.
  2966
  2967
  2968 ABEND-PGM SECTION.
  2969     DIVIDE WS-ZERO BY WS-ZERO       GIVING WS-ZERO.
  2970 ABEND-EXIT.
  2971
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* FNB169.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      618324     Code:       11761
