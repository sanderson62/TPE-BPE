* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIB001.cbl
* Options: int("CIB001.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIB001.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIB001.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CIB001.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. CIB001
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     7*        This program sorts the report output of report el562
     8*        into car, grp, fin resp and account sequence. next
     9*        sort the account summary in the same sequence. next,
    10*        the program merges them together appending the account
    11*        summary report to the billing statements. during the
    12*        process, we eliminate the page number on the 3rd
    13*        heading line.
    14*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIB001.cbl
    16******************************************************************
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 100808  CR2007100800003  PEMA  NEW PROGRAM
    25* 101613  CR2013090300001  AJRA  ADD BLANK ACCT SUMMARY
    26******************************************************************
    27 ENVIRONMENT DIVISION.
    28 INPUT-OUTPUT SECTION.
    29 FILE-CONTROL.
    30
    31
    32     SELECT BILLING-STATEMENTS   ASSIGN TO SYS010.
    33
    34     SELECT SRTD-BILL-STMTS      ASSIGN TO SYS016.
    35
    36     SELECT DISK-DATE            ASSIGN TO SYS019.
    37
    38     SELECT ACCOUNT-SUMMARY      ASSIGN TO SYS011.
    39
    40     SELECT SRTD-ACCT-SUMM       ASSIGN TO SYS017.
    41
    42     SELECT STMTS-OUT            ASSIGN TO SYS012.
    43
    44     SELECT SORT-FILE            ASSIGN TO SORTWK1.
    45
    46     SELECT SORT-FILE2           ASSIGN TO SORTWK2.
    47
    48 DATA DIVISION.
    49
    50 FILE SECTION.
    51
    52 FD  BILLING-STATEMENTS
    53     LABEL RECORDS ARE STANDARD
    54     RECORDING MODE IS F
    55     BLOCK CONTAINS 0 RECORDS.
    56 01  STMT-RECORD                 PIC X(133).
    57
    58 FD  DISK-DATE
*   59                                 COPY ELCDTEFD.
    60******************************************************************04/15/98
    61*                                                                *ELCDTEFD
    62*                                                                *ELCDTEFD
    63*                            ELCDTEFD.                           *   LV002
    64*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    65*                            VMOD=2.007                          *   CL**2
    66*                                                                *ELCDTEFD
    67******************************************************************ELCDTEFD
    68     BLOCK CONTAINS 0 RECORDS
    69     RECORDING MODE F.                                            ELCDTEFD
    70                                                                  ELCDTEFD
    71 01  DATE-DISK.                                                   ELCDTEFD
    72     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    73     12  FILLER                      PIC  X(14).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    74     12  DD-CR1                      PIC  9.                      ELCDTEFD
    75     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    76     12  DD-CR2                      PIC  9.                      ELCDTEFD
    77     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    78     12  FILLER                      PIC  X(20).                  ELCDTEFD
    79                                                                  ELCDTEFD
    80 01  DATE-DISK-R.                                                 ELCDTEFD
    81     12  FILLER                      PIC  X(4).                   ELCDTEFD
    82     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    83                                     PIC  X(32).                  ELCDTEFD
    84                                                                  ELCDTEFD
    85 01  DATE-DISK-T.                                                 ELCDTEFD
    86     12  FILLER                      PIC  X(4).                   ELCDTEFD
    87     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    88                                     PIC  X(48).                  ELCDTEFD
    89                                                                  ELCDTEFD
    90 01  DATE-DISK-M.                                                 ELCDTEFD
    91     12  FILLER                      PIC  X(4).                   ELCDTEFD
    92     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    93                                     PIC  X(48).                  ELCDTEFD
    94                                                                  ELCDTEFD
    95 01  DATE-DISK-P.                                                 ELCDTEFD
    96     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    97     12  DD-IDX                      PIC  99.                     ELCDTEFD
    98     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    99     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   100         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   101                                     PIC  X.                      ELCDTEFD
   102         16  FILLER                  PIC  X(46).                  ELCDTEFD
   103     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   104         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   105             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   106             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   107             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   108             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   109         16  FILLER                  PIC  X(16).                  ELCDTEFD
   110                                                                  ELCDTEFD
   111 01  DATE-DISK-E.                                                 ELCDTEFD
   112     12  FILLER                      PIC  X(4).                   ELCDTEFD
   113     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   114                                     PIC  X(4).                   ELCDTEFD
   115                                                                  ELCDTEFD
   116 01  DATE-DISK-C.                                                 ELCDTEFD
   117     12  FILLER                      PIC  X(7).                   ELCDTEFD
   118     12  DD-CARR1-SECPAY-SW          PIC  X.
   119     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   120     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   121     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   122     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   123     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   124     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   125     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   126     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   127     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   128     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   129     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   130     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   131     12  DD-CARR2-SECPAY-SW          PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   132     12  FILLER                      PIC  X(7).                   ELCDTEFD
   133                                                                  ELCDTEFD
   134 01  DATE-DISK-OPT.                                               ELCDTEFD
   135     12  FILLER                      PIC  X(04).                  ELCDTEFD
   136     12  DD-TLR-DATA.                                             ELCDTEFD
   137         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   138                                     PIC  X(03).                  ELCDTEFD
   139     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   140         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   141                                     PIC  X(06).                  ELCDTEFD
   142     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   143         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   144                                     PIC  X(07).                  ELCDTEFD
   145         16  FILLER                  PIC  X(05).                  ELCDTEFD
   146     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   147                                     PIC  X(96).                  ELCDTEFD
   148******************************************************************ELCDTEFD
   149
   150 FD  ACCOUNT-SUMMARY
   151     LABEL RECORDS ARE STANDARD
   152     RECORDING MODE IS F
   153     BLOCK CONTAINS 0 RECORDS.
   154 01  ACCT-SUMM-REC               PIC X(133).
   155
   156 FD  STMTS-OUT
   157     LABEL RECORDS ARE STANDARD
   158     RECORDING MODE IS F
   159     BLOCK CONTAINS 0 RECORDS.
   160 01  STMTS-OUT-REC               PIC X(133).
   161
   162 FD  SRTD-BILL-STMTS
   163     LABEL RECORDS ARE STANDARD
   164     RECORDING MODE IS F
   165     BLOCK CONTAINS 0 RECORDS.
   166
   167 01  SRTD-BILL-REC.
   168     05  SBR-KEY                 PIC X(38).
   169     05  SBR-RECORD              PIC X(133).
   170
   171 FD  SRTD-ACCT-SUMM
   172     LABEL RECORDS ARE STANDARD
   173     RECORDING MODE IS F
   174     BLOCK CONTAINS 0 RECORDS.
   175
   176 01  SRTD-ACCT-REC.
   177     05  SAR-KEY                 PIC X(38).
   178     05  SAR-RECORD              PIC X(133).
   179
   180 SD  SORT-FILE.
   181
   182 01  SORTWORK.
   183     05  SR-SORT-KEY.
   184         10  SR-CARRIER          PIC X.
   185         10  SR-GROUPING         PIC X(6).
   186         10  SR-RESP-NO          PIC X(10).
   187         10  SR-ACCT-NO          PIC X(10).
   188         10  SR-SEQ-NO           PIC 9(11).
   189     05  SR-REPORT               PIC X(133).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIB001.cbl
   190
   191 SD  SORT-FILE2.
   192
   193 01  SORTWORK2.
   194     05  SR2-SORT-KEY.
   195         10  SR2-CARRIER          PIC X.
   196         10  SR2-GROUPING         PIC X(6).
   197         10  SR2-RESP-NO          PIC X(10).
   198         10  SR2-ACCT-NO          PIC X(10).
   199         10  SR2-SEQ-NO           PIC 9(11).
   200     05  SR2-REPORT               PIC X(133).
   201
   202 WORKING-STORAGE SECTION.
*  203 copy "ctypes.cpy".
   204 77  char                   pic s9(2)  comp-5 is typedef.
   205 77  uns-char               pic  9(2)  comp-5 is typedef.
   206 77  short                  pic s9(4)  comp-5 is typedef.
   207 77  uns-short              pic  9(4)  comp-5 is typedef.
   208 77  int                    pic s9(9)  comp-5 is typedef.
   209 77  uns-int                pic  9(9)  comp-5 is typedef.
   210$IF P64 set
   211X77  long                   pic s9(18) comp-5 is typedef.
   212X77  uns-long               pic  9(18) comp-5 is typedef.
   213$ELSE
   214 77  long                   pic s9(9)  comp-5 is typedef.
   215 77  uns-long               pic  9(9)  comp-5 is typedef.
   216$END
   217 77  l-long                 pic s9(18) comp-5 is typedef.
   218 77  uns-l-long             pic  9(18) comp-5 is typedef.
   219 77  d-l-float                         comp-2 is typedef.
   220 77  d-float                           comp-2 is typedef.
   221 77  float                             comp-1 is typedef.
   222 77  proc-pointer           procedure-pointer is typedef.
   223 77  data-pointer                     pointer is typedef.
   224 77  void                   pic  9(2)  comp-5 is typedef.
   225 78  default-convention-val value   0.
   226 78  cdecl-convention-val   value   0.
   227 78  pascal-convention-val  value  11.
   228 78  fast-convention-val    value   2.
   229 78  std-convention-val     value  74.
   230 78  sys-convention-val     value  16.
   231 78  opt-convention-val     value   0.
   232 78  pasc16-convention-val  value  35.
   233 78  cdec16-convention-val  value  32.
   234
   235 77  WS-HEADING-SW               PIC X   VALUE SPACES.
   236     88  WS-HEADING                  VALUE 'Y'.
   237 77  WS-NEW-ACCT-SW              PIC X   VALUE SPACES.
   238     88  WS-NEW-ACCT                 VALUE 'Y'.
   239 77  WS-EOF-SW                   PIC X   VALUE SPACES.
   240     88  END-OF-INPUT                VALUE 'Y'.
   241 77  WS-STMT-SW                  PIC X   VALUE SPACES.
   242     88  END-OF-STMTS                VALUE 'Y'.
   243 77  WS-SUMM-SW                  PIC X   VALUE SPACES.
   244     88  END-OF-SUMM                 VALUE 'Y'.
   245 77  s1-IN-CNT                   PIC 9(7)  VALUE ZEROS.
   246 77  s1-rel-cnt                  pic 9(7)  value zeros.
   247 77  s1-ret-cnt                  pic 9(7)  value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIB001.cbl
   248 77  s2-IN-CNT                   PIC 9(7)  VALUE ZEROS.
   249 77  s2-rel-cnt                  pic 9(7)  value zeros.
   250 77  s2-ret-cnt                  pic 9(7)  value zeros.
   251 77  stmts-OUT-CNT               PIC 9(7)  VALUE ZEROS.
   252 77  A1                          PIC S999  VALUE +0 COMP-3.
   253 77  WS-PREV-STMT-KEY            PIC X(27) VALUE SPACES.
   254 77  WS-PREV-SUMM-KEY            PIC X(27) VALUE SPACES.
   255 01  WS-MISC.
   256     05  WS-HOLD-HEAD  OCCURS 4  PIC X(133).
   257
   258 01  ws-stmt-key.
   259     05  ws-sk-carrier           pic x.
   260     05  ws-sk-grouping          pic x(6).
   261     05  ws-sk-resp-no           pic x(10).
   262     05  ws-sk-acct-no           pic x(10).
   263     05  ws-sk-seq-no            pic 9(11)  value zeros.
   264 01  FILLER.
   265     05  WS-RETURN-CODE          PIC S9(4)  COMP  VALUE ZEROS.
   266     05  WS-ZERO                 PIC S9     VALUE +0  COMP-3.
   267     05  WS-ABEND-MESSAGE        PIC X(80)  VALUE SPACES.
   268     05  WS-ABEND-FILE-STATUS    PIC XX     VALUE ZEROS.
   269     05  PGM-SUB             PIC S999   COMP-3  VALUE +061.
   270     05  WS-HDG  OCCURS 4 TIMES PIC X(133).
   271     05  WRK-RUN-DATE.
   272         10  WRK-RUN-MM          PIC X(2).
   273         10  FILLER              PIC X  VALUE '/'.
   274         10  WRK-RUN-DD          PIC X(2).
   275         10  FILLER              PIC X  VALUE '/'.
   276         10  WRK-RUN-YYYY        PIC X(4).
   277
*  278                                 COPY ELCDATE.
   279******************************************************************06/11/98
   280*                                                                *ELCDATE
   281*                                                                *ELCDATE
   282*                            ELCDATE.                            *   LV023
   283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   284*                            VMOD=2.003                           ELCDATE
   285*                                                                *ELCDATE
   286*                                                                *ELCDATE
   287*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   288*                 LENGTH = 200                                   *   CL*19
   289******************************************************************ELCDATE
   290                                                                  ELCDATE
   291 01  DATE-CONVERSION-DATA.                                        ELCDATE
   292     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   293     12  DC-OPTION-CODE                PIC X.                        CL*15
   294         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   295         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   296         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   297         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   298         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   299         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   300         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   301         88  FIND-CENTURY               VALUE '7'.                   CL*22
   302         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   303         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   304         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   305         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDATE)
   306         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   307         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   308         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   309         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   310         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   311         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   312         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   313         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   314         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   315         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   316         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   317         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   318         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   319         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   320         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   321         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   322         88  THREE-CHARACTER-BIN                                  ELCDATE
   323                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   324         88  GREGORIAN-TO-BIN                                        CL**2
   325                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   326         88  BIN-TO-GREGORIAN                                        CL**2
   327                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   328         88  JULIAN-TO-BINARY                                        CL**2
   329                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   330     12  DC-ERROR-CODE                 PIC X.                        CL*15
   331         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   332         88  DATE-CONVERSION-ERROR                                ELCDATE
   333                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   334         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   335         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   336         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   337         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   338         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   339         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   340         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   341         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   342         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   343         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   344     12  DC-END-OF-MONTH               PIC X.                        CL*15
   345         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   346     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   347         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   348         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   349         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   350     12  FILLER                        PIC X.                        CL*15
   351     12  DC-CONVERSION-DATES.                                        CL*15
   352         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   353         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   354         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   355         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   356                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   357             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   358             20  SLASH1-1              PIC X.                        CL*15
   359             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   360             20  SLASH1-2              PIC X.                        CL*15
   361             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   362         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   363         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDATE)
   364                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   365             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   366             20  SLASH2-1              PIC X.                        CL*15
   367             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   368             20  SLASH2-2              PIC X.                        CL*15
   369             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   370         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   371         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   372                     DC-GREG-DATE-1-YMD.                          ELCDATE
   373             20  DC-YMD-YEAR           PIC 99.                       CL*15
   374             20  DC-YMD-MONTH          PIC 99.                       CL*15
   375             20  DC-YMD-DAY            PIC 99.                       CL*15
   376         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   377         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   378                      DC-GREG-DATE-1-MDY.                         ELCDATE
   379             20  DC-MDY-MONTH          PIC 99.                       CL*15
   380             20  DC-MDY-DAY            PIC 99.                       CL*15
   381             20  DC-MDY-YEAR           PIC 99.                       CL*15
   382         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   383             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   384             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   385             20  FILLER                PIC XX.                       CL*15
   386             20  DC-ALPHA-CENTURY.                                   CL*15
   387                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   388             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   389         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   390         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   391         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   392         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   393         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   394                                       PIC 9(05).                    CL*20
   395         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   396             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   397             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   398         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   399         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   400         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   401     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   402         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   403         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   404             20  FILLER                PIC 9(3).                     CL*15
   405             20  HOLD-CEN-1-CCYY.                                    CL*15
   406                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   407                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   408             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   409             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   410         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   411             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   412             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   413             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   414                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   415                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   416             20  FILLER                PIC 9(3).                     CL*15
   417         16  HOLD-CENTURY-1-X.                                       CL*15
   418             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   419             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   420                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   421                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDATE)
   422             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   423             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   424         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   425             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   426             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   427             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   428                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   429                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   430             20  FILLER                PIC XXX.                      CL*23
   431         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   432         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   433         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   434         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   435             20  DC-JULIAN-1-CCYY.                                   CL*15
   436                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   437                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   438             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   439         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   440         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   441             20  DC-JULIAN-2-CCYY.                                   CL*15
   442                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   443                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   444             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   445         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   446             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   447             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   448             20  DC-EDITA-DAY          PIC 99.                       CL*15
   449             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   450             20  DC-EDITA-CCYY.                                      CL*15
   451                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   452                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   453         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   454             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   455             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   456             20  DC-EDITB-DAY          PIC 99.                       CL*15
   457             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   458             20  DC-EDITB-CCYY.                                      CL*15
   459                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   460                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   461         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   462         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   463                              DC-GREG-DATE-CYMD.                  ELCDATE
   464             20  DC-CYMD-CEN           PIC 99.                       CL*15
   465             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   466             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   467             20  DC-CYMD-DAY           PIC 99.                       CL*15
   468         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   469         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   470                              DC-GREG-DATE-MDCY.                  ELCDATE
   471             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   472             20  DC-MDCY-DAY           PIC 99.                       CL*15
   473             20  DC-MDCY-CEN           PIC 99.                       CL*15
   474             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   475    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   476        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   477    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   478    12  FILLER                         PIC X(28).                    CL*26
*  479                                 COPY ELCDTECX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   480******************************************************************06/05/98
   481*                                                                *ELCDTECX
   482*                            ELCDTECX.                           *   LV005
   483*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   484*                            VMOD=2.015                          *ELCDTECX
   485*                                                                *ELCDTECX
   486*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   487*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   488*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   489*                                                                *ELCDTECX
   490******************************************************************ELCDTECX
   491******************************************************************
   492*                   C H A N G E   L O G
   493*
   494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   495*-----------------------------------------------------------------
   496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   497* EFFECTIVE    NUMBER
   498*-----------------------------------------------------------------
   499* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   500*                                  BENEFIT CODES FROM 300 TO 900
   501* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   502* 051304    2003080800002  SMVA  ADD REFUND METHOD
   503* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   504******************************************************************
   505 01  DATE-CARD.                                                   ELCDTECX
   506     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   507     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   508     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   509     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   510     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   511     12  EP-SW                       PIC  X.                      ELCDTECX
   512         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   513     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   514         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   515     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   516     12  RUN-CENTURY.                                             ELCDTECX
   517         16 RUN-CENTURY-N            PIC  99.                        CL**4
   518     12  FILLER                      PIC  X.                         CL**4
   519     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   520     12  FILLER                      PIC  XXX.                    ELCDTECX
   521     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   522                                                                  ELCDTECX
   523 01  FILLER                          PIC  X(7)                       CL**6
   524                                          VALUE 'OPTIONS'.        ELCDTECX
   525 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   526     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   527     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   528     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   529         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   530         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   531     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   532     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   533     12  FILLER                      PIC  X.                      ELCDTECX
   534     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   535     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   536     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   537     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   538     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   539     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   540     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   541     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   542     12  FILLER                      PIC  X.                      ELCDTECX
   543     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   544     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   545     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   546     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   547     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   548     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   549     12  FILLER                      PIC  X.                      ELCDTECX
   550     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   551     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   552     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   553     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   554     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   555     12  DTE-R78                     PIC  X.                      ELCDTECX
   556     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   557     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   558     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   559     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   560     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   561     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   562     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   563                                     PIC  X.                      ELCDTECX
   564         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   565                                                 ' '.             ELCDTECX
   566         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   567         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   568     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   569         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   570         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   571     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   572     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   573                                     PIC  9.                         CL**4
   574     12  DTE-SYSTEM.                                              ELCDTECX
   575         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   576         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   577         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   578         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   579         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   580         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   581         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   582         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   583         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   584         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   585         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   586         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   587         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   588         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   589         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   590         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   591         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   592         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   593         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   594         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   595         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   596         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   597         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   598         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   599         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   600         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   601     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   602         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   603                                     PIC  X.                      ELCDTECX
   604     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   605                                                                  ELCDTECX
   606 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   607     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   608     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   609     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   610*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   611     12  FILLER                      PIC  X.                      ELCDTECX
   612     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   613     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   614     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   615     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   616     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   617     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   618     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   619                                                                  ELCDTECX
   620     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   621     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   622     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   623     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   624                                                                  ELCDTECX
   625     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   626     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   627     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   628     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   629                                                                  ELCDTECX
   630     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   631     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   632                                                                  ELCDTECX
   633     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   634     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   635                                                                  ELCDTECX
   636     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   637                                                                  ELCDTECX
   638 01  DATE-CARD-FACTORS.                                           ELCDTECX
   639     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   640     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   641     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   642     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   643     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   644     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   645     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   646                                                                  ELCDTECX
   647 01  FILLER                          PIC  X(12)                   ELCDTECX
   648                                          VALUE 'COMPANY NAME'.   ELCDTECX
   649 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   650     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   651         16  CNT-ID                  PIC  X.                      ELCDTECX
   652         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   653                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   654 01  FILLER                          PIC  X(11)                   ELCDTECX
   655                                          VALUE 'STATE NAMES'.    ELCDTECX
   656 01  STATE-NAMES.                                                 ELCDTECX
   657     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   658         16  STATE-SUB               PIC  XX.                     ELCDTECX
   659         16  STATE-PIC1.                                          ELCDTECX
   660             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   661             20  FILLER              PIC  XXX.                    ELCDTECX
   662             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   663             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   664             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   665             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   666                                                                  ELCDTECX
   667 01  FILLER                          PIC  X(13)                   ELCDTECX
   668                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   669 01  CARRIER-NAMES.                                               ELCDTECX
   670     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   671         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   672         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   673         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   674         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   675         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   676         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   677*        16  FILLER                  PIC  X.                      ELCDTECX
   678         16  CARRIER-SEC-PAY         PIC  X.
   679             88  SEC-PAY-CARRIER          VALUE 'Y'.
   680                                                                  ELCDTECX
   681 01  FILLER                          PIC  X(9)                       CL**6
   682                                          VALUE 'INS TYPES'.      ELCDTECX
   683 01  CLAS-INS-TYPES.                                              ELCDTECX
   684*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   685     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   686         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   687         16  CLAS-I-AB3.                                          ELCDTECX
   688             20  FILLER              PIC  X.                      ELCDTECX
   689             20  CLAS-I-AB2.                                      ELCDTECX
   690                 24  FILLER          PIC  X.                      ELCDTECX
   691                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   692         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   693             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   694             20  FILLER              PIC  X.                         CL**4
   695         16  CLAS-I-AB10.                                         ELCDTECX
   696             20  FILLER              PIC  X(9).                   ELCDTECX
   697             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   698         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   699         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   700         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   701         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   702             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   703         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   704         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   705         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   706         16  CLAS-I-BEN-CATEGORY     PIC  X.
   707         16  CLAS-I-REFUND-METHOD    PIC  X.
   708         16  CLAS-I-MAX-BENEFITS     PIC 99.
   709         16  FILLER                  PIC  XXX.
   710                                                                  ELCDTECX
   711 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   712                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   713 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   714     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   715                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   716         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   717         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   718         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   719         16  CLAS-MORT-DESC.                                      ELCDTECX
   720             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   721             20  FILLER              PIC  XX.                        CL**5
   722             20  CLAS-YEAR           PIC  X(4).                      CL**6
   723             20  FILLER              PIC  X.                         CL**5
   724             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   725             20  FILLER              PIC  X.                         CL**5
   726             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   727             20  FILLER              PIC  X.                         CL**5
   728             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   729             20  FILLER              PIC  X(5).                      CL**6
   730                                                                  ELCDTECX
   731 01  FILLER                          PIC  X(15)                   ELCDTECX
   732                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   733 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   734     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   735         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   736         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   737         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   738         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   739         16  FILLER                  PIC  X(4).                      CL**6
   740                                                                  ELCDTECX
   741 01  FILLER                          PIC  X(7)                       CL**6
   742                                     VALUE 'INDEXES'.             ELCDTECX
   743 01  CLAS-INDEX-TBL.                                              ELCDTECX
   744     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   745     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   746     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   747     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   748     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   749     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   750     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   751     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   752     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   753     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   754     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   755     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   756     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   757     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   758     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   759     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   760     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   761                                                                  ELCDTECX
   762 01  CLAS-TYPE-MISC.                                              ELCDTECX
   763     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   764     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   765     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   766     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   767     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   768     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   769     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   770     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   771     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   772     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   773     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   774                                                                  ELCDTECX
   775 01  FILLER                          PIC  X(13)                   ELCDTECX
   776                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   777 01  CLAS-MISC.                                                   ELCDTECX
   778     12  DTE-FICH                    PIC  X.                      ELCDTECX
   779         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   780         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   781         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   782     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   783     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   784     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   785     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   786     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   787     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   788     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   789     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   790     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   791     12  STATE-L                     PIC  XX.                     ELCDTECX
   792     12  CLAS-CN                     PIC  99.                     ELCDTECX
   793     12  CLAS-CO                     PIC  99.                     ELCDTECX
   794     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   795         16  DTE-F-1                 PIC  X.                      ELCDTECX
   796         16  DTE-F-2                 PIC  X.                      ELCDTECX
   797     12  DTE-ABEND-WORK.                                          ELCDTECX
   798         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   799         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   800                                                                  ELCDTECX
   801 01  FILLER                          PIC  X(12)                   ELCDTECX
   802                                     VALUE 'WORKING DATE'.        ELCDTECX
   803 01  WS-DATE-AND-TIME.                                            ELCDTECX
   804     12  WS-ACCEPT-DATE.                                          ELCDTECX
   805         16  WS-AD-YY                PIC  99.                     ELCDTECX
   806         16  WS-AD-MM                PIC  99.                     ELCDTECX
   807         16  WS-AD-DD                PIC  99.                     ELCDTECX
   808     12  WS-CURRENT-DATE.                                         ELCDTECX
   809         16  WS-CD-MM                PIC  99.                     ELCDTECX
   810         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   811         16  WS-CD-DD                PIC  99.                     ELCDTECX
   812         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   813         16  WS-CD-YY                PIC  99.                     ELCDTECX
   814     12  WS-TIME-OF-DAY.                                          ELCDTECX
   815         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   816         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   817                                                                  ELCDTECX
   818 01  FILLER                          PIC  X(12)                   ELCDTECX
   819                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   820 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   821     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   822         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   823         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   824         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   825                                                                  ELCDTECX
   826 01  FILLER                          PIC  X(10)                   ELCDTECX
   827                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   828 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   829     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   830         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   831         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   832                                                                  ELCDTECX
   833 01  FILLER                          PIC  X(13)                   ELCDTECX
   834                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   835 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   836     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   837         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   838                                                                  ELCDTECX
   839 01  FILLER                          PIC  X(13)                   ELCDTECX
   840                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   841 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   842     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   843     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   844     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   845                                     PIC  X.                         CL**5
   846     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   847     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   848     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   849     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   850     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   851     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   852     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   853     12  FILLER                      PIC  X(75).                  ELCDTECX
   854******************************************************************ELCDTECX
   855*01  MISC-CARR-PCT-DATA.                                          00001521
   856*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   857*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   858*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   859*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   860*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   861*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   862******************************************************************ELCDTECX
*  863                                 COPY ELCDTEVR.
   864***************************************************************** 04/15/98
   865*                                                                *ELCDTEVR
   866*                                                                *ELCDTEVR
   867*                            ELCDTEVR.                           *   LV003
   868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   869*                            VMOD=2.001                          *   CL**2
   870*                                                                *ELCDTEVR
   871*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   872*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   873*                                                                *ELCDTEVR
   874******************************************************************ELCDTEVR
   875 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   876     05  WS-RUN-DATE.                                             ELCDTEVR
   877         10  FILLER                  PIC  9(03).                  ELCDTEVR
   878         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   879         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   880             15  RUN-CC              PIC  99.                     ELCDTEVR
   881             15  RUN-YR              PIC  99.                     ELCDTEVR
   882         10  RUN-MO                  PIC  99.                     ELCDTEVR
   883         10  RUN-DA                  PIC  99.                     ELCDTEVR
   884     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   885            WS-RUN-DATE              PIC 9(11).                      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   886     05  WS-EP-DT.                                                ELCDTEVR
   887         10  FILLER                  PIC  9(03).                  ELCDTEVR
   888         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   889         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   890             15  EP-CC               PIC  99.                     ELCDTEVR
   891             15  EP-YR               PIC  99.                     ELCDTEVR
   892         10  EP-MO                   PIC  99.                     ELCDTEVR
   893         10  EP-DA                   PIC  99.                     ELCDTEVR
   894     05  WS-EP-DT-N REDEFINES                                        CL**2
   895            WS-EP-DT                 PIC 9(11).                      CL**2
   896     05  WS-DTE-CONV-DT.                                             CL**4
   897         10  FILLER                  PIC  9(03).                     CL**4
   898         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   899         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   900             15  DTE-CONV-CC         PIC  99.                        CL**4
   901             15  DTE-CONV-YR         PIC  99.                        CL**4
   902         10  DTE-CONV-MO             PIC  99.                        CL**4
   903         10  DTE-CONV-DA             PIC  99.                        CL**4
   904     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   905            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   906 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   907     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   908         10  FILLER                            PIC 999.           ELCDTEVR
   909         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   910         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   911             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   912             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   913         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   914         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   915     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   916            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   917     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   918         10  FILLER                            PIC 999.           ELCDTEVR
   919         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   920         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   921         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   922         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   923     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   924            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   925 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   926     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   927         10  FILLER                            PIC 999.           ELCDTEVR
   928         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   929         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   930             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   931             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   932         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   933         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   934     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   935            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   936     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   937         10  FILLER                            PIC 999.           ELCDTEVR
   938         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   939         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   940             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   941             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   942         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   943         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   944     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   945            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   946     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   947         10  FILLER                            PIC 999.           ELCDTEVR
   948         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   949         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   950             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   951             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   952         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   953         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   954     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   955            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   956 01  WS-RATE-RECORD.                                              ELCDTEVR
   957         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   958             10  FILLER                        PIC 999.           ELCDTEVR
   959             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   960             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   961                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   962                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   963             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   964             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   965         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   966                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
*  967                                 COPY ECSDMSUM.
   968******************************************************************
   969*                                                                *
   970*                           ECSDMSUM                             *
   971*                                                                *
   972*   FILE DESCRIPTION = DUMMY ACCOUNT SUMMARY                     *
   973*                                                                *
   974*   FILE TYPE = SEQUENTIAL                                       *
   975*   RECORD SIZE = 133  RECFORM = FIXED                           *
   976*                                                                *
   977******************************************************************
   978*                   C H A N G E   L O G
   979*
   980* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   981*-----------------------------------------------------------------
   982*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   983* EFFECTIVE    NUMBER
   984*-----------------------------------------------------------------
   985* 101613    2013090300001  AJRA  NAPERSOFT PHASE 2
   986******************************************************************
   987
   988 01  DUMMY-SUMMARY-RECORD.
   989     05  DUM-SUM-LINE1.
   990         12  FILLER              PIC  X(1)      VALUE '1'.
   991         12  FILLER              PIC  X(61)     VALUE SPACES.
   992         12  FILLER              PIC  X(10)     VALUE
   993                 'SUMMARY OF'.
   994         12  FILLER              PIC  X(46)     VALUE SPACES.
   995         12  FILLER              PIC  X(15)     VALUE
   996                 'ACCOUNT SUMMARY'.
   997     05  DUM-SUM-LINE2.
   998         12  FILLER              PIC  X(53)     VALUE SPACES.
   999         12  FILLER              PIC  X(28)     VALUE
  1000                'PREMIUM CHANGES DUE BORROWER'.
  1001         12  FILLER              PIC  X(42)     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* CIB001.cbl (/apps/prod/cid1p/copy/ECSDMSUM)
  1002         12  DUM-SUM-LN2-RUN-DT  PIC  X(10)     VALUE SPACES.
  1003     05  DUM-SUM-LINE3.
  1004         12  FILLER              PIC  X(55)     VALUE SPACES.
  1005         12  FILLER              PIC  X(14)     VALUE
  1006                'PERIOD ENDING '.
  1007         12  DUM-SUM-LN3-DT      PIC  X(10).
  1008         12  FILLER              PIC  X(54)     VALUE SPACES.
  1009     05  DUM-SUM-LINE4.
  1010         12  FILLER              PIC  X(1)      VALUE '0'.
  1011         12  FILLER              PIC  X(14)
  1012             VALUE 'ACCOUNT NO. - '.
  1013         12  DUM-SUM-LN4-CAR-GRP PIC  X(7).
  1014         12  FILLER              PIC  X         VALUE '-'.
  1015         12  DUM-SUM-LN4-RESP    PIC  X(10).
  1016         12  FILLER              PIC  X(45).
  1017         12  FILLER              PIC  X(11)     VALUE
  1018                'REMIT TO - '.
  1019         12  DUM-SUM-LN4-ACCT    PIC  X(10).
  1020         12  FILLER              PIC  X(34)     VALUE SPACES.
  1021         12  DUM-SUM-LN4-REMIT   PIC  X(30)     VALUE SPACES.
  1022         12  FILLER              PIC  XX.
  1023     05  DUM-SUM-LINE5.
  1024         12  FILLER              PIC X(1)  VALUE '0'.
  1025         12  FILLER              PIC X(50) VALUE
  1026           'FOR YOUR REVIEW:  The list of transactions below r'.
  1027         12  FILLER              PIC X(50) VALUE
  1028           'esult in amounts due to your customers.  The two s'.
  1029         12  FILLER              PIC X(32) VALUE
  1030           'ections summarize the           '.
  1031     05  DUM-SUM-LINE6.
  1032         12  FILLER              PIC X(1)  VALUE ' '.
  1033         12  FILLER              PIC X(50) VALUE
  1034           'transactions for Credit Insurance contracts you is'.
  1035         12  FILLER              PIC X(50) VALUE
  1036           'sued that require you to refund your customer(s) t'.
  1037         12  FILLER              PIC X(32) VALUE
  1038           'hrough either a credit to their '.
  1039     05  DUM-SUM-LINE7.
  1040         12  FILLER              PIC X(1)  VALUE ' '.
  1041         12  FILLER              PIC X(50) VALUE
  1042           'loan or a direct refund.    You were previously no'.
  1043         12  FILLER              PIC X(50) VALUE
  1044           'tified by letter of the details for each transacti'.
  1045         12  FILLER              PIC X(32) VALUE
  1046           'on listed below.  These         '.
  1047     05  DUM-SUM-LINE8.
  1048         12  FILLER              PIC X(1)  VALUE ' '.
  1049         12  FILLER              PIC X(50) VALUE
  1050           'transactions are reflected in your current billing'.
  1051         12  FILLER              PIC X(50) VALUE
  1052           ' statement balance.  Please use this summary to en'.
  1053         12  FILLER              PIC X(32) VALUE
  1054             'sure that all required          '.
  1055     05  DUM-SUM-LINE9.
  1056         12  FILLER              PIC X(1)  VALUE ' '.
  1057         12  FILLER              PIC X(50) VALUE
  1058           'transactions have been completed as instructed.  I'.
  1059         12  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* CIB001.cbl (/apps/prod/cid1p/copy/ECSDMSUM)
  1060           'f you have any questions, contact us at 800-826-65'.
  1061         12  FILLER              PIC X(32) VALUE
  1062             '87.                             '.
  1063     05  DUM-SUM-DASH.
  1064         12  FILLER              PIC  X         VALUE SPACES.
  1065         12  FILLER              PIC  X(132)    VALUE ALL '-'.
  1066     05  DUM-SUM-LINE10-C.
  1067         12  FILLER              PIC  X(48)     VALUE SPACES.
  1068         12  FILLER              PIC  X(37)
  1069             VALUE '       CREDIT TO LOAN BALANCE        '.
  1070         12  FILLER              PIC  X(48)     VALUE SPACES.
  1071     05  DUM-SUM-LINE10-R.
  1072         12  FILLER              PIC  X(48)     VALUE SPACES.
  1073         12  FILLER              PIC  X(37)
  1074             VALUE '      REFUND DIRECT TO BORROWER      '.
  1075         12  FILLER              PIC  X(48)     VALUE SPACES.
  1076     05  DUM-SUM-LINE11.
  1077         12  FILLER              PIC  X         VALUE SPACES.
  1078         12  FILLER              PIC  X(102)    VALUE ALL '-'.
  1079         12  FILLER              PIC  X(1)      VALUE SPACES.
  1080         12  FILLER              PIC  X(7)      VALUE ALL '-'.
  1081         12  FILLER              PIC  X(15)
  1082             VALUE 'FOR REVIEW ONLY'.
  1083         12  FILLER              PIC  X(7)      VALUE ALL '-'.
  1084     05  DUM-SUM-LINE12-C.
  1085         12  FILLER              PIC  X(1)      VALUE SPACES.
  1086         12  FILLER              PIC  X(44)     VALUE
  1087             'CERTIFICATE     LAST     EFFECTIVE LIFE PREM'.
  1088         12  FILLER              PIC  X(44)     VALUE
  1089             ' LIFE PREM LIFE PREM DIS PREM  DIS PREM DIS '.
  1090         12  FILLER              PIC  X(44)     VALUE
  1091             'PREM   TOTAL   TOTAL NET  TOTAL NET  COMMENT'.
  1092     05  DUM-SUM-LINE12-R.
  1093         12  FILLER              PIC  X(1)      VALUE SPACES.
  1094         12  FILLER              PIC  X(44)     VALUE
  1095             'CERTIFICATE     LAST     EFFECTIVE LIFE RFND'.
  1096         12  FILLER              PIC  X(44)     VALUE
  1097             ' LIFE RFND LIFE RFND DIS RFND  DIS RFND DIS '.
  1098         12  FILLER              PIC  X(44)     VALUE
  1099             'RFND   TOTAL   TOTAL NET  TOTAL NET  COMMENT'.
  1100     05  DUM-SUM-LINE13-C.
  1101         12  FILLER              PIC  X(1)      VALUE SPACES.
  1102         12  FILLER              PIC  X(44)     VALUE
  1103             '  NUMBER        NAME        DATE   REPORTED '.
  1104         12  FILLER              PIC  X(44)     VALUE
  1105             '  CHANGED    NET     REPORTED  CHANGED    NE'.
  1106         12  FILLER              PIC  X(44)     VALUE
  1107             'T       DUE   PREM CHANGE PREM CHANGE       '.
  1108     05  DUM-SUM-LINE13-R.
  1109         12  FILLER              PIC  X(1)      VALUE SPACES.
  1110         12  FILLER              PIC  X(44)     VALUE
  1111             '  NUMBER        NAME        DATE   REPORTED '.
  1112         12  FILLER              PIC  X(44)     VALUE
  1113             '  CHANGED    NET     REPORTED  CHANGED    NE'.
  1114         12  FILLER              PIC  X(44)     VALUE
  1115             'T       DUE   RFND CHANGE RFND CHANGE       '.
  1116     05  DUM-SUM-LINE14.
  1117         12  FILLER              PIC  X(1)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* CIB001.cbl (/apps/prod/cid1p/copy/ECSDMSUM)
  1118         12  FILLER              PIC  X(44)     VALUE
  1119             '                                     AS:    '.
  1120         12  FILLER              PIC  X(44)     VALUE
  1121             '    TO:     CHANGE     AS:       TO:     CHA'.
  1122         12  FILLER              PIC  X(44)     VALUE
  1123             'NGE   BORROWER   ACCOUNT     CSO            '.
  1124     05  DUM-SUM-LINE15.
  1125         12  FILLER              PIC  X(1)      VALUE SPACES.
  1126         12  FILLER              PIC  X(44)     VALUE
  1127             '----------- ------------ -------- --------- '.
  1128         12  FILLER              PIC  X(44)     VALUE
  1129             '--------- --------- --------- --------- ----'.
  1130         12  FILLER              PIC  X(44)     VALUE
  1131             '----- --------- --------- --------- --------'.
  1132     05  DUM-SUM-NONE-LINE.
  1133         12  FILLER              PIC X(13)      VALUE SPACES.
  1134         12  FILLER              PIC X(04)      VALUE 'NONE'.
  1135         12  FILLER              PIC X(116)     VALUE SPACES.
  1136     05  DUM-SUM-NO-TRAN-LINE.
  1137         12  FILLER              PIC X(13)      VALUE SPACES.
  1138         12  FILLER              PIC X(28)
  1139             VALUE 'NO TRANSACTIONS AT THIS TIME'.
  1140         12  FILLER              PIC X(92)      VALUE SPACES.
  1141     05  DUM-SUM-BLANK-LINE.
  1142         12  DUM-SUM-BLANK-CC    PIC X(1)       VALUE SPACES.
  1143         12  FILLER              PIC X(132)     VALUE SPACES.
  1144     05  DUM-SUM-FOOTER.
  1145         12  FILLER              PIC X(1)       VALUE ' '.
  1146         12  FILLER              PIC X(50)      VALUE
  1147            '*The amounts reflected on this summary may vary sl'.
  1148         12  FILLER              PIC X(50)      VALUE
  1149            'ightly from your statement due to rounding issues.'.
  1150         12  FILLER              PIC X(32)      VALUE SPACES.
  1151
  1152 PROCEDURE DIVISION.
  1153
* 1154                                 COPY ELCDTERX.
  1155******************************************************************04/15/98
  1156*                                                                *ELCDTERX
  1157*                                                                *ELCDTERX
  1158*                            ELCDTERX.                           *   LV002
  1159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1160*                            VMOD=2.007                          *ELCDTERX
  1161*                                                                *ELCDTERX
  1162*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1163*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1164*      = ELCDTEFD)                                               *ELCDTERX
  1165*                                                                *ELCDTERX
  1166******************************************************************ELCDTERX
  1167                                                                  ELCDTERX
  1168     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1169                                                                  ELCDTERX
  1170     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1171     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1172     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1173                                                                  ELCDTERX
  1174     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1175                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1176******************************************************************ELCDTERX
  1177*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1178*          WARNING MESSAGES.                                      ELCDTERX
  1179******************************************************************ELCDTERX
  1180     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1181         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1182                                                                  ELCDTERX
  1183     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1184                                                                  ELCDTERX
  1185     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1186                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1187                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1188                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1189                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1190                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1191                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1192                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1193                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1194                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1195                                                                  ELCDTERX
  1196     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1197                                                                  ELCDTERX
  1198     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1199                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1200                                                                  ELCDTERX
  1201     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1202     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1203     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1204     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1205                                                                  ELCDTERX
  1206     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1207         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1208     ELSE                                                         ELCDTERX
  1209         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1210                                                                  ELCDTERX
  1211     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1212         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1213     ELSE                                                         ELCDTERX
  1214         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1215                                                                  ELCDTERX
  1216 0005-READ--CARD.                                                 ELCDTERX
  1217     READ DISK-DATE                                               ELCDTERX
  1218         AT END CLOSE DISK-DATE                                   ELCDTERX
  1219             GO TO 0060-READ--TEST.                               ELCDTERX
  1220                                                                  ELCDTERX
  1221     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1222                                                                  ELCDTERX
  1223     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1224         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1225         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1226         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1227         GO TO 0005-READ--CARD.                                   ELCDTERX
  1228                                                                  ELCDTERX
  1229     IF DD-ID = 'CLAD'                                            ELCDTERX
  1230         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1231         GO TO 0005-READ--CARD.                                   ELCDTERX
  1232                                                                  ELCDTERX
  1233     IF DD-ID = 'CLAX'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1234         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1235         GO TO 0005-READ--CARD.                                   ELCDTERX
  1236                                                                  ELCDTERX
  1237     IF DD-ID = 'CLAF'                                            ELCDTERX
  1238         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1239         GO TO 0005-READ--CARD.                                   ELCDTERX
  1240                                                                  ELCDTERX
  1241     IF DD-ID = 'CLAC'                                            ELCDTERX
  1242         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1243                                                                  ELCDTERX
  1244     IF DD-ID = 'CARR'                                            ELCDTERX
  1245         GO TO 0015-READ--CARR.                                   ELCDTERX
  1246                                                                  ELCDTERX
  1247     IF DD-ID = 'STAT'                                            ELCDTERX
  1248         GO TO 0020-READ--STAT.                                   ELCDTERX
  1249                                                                  ELCDTERX
  1250     IF DD-ID = 'BUSC'                                            ELCDTERX
  1251         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1252                                                                  ELCDTERX
  1253     IF DD-ID = 'MORT'                                            ELCDTERX
  1254         GO TO 0030-READ--MORT.                                   ELCDTERX
  1255                                                                  ELCDTERX
  1256     IF DD-ID = 'CLAI'                                            ELCDTERX
  1257         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1258                                                                  ELCDTERX
  1259     IF DD-ID = 'COLC'                                            ELCDTERX
  1260         GO TO 0065-READ--COLC.                                   ELCDTERX
  1261                                                                  ELCDTERX
  1262     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1263        DD-IDA = 'CL'                                             ELCDTERX
  1264         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1265                                                                  ELCDTERX
  1266     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1267        DD-IDA = 'PO'                                             ELCDTERX
  1268         GO TO 0050-READ--POXX.                                   ELCDTERX
  1269                                                                  ELCDTERX
  1270     IF DD-ID = 'OPCA'                                            ELCDTERX
  1271         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1272                                                                  ELCDTERX
  1273     IF DD-ID = 'OPST'                                            ELCDTERX
  1274         GO TO 0072-READ--OPST.                                   ELCDTERX
  1275                                                                  ELCDTERX
  1276     IF DD-ID = 'OPBS'                                            ELCDTERX
  1277         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1278                                                                  ELCDTERX
  1279     IF DD-ID = 'OPMS'                                            ELCDTERX
  1280         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1281                                                                  ELCDTERX
  1282     GO TO 0005-READ--CARD.                                       ELCDTERX
  1283                                                                  ELCDTERX
  1284 0010-READ--CLAC.                                                 ELCDTERX
  1285     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1286     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1287     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1288     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1289     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1290     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1291     GO TO 0005-READ--CARD.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1292                                                                  ELCDTERX
  1293 0015-READ--CARR.                                                 ELCDTERX
  1294     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1295     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1296        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1297        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1298        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1299        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1300        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1301        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1302        MOVE DD-CARR1-SECPAY-SW
  1303                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1304     END-IF
  1305                                                                  ELCDTERX
  1306     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1307     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1308        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1309        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1310        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1311        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1312        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1313        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1314        MOVE DD-CARR2-SECPAY-SW
  1315                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1316     END-IF
  1317                                                                  ELCDTERX
  1318                                                                  ELCDTERX
  1319     GO TO 0005-READ--CARD.                                       ELCDTERX
  1320                                                                  ELCDTERX
  1321 0020-READ--STAT.                                                 ELCDTERX
  1322     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1323     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1324        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1325         GO TO 0005-READ--CARD.                                   ELCDTERX
  1326                                                                  ELCDTERX
  1327     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1328     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1329     GO TO 0020-READ--STAT.                                       ELCDTERX
  1330                                                                  ELCDTERX
  1331 0025-READ--BUSC.                                                 ELCDTERX
  1332     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1333     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1334        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1335         GO TO 0005-READ--CARD.                                   ELCDTERX
  1336                                                                  ELCDTERX
  1337     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1338     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1339     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1340                                                                  ELCDTERX
  1341 0030-READ--MORT.                                                 ELCDTERX
  1342     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1343     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1344        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1345         GO TO 0005-READ--CARD.                                   ELCDTERX
  1346                                                                  ELCDTERX
  1347     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1348     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1349     GO TO 0030-READ--MORT.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1350                                                                  ELCDTERX
  1351 0035-READ--CLXX.                                                 ELCDTERX
  1352     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1353          GO TO 0005-READ--CARD.                                  ELCDTERX
  1354                                                                  ELCDTERX
  1355     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1356         DISPLAY '***********************************************'ELCDTERX
  1357         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1358         DISPLAY '***********************************************'ELCDTERX
  1359         GO TO 0055-READ--STOP.                                   ELCDTERX
  1360                                                                  ELCDTERX
  1361     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1362        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1363         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1364                                                                  ELCDTERX
  1365     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1366        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1367         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1368                                                                  ELCDTERX
  1369*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1370     GO TO 0005-READ--CARD.                                       ELCDTERX
  1371                                                                  ELCDTERX
  1372 0040-READ--CLAI.                                                 ELCDTERX
  1373     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1374     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1375        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1376         GO TO 0005-READ--CARD.                                   ELCDTERX
  1377                                                                  ELCDTERX
  1378     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1379     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1380     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1381                                                                  ELCDTERX
  1382 0045-READ--DUMP.                                                 ELCDTERX
  1383     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1384     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1385                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1386     PERFORM ABEND-PGM.                                           ELCDTERX
  1387                                                                  ELCDTERX
  1388 0050-READ--POXX.                                                 ELCDTERX
  1389     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1390         GO TO 0005-READ--CARD.                                   ELCDTERX
  1391                                                                  ELCDTERX
  1392     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1393         DISPLAY '***********************************************'ELCDTERX
  1394         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1395         DISPLAY '***********************************************'ELCDTERX
  1396         GO TO 0055-READ--STOP.                                   ELCDTERX
  1397                                                                  ELCDTERX
  1398     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1399     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1400     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1401     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1402                                                                  ELCDTERX
  1403     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1404         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1405     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1406         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1407                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1408     GO TO 0005-READ--CARD.                                       ELCDTERX
  1409                                                                  ELCDTERX
  1410 0055-READ--STOP.                                                 ELCDTERX
  1411     GOBACK.                                                      ELCDTERX
  1412                                                                  ELCDTERX
  1413 0060-READ--TEST.                                                 ELCDTERX
  1414     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1415        CLAX-ID         = SPACE  OR                               ELCDTERX
  1416        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1417         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1418                                                                  ELCDTERX
  1419     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1420     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1421                                                                  ELCDTERX
  1422 0065-READ--COLC.                                                 ELCDTERX
  1423     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1424     GO TO 0005-READ--CARD.                                       ELCDTERX
  1425                                                                  ELCDTERX
  1426 0070-READ--OPCA.                                                 ELCDTERX
  1427                                                                  ELCDTERX
  1428     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1429                                                                  ELCDTERX
  1430     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1431             OR                                                   ELCDTERX
  1432         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1433         GO TO 0005-READ--CARD.                                   ELCDTERX
  1434                                                                  ELCDTERX
  1435     ADD 1                       TO INDEXCA.                      ELCDTERX
  1436     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1437                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1438     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1439                                                                  ELCDTERX
  1440 0072-READ--OPST.                                                 ELCDTERX
  1441                                                                  ELCDTERX
  1442     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1443                                                                  ELCDTERX
  1444     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1445             OR                                                   ELCDTERX
  1446         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1447         GO TO 0005-READ--CARD.                                   ELCDTERX
  1448                                                                  ELCDTERX
  1449     ADD 1                       TO INDEXST.                      ELCDTERX
  1450     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1451                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1452     GO TO 0072-READ--OPST.                                       ELCDTERX
  1453                                                                  ELCDTERX
  1454 0074-READ--OPBS.                                                 ELCDTERX
  1455                                                                  ELCDTERX
  1456     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1457                                                                  ELCDTERX
  1458     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1459             OR                                                   ELCDTERX
  1460         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1461         GO TO 0005-READ--CARD.                                   ELCDTERX
  1462                                                                  ELCDTERX
  1463     ADD 1                       TO INDEXBS.                      ELCDTERX
  1464     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1465     GO TO 0074-READ--OPBS.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* CIB001.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1466                                                                  ELCDTERX
  1467 0079-READ--EXIT.                                                 ELCDTERX
  1468*    EXIT.                                                        ELCDTERX
  1469******************************************************************ELCDTERX
  1470
  1471     PERFORM 0010-OPEN-FILES     THRU 0010-EXIT
  1472
  1473     SORT SORT-FILE ASCENDING  SR-SORT-KEY
  1474        INPUT PROCEDURE
  1475           0100-SORT-BILL-STMTS  THRU 0100-EXIT
  1476        GIVING SRTD-BILL-STMTS
  1477
  1478     IF SORT-RETURN NOT = ZEROS
  1479        DISPLAY ' SORT 01 ABENDED '
  1480        MOVE '0101'              TO WS-RETURN-CODE
  1481        GO TO ABEND-PGM
  1482     END-IF
  1483
  1484     CLOSE BILLING-STATEMENTS
  1485     display ' end of sort one ' s1-in-cnt ' ' s1-rel-cnt
  1486
  1487     MOVE ' '                    TO WS-EOF-SW
  1488     MOVE ZEROS                  TO WS-SK-SEQ-NO
  1489
  1490     SORT SORT-FILE2 ASCENDING  SR2-SORT-KEY
  1491        INPUT PROCEDURE
  1492           0200-SORT-ACCT-SUMM   THRU 0200-EXIT
  1493        GIVING SRTD-ACCT-SUMM
  1494
  1495     IF SORT-RETURN NOT = ZEROS
  1496        DISPLAY ' SORT 02 ABENDED '
  1497        MOVE '0101'              TO WS-RETURN-CODE
  1498        GO TO ABEND-PGM
  1499     END-IF
  1500
  1501     CLOSE account-summary
  1502     display ' end of sort two ' s2-in-cnt ' ' s2-rel-cnt
  1503
  1504     perform 0310-open-files     thru 0310-exit
  1505     perform 0320-init           thru 0320-exit
  1506     perform 0350-process-matches thru 0350-exit until
  1507        end-of-stmts and end-of-summ
  1508     perform 0400-close-files    thru 0400-exit
  1509
  1510     display ' stmts in          ' s1-in-cnt
  1511     display ' stmts released    ' s1-rel-cnt
  1512     display ' stmts returned    ' s1-ret-cnt
  1513     display ' summ  in          ' s2-in-cnt
  1514     display ' summ  released    ' s2-rel-cnt
  1515     display ' summ  returned    ' s2-ret-cnt
  1516     display ' statments out     ' stmts-OUT-CNT
  1517
  1518     goback
  1519
  1520     .
  1521 0010-OPEN-FILES.
  1522
  1523     OPEN INPUT BILLING-STATEMENTS account-summary
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* CIB001.cbl
  1524
  1525     .
  1526 0010-EXIT.
  1527     EXIT.
  1528
  1529 0100-SORT-BILL-STMTS.
  1530
  1531     PERFORM 0140-READ-INPUT     THRU 0140-EXIT
  1532     PERFORM 0105-PROCESS-STMTS  THRU 0105-EXIT UNTIL
  1533        END-OF-INPUT
  1534
  1535     .
  1536 0100-EXIT.
  1537     EXIT.
  1538
  1539 0105-PROCESS-STMTS.
  1540
  1541     IF STMT-RECORD (1:1) = '1'
  1542        PERFORM 0110-PROCESS-HEAD THRU 0110-EXIT
  1543     end-if
  1544
  1545     add 1                       to ws-sk-seq-no
  1546     move ws-stmt-key            to sr-sort-key
  1547     move stmt-record            to sr-report
  1548     perform 0120-release        thru 0120-exit
  1549
  1550     PERFORM 0140-READ-INPUT     THRU 0140-EXIT
  1551
  1552     .
  1553 0105-EXIT.
  1554     EXIT.
  1555
  1556 0110-PROCESS-HEAD.
  1557
  1558     perform varying a1 from +1 by +1 until a1 > +4
  1559        move stmt-record         to ws-hdg (a1)
  1560        PERFORM 0140-READ-INPUT  THRU 0140-EXIT
  1561     end-perform
  1562
  1563     move ws-hdg (4) (16:1)      to ws-sk-carrier
  1564     move ws-hdg (4)  (17:6)     to ws-sk-grouping
  1565     move ws-hdg (4)  (24:10)    to ws-sk-resp-no
  1566     move ws-hdg (4)  (90:10)    to ws-sk-acct-no
  1567     if ws-sk-acct-no = spaces
  1568        move ws-sk-resp-no       to ws-sk-acct-no
  1569     end-if
  1570     if ws-stmt-key (1:17) = spaces
  1571        display ' found overall recap '
  1572        move '99999999999999999999999999900000000000'
  1573                                 to ws-stmt-key
  1574     end-if
  1575     perform varying a1 from +1 by +1 until a1 > +4
  1576        add 1                    to ws-sk-seq-no
  1577        move ws-stmt-key         to sr-sort-key
  1578        move ws-hdg (a1)         to sr-report
  1579        perform 0120-release     thru 0120-exit
  1580     end-perform
  1581
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* CIB001.cbl
  1582     .
  1583 0110-EXIT.
  1584     EXIT.
  1585
  1586 0120-release.
  1587
  1588     release sortwork
  1589     add 1                       to s1-rel-cnt
  1590
  1591     .
  1592 0120-exit.
  1593     exit.
  1594
  1595 0140-READ-INPUT.
  1596
  1597     READ BILLING-STATEMENTS AT END
  1598        SET END-OF-INPUT         TO TRUE
  1599     END-READ
  1600
  1601     IF NOT END-OF-INPUT
  1602        ADD 1                    TO s1-IN-CNT
  1603     END-IF
  1604
  1605     .
  1606 0140-EXIT.
  1607     EXIT.
  1608
  1609 0200-SORT-ACCT-SUMM.
  1610
  1611     PERFORM 0240-READ-INPUT     THRU 0240-EXIT
  1612     PERFORM 0205-PROCESS-SUMM   THRU 0205-EXIT UNTIL
  1613        END-OF-INPUT
  1614
  1615     .
  1616 0200-EXIT.
  1617     EXIT.
  1618
  1619 0205-PROCESS-SUMM.
  1620
  1621     IF ACCT-SUMM-REC (1:1) = '1'
  1622        PERFORM 0210-PROCESS-HEAD THRU 0210-EXIT
  1623     end-if
  1624
  1625     add 1                       to ws-sk-seq-no
  1626     move ws-stmt-key            to sr2-sort-key
  1627     move acct-summ-rec          to sr2-report
  1628     perform 0220-release        thru 0220-exit
  1629
  1630     PERFORM 0240-READ-INPUT     THRU 0240-EXIT
  1631
  1632     .
  1633 0205-EXIT.
  1634     EXIT.
  1635
  1636 0220-release.
  1637
  1638     release sortwork2
  1639     add 1                       to s2-rel-cnt
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* CIB001.cbl
  1640
  1641     .
  1642 0220-exit.
  1643     exit.
  1644
  1645 0210-PROCESS-HEAD.
  1646
  1647     perform varying a1 from +1 by +1 until a1 > +4
  1648        move acct-summ-rec          to ws-hdg (a1)
  1649        PERFORM 0240-READ-INPUT     THRU 0240-EXIT
  1650     end-perform
  1651
  1652     move spaces                 to ws-hdg (3) (121:12)
  1653     move ws-hdg (4) (16:1)      to ws-sk-carrier
  1654     move ws-hdg (4)  (17:6)     to ws-sk-grouping
  1655     move ws-hdg (4)  (24:10)    to ws-sk-resp-no
  1656     move ws-hdg (4)  (90:10)    to ws-sk-acct-no
  1657
  1658     if ws-sk-acct-no = spaces
  1659        move ws-sk-resp-no       to ws-sk-acct-no
  1660     end-if
  1661
  1662     perform varying a1 from +1 by +1 until a1 > +4
  1663        add 1                    to ws-sk-seq-no
  1664        move ws-stmt-key         to sr2-sort-key
  1665        move ws-hdg (a1)         to sr2-report
  1666        perform 0220-release     thru 0220-exit
  1667     end-perform
  1668
  1669     .
  1670 0210-EXIT.
  1671     EXIT.
  1672
  1673 0240-READ-INPUT.
  1674
  1675     READ ACCOUNT-SUMMARY AT END
  1676        SET END-OF-INPUT         TO TRUE
  1677     END-READ
  1678
  1679     IF NOT END-OF-INPUT
  1680        ADD 1                    TO s2-IN-CNT
  1681     END-IF
  1682
  1683     .
  1684 0240-EXIT.
  1685     EXIT.
  1686
  1687 0310-OPEN-FILES.
  1688
  1689     OPEN INPUT SRTD-BILL-STMTS SRTD-ACCT-SUMM
  1690         output STMTS-OUT
  1691
  1692     .
  1693 0310-EXIT.
  1694     EXIT.
  1695
  1696 0320-INIT.
  1697
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* CIB001.cbl
  1698     PERFORM 0360-READ-STMTS     THRU 0360-EXIT
  1699     move sbr-key (1:27)         to ws-prev-stmt-key
  1700     PERFORM 0365-READ-SUMM      THRU 0365-EXIT
  1701     move sar-key (1:27)         to ws-prev-summ-key
  1702
  1703     MOVE RUN-MO       TO WRK-RUN-MM.
  1704     MOVE RUN-DA       TO WRK-RUN-DD.
  1705     MOVE RUN-CCYY     TO WRK-RUN-YYYY.
  1706     MOVE WRK-RUN-DATE TO DUM-SUM-LN2-RUN-DT
  1707                          DUM-SUM-LN3-DT.
  1708
  1709     .
  1710 0320-EXIT.
  1711     EXIT.
  1712
  1713 0350-PROCESS-MATCHES.
  1714
  1715     if sbr-key (1:27) = sar-key (1:27)
  1716        perform 0370-process-eq  thru 0370-exit
  1717        move sbr-key (1:27)      to ws-prev-stmt-key
  1718     else
  1719        if sbr-key (1:27) > sar-key (1:27)
  1720           perform 0375-process-gt thru 0375-exit
  1721           move sar-key (1:27)   to ws-prev-summ-key
  1722        else
  1723           perform 0380-process-lt thru 0380-exit
  1724           move sbr-key (1:27)   to ws-prev-stmt-key
  1725        end-if
  1726     end-if
  1727
  1728     .
  1729 0350-EXIT.
  1730     EXIT.
  1731
  1732 0360-READ-STMTS.
  1733
  1734     READ SRTD-BILL-STMTS AT END
  1735        SET END-OF-STMTS         TO TRUE
  1736        move high-values         to sbr-key
  1737     END-READ
  1738
  1739     IF NOT END-OF-STMTS
  1740        ADD 1                    TO s1-RET-CNT
  1741     END-IF
  1742
  1743     .
  1744 0360-EXIT.
  1745     EXIT.
  1746
  1747 0365-READ-SUMM.
  1748
  1749     READ SRTD-ACCT-SUMM AT END
  1750        SET END-OF-SUMM          TO TRUE
  1751        move high-values         to sar-key
  1752     END-READ
  1753
  1754     IF NOT END-OF-SUMM
  1755        ADD 1                    TO s2-RET-CNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* CIB001.cbl
  1756     END-IF
  1757
  1758     .
  1759 0365-EXIT.
  1760     EXIT.
  1761
  1762 0370-process-eq.
  1763
  1764     perform until (sbr-key (1:27) > ws-prev-stmt-key)
  1765        or (end-of-stmts)
  1766        WRITE STMTS-OUT-REC      FROM SBR-RECORD
  1767        add 1 to stmts-OUT-CNT
  1768        PERFORM 0360-READ-STMTS  THRU 0360-EXIT
  1769     END-PERFORM
  1770
  1771     .
  1772 0370-exit.
  1773     exit.
  1774
  1775 0375-process-gt.
  1776
  1777     perform until (sar-key (1:27) > ws-prev-summ-key)
  1778        or (end-of-summ)
  1779        WRITE STMTS-OUT-REC      FROM SaR-RECORD
  1780        add 1 to stmts-OUT-CNT
  1781        PERFORM 0365-READ-summ   THRU 0365-EXIT
  1782     END-PERFORM
  1783
  1784     .
  1785 0375-exit.
  1786     exit.
  1787
  1788 0380-process-lt.
  1789
  1790     perform until (sbr-key (1:27) > ws-prev-stmt-key)
  1791        or (end-of-stmts)
  1792        WRITE STMTS-OUT-REC      FROM SBR-RECORD
  1793        add 1 to stmts-OUT-CNT
  1794        PERFORM 0360-READ-STMTS  THRU 0360-EXIT
  1795     END-PERFORM
  1796
  1797    IF WS-PREV-STMT-KEY = '999999999999999999999999999'
  1798        GO TO 0380-EXIT
  1799    END-IF
  1800
  1801*** NEED TO WRITE A DUMMY ACCOUNT SUMMARY PAGE
  1802
  1803    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE1
  1804    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE2
  1805    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE3
  1806    MOVE WS-PREV-STMT-KEY (1:7) TO DUM-SUM-LN4-CAR-GRP
  1807    MOVE WS-PREV-STMT-KEY (8:10) TO DUM-SUM-LN4-RESP
  1808    MOVE WS-PREV-STMT-KEY (18:10) TO DUM-SUM-LN4-ACCT
  1809    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE4
  1810    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE5
  1811    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE6
  1812    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE7
  1813    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* CIB001.cbl
  1814    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE9
  1815    WRITE STMTS-OUT-REC FROM DUM-SUM-DASH
  1816    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE10-C
  1817    WRITE STMTS-OUT-REC FROM DUM-SUM-DASH
  1818    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE11
  1819    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE12-C
  1820    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE13-C
  1821    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE14
  1822    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE15
  1823    WRITE STMTS-OUT-REC FROM DUM-SUM-NO-TRAN-LINE
  1824    MOVE '-' TO DUM-SUM-BLANK-CC
  1825    WRITE STMTS-OUT-REC FROM DUM-SUM-BLANK-LINE
  1826    WRITE STMTS-OUT-REC FROM DUM-SUM-DASH
  1827    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE10-R
  1828    WRITE STMTS-OUT-REC FROM DUM-SUM-DASH
  1829    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE11
  1830    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE12-R
  1831    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE13-R
  1832    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE14
  1833    WRITE STMTS-OUT-REC FROM DUM-SUM-LINE15
  1834    WRITE STMTS-OUT-REC FROM DUM-SUM-NONE-LINE
  1835    MOVE ' ' TO DUM-SUM-BLANK-CC
  1836    PERFORM 24 TIMES
  1837        WRITE STMTS-OUT-REC FROM DUM-SUM-BLANK-LINE
  1838    END-PERFORM
  1839    WRITE STMTS-OUT-REC FROM DUM-SUM-FOOTER.
  1840
  1841*    display ' should not have gotten to 0380 '
  1842*    display ' stmt keys ' sbr-key ' ' ws-prev-stmt-key
  1843*    display ' summ keys ' sar-key ' ' ws-prev-summ-key
  1844
  1845*    goback.
  1846
  1847     .
  1848 0380-exit.
  1849     exit.
  1850
  1851 0400-CLOSE-FILES.
  1852
  1853     CLOSE  SRTD-BILL-STMTS SRTD-ACCT-SUMM STMTS-OUT
  1854
  1855     .
  1856 0400-EXIT.
  1857     EXIT.
  1858
  1859 8500-DATE-CONVERT.
  1860
  1861     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  1862
  1863     .
  1864 8500-EXIT.
  1865     EXIT.
  1866
  1867 ABEND-PGM.
* 1868                     COPY ELCABEND.
  1869***************************************************************** 04/14/98
  1870*                                                               * ELCABEND
  1871*                            ELCABEND.                          *    LV003
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* CIB001.cbl (/apps/prod/cid1p/copy/ELCABEND)
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1873*                            VMOD 2.002                              CL**2
  1874*                                                               * ELCABEND
  1875*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  1876*            AND THEN ABENDS.                                   * ELCABEND
  1877*                                                               * ELCABEND
  1878*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  1879*                                                               * ELCABEND
  1880***************************************************************** ELCABEND
  1881*APS-010.                                                         ELCABEND
  1882     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  1883     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  1884                                                                  ELCABEND
  1885     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  1886         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1887         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1888                                 UPON CONSOLE.                    ELCABEND
  1889                                                                  ELCABEND
  1890     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  1891         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1892         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1893                                 UPON CONSOLE.                    ELCABEND
  1894                                                                  ELCABEND
  1895     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1896     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1897                                 UPON CONSOLE.                    ELCABEND
  1898                                                                  ELCABEND
  1899     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  1900     CALL 'ABORTME'.
  1901                                                                  ELCABEND
  1902 APS-EXIT.                                                        ELCABEND
  1903     EXIT.                                                        ELCABEND
  1904
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       54624     Code:        7917
