* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SQLDCCGAAP.cbl
* Options: int("SQLDCCGAAP.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SQLDCCGAAP.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SQLDCCGAAP.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SQLDCCGAAP.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*          "0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2****************************************************************
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID. sqldccgaap.
     5 AUTHOR.   Pablo.
     6
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    10*            *                                                   *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SQLDCCGAAP.cbl
    14*            *                                                   *
    15*            *****************************************************
    16
    17******************************************************************
    18*                   C H A N G E   L O G
    19*
    20* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    21*-----------------------------------------------------------------
    22*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    23* EFFECTIVE    NUMBER
    24*-----------------------------------------------------------------
    25* 070115  IR2015070100001  PEMA  ADD NULL IND TO INSERT STMT
    26******************************************************************
    27 ENVIRONMENT DIVISION.
    28 CONFIGURATION SECTION.
    29 INPUT-OUTPUT SECTION.
    30 FILE-CONTROL.
    31
    32     SELECT FILE-IN          ASSIGN TO SYS010
    33                             ORGANIZATION IS LINE SEQUENTIAL.
    34
    35     SELECT DISK-DATE        ASSIGN TO SYS019.
    36
    37 DATA DIVISION.
    38 FILE SECTION.
    39
    40 FD  FILE-IN
    41     BLOCK CONTAINS 0 RECORDS
    42     RECORDING MODE F.
    43
    44 01  FILE-IN-REC                PIC X(410).
    45
    46 FD  DISK-DATE
*   47                              COPY ELCDTEFD.
    48******************************************************************04/15/98
    49*                                                                *ELCDTEFD
    50*                                                                *ELCDTEFD
    51*                            ELCDTEFD.                           *   LV002
    52*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    53*                            VMOD=2.007                          *   CL**2
    54*                                                                *ELCDTEFD
    55******************************************************************ELCDTEFD
    56     BLOCK CONTAINS 0 RECORDS
    57     RECORDING MODE F.                                            ELCDTEFD
    58                                                                  ELCDTEFD
    59 01  DATE-DISK.                                                   ELCDTEFD
    60     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    61     12  FILLER                      PIC  X(14).                  ELCDTEFD
    62     12  DD-CR1                      PIC  9.                      ELCDTEFD
    63     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    64     12  DD-CR2                      PIC  9.                      ELCDTEFD
    65     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    66     12  FILLER                      PIC  X(20).                  ELCDTEFD
    67                                                                  ELCDTEFD
    68 01  DATE-DISK-R.                                                 ELCDTEFD
    69     12  FILLER                      PIC  X(4).                   ELCDTEFD
    70     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    71                                     PIC  X(32).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    72                                                                  ELCDTEFD
    73 01  DATE-DISK-T.                                                 ELCDTEFD
    74     12  FILLER                      PIC  X(4).                   ELCDTEFD
    75     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    76                                     PIC  X(48).                  ELCDTEFD
    77                                                                  ELCDTEFD
    78 01  DATE-DISK-M.                                                 ELCDTEFD
    79     12  FILLER                      PIC  X(4).                   ELCDTEFD
    80     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    81                                     PIC  X(48).                  ELCDTEFD
    82                                                                  ELCDTEFD
    83 01  DATE-DISK-P.                                                 ELCDTEFD
    84     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    85     12  DD-IDX                      PIC  99.                     ELCDTEFD
    86     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    87     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    88         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    89                                     PIC  X.                      ELCDTEFD
    90         16  FILLER                  PIC  X(46).                  ELCDTEFD
    91     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    92         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    93             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    94             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
    95             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
    96             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
    97         16  FILLER                  PIC  X(16).                  ELCDTEFD
    98                                                                  ELCDTEFD
    99 01  DATE-DISK-E.                                                 ELCDTEFD
   100     12  FILLER                      PIC  X(4).                   ELCDTEFD
   101     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   102                                     PIC  X(4).                   ELCDTEFD
   103                                                                  ELCDTEFD
   104 01  DATE-DISK-C.                                                 ELCDTEFD
   105     12  FILLER                      PIC  X(7).                   ELCDTEFD
   106     12  DD-CARR1-SECPAY-SW          PIC  X.
   107     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   108     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   109     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   110     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   111     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   112     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   113     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   114     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   115     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   116     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   117     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   118     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   119     12  DD-CARR2-SECPAY-SW          PIC  X.
   120     12  FILLER                      PIC  X(7).                   ELCDTEFD
   121                                                                  ELCDTEFD
   122 01  DATE-DISK-OPT.                                               ELCDTEFD
   123     12  FILLER                      PIC  X(04).                  ELCDTEFD
   124     12  DD-TLR-DATA.                                             ELCDTEFD
   125         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   126                                     PIC  X(03).                  ELCDTEFD
   127     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   128         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   129                                     PIC  X(06).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   131         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   132                                     PIC  X(07).                  ELCDTEFD
   133         16  FILLER                  PIC  X(05).                  ELCDTEFD
   134     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   135                                     PIC  X(96).                  ELCDTEFD
   136******************************************************************ELCDTEFD
   137
   138 working-storage section.
   139
*  140 EXEC SQL
*  141    INCLUDE SQLDA
*  142 END-EXEC
   143 01 SQLDA sync.
   144    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   145    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   146    05 SQLN                  PIC S9(4) COMP-5 value 0.
   147    05 SQLD                  PIC S9(4) COMP-5 value 0.
   148    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   149       10 SQLTYPE            PIC S9(4) COMP-5.
   150       10 SQLLEN             PIC S9(4) COMP-5.
   151$IF P64 SET
   152X      *> For 64-bit environments, ensure that SQLDATA is
   153X      *> aligned on an 8-byte boundary.
   154X      10 FILLER             PIC S9(9) COMP-5.
   155$END
   156       10 SQLDATA            USAGE POINTER.
   157       10 SQLIND             USAGE POINTER.
   158       10 SQLNAME.
   159          15 SQLNAMEL        PIC S9(4) COMP-5.
   160          15 SQLNAMEC        PIC X(30).
   161
   162* Values for SQLTYPE
   163
   164 78  ESQL-DATE-CHAR              VALUE 384.
   165 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   166 78  ESQL-DATE-REC               VALUE 386.
   167 78  ESQL-DATE-REC-NULL          VALUE 387.
   168 78  ESQL-TIME-CHAR              VALUE 388.
   169 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   170 78  ESQL-TIME-REC               VALUE 390.
   171 78  ESQL-TIME-REC-NULL          VALUE 391.
   172 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   173 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   174 78  ESQL-TIMESTAMP-REC          VALUE 394.
   175 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   176 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   177 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   178 78  ESQL-TS-OFFSET-REC          VALUE 398.
   179 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   180 78  ESQL-LONGVARBINARY          VALUE 404.
   181 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   182 78  ESQL-LONGVARCHAR            VALUE 408.
   183 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   184 78  ESQL-BINARY                 VALUE 444.
   185 78  ESQL-BINARY-NULL            VALUE 445.
   186 78  ESQL-VARBINARY              VALUE 446.
   187 78  ESQL-VARBINARY-NULL         VALUE 447.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SQLDCCGAAP.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   188 78  ESQL-VARCHAR                VALUE 448.
   189 78  ESQL-VARCHAR-NULL           VALUE 449.
   190
   191 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   192 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   193
   194 78  ESQL-CHAR                   VALUE 452.
   195 78  ESQL-CHAR-NULL              VALUE 453.
   196
   197 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   198 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   199
   200 78  ESQL-DOUBLE                 VALUE 480.
   201 78  ESQL-DOUBLE-NULL            VALUE 481.
   202 78  ESQL-REAL                   VALUE 482.
   203 78  ESQL-REAL-NULL              VALUE 483.
   204 78  ESQL-DECIMAL                VALUE 484.
   205 78  ESQL-DECIMAL-NULL           VALUE 485.
   206 78  ESQL-INTEGER                VALUE 496.
   207 78  ESQL-INTEGER-NULL           VALUE 497.
   208 78  ESQL-SMALLINT               VALUE 500.
   209 78  ESQL-SMALLINT-NULL          VALUE 501.
   210 78  ESQL-TINYINT                VALUE 502.
   211 78  ESQL-TINYINT-NULL           VALUE 503.
   212
*  213 EXEC SQL
*  214    INCLUDE SQLCA
*  215 END-EXEC
   216 01 SQLCA.
   217     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   218     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   219     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   220     05  SQLERRM.
   221         49  SQLERRML    PIC S9(4) COMP-5.
   222         49  SQLERRMC    PIC X(70).
   223     05  SQLERRP         PIC X(8).
   224     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   225     05  SQLWARN.
   226         10  SQLWARN0    PIC X.
   227         10  SQLWARN1    PIC X.
   228         10  SQLWARN2    PIC X.
   229         10  SQLWARN3    PIC X.
   230         10  SQLWARN4    PIC X.
   231         10  SQLWARN5    PIC X.
   232         10  SQLWARN6    PIC X.
   233         10  SQLWARN7    PIC X.
   234     05  SQLEXT.
   235         10  SQLWARN8    PIC X.
   236         10  SQLWARN9    PIC X.
   237         10  SQLWARN10   PIC X.
   238         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   239     05  SQLSTATE    PIC X(5).
   240
   241 77  rec-cnt                     pic 9(7) value zeros.
   242 77  ws-recs-in                  pic 9(7) value zeros.
   243 77  eof-sw                      pic x value ' '.
   244     88  end-of-input               value 'Y'.
   245
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SQLDCCGAAP.cbl
   246 EXEC SQL
   247    BEGIN DECLARE SECTION
   248 END-EXEC
   249
   250 01  sqlcmd                      pic x(1024).
   251 01  WS-MOE-DATE                 pic x(10).
   252 01  svr                         pic x(32).
   253 01  usr                         pic x(32).
   254 01  pass                        pic x(32).
   255 01  usr-pass                    pic x(64).
   256 01  ws-disp-code                pic s9(11).
   257
   258***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   259***                                                            ***
   260***  These indicators are used to tell sql server that i am    ***
   261***  passing it a null value.  The indicator will be -1        ***
   262***  if the value is nulls and +0 if the value is other than   ***
   263***  nulls.  Here is a sample on how to use it.                ***
   264***                                                            ***
   265***      if db-date1 = spaces move -1 to nu-date1 end-if       ***
   266***     EXEC SQL                                               ***
   267***        insert into TABLE1 (                                ***
   268***           date1,                                           ***
   269***           date2)                                           ***
   270***        values (                                            ***
   271***           :db-date1      :nu-date1,                        ***
   272***           :db-date2      :nu-date2)                        ***
   273***     END-EXEC                                               ***
   274***                                                            ***
   275***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   276
   277 01  indicator-vaiables-for-nulls.
   278     05  NU-LF-EXP-DT            PIC s9(4) comp value +0.
   279     05  NU-AH-EXP-DT            PIC s9(4) comp value +0.
   280
   281 01  GAAP-DETAIL-RECORD.
   282     12  EX-CARRIER              PIC X.
   283     12  EX-TAB1                 PIC X.
   284     12  EX-GROUPING             PIC X(6).
   285     12  EX-TAB2                 PIC X.
   286     12  EX-STATE                PIC XX.
   287     12  EX-TAB3                 PIC X.
   288     12  EX-ACCOUNT              PIC X(10).
   289     12  EX-TAB4                 PIC X.
   290     12  EX-EFF                  PIC X(10).
   291     12  EX-TAB5                 PIC X.
   292     12  EX-CERT-NO              PIC X(11).
   293     12  EX-TAB6                 PIC X.
   294     12  EX-LFTYP                PIC XX.
   295     12  EX-TAB7                 PIC X.
   296     12  EX-LF-TERM              PIC 999.
   297     12  EX-TAB8                 PIC X.
   298     12  EX-LF-REMTERM           PIC 999.
   299     12  EX-TAB9                 PIC X.
   300     12  EX-LFBEN                PIC x(13).
   301     12  EX-TAB10                PIC X.
   302     12  EX-LFPRM                PIC x(11).
   303     12  EX-TAB11                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SQLDCCGAAP.cbl
   304     12  EX-AHTYP                PIC XX.
   305     12  EX-TAB12                PIC X.
   306     12  EX-AH-TERM              PIC 999.
   307     12  EX-TAB13                PIC X.
   308     12  EX-AH-REMTERM           PIC 999.
   309     12  EX-TAB14                PIC X.
   310     12  EX-AHBEN                PIC x(11).
   311     12  EX-TAB15                PIC X.
   312     12  EX-AHPRM                PIC x(11).
   313     12  EX-TAB16                PIC X.
   314     12  EX-REM-AMT              PIC x(12).
   315     12  EX-TAB17                PIC X.
   316     12  EX-PLFPRM               PIC x(11).
   317     12  EX-TAB18                PIC X.
   318     12  EX-RLFPRM               PIC x(11).
   319     12  EX-TAB19                PIC X.
   320     12  EX-SLFPRM               PIC x(11).
   321     12  EX-TAB20                PIC X.
   322     12  EX-PAHPRM               PIC x(11).
   323     12  EX-TAB21                PIC X.
   324     12  EX-RAHPRM               PIC x(11).
   325     12  EX-TAB22                PIC X.
   326     12  EX-SAHPRM               PIC x(11).
   327     12  EX-TAB23                PIC X.
   328     12  EX-REIN                 PIC X.
   329     12  EX-TAB24                PIC X.
   330     12  EX-REIN-CO              PIC X(03).
   331     12  EX-TAB25                PIC X.
   332     12  EX-AH-REM-BEN           PIC x(13).
   333     12  EX-TAB26                PIC X.
   334     12  EX-MORT-RESV            PIC x(11).
   335     12  EX-TAB27                PIC X.
   336     12  EX-REIN-SUB             PIC X(03).
   337     12  EX-TAB28                PIC X.
   338     12  EX-SEX-CODE             PIC X.
   339     12  EX-TAB29                PIC X.
   340     12  EX-LOAN-TERM            PIC 999.
   341     12  EX-TAB30                PIC X.
   342     12  EX-LF-EXP-DT            PIC X(10).
   343     12  EX-TAB31                PIC X.
   344     12  EX-AH-EXP-DT            PIC X(10).
   345     12  EX-TAB32                PIC X.
   346     12  EX-LF-UP-REMTERM        PIC 999.
   347     12  EX-TAB33                PIC X.
   348     12  EX-AH-UP-REMTERM        PIC 999.
   349     12  EX-TAB34                PIC X.
   350     12  EX-UNLD-STAT-RESV       PIC x(11).
   351     12  EX-TAB35                PIC X.
   352     12  EX-LFCOM                PIC x(09).
   353     12  EX-TAB36                PIC X.
   354     12  EX-PLFCOM               PIC x(9).
   355     12  EX-TAB37                PIC X.
   356     12  EX-RLFCOM               PIC x(9).
   357     12  EX-TAB38                PIC X.
   358     12  EX-SLFCOM               PIC x(9).
   359     12  EX-TAB39                PIC X.
   360     12  EX-AHCOM                PIC x(9).
   361     12  EX-TAB40                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SQLDCCGAAP.cbl
   362     12  EX-PAHCOM               PIC x(9).
   363     12  EX-TAB41                PIC X.
   364     12  EX-RAHCOM               PIC x(9).
   365     12  EX-TAB42                PIC X.
   366     12  EX-SAHCOM               PIC x(9).
   367     12  EX-TAB43                PIC X.
   368     12  EX-MO-DEC               PIC x(11).
   369     12  EX-TAB44                PIC X.
   370     12  EX-MORT-FACT            PIC x(11).
   371     12  EX-TAB45                PIC X.
   372     12  EX-MORT-AGE             PIC 999.
   373     12  EX-TAB46                PIC X.
   374     12  EX-MORT-TABLE           PIC XXXX.
   375     12  EX-TAB47                PIC X.
   376     12  EX-ALT-MORT-TABLE       PIC XXXX.
   377
   378 EXEC SQL
   379    END DECLARE SECTION
   380 END-EXEC
   381
   382 01  FILLER.
   383     05  ABEND-CODE                  PIC X(4) VALUE SPACES.
   384     05  ABEND-OPTION                PIC X    VALUE 'Y'.
   385     05  WS-ABEND-MESSAGE            PIC X(80)   VALUE SPACES.
   386     05  WS-ABEND-FILE-STATUS        PIC XX      VALUE ZERO.
   387     05  WS-RETURN-CODE       COMP-3 PIC S9(3)   VALUE ZERO.
   388     05  PGM-SUB                     PIC S999 COMP-3 VALUE +344.
   389
*  390                                 COPY ELCDTECX.
   391******************************************************************06/05/98
   392*                                                                *ELCDTECX
   393*                            ELCDTECX.                           *   LV005
   394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   395*                            VMOD=2.015                          *ELCDTECX
   396*                                                                *ELCDTECX
   397*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   398*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   399*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   400*                                                                *ELCDTECX
   401******************************************************************ELCDTECX
   402******************************************************************
   403*                   C H A N G E   L O G
   404*
   405* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   406*-----------------------------------------------------------------
   407*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   408* EFFECTIVE    NUMBER
   409*-----------------------------------------------------------------
   410* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   411*                                  BENEFIT CODES FROM 300 TO 900
   412* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   413* 051304    2003080800002  SMVA  ADD REFUND METHOD
   414* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   415******************************************************************
   416 01  DATE-CARD.                                                   ELCDTECX
   417     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   418     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   419     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   420     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   421     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   422     12  EP-SW                       PIC  X.                      ELCDTECX
   423         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   424     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   425         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   426     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   427     12  RUN-CENTURY.                                             ELCDTECX
   428         16 RUN-CENTURY-N            PIC  99.                        CL**4
   429     12  FILLER                      PIC  X.                         CL**4
   430     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   431     12  FILLER                      PIC  XXX.                    ELCDTECX
   432     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   433                                                                  ELCDTECX
   434 01  FILLER                          PIC  X(7)                       CL**6
   435                                          VALUE 'OPTIONS'.        ELCDTECX
   436 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   437     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   438     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   439     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   440         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   441         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   442     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   443     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   444     12  FILLER                      PIC  X.                      ELCDTECX
   445     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   446     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   447     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   448     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   449     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   450     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   451     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   452     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   453     12  FILLER                      PIC  X.                      ELCDTECX
   454     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   455     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   456     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   457     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   458     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   459     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   460     12  FILLER                      PIC  X.                      ELCDTECX
   461     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   462     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   463     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   464     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   465     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   466     12  DTE-R78                     PIC  X.                      ELCDTECX
   467     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   468     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   469     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   470     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   471     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   472     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   473     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   474                                     PIC  X.                      ELCDTECX
   475         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   476                                                 ' '.             ELCDTECX
   477         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   478         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   479     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   480         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   481         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   482     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   483     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   484                                     PIC  9.                         CL**4
   485     12  DTE-SYSTEM.                                              ELCDTECX
   486         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   487         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   488         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   489         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   490         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   491         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   492         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   493         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   494         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   495         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   496         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   497         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   498         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   499         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   500         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   501         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   502         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   503         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   504         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   505         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   506         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   507         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   508         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   509         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   510         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   511         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   512     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   513         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   514                                     PIC  X.                      ELCDTECX
   515     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   516                                                                  ELCDTECX
   517 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   518     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   519     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   520     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   521*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   522     12  FILLER                      PIC  X.                      ELCDTECX
   523     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   524     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   525     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   526     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   527     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   528     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   529     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   530                                                                  ELCDTECX
   531     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   532     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   533     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   534     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   535                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   537     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   538     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   539     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   540                                                                  ELCDTECX
   541     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   542     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   543                                                                  ELCDTECX
   544     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   545     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   546                                                                  ELCDTECX
   547     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   548                                                                  ELCDTECX
   549 01  DATE-CARD-FACTORS.                                           ELCDTECX
   550     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   551     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   552     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   553     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   554     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   555     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   556     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   557                                                                  ELCDTECX
   558 01  FILLER                          PIC  X(12)                   ELCDTECX
   559                                          VALUE 'COMPANY NAME'.   ELCDTECX
   560 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   561     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   562         16  CNT-ID                  PIC  X.                      ELCDTECX
   563         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   564                                                                  ELCDTECX
   565 01  FILLER                          PIC  X(11)                   ELCDTECX
   566                                          VALUE 'STATE NAMES'.    ELCDTECX
   567 01  STATE-NAMES.                                                 ELCDTECX
   568     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   569         16  STATE-SUB               PIC  XX.                     ELCDTECX
   570         16  STATE-PIC1.                                          ELCDTECX
   571             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   572             20  FILLER              PIC  XXX.                    ELCDTECX
   573             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   574             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   575             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   576             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   577                                                                  ELCDTECX
   578 01  FILLER                          PIC  X(13)                   ELCDTECX
   579                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   580 01  CARRIER-NAMES.                                               ELCDTECX
   581     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   582         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   583         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   584         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   585         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   586         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   587         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   588*        16  FILLER                  PIC  X.                      ELCDTECX
   589         16  CARRIER-SEC-PAY         PIC  X.
   590             88  SEC-PAY-CARRIER          VALUE 'Y'.
   591                                                                  ELCDTECX
   592 01  FILLER                          PIC  X(9)                       CL**6
   593                                          VALUE 'INS TYPES'.      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594 01  CLAS-INS-TYPES.                                              ELCDTECX
   595*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   596     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   597         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   598         16  CLAS-I-AB3.                                          ELCDTECX
   599             20  FILLER              PIC  X.                      ELCDTECX
   600             20  CLAS-I-AB2.                                      ELCDTECX
   601                 24  FILLER          PIC  X.                      ELCDTECX
   602                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   603         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   604             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   605             20  FILLER              PIC  X.                         CL**4
   606         16  CLAS-I-AB10.                                         ELCDTECX
   607             20  FILLER              PIC  X(9).                   ELCDTECX
   608             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   609         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   610         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   611         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   612         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   613             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   614         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   615         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   616         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   617         16  CLAS-I-BEN-CATEGORY     PIC  X.
   618         16  CLAS-I-REFUND-METHOD    PIC  X.
   619         16  CLAS-I-MAX-BENEFITS     PIC 99.
   620         16  FILLER                  PIC  XXX.
   621                                                                  ELCDTECX
   622 01  FILLER                          PIC  X(16)                   ELCDTECX
   623                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   624 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   625     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   626                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   627         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   628         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   629         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   630         16  CLAS-MORT-DESC.                                      ELCDTECX
   631             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   632             20  FILLER              PIC  XX.                        CL**5
   633             20  CLAS-YEAR           PIC  X(4).                      CL**6
   634             20  FILLER              PIC  X.                         CL**5
   635             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   636             20  FILLER              PIC  X.                         CL**5
   637             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   638             20  FILLER              PIC  X.                         CL**5
   639             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   640             20  FILLER              PIC  X(5).                      CL**6
   641                                                                  ELCDTECX
   642 01  FILLER                          PIC  X(15)                   ELCDTECX
   643                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   644 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   645     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   646         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   647         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   648         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   649         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   650         16  FILLER                  PIC  X(4).                      CL**6
   651                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   652 01  FILLER                          PIC  X(7)                       CL**6
   653                                     VALUE 'INDEXES'.             ELCDTECX
   654 01  CLAS-INDEX-TBL.                                              ELCDTECX
   655     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   656     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   657     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   658     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   659     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   660     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   661     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   662     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   663     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   664     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   665     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   666     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   667     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   668     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   669     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   670     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   671     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   672                                                                  ELCDTECX
   673 01  CLAS-TYPE-MISC.                                              ELCDTECX
   674     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   675     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   676     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   677     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   678     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   679     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   680     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   681     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   682     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   683     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   684     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   685                                                                  ELCDTECX
   686 01  FILLER                          PIC  X(13)                   ELCDTECX
   687                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   688 01  CLAS-MISC.                                                   ELCDTECX
   689     12  DTE-FICH                    PIC  X.                      ELCDTECX
   690         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   691         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   692         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   693     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   694     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   695     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   696     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   697     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   698     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   699     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   700     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   701     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   702     12  STATE-L                     PIC  XX.                     ELCDTECX
   703     12  CLAS-CN                     PIC  99.                     ELCDTECX
   704     12  CLAS-CO                     PIC  99.                     ELCDTECX
   705     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   706         16  DTE-F-1                 PIC  X.                      ELCDTECX
   707         16  DTE-F-2                 PIC  X.                      ELCDTECX
   708     12  DTE-ABEND-WORK.                                          ELCDTECX
   709         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   710         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   711                                                                  ELCDTECX
   712 01  FILLER                          PIC  X(12)                   ELCDTECX
   713                                     VALUE 'WORKING DATE'.        ELCDTECX
   714 01  WS-DATE-AND-TIME.                                            ELCDTECX
   715     12  WS-ACCEPT-DATE.                                          ELCDTECX
   716         16  WS-AD-YY                PIC  99.                     ELCDTECX
   717         16  WS-AD-MM                PIC  99.                     ELCDTECX
   718         16  WS-AD-DD                PIC  99.                     ELCDTECX
   719     12  WS-CURRENT-DATE.                                         ELCDTECX
   720         16  WS-CD-MM                PIC  99.                     ELCDTECX
   721         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   722         16  WS-CD-DD                PIC  99.                     ELCDTECX
   723         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   724         16  WS-CD-YY                PIC  99.                     ELCDTECX
   725     12  WS-TIME-OF-DAY.                                          ELCDTECX
   726         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   727         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   728                                                                  ELCDTECX
   729 01  FILLER                          PIC  X(12)                   ELCDTECX
   730                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   731 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   732     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   733         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   734         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   735         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   736                                                                  ELCDTECX
   737 01  FILLER                          PIC  X(10)                   ELCDTECX
   738                                     VALUE 'STATE TLRS'.          ELCDTECX
   739 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   740     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   741         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   742         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   743                                                                  ELCDTECX
   744 01  FILLER                          PIC  X(13)                   ELCDTECX
   745                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   746 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   747     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   748         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   749                                                                  ELCDTECX
   750 01  FILLER                          PIC  X(13)                   ELCDTECX
   751                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   752 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   753     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   754     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   755     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   756                                     PIC  X.                         CL**5
   757     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   758     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   759     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   760     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   761     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   762     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   763     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   764     12  FILLER                      PIC  X(75).                  ELCDTECX
   765******************************************************************ELCDTECX
   766*01  MISC-CARR-PCT-DATA.                                          00001521
   767*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SQLDCCGAAP.cbl
   768*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   769*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   770*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   771*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   772*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   773******************************************************************ELCDTECX
*  774                                 copy ELCDTEVR.
   775***************************************************************** 04/15/98
   776*                                                                *ELCDTEVR
   777*                                                                *ELCDTEVR
   778*                            ELCDTEVR.                           *   LV003
   779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   780*                            VMOD=2.001                          *   CL**2
   781*                                                                *ELCDTEVR
   782*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   783*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   784*                                                                *ELCDTEVR
   785******************************************************************ELCDTEVR
   786 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   787     05  WS-RUN-DATE.                                             ELCDTEVR
   788         10  FILLER                  PIC  9(03).                  ELCDTEVR
   789         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   790         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   791             15  RUN-CC              PIC  99.                     ELCDTEVR
   792             15  RUN-YR              PIC  99.                     ELCDTEVR
   793         10  RUN-MO                  PIC  99.                     ELCDTEVR
   794         10  RUN-DA                  PIC  99.                     ELCDTEVR
   795     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   796            WS-RUN-DATE              PIC 9(11).                      CL**2
   797     05  WS-EP-DT.                                                ELCDTEVR
   798         10  FILLER                  PIC  9(03).                  ELCDTEVR
   799         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   800         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   801             15  EP-CC               PIC  99.                     ELCDTEVR
   802             15  EP-YR               PIC  99.                     ELCDTEVR
   803         10  EP-MO                   PIC  99.                     ELCDTEVR
   804         10  EP-DA                   PIC  99.                     ELCDTEVR
   805     05  WS-EP-DT-N REDEFINES                                        CL**2
   806            WS-EP-DT                 PIC 9(11).                      CL**2
   807     05  WS-DTE-CONV-DT.                                             CL**4
   808         10  FILLER                  PIC  9(03).                     CL**4
   809         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   810         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   811             15  DTE-CONV-CC         PIC  99.                        CL**4
   812             15  DTE-CONV-YR         PIC  99.                        CL**4
   813         10  DTE-CONV-MO             PIC  99.                        CL**4
   814         10  DTE-CONV-DA             PIC  99.                        CL**4
   815     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   816            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   817 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   818     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   819         10  FILLER                            PIC 999.           ELCDTEVR
   820         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   821         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   822             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   823             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   824         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   825         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   826     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   827            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   828     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   829         10  FILLER                            PIC 999.           ELCDTEVR
   830         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   831         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   832         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   833         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   834     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   835            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   836 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   837     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   838         10  FILLER                            PIC 999.           ELCDTEVR
   839         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   840         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   841             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   842             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   843         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   844         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   845     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   846            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   847     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   848         10  FILLER                            PIC 999.           ELCDTEVR
   849         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   850         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   851             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   852             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   853         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   854         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   855     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   856            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   857     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   858         10  FILLER                            PIC 999.           ELCDTEVR
   859         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   860         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   861             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   862             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   863         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   864         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   865     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   866            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   867 01  WS-RATE-RECORD.                                              ELCDTEVR
   868         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   869             10  FILLER                        PIC 999.           ELCDTEVR
   870             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   871             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   872                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   873                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   874             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   875             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   876         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   877                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
*  878                                 COPY ELCDATE.
   879******************************************************************06/11/98
   880*                                                                *ELCDATE
   881*                                                                *ELCDATE
   882*                            ELCDATE.                            *   LV023
   883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDATE)
   884*                            VMOD=2.003                           ELCDATE
   885*                                                                *ELCDATE
   886*                                                                *ELCDATE
   887*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   888*                 LENGTH = 200                                   *   CL*19
   889******************************************************************ELCDATE
   890                                                                  ELCDATE
   891 01  DATE-CONVERSION-DATA.                                        ELCDATE
   892     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   893     12  DC-OPTION-CODE                PIC X.                        CL*15
   894         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   895         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   896         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   897         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   898         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   899         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   900         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   901         88  FIND-CENTURY               VALUE '7'.                   CL*22
   902         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   903         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   904         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   905         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   906         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   907         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   908         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   909         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   910         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   911         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   912         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   913         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   914         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   915         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   916         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   917         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   918         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   919         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   920         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   921         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   922         88  THREE-CHARACTER-BIN                                  ELCDATE
   923                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   924         88  GREGORIAN-TO-BIN                                        CL**2
   925                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   926         88  BIN-TO-GREGORIAN                                        CL**2
   927                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   928         88  JULIAN-TO-BINARY                                        CL**2
   929                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   930     12  DC-ERROR-CODE                 PIC X.                        CL*15
   931         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   932         88  DATE-CONVERSION-ERROR                                ELCDATE
   933                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   934         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   935         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   936         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   937         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   938         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   939         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   940         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   941         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDATE)
   942         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   943         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   944     12  DC-END-OF-MONTH               PIC X.                        CL*15
   945         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   946     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   947         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   948         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   949         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   950     12  FILLER                        PIC X.                        CL*15
   951     12  DC-CONVERSION-DATES.                                        CL*15
   952         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   953         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   954         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   955         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   956                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   957             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   958             20  SLASH1-1              PIC X.                        CL*15
   959             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   960             20  SLASH1-2              PIC X.                        CL*15
   961             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   962         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   963         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   964                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   965             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   966             20  SLASH2-1              PIC X.                        CL*15
   967             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   968             20  SLASH2-2              PIC X.                        CL*15
   969             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   970         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   971         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   972                     DC-GREG-DATE-1-YMD.                          ELCDATE
   973             20  DC-YMD-YEAR           PIC 99.                       CL*15
   974             20  DC-YMD-MONTH          PIC 99.                       CL*15
   975             20  DC-YMD-DAY            PIC 99.                       CL*15
   976         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   977         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   978                      DC-GREG-DATE-1-MDY.                         ELCDATE
   979             20  DC-MDY-MONTH          PIC 99.                       CL*15
   980             20  DC-MDY-DAY            PIC 99.                       CL*15
   981             20  DC-MDY-YEAR           PIC 99.                       CL*15
   982         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   983             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   984             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   985             20  FILLER                PIC XX.                       CL*15
   986             20  DC-ALPHA-CENTURY.                                   CL*15
   987                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   988             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   989         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   990         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   991         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   992         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   993         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   994                                       PIC 9(05).                    CL*20
   995         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   996             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   997             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   998         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   999         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1000         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1001     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1002         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1003         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1004             20  FILLER                PIC 9(3).                     CL*15
  1005             20  HOLD-CEN-1-CCYY.                                    CL*15
  1006                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1007                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1008             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1009             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1010         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1011             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1012             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1013             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1014                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1015                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1016             20  FILLER                PIC 9(3).                     CL*15
  1017         16  HOLD-CENTURY-1-X.                                       CL*15
  1018             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1019             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1020                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1021                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1022             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1023             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1024         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1025             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1026             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1027             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1028                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1029                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1030             20  FILLER                PIC XXX.                      CL*23
  1031         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1032         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1033         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1034         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1035             20  DC-JULIAN-1-CCYY.                                   CL*15
  1036                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1037                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1038             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1039         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1040         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1041             20  DC-JULIAN-2-CCYY.                                   CL*15
  1042                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1043                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1044             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1045         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1046             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1047             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1048             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1049             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1050             20  DC-EDITA-CCYY.                                      CL*15
  1051                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1052                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1053         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1054             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1055             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1056             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1057             20  SLASHB-2              PIC X VALUE '/'.              CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1058             20  DC-EDITB-CCYY.                                      CL*15
  1059                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1060                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1061         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1062         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1063                              DC-GREG-DATE-CYMD.                  ELCDATE
  1064             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1065             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1066             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1067             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1068         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1069         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1070                              DC-GREG-DATE-MDCY.                  ELCDATE
  1071             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1072             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1073             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1074             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1075    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1076        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1077    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1078    12  FILLER                         PIC X(28).                    CL*26
  1079
  1080 procedure division.
* 1081                                 COPY ELCDTERX.
  1082******************************************************************04/15/98
  1083*                                                                *ELCDTERX
  1084*                                                                *ELCDTERX
  1085*                            ELCDTERX.                           *   LV002
  1086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1087*                            VMOD=2.007                          *ELCDTERX
  1088*                                                                *ELCDTERX
  1089*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1090*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1091*      = ELCDTEFD)                                               *ELCDTERX
  1092*                                                                *ELCDTERX
  1093******************************************************************ELCDTERX
  1094                                                                  ELCDTERX
  1095     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1096                                                                  ELCDTERX
  1097     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1098     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1099     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1100                                                                  ELCDTERX
  1101     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1102                                                                  ELCDTERX
  1103******************************************************************ELCDTERX
  1104*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1105*          WARNING MESSAGES.                                      ELCDTERX
  1106******************************************************************ELCDTERX
  1107     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1108         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1109                                                                  ELCDTERX
  1110     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1111                                                                  ELCDTERX
  1112     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1113                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1114                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1115                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1116                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1117                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1118                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1119                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1120                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1121                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1122                                                                  ELCDTERX
  1123     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1124                                                                  ELCDTERX
  1125     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1126                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1127                                                                  ELCDTERX
  1128     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1129     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1130     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1131     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1132                                                                  ELCDTERX
  1133     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1134         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1135     ELSE                                                         ELCDTERX
  1136         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1137                                                                  ELCDTERX
  1138     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1139         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1140     ELSE                                                         ELCDTERX
  1141         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1142                                                                  ELCDTERX
  1143 0005-READ--CARD.                                                 ELCDTERX
  1144     READ DISK-DATE                                               ELCDTERX
  1145         AT END CLOSE DISK-DATE                                   ELCDTERX
  1146             GO TO 0060-READ--TEST.                               ELCDTERX
  1147                                                                  ELCDTERX
  1148     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1149                                                                  ELCDTERX
  1150     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1151         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1152         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1153         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1154         GO TO 0005-READ--CARD.                                   ELCDTERX
  1155                                                                  ELCDTERX
  1156     IF DD-ID = 'CLAD'                                            ELCDTERX
  1157         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1158         GO TO 0005-READ--CARD.                                   ELCDTERX
  1159                                                                  ELCDTERX
  1160     IF DD-ID = 'CLAX'                                            ELCDTERX
  1161         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1162         GO TO 0005-READ--CARD.                                   ELCDTERX
  1163                                                                  ELCDTERX
  1164     IF DD-ID = 'CLAF'                                            ELCDTERX
  1165         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1166         GO TO 0005-READ--CARD.                                   ELCDTERX
  1167                                                                  ELCDTERX
  1168     IF DD-ID = 'CLAC'                                            ELCDTERX
  1169         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1170                                                                  ELCDTERX
  1171     IF DD-ID = 'CARR'                                            ELCDTERX
  1172         GO TO 0015-READ--CARR.                                   ELCDTERX
  1173                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1174     IF DD-ID = 'STAT'                                            ELCDTERX
  1175         GO TO 0020-READ--STAT.                                   ELCDTERX
  1176                                                                  ELCDTERX
  1177     IF DD-ID = 'BUSC'                                            ELCDTERX
  1178         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1179                                                                  ELCDTERX
  1180     IF DD-ID = 'MORT'                                            ELCDTERX
  1181         GO TO 0030-READ--MORT.                                   ELCDTERX
  1182                                                                  ELCDTERX
  1183     IF DD-ID = 'CLAI'                                            ELCDTERX
  1184         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1185                                                                  ELCDTERX
  1186     IF DD-ID = 'COLC'                                            ELCDTERX
  1187         GO TO 0065-READ--COLC.                                   ELCDTERX
  1188                                                                  ELCDTERX
  1189     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1190        DD-IDA = 'CL'                                             ELCDTERX
  1191         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1192                                                                  ELCDTERX
  1193     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1194        DD-IDA = 'PO'                                             ELCDTERX
  1195         GO TO 0050-READ--POXX.                                   ELCDTERX
  1196                                                                  ELCDTERX
  1197     IF DD-ID = 'OPCA'                                            ELCDTERX
  1198         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1199                                                                  ELCDTERX
  1200     IF DD-ID = 'OPST'                                            ELCDTERX
  1201         GO TO 0072-READ--OPST.                                   ELCDTERX
  1202                                                                  ELCDTERX
  1203     IF DD-ID = 'OPBS'                                            ELCDTERX
  1204         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1205                                                                  ELCDTERX
  1206     IF DD-ID = 'OPMS'                                            ELCDTERX
  1207         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1208                                                                  ELCDTERX
  1209     GO TO 0005-READ--CARD.                                       ELCDTERX
  1210                                                                  ELCDTERX
  1211 0010-READ--CLAC.                                                 ELCDTERX
  1212     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1213     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1214     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1215     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1216     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1217     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1218     GO TO 0005-READ--CARD.                                       ELCDTERX
  1219                                                                  ELCDTERX
  1220 0015-READ--CARR.                                                 ELCDTERX
  1221     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1222     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1223        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1224        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1225        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1226        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1227        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1228        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1229        MOVE DD-CARR1-SECPAY-SW
  1230                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1231     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1232                                                                  ELCDTERX
  1233     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1234     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1235        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1236        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1237        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1238        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1239        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1240        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1241        MOVE DD-CARR2-SECPAY-SW
  1242                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1243     END-IF
  1244                                                                  ELCDTERX
  1245                                                                  ELCDTERX
  1246     GO TO 0005-READ--CARD.                                       ELCDTERX
  1247                                                                  ELCDTERX
  1248 0020-READ--STAT.                                                 ELCDTERX
  1249     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1250     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1251        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1252         GO TO 0005-READ--CARD.                                   ELCDTERX
  1253                                                                  ELCDTERX
  1254     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1255     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1256     GO TO 0020-READ--STAT.                                       ELCDTERX
  1257                                                                  ELCDTERX
  1258 0025-READ--BUSC.                                                 ELCDTERX
  1259     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1260     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1261        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1262         GO TO 0005-READ--CARD.                                   ELCDTERX
  1263                                                                  ELCDTERX
  1264     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1265     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1266     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1267                                                                  ELCDTERX
  1268 0030-READ--MORT.                                                 ELCDTERX
  1269     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1270     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1271        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1272         GO TO 0005-READ--CARD.                                   ELCDTERX
  1273                                                                  ELCDTERX
  1274     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1275     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1276     GO TO 0030-READ--MORT.                                       ELCDTERX
  1277                                                                  ELCDTERX
  1278 0035-READ--CLXX.                                                 ELCDTERX
  1279     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1280          GO TO 0005-READ--CARD.                                  ELCDTERX
  1281                                                                  ELCDTERX
  1282     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1283         DISPLAY '***********************************************'ELCDTERX
  1284         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1285         DISPLAY '***********************************************'ELCDTERX
  1286         GO TO 0055-READ--STOP.                                   ELCDTERX
  1287                                                                  ELCDTERX
  1288     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1289        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1290         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1291                                                                  ELCDTERX
  1292     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1293        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1294         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1295                                                                  ELCDTERX
  1296*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1297     GO TO 0005-READ--CARD.                                       ELCDTERX
  1298                                                                  ELCDTERX
  1299 0040-READ--CLAI.                                                 ELCDTERX
  1300     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1301     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1302        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1303         GO TO 0005-READ--CARD.                                   ELCDTERX
  1304                                                                  ELCDTERX
  1305     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1306     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1307     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1308                                                                  ELCDTERX
  1309 0045-READ--DUMP.                                                 ELCDTERX
  1310     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1311     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1312                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1313     PERFORM ABEND-PGM.                                           ELCDTERX
  1314                                                                  ELCDTERX
  1315 0050-READ--POXX.                                                 ELCDTERX
  1316     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1317         GO TO 0005-READ--CARD.                                   ELCDTERX
  1318                                                                  ELCDTERX
  1319     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1320         DISPLAY '***********************************************'ELCDTERX
  1321         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1322         DISPLAY '***********************************************'ELCDTERX
  1323         GO TO 0055-READ--STOP.                                   ELCDTERX
  1324                                                                  ELCDTERX
  1325     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1326     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1327     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1328     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1329                                                                  ELCDTERX
  1330     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1331         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1332     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1333         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1334                                                                  ELCDTERX
  1335     GO TO 0005-READ--CARD.                                       ELCDTERX
  1336                                                                  ELCDTERX
  1337 0055-READ--STOP.                                                 ELCDTERX
  1338     GOBACK.                                                      ELCDTERX
  1339                                                                  ELCDTERX
  1340 0060-READ--TEST.                                                 ELCDTERX
  1341     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1342        CLAX-ID         = SPACE  OR                               ELCDTERX
  1343        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1344         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1345                                                                  ELCDTERX
  1346     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1347     GO TO 0079-READ--EXIT.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1348                                                                  ELCDTERX
  1349 0065-READ--COLC.                                                 ELCDTERX
  1350     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1351     GO TO 0005-READ--CARD.                                       ELCDTERX
  1352                                                                  ELCDTERX
  1353 0070-READ--OPCA.                                                 ELCDTERX
  1354                                                                  ELCDTERX
  1355     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1356                                                                  ELCDTERX
  1357     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1358             OR                                                   ELCDTERX
  1359         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1360         GO TO 0005-READ--CARD.                                   ELCDTERX
  1361                                                                  ELCDTERX
  1362     ADD 1                       TO INDEXCA.                      ELCDTERX
  1363     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1364                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1365     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1366                                                                  ELCDTERX
  1367 0072-READ--OPST.                                                 ELCDTERX
  1368                                                                  ELCDTERX
  1369     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1370                                                                  ELCDTERX
  1371     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1372             OR                                                   ELCDTERX
  1373         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1374         GO TO 0005-READ--CARD.                                   ELCDTERX
  1375                                                                  ELCDTERX
  1376     ADD 1                       TO INDEXST.                      ELCDTERX
  1377     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1378                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1379     GO TO 0072-READ--OPST.                                       ELCDTERX
  1380                                                                  ELCDTERX
  1381 0074-READ--OPBS.                                                 ELCDTERX
  1382                                                                  ELCDTERX
  1383     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1384                                                                  ELCDTERX
  1385     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1386             OR                                                   ELCDTERX
  1387         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1388         GO TO 0005-READ--CARD.                                   ELCDTERX
  1389                                                                  ELCDTERX
  1390     ADD 1                       TO INDEXBS.                      ELCDTERX
  1391     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1392     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1393                                                                  ELCDTERX
  1394 0079-READ--EXIT.                                                 ELCDTERX
  1395*    EXIT.                                                        ELCDTERX
  1396******************************************************************ELCDTERX
  1397 0000-begin.
  1398
  1399     display ' Begin Program '
  1400     perform 0010-init           thru 0010-exit
  1401     perform 0020-connect        thru 0020-exit
  1402*    perform 0030-drop-table     thru 0030-exit
  1403*    perform 0040-create-table   thru 0040-exit
  1404     open input file-in
  1405
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SQLDCCGAAP.cbl
  1406     EXEC SQL
  1407        SET AUTOCOMMIT OFF
  1408     END-EXEC
  1409
  1410     perform 0046-read-input     thru 0046-exit
  1411     perform 0045-process-input  thru 0045-exit until
  1412        end-of-input
  1413*      or ws-recs-in > 10000
  1414
  1415*    perform 0055-update-table   thru 0055-exit
  1416     perform 0060-finish-up      thru 0060-exit
  1417     close file-in
  1418     display ' End Program '
  1419     display ' rows inserted ' rec-cnt
  1420     display ' records read  ' ws-recs-in
  1421     goback
  1422
  1423     .
  1424 0010-init.
  1425
  1426     move 'NTCSO2_Logic'         to svr
  1427     move 'sa'                   to usr
  1428     move 'ntcso2'               to pass
  1429
  1430*    move 'NTCSO2TST_Logic'      to svr
  1431*    move 'sa'                   to usr
  1432*    move 'ntcso2'               to pass
  1433
  1434     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
  1435     MOVE    ' '                 TO DC-OPTION-CODE
  1436     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1437     move dc-greg-date-a-edit    to ws-moe-date
  1438
  1439     .
  1440 0010-exit.
  1441     exit.
  1442
  1443 0020-connect.
  1444
  1445     display 'Begin connect to DB '
  1446     string
  1447         usr delimited space
  1448         "." delimited size
  1449         pass delimited space into usr-pass
  1450     end-string
  1451
  1452     display ' usr pass ' usr-pass
  1453
  1454     EXEC SQL
  1455        CONNECT TO :svr USER :usr-pass
  1456     END-EXEC
  1457
  1458     if sqlcode not = 0
  1459        display "Error: cannot connect "
  1460        display sqlcode
  1461        display sqlerrmc
  1462        goback
  1463     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SQLDCCGAAP.cbl
  1464
  1465     display " connect to DB successful "
  1466
  1467     .
  1468 0020-exit.
  1469     exit.
  1470
  1471 0030-drop-table.
  1472
  1473     display 'Begin Drop table'
  1474     EXEC SQL
  1475         drop table DCC_GAAP_DW
  1476     END-EXEC
  1477     if sqlcode not = 0
  1478        display "Error(anticipated) : cannot drop table "
  1479        display sqlcode
  1480        display sqlerrmc
  1481*       goback
  1482     end-if
  1483
  1484     display ' sql return code ' sqlcode
  1485     display ' sql err mess    ' sqlerrmc
  1486
  1487     .
  1488 0030-exit.
  1489     exit.
  1490
  1491 0040-create-table.
  1492
  1493     display ' Begin Create table'
  1494
  1495     EXEC SQL
  1496        create table DCC_GAAP_DW (
  1497             moe_date datetime not null,
  1498             rein_co char(3),
  1499             rein_sub char(3),
  1500             carrier char(1) not null,
  1501             grouping char(6) not null,
  1502             state char(2) not null,
  1503             account char(10) not null,
  1504             eff datetime not null,
  1505             cert_no char(11) not null,
  1506             lftyp char(2),
  1507             lf_term int,
  1508             lf_remterm int ,
  1509             lfben decimal(11,2),
  1510             lfprm decimal(9,2),
  1511             ahtyp char(2),
  1512             ah_term int,
  1513             ah_remterm int,
  1514             ahben decimal(9,2),
  1515             ahprm decimal(9,2),
  1516             rem_amt decimal(10,2),
  1517             plfprm decimal(9,2),
  1518             rlfprm decimal(9,2),
  1519             slfprm decimal(9,2),
  1520             pahprm decimal(9,2),
  1521             rahprm decimal(9,2),
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SQLDCCGAAP.cbl
  1522             sahprm decimal(9,2),
  1523             rein char(1),
  1524             ah_rem_ben decimal(11,2),
  1525             mort_resv decimal(9,2),
  1526             sex_code char(1),
  1527             loan_term int,
  1528             lf_exp_dt datetime,
  1529             ah_exp_dt datetime,
  1530             lf_up_remterm int,
  1531             ah_up_remterm int,
  1532             unld_stat_resv decimal(9,2),
  1533             lfcom decimal(9,2),
  1534             plfcom decimal(9,2),
  1535             rlfcom decimal(9,2),
  1536             slfcom decimal(9,2),
  1537             ahcom decimal(9,2),
  1538             pahcom decimal(9,2),
  1539             rahcom decimal(9,2),
  1540             sahcom decimal(9,2),
  1541             mo_dec decimal(9,2),
  1542             mort_fact decimal(9,4),
  1543             mort_age int,
  1544             mort_table char(4),
  1545             alt_mort_table char(4)
  1546           CONSTRAINT PK_DCC_GAAP_DW PRIMARY KEY CLUSTERED
  1547             (moe_date, rein_co, rein_sub, carrier, grouping,
  1548             state, account, eff, cert_no)
  1549             )
  1550     END-EXEC
  1551
  1552     if sqlcode not = 0
  1553        display "Error: cannot create table "
  1554        move sqlcode             to ws-disp-code
  1555        display ' sql return code ' ws-disp-code
  1556        display ' sql err mess    ' sqlerrmc
  1557        goback
  1558     end-if
  1559
  1560     display " Create table successful "
  1561
  1562     .
  1563 0040-exit.
  1564     exit.
  1565
  1566 0045-process-input.
  1567
  1568     perform 0050-insert-row     thru 0050-exit
  1569     perform 0046-read-input     thru 0046-exit
  1570
  1571     .
  1572 0045-exit.
  1573     exit.
  1574
  1575 0046-read-input.
  1576
  1577     read file-in at end
  1578        set end-of-input         to true
  1579     end-read
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SQLDCCGAAP.cbl
  1580
  1581     if not end-of-input
  1582        move file-in-rec         to gaap-detail-record
  1583        add 1                    to ws-recs-in
  1584     end-if
  1585
  1586
  1587     .
  1588 0046-exit.
  1589     exit.
  1590
  1591 0050-insert-row.
  1592
  1593     IF EX-LF-EXP-DT = LOW-VALUES OR SPACES
  1594        MOVE -1                  TO NU-LF-EXP-DT
  1595     ELSE
  1596        MOVE +0                  TO NU-LF-EXP-DT
  1597     END-IF
  1598
  1599     IF EX-AH-EXP-DT = LOW-VALUES OR SPACES
  1600        MOVE -1                  TO NU-AH-EXP-DT
  1601     ELSE
  1602        MOVE +0                  TO NU-AH-EXP-DT
  1603     END-IF
  1604
  1605*    display ' Begin Insert row '
  1606
  1607     EXEC SQL
  1608        insert into DCC_GAAP_DW (
  1609             MOE_DATE,
  1610             REIN_CO,
  1611             REIN_SUB,
  1612             CARRIER,
  1613             GROUPING,
  1614             STATE,
  1615             ACCOUNT,
  1616             EFF,
  1617             CERT_NO,
  1618             LFTYP,
  1619             LF_TERM,
  1620             LF_REMTERM,
  1621             LFBEN,
  1622             LFPRM,
  1623             AHTYP,
  1624             AH_TERM,
  1625             AH_REMTERM,
  1626             AHBEN,
  1627             AHPRM,
  1628             REM_AMT,
  1629             PLFPRM,
  1630             RLFPRM,
  1631             SLFPRM,
  1632             PAHPRM,
  1633             RAHPRM,
  1634             SAHPRM,
  1635             REIN,
  1636             AH_REM_BEN,
  1637             MORT_RESV,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SQLDCCGAAP.cbl
  1638             SEX_CODE,
  1639             LOAN_TERM,
  1640             LF_EXP_DT,
  1641             AH_EXP_DT,
  1642             LF_UP_REMTERM,
  1643             AH_UP_REMTERM,
  1644             UNLD_STAT_RESV,
  1645             LFCOM,
  1646             PLFCOM,
  1647             RLFCOM,
  1648             SLFCOM,
  1649             AHCOM,
  1650             PAHCOM,
  1651             RAHCOM,
  1652             SAHCOM,
  1653             MO_DEC,
  1654             MORT_FACT,
  1655             MORT_AGE,
  1656             MORT_TABLE,
  1657             ALT_MORT_TABLE)
  1658                values (
  1659             :WS-MOE-DATE,
  1660             :EX-REIN-CO,
  1661             :EX-REIN-SUB,
  1662             :EX-CARRIER,
  1663             :EX-GROUPING,
  1664             :EX-STATE,
  1665             :EX-ACCOUNT,
  1666             :EX-EFF,
  1667             :EX-CERT-NO,
  1668             :EX-LFTYP,
  1669             :EX-LF-TERM,
  1670             :EX-LF-REMTERM,
  1671             :EX-LFBEN,
  1672             :EX-LFPRM,
  1673             :EX-AHTYP,
  1674             :EX-AH-TERM,
  1675             :EX-AH-REMTERM,
  1676             :EX-AHBEN,
  1677             :EX-AHPRM,
  1678             :EX-REM-AMT,
  1679             :EX-PLFPRM,
  1680             :EX-RLFPRM,
  1681             :EX-SLFPRM,
  1682             :EX-PAHPRM,
  1683             :EX-RAHPRM,
  1684             :EX-SAHPRM,
  1685             :EX-REIN,
  1686             :EX-AH-REM-BEN,
  1687             :EX-MORT-RESV,
  1688             :EX-SEX-CODE,
  1689             :EX-LOAN-TERM,
  1690             :EX-LF-EXP-DT         :NU-LF-EXP-DT,
  1691             :EX-AH-EXP-DT         :NU-AH-EXP-DT,
  1692             :EX-LF-UP-REMTERM,
  1693             :EX-AH-UP-REMTERM,
  1694             :EX-UNLD-STAT-RESV,
  1695             :EX-LFCOM,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* SQLDCCGAAP.cbl
  1696             :EX-PLFCOM,
  1697             :EX-RLFCOM,
  1698             :EX-SLFCOM,
  1699             :EX-AHCOM,
  1700             :EX-PAHCOM,
  1701             :EX-RAHCOM,
  1702             :EX-SAHCOM,
  1703             :EX-MO-DEC,
  1704             :EX-MORT-FACT,
  1705             :EX-MORT-AGE,
  1706             :EX-MORT-TABLE,
  1707             :EX-ALT-MORT-TABLE)
  1708     END-EXEC
  1709
  1710     if sqlcode not = 0
  1711        display "Error: cannot insert row "
  1712        display ' sql return code ' sqlcode
  1713        display ' sql err mess    ' sqlerrmc
  1714        display ' recs so far ' rec-cnt
  1715        display ' offending rec ' gaap-detail-record
  1716        goback
  1717     end-if
  1718
  1719     add 1 to rec-cnt
  1720
  1721     .
  1722 0050-exit.
  1723     exit.
  1724
  1725 0055-update-table.
  1726
  1727     move spaces                 to sqlcmd
  1728     string 'update DCC_GAAP_DW '
  1729            'set lf_exp_dt = NULL '
  1730            'where (lf_exp_dt = '
  1731            'CONVERT(DATETIME, ''1900-01-01 00:00:00'', 102))'
  1732        delimited by size into sqlcmd
  1733     end-string
  1734     display ' cmd **' sqlcmd '**'
  1735
  1736     display ' Begin Exp Dt Updates '
  1737     exec sql
  1738        EXECUTE IMMEDIATE :sqlcmd
  1739     end-exec
  1740
  1741*    exec sql
  1742*       UPDATE DCC_GAAP_DW
  1743*       SET lf_exp_dt = NULL
  1744*       WHERE (lf_exp_dt =
  1745*          CONVERT(DATETIME, '1900-01-01 00:00:00', 102))
  1746*    end-exec
  1747
  1748     if sqlcode not = 0
  1749        display "Error: update lf exp dt  "
  1750        display ' sql return code ' sqlcode
  1751        display ' sql err mess    ' sqlerrmc
  1752        goback
  1753     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* SQLDCCGAAP.cbl
  1754
  1755     display ' Lf Exp Dt Update success '
  1756
  1757     move spaces                 to sqlcmd
  1758     string 'update DCC_GAAP_DW '
  1759            'set ah_exp_dt = NULL '
  1760            'where (ah_exp_dt = '
  1761            'CONVERT(DATETIME, ''1900-01-01 00:00:00'', 102))'
  1762        delimited by size into sqlcmd
  1763     end-string
  1764     display ' cmd **' sqlcmd '**'
  1765
  1766     exec sql
  1767        EXECUTE IMMEDIATE :sqlcmd
  1768     end-exec
  1769
  1770*    exec sql
  1771*       UPDATE DCC_GAAP_DW
  1772*       SET ah_exp_dt = NULL
  1773*       WHERE (ah_exp_dt =
  1774*          CONVERT(DATETIME, '1900-01-01 00:00:00', 102))
  1775*    end-exec
  1776
  1777     if sqlcode not = 0
  1778        display "Error: update ah exp dt  "
  1779        display ' sql return code ' sqlcode
  1780        display ' sql err mess    ' sqlerrmc
  1781        goback
  1782     end-if
  1783
  1784     display ' Ah Exp Dt Update success '
  1785
  1786     .
  1787 0055-exit.
  1788     exit.
  1789
  1790 0060-finish-up.
  1791
  1792     display ' Begin Commit '
  1793     EXEC SQL
  1794         commit transaction
  1795     END-EXEC
  1796     if sqlcode not = 0
  1797        display "Error: commit "
  1798        display ' sql return code ' sqlcode
  1799        display ' sql err mess    ' sqlerrmc
  1800        goback
  1801     end-if
  1802
  1803     display " Commit trans successful "
  1804
  1805     display ' Begin Disconnect '
  1806     EXEC SQL
  1807         commit work release
  1808     END-EXEC
  1809     if sqlcode not = 0
  1810        display "Error: commit release "
  1811        display ' sql return code ' sqlcode
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* SQLDCCGAAP.cbl
  1812        display ' sql err mess    ' sqlerrmc
  1813     end-if
  1814
  1815     .
  1816 0060-exit.
  1817     exit.
  1818
  1819 8500-DATE-CONVERT.
* 1820                                 COPY ELCDCS.
  1821****************************************************************  04/15/98
  1822*                                                              *  ELCDCS
  1823*                                                              *  ELCDCS
  1824*                            ELCDCS.                           *     LV003
  1825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1826*                            VMOD=2.002                        *     CL**3
  1827*                                                              *  ELCDCS
  1828*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  1829****************************************************************. ELCDCS
  1830                                                                  ELCDCS
  1831 8510-DATE-CONVERSION.                                            ELCDCS
  1832     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  1833                                                                  ELCDCS
  1834 8590-EXIT.                                                       ELCDCS
  1835     EXIT.                                                        ELCDCS
  1836                                                                  ELCDCS
  1837
  1838 abend-pgm.
  1839
  1840      call 'ABORTME'.
  1841
  1842      goback.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      180572     Code:       13875
