* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL517 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/08/94 08:12:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.040.
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   2
* EL517.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    27*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    38* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    39*                                IS OPEN OR CNC DT < PD THRU
    40*                                ALSO ADD ALTERNATE KEY CLAUSE
    41* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    42* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    43* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    44* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    45* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    46* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    47* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    48* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    49* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    50* 061412  CR2011022800001  AJRA  NAPERSOFT
    51* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    54* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    55* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    56* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    57* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    58* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    59* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    60******************************************************************
    61
    62 ENVIRONMENT DIVISION.
    63
    64 INPUT-OUTPUT SECTION.
    65
    66 FILE-CONTROL.
    67
    68     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    69
    70     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    71                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   3
* EL517.cbl
    72                             ACCESS IS DYNAMIC
    73                             RECORD KEY IS CF-CONTROL-PRIMARY
    74                             FILE STATUS IS ELCNTL-FILE-STATUS.
    75
    76     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    77                             ORGANIZATION IS INDEXED
    78                             ACCESS IS SEQUENTIAL
    79                             RECORD KEY IS PB-CONTROL-PRIMARY
    80                             ALTERNATE RECORD KEY IS
    81                                 PB-CONTROL-BY-ACCOUNT
    82                             FILE STATUS IS ERPNDB-FILE-STATUS.
    83
    84     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    85                             ORGANIZATION IS INDEXED
    86                             ACCESS IS DYNAMIC
    87                             RECORD KEY IS RE-CONTROL-PRIMARY
    88                             FILE STATUS IS ERREIN-FILE-STATUS.
    89
    90     SELECT ELCERT
*                                  COPY ELCCERTS.
    91******************************************************************04/15/98
    92*                                                                *ELCCERTS
    93*                            ELCCERTS.                           *   LV002
    94*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    95*                            VMOD=2.001                          *ELCCERTS
    96*                                                                *ELCCERTS
    97*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    98*                                                                *ELCCERTS
    99*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
   100******************************************************************ELCCERTS
   101                                                                  ELCCERTS
   102         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   103         ORGANIZATION IS INDEXED                                  ELCCERTS
   104         ACCESS IS DYNAMIC                                        ELCCERTS
   105         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   106         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   107                                                                  ELCCERTS
   108
   109     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   110                             ORGANIZATION IS INDEXED
   111                             ACCESS IS DYNAMIC
   112                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   113                             FILE STATUS IS ELMSTR-FILE-STATUS.
   114
   115     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   116                             ORGANIZATION IS INDEXED
   117                             ACCESS IS DYNAMIC
   118                             RECORD KEY IS CT-CONTROL-PRIMARY
   119                             FILE STATUS IS ERCTBL-FILE-STATUS.
   120
   121     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   122                             ORGANIZATION IS INDEXED
   123                             ACCESS IS DYNAMIC
   124                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   125                             FILE STATUS IS ERACCT-FILE-STATUS.
   126
   127     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   128                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   4
* EL517.cbl
   129                             ACCESS IS DYNAMIC
   130                             RECORD KEY IS EM-CONTROL-PRIMARY
   131                             FILE STATUS IS ELCERR-FILE-STATUS.
   132
   133     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   134                             ORGANIZATION IS INDEXED
   135                             ACCESS IS DYNAMIC
   136                             RECORD KEY IS PM-CONTROL-PRIMARY
   137                             FILE STATUS IS ERPNDM-FILE-STATUS.
   138
   139     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   140                             ORGANIZATION IS INDEXED
   141                             ACCESS IS DYNAMIC
   142                             RECORD KEY IS MA-CONTROL-PRIMARY
   143                             FILE STATUS IS ERMAIL-FILE-STATUS.
   144
   145     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   146                             ORGANIZATION IS INDEXED
   147                             ACCESS IS DYNAMIC
   148                             RECORD KEY IS PL-CONTROL-PRIMARY
   149                             FILE STATUS IS ERPLAN-FILE-STATUS.
   150
   151     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   152                             ORGANIZATION IS INDEXED
   153                             ACCESS IS DYNAMIC
   154                             RECORD KEY IS FO-CONTROL-PRIMARY
   155                             FILE STATUS IS ERFORM-FILE-STATUS.
   156
   157     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   158
   159     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   160
   161     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   162                             ORGANIZATION IS INDEXED
   163                             ACCESS IS DYNAMIC
   164                             RECORD KEY IS RF-CONTROL-PRIMARY
   165                             FILE STATUS IS DTE-VSAM-FLAGS.
   166
   167     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   168                             ORGANIZATION IS INDEXED
   169                             ACCESS IS DYNAMIC
   170                             RECORD KEY IS ERRESS-PRIMARY-KEY
   171                             FILE STATUS IS ERRESS-FILE-STATUS.
   172
   173     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   174                             ORGANIZATION IS INDEXED
   175                             ACCESS IS DYNAMIC
   176                             RECORD KEY IS ERRESC-RECORD-KEY
   177                             FILE STATUS IS ERRESC-FILE-STATUS.
   178
   179     SELECT ERCOMP           ASSIGN TO             ERCOMP
   180                             ORGANIZATION IS INDEXED
   181                             ACCESS IS DYNAMIC
   182                             RECORD KEY IS CO-CONTROL-PRIMARY
   183                             FILE STATUS IS ERCOMP-FILE-STATUS.
   184
   185     SELECT ERLOFC           ASSIGN TO             ERLOFC
   186                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   5
* EL517.cbl
   187                             ACCESS IS DYNAMIC
   188                             RECORD KEY IS LO-CONTROL-PRIMARY
   189                             FILE STATUS IS ERLOFC-FILE-STATUS.
   190
   191     SELECT ERBXRF           ASSIGN TO             ERBXRF
   192                             ORGANIZATION IS INDEXED
   193                             ACCESS IS DYNAMIC
   194                             RECORD KEY IS BK-CONTROL-PRIMARY
   195                             FILE STATUS IS ERBXRF-FILE-STATUS.
   196
   197     SELECT ERAGTC           ASSIGN TO             ERAGTC
   198                             ORGANIZATION IS INDEXED
   199                             ACCESS IS DYNAMIC
   200                             RECORD KEY IS AG-CONTROL-PRIMARY
   201                             FILE STATUS IS ERAGTC-FILE-STATUS.
   202
   203     SELECT ELCRTT           ASSIGN TO             ELCRTT
   204                             ORGANIZATION IS INDEXED
   205                             ACCESS IS DYNAMIC
   206                             RECORD KEY IS CS-CONTROL-PRIMARY
   207                             FILE STATUS IS ELCRTT-FILE-STATUS.
   208
   209     SELECT ERPDEF           ASSIGN TO ERPDEF
   210                             ACCESS IS DYNAMIC
   211                             ORGANIZATION IS INDEXED
   212                             FILE STATUS IS ERPDEF-FILE-STATUS
   213                             RECORD KEY IS PD-CONTROL-PRIMARY.
   214
   215     SELECT ELSTAT           ASSIGN TO ELSTAT
   216                             ACCESS IS DYNAMIC
   217                             ORGANIZATION IS INDEXED
   218                             FILE STATUS IS ELSTAT-FILE-STATUS
   219                             RECORD KEY IS SF-CONTROL-PRIMARY.
   220
   221     SELECT ELCRTO           ASSIGN TO ELCRTO
   222                             ACCESS IS DYNAMIC
   223                             ORGANIZATION IS INDEXED
   224                             FILE STATUS IS ELCRTO-FILE-STATUS
   225                             RECORD KEY IS OC-CONTROL-PRIMARY.
   226
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   6
* EL517.cbl
   228 DATA DIVISION.
   229
   230 FILE SECTION.
   231
   232 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   233******************************************************************04/15/98
   234*                                                                *ELCDTEFD
   235*                                                                *ELCDTEFD
   236*                            ELCDTEFD.                           *   LV002
   237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   238*                            VMOD=2.007                          *   CL**2
   239*                                                                *ELCDTEFD
   240******************************************************************ELCDTEFD
   241     BLOCK CONTAINS 0 RECORDS
   242     RECORDING MODE F.                                            ELCDTEFD
   243                                                                  ELCDTEFD
   244 01  DATE-DISK.                                                   ELCDTEFD
   245     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   246     12  FILLER                      PIC  X(14).                  ELCDTEFD
   247     12  DD-CR1                      PIC  9.                      ELCDTEFD
   248     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   249     12  DD-CR2                      PIC  9.                      ELCDTEFD
   250     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   251     12  FILLER                      PIC  X(20).                  ELCDTEFD
   252                                                                  ELCDTEFD
   253 01  DATE-DISK-R.                                                 ELCDTEFD
   254     12  FILLER                      PIC  X(4).                   ELCDTEFD
   255     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   256                                     PIC  X(32).                  ELCDTEFD
   257                                                                  ELCDTEFD
   258 01  DATE-DISK-T.                                                 ELCDTEFD
   259     12  FILLER                      PIC  X(4).                   ELCDTEFD
   260     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   261                                     PIC  X(48).                  ELCDTEFD
   262                                                                  ELCDTEFD
   263 01  DATE-DISK-M.                                                 ELCDTEFD
   264     12  FILLER                      PIC  X(4).                   ELCDTEFD
   265     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   266                                     PIC  X(48).                  ELCDTEFD
   267                                                                  ELCDTEFD
   268 01  DATE-DISK-P.                                                 ELCDTEFD
   269     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   270     12  DD-IDX                      PIC  99.                     ELCDTEFD
   271     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   272     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   273         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   274                                     PIC  X.                      ELCDTEFD
   275         16  FILLER                  PIC  X(46).                  ELCDTEFD
   276     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   277         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   278             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   279             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   280             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   281             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   282         16  FILLER                  PIC  X(16).                  ELCDTEFD
   283                                                                  ELCDTEFD
   284 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   285     12  FILLER                      PIC  X(4).                   ELCDTEFD
   286     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   287                                     PIC  X(4).                   ELCDTEFD
   288                                                                  ELCDTEFD
   289 01  DATE-DISK-C.                                                 ELCDTEFD
   290     12  FILLER                      PIC  X(7).                   ELCDTEFD
   291     12  DD-CARR1-SECPAY-SW          PIC  X.
   292     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   293     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   294     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   295     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   296     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   297     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   298     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   299     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   300     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   301     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   302     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   303     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   304     12  DD-CARR2-SECPAY-SW          PIC  X.
   305     12  FILLER                      PIC  X(7).                   ELCDTEFD
   306                                                                  ELCDTEFD
   307 01  DATE-DISK-OPT.                                               ELCDTEFD
   308     12  FILLER                      PIC  X(04).                  ELCDTEFD
   309     12  DD-TLR-DATA.                                             ELCDTEFD
   310         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   311                                     PIC  X(03).                  ELCDTEFD
   312     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   313         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   314                                     PIC  X(06).                  ELCDTEFD
   315     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   316         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   317                                     PIC  X(07).                  ELCDTEFD
   318         16  FILLER                  PIC  X(05).                  ELCDTEFD
   319     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   320                                     PIC  X(96).                  ELCDTEFD
   321******************************************************************ELCDTEFD
   322
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   8
* EL517.cbl
   324 FD  ELCNTL.
*  325                                 COPY ELCCNTL.
   326******************************************************************
   327*                                                                *
   328*                                                                *
   329*                            ELCCNTL.                            *
   330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   331*                            VMOD=2.059                          *
   332*                                                                *
   333*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   334*                                                                *
   335*   FILE TYPE = VSAM,KSDS                                        *
   336*   RECORD SIZE = 750  RECFORM = FIXED                           *
   337*                                                                *
   338*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   339*       ALTERNATE INDEX = NONE                                   *
   340*                                                                *
   341*   LOG = YES                                                    *
   342*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   343******************************************************************
   344*                   C H A N G E   L O G
   345*
   346* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   347*-----------------------------------------------------------------
   348*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   349* EFFECTIVE    NUMBER
   350*-----------------------------------------------------------------
   351* 082503                   PEMA  ADD BENEFIT GROUP
   352* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   353* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   354* 092705    2005050300006  PEMA  ADD SPP LEASES
   355* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   356* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   357* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   358* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   359* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   360* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   361* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   362* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   363* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   364******************************************************************
   365*
   366 01  CONTROL-FILE.
   367     12  CF-RECORD-ID                       PIC XX.
   368         88  VALID-CF-ID                        VALUE 'CF'.
   369
   370     12  CF-CONTROL-PRIMARY.
   371         16  CF-COMPANY-ID                  PIC XXX.
   372         16  CF-RECORD-TYPE                 PIC X.
   373             88  CF-COMPANY-MASTER              VALUE '1'.
   374             88  CF-PROCESSOR-MASTER            VALUE '2'.
   375             88  CF-STATE-MASTER                VALUE '3'.
   376             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   377             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   378             88  CF-CARRIER-MASTER              VALUE '6'.
   379             88  CF-MORTALITY-MASTER            VALUE '7'.
   380             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   381             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page   9
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   382             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   383             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   384             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   385             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   386             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   387             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   388             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   389             88  CF-REMINDERS-MASTER            VALUE 'R'.
   390             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   391         16  CF-ACCESS-CD-GENL              PIC X(4).
   392         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   393             20  CF-PROCESSOR               PIC X(4).
   394         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   395             20  CF-STATE-CODE              PIC XX.
   396             20  FILLER                     PIC XX.
   397         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   398             20  FILLER                     PIC XX.
   399             20  CF-HI-BEN-IN-REC           PIC XX.
   400         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   401             20  FILLER                     PIC XXX.
   402             20  CF-CARRIER-CNTL            PIC X.
   403         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   404             20  FILLER                     PIC XX.
   405             20  CF-HI-TYPE-IN-REC          PIC 99.
   406         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   407             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   408                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   409             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   410             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   411         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   412             20  FILLER                     PIC X.
   413             20  CF-CUSTOM-REPORT-NO        PIC 999.
   414         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   415             20  FILLER                     PIC XX.
   416             20  CF-MORTGAGE-PLAN           PIC XX.
   417         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   418
   419     12  CF-LAST-MAINT-DT                   PIC XX.
   420     12  CF-LAST-MAINT-BY                   PIC X(4).
   421     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   422
   423     12  CF-RECORD-BODY                     PIC X(728).
   424
   425
   426****************************************************************
   427*             COMPANY MASTER RECORD                            *
   428****************************************************************
   429
   430     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   431         16  CF-COMPANY-ADDRESS.
   432             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   433             20  CF-CL-IN-CARE-OF           PIC X(30).
   434             20  CF-CL-ADDR-LINE-1          PIC X(30).
   435             20  CF-CL-ADDR-LINE-2          PIC X(30).
   436             20  CF-CL-CITY-STATE           PIC X(30).
   437             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   438             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   439         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  10
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   440         16  CF-COMPANY-PASSWORD            PIC X(8).
   441         16  CF-SECURITY-OPTION             PIC X.
   442             88  ALL-SECURITY                   VALUE '1'.
   443             88  COMPANY-VERIFY                 VALUE '2'.
   444             88  PROCESSOR-VERIFY               VALUE '3'.
   445             88  NO-SECURITY                    VALUE '4'.
   446             88  ALL-BUT-TERM                   VALUE '5'.
   447         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   448             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   449         16  CF-LGX-INTERFACE-CNTL          PIC X.
   450             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   451         16  CF-INFORCE-LOCATION            PIC X.
   452             88  CERTS-ARE-ONLINE               VALUE '1'.
   453             88  CERTS-ARE-OFFLINE              VALUE '2'.
   454             88  NO-CERTS-AVAILABLE             VALUE '3'.
   455         16  CF-LOWER-CASE-LETTERS          PIC X.
   456         16  CF-CERT-ACCESS-CONTROL         PIC X.
   457             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   458             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   459             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   460             88  CF-ACCNT-CNTL                  VALUE '3'.
   461             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   462
   463         16  CF-FORMS-PRINTER-ID            PIC X(4).
   464         16  CF-CHECK-PRINTER-ID            PIC X(4).
   465
   466         16  CF-LGX-CREDIT-USER             PIC X.
   467             88  CO-IS-NOT-USER                 VALUE 'N'.
   468             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   469
   470         16 CF-CREDIT-CALC-CODES.
   471             20  CF-CR-REM-TERM-CALC PIC X.
   472               88  CR-EARN-AFTER-15TH           VALUE '1'.
   473               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   474               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   475               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   476               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   477               88  CR-EARN-AFTER-14TH           VALUE '6'.
   478               88  CR-EARN-AFTER-16TH           VALUE '7'.
   479             20  CF-CR-R78-METHOD           PIC X.
   480               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   481               88  DONT-USE-PLUS-ONE            VALUE '1'.
   482
   483         16  CF-CLAIM-CONTROL-COUNTS.
   484             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   485                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   486
   487             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   488                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   489
   490             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   491                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   492
   493             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   494                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   495
   496         16  CF-CURRENT-MONTH-END           PIC XX.
   497
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  11
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   498         16  CF-CO-CALC-QUOTE-TOLERANCE.
   499             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   500             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   501             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   502             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   503                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   504                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   505             20  CF-CO-PREM-REJECT-SW       PIC X.
   506                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   507                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   508             20  CF-CO-REF-REJECT-SW        PIC X.
   509                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   510                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   511
   512         16  CF-CO-REPORTING-DT             PIC XX.
   513         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   514         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   515           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   516           88  CF-CO-MONTH-END                  VALUE '1'.
   517
   518         16  CF-LGX-CLAIM-USER              PIC X.
   519             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   520             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   521
   522         16  CF-CREDIT-EDIT-CONTROLS.
   523             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   524             20  CF-MIN-AGE                 PIC 99.
   525             20  CF-DEFAULT-AGE             PIC 99.
   526             20  CF-MIN-TERM                PIC S999      COMP-3.
   527             20  CF-MAX-TERM                PIC S999      COMP-3.
   528             20  CF-DEFAULT-SEX             PIC X.
   529             20  CF-JOINT-AGE-INPUT         PIC X.
   530                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   531             20  CF-BIRTH-DATE-INPUT        PIC X.
   532                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   533             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   534                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   535                 88  CF-ZERO-CARRIER            VALUE '1'.
   536                 88  CF-ZERO-GROUPING           VALUE '2'.
   537                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   538             20  CF-EDIT-SW                 PIC X.
   539                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   540             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   541             20  CF-CR-PR-METHOD            PIC X.
   542               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   543               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   544             20  FILLER                     PIC X.
   545
   546         16  CF-CREDIT-MISC-CONTROLS.
   547             20  CF-REIN-TABLE-SW           PIC X.
   548                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   549             20  CF-COMP-TABLE-SW           PIC X.
   550                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   551             20  CF-EXPERIENCE-RETENTION-AGE
   552                                            PIC S9        COMP-3.
   553             20  CF-CONVERSION-DT           PIC XX.
   554             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   555             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  12
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   556                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   557                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   558
   559             20  CF-CR-CHECK-NO-CONTROL.
   560                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   561                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   562                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   563                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   564                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   565                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   566
   567                 24  CF-CR-CHECK-COUNT       REDEFINES
   568                     CF-CR-CHECK-COUNTER      PIC X(4).
   569
   570                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   571                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   572
   573                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   574                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   575                 24  CF-MAIL-PROCESSING       PIC X.
   576                     88  MAIL-PROCESSING          VALUE 'Y'.
   577
   578         16  CF-MISC-SYSTEM-CONTROL.
   579             20  CF-SYSTEM-C                 PIC X.
   580                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   581             20  CF-SYSTEM-D                 PIC X.
   582                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   583             20  CF-SOC-SEC-NO-SW            PIC X.
   584                 88  SOC-SEC-NO-USED             VALUE '1'.
   585             20  CF-MEMBER-NO-SW             PIC X.
   586                 88  MEMBER-NO-USED              VALUE '1'.
   587             20  CF-TAX-ID-NUMBER            PIC X(11).
   588             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   589             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   590                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   591                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   592                 88  CF-ALL-APPROVED             VALUE 'Y'.
   593                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   594             20  CF-SYSTEM-E                 PIC X.
   595                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   596
   597         16  CF-LGX-LIFE-USER               PIC X.
   598             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   599             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   600
   601         16  CF-CR-MONTH-END-DT             PIC XX.
   602
   603         16  CF-FILE-MAINT-DATES.
   604             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   605                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   606             20  CF-LAST-BATCH       REDEFINES
   607                 CF-LAST-BATCH-NO               PIC X(4).
   608             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   609             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   610             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   611             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   612             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   613             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  13
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   614             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   615             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   616             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   617             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   618
   619         16  CF-NEXT-COMPANY-ID             PIC XXX.
   620         16  FILLER                         PIC X.
   621
   622         16  CF-ALT-MORT-CODE               PIC X(4).
   623         16  CF-MEMBER-CAPTION              PIC X(10).
   624
   625         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   626             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   627             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   628             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   629             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   630             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   631
   632         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   633
   634         16  CF-LIFE-OVERRIDE-L1            PIC X.
   635         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   636         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   637         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   638
   639         16  CF-AH-OVERRIDE-L1              PIC X.
   640         16  CF-AH-OVERRIDE-L2              PIC XX.
   641         16  CF-AH-OVERRIDE-L6              PIC X(6).
   642         16  CF-AH-OVERRIDE-L12             PIC X(12).
   643
   644         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   645         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   646
   647         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   648         16  CF-AR-LAST-EL860-DT            PIC XX.
   649         16  CF-MP-MONTH-END-DT             PIC XX.
   650
   651         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   652         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   653             88  CF-CLAIM-PAID-TO               VALUE '1'.
   654
   655         16  CF-AR-MONTH-END-DT             PIC XX.
   656
   657         16  CF-CRDTCRD-USER                PIC X.
   658             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   659             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   660
   661         16  CF-CC-MONTH-END-DT             PIC XX.
   662
   663         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   664
   665         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   666             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   667             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   668             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   669         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   670         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   671         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  14
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   672         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   673             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   674             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   675         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   676         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   677         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   678             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   679         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   680
   681         16  CF-CL-ZIP-CODE.
   682             20  CF-CL-ZIP-PRIME.
   683                 24  CF-CL-ZIP-1ST          PIC X.
   684                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   685                 24  FILLER                 PIC X(4).
   686             20  CF-CL-ZIP-PLUS4            PIC X(4).
   687         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   688             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   689             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   690             20  FILLER                     PIC XXX.
   691
   692         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   693         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   694         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   695         16  CF-CO-OPTION-START-DATE        PIC XX.
   696         16  CF-REM-TRM-CALC-OPTION         PIC X.
   697           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   698                                                      '3' '4'.
   699           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   700           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   701           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   702           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   703           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   704           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   705
   706         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   707
   708         16  CF-PAYMENT-APPROVAL-LEVELS.
   709             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   710             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   711             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   712             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   713             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   714             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   715
   716         16  CF-END-USER-REPORTING-USER     PIC X.
   717             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   718             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   719
   720         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   721             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   722             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   723
   724         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   725
   726         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   727         16  FILLER                         PIC X.
   728
   729         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  15
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   730             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   731             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   732             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   733
   734         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   735
   736         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   737             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   738             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   739
   740         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   741             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   742             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   743
   744         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   745
   746         16  CF-CO-ACH-ID-CODE              PIC  X.
   747             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   748             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   749             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   750         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   751         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   752         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   753         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   754         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   755         16  CF-CO-ACH-RECV-NO              PIC X(08).
   756         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   757         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   758         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   759                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   760         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   761                 CF-CO-ACH-TRACE-NO         PIC X(4).
   762
   763         16  CF-CO-OVER-SHORT.
   764             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   765             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   766
   767*         16  FILLER                         PIC X(102).
   768         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   769             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   770             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   771
   772         16  CF-AH-APPROVAL-DAYS.
   773             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   774             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   775             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   776             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   777
   778         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   779
   780         16  CF-APPROV-LEV-5.
   781             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   782             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   783             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   784
   785         16  FILLER                         PIC X(68).
   786****************************************************************
   787*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  16
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   788****************************************************************
   789
   790     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   791         16  CF-PROCESSOR-NAME              PIC X(30).
   792         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   793         16  CF-PROCESSOR-TITLE             PIC X(26).
   794         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   795                 88  MESSAGE-YES                VALUE 'Y'.
   796                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   797
   798*****************************************************
   799****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   800****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   801****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   802****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   803*****************************************************
   804
   805         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   806             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   807             20  CF-APPLICATION-FORCE       PIC X.
   808             20  CF-INDIVIDUAL-APP.
   809                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   810                     28  CF-BROWSE-APP      PIC X.
   811                     28  CF-UPDATE-APP      PIC X.
   812
   813         16  CF-CURRENT-TERM-ON             PIC X(4).
   814         16  CF-PROCESSOR-LIMITS-CLAIMS.
   815             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   816             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   817             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   818             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   819             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   820             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   821             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   822         16  CF-PROCESSOR-CARRIER           PIC X.
   823             88  NO-CARRIER-SECURITY            VALUE ' '.
   824         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   825             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   826         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   827             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   828         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   829             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   830
   831         16  CF-PROC-SYS-ACCESS-SW.
   832             20  CF-PROC-CREDIT-CLAIMS-SW.
   833                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   834                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   835                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   836                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   837             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   838                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   839                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   840             20  CF-PROC-LIFE-GNRLDGR-SW.
   841                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   842                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   843                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   844                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   845             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  17
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   846                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   847                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   848         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   849             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   850             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   851         16  CF-PROCESSOR-PRINTER               PIC X(4).
   852
   853         16  CF-APPROVAL-LEVEL                  PIC X.
   854             88  APPROVAL-LEVEL-1                   VALUE '1'.
   855             88  APPROVAL-LEVEL-2                   VALUE '2'.
   856             88  APPROVAL-LEVEL-3                   VALUE '3'.
   857             88  APPROVAL-LEVEL-4                   VALUE '4'.
   858             88  APPROVAL-LEVEL-5                   VALUE '5'.
   859
   860         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   861
   862         16  CF-LANGUAGE-TYPE                   PIC X.
   863             88  CF-LANG-IS-ENG                     VALUE 'E'.
   864             88  CF-LANG-IS-FR                      VALUE 'F'.
   865
   866         16  CF-CSR-IND                         PIC X.
   867         16  FILLER                             PIC X(239).
   868
   869****************************************************************
   870*             PROCESSOR/REMINDERS RECORD                       *
   871****************************************************************
   872
   873     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   874         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   875             20  CF-START-REMIND-DT         PIC XX.
   876             20  CF-END-REMIND-DT           PIC XX.
   877             20  CF-REMINDER-TEXT           PIC X(50).
   878         16  FILLER                         PIC X(296).
   879
   880
   881****************************************************************
   882*             STATE MASTER RECORD                              *
   883****************************************************************
   884
   885     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   886         16  CF-STATE-ABBREVIATION          PIC XX.
   887         16  CF-STATE-NAME                  PIC X(25).
   888         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   889         16  CF-ST-CALC-QUOTE-TOLERANCE.
   890             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   891             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   892             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   893             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   894                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   895                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   896             20  CF-ST-PREM-REJECT-SW       PIC X.
   897                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   898                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   899             20  CF-ST-REF-REJECT-SW        PIC X.
   900                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   901                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   902         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   903         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  18
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   904         16  CF-ST-REFUND-RULES.
   905             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   906             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   907             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   908         16  CF-ST-FST-PMT-EXTENSION.
   909             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   910             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   911                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   912                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   913                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   914                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   915         16  CF-ST-STATE-CALL.
   916             20  CF-ST-CALL-UNEARNED        PIC X.
   917             20  CF-ST-CALL-RPT-CNTL        PIC X.
   918             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   919         16  CF-REPLACEMENT-LAW-SW          PIC X.
   920             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   921             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   922         16  CF-REPLACEMENT-LETTER          PIC X(4).
   923         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   924         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   925         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   926         16  CF-ST-SPLIT-PAYMENT            PIC X.
   927         16  FILLER                         PIC X.
   928         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   929             20  CF-ST-BENEFIT-CD           PIC XX.
   930             20  CF-ST-BENEFIT-KIND         PIC X.
   931                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   932                 88  CF-ST-AH-KIND              VALUE 'A'.
   933             20  CF-ST-REM-TERM-CALC        PIC X.
   934                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   935                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   936                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   937                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   938                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   939                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   940                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   941                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   942
   943             20  CF-ST-REFUND-CALC          PIC X.
   944                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   945                 88  ST-REFD-BY-R78             VALUE '1'.
   946                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   947                 88  ST-REFD-AS-CALIF           VALUE '3'.
   948                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   949                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   950                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   951                 88  ST-REFD-UTAH               VALUE '7'.
   952                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   953                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   954                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   955
   956             20  CF-ST-EARNING-CALC         PIC X.
   957                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   958                 88  ST-EARN-BY-R78             VALUE '1'.
   959                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   960                 88  ST-EARN-AS-CALIF           VALUE '3'.
   961                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  19
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   962                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   963                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   964                 88  ST-EARN-MEAN               VALUE '8'.
   965                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   966
   967             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   968                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   969                 88  ST-OVRD-BY-R78             VALUE '1'.
   970                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   971                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   972                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   973                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   974                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   975                 88  ST-OVRD-MEAN               VALUE '8'.
   976                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   977             20  FILLER                     PIC X.
   978
   979         16  CF-ST-COMMISSION-CAPS.
   980             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   981             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   982             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   983             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   984         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   985                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   986
   987         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   988
   989         16  CF-ST-STATUTORY-INTEREST.
   990             20  CF-ST-STAT-DATE-FROM       PIC X.
   991                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   992                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   993             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   994             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   995             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   996             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   997             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   998
   999         16  CF-ST-OVER-SHORT.
  1000             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1001             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1002
  1003         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1004
  1005         16  CF-ST-RT-CALC                  PIC X.
  1006
  1007         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1008         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1009         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1010         16  CF-ST-RF-LR-CALC               PIC X.
  1011         16  CF-ST-RF-LL-CALC               PIC X.
  1012         16  CF-ST-RF-LN-CALC               PIC X.
  1013         16  CF-ST-RF-AH-CALC               PIC X.
  1014         16  CF-ST-RF-CP-CALC               PIC X.
  1015*        16  FILLER                         PIC X(206).
  1016*CIDMOD         16  FILLER                         PIC X(192).
  1017         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1018             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1019         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  20
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1020         16  CF-ST-VFY-2ND-BENE             PIC X.
  1021         16  CF-ST-CAUSAL-STATE             PIC X.
  1022         16  FILLER                         PIC X(185).
  1023
  1024****************************************************************
  1025*             BENEFIT MASTER RECORD                            *
  1026****************************************************************
  1027
  1028     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1029         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1030             20  CF-BENEFIT-CODE            PIC XX.
  1031             20  CF-BENEFIT-NUMERIC  REDEFINES
  1032                 CF-BENEFIT-CODE            PIC XX.
  1033             20  CF-BENEFIT-ALPHA           PIC XXX.
  1034             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1035             20  CF-BENEFIT-COMMENT         PIC X(10).
  1036
  1037             20  CF-LF-COVERAGE-TYPE        PIC X.
  1038                 88  CF-REDUCING                VALUE 'R'.
  1039                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1040
  1041             20  CF-SPECIAL-CALC-CD         PIC X.
  1042                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1043                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1044                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1045                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1046                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1047                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1048                 88  CF-FARM-PLAN               VALUE 'F'.
  1049                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1050                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1051                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1052                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1053                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1054                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1055                 88  CF-PRUDENTIAL              VALUE 'P'.
  1056                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1057                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1058                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1059                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1060                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1061                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1062
  1063             20  CF-JOINT-INDICATOR         PIC X.
  1064                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1065
  1066*            20  FILLER                     PIC X(12).
  1067             20  FILLER                     PIC X(11).
  1068             20  CF-BENEFIT-CATEGORY        PIC X.
  1069             20  CF-LOAN-TYPE               PIC X(8).
  1070
  1071             20  CF-CO-REM-TERM-CALC        PIC X.
  1072                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1073                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1074                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1075                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1076                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1077
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  21
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1078             20  CF-CO-EARNINGS-CALC        PIC X.
  1079                 88  CO-EARN-BY-R78             VALUE '1'.
  1080                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1081                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1082                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1083                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1084                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1085                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1086                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1087
  1088             20  CF-CO-REFUND-CALC          PIC X.
  1089                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1090                 88  CO-REFD-BY-R78             VALUE '1'.
  1091                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1092                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1093                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1094                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1095                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1096                 88  CO-REFD-MEAN               VALUE '8'.
  1097                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1098                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1099                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1100
  1101             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1102                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1103                 88  CO-OVRD-BY-R78             VALUE '1'.
  1104                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1105                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1106                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1107                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1108                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1109                 88  CO-OVRD-MEAN               VALUE '8'.
  1110                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1111
  1112             20  CF-CO-BEN-I-G-CD           PIC X.
  1113                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1114                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1115                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1116
  1117         16  FILLER                         PIC X(304).
  1118
  1119
  1120****************************************************************
  1121*             CARRIER MASTER RECORD                            *
  1122****************************************************************
  1123
  1124     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1125         16  CF-ADDRESS-DATA.
  1126             20  CF-MAIL-TO-NAME            PIC X(30).
  1127             20  CF-IN-CARE-OF              PIC X(30).
  1128             20  CF-ADDRESS-LINE-1          PIC X(30).
  1129             20  CF-ADDRESS-LINE-2          PIC X(30).
  1130             20  CF-CITY-STATE              PIC X(30).
  1131             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1132             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1133
  1134         16  CF-CLAIM-NO-CONTROL.
  1135             20  CF-CLAIM-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  22
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1136                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1137                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1138                 88  CLAIM-NO-SEQ               VALUE '3'.
  1139                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1140             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1141                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1142                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1143                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1144
  1145         16  CF-CHECK-NO-CONTROL.
  1146             20  CF-CHECK-NO-METHOD         PIC X.
  1147                 88  CHECK-NO-MANUAL            VALUE '1'.
  1148                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1149                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1150                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1151             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1152                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1153
  1154         16  CF-DOMICILE-STATE              PIC XX.
  1155
  1156         16  CF-EXPENSE-CONTROLS.
  1157             20  CF-EXPENSE-METHOD          PIC X.
  1158                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1159                 88  DOLLARS-PER-PMT            VALUE '2'.
  1160                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1161                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1162             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1163             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1164
  1165         16  CF-CORRESPONDENCE-CONTROL.
  1166             20  CF-LETTER-RESEND-OPT       PIC X.
  1167                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1168                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1169             20  FILLER                     PIC X(4).
  1170
  1171         16  CF-RESERVE-CONTROLS.
  1172             20  CF-MANUAL-SW               PIC X.
  1173                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1174             20  CF-FUTURE-SW               PIC X.
  1175                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1176             20  CF-PTC-SW                  PIC X.
  1177                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1178             20  CF-IBNR-SW                 PIC X.
  1179                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1180             20  CF-PTC-LF-SW               PIC X.
  1181                 88  CF-LF-PTC-USED             VALUE '1'.
  1182             20  CF-CDT-ACCESS-METHOD       PIC X.
  1183                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1184                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1185                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1186             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1187
  1188         16  CF-CLAIM-CALC-METHOD           PIC X.
  1189             88  360-PLUS-MONTHS                VALUE '1'.
  1190             88  365-PLUS-MONTHS                VALUE '2'.
  1191             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1192             88  360-DAILY                      VALUE '4'.
  1193             88  365-DAILY                      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  23
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1194
  1195         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1196         16  FILLER                         PIC X(11).
  1197
  1198         16  CF-LIMIT-AMOUNTS.
  1199             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1200             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1201             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1202             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1203             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1204             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1205             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1206             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1207             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1208             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1209
  1210         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1211         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1212         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1213
  1214         16  CF-ZIP-CODE.
  1215             20  CF-ZIP-PRIME.
  1216                 24  CF-ZIP-1ST             PIC X.
  1217                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1218                 24  FILLER                 PIC X(4).
  1219             20  CF-ZIP-PLUS4               PIC X(4).
  1220         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1221             20  CF-CAN-POSTAL-1            PIC XXX.
  1222             20  CF-CAN-POSTAL-2            PIC XXX.
  1223             20  FILLER                     PIC XXX.
  1224
  1225         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1226         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1227         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1228
  1229         16  CF-RATING-SWITCH               PIC X.
  1230             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1231             88  CF-NO-RATING                   VALUE 'N'.
  1232
  1233         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1234
  1235         16  CF-CARRIER-OVER-SHORT.
  1236             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1237             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1238
  1239         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1240         16  CF-SECPAY-SWITCH               PIC X.
  1241             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1242             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1243         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1244         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1245         16  FILLER                         PIC X(444).
  1246*        16  FILLER                         PIC X(452).
  1247
  1248
  1249****************************************************************
  1250*             MORTALITY MASTER RECORD                          *
  1251****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  24
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1252
  1253     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1254         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1255                                INDEXED BY CF-MORT-NDX.
  1256             20  CF-MORT-TABLE              PIC X(5).
  1257             20  CF-MORT-TABLE-TYPE         PIC X.
  1258                 88  CF-MORT-JOINT              VALUE 'J'.
  1259                 88  CF-MORT-SINGLE             VALUE 'S'.
  1260                 88  CF-MORT-COMBINED           VALUE 'C'.
  1261                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1262                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1263             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1264             20  CF-MORT-AGE-METHOD         PIC XX.
  1265                 88  CF-AGE-LAST                VALUE 'AL'.
  1266                 88  CF-AGE-NEAR                VALUE 'AN'.
  1267             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1268             20  CF-MORT-ADJUSTMENT-DIRECTION
  1269                                            PIC X.
  1270                 88  CF-MINUS                   VALUE '-'.
  1271                 88  CF-PLUS                    VALUE '+'.
  1272             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1273             20  CF-MORT-JOINT-CODE         PIC X.
  1274                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1275             20  CF-MORT-PC-Q               PIC X.
  1276                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1277             20  CF-MORT-TABLE-CODE         PIC X(4).
  1278             20  CF-MORT-COMMENTS           PIC X(15).
  1279             20  FILLER                     PIC X(14).
  1280
  1281         16  FILLER                         PIC X(251).
  1282
  1283
  1284****************************************************************
  1285*             BUSSINESS TYPE MASTER RECORD                     *
  1286****************************************************************
  1287
  1288     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1289* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1290* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1291* AND RECORD 05 IS TYPES 81-99
  1292         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1293             20  CF-BUSINESS-TITLE          PIC  X(19).
  1294             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1295                                            PIC S9V9(4) COMP-3.
  1296             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1297             20  FILLER                     PIC  X.
  1298         16  FILLER                         PIC  X(248).
  1299
  1300
  1301****************************************************************
  1302*             TERMINAL MASTER RECORD                           *
  1303****************************************************************
  1304
  1305     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1306
  1307         16  CF-COMPANY-TERMINALS.
  1308             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1309                                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  25
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1310         16  FILLER               PIC X(248).
  1311
  1312
  1313****************************************************************
  1314*             LIFE EDIT MASTER RECORD                          *
  1315****************************************************************
  1316
  1317     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1318         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1319             20  CF-LIFE-CODE-IN            PIC XX.
  1320             20  CF-LIFE-CODE-OUT           PIC XX.
  1321         16  FILLER                         PIC X(248).
  1322
  1323
  1324****************************************************************
  1325*             AH EDIT MASTER RECORD                            *
  1326****************************************************************
  1327
  1328     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1329         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1330             20  CF-AH-CODE-IN              PIC XXX.
  1331             20  CF-AH-CODE-OUT             PIC XX.
  1332         16  FILLER                         PIC X(248).
  1333
  1334
  1335****************************************************************
  1336*             CREDIBILITY TABLES                               *
  1337****************************************************************
  1338
  1339     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1340         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1341                             INDEXED BY CF-CRDB-NDX.
  1342             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1343             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1344             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1345         16  FILLER                         PIC  X(332).
  1346
  1347
  1348****************************************************************
  1349*             REPORT CUSTOMIZATION RECORD                      *
  1350****************************************************************
  1351
  1352     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1353         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1354             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1355             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1356             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1357**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1358****       A T-TRANSFER.                                   ****
  1359             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1360
  1361         16  FILLER                         PIC XX.
  1362
  1363         16  CF-CARRIER-CNTL-OPT.
  1364             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1365                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1366                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1367             20  CF-CARRIER-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  26
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1368                                            PIC X.
  1369         16  CF-GROUP-CNTL-OPT.
  1370             20  CF-GROUP-OPT-SEQ           PIC 9.
  1371                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1372                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1373             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1374                                            PIC X(6).
  1375         16  CF-STATE-CNTL-OPT.
  1376             20  CF-STATE-OPT-SEQ           PIC 9.
  1377                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1378                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1379             20  CF-STATE-SELECT OCCURS 3 TIMES
  1380                                            PIC XX.
  1381         16  CF-ACCOUNT-CNTL-OPT.
  1382             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1383                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1384                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1385             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1386                                            PIC X(10).
  1387         16  CF-BUS-TYP-CNTL-OPT.
  1388             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1389                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1390                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1391             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1392                                            PIC XX.
  1393         16  CF-LF-TYP-CNTL-OPT.
  1394             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1395                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1396                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1397             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1398                                            PIC XX.
  1399         16  CF-AH-TYP-CNTL-OPT.
  1400             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1401                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1402                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1403             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1404                                            PIC XX.
  1405         16  CF-REPTCD1-CNTL-OPT.
  1406             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1407                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1408                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1409             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1410                                            PIC X(10).
  1411         16  CF-REPTCD2-CNTL-OPT.
  1412             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1413                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1414                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1415             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1416                                            PIC X(10).
  1417         16  CF-USER1-CNTL-OPT.
  1418             20  CF-USER1-OPT-SEQ           PIC 9.
  1419                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1420                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1421             20  CF-USER1-SELECT OCCURS 3 TIMES
  1422                                            PIC X(10).
  1423         16  CF-USER2-CNTL-OPT.
  1424             20  CF-USER2-OPT-SEQ           PIC 9.
  1425                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  27
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1426                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1427             20  CF-USER2-SELECT OCCURS 3 TIMES
  1428                                            PIC X(10).
  1429         16  CF-USER3-CNTL-OPT.
  1430             20  CF-USER3-OPT-SEQ           PIC 9.
  1431                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1432                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1433             20  CF-USER3-SELECT OCCURS 3 TIMES
  1434                                            PIC X(10).
  1435         16  CF-USER4-CNTL-OPT.
  1436             20  CF-USER4-OPT-SEQ           PIC 9.
  1437                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1438                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1439             20  CF-USER4-SELECT OCCURS 3 TIMES
  1440                                            PIC X(10).
  1441         16  CF-USER5-CNTL-OPT.
  1442             20  CF-USER5-OPT-SEQ           PIC 9.
  1443                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1444                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1445             20  CF-USER5-SELECT OCCURS 3 TIMES
  1446                                            PIC X(10).
  1447         16  CF-REINS-CNTL-OPT.
  1448             20  CF-REINS-OPT-SEQ           PIC 9.
  1449                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1450                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1451             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1452                 24  CF-REINS-PRIME         PIC XXX.
  1453                 24  CF-REINS-SUB           PIC XXX.
  1454
  1455         16  CF-AGENT-CNTL-OPT.
  1456             20  CF-AGENT-OPT-SEQ           PIC 9.
  1457                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1458                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1459             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1460                                            PIC X(10).
  1461
  1462         16  FILLER                         PIC X(43).
  1463
  1464         16  CF-LOSS-RATIO-SELECT.
  1465             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1466             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1467         16  CF-ENTRY-DATE-SELECT.
  1468             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1469             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1470         16  CF-EFFECTIVE-DATE-SELECT.
  1471             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1472             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1473
  1474         16  CF-EXCEPTION-LIST-IND          PIC X.
  1475             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1476
  1477         16  FILLER                         PIC X(318).
  1478
  1479****************************************************************
  1480*                  EXCEPTION REPORTING RECORD                  *
  1481****************************************************************
  1482
  1483     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  28
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1484         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1485             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1486
  1487         16  CF-COMBINED-LIFE-AH-OPT.
  1488             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1489             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1490             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1491             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1492
  1493         16  CF-LIFE-OPT.
  1494             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1495             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1496             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1497             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1498             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1499             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1500             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1501             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1502             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1503             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1504
  1505         16  CF-AH-OPT.
  1506             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1507             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1508             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1509             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1510             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1511             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1512             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1513             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1514             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1515             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1516
  1517         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1518             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1519             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1520             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1521
  1522         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1523
  1524         16  FILLER                         PIC X(673).
  1525
  1526
  1527****************************************************************
  1528*             MORTGAGE SYSTEM PLAN RECORD                      *
  1529****************************************************************
  1530
  1531     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1532         16  CF-PLAN-TYPE                   PIC X.
  1533             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1534             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1535             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1536         16  CF-PLAN-ABBREV                 PIC XXX.
  1537         16  CF-PLAN-DESCRIPT               PIC X(10).
  1538         16  CF-PLAN-NOTES                  PIC X(20).
  1539         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1540         16  CF-PLAN-UNDERWRITING.
  1541             20  CF-PLAN-TERM-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  29
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1542                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1543                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1544             20  CF-PLAN-AGE-DATA.
  1545                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1546                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1547                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1548             20  CF-PLAN-BENEFIT-DATA.
  1549                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1550                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1551                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1552                                            PIC S9(7)V99  COMP-3.
  1553         16  CF-PLAN-POLICY-FORMS.
  1554             20  CF-POLICY-FORM             PIC X(12).
  1555             20  CF-MASTER-APPLICATION      PIC X(12).
  1556             20  CF-MASTER-POLICY           PIC X(12).
  1557         16  CF-PLAN-RATING.
  1558             20  CF-RATE-CODE               PIC X(5).
  1559             20  CF-SEX-RATING              PIC X.
  1560                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1561                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1562             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1563             20  CF-SUB-STD-TYPE            PIC X.
  1564                 88  CF-PCT-OF-PREM            VALUE '1'.
  1565                 88  CF-PCT-OF-BENE            VALUE '2'.
  1566         16  CF-PLAN-PREM-TOLERANCES.
  1567             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1568             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1569         16  CF-PLAN-PYMT-TOLERANCES.
  1570             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1571             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1572         16  CF-PLAN-MISC-DATA.
  1573             20  FILLER                     PIC X.
  1574             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1575             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1576         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1577         16  CF-PLAN-IND-GRP                PIC X.
  1578             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1579                                                     '1'.
  1580             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1581                                                     '2'.
  1582         16  CF-MIB-SEARCH-SW               PIC X.
  1583             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1584             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1585             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1586             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1587         16  CF-ALPHA-SEARCH-SW             PIC X.
  1588             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1589             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1590             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1591             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1592             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1593             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1594             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1595             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1596             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1597             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1598                                                     'A' 'B' 'C'
  1599                                                     'X' 'Y' 'Z'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  30
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1600         16  CF-EFF-DT-RULE-SW              PIC X.
  1601             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1602             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1603             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1604             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1605             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1606         16  FILLER                         PIC X(4).
  1607         16  CF-HEALTH-QUESTIONS            PIC X.
  1608             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1609         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1610         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1611         16  CF-PLAN-SNGL-JNT               PIC X.
  1612             88  CF-COMBINED-PLAN              VALUE 'C'.
  1613             88  CF-JNT-PLAN                   VALUE 'J'.
  1614             88  CF-SNGL-PLAN                  VALUE 'S'.
  1615         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1616         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1617         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1618         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1619         16  CF-RERATE-CNTL                 PIC  X.
  1620             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1621             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1622             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1623             88  CF-AUTO-RECALC                 VALUE '4'.
  1624         16  CF-BENEFIT-TYPE                PIC  X.
  1625             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1626             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1627         16  CF-POLICY-FEE                  PIC S999V99
  1628                                                    COMP-3.
  1629         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1630         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1631         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1632         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1633         16  FILLER                         PIC  X(32).
  1634         16  CF-TERMINATION-FORM            PIC  X(04).
  1635         16  FILLER                         PIC  X(08).
  1636         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1637                                                       COMP-3.
  1638         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1639         16  CF-ISSUE-LETTER                PIC  X(4).
  1640         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1641         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1642             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1643             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1644         16  CF-MP-REFUND-CALC              PIC X.
  1645             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1646             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1647             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1648             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1649             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1650             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1651             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1652             88  CF-MP-REFD-MEAN                VALUE '8'.
  1653         16  CF-ALT-RATE-CODE               PIC  X(5).
  1654
  1655
  1656         16  FILLER                         PIC X(498).
  1657****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  31
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1658*             MORTGAGE COMPANY MASTER RECORD                   *
  1659****************************************************************
  1660
  1661     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1662         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1663         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1664             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1665             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1666             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1667             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1668             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1669
  1670         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1671         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1672         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1673         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1674         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1675
  1676         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1677             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1678         16  CF-MP-RECON-USE-IND            PIC X(1).
  1679             88  CF-MP-USE-RECON             VALUE 'Y'.
  1680         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1681             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1682         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1683             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1684             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1685         16  FILLER                         PIC X(1).
  1686         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1687             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1688         16  CF-MORTG-MIB-VERSION           PIC X.
  1689             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1690             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1691             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1692         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1693             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1694                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1695             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1696                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1697             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1698                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1699             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1700                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1701             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1702                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1703             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1704                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1705         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1706         16  FILLER                         PIC X(7).
  1707         16  CF-MORTG-DESTINATION-SYMBOL.
  1708             20  CF-MORTG-MIB-COMM          PIC X(5).
  1709             20  CF-MORTG-MIB-TERM          PIC X(5).
  1710         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1711             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1712         16  FILLER                         PIC X(03).
  1713         16  CF-MP-CHECK-NO-CONTROL.
  1714             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1715                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  32
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1716                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1717                                                ' ' LOW-VALUES.
  1718                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1719                                               VALUE '3'.
  1720         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1721         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1722         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1723             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1724                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1725             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1726                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1727             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1728                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1729             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1730                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1731             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1732                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1733             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1734                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1735         16  CF-MORTG-BILLING-AREA.
  1736             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1737                                            PIC X.
  1738         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1739         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1740         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1741         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1742             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1743             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1744         16  FILLER                         PIC X.
  1745         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1746             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1747             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1748         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1749         16  FILLER                         PIC X(8).
  1750         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1751         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1752         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1753         16  CF-ACH-COMPANY-ID.
  1754             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1755                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1756                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1757                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1758             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1759         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1760             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1761         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1762             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1763             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1764         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1765         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1766         16  FILLER                         PIC X(536).
  1767
  1768****************************************************************
  1769*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1770****************************************************************
  1771
  1772     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1773         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  33
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1774             20  CF-FEMALE-HEIGHT.
  1775                 24  CF-FEMALE-FT           PIC 99.
  1776                 24  CF-FEMALE-IN           PIC 99.
  1777             20  CF-FEMALE-MIN-WT           PIC 999.
  1778             20  CF-FEMALE-MAX-WT           PIC 999.
  1779         16  FILLER                         PIC X(428).
  1780
  1781     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1782         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1783             20  CF-MALE-HEIGHT.
  1784                 24  CF-MALE-FT             PIC 99.
  1785                 24  CF-MALE-IN             PIC 99.
  1786             20  CF-MALE-MIN-WT             PIC 999.
  1787             20  CF-MALE-MAX-WT             PIC 999.
  1788         16  FILLER                         PIC X(428).
  1789******************************************************************
  1790*             AUTOMATIC ACTIVITY RECORD                          *
  1791******************************************************************
  1792     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1793         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1794             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1795             20  CF-SYS-LETTER-ID           PIC X(04).
  1796             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1797             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1798             20  CF-SYS-RESET-SW            PIC X(01).
  1799             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1800             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1801
  1802         16  FILLER                         PIC X(50).
  1803
  1804         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1805             20  CF-USER-ACTIVE-SW          PIC X(01).
  1806             20  CF-USER-LETTER-ID          PIC X(04).
  1807             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1808             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1809             20  CF-USER-RESET-SW           PIC X(01).
  1810             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1811             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1812             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1813
  1814         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  34
* EL517.cbl
  1816 FD  ERPNDB.
* 1817                                  COPY ERCPNDB.
  1818******************************************************************
  1819*                                                                *
  1820*                                                                *
  1821*                            ERCPNDB.                            *
  1822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1823*                            VMOD=2.025                          *
  1824*                                                                *
  1825*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1826*                                                                *
  1827******************************************************************
  1828*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1829*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1830******************************************************************
  1831*                                                                *
  1832*                                                                *
  1833*   FILE TYPE = VSAM,KSDS                                        *
  1834*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1835*                                                                *
  1836*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1837*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1838*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1839*                                                 RKP=13,LEN=36  *
  1840*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1841*                                      AND CHG-SEQ.)             *
  1842*                                                RKP=49,LEN=11   *
  1843*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1844*                                      AND CHG-SEQ.)             *
  1845*                                                RKP=60,LEN=15   *
  1846*                                                                *
  1847*   LOG = NO                                                     *
  1848*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1849******************************************************************
  1850******************************************************************
  1851*                   C H A N G E   L O G
  1852*
  1853* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1854*-----------------------------------------------------------------
  1855*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1856* EFFECTIVE    NUMBER
  1857*-----------------------------------------------------------------
  1858* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1859* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1860* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1861* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1862* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1863* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1864* 032306                   PEMA  ADD BOW LOAN NUMBER
  1865* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1866* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1867* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1868* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1869* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1870* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1871* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1872* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1873******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1874
  1875 01  PENDING-BUSINESS.
  1876     12  PB-RECORD-ID                     PIC XX.
  1877         88  VALID-PB-ID                        VALUE 'PB'.
  1878
  1879     12  PB-CONTROL-PRIMARY.
  1880         16  PB-COMPANY-CD                PIC X.
  1881         16  PB-ENTRY-BATCH               PIC X(6).
  1882         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1883         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1884
  1885     12  PB-CONTROL-BY-ACCOUNT.
  1886         16  PB-COMPANY-CD-A1             PIC X.
  1887         16  PB-CARRIER                   PIC X.
  1888         16  PB-GROUPING.
  1889             20  PB-GROUPING-PREFIX       PIC XXX.
  1890             20  PB-GROUPING-PRIME        PIC XXX.
  1891         16  PB-STATE                     PIC XX.
  1892         16  PB-ACCOUNT.
  1893             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1894             20  PB-ACCOUNT-PRIME         PIC X(6).
  1895         16  PB-CERT-EFF-DT               PIC XX.
  1896         16  PB-CERT-NO.
  1897             20  PB-CERT-PRIME            PIC X(10).
  1898             20  PB-CERT-SFX              PIC X.
  1899         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1900
  1901         16  PB-RECORD-TYPE               PIC X.
  1902             88  PB-MAILING-DATA                VALUE '0'.
  1903             88  PB-ISSUE                       VALUE '1'.
  1904             88  PB-CANCELLATION                VALUE '2'.
  1905             88  PB-BATCH-TRAILER               VALUE '9'.
  1906
  1907     12  PB-CONTROL-BY-ORIG-BATCH.
  1908         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1909         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1910         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1911         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1912
  1913     12  PB-CONTROL-BY-CSR.
  1914         16  PB-CSR-COMPANY-CD            PIC X.
  1915         16  PB-CSR-ID                    PIC X(4).
  1916         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1917         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1918         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1919******************************************************************
  1920*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1921******************************************************************
  1922
  1923     12  PB-LAST-MAINT-DT                 PIC XX.
  1924     12  PB-LAST-MAINT-BY                 PIC X(4).
  1925     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1926
  1927     12  PB-RECORD-BODY                   PIC X(375).
  1928
  1929     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1930         16  PB-CERT-ORIGIN               PIC X.
  1931             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1932         16  PB-I-NAME.
  1933             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1934             20  PB-I-INSURED-FIRST-NAME.
  1935                 24  PB-I-INSURED-1ST-INIT PIC X.
  1936                 24  FILLER                PIC X(9).
  1937             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1938         16  PB-I-AGE                     PIC S99   COMP-3.
  1939         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1940         16  PB-I-BIRTHDAY                PIC XX.
  1941         16  PB-I-INSURED-SEX             PIC X.
  1942             88  PB-SEX-MALE     VALUE 'M'.
  1943             88  PB-SEX-FEMALE   VALUE 'F'.
  1944
  1945         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1946         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1947         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1948         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1949         16  PB-I-SKIP-CODE               PIC X.
  1950             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1951             88  PB-SKIP-JULY              VALUE '1'.
  1952             88  PB-SKIP-AUGUST            VALUE '2'.
  1953             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1954             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1955             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1956             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1957             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1958             88  PB-SKIP-JUNE              VALUE '8'.
  1959             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1960             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1961             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1962         16  PB-I-TERM-TYPE               PIC X.
  1963             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1964             88  PB-PAID-WEEKLY            VALUE 'W'.
  1965             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1966             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1967             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1968         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1969         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1970         16  PB-I-DATA-ENTRY-SW           PIC X.
  1971             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1972             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1973             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1974             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1975         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1976         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1977*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1978         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1979         16  FILLER                       PIC X.
  1980
  1981         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1982             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1983             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1984                                                   '90' THRU '99'.
  1985         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1986                                          PIC XX.
  1987         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1988         16  PB-I-AMOUNT-FINANCED REDEFINES
  1989                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1990         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1991         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1992                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1993         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1994         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1995         16  PB-I-CLP-AMOUNT REDEFINES
  1996                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1997         16  PB-I-LF-CALC-FLAG            PIC X.
  1998             88 PB-COMP-LF-PREM               VALUE '?'.
  1999         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2000         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2001         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2002         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2003         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2004         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2005         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2006         16  PB-I-LF-ABBR                 PIC XXX.
  2007         16  PB-I-LF-INPUT-CD             PIC XX.
  2008
  2009         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2010             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2011             88  PB-INVALID-AH               VALUE '  ' '00'
  2012                                                   '90' THRU '99'.
  2013         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2014         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2015         16  PB-I-AH-CALC-FLAG            PIC X.
  2016             88 PB-COMP-AH-PREM                  VALUE '?'.
  2017         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2018         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2019         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2020         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2021         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2022         16  PB-I-AH-ABBR                 PIC XXX.
  2023         16  PB-I-AH-INPUT-CD             PIC XXX.
  2024
  2025         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2026         16  PB-I-REIN-TABLE              PIC XXX.
  2027         16  PB-I-BUSINESS-TYPE           PIC 99.
  2028         16  PB-I-INDV-GRP-CD             PIC X.
  2029         16  PB-I-MORT-CODE.
  2030             20  PB-I-TABLE               PIC X.
  2031             20  PB-I-INTEREST            PIC XX.
  2032             20  PB-I-MORT-TYP            PIC X.
  2033         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2034         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2035         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2036         16  PB-I-INDV-GRP-OVRD           PIC X.
  2037         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2038         16  PB-I-SIG-SW                  PIC X.
  2039             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2040         16  PB-I-RATE-CLASS              PIC XX.
  2041         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2042         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2043         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2044         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2045         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2046         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2047         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2048         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2049         16  PB-I-OB-FLAG                 PIC X.
  2050             88  PB-I-OB                      VALUE 'B'.
  2051             88  PB-I-SUMMARY                 VALUE 'Z'.
  2052         16  PB-I-ENTRY-STATUS            PIC X.
  2053             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2054                                              'M' '5' '9' '2'.
  2055             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2056             88  PB-I-POLICY-PENDING          VALUE '2'.
  2057             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2058             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2059             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2060             88  PB-I-REIN-ONLY               VALUE '9'.
  2061             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2062             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2063             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2064             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2065         16  PB-I-INT-CODE                PIC X.
  2066             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2067             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2068         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2069         16  PB-I-SOC-SEC-NO              PIC X(11).
  2070         16  PB-I-MEMBER-NO               PIC X(12).
  2071         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2072*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2073         16  PB-I-OLD-LOF                 PIC XXX.
  2074         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2075         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2076         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2077         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2078         16  PB-I-LIFE-INDICATOR          PIC X.
  2079             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2080         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2081         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2082                                          PIC S9(5)V99    COMP-3.
  2083         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2084             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2085             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2086         16  PB-I-1ST-PMT-DT              PIC XX.
  2087         16  PB-I-JOINT-INSURED.
  2088             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2089             20 PB-I-JOINT-FIRST-NAME.
  2090                24  PB-I-JOINT-FIRST-INIT PIC X.
  2091                24  FILLER                PIC X(9).
  2092             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2093*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2094         16  PB-I-BENEFICIARY-NAME.
  2095             20  PB-I-BANK-NUMBER         PIC X(10).
  2096             20  FILLER                   PIC X(15).
  2097         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2098         16  PB-I-REFERENCE               PIC X(12).
  2099         16  FILLER REDEFINES PB-I-REFERENCE.
  2100             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2101             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2102             20  PB-I-CLP-STATE           PIC XX.
  2103         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2104             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2105             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2106             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2107         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2108         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2109         16  PB-I-RESIDENT-STATE          PIC XX.
  2110         16  PB-I-RATE-CODE               PIC X(4).
  2111         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2112         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2113         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2114         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2115         16  PB-I-BANK-NOCHRGB            PIC 99.
  2116         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2117         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2118
  2119     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2120         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2121             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2122         16  PB-C-CANCEL-ORIGIN           PIC X.
  2123             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2124         16  PB-C-LF-CANCEL-DT            PIC XX.
  2125         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2126         16  PB-C-LF-CALC-REQ             PIC X.
  2127             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2128         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2129         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2130         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2131             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2132         16  PB-C-AH-CANCEL-DT            PIC XX.
  2133         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2134         16  PB-C-AH-CALC-REQ             PIC X.
  2135             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2136         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2137         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2138         16  PB-C-LAST-NAME               PIC X(15).
  2139         16  PB-C-REFUND-SW               PIC X.
  2140             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2141             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2142         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2143         16  PB-C-PAYEE-CODE              PIC X(6).
  2144         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2145         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2146         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2147         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2148         16  PB-C-REFERENCE               PIC X(12).
  2149         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2150         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2151         16  PB-C-POST-CARD-IND           PIC X.
  2152         16  PB-C-CANCEL-REASON           PIC X.
  2153         16  PB-C-REF-INTERFACE-SW        PIC X.
  2154         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2155         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2156         16  FILLER                       PIC X(01).
  2157*        16  FILLER                       PIC X(18).
  2158         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2159*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2160         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2161         16  PB-CANCELED-CERT-DATA.
  2162             20  PB-CI-INSURED-NAME.
  2163                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2164                 24  PB-CI-INITIALS       PIC XX.
  2165             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2166             20  PB-CI-INSURED-SEX        PIC X.
  2167             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2168             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2169             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2170             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2171             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2172             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2173             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2174             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2175             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2176             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2177             20  PB-CI-RATE-CLASS         PIC XX.
  2178             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2179             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2180             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2181             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2182             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2183             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2184             20  PB-CI-LF-ABBR            PIC X(3).
  2185             20  PB-CI-AH-ABBR            PIC X(3).
  2186             20  PB-CI-OB-FLAG            PIC X.
  2187                 88  PB-CI-OB                VALUE 'B'.
  2188             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2189                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2190                                           'M' '4' '5' '9' '2'.
  2191                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2192                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2193                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2194                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2195                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2196                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2197                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2198                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2199                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2200                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2201                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2202                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2203             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2204                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2205                                           'M' '4' '5' '9' '2'.
  2206                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2207                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2208                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2209                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2210                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2211                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2212                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2213                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2214                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2215                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2216                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2217                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2218             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2219             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2220             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2221             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2222             20  PB-CI-INT-CODE           PIC X.
  2223                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2224                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2225             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2226             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2227             20  PB-CI-COMP-EXCP-SW       PIC X.
  2228                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2229                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2230             20  PB-CI-ENTRY-STATUS       PIC X.
  2231             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2232             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2233             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2234             20  PB-CI-DEATH-DT           PIC XX.
  2235             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2236             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2237             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2238             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2239             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2240             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2241             20  PB-CI-ENTRY-DT              PIC XX.
  2242             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2243             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2244             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2245             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2246             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2247             20  PB-CI-OLD-LOF               PIC XXX.
  2248*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2249             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2250             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2251             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2252             20  PB-CI-INDV-GRP-CD           PIC X.
  2253             20  PB-CI-BENEFICIARY-NAME.
  2254                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2255                 24  FILLER                  PIC X(15).
  2256             20  PB-CI-NOTE-SW               PIC X.
  2257             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2258             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2259             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2260             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2261             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2262             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2263             20  PB-CI-FIRST-NAME            PIC X(10).
  2264             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2265
  2266         16  FILLER                       PIC X(13).
  2267*032306  16  FILLER                       PIC X(27).
  2268*        16  FILLER                       PIC X(46).
  2269
  2270     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2271         16  FILLER                       PIC X(10).
  2272         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2273         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2274         16  PB-M-INSURED-MID-INIT        PIC X.
  2275         16  PB-M-INSURED-AGE             PIC 99.
  2276         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2277         16  PB-M-INSURED-SEX             PIC X.
  2278         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2279         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2280         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2281         16  PB-M-INSURED-CITY-STATE.
  2282             20  PB-M-INSURED-CITY        PIC X(28).
  2283             20  PB-M-INSURED-STATE       PIC XX.
  2284         16  PB-M-INSURED-ZIP-CODE.
  2285             20  PB-M-INSURED-ZIP-PRIME.
  2286                 24  PB-M-INSURED-ZIP-1   PIC X.
  2287                     88  PB-M-CANADIAN-POST-CODE
  2288                                             VALUE 'A' THRU 'Z'.
  2289                 24  FILLER               PIC X(4).
  2290             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2291         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2292                                        PB-M-INSURED-ZIP-CODE.
  2293             20  PM-M-INS-CAN-POST1       PIC XXX.
  2294             20  PM-M-INS-CAN-POST2       PIC XXX.
  2295             20  FILLER                   PIC XXX.
  2296         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2297         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2298         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2299         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2300         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2301         16  PB-M-CRED-BENE-CITYST.
  2302             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2303             20  PB-M-CRED-BENE-STATE     PIC XX.
  2304
  2305         16  FILLER                       PIC X(92).
  2306
  2307     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2308         16  FILLER                       PIC X(10).
  2309         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2310         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2311         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2312         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2313         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2314         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2315         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2316         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2317         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2318         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2319         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2320         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2321         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2322         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2323         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2324         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2325         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2326         16  PB-ACCOUNT-NAME              PIC X(30).
  2327         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2328         16  PB-REFERENCE                 PIC X(12).
  2329         16  PB-B-RECEIVED-DT             PIC XX.
  2330         16  FILLER                       PIC X(234).
  2331
  2332     12  PB-RECORD-STATUS.
  2333         16  PB-CREDIT-SELECT-DT          PIC XX.
  2334         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2335         16  PB-BILLED-DT                 PIC XX.
  2336         16  PB-BILLING-STATUS            PIC X.
  2337             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2338             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2339             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2340         16  PB-RECORD-BILL               PIC X.
  2341             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2342             88  PB-RECORD-RETURNED           VALUE 'R'.
  2343             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2344             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2345             88  PB-OVERRIDE-AH               VALUE 'A'.
  2346             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2347         16  PB-BATCH-ENTRY               PIC X.
  2348             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2349             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2350             88  PB-REISSUED-CERT             VALUE 'E'.
  2351             88  PB-MONTHLY-CERT              VALUE 'M'.
  2352             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2353             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2354             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2355         16  PB-FORCE-CODE                PIC X.
  2356             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2357             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2358             88  PB-CANCEL-FORCE              VALUE '8'.
  2359             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2360             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2361             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2362             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2363             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2364             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2365             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2366         16  PB-FATAL-FLAG                PIC X.
  2367             88  PB-FATAL-ERRORS              VALUE 'X'.
  2368         16  PB-FORCE-ER-CD               PIC X.
  2369             88  PB-FORCE-ERRORS              VALUE 'F'.
  2370             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2371         16  PB-WARN-ER-CD                PIC X.
  2372             88  PB-WARNING-ERRORS            VALUE 'W'.
  2373         16  FILLER                       PIC X.
  2374         16  PB-OUT-BAL-CD                PIC X.
  2375             88  PB-OUT-OF-BAL                VALUE 'O'.
  2376         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2377         16  PB-AH-OVERRIDE-L1            PIC X.
  2378         16  PB-INPUT-DT                  PIC XX.
  2379         16  PB-INPUT-BY                  PIC X(4).
  2380         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2381         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2382         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2383         16  PB-LF-EARNING-METHOD         PIC X.
  2384         16  PB-AH-EARNING-METHOD         PIC X.
  2385         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2386         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2387         16  PB-REIN-CD                   PIC XXX.
  2388         16  PB-LF-REFUND-TYPE            PIC X.
  2389         16  PB-AH-REFUND-TYPE            PIC X.
  2390         16  PB-ACCT-EFF-DT               PIC XX.
  2391         16  PB-ACCT-EXP-DT               PIC XX.
  2392         16  PB-COMPANY-ID                PIC X(3).
  2393         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2394         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2395         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2396         16  PB-SV-GROUPING               PIC X(6).
  2397         16  PB-SV-STATE                  PIC XX.
  2398         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2399         16  PB-GA-BILLING-INFO.
  2400             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2401                                          PIC XX.
  2402         16  PB-SV-REMIT-TO  REDEFINES
  2403             PB-GA-BILLING-INFO           PIC X(10).
  2404         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2405         16  PB-I-LOAN-OFFICER            PIC X(5).
  2406         16  PB-I-VIN                     PIC X(17).
  2407
  2408         16  FILLER                       PIC X(04).
  2409         16  IMNET-BYPASS-SW              PIC X.
  2410
  2411******************************************************************
  2412*                COMMON EDIT ERRORS                              *
  2413******************************************************************
  2414
  2415     12  PB-COMMON-ERRORS.
  2416         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2417                                           PIC S9(4)     COMP.
  2418
  2419******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  45
* EL517.cbl
  2421 FD  ERREIN.
* 2422                                  COPY ERCREIN.
  2423******************************************************************07/27/93
  2424*                                                                *ERCREIN
  2425*                            ERCREIN                             *   LV009
  2426*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2427*                            VMOD=2.010                          *   CL**9
  2428*                                                                *ERCREIN
  2429*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2430*                                                                *ERCREIN
  2431*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2432*                                                                *ERCREIN
  2433*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2434*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2435*                                                                *ERCREIN
  2436*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2437*       ALTERNATE PATH = NONE                                    *ERCREIN
  2438*                                                                *ERCREIN
  2439*   LOG = NO                                                     *ERCREIN
  2440*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2441*                                                                *ERCREIN
  2442******************************************************************ERCREIN
  2443*                   C H A N G E   L O G
  2444*
  2445* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2446*-----------------------------------------------------------------
  2447*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2448* EFFECTIVE    NUMBER
  2449*-----------------------------------------------------------------
  2450* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2451* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2452******************************************************************
  2453 01  REINSURANCE-RECORD.                                          ERCREIN
  2454     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2455         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2456                                                                  ERCREIN
  2457     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2458         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2459         16  RE-KEY.                                              ERCREIN
  2460             20  RE-CODE                   PIC X.                 ERCREIN
  2461                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2462                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2463             20  RE-TABLE                  PIC XXX.               ERCREIN
  2464             20  FILLER                    PIC XXX.               ERCREIN
  2465         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2466             20  FILLER                    PIC X.                 ERCREIN
  2467             20  RE-COMPANY.                                      ERCREIN
  2468                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2469                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2470                                                                  ERCREIN
  2471     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2472         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2473         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2474         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2475         16  FILLER                        PIC X(10).             ERCREIN
  2476                                                                  ERCREIN
  2477     12  RE-TABLE-DATA.                                           ERCREIN
  2478         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2479                                                                  ERCREIN
  2480         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2481             20  RE-REI-COMP-NO.                                  ERCREIN
  2482                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2483                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2484             20  RE-LF-QC                  PIC X.                 ERCREIN
  2485             20  RE-AH-QC                  PIC X.                 ERCREIN
  2486             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2487             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2488             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2489             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2490             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2491             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2492             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2493             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2494             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2495             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2496             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2497             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2498             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2499             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2500             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2501             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2502             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2503             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2504             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2505             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2506             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2507             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2508             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2509             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2510             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2511             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2512             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2513             20  RE-REMAINING              PIC X.                 ERCREIN
  2514             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2515             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2516             20  FILLER                    PIC X(19).                  000
  2517                                                                  ERCREIN
  2518         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2519         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2520         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2521         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2522             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2523                                                                  ERCREIN
  2524         16  FILLER                        PIC X(27).             ERCREIN
  2525                                                                  ERCREIN
  2526     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2527         16  RE-NAME                       PIC X(30).             ERCREIN
  2528         16  RE-LF-PE                      PIC X.                 ERCREIN
  2529         16  RE-AH-PE                      PIC X.                 ERCREIN
  2530         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2531         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2532         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2533         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2534         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2535         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2536         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2537         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2538         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2539         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2540         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2541         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2542         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2543         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2544         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2545         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2546         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2547         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2548                                                                  ERCREIN
  2549         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2550             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2551                                                                  ERCREIN
  2552         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2553             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2554                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2555                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2556                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2557                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2558             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2559                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2560                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2561                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2562                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2563                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2564                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2565                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2566                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2567             20  FILLER                    PIC XXX.               ERCREIN
  2568             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2569                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2570                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2571                                                                  ERCREIN
  2572         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2573             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2574                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2575                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2576                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2577                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2578             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2579                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2580                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2581                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2582                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2583                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2584                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2585                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2586                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2587             20  FILLER                    PIC XXX.               ERCREIN
  2588             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2589                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2590                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2591                                                                  ERCREIN
  2592         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2593                                                                  ERCREIN
  2594         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2595                                                                  ERCREIN
  2596         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2597         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2598         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2599         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2600         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2601         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2602         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2603         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2604         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2605             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2606             88  RE-CEDED                          VALUE 'C'.        CL**2
  2607             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2608             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2609                                                                  ERCREIN
  2610         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2611             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2612         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2613             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2614         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2615             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2616         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2617             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2618         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2619             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2620                                                                     CL**3
  2621         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2622                                                                     CL**5
  2623         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2624                                                                     CL**8
  2625         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2626                                                                     CL**8
  2627         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2628                                                                     CL**9
  2629         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2630             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2631             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2632
  2633         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2634             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2635                                                                     CL**9
  2636         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2637         16  FILLER                        PIC X(2281).              CL**9
  2638                                                                  ERCREIN
  2639         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2640                                                                  ERCREIN
  2641******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  49
* EL517.cbl
  2643 FD  ELCERT.
* 2644                                  COPY ELCCERT.
  2645******************************************************************04/15/98
  2646*                                                                *ELCCERT
  2647*                            ELCCERT.                            *   LV002
  2648*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2649*                            VMOD=2.013                          *   CL**2
  2650*                                                                *ELCCERT
  2651*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2652*                                                                *ELCCERT
  2653*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2654*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2655*                                                                *ELCCERT
  2656*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2657*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2658*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2659*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2660*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2661*                                                                *ELCCERT
  2662*   LOG = YES                                                    *ELCCERT
  2663*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2664******************************************************************
  2665*                   C H A N G E   L O G
  2666*
  2667* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2668*-----------------------------------------------------------------
  2669*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2670* EFFECTIVE    NUMBER
  2671*-----------------------------------------------------------------
  2672* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2673* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2674* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2675* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2676* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2677* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2678* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2679* 032612  CR2011110200001  PEMA  AHL CHANGES
  2680******************************************************************
  2681                                                                  ELCCERT
  2682 01  CERTIFICATE-MASTER.                                          ELCCERT
  2683     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2684         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2685                                                                  ELCCERT
  2686     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2687         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2688         16  CM-CARRIER                    PIC X.                 ELCCERT
  2689         16  CM-GROUPING.                                         ELCCERT
  2690             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2691             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2692         16  CM-STATE                      PIC XX.                ELCCERT
  2693         16  CM-ACCOUNT.                                          ELCCERT
  2694             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2695             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2696         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2697         16  CM-CERT-NO.                                          ELCCERT
  2698             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2699             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2700                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2701     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2702         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2703         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2704         16  CM-INSURED-INITIALS.                                 ELCCERT
  2705             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2706             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2707                                                                  ELCCERT
  2708     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2709         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2710         16  CM-SOC-SEC-NO.                                       ELCCERT
  2711             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2712             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2713             20  CM-SSN-LN3.                                      ELCCERT
  2714                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2715                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2716                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2717                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2718                                                                  ELCCERT
  2719     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2720         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2721         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2722                                                                  ELCCERT
  2723     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2724         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2725         16  CM-MEMBER-NO.                                        ELCCERT
  2726             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2727             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2728             20  CM-MEMB-LN4.                                     ELCCERT
  2729                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2730                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2731                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2732                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2733                                                                  ELCCERT
  2734     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2735         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2736             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2737             20  FILLER                    PIC X(9).              ELCCERT
  2738         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2739         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2740             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2741             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2742         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2743         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2744             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2745             20  CM-JT-FIRST-NAME.                                ELCCERT
  2746                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2747                 24  FILLER                PIC X(9).              ELCCERT
  2748             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2749                                                                  ELCCERT
  2750     12  CM-LIFE-DATA.                                            ELCCERT
  2751         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2752         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2753         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2754         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2755         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2756         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2757         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2758         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2759         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2760         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2761         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2762         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2763         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2764         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2765         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2766         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2767         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2768         16  FILLER                        PIC XX.                ELCCERT
  2769                                                                  ELCCERT
  2770     12  CM-AH-DATA.                                              ELCCERT
  2771         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2772         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2773         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2774         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2775         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2776         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2777         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2778         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2779         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2780         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2781         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2782         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2783             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2784         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2785         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2786         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2787         16  FILLER                        PIC X.                 ELCCERT
  2788                                                                  ELCCERT
  2789     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2790         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2791         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2792                                           PIC S9(5)V99  COMP-3.
  2793         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2794         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2795         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2796         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2797         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2798         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2799         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2800         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2801         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2802         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2803             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2804             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2805         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2806             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2807             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2808             20  FILLER                    PIC XX.                ELCCERT
  2809         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2810             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2811             20  FILLER                    PIC XXX.               ELCCERT
  2812         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2813         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2814             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2815         16  CM-POST-CARD-IND              PIC X.
  2816         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2817         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2818             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2819             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2820             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2821         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2822             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2823             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2824         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2825             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2826             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2827             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2828             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2829             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2830             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2831             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2832             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2833             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2834             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2835             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2836             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2837         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2838             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2839             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2840             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2841             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2842             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2843         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2844         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2845         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2846*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2847         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2848         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2849         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2850         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2851         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2852                                                                  ELCCERT
  2853     12  CM-STATUS-DATA.                                          ELCCERT
  2854         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2855         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2856                                                                  ELCCERT
  2857         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2858         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2859         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2860                                                                  ELCCERT
  2861         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2862         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2863         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2864                                                                  ELCCERT
  2865         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2866             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2867                                                'M' '4' '5' '9'.  ELCCERT
  2868             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2869             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2870             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2871             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2872             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2873             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2874             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2875             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2876             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2877             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2878             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2879             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2880                                                                  ELCCERT
  2881         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2882         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2883         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2884                                                                  ELCCERT
  2885         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2886         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2887         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2888                                                                  ELCCERT
  2889         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2890             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2891                                                'M' '4' '5' '9'.  ELCCERT
  2892             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2893             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2894             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2895             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2896             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2897             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2898             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2899             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2900             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2901             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2902             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2903             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2904                                                                  ELCCERT
  2905         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2906             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2907             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2908             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2909         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2910                                                                  ELCCERT
  2911         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2912         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2913         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2914         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2915                                                                  ELCCERT
  2916     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2917         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2918         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2919         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2920         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2921         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2922         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2923         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2924         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2925     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2926         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2927         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2928     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2929         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2930         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2931                                                                  ELCCERT
  2932*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2933     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2934     12  FILLER                            PIC X.
  2935                                                                  ELCCERT
  2936*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2937     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2938     12  FILLER                            PIC X.
  2939*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2940     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2941                                                                  ELCCERT
  2942     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2943         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2944         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2945         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2946         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2947         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2948     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2949         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2950         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2951         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2952         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2953         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2954         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2955         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2956         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2957                                                                  ELCCERT
  2958     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2959         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2960         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2961                                                                  ELCCERT
  2962     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2963     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2964     12  CM-CLP-STATE                      PIC XX.
  2965     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2966     12  CM-USER-RESERVED                  PIC XXX.
  2967     12  FILLER REDEFINES CM-USER-RESERVED.
  2968         16  CM-AH-CLASS-CD                PIC XX.
  2969         16  F                             PIC X.
  2970******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  55
* EL517.cbl
  2972 FD  ELMSTR.
* 2973                                  COPY ELCMSTR.
  2974******************************************************************04/15/98
  2975*                                                                *ELCMSTR
  2976*                            ELCMSTR.                            *   LV002
  2977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2978*                            VMOD=2.012                          *   CL**2
  2979*                                                                *ELCMSTR
  2980*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2981*                                                                *ELCMSTR
  2982*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2983*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2984*                                                                *ELCMSTR
  2985*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2986*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2987*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2988*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2989*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2990*                                                 RKP=75,LEN=21  *ELCMSTR
  2991*                                                                *ELCMSTR
  2992*   **** NOTE ****                                               *ELCMSTR
  2993*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2994*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2995*                                                                *ELCMSTR
  2996*   LOG = YES                                                    *ELCMSTR
  2997*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2998******************************************************************
  2999*                   C H A N G E   L O G
  3000*
  3001* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3002*-----------------------------------------------------------------
  3003*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3004* EFFECTIVE    NUMBER
  3005*-----------------------------------------------------------------
  3006* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3007* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3008* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3009******************************************************************ELCMSTR
  3010 01  CLAIM-MASTER.                                                ELCMSTR
  3011     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  3012         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  3013                                                                  ELCMSTR
  3014     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3015         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3016         16  CL-CARRIER              PIC X.                       ELCMSTR
  3017         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3018         16  CL-CERT-NO.                                          ELCMSTR
  3019             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3020             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3021                                                                  ELCMSTR
  3022     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3023         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3024         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3025         16  CL-INSURED-NAME.                                     ELCMSTR
  3026             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3027             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3028                                                                  ELCMSTR
  3029     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3030         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  3031         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3032             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3033             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3034             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3035                                                                  ELCMSTR
  3036     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3037         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3038         16  CL-CERT-NO-A4.                                       ELCMSTR
  3039             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3040             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3041                                                                  ELCMSTR
  3042     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3043         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3044         16  CL-CCN-A5.                                           ELCMSTR
  3045             20  CL-CCN.                                          ELCMSTR
  3046                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3047                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3048             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3049                                                                  ELCMSTR
  3050     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3051         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3052         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3053             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3054             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3055             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3056         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3057         16  FILLER                  PIC X(5).                    ELCMSTR
  3058                                                                  ELCMSTR
  3059     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3060         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3061         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3062             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3063             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3064         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3065*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3066*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3067*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3068*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3069*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3070         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3071             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3072             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3073             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3074         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3075         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3076         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3077         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3078         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3079         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3080         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3081         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3082         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3083         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3084         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3085             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3086             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3087             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3088         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  3089                                                                  ELCMSTR
  3090         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3091             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3092             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3093                                                                  ELCMSTR
  3094         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3095             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3096             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3097                                                                  ELCMSTR
  3098         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3099         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3100         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3101                                                                  ELCMSTR
  3102         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3103         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3104         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3105             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3106             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3107             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3108             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3109             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3110             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3111         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3112         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3113         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3114             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3115         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3116         16  FILLER                  PIC X.
  3117                                                                  ELCMSTR
  3118     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3119         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3120             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3121             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3122             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3123         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3124             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3125             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3126             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3127             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3128                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3129                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3130             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3131                                                                  ELCMSTR
  3132     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3133         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3134             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3135             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3136         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3137             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3138             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3139         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3140         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3141         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3142         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3143         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3144         16  CL-CRITICAL-PERIOD      PIC 99.
  3145*        16  FILLER                  PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3146         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3147         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  3148         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3149         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3150             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3151             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3152             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3153             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3154             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3155             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3156             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3157             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3158             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3159         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3160         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3161         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3162         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3163         16  CL-DENIAL-TYPE          PIC X.
  3164             88  CL-TYPE-DENIAL          VALUE '1'.
  3165             88  CL-TYPE-RESCISSION      VALUE '2'.
  3166             88  CL-TYPE-REFORMATION     VALUE '3'.
  3167             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3168             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3169         16  CL-CRIT-PER-RECURRENT   PIC X.
  3170         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3171         16  CL-RTW-DT               PIC XX.
  3172                                                                  ELCMSTR
  3173     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3174         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3175             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3176             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3177             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3178         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3179         16  FILLER                  PIC XX.                      ELCMSTR
  3180         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3181         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3182             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3183                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3184             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3185                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3186             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3187                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3188             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3189                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3190             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3191                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3192             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3193                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3194             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3195                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3196                                                                  ELCMSTR
  3197     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3198         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3199         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3200                                                                  ELCMSTR
  3201     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3202                                                                  ELCMSTR
  3203     12  CL-PROCESS-ERRORS.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3204         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3205             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3206         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3207             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  3208                                                                  ELCMSTR
  3209     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3210                                                                  ELCMSTR
  3211     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3212         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3213         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3214         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3215         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3216                                                                  ELCMSTR
  3217     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3218         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3219         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3220         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3221         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3222                                                                  ELCMSTR
  3223     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3224     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3225     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3226                                                                  ELCMSTR
  3227     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3228     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3229     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3230     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3231                                                                  ELCMSTR
  3232     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3233     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3234         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3235         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3236         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3237     12  cl-insured-claim            pic x.
  3238         88  cl-claim-on-primary         value 'P'.
  3239         88  cl-claim-on-secondary       value 'S'.
  3240     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  60
* EL517.cbl
  3242 FD  ERCTBL.
* 3243                                 COPY ERCCTBL.
  3244******************************************************************04/29/98
  3245*                                                                *ERCCTBL
  3246*                                                                *ERCCTBL
  3247*                            ERCCTBL                             *   LV002
  3248*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3249*                            VMOD=2.003                              CL**2
  3250*                                                                *ERCCTBL
  3251*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3252*                                                                *ERCCTBL
  3253*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3254*                                                                *ERCCTBL
  3255*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3256*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3257*                                                                *ERCCTBL
  3258*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3259*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3260*                                                                *ERCCTBL
  3261*   LOG = NO                                                     *ERCCTBL
  3262*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3263*                                                                *ERCCTBL
  3264*                                                                *ERCCTBL
  3265******************************************************************ERCCTBL
  3266                                                                  ERCCTBL
  3267 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3268     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3269         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3270                                                                  ERCCTBL
  3271     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3272         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3273         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3274         16  CT-CNTRL-2.                                          ERCCTBL
  3275             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3276             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3277                                                                  ERCCTBL
  3278     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3279         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3280         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3281         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3282         16  FILLER                        PIC X(31).             ERCCTBL
  3283                                                                  ERCCTBL
  3284     12  CT-LIMITS.                                               ERCCTBL
  3285         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3286                                                                  ERCCTBL
  3287         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3288                                                                  ERCCTBL
  3289         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3290                                                                  ERCCTBL
  3291     12  CT-RATES.                                                ERCCTBL
  3292         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3293             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3294             20  CT-RT-R   REDEFINES                              ERCCTBL
  3295                 CT-RT                     PIC XXX.               ERCCTBL
  3296                                                                  ERCCTBL
  3297     12  FILLER                            PIC  X(42).            ERCCTBL
  3298                                                                  ERCCTBL
  3299******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  61
* EL517.cbl
  3300
  3301 FD  ERACCT.
* 3302                                 COPY ERCACCT.
  3303******************************************************************04/19/98
  3304*                                                                *ERCACCT
  3305*                                                                *ERCACCT
  3306*                            ERCACCT                             *   LV031
  3307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3308*                            VMOD=2.031                          *ERCACCT
  3309*                                                                *ERCACCT
  3310*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3311*                                                                *ERCACCT
  3312*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3313*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3314*                                                                *ERCACCT
  3315*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3316*                                                                *ERCACCT
  3317*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3318*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3319*                                                                *ERCACCT
  3320*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3321*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3322*                                                                *ERCACCT
  3323*   LOG = NO                                                     *ERCACCT
  3324*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3325*                                                                *ERCACCT
  3326*                                                                *ERCACCT
  3327******************************************************************ERCACCT
  3328*                   C H A N G E   L O G
  3329*
  3330* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3331*-----------------------------------------------------------------
  3332*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3333* EFFECTIVE    NUMBER
  3334*-----------------------------------------------------------------
  3335* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3336* 092705    2005050300006  PEMA  ADD SPP LEASES
  3337* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3338* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3339* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3340* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3341* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3342******************************************************************
  3343                                                                  ERCACCT
  3344 01  ACCOUNT-MASTER.                                              ERCACCT
  3345     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3346         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3347                                                                  ERCACCT
  3348     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3349         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3350         16  AM-MSTR-CNTRL.                                       ERCACCT
  3351             20  AM-CONTROL-A.                                    ERCACCT
  3352                 24  AM-CARRIER            PIC X.                 ERCACCT
  3353                 24  AM-GROUPING.                                 ERCACCT
  3354                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3355                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3356                 24  AM-STATE              PIC XX.                ERCACCT
  3357                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3358                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3359                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3360             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3361                                           PIC X(19).             ERCACCT
  3362             20  AM-CNTRL-B.                                      ERCACCT
  3363                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3364                 24  FILLER                PIC X(4).              ERCACCT
  3365             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3366                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3367                                                                  ERCACCT
  3368     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3369         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3370         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3371         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3372         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3373         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3374         16  AM-VG-DATE.                                          ERCACCT
  3375             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3376             20  FILLER                    PIC X(4).              ERCACCT
  3377         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3378                                           PIC 9(11)      COMP-3. ERCACCT
  3379     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3380         16  FILLER                        PIC X(10).
  3381         16  AM-VG-KEY3.
  3382             20  AM-VG3-ACCOUNT            PIC X(10).
  3383             20  AM-VG3-EXP-DT             PIC XX.
  3384         16  FILLER                        PIC X(4).
  3385     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3386         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3387         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3388         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3389         16  FILLER                        PIC XX.                ERCACCT
  3390                                                                  ERCACCT
  3391     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3392     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3393                                                                  ERCACCT
  3394     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3395         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3396         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3397                                                                  ERCACCT
  3398     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3399     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3400                                                                  ERCACCT
  3401     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3402     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3403                                                                  ERCACCT
  3404     12  AM-NAME                           PIC X(30).             ERCACCT
  3405     12  AM-PERSON                         PIC X(30).             ERCACCT
  3406     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3407     12  AM-CITY.
  3408         16  AM-ADDR-CITY                  PIC X(28).
  3409         16  AM-ADDR-STATE                 PIC XX.
  3410     12  AM-ZIP.                                                  ERCACCT
  3411         16  AM-ZIP-PRIME.                                        ERCACCT
  3412             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3413                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3414             20  FILLER                    PIC X(4).              ERCACCT
  3415         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3416     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3417         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3418         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3419         16  FILLER                        PIC XXX.               ERCACCT
  3420     12  AM-TEL-NO.                                               ERCACCT
  3421         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3422         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3423         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3424     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3425         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3426         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3427                                                                  ERCACCT
  3428     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3429         16  AM-DEFN-1.                                           ERCACCT
  3430             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3431                 24  AM-AGT.                                      ERCACCT
  3432                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3433                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3434                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3435                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3436                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3437                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3438                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3439                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3440                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3441                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3442                 24  FILLER                PIC X(01).             ERCACCT
  3443         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3444             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3445                 24  FILLER                PIC X(11).             ERCACCT
  3446                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3447                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3448                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3449                 24  FILLER                PIC X(6).              ERCACCT
  3450                                                                  ERCACCT
  3451     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3452         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3453                                                                  ERCACCT
  3454     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3455                                                                  ERCACCT
  3456     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3457         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3458         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3459     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3460         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3461         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3462     12  AM-GPCD                           PIC 99.                ERCACCT
  3463     12  AM-IG                             PIC X.                 ERCACCT
  3464         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3465         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3466     12  AM-STATUS                         PIC X.                 ERCACCT
  3467         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3468         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3469         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3470         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3471         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3472         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3473     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3474     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3475                                                                  ERCACCT
  3476     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3477     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3478     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3479     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3480     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3481     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3482     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3483     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3484     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3485                                                                  ERCACCT
  3486     12  AM-USER-FIELDS.                                          ERCACCT
  3487         16  AM-FLD-1                      PIC XX.                ERCACCT
  3488         16  AM-FLD-2                      PIC XX.                ERCACCT
  3489         16  AM-FLD-3                      PIC XX.                ERCACCT
  3490         16  AM-FLD-4                      PIC XX.                ERCACCT
  3491         16  AM-FLD-5                      PIC XX.                ERCACCT
  3492                                                                  ERCACCT
  3493     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3494         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3495         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3496         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3497     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3498     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3499         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3500         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3501         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3502     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3503     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3504     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3505     12  AM-INACTIVE-DATE.                                        ERCACCT
  3506         16  AM-INA-MO                     PIC 99.                ERCACCT
  3507         16  AM-INA-DA                     PIC 99.                ERCACCT
  3508         16  AM-INA-YR                     PIC 99.                ERCACCT
  3509     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3510                                                                  ERCACCT
  3511     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3512     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3513                                                                  ERCACCT
  3514     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3515         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3516         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3517         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3518         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3519                                                                  ERCACCT
  3520     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3521         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3522         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3523                                                                  ERCACCT
  3524     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3525                                                                  ERCACCT
  3526     12  AM-OVER-SHORT.                                           ERCACCT
  3527         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3528         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3529                                                                  ERCACCT
  3530     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3531     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3532                                                                  ERCACCT
  3533     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3534     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3535                                                                  ERCACCT
  3536     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3537     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3538     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3539     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3540     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3541     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3542     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3543     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3544     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3545     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3546     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3547     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3548     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3549     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3550     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3551     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3552                                                                  ERCACCT
  3553     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3554                                                                  ERCACCT
  3555     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3556     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3557                                                                  ERCACCT
  3558     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3559     12  AM-EARN-METHODS.                                         ERCACCT
  3560         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3561             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3562             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3563             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3564             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3565         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3566             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3567             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3568             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3569             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3570         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3571             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3572             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3573             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3574             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3575             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3576             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3577                                                                  ERCACCT
  3578     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3579     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3580     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3581                                                                  ERCACCT
  3582     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3583     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3584     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3585     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3586     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3587     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3588         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3589         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3590     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3591         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3592         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3593         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3594     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3595         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3596         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3597     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3598         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3599         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3600         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3601     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3602     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3603                                                                  ERCACCT
  3604     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3605         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3606         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3607         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3608         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3609         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3610                                                                  ERCACCT
  3611     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3612                                                                  ERCACCT
  3613     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3614                                                                  ERCACCT
  3615     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3616         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3617                                                                  ERCACCT
  3618     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3619         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3620         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3621                                                                  ERCACCT
  3622     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3623         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3624                                                                  ERCACCT
  3625     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3626         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3627         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3628                                                                  ERCACCT
  3629     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3630                                                                  ERCACCT
  3631     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3632     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3633     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3634     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3635     12  AM-DCC-UEF-STATE                  PIC XX.
  3636     12  FILLER                            PIC XXX.
  3637     12  AM-REPORT-CODE-3                  PIC X(10).
  3638*    12  FILLER                            PIC X(22).             ERCACCT
  3639                                                                  ERCACCT
  3640     12  AM-RESERVE-DATE.                                         ERCACCT
  3641         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3642         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3643         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3644                                                                  ERCACCT
  3645     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3646     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3647         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3648         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3649         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3650         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3651                                                                  ERCACCT
  3652     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3653         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3654         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3655         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3656         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3657                                                                  ERCACCT
  3658     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3659         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3660             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3661             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3662             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3663             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3664             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3665             20  FILLER                    PIC XX.                ERCACCT
  3666         16  FILLER                        PIC X(80).             ERCACCT
  3667                                                                  ERCACCT
  3668     12  AM-TRANSFER-DATA.                                        ERCACCT
  3669         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3670             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3671             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3672                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3673                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3674             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3675             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3676                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3677                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3678             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3679         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3680             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3681             20  AM-TRNTO-GROUPING.                               ERCACCT
  3682                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3683                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3684             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3685             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3686                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3687                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3688             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3689         16  FILLER                        PIC X(10).             ERCACCT
  3690                                                                  ERCACCT
  3691     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3692                                                                  ERCACCT
  3693     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3694         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3695             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3696                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3697                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3698                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3699                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3700                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3701                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3702                 24  FILLER                PIC X.                 ERCACCT
  3703                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3704                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3705                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3706         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3707             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3708                 24  FILLER                PIC X(11).             ERCACCT
  3709                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3710                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3711                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3712                 24  FILLER                PIC X(6).              ERCACCT
  3713                                                                  ERCACCT
  3714     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3715         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3716            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3717            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3718            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3719                                                                  ERCACCT
  3720     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3721     12  FILLER                            PIC X(120).            ERCACCT
  3722                                                                  ERCACCT
  3723     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3724         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3725         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3726             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3727             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3728                                                          COMP-3. ERCACCT
  3729             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3730                                                          COMP-3. ERCACCT
  3731         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3732             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3733             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3734                                                          COMP-3. ERCACCT
  3735             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3736                                                          COMP-3. ERCACCT
  3737                                                                  ERCACCT
  3738     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3739         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3740         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3741         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3742         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3743             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3744                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3745                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3746             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3747                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3748                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3749             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3750                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3751                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3752         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3753             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3754                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3755                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3756                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3757             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3758                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3759                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3760             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3761                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3762                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3763                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3764     12  AM-COMMENTS.                                             ERCACCT
  3765         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3766                                                                  ERCACCT
  3767     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3768         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3769         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3770         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3771         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3772         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3773             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3774             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3775             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3776             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3777         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3778             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3779             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3780             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3781         16  FILLER                        PIC X(102).            ERCACCT
  3782                                                                  ERCACCT
  3783     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3784         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3785             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3786             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3787             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3788             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3789             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3790         16  FILLER                          PIC X(10).           ERCACCT
  3791******************************************************************ERCACCT
  3792
  3793 FD  ELCERR.
* 3794                                 COPY ELCERRS.
  3795******************************************************************04/15/98
  3796*                                                                *ELCERRS
  3797*                                                                *ELCERRS
  3798*                            ELCERRS.                            *   LV002
  3799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3800*                            VMOD 2.002                          *   CL**2
  3801*                                                                *ELCERRS
  3802*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3803*                                                                *ELCERRS
  3804*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3805*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3806*                                                                *ELCERRS
  3807*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3808*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3809*                                                                *ELCERRS
  3810*   LOG = NO                                                     *ELCERRS
  3811*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3812******************************************************************ELCERRS
  3813 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3814     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3815         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3816                                                                  ELCERRS
  3817     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3818         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3819                                                                  ELCERRS
  3820     12  EM-ERROR-TEXT.                                           ELCERRS
  3821         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3822         16  FILLER                  PIC X(59).                   ELCERRS
  3823                                                                  ELCERRS
  3824     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3825         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3826         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3827         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3828         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3829                                                                  ELCERRS
  3830******************************************************************ELCERRS
  3831
  3832 FD  ERPNDM.
* 3833                                 COPY ERCPNDM.
  3834******************************************************************
  3835*                                                                *
  3836*                                                                *
  3837*                            ERCPNDM                             *
  3838*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3839*                            VMOD=2.003                          *
  3840*                                                                *
  3841*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3842*                                                                *
  3843*   FILE TYPE = VSAM,KSDS                                        *
  3844*   RECORD SIZE = 374   RECFORM = FIX                            *
  3845*                                                                *
  3846*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3847*   ALTERNATE PATH    = NOT USED                                 *
  3848*                                                                *
  3849*   LOG = YES                                                    *
  3850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3851******************************************************************
  3852*                   C H A N G E   L O G
  3853*
  3854* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3855*-----------------------------------------------------------------
  3856*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3857* EFFECTIVE    NUMBER
  3858*-----------------------------------------------------------------
  3859* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3860* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3861* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3862******************************************************************
  3863
  3864 01  PENDING-MAILING-DATA.
  3865     12  PM-RECORD-ID                      PIC XX.
  3866         88  VALID-MA-ID                       VALUE 'PM'.
  3867
  3868     12  PM-CONTROL-PRIMARY.
  3869         16  PM-COMPANY-CD                 PIC X.
  3870         16  PM-ENTRY-BATCH                PIC X(6).
  3871         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3872         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3873
  3874     12  FILLER                            PIC X(14).
  3875
  3876     12  PM-ACCESS-CONTROL.
  3877         16  PM-SOURCE-SYSTEM              PIC XX.
  3878             88  PM-FROM-CREDIT                VALUE 'CR'.
  3879             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3880             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3881             88  PM-FROM-OTHER                 VALUE 'OT'.
  3882         16  PM-RECORD-ADD-DT              PIC XX.
  3883         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3884         16  PM-LAST-MAINT-DT              PIC XX.
  3885         16  PM-LAST-MAINT-BY              PIC XXXX.
  3886         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3887
  3888     12  PM-PROFILE-INFO.
  3889         16  PM-QUALIFY-CODE-1             PIC XX.
  3890         16  PM-QUALIFY-CODE-2             PIC XX.
  3891         16  PM-QUALIFY-CODE-3             PIC XX.
  3892         16  PM-QUALIFY-CODE-4             PIC XX.
  3893         16  PM-QUALIFY-CODE-5             PIC XX.
  3894
  3895         16  PM-INSURED-LAST-NAME          PIC X(15).
  3896         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3897         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3898         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3899         16  PM-INSURED-BIRTH-DT           PIC XX.
  3900         16  PM-INSURED-SEX                PIC X.
  3901             88  PM-SEX-MALE                   VALUE 'M'.
  3902             88  PM-SEX-FEMALE                 VALUE 'F'.
  3903         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3904
  3905         16  PM-ADDRESS-CORRECTED          PIC X.
  3906         16  PM-JOINT-BIRTH-DT             PIC XX.
  3907*        16  FILLER                        PIC X(12).
  3908
  3909         16  PM-ADDRESS-LINE-1             PIC X(30).
  3910         16  PM-ADDRESS-LINE-2             PIC X(30).
  3911         16  PM-CITY-STATE.
  3912             20  PM-CITY                   PIC X(28).
  3913             20  PM-STATE                  PIC XX.
  3914         16  PM-ZIP.
  3915             20  PM-ZIP-CODE.
  3916                 24  PM-ZIP-1              PIC X.
  3917                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3918                 24  FILLER                PIC X(4).
  3919             20  PM-ZIP-PLUS4              PIC X(4).
  3920         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3921             20  PM-CAN-POST1              PIC XXX.
  3922             20  PM-CAN-POST2              PIC XXX.
  3923             20  FILLER                    PIC XXX.
  3924
  3925         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3926
  3927         16  FILLER                        PIC X(03).
  3928
  3929     12  PM-CRED-BENE-INFO.
  3930         16  PM-CRED-BENE-NAME             PIC X(25).
  3931         16  PM-CRED-BENE-ADDR             PIC X(30).
  3932         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3933         16  PM-CRED-BENE-CTYST.
  3934             20  PM-CRED-BENE-CITY         PIC X(28).
  3935             20  PM-CRED-BENE-STATE        PIC XX.
  3936         16  PM-CRED-BENE-ZIP.
  3937             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3938                 24  PM-CB-ZIP-1           PIC X.
  3939                     88  PM-CB-CANADIAN-POST-CODE
  3940                                  VALUE 'A' THRU 'Z'.
  3941                 24  FILLER                PIC X(4).
  3942             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3943         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3944             20  PM-CB-CAN-POST1           PIC XXX.
  3945             20  PM-CB-CAN-POST2           PIC XXX.
  3946             20  FILLER                    PIC XXX.
  3947     12  PM-POST-CARD-MAIL-DATA.
  3948         16  PM-MAIL-DATA OCCURS 7.
  3949             20  PM-MAIL-TYPE              PIC X.
  3950                 88  PM-12MO-MAILING           VALUE '1'.
  3951                 88  PM-EXP-MAILING            VALUE '2'.
  3952             20  PM-MAIL-STATUS            PIC X.
  3953                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3954                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3955                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3956             20  PM-MAIL-DATE              PIC XX.
  3957     12  FILLER                            PIC XX.
  3958     12  FILLER                            PIC X(12).
  3959*    12  FILLER                            PIC X(30).
  3960
  3961******************************************************************
  3962
  3963 FD  ERMAIL.
* 3964                                 COPY ERCMAIL.
  3965******************************************************************
  3966*                                                                *
  3967*                                                                *
  3968*                            ERCMAIL                             *
  3969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3970*                            VMOD=2.003                          *
  3971*                                                                *
  3972*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3973*                                                                *
  3974*   FILE TYPE = VSAM,KSDS                                        *
  3975*   RECORD SIZE = 374   RECFORM = FIX                            *
  3976*                                                                *
  3977*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3978*   ALTERNATE PATH    = NOT USED                                 *
  3979*                                                                *
  3980*   LOG = YES                                                    *
  3981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3982******************************************************************
  3983*                   C H A N G E   L O G
  3984*
  3985* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3986*-----------------------------------------------------------------
  3987*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3988* EFFECTIVE    NUMBER
  3989*-----------------------------------------------------------------
  3990* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3991* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3992* 111108                   PEMA  ADD CRED BENE ADDR2
  3993******************************************************************
  3994
  3995 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3996     12  MA-RECORD-ID                      PIC XX.
  3997         88  VALID-MA-ID                       VALUE 'MA'.
  3998
  3999     12  MA-CONTROL-PRIMARY.
  4000         16  MA-COMPANY-CD                 PIC X.
  4001         16  MA-CARRIER                    PIC X.
  4002         16  MA-GROUPING.
  4003             20  MA-GROUPING-PREFIX        PIC XXX.
  4004             20  MA-GROUPING-PRIME         PIC XXX.
  4005         16  MA-STATE                      PIC XX.
  4006         16  MA-ACCOUNT.
  4007             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4008             20  MA-ACCOUNT-PRIME          PIC X(6).
  4009         16  MA-CERT-EFF-DT                PIC XX.
  4010         16  MA-CERT-NO.
  4011             20  MA-CERT-PRIME             PIC X(10).
  4012             20  MA-CERT-SFX               PIC X.
  4013
  4014     12  FILLER                            PIC XX.
  4015
  4016     12  MA-ACCESS-CONTROL.
  4017         16  MA-SOURCE-SYSTEM              PIC XX.
  4018             88  MA-FROM-CREDIT                VALUE 'CR'.
  4019             88  MA-FROM-VSI                   VALUE 'VS'.
  4020             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4021             88  MA-FROM-OTHER                 VALUE 'OT'.
  4022         16  MA-RECORD-ADD-DT              PIC XX.
  4023         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4024         16  MA-LAST-MAINT-DT              PIC XX.
  4025         16  MA-LAST-MAINT-BY              PIC XXXX.
  4026         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4027
  4028     12  MA-PROFILE-INFO.
  4029         16  MA-QUALIFY-CODE-1             PIC XX.
  4030         16  MA-QUALIFY-CODE-2             PIC XX.
  4031         16  MA-QUALIFY-CODE-3             PIC XX.
  4032         16  MA-QUALIFY-CODE-4             PIC XX.
  4033         16  MA-QUALIFY-CODE-5             PIC XX.
  4034
  4035         16  MA-INSURED-LAST-NAME          PIC X(15).
  4036         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4037         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4038         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4039         16  MA-INSURED-BIRTH-DT           PIC XX.
  4040         16  MA-INSURED-SEX                PIC X.
  4041             88  MA-SEX-MALE                   VALUE 'M'.
  4042             88  MA-SEX-FEMALE                 VALUE 'F'.
  4043         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4044
  4045         16  MA-ADDRESS-CORRECTED          PIC X.
  4046         16  MA-JOINT-BIRTH-DT             PIC XX.
  4047*        16  FILLER                        PIC X(12).
  4048
  4049         16  MA-ADDRESS-LINE-1             PIC X(30).
  4050         16  MA-ADDRESS-LINE-2             PIC X(30).
  4051         16  MA-CITY-STATE.
  4052             20  MA-CITY                   PIC X(28).
  4053             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4054         16  MA-ZIP.
  4055             20  MA-ZIP-CODE.
  4056                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4057                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4058                 24  FILLER                PIC X(4).
  4059             20  MA-ZIP-PLUS4              PIC X(4).
  4060         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4061             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4062             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4063             20  FILLER                    PIC X(3).
  4064
  4065         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4066
  4067         16  FILLER                        PIC XXX.
  4068*        16  FILLER                        PIC X(10).
  4069
  4070
  4071     12  MA-CRED-BENE-INFO.
  4072         16  MA-CRED-BENE-NAME                 PIC X(25).
  4073         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4074         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4075         16  MA-CRED-BENE-CTYST.
  4076             20  MA-CRED-BENE-CITY             PIC X(28).
  4077             20  MA-CRED-BENE-STATE            PIC XX.
  4078         16  MA-CRED-BENE-ZIP.
  4079             20  MA-CB-ZIP-CODE.
  4080                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4081                     88  MA-CB-CANADIAN-POST-CODE
  4082                                           VALUE 'A' THRU 'Z'.
  4083                 24  FILLER                    PIC X(4).
  4084             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4085         16  MA-CB-CANADIAN-POSTAL-CODE
  4086                            REDEFINES MA-CRED-BENE-ZIP.
  4087             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4088             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4089             20  FILLER                        PIC X(3).
  4090     12  MA-POST-CARD-MAIL-DATA.
  4091         16  MA-MAIL-DATA OCCURS 7.
  4092             20  MA-MAIL-TYPE              PIC X.
  4093                 88  MA-12MO-MAILING           VALUE '1'.
  4094                 88  MA-EXP-MAILING            VALUE '2'.
  4095             20  MA-MAIL-STATUS            PIC X.
  4096                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4097                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4098                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4099             20  MA-MAIL-DATE              PIC XX.
  4100     12  FILLER                            PIC XX.
  4101     12  FILLER                            PIC XX.
  4102*    12  FILLER                            PIC X(30).
  4103******************************************************************
  4104
  4105 FD  ERPLAN.
* 4106                                 COPY ERCPLAN.
  4107******************************************************************04/29/98
  4108*                                                                *ERCPLAN
  4109*                                                                *ERCPLAN
  4110*                            ERCPLAN                             *   LV003
  4111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4112*                            VMOD=2.003                          *   CL**2
  4113*                                                                *ERCPLAN
  4114*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4115*                                                                *ERCPLAN
  4116*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4117*   PLAN MASTER                                                  *ERCPLAN
  4118*                                                                *ERCPLAN
  4119*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4120*                                                                *ERCPLAN
  4121*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4122*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4123*                                                                *ERCPLAN
  4124*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4125*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4126*                                                                *ERCPLAN
  4127*   LOG = NO                                                     *ERCPLAN
  4128*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4129*                                                                *ERCPLAN
  4130*                                                                *ERCPLAN
  4131******************************************************************ERCPLAN
  4132                                                                  ERCPLAN
  4133 01  PLAN-MASTER.                                                 ERCPLAN
  4134     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4135         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4136                                                                  ERCPLAN
  4137     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4138         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4139         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4140             20  PL-CONTROL-A.                                    ERCPLAN
  4141                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4142                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4143                 24  PL-STATE              PIC XX.                ERCPLAN
  4144                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4145             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4146             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4147             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4148                                                                  ERCPLAN
  4149     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4150         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4151         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4152         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4153         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4154         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4155         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4156         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4157         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4158                                                                  ERCPLAN
  4159     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4160         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4161         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4162         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4163         16  FILLER                        PIC XX.                ERCPLAN
  4164                                                                  ERCPLAN
  4165     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4166         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4167         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4168             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4169             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4170             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4171             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4172                                                                  ERCPLAN
  4173     12  FILLER                            PIC X(30).             ERCPLAN
  4174                                                                  ERCPLAN
  4175     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4176         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4177         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4178         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4179     12  FILLER                            PIC X(24).             ERCPLAN
  4180     12  PL-TOLERANCES.                                           ERCPLAN
  4181         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4182         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4183         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4184         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4185         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4186         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4187     12  PL-OVER-SHORT.                                           ERCPLAN
  4188         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4189         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4190     12  FILLER                            PIC X(24).             ERCPLAN
  4191     12  PLAN-MISC.                                               ERCPLAN
  4192         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4193         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4194         16  PL-IG                         PIC X.                 ERCPLAN
  4195         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4196         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4197         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4198         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4199         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4200         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4201         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4202         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4203                                                                  ERCPLAN
  4204         16  FILLER                        PIC X(99).             ERCPLAN
  4205******************************************************************ERCPLAN
  4206 FD  ERFORM.
* 4207                                 COPY ERCFORM.
  4208******************************************************************04/29/98
  4209*                                                                *ERCFORM
  4210*                                                                *ERCFORM
  4211*                            ERCFORM.                            *   LV002
  4212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4213*                            VMOD=2.003                          *   CL**2
  4214*                                                                *ERCFORM
  4215*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4216*                                                                *ERCFORM
  4217*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4218*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4219*                                                                *ERCFORM
  4220*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4221*                                                                *ERCFORM
  4222*    LOG = YES                                                   *ERCFORM
  4223*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4224******************************************************************ERCFORM
  4225 01  FORM-MASTER.                                                 ERCFORM
  4226    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4227        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4228                                                                  ERCFORM
  4229    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4230        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4231        16  FO-STATE                 PIC X(02).                   ERCFORM
  4232        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4233        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4234                                                                  ERCFORM
  4235    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4236        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4237        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4238        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4239        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4240        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4241        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4242        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4243        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4244        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4245        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4246        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4247        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4248        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4249        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4250        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4251        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4252                                                                  ERCFORM
  4253    12  FILLER                       PIC X(29).                   ERCFORM
  4254                                                                  ERCFORM
  4255    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4256        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4257            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4258            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4259            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4260            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4261                                     PIC X.                       ERCFORM
  4262                                                                  ERCFORM
  4263    12  FILLER                       PIC X(30).                   ERCFORM
  4264                                                                  ERCFORM
  4265    12  FO-COMMENTS-AREA.                                         ERCFORM
  4266        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4267                                                                  ERCFORM
  4268    12  FILLER                       PIC X(20).                   ERCFORM
  4269                                                                  ERCFORM
  4270    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4271        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4272        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4273        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4274
  4275 FD  PRINT-FILE
* 4276                                 COPY ELCPRTFD.
  4277******************************************************************04/15/98
  4278*                                                                *ELCPRTFD
  4279*                                                                *ELCPRTFD
  4280*                            ELCPRTFD.                           *   LV003
  4281*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4282*                            VMOD=2.006                          *ELCPRTFD
  4283******************************************************************ELCPRTFD
  4284     RECORDING MODE F                                             ELCPRTFD
  4285     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4286     BLOCK CONTAINS 0 RECORDS
  4287     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4288 01  PRT.                                                         ELCPRTFD
  4289     12  P-CTL               PIC  X.                                 CL**2
  4290     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4291******************************************************************ELCPRTFD
  4292 FD  FICH
* 4293                                 COPY ELCFCHFD.
  4294******************************************************************04/15/98
  4295*                                                                *ELCFCHFD
  4296*                            ELCFCHFD.                           *   LV003
  4297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4298*                            VMOD=2.004                          *   CL**3
  4299*                                                                *ELCFCHFD
  4300******************************************************************ELCFCHFD
  4301     BLOCK CONTAINS 0 RECORDS
  4302     RECORDING MODE F.                                            ELCFCHFD
  4303                                                                  ELCFCHFD
  4304 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4305******************************************************************ELCFCHFD
  4306
  4307 FD  ELREPT.
* 4308                                 COPY ELCREPT.
  4309******************************************************************04/15/98
  4310*                                                                *ELCREPT
  4311*                                                                *ELCREPT
  4312*                            ELCREPT.                            *   LV002
  4313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4314*                            VMOD=2.002                          *   CL**2
  4315*                                                                *ELCREPT
  4316*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4317*                                                                *ELCREPT
  4318*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4319*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4320*                                                                *ELCREPT
  4321*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4322*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4323*                                                                *ELCREPT
  4324*   LOG = NO                                                     *ELCREPT
  4325*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4326******************************************************************ELCREPT
  4327 01  REPORT-SAVE-FILE.                                            ELCREPT
  4328     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4329         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4330                                                                  ELCREPT
  4331     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4332         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4333         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4334             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4335             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4336         16  RF-REPORT-ID.                                        ELCREPT
  4337             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4338                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4339                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4340             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4341         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4342     12  RF-REPORT-LINE-133.                                      ELCREPT
  4343         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4344         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4345         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4346             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4347             20  FILLER              PIC X(52).                   ELCREPT
  4348         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4349             20  FILLER              PIC X(53).                   ELCREPT
  4350             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4351     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4352         16  FILLER                  PIC X.                       ELCREPT
  4353         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4354         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4355         16  FILLER                  PIC X(115).                  ELCREPT
  4356         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4357******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  80
* EL517.cbl
  4359
  4360 FD  ERRESS.
* 4361                                 COPY ERCRESS.
  4362******************************************************************04/29/98
  4363*                                                                *ERCRESS
  4364*                            ERCRESS                             *   LV002
  4365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4366*                            VMOD=2.002                          *   CL**2
  4367*                                                                *ERCRESS
  4368*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4369*                                                                *ERCRESS
  4370*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4371*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4372*                                                                *ERCRESS
  4373*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4374*                                                                *ERCRESS
  4375*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4376*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4377*                                                                *ERCRESS
  4378*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4379*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4380*                                                                *ERCRESS
  4381*   LOG = NO                                                     *ERCRESS
  4382*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4383*                                                                *ERCRESS
  4384*                                                                *ERCRESS
  4385******************************************************************ERCRESS
  4386                                                                  ERCRESS
  4387 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4388                                                                  ERCRESS
  4389     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4390         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4391         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4392         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4393         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4394*                                      YYYYMMDD                   ERCRESS
  4395*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4396                                                                  ERCRESS
  4397     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4398                                                                  ERCRESS
  4399         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4400         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4401         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4402         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4403                                                                  ERCRESS
  4404     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4405         88 RECALC                VALUE 'Y'.                      ERCRESS
  4406         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4407     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4408     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4409     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4410*                                      YYYYMMDD                   ERCRESS
  4411
  4412 FD  ERRESC.
* 4413                                 COPY ERCRESC.
  4414******************************************************************04/29/98
  4415*                                                                *ERCRESC
  4416*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4418*                            VMOD=2.003                          *   CL**2
  4419*                                                                *ERCRESC
  4420*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4421*                                                                *ERCRESC
  4422*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4423*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4424*                                                                *ERCRESC
  4425*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4426*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4427*                                                                *ERCRESC
  4428*   LOG = NO                                                     *ERCRESC
  4429*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4430*                                                                *ERCRESC
  4431******************************************************************ERCRESC
  4432                                                                  ERCRESC
  4433 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4434                                                                  ERCRESC
  4435     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4436         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4437         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4438         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4439         15  RESC-STATE                PIC   XX.                  ERCRESC
  4440         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4441         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4442         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4443         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4444*                                           YYYYMMDD              ERCRESC
  4445     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4446                                                                  ERCRESC
  4447     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4448         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4449             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4450             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4451             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4452                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4453                                                                  ERCRESC
  4454     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4455     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4456     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4457*                                          YYYYMMDD               ERCRESC
  4458
  4459 FD  ERCOMP.
* 4460                                 COPY ERCCOMP.
  4461******************************************************************
  4462*                                                                *
  4463*                                                                *
  4464*                            ERCCOMP                             *
  4465*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4466*                            VMOD=2.019                          *
  4467*                                                                *
  4468*   ONLINE CREDIT SYSTEM                                         *
  4469*                                                                *
  4470*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4471*                                                                *
  4472*   FILE TYPE = VSAM,KSDS                                        *
  4473*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4474*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4475*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4476*       ALTERNATE PATH = NONE                                    *
  4477*                                                                *
  4478*   LOG = NO                                                     *
  4479*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4480*                                                                *
  4481******************************************************************
  4482*                   C H A N G E   L O G
  4483*
  4484* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4485*-----------------------------------------------------------------
  4486*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4487* EFFECTIVE    NUMBER
  4488*-----------------------------------------------------------------
  4489* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4490* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4491* 092205    2005050300006  PEMA  ADD LEASE FEE
  4492* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4493* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4494* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4495* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4496* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4497* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4498******************************************************************
  4499
  4500 01  COMPENSATION-MASTER.
  4501     12  CO-RECORD-ID                          PIC XX.
  4502         88  VALID-CO-ID                          VALUE 'CO'.
  4503
  4504     12  CO-CONTROL-PRIMARY.
  4505         16  CO-COMPANY-CD                     PIC X.
  4506         16  CO-CONTROL.
  4507             20  CO-CTL-1.
  4508                 24  CO-CARR-GROUP.
  4509                     28  CO-CARRIER            PIC X.
  4510                     28  CO-GROUPING.
  4511                         32  CO-GROUP-PREFIX   PIC XXX.
  4512                         32  CO-GROUP-PRIME    PIC XXX.
  4513                 24  CO-RESP-NO.
  4514                     28  CO-RESP-PREFIX        PIC X(4).
  4515                     28  CO-RESP-PRIME         PIC X(6).
  4516             20  CO-CTL-2.
  4517                 24  CO-ACCOUNT.
  4518                     28  CO-ACCT-PREFIX        PIC X(4).
  4519                     28  CO-ACCT-PRIME         PIC X(6).
  4520         16  CO-TYPE                           PIC X.
  4521             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4522             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4523             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4524
  4525     12  CO-MAINT-INFORMATION.
  4526         16  CO-LAST-MAINT-DT                  PIC XX.
  4527         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4528         16  CO-LAST-MAINT-USER                PIC X(4).
  4529     12  FILLER                                PIC XX.
  4530     12  CO-STMT-TYPE                          PIC XXX.
  4531     12  CO-COMP-TYPE                          PIC X.
  4532         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4533     12  CO-STMT-OWNER                         PIC X(4).
  4534     12  CO-BALANCE-CONTROL                    PIC X.
  4535         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4536         88  CO-NO-BALANCE                        VALUE 'N'.
  4537
  4538     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4539         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4540         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4541         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4542
  4543     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4544         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4545         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4546
  4547     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4548     12  CO-GA-DIRECT-DEP                      PIC X.
  4549     12  CO-FUTURE-SPACE                       PIC X.
  4550         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4551
  4552     12  CO-ACCT-NAME                          PIC X(30).
  4553     12  CO-MAIL-NAME                          PIC X(30).
  4554     12  CO-ADDR-1                             PIC X(30).
  4555     12  CO-ADDR-2                             PIC X(30).
  4556     12  CO-ADDR-3.
  4557         16  CO-ADDR-CITY                      PIC X(27).
  4558         16  CO-ADDR-STATE                     PIC XX.
  4559     12  CO-CSO-1099                           PIC X.
  4560     12  CO-ZIP.
  4561         16  CO-ZIP-PRIME.
  4562             20  CO-ZIP-PRI-1ST                PIC X.
  4563                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4564             20  FILLER                        PIC X(4).
  4565         16  CO-ZIP-PLUS4                      PIC X(4).
  4566     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4567         16  CO-CAN-POSTAL-1                   PIC XXX.
  4568         16  CO-CAN-POSTAL-2                   PIC XXX.
  4569         16  FILLER                            PIC XXX.
  4570     12  CO-SOC-SEC                            PIC X(13).
  4571     12  CO-TELEPHONE.
  4572         16  CO-AREA-CODE                      PIC XXX.
  4573         16  CO-PREFIX                         PIC XXX.
  4574         16  CO-PHONE                          PIC X(4).
  4575
  4576     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4577
  4578     12  CO-AR-BAL-LEVEL                       PIC X.
  4579         88  CO-AR-REF-LVL                        VALUE '1'.
  4580         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4581         88  CO-AR-BILL-LVL                       VALUE '2'.
  4582         88  CO-AR-AGT-LVL                        VALUE '3'.
  4583         88  CO-AR-FR-LVL                         VALUE '4'.
  4584
  4585     12  CO-AR-NORMAL-PRINT                    PIC X.
  4586         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4587         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4588
  4589     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4590
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4591     12  CO-AR-REPORTING                       PIC X.
  4592         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4593         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4594
  4595     12  CO-AR-PULL-CHECK                      PIC X.
  4596         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4597         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4598
  4599     12  CO-AR-BALANCE-PRINT                   PIC X.
  4600         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4601
  4602     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4603         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4604         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4605         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4606
  4607     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4608
  4609     12  CO-USER-CODE                          PIC X.
  4610     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4611
  4612******************************************************************
  4613*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4614*    THE LAST MONTH END RUN.
  4615******************************************************************
  4616
  4617     12  CO-LAST-ACTIVITY-DATE.
  4618         16  CO-ACT-YEAR                       PIC 99.
  4619         16  CO-ACT-MONTH                      PIC 99.
  4620         16  CO-ACT-DAY                        PIC 99.
  4621
  4622     12  CO-LAST-STMT-DT.
  4623         16  CO-LAST-STMT-YEAR                 PIC 99.
  4624         16  CO-LAST-STMT-MONTH                PIC 99.
  4625         16  CO-LAST-STMT-DAY                  PIC 99.
  4626
  4627     12  CO-MO-END-TOTALS.
  4628         16  CO-MONTHLY-TOTALS.
  4629             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4630             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4631             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4632             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4633             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4634
  4635         16  CO-AGING-TOTALS.
  4636             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4637             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4638             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4639             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4640
  4641         16  CO-YTD-TOTALS.
  4642             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4643             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4644
  4645         16  CO-OVER-UNDER-TOTALS.
  4646             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4647             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4648
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4649     12  CO-MISCELLANEOUS-TOTALS.
  4650         16  CO-FICA-TOTALS.
  4651             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4652             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4653
  4654         16  CO-CLAIM-TOTALS.
  4655             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4656             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4657
  4658******************************************************************
  4659*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4660*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4661******************************************************************
  4662
  4663     12  CO-CURRENT-TOTALS.
  4664         16  CO-CURRENT-LAST-STMT-DT.
  4665             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4666             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4667             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4668
  4669         16  CO-CURRENT-MONTHLY-TOTALS.
  4670             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4671             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4672             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4673             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4674             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4675
  4676         16  CO-CURRENT-AGING-TOTALS.
  4677             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4678             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4679             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4680             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4681
  4682         16  CO-CURRENT-YTD-TOTALS.
  4683             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4684             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4685
  4686     12  CO-PAID-COMM-TOTALS.
  4687         16  CO-YTD-PAID-COMMS.
  4688             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4689             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4690
  4691     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4692         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4693         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4694
  4695     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4696         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4697         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4698         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4699         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4700         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4701         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4702         88  CO-FINAL-LETTER                  VALUE 'F'.
  4703         88  CO-RECONCILING                   VALUE 'R'.
  4704         88  CO-PHONE-CALL                    VALUE 'P'.
  4705         88  CO-LEGAL                         VALUE 'L'.
  4706         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4707         88  CO-WRITE-OFF                     VALUE 'W'.
  4708         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4709
  4710     12  CO-CSR-CODE                       PIC X(4).
  4711
  4712     12  CO-GA-STATUS-INFO.
  4713         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4714         16  CO-GA-TERMINATION-DT          PIC XX.
  4715         16  CO-GA-STATUS-CODE             PIC X.
  4716             88  CO-GA-ACTIVE                 VALUE 'A'.
  4717             88  CO-GA-INACTIVE               VALUE 'I'.
  4718             88  CO-GA-PENDING                VALUE 'P'.
  4719         16  CO-GA-COMMENTS.
  4720             20  CO-GA-COMMENT-1           PIC X(40).
  4721             20  CO-GA-COMMENT-2           PIC X(40).
  4722             20  CO-GA-COMMENT-3           PIC X(40).
  4723             20  CO-GA-COMMENT-4           PIC X(40).
  4724
  4725     12  CO-RPTCD2                         PIC X(10).
  4726     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4727         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4728         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4729
  4730     12  CO-TYPE-AGENT                     PIC X(01).
  4731         88  CO-CORPORATION                   VALUE 'C'.
  4732         88  CO-PARTNERSHIP                   VALUE 'P'.
  4733         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4734         88  CO-TRUST                         VALUE 'T'.
  4735         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4736
  4737     12  CO-FAXNO.
  4738         16  CO-FAX-AREA-CODE                  PIC XXX.
  4739         16  CO-FAX-PREFIX                     PIC XXX.
  4740         16  CO-FAX-PHONE                      PIC X(4).
  4741
  4742     12  CO-BANK-INFORMATION.
  4743         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4744         16  CO-BANK-TRANSIT-NON REDEFINES
  4745             CO-BANK-TRANSIT-NO                PIC 9(8).
  4746
  4747         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4748     12  CO-MISC-DEDUCT-INFO REDEFINES
  4749                  CO-BANK-INFORMATION.
  4750         16  CO-MD-GL-ACCT                     PIC X(10).
  4751         16  CO-MD-DIV                         PIC XX.
  4752         16  CO-MD-CENTER                      PIC X(4).
  4753         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4754         16  CO-CREATE-AP-CHECK                PIC X.
  4755         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4756         16  FILLER                            PIC XXX.
  4757     12  CO-ACH-STATUS                         PIC X.
  4758         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4759         88  CO-ACH-PENDING                        VALUE 'P'.
  4760
  4761     12  CO-BILL-SW                            PIC X.
  4762     12  CO-CONTROL-NAME                       PIC X(30).
  4763     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4764     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4765     12  CO-CLP-STATE                          PIC XX.
  4766     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4767     12  CO-SPP-REFUND-EDIT                    PIC X.
  4768
  4769******************************************************************
  4770
  4771 FD  ERLOFC.
* 4772                                 COPY ERCLOFC.
  4773******************************************************************12/04/92
  4774*                                                                *ERCLOFC
  4775*                                                                *ERCLOFC
  4776*                            ERCLOFC                             *   LV002
  4777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4778*                            VMOD=2.003                          *   CL**2
  4779*                                                                *ERCLOFC
  4780*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4781*                                                                *ERCLOFC
  4782*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4783*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4784*                                                                *ERCLOFC
  4785*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4786*                                                                *ERCLOFC
  4787*   LOG = YES                                                    *ERCLOFC
  4788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4789*                                                                *ERCLOFC
  4790******************************************************************ERCLOFC
  4791                                                                  ERCLOFC
  4792 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4793     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4794         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4795                                                                  ERCLOFC
  4796     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4797         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4798         16  LO-CARRIER              PIC X.                       ERCLOFC
  4799         16  LO-GROUPING.                                         ERCLOFC
  4800             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4801             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4802         16  LO-STATE                PIC XX.                      ERCLOFC
  4803         16  LO-ACCOUNT.                                          ERCLOFC
  4804             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4805             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4806         16  LO-OFFICER-CODE         PIC X(5).
  4807                                                                  ERCLOFC
  4808     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4809                                                                  ERCLOFC
  4810     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4811     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4812     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4813                                                                  ERCLOFC
  4814     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4815             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4816             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4817     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4818             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4819             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4820                                                                  ERCLOFC
  4821     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4822     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4823     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4824                                                                  ERCLOFC
  4825     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4826     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4827                                                                  ERCLOFC
  4828     12  LO-OFFICER-INFO.                                         ERCLOFC
  4829         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4830             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4831             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4832             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4833             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4834             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4835             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4836             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4837             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4838     12  FILLER                      PIC X(198).
  4839******************************************************************ERCLOFC
  4840
  4841 FD  ERBXRF.
* 4842                                 COPY ERCBXRF.
  4843******************************************************************04/29/98
  4844*                                                                *ERCBXRF
  4845*                                                                *ERCBXRF
  4846*                            ERCBXRF                             *   LV002
  4847*                                                                *ERCBXRF
  4848*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4849*                                                                *ERCBXRF
  4850*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4851*                                                                *ERCBXRF
  4852*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4853*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4854*                                                                *ERCBXRF
  4855*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4856*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4857*                                                                *ERCBXRF
  4858*   LOG = NO                                                     *ERCBXRF
  4859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4860*                                                                *ERCBXRF
  4861******************************************************************ERCBXRF
  4862                                                                  ERCBXRF
  4863 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4864     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4865         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4866                                                                  ERCBXRF
  4867     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4868         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4869         16  BK-CARRIER              PIC X.                       ERCBXRF
  4870         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4871         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4872                                                                  ERCBXRF
  4873     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4874         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4875         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4876         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4877         16  FILLER                  PIC X(9).                    ERCBXRF
  4878                                                                  ERCBXRF
  4879     12  FILLER                      PIC X(37).                   ERCBXRF
  4880                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4881     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4882                                                                  ERCBXRF
  4883     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4884                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4885         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4886         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4887         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4888         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4889         16  FILLER                  PIC X(20).                   ERCBXRF
  4890                                                                  ERCBXRF
  4891******************************************************************ERCBXRF
  4892
  4893 FD  ERAGTC.
* 4894                                 COPY ERCAGTC.
  4895******************************************************************
  4896*                                                                *
  4897*                                                                *
  4898*                            ERCAGTC                             *
  4899*                            VMOD=2.001                          *
  4900*                                                                *
  4901*   ONLINE CREDIT SYSTEM                                         *
  4902*                                                                *
  4903*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4904*                                                                *
  4905*   FILE TYPE = VSAM,KSDS                                        *
  4906*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4907*                                                                *
  4908*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4909*       ALTERNATE PATH = NONE                                    *
  4910*                                                                *
  4911*   LOG = NO                                                     *
  4912*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4913*                                                                *
  4914******************************************************************
  4915*                   C H A N G E   L O G
  4916*
  4917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4918*-----------------------------------------------------------------
  4919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4920* EFFECTIVE    NUMBER
  4921*-----------------------------------------------------------------
  4922* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4923* 111004                         NEW FILE AND COPYBOOK
  4924* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4925******************************************************************
  4926
  4927 01  AGENT-COMMISSIONS.
  4928     12  AG-RECORD-ID                          PIC XX.
  4929         88  VALID-CO-ID                          VALUE 'AG'.
  4930
  4931     12  AG-CONTROL-PRIMARY.
  4932         16  AG-COMPANY-CD                     PIC X.
  4933         16  AG-CONTROL.
  4934             20  AG-CTL-1.
  4935                 24  AG-CARR-GROUP.
  4936                     28  AG-CARRIER            PIC X.
  4937                     28  AG-GROUPING           PIC X(6).
  4938                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4939             20  AG-CTL-2.
  4940                 24  AG-EXP-DT                 PIC XX.
  4941         16  AG-TYPE                           PIC X.
  4942             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4943             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4944
  4945     12  AG-MAINT-INFORMATION.
  4946         16  AG-LAST-MAINT-DT                  PIC XX.
  4947         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4948         16  AG-LAST-MAINT-USER                PIC X(4).
  4949         16  FILLER                            PIC X(10).
  4950
  4951     12  AG-EFF-DT                             PIC XX.
  4952     12  AG-COMM-STRUCTURE.
  4953         16  AG-AGT-COMMS OCCURS 10.
  4954             20  AG-AGT                PIC X(10).
  4955             20  AG-COM-TYP            PIC X.
  4956             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4957             20  AG-RECALC-LV-INDIC    PIC X.
  4958             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4959             20  AG-LRCALC-LV-INDIC    PIC X.
  4960             20  FILLER                PIC X(05).
  4961
  4962     12  FILLER                  PIC X(145).
  4963******************************************************************
  4964
  4965 FD  ELCRTT.
* 4966                                 COPY ELCCRTT.
  4967******************************************************************
  4968*                                                                *ELCCRTT
  4969*                            ELCCRTT.                            *
  4970*                                                                *ELCCRTT
  4971*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4972*                                                                *ELCCRTT
  4973*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4974*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4975*                                                                *ELCCRTT
  4976*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4977*                                                                *ELCCRTT
  4978*   LOG = YES                                                    *ELCCRTT
  4979*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4980******************************************************************
  4981*                   C H A N G E   L O G
  4982*
  4983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4984*-----------------------------------------------------------------
  4985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4986* EFFECTIVE    NUMBER
  4987*-----------------------------------------------------------------
  4988* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4989* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4990* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4991* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4992* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4993******************************************************************
  4994                                                                  ELCCRTT
  4995 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4996     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4997         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  4998                                                                  ELCCRTT
  4999     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  5000         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  5001         16  CS-CARRIER                    PIC X.                 ELCCRTT
  5002         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  5003         16  CS-STATE                      PIC XX.                ELCCRTT
  5004         16  CS-ACCOUNT                    PIC X(10).
  5005         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  5006         16  CS-CERT-NO.                                          ELCCRTT
  5007             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  5008             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  5009         16  CS-TRAILER-TYPE               PIC X.
  5010             88  COMM-TRLR           VALUE 'A'.
  5011             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5012             88  CERT-DATA-TRLR      VALUE 'C'.
  5013                                                                  ELCCRTT
  5014     12  CS-DATA-AREA                      PIC X(516).
  5015
  5016     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5017         16  CS-BANK-COMMISSION-AREA.
  5018             20  CS-BANK-COMMS       OCCURS 10.
  5019                 24  CS-AGT                PIC X(10).
  5020                 24  CS-COM-TYP            PIC X.
  5021                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5022                 24  CS-RECALC-LV-INDIC    PIC X.
  5023                 24  FILLER                PIC X(10).
  5024
  5025         16  FILLER                        PIC X(256).
  5026
  5027     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5028****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5029****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5030         16  CS-MB-CLAIM-DATA OCCURS 2.
  5031             20  FILLER OCCURS 10.
  5032                 24  CS-CLAIM-TYPE         PIC X.
  5033                     88  CS-AH-CLM           VALUE 'A'.
  5034                     88  CS-IU-CLM           VALUE 'I'.
  5035                     88  CS-GP-CLM           VALUE 'G'.
  5036                     88  CS-LF-CLM           VALUE 'L'.
  5037                     88  CS-PR-CLM           VALUE 'P'.
  5038                 24  CS-BANK               PIC S999 COMP-3.
  5039                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5040                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5041                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5042         16  FILLER                        PIC X(216).
  5043
  5044     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5045         16  CS-VIN-NUMBER                 PIC X(17).
  5046         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5047         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5048         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5049         16  FILLER                        PIC X(496).
  5050
  5051******************************************************************ELCCRTT
  5052
  5053 FD  ERPDEF.
  5054
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  92
* EL517.cbl
* 5055                                 COPY ERCPDEF.
  5056******************************************************************
  5057*                                                                *
  5058*                                                                *
  5059*                            ERCPDEF.                            *
  5060*                                                                *
  5061*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5062*                                                                *
  5063*    FILE TYPE = VSAM,KSDS                                       *
  5064*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5065*                                                                *
  5066*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5067*                                                                *
  5068*    LOG = YES                                                   *
  5069*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5070******************************************************************
  5071 01  PRODUCT-MASTER.
  5072    12  PD-RECORD-ID                 PIC X(02).
  5073        88  VALID-PD-ID                  VALUE 'PD'.
  5074
  5075    12  PD-CONTROL-PRIMARY.
  5076        16  PD-COMPANY-CD            PIC X.
  5077        16  PD-STATE                 PIC XX.
  5078        16  PD-PRODUCT-CD            PIC XXX.
  5079        16  PD-FILLER                PIC X(7).
  5080        16  PD-BEN-TYPE              PIC X.
  5081        16  PD-BEN-CODE              PIC XX.
  5082        16  PD-PROD-EXP-DT           PIC XX.
  5083
  5084    12  FILLER                       PIC X(50).
  5085
  5086    12  PD-PRODUCT-DATA OCCURS 8.
  5087        16  PD-PROD-CODE             PIC X.
  5088            88  PD-PROD-LIFE           VALUE 'L'.
  5089            88  PD-PROD-PROP           VALUE 'P'.
  5090            88  PD-PROD-AH             VALUE 'A'.
  5091            88  PD-PROD-IU             VALUE 'I'.
  5092            88  PD-PROD-GAP            VALUE 'G'.
  5093        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5094        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5095        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5096        16  PD-MAX-TERM              PIC S999        COMP-3.
  5097        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5098        16  FILLER                   PIC X.
  5099        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5100        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5101        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5102        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5103        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5104        16  PD-REC-CRIT-PERIOD       PIC X.
  5105        16  PD-RTW-MOS               PIC 99.
  5106        16  FILLER                   PIC X(5).
  5107
  5108    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5109
  5110    12  PD-TERM-LIMITS OCCURS 15.
  5111        16  PD-LOW-TERM              PIC S999        COMP-3.
  5112        16  PD-HI-TERM               PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  93
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5113
  5114*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5115    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5116        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5117        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5118
  5119    12  PD-EARN-FACTORS.
  5120        16  FILLER OCCURS 15.
  5121            20  FILLER OCCURS 15.
  5122                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5123
  5124    12  PD-PRODUCT-DESC              PIC X(80).
  5125    12  PD-TRUNCATED                 PIC X.
  5126    12  FILLER                       PIC X(59).
  5127
  5128    12  PD-MAINT-INFORMATION.
  5129        16  PD-LAST-MAINT-DT         PIC X(02).
  5130        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5131        16  PD-LAST-MAINT-BY         PIC X(04).
  5132
  5133 FD  ELSTAT.
  5134
* 5135                                 COPY ELCSTATE.
  5136******************************************************************
  5137*                                                                *
  5138*                                                                *
  5139*                            ELCSTATE.                           *
  5140*                                                                *
  5141*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5142*                                                                *
  5143*   FILE TYPE = VSAM,KSDS                                        *
  5144*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5145*                                                                *
  5146*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5147*       ALTERNATE INDEX = NONE                                   *
  5148*                                                                *
  5149*   LOG = YES                                                    *
  5150*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5151******************************************************************
  5152*                   C H A N G E   L O G
  5153*
  5154* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5155*-----------------------------------------------------------------
  5156*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5157* EFFECTIVE    NUMBER
  5158*-----------------------------------------------------------------
  5159* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5160******************************************************************
  5161*
  5162 01  STATE-FILE.
  5163     12  SF-RECORD-ID                       PIC XX.
  5164         88  VALID-CF-ID                        VALUE 'SF'.
  5165
  5166     12  SF-CONTROL-PRIMARY.
  5167         16  SF-COMPANY-ID                  PIC XXX.
  5168         16  SF-CARRIER-CODE                PIC X.
  5169         16  SF-GROUPING                    PIC X(6).
  5170         16  SF-STATE-CODE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5171         16  SF-EXPIRE-DATE                 PIC 9(8).
  5172
  5173****************************************************************
  5174*             STATE CONTROLS
  5175****************************************************************
  5176
  5177     12  SF-LAST-MAINT-DT                   PIC XX.
  5178     12  SF-LAST-MAINT-BY                   PIC X(4).
  5179     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5180
  5181     12  SF-STATE-RT-CONTROLS.
  5182         16  SF-ST-RT-CALC                  PIC X.
  5183
  5184     12  SF-ST-TAX-CONTROLS.
  5185         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5186         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5187         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5188
  5189     12  SF-ST-REFUND-OPTIONS.
  5190         16  SF-ST-RF-LR-CALC               PIC X.
  5191         16  SF-ST-RF-LL-CALC               PIC X.
  5192         16  SF-ST-RF-LN-CALC               PIC X.
  5193         16  SF-ST-RF-AH-CALC               PIC X.
  5194         16  SF-ST-RF-CP-CALC               PIC X.
  5195
  5196     12  SF-ST-UNEARN-PREM-OPTIONS.
  5197         16  SF-ST-LUEP-R78                 PIC X.
  5198         16  SF-ST-LUEP-PRO                 PIC X.
  5199         16  SF-ST-LUEP-ST                  PIC X.
  5200         16  SF-ST-LUEP-DOM                 PIC X.
  5201         16  SF-ST-AUEP-R78                 PIC X.
  5202         16  SF-ST-AUEP-PRO                 PIC X.
  5203         16  SF-ST-AUEP-ST                  PIC X.
  5204         16  SF-ST-AUEP-DOM                 PIC X.
  5205         16  SF-ST-CUEP-R78                 PIC X.
  5206         16  SF-ST-CUEP-PRO                 PIC X.
  5207         16  SF-ST-CUEP-ST                  PIC X.
  5208         16  SF-ST-CUEP-DOM                 PIC X.
  5209
  5210     12  SF-ST-EARN-PREM-OPTIONS.
  5211         16  SF-ST-LEP-R78                  PIC X.
  5212         16  SF-ST-LEP-PRO                  PIC X.
  5213         16  SF-ST-LEP-ST                   PIC X.
  5214         16  SF-ST-LEP-DOM                  PIC X.
  5215         16  SF-ST-AEP-R78                  PIC X.
  5216         16  SF-ST-AEP-PRO                  PIC X.
  5217         16  SF-ST-AEP-ST                   PIC X.
  5218         16  SF-ST-AEP-DOM                  PIC X.
  5219         16  SF-ST-CEP-R78                  PIC X.
  5220         16  SF-ST-CEP-PRO                  PIC X.
  5221         16  SF-ST-CEP-ST                   PIC X.
  5222         16  SF-ST-CEP-DOM                  PIC X.
  5223
  5224     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5225
  5226 FD  ELCRTO.
  5227
* 5228                                 COPY ELCCRTO.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5229******************************************************************
  5230*                                                                *
  5231*                            ELCCRTO.                            *
  5232*                                                                *
  5233*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5234*                                                                *
  5235*   FILE TYPE = VSAM,KSDS                                        *
  5236*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5237*                                                                *
  5238*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5239*                                                                *
  5240*   LOG = YES                                                    *
  5241*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5242******************************************************************
  5243*                   C H A N G E   L O G
  5244*
  5245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5246*-----------------------------------------------------------------
  5247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5248* EFFECTIVE    NUMBER
  5249*-----------------------------------------------------------------
  5250* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5251* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5252* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5253* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5254* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5255******************************************************************
  5256
  5257 01  ORIGINAL-CERTIFICATE.
  5258     12  OC-RECORD-ID                      PIC XX.
  5259         88  VALID-OC-ID                      VALUE 'OC'.
  5260
  5261     12  OC-CONTROL-PRIMARY.
  5262         16  OC-COMPANY-CD                 PIC X.
  5263         16  OC-CARRIER                    PIC X.
  5264         16  OC-GROUPING                   PIC X(6).
  5265         16  OC-STATE                      PIC XX.
  5266         16  OC-ACCOUNT                    PIC X(10).
  5267         16  OC-CERT-EFF-DT                PIC XX.
  5268         16  OC-CERT-NO.
  5269             20  OC-CERT-PRIME             PIC X(10).
  5270             20  OC-CERT-SFX               PIC X.
  5271         16  OC-RECORD-TYPE                PIC X.
  5272         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5273
  5274     12  OC-LAST-MAINT-DT                  PIC XX.
  5275     12  OC-LAST-MAINT-BY                  PIC X(4).
  5276     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5277
  5278     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5279     12  FILLER                            PIC X(49).
  5280
  5281     12  OC-ORIG-REC.
  5282         16  OC-INS-LAST-NAME              PIC X(15).
  5283         16  OC-INS-FIRST-NAME             PIC X(10).
  5284         16  OC-INS-MIDDLE-INIT            PIC X.
  5285         16  OC-INS-AGE                    PIC S999     COMP-3.
  5286         16  OC-JNT-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5287         16  OC-JNT-FIRST-NAME             PIC X(10).
  5288         16  OC-JNT-MIDDLE-INIT            PIC X.
  5289         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5290         16  OC-LF-BENCD                   PIC XX.
  5291         16  OC-LF-TERM                    PIC S999      COMP-3.
  5292         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5293         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5294         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5295         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5296         16  OC-LF-EXP-DT                  PIC XX.
  5297         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5298         16  OC-LF-CANCEL-DT               PIC XX.
  5299         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5300         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5301         16  OC-AH-BENCD                   PIC XX.
  5302         16  OC-AH-TERM                    PIC S999      COMP-3.
  5303         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5304         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5305         16  OC-AH-EXP-DT                  PIC XX.
  5306         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5307         16  OC-AH-CP                      PIC 99.
  5308         16  OC-AH-CANCEL-DT               PIC XX.
  5309         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5310         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5311         16  OC-CRED-BENE-NAME             PIC X(25).
  5312         16  OC-1ST-PMT-DT                 PIC XX.
  5313         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5314         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5315         16  OC-ISSUE-TRAN-IND             PIC X.
  5316         16  OC-CANCEL-TRAN-IND            PIC X.
  5317         16  FILLER                        PIC X(211).
  5318
  5319     12  FILLER                            PIC X(50).
  5320
  5321******************************************************************
  5322
  5323 WORKING-STORAGE SECTION.
  5324 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5325 77  FILLER   PIC X(32) VALUE '********************************'.
  5326 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5327 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5328
  5329 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5330 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5331 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5332 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5333
  5334 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5335 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5336 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5337 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5338 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5339 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5340 77  X                      PIC X                  VALUE ' '.
  5341 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5342
  5343 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5344 01  TRAN-CX REDEFINES TRAN-CT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  97
* EL517.cbl
  5345     12  FILLER             PIC XX.
  5346     12  TCX                PIC 999.
  5347 01  SEQ-NO                 PIC 9999               VALUE 0.
  5348 01  RPND                   PIC 9(5)               VALUE 0.
  5349 01  WPND                   PIC 9(5)               VALUE 0.
  5350 01  RREI                   PIC 9(5)               VALUE 0.
  5351 01  RCTB                   PIC 9(5)               VALUE 0.
  5352 01  RACC                   PIC 9(5)               VALUE 0.
  5353 01  RCER                   PIC 9(5)               VALUE 0.
  5354 01  RCNT                   PIC 9(5)               VALUE 0.
  5355 01  WCER                   PIC 9(5)               VALUE 0.
  5356 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5357 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5358 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5359 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5360 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5361 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5362 01  EMSG.
  5363     12  WS-FILE-ERROR-MESSAGE.
  5364         16  FILLER              PIC X(24)   VALUE
  5365             'ERROR OCCURED OPENING - '.
  5366         16  WS-FEM-FILE-NAME    PIC X(8).
  5367
  5368 01  CMSG.
  5369     12  WS-FILE-ERROR-MESSAGE.
  5370         16  FILLER              PIC X(24)   VALUE
  5371             'ERROR OCCURED CLOSING - '.
  5372         16  WS-CEM-FILE-NAME    PIC X(8).
  5373
  5374 01  RMSG.
  5375     12  WS-FILE-ERROR-MESSAGE.
  5376         16  FILLER              PIC X(24)   VALUE
  5377             'ERROR OCCURED READING - '.
  5378         16  WS-REM-FILE-NAME    PIC X(8).
  5379
  5380 01  HDG1.
  5381     12  FILLER                  PIC X(50)       VALUE ' '.
  5382     12  FILLER                  PIC X(28)       VALUE
  5383                   'PENDING BUSINESS FILE EDIT '.
  5384     12  ER-ONLY                 PIC X(47)       VALUE
  5385          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5386     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5387
  5388 01  HDG2.
  5389     12  FILLER              PIC X(52)              VALUE SPACE.
  5390     12  H2-COMP             PIC X(30).
  5391     12  FILLER              PIC X(42)              VALUE SPACE.
  5392     12  H2-DATE             PIC X(8).
  5393
  5394 01  HDG3.
  5395     12  FILLER              PIC X(54)              VALUE SPACE.
  5396     12  H3-DATE             PIC X(18).
  5397     12  FILLER              PIC X(49)              VALUE SPACE.
  5398
  5399 01  SUM1.
  5400     12  FILLER              PIC XX                 VALUE ' '.
  5401     12  SUM-TOT             PIC ZZ,ZZZ.
  5402     12  FILLER              PIC X(3)               VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  98
* EL517.cbl
  5403     12  FILLER              PIC X(30)              VALUE
  5404          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page  99
* EL517.cbl
  5406
  5407 01  WX-AREA.
  5408     12  PH-COBOL            PIC X.
  5409     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5410
  5411 01  STATUS-SWITCH.
  5412     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5413     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5414     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5415     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5416     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5417     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5418     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5419     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5420     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5421     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5422     12  ERACCT-FILE-STATUS.
  5423         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5424         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5425     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5426     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5427     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5428     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5429     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5430     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5431     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5432     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5433     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5434     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5435     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5436
  5437     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5438     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5439     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5440     12  WS-SW-1                  PIC X  VALUE ' '.
  5441     12  WS-SW-2                  PIC X  VALUE ' '.
  5442
  5443     12  WS-COMPUTED-TOTALS      COMP-3.
  5444         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5445         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5446         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5447         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5448         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5449         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5450         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5451         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5452         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5453         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5454     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5455         88  CO-HAS-CLAIMS                     VALUE '2'.
  5456
  5457     12  EIBDATE                 PIC S9(7)     COMP-3.
  5458
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 100
* EL517.cbl
  5460
  5461* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5462     COPY ELC50W1.
  5463******************************************************************04/19/98
  5464*                                                                *ELC50W1
  5465*                                                                *ELC50W1
  5466*                             ELC50W1                            *   LV005
  5467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5468*                            VMOD=2.004                          *   CL**5
  5469*                                                                *ELC50W1
  5470*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5471*                                                                *ELC50W1
  5472*                                                                *ELC50W1
  5473******************************************************************ELC50W1
  5474                                                                  ELC50W1
  5475     12  WK-WORK-AREA.                                            ELC50W1
  5476         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5477         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5478         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5479         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5480         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5481         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5482         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5483         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5484         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5485         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5486         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5487         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5488         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5489         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5490         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5491         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5492             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5493             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5494             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5495             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5496             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5497             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5498         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5499         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5500             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5501             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5502             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5503         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5504             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5505         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5506         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5507     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5508         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5509         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5510         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5511         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5512         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5513         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5514         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5515         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5516     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5517         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5518         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5519         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5520             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5521         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5522
  5523         16  WK-CONV-GREG.
  5524             24  WCG-CENT             PIC XX.
  5525             24  WCG-REST             PIC X(4).
  5526         16  WORK-GREGORIAN-DATE.
  5527             24  WK-GREG-CENT         PIC XX.
  5528             24  WK-GREG-DATE-YYMMDD.
  5529                 28  WK-GREG-YYMM     PIC X(4).
  5530                 28  WK-GREG-DD       PIC XX.
  5531
  5532         16  WORK-SELECT-DATE.
  5533             24  WK-SELECT-CENT           PIC XX.
  5534             24  WK-SELECT-DATE-YYMMDD.
  5535                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5536                 28  FILLER               PIC XX.
  5537
  5538         16  WK-FORM-NO.
  5539             24  WK-FORM-BANK-ID       PIC X(5).
  5540             24  WK-FORM-UNDRWRTR      PIC X(1).
  5541             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5542
  5543         16  WK-MEMBER-NO.
  5544             24  WK-MEMBER-1-6        PIC X(6).
  5545             24  WK-MEMBER-7-12       PIC X(6).
  5546
  5547         16  WK-FULL-CERT-NO.
  5548             24  WK-CERT-POS-1-2      PIC X(2).
  5549             24  WK-CERT-POS-3        PIC X(1).
  5550             24  WK-CERT-POS-4        PIC X(1).
  5551             24  WK-CERT-POS-5-6      PIC X(2).
  5552             24  WK-CERT-POS-7        PIC X(1).
  5553             24  WK-CERT-POS-8-11     PIC X(4).
  5554
  5555         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5556             88  VALID-RATE-CODE     VALUE 'Y'.
  5557             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5558
  5559     12  WK-BATCH-NO.
  5560         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5561         16  FILLER                   PIC XXX       VALUE SPACES.
  5562
* 5563                                  COPY ELCEDITC.
  5564******************************************************************04/15/98
  5565*                                                                *ELCEDITC
  5566*                                                                *ELCEDITC
  5567*                            ELCEDITC                            *   LV002
  5568*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5569*                            VMOD=2.012                          *   CL**2
  5570*                                                                *ELCEDITC
  5571*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5572*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5573*                                                                *ELCEDITC
  5574******************************************************************ELCEDITC
  5575******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5576*                   C H A N G E   L O G
  5577*
  5578* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5579*-----------------------------------------------------------------
  5580*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5581* EFFECTIVE    NUMBER
  5582*-----------------------------------------------------------------
  5583* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5584******************************************************************
  5585                                                                  ELCEDITC
  5586     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5587         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5588         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5589         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5590         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5591         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5592         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5593         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5594         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5595         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5596         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5597               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5598               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5599               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5600               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5601                                                                  ELCEDITC
  5602         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5603               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5604               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5605               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5606               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5607               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5608               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5609               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5610               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5611               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5612               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5613                                                                  ELCEDITC
  5614         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5615               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5616               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5617               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5618               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5619               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5620               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5621               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5622               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5623                                                                  ELCEDITC
  5624         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5625                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5626                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5627                                                                  ELCEDITC
  5628         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5629                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5630                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5631                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5632                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5633                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5634                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5635                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5636                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5637                                                                  ELCEDITC
  5638         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5639               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5640               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5641                                                                  ELCEDITC
  5642         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5643         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5644         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5645         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5646         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5647                                                                  ELCEDITC
  5648         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5649               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5650               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5651               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5652               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5653                                                                  ELCEDITC
  5654         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5655               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5656               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5657               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5658               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5659                                                                  ELCEDITC
  5660         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5661                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5662                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5663                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5664                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5665                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5666                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5667                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5668                                                                  ELCEDITC
  5669         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5670                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5671                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5672                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5673                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5674                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5675                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5676                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5677                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5678                                                                  ELCEDITC
  5679         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5680                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5681                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5682                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5683                                                                  ELCEDITC
  5684         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5685                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5686                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5687                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5688                                                                  ELCEDITC
  5689         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5690         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5691         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5692         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5693                                                                  ELCEDITC
  5694         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5695         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5696                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5697                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5698                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5699                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5700                                                                  ELCEDITC
  5701         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5702               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5703               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5704               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5705               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5706               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5707                                                                  ELCEDITC
  5708         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5709               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5710               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5711               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5712               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5713               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5714                                                                  ELCEDITC
  5715         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5716                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5717                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5718                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5719                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5720                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5721                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5722                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5723                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5724                                                                  ELCEDITC
  5725         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5726                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5727                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5728                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5729                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5730                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5731                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5732                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5733                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5734                                                                  ELCEDITC
  5735         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5736         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5737         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5738         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5739         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5740         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5741         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5742         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5743         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5744         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5745         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5746         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5747                                                                  ELCEDITC
  5748         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5749                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5750                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5751                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5752                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5753                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5754                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5755                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5756                                                                  ELCEDITC
  5757         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5758                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5759                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5760                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5761                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5762                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5763                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5764                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5765                                                                  ELCEDITC
  5766         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5767                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5768                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5769                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5770                                                                  ELCEDITC
  5771         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5772         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5773         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5774         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5775         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5776         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5777         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5778         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5779         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5780                                                                  ELCEDITC
  5781         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5782         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5783         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5784         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5785         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5786         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5787         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5788         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5789         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5790         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5791         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5792         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5793         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5794         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5795         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5796                                                                  ELCEDITC
  5797         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5798             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5799                                             'M' '5' '9' '2'.     ELCEDITC
  5800             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5801             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5802             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5803             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5804             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5805             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5806             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5807             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 106
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5808             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5809             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5810                                                                  ELCEDITC
  5811         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5812             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5813                                             'M' '5' '9' '2'.     ELCEDITC
  5814             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5815             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5816             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5817             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5818             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5819             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5820             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5821             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5822             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5823             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5824                                                                  ELCEDITC
  5825         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5826         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5827         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5828         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5829         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5830                                                                  ELCEDITC
  5831*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5832*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5833         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5834                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5835                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5836                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5837                                                                  ELCEDITC
  5838         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5839         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5840         16  FILLER                    PIC X.                     ELCEDITC
  5841*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5842         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5843             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5844             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5845             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5846             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5847             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5848             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5849             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5850             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5851             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5852         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 107
* EL517.cbl
* 5854                                  COPY ELC50WS.
  5855*****************************************************************
  5856*                                                               *
  5857*                            ELC50WS.                           *
  5858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5859*                            VMOD=2.061.                        *
  5860*                                                               *
  5861*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5862*                                   EL517                       *
  5863*****************************************************************
  5864******************************************************************
  5865*                   C H A N G E   L O G
  5866*
  5867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5868*-----------------------------------------------------------------
  5869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5870* EFFECTIVE    NUMBER
  5871*-----------------------------------------------------------------
  5872* 123102                   PEMA  ADD DCC PROCESSING
  5873* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5874* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5875* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5876* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5877* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5878* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5879* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5880* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5881* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5882* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5883* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5884* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5885* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5886* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5887* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5888* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5889* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5890* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5891* 030309  CR2009021700001  PEMA  ADD ER-2883
  5892* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5893* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5894* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5895* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5896* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5897* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5898* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5899* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5900* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5901* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5902* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5903* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5904* 061412  CR2011022800001  AJRA  NAPERSOFT
  5905* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5906* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5907* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5908* 101314  IR2013100100002  PEMA  ADD ERROR 1572
  5909* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  5910* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
  5911* 040914  IR2014040900001  AJRA  ADD ERROR 2896
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 108
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5912*-----------------------------------------------------------------
  5913
  5914 01  WORK-AREAS.
  5915
  5916*****************************************************************
  5917*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5918*****************************************************************
  5919
  5920     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5921     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5922     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5923     12  WS-NAME-EDIT-WORK-AREA.
  5924         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5925         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5926             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5927         16  WS-WORK-NAME.
  5928             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5929             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5930             20  FILLER           PIC X(10)     VALUE SPACES.
  5931         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5932             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5933
  5934*****************************************************************
  5935*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5936*****************************************************************
  5937
  5938     12  WS-ERRESC-KEY.
  5939         16 WS-ERRESC-SEARCH-KEY.
  5940             20  WS-ERRESC-COMPANY-CD PIC  X.
  5941             20  WS-ERRESC-CARRIER    PIC  X.
  5942             20  WS-ERRESC-GROUP      PIC X(6).
  5943             20  WS-ERRESC-STATE      PIC XX.
  5944             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5945         16 WS-ERRESC-RESIDUAL-KEY.
  5946             20  WS-ERRESC-AGENT      PIC X(10).
  5947             20  WS-ERRESC-RES-STATE  PIC XX.
  5948             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5949*                                          YYYYMMDD
  5950     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5951     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5952
  5953*RESIDENT STATE TAX MASTER(ERRESS)
  5954*
  5955     12  WS-ERRESS-KEY.
  5956         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5957         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5958         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5959         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5960*                                          YYYYMMDD
  5961
  5962     12  WS-CONTRACT-DATE              PIC 9(8).
  5963*                                          YYYYMMDD
  5964     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5965     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5966         16 WS-YEAR-YY                 PIC   9999.
  5967         16 FILLER                     PIC 9(4).
  5968*                                          YYYYMMDD
  5969     12  WS-SAVE-ERRESS-KEY            PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 109
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5970     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5971     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5972     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5973
  5974     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5975         88  DPRB-1ST-TIME                      VALUE ' '.
  5976
  5977*****************************************************************
  5978*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5979*****************************************************************
  5980
  5981     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5982     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5983     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5984     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5985     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5986     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5987     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5988     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5989     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5990     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5991         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5992         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5993     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5994         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5995         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5996     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5997
  5998     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5999     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  6000
  6001     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  6002     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  6003     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6004     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6005     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6006     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6007     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6008     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6009     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6010     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6011     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6012     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6013     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  6014     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  6015     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  6016     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  6017     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6018     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6019     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6020     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6021     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6022     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6023     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6024     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6025     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6026     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6027     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 110
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6028     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6029     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6030     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6031     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6032     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6033     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6034     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6035     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  6036     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  6037     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  6038     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  6039     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  6040     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  6041     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  6042     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  6043     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  6044     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  6045     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6046     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6047     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6048     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6049     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6050     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6051     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6052     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6053     12  WS-2671-SW               PIC X         VALUE SPACE.
  6054     12  WS-2672-SW               PIC X         VALUE SPACE.
  6055     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6056         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6057     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6058         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6059     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6060
  6061     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6062         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6063         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6064         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6065         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6066
  6067     12  WS-CREDIT-EDIT-CONTROLS.
  6068         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6069         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6070         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6071         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6072         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6073         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6074
  6075     12  WS-AGE-FIELDS.
  6076         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6077         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6078         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6079         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6080
  6081     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6082         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6083         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6084         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6085         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 111
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6086         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6087         16  FILLER                      PIC XX.
  6088
  6089     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
  6090     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6091     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6092     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6093     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6094     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6095     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6096     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6097     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6098     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6099
  6100     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6101     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6102     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6103     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6104     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6105     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6106     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6107     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6108         88  WS-REDUCING              VALUE 'R'.
  6109         88  WS-LEVEL                 VALUE 'L' 'P'.
  6110     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6111
  6112     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6113     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6114     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6115     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6116     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6117     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6118     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6119     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6120     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6121
  6122     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6123     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6124     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6125     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6126     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6127     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6128     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6129     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6130     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6131     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6132     12  WS-ACCT-SIG-SW.
  6133         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6134         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6135     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6136     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6137     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6138     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6139     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6140     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6141     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6142     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6143     12  WS-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 112
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6144         16  WS-INIT-1            PIC X         VALUE SPACES.
  6145         16  WS-INIT-2            PIC X         VALUE SPACES.
  6146
  6147     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
  6148     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6149     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6150     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6151     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6152*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6153     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6154     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6155     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6156     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6157     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6158     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6159     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6160     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6161     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6162     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6163     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6164     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6165     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6166     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6167     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6168     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6169     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6170     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6171     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6172     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6173     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6174     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6175******** FLA
  6176     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6177     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6178     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6179     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6180     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6181********
  6182     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6183     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6184     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6185     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6186     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6187     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6188     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6189     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6190     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6191     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6192
  6193     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6194         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6195                                         '0' THRU '9'.
  6196
  6197     12  NUMBER-OF-MONTHS.
  6198         16  SK-MO OCCURS 12 TIMES PIC X.
  6199
  6200     12  WS-WORK-DATE.
  6201         16  WS-YEAR            PIC 99    VALUE 00.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 113
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6202         16  WS-MONTH           PIC 99    VALUE 00.
  6203         16  WS-DAY             PIC 99    VALUE 00.
  6204
  6205     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
  6206     12  WS-WORK-CRIT-DEV       REDEFINES
  6207         WS-WORK-LF-CRIT-PER    PIC X(03).
  6208
  6209     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6210     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6211
  6212     12  WS-WORK-DATE-FROM.
  6213         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6214         16  FILLER             PIC X  VALUE SPACE.
  6215         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6216         16  FILLER             PIC X         VALUE SPACE.
  6217         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6218
  6219     12  WS-WORK-DATE-THRU.
  6220         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6221         16  FILLER             PIC X         VALUE SPACE.
  6222         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6223         16  FILLER             PIC X         VALUE SPACE.
  6224         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6225
  6226     12  WS-LF-INPUT-CD.
  6227         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6228         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6229
  6230     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6231     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6232         16  WS-AH-INPUT-CD-1   PIC X.
  6233         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6234
  6235     12  WS-SWITCHES.
  6236         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6237         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6238             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6239         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6240             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6241         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6242             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6243         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6244             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6245         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6246             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6247         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6248             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6249         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6250             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6251         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6252             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6253         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6254             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6255         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6256             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6257         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6258             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6259         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 114
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6260             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6261         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6262             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6263         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
  6264             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6265         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6266             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6267         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6268             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6269         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6270             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6271         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6272             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6273         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6274             88  AH-BENEFIT-FOUND         VALUE ' '.
  6275             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6276         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6277             88  LF-BENEFIT-FOUND         VALUE ' '.
  6278             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6279         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6280             88  NO-STATE-RECORD          VALUE '1'.
  6281         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6282             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6283         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6284             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6285         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6286             88  CERT-WAS-FOUND           VALUE ' '.
  6287             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6288         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6289             88  BROWSE-STARTED           VALUE 'Y'.
  6290         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6291             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6292         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6293             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6294         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6295             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6296         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6297             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6298         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6299             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6300         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6301             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6302         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6303             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6304             88  FIRST-TIME-THROUGH       VALUE '1'.
  6305             88  CTBL-NOT-FOUND           VALUE '2'.
  6306
  6307         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6308             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6309
  6310         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6311             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6312
  6313********FLA
  6314     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6315     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6316********
  6317     12  RC-SW-1                  PIC X           VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 115
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6318     12  RC-SW-2                  PIC X           VALUE '0'.
  6319     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6320     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6321     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
  6322     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6323     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6324     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6325     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6326     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6327     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6328     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6329     12  LIT-SPACES               PIC X           VALUE SPACES.
  6330     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6331     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6332     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6333     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6334     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6335     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6336     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6337         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6338         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6339     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6340         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6341
  6342 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6343     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6344     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6345 01  WS-CRI-SSN-WORK-AREA.
  6346     05  WS-CRI-SOC-SEC-NO.
  6347         10  WS-SS-REPT-CD       PIC X(5).
  6348         10  WS-SS-LAST-NAME     PIC X(5).
  6349         10  WS-SS-INITIAL       PIC X.
  6350
  6351     05  WS-CRI-REPORT-CODE.
  6352         10  FILLER              PIC X(5).
  6353         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6354
  6355     05  WS-CRI-LAST-NAME.
  6356         10  WS-CRI-NAME-MOVE    PIC X(5).
  6357         10  FILLER              PIC X(10).
  6358
  6359 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6360     '12345678012345070923456789'.
  6361 01  FILLER REDEFINES WS-NUM-TABLE.
  6362     05  WS-NUM OCCURS 26        PIC 9.
  6363 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6364 01  V1                          PIC S999 COMP-3.
  6365 01  V2                          PIC S999 COMP-3.
  6366 01  V3                          PIC S999 COMP-3.
  6367 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6368 01  FILLER REDEFINES WS-WORK-VIN.
  6369     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6370 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6371 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6372 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6373 01  WS-HEX-WORK.
  6374     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6375     05  WS-HEX-BYTE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 116
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6376 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6377 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6378
  6379 01  WS-WORK-HIN-ROW-B.
  6380     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6381
  6382 01  ws-benefit-cd-chg-sw      pic x value spaces.
  6383     88  benefit-code-chg           value 'Y'.
  6384 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6385 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6386     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6387 01  WS-ROW-D-TABLE.
  6388     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6389
  6390 01  WS-HIN-TABLE-B.
  6391     05  F                       PIC XX VALUE 'A2'.
  6392     05  F                       PIC XX VALUE 'B3'.
  6393     05  F                       PIC XX VALUE 'C4'.
  6394     05  F                       PIC XX VALUE 'D5'.
  6395     05  F                       PIC XX VALUE 'E6'.
  6396     05  F                       PIC XX VALUE 'F7'.
  6397     05  F                       PIC XX VALUE 'G8'.
  6398     05  F                       PIC XX VALUE 'H9'.
  6399     05  F                       PIC XX VALUE 'I1'.
  6400     05  F                       PIC XX VALUE 'J2'.
  6401     05  F                       PIC XX VALUE 'K3'.
  6402     05  F                       PIC XX VALUE 'L4'.
  6403     05  F                       PIC XX VALUE 'M5'.
  6404     05  F                       PIC XX VALUE 'N6'.
  6405     05  F                       PIC XX VALUE 'O0'.
  6406     05  F                       PIC XX VALUE 'P7'.
  6407     05  F                       PIC XX VALUE 'Q0'.
  6408     05  F                       PIC XX VALUE 'R8'.
  6409     05  F                       PIC XX VALUE 'S9'.
  6410     05  F                       PIC XX VALUE 'T2'.
  6411     05  F                       PIC XX VALUE 'U3'.
  6412     05  F                       PIC XX VALUE 'V4'.
  6413     05  F                       PIC XX VALUE 'W5'.
  6414     05  F                       PIC XX VALUE 'X6'.
  6415     05  F                       PIC XX VALUE 'Y7'.
  6416     05  F                       PIC XX VALUE 'Z8'.
  6417 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6418     05  WS-VAL-IN               PIC X.
  6419     05  WS-VAL-OUT              PIC 9.
  6420 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6421
  6422 01  WS-COMPARE-BINARY-DATES.
  6423     05  WS-971231                PIC XX VALUE X'92FF'.
  6424     05  WS-931231                PIC XX VALUE X'8CFF'.
  6425     05  WS-791231                PIC XX VALUE X'77FF'.
  6426     05  WS-771001                PIC XX VALUE X'74A1'.
  6427     05  WS-820301                PIC XX VALUE X'7B41'.
  6428     05  WS-831031                PIC XX VALUE X'7DBF'.
  6429     05  WS-831231                PIC XX VALUE X'7DFF'.
  6430     05  WS-810831                PIC XX VALUE X'7A7F'.
  6431     05  WS-830901                PIC XX VALUE X'7D81'.
  6432
  6433 01  FILE-ACCESS-IDS.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 117
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6434     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6435     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6436     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6437     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6438     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6439     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
  6440     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6441     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6442     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6443     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6444     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6445     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6446     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6447     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6448     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6449     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6450     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6451
  6452 01  DD-IU-SW                    PIC X   VALUE ' '.
  6453     88  DD-IU-PRESENT                 VALUE 'Y'.
  6454
  6455 01  ACCESS-KEYS.
  6456     12  ELMSTR-KEY.
  6457         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6458         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6459     12  W-CLAIM-KEY.
  6460         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6461         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6462
  6463     12  ELCNTL-KEY.
  6464         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6465         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6466         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6467         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6468
  6469     12  ELCERT-KEY.
  6470         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6471         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6472         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6473         16  CERT-STATE           PIC XX      VALUE SPACES.
  6474         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6475         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6476         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6477
  6478     12  ELCERT2-KEY.
  6479         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6480         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6481
  6482     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6483
  6484     12  ELCERT-SAVE.
  6485         16  FILLER                      PIC XX    VALUE SPACES.
  6486
  6487         16  WCS-CONTROL-PRIMARY.
  6488             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6489             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6490             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6491             20  WCS-STATE               PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 118
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6492             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6493             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6494             20  WCS-CERT-NO.
  6495                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6496                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6497
  6498         16  CS-CONTROL-BY-NAME.
  6499             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6500             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6501             20  CS-INSURED-INITIALS.
  6502                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6503                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6504
  6505         16  CS-CONTROL-BY-SSN.
  6506             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6507             20  CS-SOC-SEC-NO.
  6508                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6509                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6510                 24  CS-SSN-LN3.
  6511                     28 CS-INSURED-INITIALS-A2   PIC XX
  6512                                     VALUE SPACES.
  6513                     28 CS-PART-LAST-NAME-A2     PIC X
  6514                                     VALUE SPACE.
  6515
  6516         16  CS-CONTROL-BY-CERT-NO.
  6517             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6518             20  CS-CERT-NO-A4           PIC X(11)
  6519                                     VALUE SPACES.
  6520
  6521         16  CS-CONTROL-BY-MEMB.
  6522             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6523             20  CS-MEMBER-NO.
  6524                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6525                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6526                 24  CS-MEMB-LN4.
  6527                     28 CS-INSURED-INITIALS-A5   PIC XX
  6528                                      VALUE SPACES.
  6529                     28 CS-PART-LAST-NAME-A5     PIC XX
  6530                                      VALUE SPACES.
  6531
  6532         16  FILLER              PIC X(360) VALUE SPACES.
  6533
  6534     12  ERACCT-KEY.
  6535         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6536         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6537         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6538         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6539         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6540         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6541
  6542     12  ERCOMP-KEY.
  6543         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6544         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6545         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6546         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6547         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6548         16  COMP-TYPE            PIC X     VALUE SPACES.
  6549
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 119
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6550     12  ERLOFC-KEY.
  6551         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6552         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6553         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6554         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6555         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
  6556         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6557
  6558     12  WS-ELCRTT-KEY.
  6559         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6560         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6561
  6562     12  ERBXRF-KEY.
  6563         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6564         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6565         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6566         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6567
  6568     12  ERAGTC-KEY.
  6569         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6570         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6571         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6572         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6573         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6574         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6575
  6576     12  ERPLAN-KEY.
  6577         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6578         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6579         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6580         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6581         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6582         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6583         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6584         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6585
  6586     12  ERFORM-KEY.
  6587         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6588         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6589         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6590         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6591
  6592     12  ERREIN-KEY.
  6593         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6594         16  REIN-TYPE            PIC X     VALUE SPACES.
  6595         16  REIN-TABLE-CO.
  6596             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6597             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6598             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6599         16  FILLER               PIC X(3)  VALUE SPACES.
  6600
  6601     12  ERCTBL-KEY.
  6602         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6603         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6604         16  CTBL-CNTRL-2.
  6605             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6606             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6607
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 120
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6608     12  ELCRTO-KEY.
  6609         16  ELCRTO-COMPANY-CD       PIC X.
  6610         16  ELCRTO-CARRIER          PIC X.
  6611         16  ELCRTO-GROUPING         PIC X(6).
  6612         16  ELCRTO-STATE            PIC XX.
  6613         16  ELCRTO-ACCOUNT          PIC X(10).
  6614         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6615         16  ELCRTO-CERT-NO.
  6616             20  ELCRTO-CERT-PRIME   PIC X(10).
  6617             20  ELCRTO-CERT-SFX     PIC X.
  6618         16  ELCRTO-RECORD-TYPE      PIC X.
  6619         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6620
  6621
  6622     12  WS-ACCESS.
  6623         16  FILLER               PIC XX    VALUE SPACES.
  6624         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6625
  6626     12  WS-CARR-ACCESS.
  6627         16  FILLER               PIC X(3)  VALUE SPACES.
  6628         16  WS-CARR              PIC X     VALUE SPACE.
  6629*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6630*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6631     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6632         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6633         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6634         88  WS-DMD-NO-RATING   VALUE 'N'.
  6635
  6636
  6637     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6638         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6639                                         'NJ' 'NL'
  6640                                         'PJ' 'PL'
  6641                                         'SJ' 'SL'.
  6642     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6643         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6644                                         'NI' 'NJ' 'NL' 'NU'
  6645                                         'PJ' 'PL' 'PI' 'PU'
  6646                                         'SI' 'SJ' 'SL' 'SU'
  6647                                         'MX' 'MY' 'MZ'.
  6648
  6649 01  ERPDEF-KEY-SAVE             PIC X(18).
  6650 01  ERPDEF-KEY.
  6651     12  ERPDEF-COMPANY-CD       PIC X.
  6652     12  ERPDEF-STATE            PIC XX.
  6653     12  ERPDEF-PROD-CD          PIC XXX.
  6654     12  F                       PIC X(7).
  6655     12  ERPDEF-BEN-TYPE         PIC X.
  6656     12  ERPDEF-BEN-CODE         PIC XX.
  6657     12  ERPDEF-EXP-DT           PIC XX.
  6658
  6659 01  ELSTAT-KEY-SAVE             PIC X(20).
  6660 01  ELSTAT-KEY.
  6661     12  ELSTAT-COMPANY-ID       PIC XXX.
  6662     12  ELSTAT-CARRIER          PIC X.
  6663     12  ELSTAT-GROUP            PIC X(6).
  6664     12  ELSTAT-STATE            PIC XX.
  6665     12  ELSTAT-EXP-DT           PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 121
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6666
  6667 01  WS-ERROR-VALUES.
  6668     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6669     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6670     12  er-1572                     pic s9(4)   value +1572.
  6671     12  er-1573                     pic s9(4)   value +1573.
  6672     12  er-1574                     pic s9(4)   value +1574.
  6673     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6674     12  ER-1891                     PIC S9(4)   VALUE +1891.
  6675     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6676     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6677     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6678     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6679     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6680     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6681     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6682     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6683     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6684     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6685     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6686     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6687     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6688     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6689     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6690     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6691     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6692     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6693     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6694     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6695     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6696     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6697     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6698     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6699     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6700     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6701     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6702     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6703     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6704     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6705     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6706     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6707     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6708     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6709     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6710     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6711     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6712     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6713     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6714     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6715     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6716     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6717     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6718     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6719     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6720     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6721     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6722     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6723     12  ER-2612                     PIC S9(4)   VALUE +2612.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 122
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6724     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6725     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6726     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6727     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6728     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6729     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6730     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6731     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6732     12  ER-2621                     PIC S9(4)   VALUE +2621.
  6733     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6734     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6735     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6736     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6737     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6738     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6739     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6740     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6741     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6742     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6743     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6744     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6745     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6746     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6747     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6748     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6749     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6750     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6751     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6752     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6753     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6754     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6755     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6756     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6757     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6758     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6759     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6760     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6761     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6762     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6763     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6764     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6765     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6766     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6767     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6768     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6769     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6770     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6771     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6772     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6773     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6774     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6775     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6776     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6777     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6778     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6779     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6780     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6781     12  ER-2670                     PIC S9(4)   VALUE +2670.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 123
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6782     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6783     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6784     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6785     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6786     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6787     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6788     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6789     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6790     12  ER-2679                     PIC S9(4)   VALUE +2679.
  6791     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6792     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6793     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6794     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6795     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6796     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6797     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6798     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6799     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6800     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6801     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6802     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6803     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6804     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6805     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6806     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6807     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6808     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6809     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6810     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6811     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6812     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6813     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6814     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6815     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6816     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6817     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6818     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6819     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6820     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6821     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6822     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6823     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6824     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6825     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6826     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6827     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6828     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6829     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6830     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6831     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6832     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6833     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6834     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6835     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6836     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6837     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6838     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6839     12  ER-2738                     PIC S9(4)   VALUE +2738.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 124
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6840     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6841     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6842     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6843     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6844     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6845     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6846     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6847     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6848     12  ER-2747                     PIC S9(4)   VALUE +2747.
  6849     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6850     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6851     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6852     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6853     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6854     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6855     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6856     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6857     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6858     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6859     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6860     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6861     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6862     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6863     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6864     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6865     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6866     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6867     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6868     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6869     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6870     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6871     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6872     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6873     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6874     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6875     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6876     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6877     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6878     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6879     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6880     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6881     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6882     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6883     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6884     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6885     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6886     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6887     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6888     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6889     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6890     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6891     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6892     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6893     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6894     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6895     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6896     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6897     12  ER-2879                     PIC S9(4)   VALUE +2879.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 125
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6898     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6899     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6900     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6901     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6902     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6903     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6904     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6905     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6906     12  ER-2889                     PIC S9(4)   VALUE +2889.
  6907     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6908     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6909     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6910     12  ER-2896                     PIC S9(4)   VALUE +2896.
  6911     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6912     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6913     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6914     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6915     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6916     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6917     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6918     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6919     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6920     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6921     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6922     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6923     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6924     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6925     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6926     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6927     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6928     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6929     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6930     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6931     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6932     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6933     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6934     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6935     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6936     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6937     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6938     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6939     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6940     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6941     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6942     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6943     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6944     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6945     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6946     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6947     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6948     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6949     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6950     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6951     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6952     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6953     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6954     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6955     12  ER-8067                     PIC S9(4)   VALUE +8067.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 126
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6956     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6957     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6958     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6959     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6960     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6961     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6962     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6963     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6964     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6965     12  ER-8078                     PIC S9(4)   VALUE +8078.
  6966     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6967     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6968     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6969     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6970     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6971     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6972     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6973     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6974     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6975     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6976     12  ER-8089                     PIC S9(4)   VALUE +8089.
  6977     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6978     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6979     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6980     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6981     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6982     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6983     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6984     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6985     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6986     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6987     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6988     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6989     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6990     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6991     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6992     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6993     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6994     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6995     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6996     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6997     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6998     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6999     12  ER-8303                     PIC S9(4)   VALUE +8303.
  7000     12  ER-8304                     PIC S9(4)   VALUE +8304.
  7001     12  ER-8310                     PIC S9(4)   VALUE +8310.
  7002     12  ER-8311                     PIC S9(4)   VALUE +8311.
  7003     12  ER-8312                     PIC S9(4)   VALUE +8312.
  7004     12  ER-8313                     PIC S9(4)   VALUE +8313.
  7005     12  ER-8314                     PIC S9(4)   VALUE +8314.
  7006     12  ER-8315                     PIC S9(4)   VALUE +8315.
  7007     12  ER-8316                     PIC S9(4)   VALUE +8316.
  7008     12  ER-8317                     PIC S9(4)   VALUE +8317.
  7009     12  ER-9236                     PIC S9(4)   VALUE +9236.
  7010     12  ER-9501                     PIC S9(4)   VALUE +9501.
  7011     12  ER-9503                     PIC S9(4)   VALUE +9503.
  7012     12  ER-9263                     PIC S9(4)   VALUE +9263.
  7013     12  ER-9999                     PIC S9(4)   VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 127
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  7014******************************************************************
  7015***************   END OF ELC50WS     ****************************
  7016******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 128
* EL517.cbl
  7018 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 129
* EL517.cbl
  7020*DLB001
  7021 01  WS-DLB-MASTER-POLICY-FORM.
  7022     12  DMPF-PROCESS-TYPE         PIC X.
  7023         88  DMPF-OPEN-FILES                   VALUE 'O'.
  7024         88  DMPF-REG-PROCESS                  VALUE 'P'.
  7025         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  7026     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  7027     12  DMPF-RETURN-CODE          PIC XX.
  7028         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7029         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  7030         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  7031         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  7032         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7033         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  7034         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  7035
  7036*DLB002
  7037 01  WS-DLB-INTERNAL-POLICY-FORM.
  7038     12  DIPF-PROCESS-TYPE         PIC X.
  7039         88  DIPF-OPEN-FILES                   VALUE 'O'.
  7040         88  DIPF-REG-PROCESS                  VALUE 'P'.
  7041         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  7042     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  7043     12  DIPF-RETURN-CODE          PIC XX.
  7044         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7045         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  7046         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  7047         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  7048         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7049         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  7050         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  7051
  7052*DLB003
  7053 01  WS-DLB-VALID-BANK-ID.
  7054     12  DVBI-PROCESS-TYPE         PIC X.
  7055         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7056         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7057         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7058     12  DVBI-BANK-ID              PIC X(5).
  7059     12  DVBI-BANK-ID-TYPE         PIC X.
  7060         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7061         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7062         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7063         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7064         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7065     12  DVBI-RETURN-CODE          PIC XX.
  7066         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7067         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7068         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7069         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7070         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7071         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7072         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7073         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7074         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7075         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7076
  7077*DLB007
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 130
* EL517.cbl
  7078 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7079     12  DCUA-PROCESS-TYPE         PIC X.
  7080         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7081         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7082         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7083     12  DCUA-RES-STATE            PIC XX.
  7084     12  DCUA-BEN-TYPE             PIC XX.
  7085     12  DCUA-SYS-IDENT            PIC X.
  7086         88  DCUA-CLAIM                        VALUE 'C'.
  7087         88  DCUA-PREMIUM                      VALUE 'P'.
  7088     12  DCUA-COVERAGE-RULE        PIC X.
  7089     12  DCUA-CLIENT-ID            PIC X(10).
  7090     12  DCUA-EFF-DATE             PIC X(8).
  7091     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7092     12  DCUA-RETURN-CODE          PIC XX.
  7093         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7094         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7095         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7096     12  DCUA-CERT-NUMBER          PIC X(11).
  7097     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7098     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7099
  7100*DLB011
  7101 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7102     12  DPRB-PROCESS-TYPE         PIC X.
  7103         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7104         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7105         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7106     12  DPRB-RATE-CODE            PIC X(4).
  7107     12  DPRB-COVERAGE-CATEG       PIC X.
  7108     12  DPRB-RETURN-CODE          PIC XX.
  7109         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7110         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7111         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7112         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7113         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7114         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7115         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7116         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7117     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7118     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7119     12  DPRB-BEN-TYPE             PIC XX.
  7120
  7121*DLB017
  7122 01  WS-DLB-VALID-RATE-CODE.
  7123     12  DVRC-PROCESS-TYPE         PIC X.
  7124         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7125         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7126         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7127     12  DVRC-RATE-CODE            PIC X(4).
  7128     12  DVRC-RETURN-CODE          PIC XX.
  7129         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7130         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7131         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7132         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7133         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7134         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7135         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 131
* EL517.cbl
  7136
  7137*DLB019
  7138 01  WS-DLB-ORIG-COV-CAT.
  7139     12  DOCC-PROCESS-TYPE         PIC X.
  7140         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7141         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7142         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7143     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7144     12  DOCC-RETURN-CODE          PIC XX.
  7145     12  DOCC-ORIG-COV-CAT         PIC X.
  7146     12  DOCC-UNDERWRITER          PIC XX.
  7147     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7148     12  DOCC-CREDIT-IND           PIC X.
  7149     12  DOCC-PRODUCT-CD           PIC XX.
  7150     12  DOCC-TERM                 PIC XXX.
  7151
  7152*DLB021
  7153 01  WS-DLB-VALID-LOAN-OFFICER.
  7154     12  DVLO-LOAN-OFFICER         PIC X(3).
  7155     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7156         16  DVLO-BILL-TYPE        PIC X.
  7157         16  DVLO-BILL-SOURCE      PIC X.
  7158         16  DVLO-BATCH-TYPE       PIC X.
  7159     12  DVLO-RETURN-CODE          PIC XX.
  7160         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7161         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7162         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7163         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7164         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7165         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7166
  7167*DLB022
  7168 01  WS-DLB-VALID-STATE-CODE.
  7169     12  DVSC-PROCESS-TYPE         PIC X.
  7170         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7171         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7172         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7173     12  DVSC-STATE-CODE           PIC XX.
  7174     12  DVSC-RETURN-CODE          PIC XX.
  7175         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7176         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7177         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7178         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7179         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7180         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7181         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7182
  7183*DLB023
  7184 01  WS-DLB-VALID-CODE-VALUES.
  7185     12  DVCV-PROCESS-TYPE         PIC X.
  7186         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7187         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7188         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7189     12  DVCV-SYSTEM-ID            PIC XX.
  7190         88  DVCV-CLAIMS                       VALUE 'CL'.
  7191         88  DVCV-CREDIT                       VALUE 'CR'.
  7192     12  DVCV-RECORD-TYPE          PIC XX.
  7193         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 132
* EL517.cbl
  7194         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7195         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7196         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7197         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7198         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7199         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7200         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7201     12  DVCV-RECORD-KEY           PIC X(6).
  7202     12  DVCV-RETURN-CODE          PIC XX.
  7203         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7204         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7205         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7206         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7207         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7208         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7209         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7210         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7211         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7212         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7213     12  DVCV-CODE-DESC            PIC X(60).
  7214     12  DVCV-GEN-DESC-1           PIC X(20).
  7215     12  DVCV-GEN-DESC-2           PIC X(20).
  7216     12  DVCV-GEN-DESC-3           PIC X(20).
  7217
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 133
* EL517.cbl
  7219
  7220 01  PARMLIST.
  7221     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7222     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7223     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7224**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7225**
  7226**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7227     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7228
  7229 01  PLAN-RECORDS.
  7230     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7231     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7232
* 7233                                  COPY ELCDATE.
  7234******************************************************************06/11/98
  7235*                                                                *ELCDATE
  7236*                                                                *ELCDATE
  7237*                            ELCDATE.                            *   LV023
  7238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7239*                            VMOD=2.003                           ELCDATE
  7240*                                                                *ELCDATE
  7241*                                                                *ELCDATE
  7242*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7243*                 LENGTH = 200                                   *   CL*19
  7244******************************************************************ELCDATE
  7245                                                                  ELCDATE
  7246 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7247     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7248     12  DC-OPTION-CODE                PIC X.                        CL*15
  7249         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7250         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7251         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7252         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7253         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7254         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7255         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7256         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7257         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7258         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7259         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7260         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7261         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7262         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7263         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7264         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7265         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7266         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7267         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7268         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7269         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7270         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7271         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7272         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7273         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7274         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7275         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7276         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7277         88  THREE-CHARACTER-BIN                                  ELCDATE
  7278                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7279         88  GREGORIAN-TO-BIN                                        CL**2
  7280                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7281         88  BIN-TO-GREGORIAN                                        CL**2
  7282                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7283         88  JULIAN-TO-BINARY                                        CL**2
  7284                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7285     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7286         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7287         88  DATE-CONVERSION-ERROR                                ELCDATE
  7288                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7289         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7290         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7291         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7292         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7293         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7294         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7295         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7296         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7297         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7298         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7299     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7300         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7301     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7302         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7303         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7304         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7305     12  FILLER                        PIC X.                        CL*15
  7306     12  DC-CONVERSION-DATES.                                        CL*15
  7307         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7308         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7309         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7310         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7311                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7312             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7313             20  SLASH1-1              PIC X.                        CL*15
  7314             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7315             20  SLASH1-2              PIC X.                        CL*15
  7316             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7317         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7318         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7319                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7320             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7321             20  SLASH2-1              PIC X.                        CL*15
  7322             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7323             20  SLASH2-2              PIC X.                        CL*15
  7324             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7325         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7326         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7327                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7328             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7329             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7330             20  DC-YMD-DAY            PIC 99.                       CL*15
  7331         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7332         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7333                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7334             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 135
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7335             20  DC-MDY-DAY            PIC 99.                       CL*15
  7336             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7337         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7338             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7339             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7340             20  FILLER                PIC XX.                       CL*15
  7341             20  DC-ALPHA-CENTURY.                                   CL*15
  7342                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7343             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7344         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7345         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7346         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7347         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7348         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7349                                       PIC 9(05).                    CL*20
  7350         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7351             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7352             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7353         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7354         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7355         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7356     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7357         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7358         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7359             20  FILLER                PIC 9(3).                     CL*15
  7360             20  HOLD-CEN-1-CCYY.                                    CL*15
  7361                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7362                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7363             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7364             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7365         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7366             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7367             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7368             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7369                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7370                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7371             20  FILLER                PIC 9(3).                     CL*15
  7372         16  HOLD-CENTURY-1-X.                                       CL*15
  7373             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7374             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7375                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7376                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7377             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7378             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7379         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7380             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7381             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7382             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7383                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7384                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7385             20  FILLER                PIC XXX.                      CL*23
  7386         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7387         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7388         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7389         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7390             20  DC-JULIAN-1-CCYY.                                   CL*15
  7391                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7392                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7393             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7394         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7395         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7396             20  DC-JULIAN-2-CCYY.                                   CL*15
  7397                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7398                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7399             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7400         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7401             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7402             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7403             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7404             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7405             20  DC-EDITA-CCYY.                                      CL*15
  7406                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7407                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7408         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7409             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7410             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7411             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7412             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7413             20  DC-EDITB-CCYY.                                      CL*15
  7414                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7415                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7416         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7417         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7418                              DC-GREG-DATE-CYMD.                  ELCDATE
  7419             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7420             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7421             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7422             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7423         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7424         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7425                              DC-GREG-DATE-MDCY.                  ELCDATE
  7426             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7427             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7428             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7429             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7430    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7431        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7432    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7433    12  FILLER                         PIC X(28).                    CL*26
  7434
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 137
* EL517.cbl
* 7436                                  COPY ELCCALC.
  7437******************************************************************04/15/98
  7438*                                                                *ELCCALC
  7439*                           ELCCALC.                            *    LV003
  7440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7441*                            VMOD=2.025                          *   CL**3
  7442*                                                                *   CL**2
  7443*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7444*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7445*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7446*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7447*                                                                *   CL**2
  7448*  PASSED TO ELRTRM                                              *   CL**2
  7449*  -----------------                                             *   CL**2
  7450*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7451*  ORIGINAL TERM                                                 *   CL**2
  7452*  BEGINNING DATE                                                *   CL**2
  7453*  ENDING DATE                                                   *   CL**2
  7454*  COMPANY I.D.                                                  *   CL**2
  7455*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7456*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7457*  FREE LOOK DAYS                                                *   CL**2
  7458*                                                                *   CL**2
  7459*  RETURNED FROM ELRTRM                                          *   CL**2
  7460*  ---------------------                                         *   CL**2
  7461*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7462*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7463*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7464*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7465*----------------------------------------------------------------*   CL**2
  7466*  PASSED TO ELRAMT                                              *   CL**2
  7467*  ----------------                                              *   CL**2
  7468*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7469*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7470*  ORIGINAL AMOUNT                                               *   CL**2
  7471*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7472*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7473*  METHOD                                                            CL**2
  7474*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7475*  COMPANY I.D.                                                  *   CL**2
  7476*  BENEFIT TYPE                                                  *   CL**2
  7477*                                                                *   CL**2
  7478*  RETURNED FROM ELRAMT                                          *   CL**2
  7479*  --------------------                                          *   CL**2
  7480*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7481*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7482*  REMAINING AMOUNT FACTOR                                           CL**2
  7483*----------------------------------------------------------------*   CL**2
  7484*  PASSED TO ELRESV                                              *   CL**2
  7485*  -----------------                                             *   CL**2
  7486*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7487*  VALUATION DATE                                                *   CL**2
  7488*  PAID THRU DATE                                                *   CL**2
  7489*  BENEFIT                                                       *   CL**2
  7490*  INCURRED DATE                                                 *   CL**2
  7491*  REPORTED DATE                                                 *   CL**2
  7492*  ISSUE AGE                                                     *   CL**2
  7493*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7494*  CDT PERCENT                                                   *   CL**2
  7495*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7496* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7497* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7498* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7499*                                                                *   CL**2
  7500*  RETURNED FROM ELRESV                                          *   CL**2
  7501*  --------------------                                          *   CL**2
  7502*  CDT TABLE USED                                                *   CL**2
  7503*  CDT FACTOR USED                                               *   CL**2
  7504*  PAY TO CURRENT RESERVE                                        *   CL**2
  7505*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7506*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7507*----------------------------------------------------------------*   CL**2
  7508*  PASSED TO ELRATE                                              *   CL**2
  7509*  ----------------                                              *   CL**2
  7510*  CERT ISSUE DATE                                               *   CL**2
  7511*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7512*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7513*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7514*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7515*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7516*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7517*  DEVIATION CODE                                                *   CL**2
  7518*  ISSUE AGE                                                     *   CL**2
  7519*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7520*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7521*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7522*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7523*  A.P.R.                                                        *   CL**2
  7524*  METHOD                                                            CL**2
  7525*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7526*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7527*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7528*  BENEFIT CODE                                                  *   CL**2
  7529*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7530*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7531*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7532*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7533*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7534*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7535*                                                                *   CL**2
  7536*  RETURNED FROM ELRATE                                          *   CL**2
  7537*  --------------------                                          *   CL**2
  7538*  CALCULATED PREMIUM                                            *   CL**2
  7539*  PREMIUM RATE                                                  *   CL**2
  7540*  MORTALITY CODE                                                *   CL**2
  7541*  MAX ATTAINED AGE                                              *   CL**2
  7542*  MAX AGE                                                       *   CL**2
  7543*  MAX TERM                                                      *   CL**2
  7544*  MAX MONTHLY BENEFIT                                           *   CL**2
  7545*  MAX TOTAL BENIFIT                                             *   CL**2
  7546*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7547*----------------------------------------------------------------*   CL**2
  7548*  PASSED TO ELRFND                                              *   CL**2
  7549*  ----------------                                              *   CL**2
  7550*  CERT ISSUE DATE                                               *   CL**2
  7551*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7552*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7553*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7554*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7555*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7556*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7557*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7558*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7559*  DEVIATION CODE                                                *   CL**2
  7560*  ISSUE AGE                                                     *   CL**2
  7561*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7562*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7563*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7564*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7565*  A.P.R.                                                        *   CL**2
  7566*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7567*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7568*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7569*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7570*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7571*  BENEFIT CODE                                                  *   CL**2
  7572*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7573*                                                                *   CL**2
  7574*  RETURNED FROM ELRFND                                          *   CL**2
  7575*  --------------------                                          *   CL**2
  7576*  CALCULATED REFUND                                             *   CL**2
  7577*----------------------------------------------------------------*   CL**2
  7578*  PASSED TO ELEARN                                              *   CL**2
  7579*  ----------------                                              *   CL**2
  7580*  CERT ISSUE DATE                                               *   CL**2
  7581*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7582*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7583*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7584*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7585*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7586*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7587*  DEVIATION CODE                                                *   CL**2
  7588*  ISSUE AGE                                                     *   CL**2
  7589*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7590*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7591*  A.P.R.                                                        *   CL**2
  7592*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7593*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7594*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7595*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7596*  BENEFIT CODE                                                  *   CL**2
  7597*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7598*                                                                *   CL**2
  7599*  RETURNED FROM ELEARN                                          *   CL**2
  7600*  --------------------                                          *   CL**2
  7601*  INDICATED  EARNINGS                                           *   CL**2
  7602*----------------------------------------------------------------*   CL**2
  7603*                 LENGTH = 450                                   *   CL**2
  7604*                                                                *   CL**2
  7605******************************************************************   CL**2
  7606******************************************************************
  7607*                   C H A N G E   L O G
  7608*
  7609* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7610*-----------------------------------------------------------------
  7611*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7612* EFFECTIVE    NUMBER
  7613*-----------------------------------------------------------------
  7614* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7615* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7616* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7617* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7618* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7619* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7620* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7621* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7622* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7623******************************************************************
  7624                                                                     CL**2
  7625 01  CALCULATION-PASS-AREA.                                          CL**2
  7626     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7627                                     COMP.                           CL**2
  7628                                                                     CL**2
  7629     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7630       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7631       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7632                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7633       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7634       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7635       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7636       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7637       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7638       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7639       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7640       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7641       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7642       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7643       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7644       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7645       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7646       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7647       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7648       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7649       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7650                                                                     CL**2
  7651     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7652       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7653***********************  INPUT AREAS ****************************    CL**2
  7654                                                                     CL**2
  7655     12  CP-CALCULATION-AREA.                                        CL**2
  7656         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7657         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7658         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7659         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7660         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7661           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7662                                                   'I' 'U'.          CL**2
  7663           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7664           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7665         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7666         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7667         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7668         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7669         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7670                                     COMP-3.                         CL**2
  7671         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7672                                     COMP-3.                         CL**2
  7673         16  CP-CDT-METHOD         PIC X.                            CL**2
  7674           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7675           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7676           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7677         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7678           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7679           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7680         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7681                                     COMP-3.                         CL**2
  7682         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7683                                     COMP-3.                         CL**2
  7684         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7685                                     COMP-3.                         CL**2
  7686         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7687                                     COMP-3.                         CL**2
  7688         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7689                                     COMP-3.                         CL**2
  7690         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7691                                     COMP-3.                         CL**2
  7692         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7693                                     COMP-3.                         CL**2
  7694         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7695           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7696           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7697           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7698           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7699           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7700           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7701           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7702         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7703           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7704           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7705           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7706           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7707           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7708           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7709           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7710           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7711           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7712           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7713           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7714           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7715           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7716           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7717         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7718           88  CP-CLAIM                            VALUE '1'.        CL**2
  7719           88  CP-CANCEL                           VALUE '2'.        CL**2
  7720           88  CP-ISSUE                            VALUE '3'.        CL**2
  7721         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7722           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7723           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7724           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7725           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7726           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7727           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7728           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7729           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7730           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7731           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7732           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7733           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7734           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7735           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7736           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7737           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7738           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7739           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7740                                                     'W' 'X'.        CL**2
  7741           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7742           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7743           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7744           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7745           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7746           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7747           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7748           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7749           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7750           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7751           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7752           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7753           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7754                                                                     CL**2
  7755         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7756                                     COMP-3.                         CL**2
  7757         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7758         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7759         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7760         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7761         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7762           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7763               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7764         16  CP-R78-OPTION         PIC X.                            CL**2
  7765           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7766           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7767                                                                     CL**2
  7768         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7769         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7770         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7771         16  CP-RATE-FILE          PIC X.                            CL**2
  7772         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7773                                     COMP-3.                         CL**2
  7774                                                                     CL**2
  7775         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7776         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7777                                                                     CL**2
  7778         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7779                                     COMP-3.
  7780         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7781                                   PIC S9(5)V99 COMP-3.
  7782         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7783                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7784         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7785                                     COMP-3.                         CL**2
  7786         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7787                                     COMP-3.
  7788         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7789                                  PIC S9(7)V99 COMP-3.
  7790                                                                     CL**2
  7791         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7792         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7793         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7794           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7795           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7796           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7797           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7798         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7799         16  CP-CARRIER            PIC X.                            CL**2
  7800         16  CP-REIN-FLAG          PIC X.                            CL**2
  7801         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7802           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7803                      '2' '3' '4' '5'.                               CL**2
  7804           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7805           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7806           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7807           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7808           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7809           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7810           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7811           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7812         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7813         16  CP-RATING-METHOD      PIC X.                            CL**2
  7814           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7815           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7816           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7817           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7818           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7819           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7820           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7821           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7822           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7823         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7824                                     COMP-3.                         CL**2
  7825         16  CP-BEN-CATEGORY       PIC X.
  7826         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7827         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7828                                   PIC S99V9(5) COMP-3.
  7829         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7830         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7831                                   PIC S99V9(5) COMP-3.
  7832         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7833         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7834         16  CP-EXPIRE-DT          PIC XX.
  7835         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7836         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7837         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7838         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7839         16  CP-DDF-SPEC-CALC      PIC X.
  7840             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7841             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7842         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7843         16  CP-CANCEL-REASON      PIC X.
  7844         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7845         16  CP-PMT-MODE           PIC X.
  7846         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7847         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7848         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7849         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7850         16  FILLER                PIC X.
  7851                                                                     CL**2
  7852***************    OUTPUT FROM ELRESV   ************************     CL**2
  7853                                                                     CL**2
  7854         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7855                                                                     CL**2
  7856         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7857                                     COMP-3.                         CL**2
  7858         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7859                                     COMP-3.                         CL**2
  7860         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7861                                     COMP-3.                         CL**2
  7862         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7863                                     COMP-3.                         CL**2
  7864         16  FILLER                PIC X(09).                        CL**2
  7865***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7866                                                                     CL**2
  7867         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7868                                     COMP-3.                         CL**2
  7869         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7870                                     COMP-3.                         CL**2
  7871         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7872                                     COMP-3.                         CL**2
  7873         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7874                                     COMP-3.                         CL**2
  7875         16  FILLER                PIC X(12).                        CL**2
  7876                                                                     CL**2
  7877***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7878                                                                     CL**2
  7879         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7880                                     COMP-3.                         CL**2
  7881         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7882                                     COMP-3.                         CL**2
  7883         16  FILLER                PIC X(12).                        CL**2
  7884                                                                     CL**2
  7885***************    OUTPUT FROM ELRATE   *************************    CL**2
  7886                                                                     CL**2
  7887         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7888                                     COMP-3.                         CL**2
  7889         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7890                                     COMP-3.                         CL**2
  7891         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7892         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7893             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7894         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7895                                     COMP-3.                         CL**2
  7896         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7897         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7898         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7899                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 145
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7900         16  FILLER                PIC X(07).                        CL**2
  7901                                                                     CL**2
  7902***************    OUTPUT FROM ELRFND   *************************    CL**2
  7903                                                                     CL**2
  7904         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7905                                     COMP-3.                         CL**2
  7906         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7907           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7908           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7909           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7910           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7911           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7912           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7913           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7914           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7915           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7916           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7917           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7918           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7919           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7920           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7921         16  FILLER                PIC X(12).                        CL**2
  7922                                                                     CL**2
  7923***************    OUTPUT FROM ELEARN   *************************    CL**2
  7924                                                                     CL**2
  7925         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7926                                     COMP-3.                         CL**2
  7927         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7928                                     COMP-3.                         CL**2
  7929         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7930                                     COMP-3.                         CL**2
  7931         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7932                                     COMP-3.                         CL**2
  7933         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7934                                     COMP-3.                         CL**2
  7935         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7936                                     COMP-3.                         CL**2
  7937         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7938           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7939           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7940           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7941           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7942           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7943           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7944           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7945           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7946           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7947         16  FILLER                PIC X(12).                        CL**2
  7948                                                                     CL**2
  7949***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7950                                                                     CL**2
  7951         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7952                                     COMP-3.                         CL**2
  7953         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7954                                     COMP-3.                         CL**2
  7955         16  FILLER                PIC X(12).                        CL**2
  7956                                                                     CL**2
  7957***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7958         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7959                                     COMP-3.                         CL**2
  7960         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7961                                     COMP-3.                         CL**2
  7962         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7963                                     COMP-3.                         CL**2
  7964         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7965                                     COMP-3.                         CL**2
  7966         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7967                                     COMP-3.                         CL**2
  7968         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7969                                     COMP-3.                         CL**2
  7970         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7971             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7972             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7973             88  IO-ERROR                         VALUE 'E'.         CL**2
  7974                                                                     CL**2
  7975         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7976                                                                     CL**2
  7977         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7978                                                                     CL**2
  7979         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7980                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7981                                     COMP-3.                         CL**2
  7982                                                                     CL**2
  7983         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7984                                                                     CL**2
  7985         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7986                                     COMP-3.                         CL**2
  7987                                                                     CL**2
  7988         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7989                                     COMP-3.                         CL**2
  7990                                                                     CL**2
  7991         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7992                                     COMP-3.                         CL**2
  7993                                                                     CL**2
  7994         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7995                                     COMP-3.                         CL**2
  7996                                                                     CL**2
  7997         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7998                                     COMP-3.                         CL**2
  7999                                                                     CL**2
  8000         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  8001                                     COMP-3.                         CL**2
  8002                                                                     CL**2
  8003         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  8004                                     COMP-3.                         CL**2
  8005                                                                     CL**2
  8006         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  8007             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  8008                                                                     CL**2
  8009         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  8010                                     COMP-3.                         CL**2
  8011         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  8012                                     COMP-3.
  8013         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  8014         16  FILLER                PIC X(15).                        CL**2
  8015******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 147
* EL517.cbl
  8016
* 8017                                  COPY ELCDTECX.
  8018******************************************************************06/05/98
  8019*                                                                *ELCDTECX
  8020*                            ELCDTECX.                           *   LV005
  8021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8022*                            VMOD=2.015                          *ELCDTECX
  8023*                                                                *ELCDTECX
  8024*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  8025*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  8026*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  8027*                                                                *ELCDTECX
  8028******************************************************************ELCDTECX
  8029******************************************************************
  8030*                   C H A N G E   L O G
  8031*
  8032* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8033*-----------------------------------------------------------------
  8034*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8035* EFFECTIVE    NUMBER
  8036*-----------------------------------------------------------------
  8037* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  8038*                                  BENEFIT CODES FROM 300 TO 900
  8039* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  8040* 051304    2003080800002  SMVA  ADD REFUND METHOD
  8041******************************************************************
  8042 01  DATE-CARD.                                                   ELCDTECX
  8043     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  8044     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  8045     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  8046     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  8047     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  8048     12  EP-SW                       PIC  X.                      ELCDTECX
  8049         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  8050     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  8051         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8052     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8053     12  RUN-CENTURY.                                             ELCDTECX
  8054         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8055     12  FILLER                      PIC  X.                         CL**4
  8056     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8057     12  FILLER                      PIC  XXX.                    ELCDTECX
  8058     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8059                                                                  ELCDTECX
  8060 01  FILLER                          PIC  X(7)                       CL**6
  8061                                          VALUE 'OPTIONS'.        ELCDTECX
  8062 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8063     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8064     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8065     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8066         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8067         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8068     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8069     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8070     12  FILLER                      PIC  X.                      ELCDTECX
  8071     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8072     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8073     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8074     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8075     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8076     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8077     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8078     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8079     12  FILLER                      PIC  X.                      ELCDTECX
  8080     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8081     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8082     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8083     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8084     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8085     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8086     12  FILLER                      PIC  X.                      ELCDTECX
  8087     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8088     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8089     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8090     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8091     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8092     12  DTE-R78                     PIC  X.                      ELCDTECX
  8093     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8094     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8095     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8096     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8097     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8098     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8099     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8100                                     PIC  X.                      ELCDTECX
  8101         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8102                                                 ' '.             ELCDTECX
  8103         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8104         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8105     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8106         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8107         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8108     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8109     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8110                                     PIC  9.                         CL**4
  8111     12  DTE-SYSTEM.                                              ELCDTECX
  8112         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8113         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8114         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8115         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8116         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8117         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8118         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8119         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8120         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8121         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8122         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8123         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8124         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8125         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8126         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8127         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8128         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8129         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8130         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8131         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8132         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8133         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8134         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8135         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8136         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8137         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8138     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8139         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8140                                     PIC  X.                      ELCDTECX
  8141     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8142                                                                  ELCDTECX
  8143 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8144     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8145     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8146     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8147*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8148     12  FILLER                      PIC  X.                      ELCDTECX
  8149     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8150     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8151     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8152     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8153     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8154     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8155     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8156                                                                  ELCDTECX
  8157     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8158     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8159     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8160     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8161                                                                  ELCDTECX
  8162     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8163     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8164     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8165     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8166                                                                  ELCDTECX
  8167     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8168     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8169                                                                  ELCDTECX
  8170     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8171     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8172                                                                  ELCDTECX
  8173     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8174                                                                  ELCDTECX
  8175 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8176     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8177     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8178     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8179     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8180     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8181     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8182     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8183                                                                  ELCDTECX
  8184 01  FILLER                          PIC  X(12)                   ELCDTECX
  8185                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8186 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8187     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8188         16  CNT-ID                  PIC  X.                      ELCDTECX
  8189         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8190                                                                  ELCDTECX
  8191 01  FILLER                          PIC  X(11)                   ELCDTECX
  8192                                          VALUE 'STATE NAMES'.    ELCDTECX
  8193 01  STATE-NAMES.                                                 ELCDTECX
  8194     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8195         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8196         16  STATE-PIC1.                                          ELCDTECX
  8197             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8198             20  FILLER              PIC  XXX.                    ELCDTECX
  8199             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8200             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8201             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8202             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8203                                                                  ELCDTECX
  8204 01  FILLER                          PIC  X(13)                   ELCDTECX
  8205                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8206 01  CARRIER-NAMES.                                               ELCDTECX
  8207     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8208         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8209         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8210         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8211         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8212         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8213         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8214*        16  FILLER                  PIC  X.                      ELCDTECX
  8215         16  CARRIER-SEC-PAY         PIC  X.
  8216             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8217                                                                  ELCDTECX
  8218 01  FILLER                          PIC  X(9)                       CL**6
  8219                                          VALUE 'INS TYPES'.      ELCDTECX
  8220 01  CLAS-INS-TYPES.                                              ELCDTECX
  8221*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8222     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8223         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8224         16  CLAS-I-AB3.                                          ELCDTECX
  8225             20  FILLER              PIC  X.                      ELCDTECX
  8226             20  CLAS-I-AB2.                                      ELCDTECX
  8227                 24  FILLER          PIC  X.                      ELCDTECX
  8228                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8229         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8230             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8231             20  FILLER              PIC  X.                         CL**4
  8232         16  CLAS-I-AB10.                                         ELCDTECX
  8233             20  FILLER              PIC  X(9).                   ELCDTECX
  8234             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8235         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8236         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8237         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8238         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8239             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8240         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8241         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8242         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8243         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8244         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8245         16  FILLER                  PIC  X(05).
  8246                                                                  ELCDTECX
  8247 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8248                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8249 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8250     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8251                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8252         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8253         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8254         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8255         16  CLAS-MORT-DESC.                                      ELCDTECX
  8256             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8257             20  FILLER              PIC  XX.                        CL**5
  8258             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8259             20  FILLER              PIC  X.                         CL**5
  8260             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8261             20  FILLER              PIC  X.                         CL**5
  8262             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8263             20  FILLER              PIC  X.                         CL**5
  8264             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8265             20  FILLER              PIC  X(5).                      CL**6
  8266                                                                  ELCDTECX
  8267 01  FILLER                          PIC  X(15)                   ELCDTECX
  8268                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8269 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8270     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8271         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8272         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8273         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8274         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8275         16  FILLER                  PIC  X(4).                      CL**6
  8276                                                                  ELCDTECX
  8277 01  FILLER                          PIC  X(7)                       CL**6
  8278                                     VALUE 'INDEXES'.             ELCDTECX
  8279 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8280     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8281     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8282     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8283     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8284     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8285     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8286     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8287     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8288     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8289     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8290     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8291     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8292     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8293     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8294     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8295     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8296     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8297                                                                  ELCDTECX
  8298 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8299     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8300     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8301     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8302     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8303     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8304     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8305     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8306     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8307     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8308     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8309     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8310                                                                  ELCDTECX
  8311 01  FILLER                          PIC  X(13)                   ELCDTECX
  8312                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8313 01  CLAS-MISC.                                                   ELCDTECX
  8314     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8315         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8316         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8317         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8318     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8319     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8320     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8321     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8322     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8323     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8324     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8325     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8326     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8327     12  STATE-L                     PIC  XX.                     ELCDTECX
  8328     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8329     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8330     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8331         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8332         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8333     12  DTE-ABEND-WORK.                                          ELCDTECX
  8334         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8335         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8336                                                                  ELCDTECX
  8337 01  FILLER                          PIC  X(12)                   ELCDTECX
  8338                                     VALUE 'WORKING DATE'.        ELCDTECX
  8339 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8340     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8341         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8342         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8343         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8344     12  WS-CURRENT-DATE.                                         ELCDTECX
  8345         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8346         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8347         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8348         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8349         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8350     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8351         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8352         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8353                                                                  ELCDTECX
  8354 01  FILLER                          PIC  X(12)                   ELCDTECX
  8355                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8356 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8357     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8358         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8359         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8360         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8361                                                                  ELCDTECX
  8362 01  FILLER                          PIC  X(10)                   ELCDTECX
  8363                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8364 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8365     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8366         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8367         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8368                                                                  ELCDTECX
  8369 01  FILLER                          PIC  X(13)                   ELCDTECX
  8370                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8371 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8372     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8373         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8374                                                                  ELCDTECX
  8375 01  FILLER                          PIC  X(13)                   ELCDTECX
  8376                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8377 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8378     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8379     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8380     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8381                                     PIC  X.                         CL**5
  8382     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8383     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8384     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8385     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8386     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8387     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8388     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8389     12  FILLER                      PIC  X(75).                  ELCDTECX
  8390******************************************************************ELCDTECX
  8391*01  MISC-CARR-PCT-DATA.                                          00001521
  8392*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8393*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8394*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8395*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8396*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8397*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8398******************************************************************ELCDTECX
  8399
* 8400                                  COPY ELCDTEVR.
  8401***************************************************************** 04/15/98
  8402*                                                                *ELCDTEVR
  8403*                                                                *ELCDTEVR
  8404*                            ELCDTEVR.                           *   LV003
  8405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8406*                            VMOD=2.001                          *   CL**2
  8407*                                                                *ELCDTEVR
  8408*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8409*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8410*                                                                *ELCDTEVR
  8411******************************************************************ELCDTEVR
  8412 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8413     05  WS-RUN-DATE.                                             ELCDTEVR
  8414         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8415         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8416         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8417             15  RUN-CC              PIC  99.                     ELCDTEVR
  8418             15  RUN-YR              PIC  99.                     ELCDTEVR
  8419         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8420         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8421     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8422            WS-RUN-DATE              PIC 9(11).                      CL**2
  8423     05  WS-EP-DT.                                                ELCDTEVR
  8424         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8425         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8426         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8427             15  EP-CC               PIC  99.                     ELCDTEVR
  8428             15  EP-YR               PIC  99.                     ELCDTEVR
  8429         10  EP-MO                   PIC  99.                     ELCDTEVR
  8430         10  EP-DA                   PIC  99.                     ELCDTEVR
  8431     05  WS-EP-DT-N REDEFINES                                        CL**2
  8432            WS-EP-DT                 PIC 9(11).                      CL**2
  8433     05  WS-DTE-CONV-DT.                                             CL**4
  8434         10  FILLER                  PIC  9(03).                     CL**4
  8435         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8436         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8437             15  DTE-CONV-CC         PIC  99.                        CL**4
  8438             15  DTE-CONV-YR         PIC  99.                        CL**4
  8439         10  DTE-CONV-MO             PIC  99.                        CL**4
  8440         10  DTE-CONV-DA             PIC  99.                        CL**4
  8441     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8442            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8443 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8444     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8445         10  FILLER                            PIC 999.           ELCDTEVR
  8446         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8447         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8448             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8449             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8450         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8451         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8452     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8453            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8454     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8455         10  FILLER                            PIC 999.           ELCDTEVR
  8456         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8457         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8458         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8459         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8460     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8461            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8462 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8463     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8464         10  FILLER                            PIC 999.           ELCDTEVR
  8465         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8466         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8467             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8468             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8469         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8470         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8471     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8472            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8473     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8474         10  FILLER                            PIC 999.           ELCDTEVR
  8475         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8476         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8477             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8478             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8479         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8480         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8481     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8482            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8483     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8484         10  FILLER                            PIC 999.           ELCDTEVR
  8485         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8486         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8487             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8488             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8489         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8490         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8491     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8492            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8493 01  WS-RATE-RECORD.                                              ELCDTEVR
  8494         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8495             10  FILLER                        PIC 999.           ELCDTEVR
  8496             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8497             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8498                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8499                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8500             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8501             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8502         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8503                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8504
* 8505                                  COPY ELCREINV.
  8506******************************************************************04/18/98
  8507*                                                                *ELCREINV
  8508*                                                                *ELCREINV
  8509*                            ELCREINV                            *   LV003
  8510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8511*                            VMOD=2.001                          *ELCREINV
  8512*                                                                *ELCREINV
  8513*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8514*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8515*                                                                *ELCREINV
  8516******************************************************************ELCREINV
  8517                                                                  ELCREINV
  8518 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8519     05  WS-RE-LO-DATE.                                              CL**3
  8520         10 FILLER                     PIC 999.                      CL**3
  8521         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8522         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8523            15 RE-LO-CC                PIC 99.                       CL**3
  8524            15 RE-LO-YR                PIC 99.                       CL**3
  8525         10 RE-LO-MO                   PIC 99.                       CL**3
  8526         10 RE-LO-DA                   PIC 99.                       CL**3
  8527     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8528            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8529     05  WS-RE-HI-DATE.                                              CL**3
  8530         10 FILLER                     PIC 999.                      CL**3
  8531         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8532         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8533            15 RE-HI-CC                PIC 99.                       CL**3
  8534            15 RE-HI-YR                PIC 99.                       CL**3
  8535         10 RE-HI-MO                   PIC 99.                       CL**3
  8536         10 RE-HI-DA                   PIC 99.                       CL**3
  8537     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8538            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8539     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8540         10 FILLER                     PIC 999.                   ELCREINV
  8541         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8542         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8543            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8544            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8545         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8546         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8547     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8548            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8549     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8550         10  FILLER                    PIC 999.                   ELCREINV
  8551         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8552         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8553             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8554             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8555         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8556         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8557     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8558            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8559     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8560         10  FILLER                    PIC 999.                   ELCREINV
  8561         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8562         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8563             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8564             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8565         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8566         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8567     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8568            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8569
* 8570                                  COPY ELCACCTV.
  8571******************************************************************04/14/98
  8572*                                                                *ELCACCTV
  8573*                            ELCACCTV                            *   LV002
  8574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8575*                            VMOD=2.001                          *ELCACCTV
  8576*                                                                *ELCACCTV
  8577*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8578*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8579*                                                                *ELCACCTV
  8580*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8581*                                                                *ELCACCTV
  8582******************************************************************ELCACCTV
  8583                                                                  ELCACCTV
  8584 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8585                                                                  ELCACCTV
  8586     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8587         10  FILLER            PIC 999.                           ELCACCTV
  8588         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8589         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8590             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8591             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8592         10  AM-EXP-MO         PIC 99.                               CL**5
  8593         10  AM-EXP-DA         PIC 99.                               CL**5
  8594     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8595            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 157
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8596     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8597         10  FILLER                    PIC 999.                   ELCACCTV
  8598         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8599         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8600             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8601             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8602         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8603         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8604     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8605            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8606     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8607         10  FILLER                    PIC 999.                   ELCACCTV
  8608         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8609         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8610             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8611             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8612         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8613         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8614     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8615            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8616     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8617         10 FILLER                     PIC 999.                   ELCACCTV
  8618         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8619         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8620            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8621            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8622         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8623         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8624     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8625            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8626     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8627         10 FILLER                     PIC 999.                   ELCACCTV
  8628         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8629         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8630            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8631            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8632         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8633         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8634     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8635            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8636     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8637         10  FILLER                    PIC 999.                   ELCACCTV
  8638         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8639         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8640             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8641             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8642         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8643         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8644     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8645            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8646     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8647         10  FILLER                    PIC 999.                   ELCACCTV
  8648         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8649         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8650             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8651             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8652         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8653         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 158
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8654     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8655            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8656     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8657         10  FILLER                    PIC 999.                   ELCACCTV
  8658         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8659         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8660             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8661             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8662         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8663         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8664     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8665            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8666     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8667         10  FILLER                    PIC 999.                   ELCACCTV
  8668         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8669         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8670             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8671             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8672         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8673         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8674     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8675            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 159
* EL517.cbl
* 8677                                  COPY ELCDIFRD.
  8678******************************************************************04/15/98
  8679*                                                                *ELCDIFRD
  8680*                                                                *ELCDIFRD
  8681*                            ELCDIFRD.                           *   LV003
  8682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8683*                            VMOD=2.004                          *   CL**3
  8684*                                                                *ELCDIFRD
  8685*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8686*                                                                *ELCDIFRD
  8687******************************************************************ELCDIFRD
  8688*                                                                 ELCDIFRD
  8689  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8690        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8691        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8692        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8693        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8694        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8695        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8696        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8697        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8698        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8699        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8700        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 160
* EL517.cbl
* 8702                                  COPY ELCERRWS.
  8703******************************************************************04/15/98
  8704*                                                                *ELCERRWS
  8705*                                                                *ELCERRWS
  8706*                            ELCERRWS                            *   LV002
  8707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8708*                            VMOD=2.005                          *   CL**2
  8709*                                                                *ELCERRWS
  8710*                                                                *ELCERRWS
  8711*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8712*                                                                *ELCERRWS
  8713******************************************************************ELCERRWS
  8714                                                                  ELCERRWS
  8715 01  W-ERROR-WORK.                                                ELCERRWS
  8716     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8717     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8718     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8719     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8720     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8721     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8722     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8723     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8724     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8725     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8726     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8727     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8728     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8729     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8730     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8731     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8732     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8733                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 161
* EL517.cbl
  8735
  8736 PROCEDURE DIVISION.
  8737
  8738 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8739******************************************************************04/15/98
  8740*                                                                *ELCDTERX
  8741*                                                                *ELCDTERX
  8742*                            ELCDTERX.                           *   LV002
  8743*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8744*                            VMOD=2.007                          *ELCDTERX
  8745*                                                                *ELCDTERX
  8746*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8747*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8748*      = ELCDTEFD)                                               *ELCDTERX
  8749*                                                                *ELCDTERX
  8750******************************************************************ELCDTERX
  8751                                                                  ELCDTERX
  8752     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8753                                                                  ELCDTERX
  8754     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8755     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8756     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8757                                                                  ELCDTERX
  8758     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8759                                                                  ELCDTERX
  8760******************************************************************ELCDTERX
  8761*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8762*          WARNING MESSAGES.                                      ELCDTERX
  8763******************************************************************ELCDTERX
  8764     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8765         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8766                                                                  ELCDTERX
  8767     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8768                                                                  ELCDTERX
  8769     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8770                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8771                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8772                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8773                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8774                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8775                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8776                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8777                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8778                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8779                                                                  ELCDTERX
  8780     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8781                                                                  ELCDTERX
  8782     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8783                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8784                                                                  ELCDTERX
  8785     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8786     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8787     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8788     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8789                                                                  ELCDTERX
  8790     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8791         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8792     ELSE                                                         ELCDTERX
  8793         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8794                                                                  ELCDTERX
  8795     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8796         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8797     ELSE                                                         ELCDTERX
  8798         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8799                                                                  ELCDTERX
  8800 0005-READ--CARD.                                                 ELCDTERX
  8801     READ DISK-DATE                                               ELCDTERX
  8802         AT END CLOSE DISK-DATE                                   ELCDTERX
  8803             GO TO 0060-READ--TEST.                               ELCDTERX
  8804                                                                  ELCDTERX
  8805     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8806                                                                  ELCDTERX
  8807     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8808         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8809         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8810         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8811         GO TO 0005-READ--CARD.                                   ELCDTERX
  8812                                                                  ELCDTERX
  8813     IF DD-ID = 'CLAD'                                            ELCDTERX
  8814         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8815         GO TO 0005-READ--CARD.                                   ELCDTERX
  8816                                                                  ELCDTERX
  8817     IF DD-ID = 'CLAX'                                            ELCDTERX
  8818         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8819         GO TO 0005-READ--CARD.                                   ELCDTERX
  8820                                                                  ELCDTERX
  8821     IF DD-ID = 'CLAF'                                            ELCDTERX
  8822         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8823         GO TO 0005-READ--CARD.                                   ELCDTERX
  8824                                                                  ELCDTERX
  8825     IF DD-ID = 'CLAC'                                            ELCDTERX
  8826         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8827                                                                  ELCDTERX
  8828     IF DD-ID = 'CARR'                                            ELCDTERX
  8829         GO TO 0015-READ--CARR.                                   ELCDTERX
  8830                                                                  ELCDTERX
  8831     IF DD-ID = 'STAT'                                            ELCDTERX
  8832         GO TO 0020-READ--STAT.                                   ELCDTERX
  8833                                                                  ELCDTERX
  8834     IF DD-ID = 'BUSC'                                            ELCDTERX
  8835         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8836                                                                  ELCDTERX
  8837     IF DD-ID = 'MORT'                                            ELCDTERX
  8838         GO TO 0030-READ--MORT.                                   ELCDTERX
  8839                                                                  ELCDTERX
  8840     IF DD-ID = 'CLAI'                                            ELCDTERX
  8841         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8842                                                                  ELCDTERX
  8843     IF DD-ID = 'COLC'                                            ELCDTERX
  8844         GO TO 0065-READ--COLC.                                   ELCDTERX
  8845                                                                  ELCDTERX
  8846     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8847        DD-IDA = 'CL'                                             ELCDTERX
  8848         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8849                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8850     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8851        DD-IDA = 'PO'                                             ELCDTERX
  8852         GO TO 0050-READ--POXX.                                   ELCDTERX
  8853                                                                  ELCDTERX
  8854     IF DD-ID = 'OPCA'                                            ELCDTERX
  8855         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8856                                                                  ELCDTERX
  8857     IF DD-ID = 'OPST'                                            ELCDTERX
  8858         GO TO 0072-READ--OPST.                                   ELCDTERX
  8859                                                                  ELCDTERX
  8860     IF DD-ID = 'OPBS'                                            ELCDTERX
  8861         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8862                                                                  ELCDTERX
  8863     IF DD-ID = 'OPMS'                                            ELCDTERX
  8864         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8865                                                                  ELCDTERX
  8866     GO TO 0005-READ--CARD.                                       ELCDTERX
  8867                                                                  ELCDTERX
  8868 0010-READ--CLAC.                                                 ELCDTERX
  8869     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8870     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8871     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8872     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8873     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8874     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8875     GO TO 0005-READ--CARD.                                       ELCDTERX
  8876                                                                  ELCDTERX
  8877 0015-READ--CARR.                                                 ELCDTERX
  8878     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8879     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8880        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8881        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8882        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8883        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8884        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8885        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8886        MOVE DD-CARR1-SECPAY-SW
  8887                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8888     END-IF
  8889                                                                  ELCDTERX
  8890     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8891     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8892        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8893        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8894        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8895        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8896        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8897        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8898        MOVE DD-CARR2-SECPAY-SW
  8899                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8900     END-IF
  8901                                                                  ELCDTERX
  8902                                                                  ELCDTERX
  8903     GO TO 0005-READ--CARD.                                       ELCDTERX
  8904                                                                  ELCDTERX
  8905 0020-READ--STAT.                                                 ELCDTERX
  8906     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8907     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8908        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8909         GO TO 0005-READ--CARD.                                   ELCDTERX
  8910                                                                  ELCDTERX
  8911     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8912     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8913     GO TO 0020-READ--STAT.                                       ELCDTERX
  8914                                                                  ELCDTERX
  8915 0025-READ--BUSC.                                                 ELCDTERX
  8916     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8917     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8918        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8919         GO TO 0005-READ--CARD.                                   ELCDTERX
  8920                                                                  ELCDTERX
  8921     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8922     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8923     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8924                                                                  ELCDTERX
  8925 0030-READ--MORT.                                                 ELCDTERX
  8926     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8927     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8928        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8929         GO TO 0005-READ--CARD.                                   ELCDTERX
  8930                                                                  ELCDTERX
  8931     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8932     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8933     GO TO 0030-READ--MORT.                                       ELCDTERX
  8934                                                                  ELCDTERX
  8935 0035-READ--CLXX.                                                 ELCDTERX
  8936     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8937          GO TO 0005-READ--CARD.                                  ELCDTERX
  8938                                                                  ELCDTERX
  8939     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8940         DISPLAY '***********************************************'ELCDTERX
  8941         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8942         DISPLAY '***********************************************'ELCDTERX
  8943         GO TO 0055-READ--STOP.                                   ELCDTERX
  8944                                                                  ELCDTERX
  8945     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8946        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8947         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8948                                                                  ELCDTERX
  8949     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8950        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8951         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8952                                                                  ELCDTERX
  8953*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8954     GO TO 0005-READ--CARD.                                       ELCDTERX
  8955                                                                  ELCDTERX
  8956 0040-READ--CLAI.                                                 ELCDTERX
  8957     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8958     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8959        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8960         GO TO 0005-READ--CARD.                                   ELCDTERX
  8961                                                                  ELCDTERX
  8962     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8963     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8964     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8965                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 165
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8966 0045-READ--DUMP.                                                 ELCDTERX
  8967     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8968     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8969                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8970     PERFORM ABEND-PGM.                                           ELCDTERX
  8971                                                                  ELCDTERX
  8972 0050-READ--POXX.                                                 ELCDTERX
  8973     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8974         GO TO 0005-READ--CARD.                                   ELCDTERX
  8975                                                                  ELCDTERX
  8976     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8977         DISPLAY '***********************************************'ELCDTERX
  8978         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8979         DISPLAY '***********************************************'ELCDTERX
  8980         GO TO 0055-READ--STOP.                                   ELCDTERX
  8981                                                                  ELCDTERX
  8982     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8983     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8984     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8985     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8986                                                                  ELCDTERX
  8987     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8988         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8989     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8990         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8991                                                                  ELCDTERX
  8992     GO TO 0005-READ--CARD.                                       ELCDTERX
  8993                                                                  ELCDTERX
  8994 0055-READ--STOP.                                                 ELCDTERX
  8995     GOBACK.                                                      ELCDTERX
  8996                                                                  ELCDTERX
  8997 0060-READ--TEST.                                                 ELCDTERX
  8998     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8999        CLAX-ID         = SPACE  OR                               ELCDTERX
  9000        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  9001         GO TO 0045-READ--DUMP.                                   ELCDTERX
  9002                                                                  ELCDTERX
  9003     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  9004     GO TO 0079-READ--EXIT.                                       ELCDTERX
  9005                                                                  ELCDTERX
  9006 0065-READ--COLC.                                                 ELCDTERX
  9007     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  9008     GO TO 0005-READ--CARD.                                       ELCDTERX
  9009                                                                  ELCDTERX
  9010 0070-READ--OPCA.                                                 ELCDTERX
  9011                                                                  ELCDTERX
  9012     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9013                                                                  ELCDTERX
  9014     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  9015             OR                                                   ELCDTERX
  9016         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  9017         GO TO 0005-READ--CARD.                                   ELCDTERX
  9018                                                                  ELCDTERX
  9019     ADD 1                       TO INDEXCA.                      ELCDTERX
  9020     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  9021                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  9022     GO TO 0070-READ--OPCA.                                       ELCDTERX
  9023                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 166
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  9024 0072-READ--OPST.                                                 ELCDTERX
  9025                                                                  ELCDTERX
  9026     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9027                                                                  ELCDTERX
  9028     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  9029             OR                                                   ELCDTERX
  9030         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9031         GO TO 0005-READ--CARD.                                   ELCDTERX
  9032                                                                  ELCDTERX
  9033     ADD 1                       TO INDEXST.                      ELCDTERX
  9034     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  9035                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  9036     GO TO 0072-READ--OPST.                                       ELCDTERX
  9037                                                                  ELCDTERX
  9038 0074-READ--OPBS.                                                 ELCDTERX
  9039                                                                  ELCDTERX
  9040     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9041                                                                  ELCDTERX
  9042     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  9043             OR                                                   ELCDTERX
  9044         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9045         GO TO 0005-READ--CARD.                                   ELCDTERX
  9046                                                                  ELCDTERX
  9047     ADD 1                       TO INDEXBS.                      ELCDTERX
  9048     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  9049     GO TO 0074-READ--OPBS.                                       ELCDTERX
  9050                                                                  ELCDTERX
  9051 0079-READ--EXIT.                                                 ELCDTERX
  9052*    EXIT.                                                        ELCDTERX
  9053******************************************************************ELCDTERX
  9054
  9055     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9056
  9057     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9058     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9059     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9060
  9061     MOVE 4                      TO DC-OPTION-CODE.
  9062     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9063     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9064     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9065     MOVE WORK-AREAS             TO HOLD-WORK.
  9066
  9067     IF DTE-PRC-OPT = '2'
  9068         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9069
  9070     OPEN INPUT ELCNTL.
  9071     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9072         NEXT SENTENCE
  9073       ELSE
  9074         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9075         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9076         MOVE EMSG               TO WS-ABEND-MESSAGE
  9077         GO TO ABEND-PGM.
  9078
  9079     OPEN  I-O ERPNDB.
  9080     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9081         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 167
* EL517.cbl
  9082       ELSE
  9083         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9084         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9085         MOVE EMSG               TO WS-ABEND-MESSAGE
  9086         GO TO ABEND-PGM.
  9087
  9088     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9089     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9090
  9091     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9092
  9093     IF ERPNDB-FILE-STATUS NOT = '00'
  9094         GO TO 9999-DONE.
  9095
  9096     OPEN INPUT ERREIN.
  9097     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9098         NEXT SENTENCE
  9099       ELSE
  9100         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9101         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9102         MOVE EMSG               TO WS-ABEND-MESSAGE
  9103         GO TO ABEND-PGM.
  9104
  9105     IF DTE-CLIENT = 'DCC'
  9106        OPEN INPUT ERPDEF ELSTAT
  9107        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9108           CONTINUE
  9109        ELSE
  9110           MOVE ERPDEF-FILE-STATUS
  9111                                 TO WS-ABEND-FILE-STATUS
  9112           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9113           MOVE EMSG             TO WS-ABEND-MESSAGE
  9114           GO TO ABEND-PGM
  9115        END-IF
  9116        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9117           CONTINUE
  9118        ELSE
  9119           MOVE ELSTAT-FILE-STATUS
  9120                                 TO WS-ABEND-FILE-STATUS
  9121           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9122           MOVE EMSG             TO WS-ABEND-MESSAGE
  9123           GO TO ABEND-PGM
  9124        END-IF
  9125     END-IF
  9126
  9127     OPEN I-O   ELCERT.
  9128******************************************************************
  9129*                                                                *
  9130*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9131*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9132*                                                                *
  9133*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9134*                                                                *
  9135*               EL631 - EL6311 - EL6312 - EL6313                 *
  9136*                                                                *
  9137******************************************************************
  9138
  9139     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 168
* EL517.cbl
  9140         NEXT SENTENCE
  9141       ELSE
  9142         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9143         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9144         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9145         GO TO ABEND-PGM.
  9146
  9147     OPEN INPUT ERCTBL.
  9148     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9149         NEXT SENTENCE
  9150       ELSE
  9151         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9152         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9153         MOVE EMSG               TO WS-ABEND-MESSAGE
  9154         GO TO ABEND-PGM.
  9155
  9156     OPEN INPUT ERACCT.
  9157     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9158         NEXT SENTENCE
  9159       ELSE
  9160         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9161         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9162         MOVE EMSG               TO WS-ABEND-MESSAGE
  9163         GO TO ABEND-PGM.
  9164
  9165     OPEN INPUT ERCOMP.
  9166     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9167         NEXT SENTENCE
  9168       ELSE
  9169         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9170         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9171         MOVE EMSG               TO WS-ABEND-MESSAGE
  9172         GO TO ABEND-PGM.
  9173
  9174     OPEN INPUT ERLOFC
  9175     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9176        CONTINUE
  9177     ELSE
  9178        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9179        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9180        MOVE EMSG                TO WS-ABEND-MESSAGE
  9181        GO TO ABEND-PGM
  9182     END-IF
  9183
  9184     OPEN INPUT ERBXRF.
  9185     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9186         NEXT SENTENCE
  9187       ELSE
  9188         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9189         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9190         MOVE EMSG               TO WS-ABEND-MESSAGE
  9191         GO TO ABEND-PGM.
  9192
  9193     OPEN INPUT ERAGTC.
  9194     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9195         NEXT SENTENCE
  9196       ELSE
  9197         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 169
* EL517.cbl
  9198         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9199         MOVE EMSG               TO WS-ABEND-MESSAGE
  9200         GO TO ABEND-PGM.
  9201
  9202     OPEN INPUT ERPLAN.
  9203     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9204        NEXT SENTENCE
  9205     ELSE
  9206        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9207        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9208        MOVE EMSG                TO WS-ABEND-MESSAGE
  9209        GO TO ABEND-PGM.
  9210
  9211     OPEN INPUT ERFORM.
  9212     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9213        OR '9%'
  9214        NEXT SENTENCE
  9215     ELSE
  9216        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9217        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9218        MOVE EMSG                TO WS-ABEND-MESSAGE
  9219        GO TO ABEND-PGM.
  9220
  9221     OPEN INPUT ELCERR.
  9222     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9223         NEXT SENTENCE
  9224       ELSE
  9225         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9226         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9227         MOVE EMSG               TO WS-ABEND-MESSAGE
  9228         GO TO ABEND-PGM.
  9229
  9230     MOVE 'R'                     TO CP-RATE-FILE.
  9231     MOVE 'O'                     TO CP-IO-FUNCTION.
  9232     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9233
  9234     IF IO-ERROR
  9235        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9236        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9237        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9238        GO TO ABEND-PGM.
  9239
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 170
* EL517.cbl
  9241*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9242*
  9243     IF DTE-CLIENT NOT = 'DMD'
  9244         GO TO 0100-READ-PENDING.
  9245
  9246     OPEN INPUT ERRESS ERRESC.
  9247
  9248     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9249         NEXT SENTENCE
  9250     ELSE
  9251         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9252         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9253         MOVE EMSG               TO WS-ABEND-MESSAGE
  9254         GO TO ABEND-PGM.
  9255
  9256     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9257         NEXT SENTENCE
  9258     ELSE
  9259         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9260         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9261         MOVE EMSG               TO WS-ABEND-MESSAGE
  9262         GO TO ABEND-PGM.
  9263
  9264     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9265     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9266     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9267     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9268         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9269         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9270         MOVE EMSG               TO WS-ABEND-MESSAGE
  9271         GO TO ABEND-PGM.
  9272
  9273     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9274     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9275     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9276     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9277         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9278         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9279         MOVE EMSG               TO WS-ABEND-MESSAGE
  9280         GO TO ABEND-PGM.
  9281
  9282     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9283     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9284     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9285     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9286         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9287         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9288         MOVE EMSG               TO WS-ABEND-MESSAGE
  9289         GO TO ABEND-PGM.
  9290
  9291     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9292     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9293     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9294     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9295         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9296         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9297         MOVE EMSG               TO WS-ABEND-MESSAGE
  9298         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 171
* EL517.cbl
  9299
  9300     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9301     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9302     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9303     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9304         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9305         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9306         MOVE EMSG               TO WS-ABEND-MESSAGE
  9307         GO TO ABEND-PGM.
  9308
  9309     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9310     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9311     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9312     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9313         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9314         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9315         MOVE EMSG               TO WS-ABEND-MESSAGE
  9316         GO TO ABEND-PGM.
  9317
  9318     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9319     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9320     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9321     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9322         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9323         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9324         MOVE EMSG               TO WS-ABEND-MESSAGE
  9325         GO TO ABEND-PGM.
  9326
  9327*
  9328*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9329*
  9330 0100-READ-PENDING.
  9331
  9332     MOVE HOLD-WORK TO WORK-AREAS.
  9333
  9334     MOVE ZEROS                  TO EMI-WARNING-CTR
  9335                                    EMI-FORCABLE-CTR
  9336                                    EMI-FATAL-CTR.
  9337 0101-READ-PENDING.
  9338     READ ERPNDB.
  9339     ADD 1 TO RPND.
  9340
  9341     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9342         GO TO 9999-DONE.
  9343
  9344     IF ERPNDB-FILE-STATUS NOT = '00'
  9345         GO TO 9999-DONE.
  9346
  9347     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9348     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9349     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9350
  9351     IF PB-BATCH-TRAILER
  9352         GO TO 9999-REWRITE-RECORD.
  9353
  9354     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9355        GO TO 0100-READ-PENDING.
  9356
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 172
* EL517.cbl
  9357     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9358        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9359        GO TO 0100-READ-PENDING.
  9360
  9361     IF WK-BATCH-PREFIX = '#CL'
  9362        GO TO 0100-READ-PENDING.
  9363
  9364     IF DTE-PRC-OPT = '2'
  9365         NEXT SENTENCE
  9366     ELSE
  9367         IF NOT PB-FATAL-ERRORS
  9368             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9369             GO TO 0100-READ-PENDING.
  9370
  9371     ADD 1 TO TRAN-CT.
  9372
  9374 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 173
* EL517.cbl
*                           COPY ELC50PD.
  9375******************************************************************04/22/98
  9376*                                                                *ELC50PD
  9377*                            ELC50PD                             *   LV012
  9378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9379*                            VMOD=2.188                          *   CL**7
  9380*                                                                *ELC50PD
  9381******************************************************************
  9382*                   C H A N G E   L O G
  9383*
  9384* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9385*-----------------------------------------------------------------
  9386*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9387* EFFECTIVE    NUMBER
  9388*-----------------------------------------------------------------
  9389* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9390* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9391* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9392*                             2709 AND 2718
  9393* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9394* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9395* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9396* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9397* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9398*                                IS OPEN OR CNC DT < PD THRU
  9399* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9400* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9401* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9402* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9403* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9404* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9405* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9406* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9407* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9408* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9409* 020906                   PEMA  EXPAND LOAN OFFICER
  9410* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9411* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9412* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9413* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9414* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9415* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9416* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9417* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9418* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9419* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9420* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9421* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9422* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9423* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9424* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9425* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9426* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9427* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9428* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9429* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9430* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9431* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 174
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9432* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9433* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9434* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9435*                                UPDATE VIN ON CERT TRAILER
  9436* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9437* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9438* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9439* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9440* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9441* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9442* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9443* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9444* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9445* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9446* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9447* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9448* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9449* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9450* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9451* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9452* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9453* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9454* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9455* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9456* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9457* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9458* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9459* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9460* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9461* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9462* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9463* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9464* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9465* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9466* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9467* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9468* 032912  CR2011110200001  PEMA  AHL CHANGES
  9469* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9470* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9471* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9472* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9473* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  9474* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9475* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9476* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9477* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9478* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9479* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9480* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9481* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9482* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9483* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  9484* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  9485* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  9486* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  9487* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  9488* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  9489* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 175
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9490******************************************************************ELC50PD
  9491************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9492******************************************************************ELC50PD
  9493                                                                  ELC50PD
  9494     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9495                                                                  ELC50PD
  9496     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9497                                    PB-FORCE-ER-CD                ELC50PD
  9498                                    PB-WARN-ER-CD                 ELC50PD
  9499                                    PB-OUT-BAL-CD.                ELC50PD
  9500                                                                  ELC50PD
  9501     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9502                                    WS-IG-OVRD-LF                 ELC50PD
  9503                                    WS-IG-OVRD-AM                 ELC50PD
  9504                                    WS-IG-OVRD                    ELC50PD
  9505                                    WS-IG-OVRD-AH-PL              ELC50PD
  9506                                    WS-IG-OVRD-LF-PL              ELC50PD
  9507                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9508                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9509                                                                  ELC50PD
  9510******************************************************************ELC50PD
  9511*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9512******************************************************************ELC50PD
  9513                                                                  ELC50PD
  9514     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9515     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9516                                                                  ELC50PD
  9517******************************************************************ELC50PD
  9518                                                                  ELC50PD
  9519     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9520     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9521*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9522     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9523     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9524                                                                  ELC50PD
  9525     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9526                                                                  ELC50PD
  9527 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9528                                                                  ELC50PD
  9529     ADD +1                      TO  SUB4.                        ELC50PD
  9530                                                                  ELC50PD
  9531     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9532         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9533                                                                  ELC50PD
  9534     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9535         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9536                                                                  ELC50PD
  9537     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9538                                                                  ELC50PD
  9539 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9540                                                                  ELC50PD
  9541     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9542        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9543                                         WS-AH-REM-TERM-CALC      ELC50PD
  9544                                         EC-CO-REM-TERM-CALC      ELC50PD
  9545        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9546        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9547        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 176
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9548                                         WS-TOL-AH-CLAIM          ELC50PD
  9549        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9550                                         WS-TOL-AH-PREM           ELC50PD
  9551                                         EC-CO-TOL-PREM           ELC50PD
  9552        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9553                                         WS-TOL-AH-REFUND         ELC50PD
  9554                                         EC-CO-TOL-REFUND         ELC50PD
  9555        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9556                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9557                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9558        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9559                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9560                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9561        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9562                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9563                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9564        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9565                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9566                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9567        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9568        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9569        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9570        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9571        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9572        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9573        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9574        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9575        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9576        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9577        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9578        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9579                                         EC-CO-MONTH-END-DT       ELC50PD
  9580        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9581          GO TO 0100-READ-ACCT.                                   ELC50PD
  9582                                                                  ELC50PD
  9583     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9584     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9585     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9586     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9587                                                                  ELC50PD
  9588     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9589     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9590     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9591         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9592                                   WK-CO-TOL-CLAIM                ELC50PD
  9593                                   WK-CO-TOL-REFUND               ELC50PD
  9594                                   WK-REFUND-OVS-AMT              ELC50PD
  9595                                   WK-REFUND-OVS-PCT              ELC50PD
  9596                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9597                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9598                                   WK-DEFAULT-APR                 ELC50PD
  9599                                   WK-CO-MAX-CAP                  ELC50PD
  9600        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9601                                   WK-CR-R78-METHOD               ELC50PD
  9602                                   WK-CO-REF-REJECT-SW            ELC50PD
  9603                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9604                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9605                                   WK-BIRTH-DATE-INPUT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 177
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9606                                   WK-JOINT-AGE-INPUT             ELC50PD
  9607        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9608        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9609        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9610        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9611          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9612                                                                  ELC50PD
  9613     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9614        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9615     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9616        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9617     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9618        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9619     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9620        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9621                                                                  ELC50PD
  9622     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9623     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9624     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9625     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9626     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9627     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9628     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9629     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9630     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9631     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9632     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9633     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9634                                                                  ELC50PD
  9635     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9636          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9637        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9638                                                                  ELC50PD
  9639     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9640          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9641        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9642                                                                  ELC50PD
  9643     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9644         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9645     ELSE                                                         ELC50PD
  9646         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9647                                                                  ELC50PD
  9648     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9649     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9650     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9651     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9652                                                                  ELC50PD
  9653     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9654                                                                  ELC50PD
  9655 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9656                                                                  ELC50PD
  9657     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9658     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9659                                                                  ELC50PD
  9660 0100-READ-ACCT.                                                  ELC50PD
  9661                                                                  ELC50PD
  9662     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9663                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 178
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9664     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9665        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9666                                                                  ELC50PD
  9667     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9668     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9669     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9670                                                                  ELC50PD
  9671     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9672        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9673        GO TO 0105-READ-ACCT
  9674     END-IF
  9675                                                                  ELC50PD
  9676     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9677        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9678           GO TO 0105-READ-ACCT.                                  ELC50PD
  9679                                                                  ELC50PD
  9680     IF PB-STATE NOT = SPACES                                     ELC50PD
  9681        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9682           GO TO 0105-READ-ACCT.                                  ELC50PD
  9683                                                                  ELC50PD
  9684     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9685        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9686           GO TO 0105-READ-ACCT.                                  ELC50PD
  9687                                                                  ELC50PD
  9688     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9689                                                                  ELC50PD
  9690     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9691        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9692        GO TO 0105-READ-ACCT.                                     ELC50PD
  9693                                                                  ELC50PD
  9694     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9695        GO TO 0105-READ-ACCT.                                     ELC50PD
  9696                                                                  ELC50PD
  9697     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9698                                                                  ELC50PD
  9699 0102-ACCT-GETMAIN.                                               ELC50PD
  9700     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9701     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9702                                                                  ELC50PD
  9703 0105-READ-ACCT.                                                  ELC50PD
  9704     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9705     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9706     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9707     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9708     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9709     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9710                                                                  ELC50PD
  9711     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9712                                                                  ELC50PD
  9713     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9714                                                                  ELC50PD
  9715 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9716
  9717     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9718                                                                  ELC50PD
  9719     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9720        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9721        GO TO 0199-ACCT-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 179
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9722     END-IF
  9723     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9724        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9725           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9726                                                                  ELC50PD
  9727     IF PB-STATE NOT = SPACES                                     ELC50PD
  9728        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9729           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9730                                                                  ELC50PD
  9731     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9732        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9733           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9734                                                                  ELC50PD
  9735     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9736                                                                  ELC50PD
  9737     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9738        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9739        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9740                                                                  ELC50PD
  9741     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9742        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9743                                                                  ELC50PD
  9744 0180-ACCOUNT-FOUND.                                              ELC50PD
  9745
  9746     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9747     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9748     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9749     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9750                                                                  ELC50PD
  9751     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9752        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9753                                                                  ELC50PD
  9754     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9755        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9756                                                                  ELC50PD
  9757     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9758        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9759                                                                  ELC50PD
  9760     IF AM-CLP-TOL-PCT NOT NUMERIC
  9761        MOVE +0                  TO AM-CLP-TOL-PCT
  9762     END-IF
  9763     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9764        MOVE +0                  TO AM-SPP-LEASE-COMM
  9765     END-IF
  9766     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9767        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9768        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9769                                                                  ELC50PD
  9770     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9771        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9773                                                                  ELC50PD
  9774     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9775        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9776        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9777        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9778         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9779                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 180
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9780     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9781     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9782     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9783     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9784     IF AM-CLP-TOL-PCT NOT = ZEROS
  9785        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9786     END-IF
  9787     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9788        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9789     END-IF
  9790
  9791
  9792
  9793
  9794*    IF PB-COMPANY-ID = 'DCC'
  9795*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9796*                                   WS-ADMIN-FEES
  9797*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9798*          (SUB5 > +10)
  9799*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9800*             AND (AM-A-COM (SUB5) NUMERIC)
  9801*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9802*                + (AM-A-COM (SUB5) * 1000)
  9803*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9804*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9805*                + (AM-A-COM (SUB5) * 1000)
  9806*             END-IF
  9807*             IF AM-COM-TYP (SUB5) = 'N'
  9808*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9809*                + (AM-A-COM (SUB5) * 1000)
  9810*             END-IF
  9811*          END-IF
  9812*       END-PERFORM
  9813*    END-IF
  9814
  9815     IF (PB-COMPANY-ID = 'DCC')
  9816        AND (PB-ISSUE)
  9817        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9818        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9819           (SUB5 > +10)
  9820           MOVE +0 TO WS-WK-RATE
  9821           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9822              IF (AM-A-COM (SUB5) NUMERIC)
  9823                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9824                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9825              ELSE
  9826                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9827                 IF PB-ISSUE
  9828                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9829                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9830                 ELSE
  9831                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9832                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9833                 END-IF
  9834                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9835                 MOVE ZEROS             TO WS-SUB1
  9836                                           WS-COMMISSION
  9837                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 181
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9838                 MOVE '0530'               TO CTBL-SW
  9839                 MOVE ' '                  TO WS-CTBL-READ-SW
  9840                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9841                 IF FIRST-TIME-THROUGH
  9842                    MOVE 'AA'              TO CTBL-BEN-CODE
  9843                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9844                 END-IF
  9845                 IF CTBL-TABLE-FOUND
  9846                    IF PB-ISSUE
  9847                       COMPUTE WS-COMM-CK-AMT =
  9848                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9849                    ELSE
  9850                       COMPUTE WS-COMM-CK-AMT =
  9851                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9852                    END-IF
  9853                    PERFORM 8800-GET-COMP-RATE
  9854                              THRU 8800-EXIT
  9855                 END-IF
  9856              END-IF
  9857              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9858                + (WS-WK-RATE * 1000)
  9859           END-IF
  9860        END-PERFORM
  9861     END-IF
  9862
  9863     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9864         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9865                                                                  ELC50PD
  9866     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9867         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9868     END-IF
  9869                                                                  ELC50PD
  9870     GO TO 0200-READ-CERT.                                        ELC50PD
  9871                                                                  ELC50PD
  9872 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9873                                                                  ELC50PD
  9874     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9875                                                                  ELC50PD
  9876     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9877        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9879     ELSE                                                         ELC50PD
  9880        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9882                                                                  ELC50PD
  9883     GO TO 9990-RETURN.                                           ELC50PD
  9884                                                                  ELC50PD
  9885 0200-READ-CERT.                                                  ELC50PD
  9886                                                                  ELC50PD
  9887     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9888     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9889     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9890     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9891     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9892     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9893     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9894                                                                  ELC50PD
  9895     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 182
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9896                                                                  ELC50PD
  9897     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9898        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9899                                                                  ELC50PD
  9900     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9901        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9902        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9903        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9904                                                                  ELC50PD
  9905     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9906         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9908         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9909                                                                  ELC50PD
  9910     IF PB-ISSUE                                                  ELC50PD
  9911        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9912           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9913              NEXT SENTENCE                                       ELC50PD
  9914            ELSE                                                  ELC50PD
  9915              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9916              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9917              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9918                                                                  ELC50PD
  9919     IF NOT PB-CANCELLATION                                       ELC50PD
  9920        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9921                                                                  ELC50PD
  9922     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9923     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9924     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9925     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9926     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9927     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9928                                                                  ELC50PD
  9929     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9930     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9931     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9932     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9933     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9934     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9935     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9936     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9937     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9938                                                                  ELC50PD
  9939     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9940     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9941     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9942     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9943     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9944     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9945     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9946                                                                  ELC50PD
  9947     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9948     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9949                                                                  ELC50PD
  9950     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9951                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9952     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9953                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 183
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9954                                                                  ELC50PD
  9955     IF CM-O-B-COVERAGE                                           ELC50PD
  9956         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9957                                                                  ELC50PD
  9958     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9959         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9960                                                                  ELC50PD
  9961     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9962         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9963                                                                  ELC50PD
  9964     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9965         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9966         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9967         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9968         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9969         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9970         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9971         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9972*The next line causes a problem with my change  I dont think it is needed
  9973*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9974                                                                  ELC50PD
  9975     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9976     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9977     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9978     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9979     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9980     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9981                                                                  ELC50PD
  9982     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9983     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9984     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9985     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9986                                                                  ELC50PD
  9987     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9988         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9989     ELSE                                                         ELC50PD
  9990         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9991                                                                  ELC50PD
  9992     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9993         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9994     ELSE                                                         ELC50PD
  9995         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9996                                                                  ELC50PD
  9997     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9998                                                                  ELC50PD
  9999     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
 10000           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
 10001                                                                  ELC50PD
 10002     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
 10003           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
 10004                                                                  ELC50PD
 10005     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
 10006           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
 10007                                                                  ELC50PD
 10008     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
 10009           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
 10010                                                                  ELC50PD
 10011     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 184
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10012           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
 10013                                                                  ELC50PD
 10014     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
 10015     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
 10016     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
 10017     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
 10018     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
 10019     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
 10020     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
 10021     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
 10022     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
 10023     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
 10024     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
 10025     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
 10026                                                                  ELC50PD
 10027     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
 10028         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
 10029                                                                  ELC50PD
 10030     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
 10031         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
 10032                                                                  ELC50PD
 10033     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
 10034                                                                  ELC50PD
 10035     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
 10036        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
 10037        IF CM-ADDL-CLP NOT NUMERIC
 10038           MOVE +0               TO CM-ADDL-CLP
 10039        END-IF
 10040        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
 10041        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10042           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
 10043        END-IF
 10044     END-IF
 10045
 10046     IF PB-COMPANY-ID = 'DCC'
 10047        MOVE +0                  TO WS-ADMIN-FEES
 10048                                    WS-CSO-ADMIN-FEE
 10049                                    WS-COMM-AND-MFEE
 10050                                    WS-1ST-YR-ALLOW
 10051        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
 10052           (SUB5 > +10)
 10053           MOVE +0 TO WS-WK-RATE
 10054           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
 10055              IF (AM-A-COM (SUB5) NUMERIC)
 10056                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
 10057                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
 10058              ELSE
 10059                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10060                 IF PB-ISSUE
 10061                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10062                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10063                 ELSE
 10064                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10065                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10066                 END-IF
 10067                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10068                 MOVE ZEROS             TO WS-SUB1
 10069                                           WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 185
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10070                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10071                 MOVE '0530'               TO CTBL-SW
 10072                 MOVE ' '                  TO WS-CTBL-READ-SW
 10073                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10074                 IF FIRST-TIME-THROUGH
 10075                    MOVE 'AA'              TO CTBL-BEN-CODE
 10076                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10077                 END-IF
 10078                 IF CTBL-TABLE-FOUND
 10079                    IF PB-ISSUE
 10080                       COMPUTE WS-COMM-CK-AMT =
 10081                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10082                    ELSE
 10083                       COMPUTE WS-COMM-CK-AMT =
 10084                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10085                    END-IF
 10086                    PERFORM 8800-GET-COMP-RATE
 10087                              THRU 8800-EXIT
 10088                 END-IF
 10089              END-IF
 10090              IF AM-COM-TYP (SUB5) = 'I'
 10091                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10092                   + (WS-WK-RATE * 1000)
 10093              END-IF
 10094              IF AM-COM-TYP (SUB5) = 'N'
 10095                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10096                   + (WS-WK-RATE * 1000)
 10097              END-IF
 10098              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10099                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10100                   + (WS-WK-RATE * 1000)
 10101              END-IF
 10102              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10103                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10104                   + (WS-WK-RATE * 1000)
 10105              END-IF
 10106           END-IF
 10107        END-PERFORM
 10108     END-IF
 10109
 10110     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10111                                                                  ELC50PD
 10112 0298-UNLOCK-RETURN.                                              ELC50PD
 10113      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10114      GO TO 9990-RETURN.                                          ELC50PD
 10115                                                                  ELC50PD
 10116 0299-CERT-NOT-FOUND.                                             ELC50PD
 10117                                                                  ELC50PD
 10118     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10119                                                                  ELC50PD
 10120     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10121         IF WS-ERROR = ER-2799                                    ELC50PD
 10122             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10123                                                                  ELC50PD
 10124     IF NOT PB-CANCELLATION                                       ELC50PD
 10125         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10126                                                                  ELC50PD
 10127     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 186
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10128     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10129     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10130     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10131                                    PB-CI-LF-TERM                 ELC50PD
 10132                                    PB-C-LF-REM-TERM              ELC50PD
 10133                                    PB-CI-AH-TERM                 ELC50PD
 10134                                    PB-C-AH-REM-TERM              ELC50PD
 10135                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10136                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10137                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10138                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10139                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10140                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10141                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10142                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10143                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10144                                    PB-CI-LOAN-APR                ELC50PD
 10145                                    PB-CI-LOAN-TERM               ELC50PD
 10146                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10147                                    PB-CI-AH-COMMISSION           ELC50PD
 10148                                    PB-CI-CURR-SEQ                ELC50PD
 10149                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10150                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10151                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10152                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10153                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10154                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10155                                    PB-CI-LIVES                   ELC50PD
 10156                                    PB-CI-LF-CRIT-PER             ELC50PD
 10157                                    PB-CI-AH-CRIT-PER
 10158                                    PB-CI-ADDL-CLP
 10159                                    PB-CI-DDF-IU-RATE-UP.
 10160                                                                  ELC50PD
 10161     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10162                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10163                                    PB-CI-DEATH-DT                ELC50PD
 10164                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10165                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10166                                    PB-CI-ENTRY-DT                ELC50PD
 10167                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10168                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10169                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10170                                                                  ELC50PD
 10171     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10172        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10173        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10174                                                                  ELC50PD
 10175                                                                  ELC50PD
 10176 0300-CONTINUE-EDIT.                                              ELC50PD
 10177                                                                  ELC50PD
 10178     IF PB-ISSUE                                                  ELC50PD
 10179        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10180            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10181                                                                  ELC50PD
 10182     IF PB-ISSUE                                                  ELC50PD
 10183        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10184            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10185                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 187
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10186     IF PB-ISSUE                                                  ELC50PD
 10187       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10188          (AM-NO-AH-ONLY)                                         ELC50PD
 10189           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10190               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10191                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10192                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10193                                                                  ELC50PD
 10194     IF PB-ISSUE                                                  ELC50PD
 10195        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10196        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10197        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10198     ELSE                                                         ELC50PD
 10199        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10200        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10201        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10202                                                                  ELC50PD
 10203     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10204                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10205                                    FORM-MASTER-SW                ELC50PD
 10206                                    WS-APP-CERT-SW.               ELC50PD
 10207                                                                  ELC50PD
 10208     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10209                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10210                                    WS-PL-REF-OVS-AMT             ELC50PD
 10211                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10212                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10213                                    WS-PL-REF-OVS-PCT             ELC50PD
 10214                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10215                                                                  ELC50PD
 10216     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10217       IF PB-ISSUE                                                ELC50PD
 10218         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10219             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10220             IF FORM-MASTER-FOUND                                 ELC50PD
 10221                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10222                                                                  ELC50PD
 10223     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10224        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10225                                                                  ELC50PD
 10226********************** MON CODE **********************            ELC50PD
 10227     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10228     IF PB-ISSUE                                                  ELC50PD
 10229     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10230        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10231             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10232               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
 10233******************************************************            ELC50PD
 10234                                                                  ELC50PD
 10235     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10236       IF PB-ISSUE                                                ELC50PD
 10237           IF FORM-MASTER-FOUND                                   ELC50PD
 10238             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10239                AM-DISMBR-COVERAGE                                ELC50PD
 10240                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10241                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10242                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10243                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 188
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10244                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10245                                                                  ELC50PD
 10246     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10247                                                                  ELC50PD
 10248     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10249         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10250         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10251         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10252         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10253         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10254           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10255             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10256         ELSE                                                     ELC50PD
 10257             NEXT SENTENCE                                        ELC50PD
 10258     ELSE                                                         ELC50PD
 10259         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10260                                                                  ELC50PD
 10261     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10262     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10263     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10264     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10265                                                                  ELC50PD
 10266     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10267     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10268                                                                  ELC50PD
 10269     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10270        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10271         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10272                                                                  ELC50PD
 10273     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10274                                                                  ELC50PD
 10275 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10276                                                                  ELC50PD
 10277     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10278                                                                  ELC50PD
 10279     IF NO-BENEFIT-FOUND                                          ELC50PD
 10280        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10281                                                                  ELC50PD
 10282     IF WS-BEN-CD = '99'                                          ELC50PD
 10283        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10284                                                                  ELC50PD
 10285     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10286         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10287             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10288                                                                  ELC50PD
 10289     MOVE +1                     TO SUB5.                         ELC50PD
 10290     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10291                                                                  ELC50PD
 10292* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10293* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10294     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10295         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10296                                                                  ELC50PD
 10297 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10298                                                                  ELC50PD
 10299     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10300        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10301           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 189
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10302                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10303           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10304                                                                  ELC50PD
 10305     IF SUB5 LESS THAN +20                                        ELC50PD
 10306        ADD +1                   TO SUB5                          ELC50PD
 10307        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10308                                                                  ELC50PD
 10309     MOVE +1                     TO SUB5.                         ELC50PD
 10310                                                                  ELC50PD
 10311     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10312        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10313                                                                  ELC50PD
 10314 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10315                                                                  ELC50PD
 10316     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10317        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10318           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10319                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10320           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10321                                                                  ELC50PD
 10322     IF SUB5 LESS THAN +30                                        ELC50PD
 10323        ADD +1                   TO SUB5                          ELC50PD
 10324        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10325                                                                  ELC50PD
 10326     MOVE +1                     TO SUB5.                         ELC50PD
 10327                                                                  ELC50PD
 10328 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10329                                                                  ELC50PD
 10330***************************************************************   ELC50PD
 10331*                                                             *   ELC50PD
 10332*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10333*                                                             *   ELC50PD
 10334*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10335*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10336*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10337*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10338*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10339*           BENEFIT CONTROLS.                                 *   ELC50PD
 10340*      99 = ALL BENEFITS                                      *   ELC50PD
 10341*                                                             *   ELC50PD
 10342***************************************************************   ELC50PD
 10343                                                                  ELC50PD
 10344     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10345                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10346                                                                  ELC50PD
 10347     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10348       AND                                                        ELC50PD
 10349        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10350        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10351                                                                  ELC50PD
 10352     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10353       AND                                                        ELC50PD
 10354        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10355        IF CF-REDUCING (SUB3)                                     ELC50PD
 10356           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10357              OR                                                  ELC50PD
 10358           ((AM-IG = '1') AND                                     ELC50PD
 10359           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 190
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10360              OR                                                  ELC50PD
 10361           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10362           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10363           (AM-IG NOT = '2'))                                     ELC50PD
 10364              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10365                                                                  ELC50PD
 10366     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10367       AND                                                        ELC50PD
 10368        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10369        IF CF-REDUCING (SUB3)                                     ELC50PD
 10370           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10371              OR                                                  ELC50PD
 10372           ((AM-IG = '2') AND                                     ELC50PD
 10373           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10374              OR                                                  ELC50PD
 10375           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10376           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10377           (AM-IG NOT = '1'))                                     ELC50PD
 10378              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10379                                                                  ELC50PD
 10380     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10381       AND                                                        ELC50PD
 10382        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10383        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10384           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10385              OR                                                  ELC50PD
 10386           ((AM-IG = '1') AND                                     ELC50PD
 10387           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10388              OR                                                  ELC50PD
 10389           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10390           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10391            (AM-IG NOT = '2'))                                    ELC50PD
 10392              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10393                                                                  ELC50PD
 10394     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10395       AND                                                        ELC50PD
 10396        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10397        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10398           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10399              OR                                                  ELC50PD
 10400           ((AM-IG = '2') AND                                     ELC50PD
 10401           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10402              OR                                                  ELC50PD
 10403           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10404           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10405           (AM-IG NOT = '1'))                                     ELC50PD
 10406              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10407                                                                  ELC50PD
 10408     IF SUB5 LESS THAN +20                                        ELC50PD
 10409        ADD +1                   TO SUB5                          ELC50PD
 10410        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10411                                                                  ELC50PD
 10412     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10413                                                                  ELC50PD
 10414     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10415        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10416                                                                  ELC50PD
 10417     MOVE +1                     TO SUB5.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 191
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10418                                                                  ELC50PD
 10419 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10420                                                                  ELC50PD
 10421     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10422                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10423                                                                  ELC50PD
 10424     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10425       AND                                                        ELC50PD
 10426        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10427        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10428                                                                  ELC50PD
 10429     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10430       AND                                                        ELC50PD
 10431        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10432        IF CF-REDUCING (SUB3)                                     ELC50PD
 10433           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10434              OR                                                  ELC50PD
 10435           ((AM-IG = '1') AND                                     ELC50PD
 10436           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10437              OR                                                  ELC50PD
 10438           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10439           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10440           (AM-IG NOT = '2'))                                     ELC50PD
 10441              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10442                                                                  ELC50PD
 10443     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10444       AND                                                        ELC50PD
 10445        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10446        IF CF-REDUCING (SUB3)                                     ELC50PD
 10447           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10448              OR                                                  ELC50PD
 10449           ((AM-IG = '2') AND                                     ELC50PD
 10450           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10451              OR                                                  ELC50PD
 10452           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10453           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10454           (AM-IG NOT = '1'))                                     ELC50PD
 10455              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10456                                                                  ELC50PD
 10457     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10458       AND                                                        ELC50PD
 10459        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10460        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10461           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10462              OR                                                  ELC50PD
 10463           ((AM-IG = '1') AND                                     ELC50PD
 10464           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10465              OR                                                  ELC50PD
 10466           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10467           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10468            (AM-IG NOT = '2'))                                    ELC50PD
 10469              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10470                                                                  ELC50PD
 10471     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10472       AND                                                        ELC50PD
 10473        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10474        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10475           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 192
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10476              OR                                                  ELC50PD
 10477           ((AM-IG = '2') AND                                     ELC50PD
 10478           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10479              OR                                                  ELC50PD
 10480           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10481           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10482           (AM-IG NOT = '1'))                                     ELC50PD
 10483              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10484                                                                  ELC50PD
 10485     IF SUB5 LESS THAN +30                                        ELC50PD
 10486        ADD +1                   TO SUB5                          ELC50PD
 10487        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10488                                                                  ELC50PD
 10489     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10490                                                                  ELC50PD
 10491 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10492                                                                  ELC50PD
 10493     MOVE +99                    TO SUB5.                         ELC50PD
 10494                                                                  ELC50PD
 10495     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10496        IF PB-ISSUE                                               ELC50PD
 10497           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10498           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10499                                                                  ELC50PD
 10500     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10501                                                                  ELC50PD
 10502 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10503                                                                  ELC50PD
 10504     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10505        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10506                                                                  ELC50PD
 10507     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10508     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10509     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10510     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10511     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10512                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10513     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10514                                                                  ELC50PD
 10515 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10516                                                                  ELC50PD
 10517     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10518     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10519                                                                  ELC50PD
 10520 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10521                                                                  ELC50PD
 10522     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10523     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10524     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10525     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10526     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10527     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10528     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10529     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10530                                 TO PLAN-REVISION-NO.             ELC50PD
 10531                                                                  ELC50PD
 10532     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10533     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 193
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10534                                                                  ELC50PD
 10535     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10536       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10537         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10538            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10539             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10540             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10541             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10542                                                                  ELC50PD
 10543     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10544        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10545                                                                  ELC50PD
 10546 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10547                                                                  ELC50PD
 10548     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10549        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10550        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10551        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10552        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10553        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10554        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10555        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10556        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10557          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10558                                                                  ELC50PD
 10559     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10560                                                                  ELC50PD
 10561     IF  PB-CANCELLATION                                          ELC50PD
 10562         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10563                                                                  ELC50PD
 10564     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10565        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10566           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10567           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10568              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10569              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10570           ELSE                                                   ELC50PD
 10571              NEXT SENTENCE                                       ELC50PD
 10572        ELSE                                                      ELC50PD
 10573           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10574              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10575                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10576                                                                  ELC50PD
 10577 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10578                                                                  ELC50PD
 10579     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10580                                                                  ELC50PD
 10581     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10582        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10583                                                                  ELC50PD
 10584     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10585        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10586        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10587                                                                  ELC50PD
 10588     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10589        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10590                                                                  ELC50PD
 10591     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 194
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10592        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10593                                                                  ELC50PD
 10594     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10595        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10596                                                                  ELC50PD
 10597     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10598        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10599                                                                  ELC50PD
 10600     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10601        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10602                                                                  ELC50PD
 10603     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10604                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10605        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10606                                                                  ELC50PD
 10607     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10608                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10609        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10610                                                                  ELC50PD
 10611     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10612                          PL-SALES-TAX > +0                       ELC50PD
 10613         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10614                                                                  ELC50PD
 10615     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10616        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10617                                    WS-IG-OVRD-AM.                ELC50PD
 10618                                                                  ELC50PD
 10619 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10620                                                                  ELC50PD
 10621     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10622                                                                  ELC50PD
 10623     IF PB-ISSUE                                                  ELC50PD
 10624        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10625     ELSE                                                         ELC50PD
 10626        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10627                                                                  ELC50PD
 10628     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10629     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10630     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10631     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10632     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10633                                         WS-LF-REFUND-CALC.       ELC50PD
 10634     if (ws-lf-earnings-calc = '5')
 10635        and (pb-i-loan-apr = zeros)
 10636        and (benefit-code-chg)
 10637        move +99.9999 to pb-i-loan-apr
 10638     end-if
 10639                                                                  ELC50PD
 10640     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10641        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10642                                                                  ELC50PD
 10643     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10644        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10645
 10646     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10647                                                                  ELC50PD
 10648     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10649     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 195
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10650     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10651     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10652     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10653     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10654                                                                  ELC50PD
 10655     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10656        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10657         NEXT SENTENCE                                            ELC50PD
 10658     ELSE                                                         ELC50PD
 10659         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10660            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10661               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10662                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10663                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10664                                                                  ELC50PD
 10665     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10666     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10667                                                                  ELC50PD
 10668     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10669                                                                  ELC50PD
 10670 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10671                                                                  ELC50PD
 10672     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10673     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10674     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10675                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 196
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10677                                                                  ELC50PD
 10678 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10679                                                                  ELC50PD
 10680     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10681                                    PLAN-MASTER-AH-SW.            ELC50PD
 10682                                                                  ELC50PD
 10683     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10684                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10685                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10686                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10687                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10688                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10689                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10690     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10691                                                                  ELC50PD
 10692                                                                  ELC50PD
 10693     if pb-issue
 10694        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10695           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10696        end-if
 10697        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10698           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10699           GO TO 0399-BENEFIT-NOT-FOUND
 10700        end-if
 10701     end-if
 10702                                                                  ELC50PD
 10703     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10704        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10705                                                                  ELC50PD
 10706     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10707                                                                  ELC50PD
 10708     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10709         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10710         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10711         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10712         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10713           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10714             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10715         ELSE                                                     ELC50PD
 10716             NEXT SENTENCE                                        ELC50PD
 10717     ELSE                                                         ELC50PD
 10718         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10719                                                                  ELC50PD
 10720     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10721     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10722     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10723     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10724                                                                  ELC50PD
 10725     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10726     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10727                                                                  ELC50PD
 10728     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10729        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10730          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10731                                                                  ELC50PD
 10732     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10733                                                                  ELC50PD
 10734 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 197
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10735                                                                  ELC50PD
 10736     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10737                                                                  ELC50PD
 10738     IF NO-BENEFIT-FOUND                                          ELC50PD
 10739         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10740                                                                  ELC50PD
 10741     IF WS-BEN-CD = '99'                                          ELC50PD
 10742        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10743                                                                  ELC50PD
 10744     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10745         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10746             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10747                                                                  ELC50PD
 10748     MOVE +1                     TO SUB5.                         ELC50PD
 10749     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10750                                                                  ELC50PD
 10751* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10752* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10753     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10754         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10755                                                                  ELC50PD
 10756 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10757                                                                  ELC50PD
 10758     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10759        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10760           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10761                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10762           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10763                                                                  ELC50PD
 10764     IF SUB5 LESS THAN +20                                        ELC50PD
 10765        ADD +1                   TO SUB5                          ELC50PD
 10766        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10767                                                                  ELC50PD
 10768     MOVE +1                     TO SUB5.                         ELC50PD
 10769                                                                  ELC50PD
 10770     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10771        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10772                                                                  ELC50PD
 10773 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10774                                                                  ELC50PD
 10775     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10776        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10777           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10778                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10779           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10780                                                                  ELC50PD
 10781     IF SUB5 LESS THAN +30                                        ELC50PD
 10782        ADD +1                   TO SUB5                          ELC50PD
 10783        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10784                                                                  ELC50PD
 10785     MOVE +1                     TO SUB5.                         ELC50PD
 10786                                                                  ELC50PD
 10787 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10788                                                                  ELC50PD
 10789***************************************************************   ELC50PD
 10790*                                                             *   ELC50PD
 10791*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10792*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 198
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10793*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10794*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10795*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10796*           BENEFIT CONTROLS.                                 *   ELC50PD
 10797*      99 = ALL BENEFITS.                                     *   ELC50PD
 10798*                                                             *   ELC50PD
 10799***************************************************************   ELC50PD
 10800                                                                  ELC50PD
 10801     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10802                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10803                                                                  ELC50PD
 10804     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10805       AND                                                        ELC50PD
 10806        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10807        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10808                                                                  ELC50PD
 10809     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10810       AND                                                        ELC50PD
 10811        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10812           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10813              OR                                                  ELC50PD
 10814           ((AM-IG = '1') AND                                     ELC50PD
 10815           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10816              OR                                                  ELC50PD
 10817           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10818           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10819           (AM-IG NOT = '2'))                                     ELC50PD
 10820              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10821                                                                  ELC50PD
 10822     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10823       AND                                                        ELC50PD
 10824        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10825           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10826              OR                                                  ELC50PD
 10827           ((AM-IG = '2') AND                                     ELC50PD
 10828           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10829              OR                                                  ELC50PD
 10830           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10831           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10832           (AM-IG NOT = '1'))                                     ELC50PD
 10833              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10834                                                                  ELC50PD
 10835     IF SUB5 LESS THAN +20                                        ELC50PD
 10836        ADD +1                   TO SUB5                          ELC50PD
 10837        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10838                                                                  ELC50PD
 10839     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10840        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10841                                                                  ELC50PD
 10842     MOVE +1                    TO SUB5.                          ELC50PD
 10843                                                                  ELC50PD
 10844 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10845                                                                  ELC50PD
 10846     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10847                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10848                                                                  ELC50PD
 10849     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10850       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 199
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10851        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10852        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10853                                                                  ELC50PD
 10854     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10855       AND                                                        ELC50PD
 10856        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10857           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10858              OR                                                  ELC50PD
 10859           ((AM-IG = '1') AND                                     ELC50PD
 10860           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10861              OR                                                  ELC50PD
 10862           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10863           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10864           (AM-IG NOT = '2'))                                     ELC50PD
 10865              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10866                                                                  ELC50PD
 10867     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10868       AND                                                        ELC50PD
 10869        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10870           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10871              OR                                                  ELC50PD
 10872           ((AM-IG = '2') AND                                     ELC50PD
 10873           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10874              OR                                                  ELC50PD
 10875           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10876           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10877           (AM-IG NOT = '1'))                                     ELC50PD
 10878              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10879                                                                  ELC50PD
 10880     IF SUB5 LESS THAN +30                                        ELC50PD
 10881        ADD +1                   TO SUB5                          ELC50PD
 10882        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10883                                                                  ELC50PD
 10884 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10885                                                                  ELC50PD
 10886     MOVE +99                    TO SUB5.                         ELC50PD
 10887                                                                  ELC50PD
 10888     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10889                                                                  ELC50PD
 10890     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10891        IF PB-ISSUE                                               ELC50PD
 10892           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10893           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10894                                                                  ELC50PD
 10895     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10896                                                                  ELC50PD
 10897 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10898                                                                  ELC50PD
 10899     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10900         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10901                                                                  ELC50PD
 10902     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10903     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10904     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10905     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10906     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10907                                    PLAN-MASTER-AH-SW.            ELC50PD
 10908*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 200
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10909     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10910                                                                  ELC50PD
 10911 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10912                                                                  ELC50PD
 10913     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10914     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10915                                                                  ELC50PD
 10916 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10917                                                                  ELC50PD
 10918     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10919     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10920     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10921     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10922     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10923     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10924     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10925     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10926                                 TO PLAN-REVISION-NO.             ELC50PD
 10927                                                                  ELC50PD
 10928     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10929     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10930                                                                  ELC50PD
 10931     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10932       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10933         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10934            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10935             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10936             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10937             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10938                                                                  ELC50PD
 10939     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10940        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10941                                                                  ELC50PD
 10942 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10943                                                                  ELC50PD
 10944     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10945        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10946        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10947        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10948        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10949        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10950        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10951        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10952        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10953          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10954                                                                  ELC50PD
 10955     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10956                                                                  ELC50PD
 10957     IF  PB-CANCELLATION                                          ELC50PD
 10958         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10959                                                                  ELC50PD
 10960     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10961       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10962          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10963          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10964             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10965             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10966          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 201
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10967             NEXT SENTENCE                                        ELC50PD
 10968       ELSE                                                       ELC50PD
 10969          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10970             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10971                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10972                                                                  ELC50PD
 10973 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10974                                                                  ELC50PD
 10975     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10976                                                                  ELC50PD
 10977     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10978        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10979                                                                  ELC50PD
 10980     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10981        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10982        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10983                                                                  ELC50PD
 10984     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10985        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10986                                                                  ELC50PD
 10987     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10988        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10989                                                                  ELC50PD
 10990     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10991        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10992                                                                  ELC50PD
 10993     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10994        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10995                                                                  ELC50PD
 10996     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10997        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10998                                                                  ELC50PD
 10999     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 11000                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 11001        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 11002                                                                  ELC50PD
 11003     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 11004                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 11005        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 11006                                                                  ELC50PD
 11007     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 11008        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 11009        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 11010            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 11011                                                                  ELC50PD
 11012 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 11013                                                                  ELC50PD
 11014     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 11015                                                                  ELC50PD
 11016     IF PB-ISSUE                                                  ELC50PD
 11017        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 11018       ELSE                                                       ELC50PD
 11019        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 11020                                                                  ELC50PD
 11021     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 11022     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 11023     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 11024     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 202
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11025                                         WS-AH-REFUND-CALC.       ELC50PD
 11026                                                                  ELC50PD
 11027     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 11028        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 11029                                                                  ELC50PD
 11030     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 11031        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 11032
 11033     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 11034                                                                  ELC50PD
 11035     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 11036     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 11037     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 11038     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 11039     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 11040     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11041                                                                  ELC50PD
 11042     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 11043        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 11044         NEXT SENTENCE                                            ELC50PD
 11045     ELSE                                                         ELC50PD
 11046         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 11047            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 11048                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 11049                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 11050                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11051                                                                  ELC50PD
 11052     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 11053     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 11054                                                                  ELC50PD
 11055     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 11056                                                                  ELC50PD
 11057 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 11058                                                                  ELC50PD
 11059     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 11060     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 11061     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11062                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 203
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11064                                                                  ELC50PD
 11065 0400-FIND-CARRIER.                                               ELC50PD
 11066                                                                  ELC50PD
 11067     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11068                                                                  ELC50PD
 11069     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11070     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11071     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11072     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11073                                                                  ELC50PD
 11074*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11075     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11076                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11077                                                                  ELC50PD
 11078     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11079     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11080                                                                  ELC50PD
 11081     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11082        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11083                                                                  ELC50PD
 11084 0400-BUILD-CARR-TOL.                                             ELC50PD
 11085                                                                  ELC50PD
 11086     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11087        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11088        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11089                                    WS-TOL-AH-PREM.               ELC50PD
 11090                                                                  ELC50PD
 11091     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11092        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11093        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11094                                    WS-TOL-AH-REFUND.             ELC50PD
 11095                                                                  ELC50PD
 11096     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11097        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11098        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11099                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11100                                                                  ELC50PD
 11101     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11102        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11103        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11104                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11105                                                                  ELC50PD
 11106     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11107        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11108        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11109                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11110                                                                  ELC50PD
 11111     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11112        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11113        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11114                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11115                                                                  ELC50PD
 11116     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11117         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11118                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11119                                                                  ELC50PD
 11120     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11121     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 204
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11122        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11123     END-IF
 11124     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11125        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11126     END-IF
 11127     IF WS-TOL-CLP-PCT = ZEROS
 11128        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11129     END-IF
 11130
 11131     IF WS-SPP-LEASE-COMM = ZEROS
 11132        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11133     END-IF
 11134
 11135     GO TO 0400-FIND-ERPDEF.
 11136                                                                  ELC50PD
 11137 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11138                                                                  ELC50PD
 11139     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11141                                                                  ELC50PD
 11142 0400-FIND-ERPDEF.
 11143
 11144     IF PB-COMPANY-ID = 'DCC'
 11145        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11146        CONTINUE
 11147     ELSE
 11148        GO TO 0400-FIND-ERCOMP
 11149     END-IF
 11150
 11151     MOVE ' '                    TO PDEF-MASTER-SW
 11152     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11153     MOVE PB-STATE               TO ERPDEF-STATE
 11154     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11155     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11156     IF PB-ISSUE
 11157        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11158     ELSE
 11159        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11160     END-IF
 11161     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11162     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11163     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11164     IF PDEF-MASTER-FOUND
 11165        MOVE 'N'                 TO PDEF-MASTER-SW
 11166        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11167        IF PDEF-MASTER-FOUND
 11168           IF (ERPDEF-KEY-SAVE (1:16) =
 11169                        PD-CONTROL-PRIMARY (1:16))
 11170              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11171              CONTINUE
 11172           ELSE
 11173              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11174              IF (ERPDEF-KEY-SAVE (1:16) =
 11175                        PD-CONTROL-PRIMARY (1:16))
 11176                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11177                 CONTINUE
 11178              ELSE
 11179                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 205
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11180              END-IF
 11181           END-IF
 11182        END-IF
 11183        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11184     END-IF
 11185     IF PDEF-MASTER-FOUND
 11186        IF PD-TRUNCATED = 'Y'
 11187           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11188        END-IF
 11189     END-IF
 11190
 11191     .
 11192 0400-FIND-ERCOMP.
 11193
 11194     IF PB-COMPANY-ID = 'DCC'
 11195        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11196           (WS-SUB1 > +10)
 11197           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11198                 OR 'A' OR 'N'
 11199              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11200              MOVE PB-CARRIER    TO COMP-CARRIER
 11201              MOVE PB-GROUPING   TO COMP-GROUPING
 11202              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11203              MOVE AM-AGT (WS-SUB1)
 11204                                 TO COMP-FIN-RESP
 11205              MOVE 'G'           TO COMP-TYPE
 11206              PERFORM 8582-READ-COMPENSATION-MASTER
 11207                                 THRU 8582-EXIT
 11208              IF COMP-MASTER-FOUND
 11209                 IF CO-GA-INACTIVE
 11210                    MOVE ER-2763 TO WS-ERROR
 11211                    PERFORM 9900-ERROR-FORMAT
 11212                                 THRU 9900-EXIT
 11213                    MOVE +11     TO WS-SUB1
 11214                 END-IF
 11215                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11216                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11217                    MOVE ER-2788 TO WS-ERROR
 11218                    PERFORM 9900-ERROR-FORMAT
 11219                                 THRU 9900-EXIT
 11220                    MOVE +11     TO WS-SUB1
 11221                 END-IF
 11222              END-IF
 11223           END-IF
 11224        END-PERFORM
 11225     END-IF
 11226
 11227     IF PB-COMPANY-ID = 'DCC'
 11228        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11229           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11230                                    WS-CLP-STATE
 11231        ELSE
 11232           MOVE SPACES           TO PB-I-CLP-STATE
 11233                                    WS-CLP-STATE
 11234        END-IF
 11235     END-IF
 11236
 11237     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 206
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11238        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11239        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11240        CONTINUE
 11241     ELSE
 11242        GO TO 0400-FIND-STATE-RECORD
 11243     END-IF
 11244
 11245     MOVE SPACES                 TO WS-CLP-STATE
 11246     MOVE +0                     TO WS-BANK-FEE
 11247                                    WS-BANK-LFEE
 11248                                    WS-BANK-NOCHRGB
 11249
 11250     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11251
 11252     IF (PB-ISSUE)
 11253        AND (PB-I-BANK-NUMBER NOT =
 11254            SPACES AND ZEROS AND LOW-VALUES)
 11255        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11256     ELSE
 11257        IF (PB-CANCELLATION)
 11258           AND (PB-CI-BANK-NUMBER NOT =
 11259                SPACES AND ZEROS AND LOW-VALUES)
 11260           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11261        END-IF
 11262     END-IF
 11263
 11264     IF COMP-FIN-RESP NOT = LOW-VALUES
 11265        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11266        MOVE PB-CARRIER          TO COMP-CARRIER
 11267        MOVE PB-GROUPING         TO COMP-GROUPING
 11268        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11269        MOVE 'B'                 TO COMP-TYPE
 11270        PERFORM 8582-READ-COMPENSATION-MASTER
 11271                                 THRU 8582-EXIT
 11272        IF COMP-MASTER-FOUND
 11273           IF CO-MAX-BANK-FEE NOT NUMERIC
 11274              MOVE +0            TO CO-MAX-BANK-FEE
 11275           END-IF
 11276           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11277              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11278           END-IF
 11279           IF CO-GA-INACTIVE
 11280              MOVE ER-2763       TO WS-ERROR
 11281              PERFORM 9900-ERROR-FORMAT
 11282                                 THRU 9900-EXIT
 11283           END-IF
 11284           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11285              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11286              MOVE ER-2788 TO WS-ERROR
 11287              PERFORM 9900-ERROR-FORMAT
 11288                                 THRU 9900-EXIT
 11289              MOVE +11     TO WS-SUB1
 11290           END-IF
 11291           IF WS-AH-BEN-CATEGORY = 'G'
 11292              MOVE CO-MAX-BANK-FEE
 11293                                 TO WS-BANK-FEE
 11294                                    PB-I-BANK-FEE
 11295           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 207
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11296              MOVE CO-MAX-BANK-FEE-LEASE
 11297                                 TO WS-BANK-LFEE
 11298                                    PB-I-BANK-FEE
 11299           END-IF
 11300           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11301              AND (WS-AH-REFUND-CALC = 'G'))
 11302                        OR
 11303              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11304              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11305              CONTINUE
 11306           ELSE
 11307              MOVE ER-2789 TO WS-ERROR
 11308              PERFORM 9900-ERROR-FORMAT
 11309                                 THRU 9900-EXIT
 11310           END-IF
 11311           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11312                                    PB-I-CLP-STATE
 11313           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11314           MOVE CO-CARRIER       TO BXRF-CARRIER
 11315           MOVE CO-GROUPING      TO BXRF-GROUPING
 11316           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11317           MOVE BXRF-MAX-REC-LENGTH
 11318                                 TO BXRF-REC-LENGTH
 11319           PERFORM 8584-READ-BANK-CROSS-REF
 11320                                 THRU 8584-EXIT
 11321           IF BXRF-MASTER-FOUND
 11322              MOVE ' '           TO BANK-ACCT-SW
 11323              MOVE BK-BANK-POINTER-CNT
 11324                                 TO BK-BANK-POINTER-CNT
 11325              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11326                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11327                 OR (BANK-ACCT-FOUND)
 11328                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11329                    AND (BK-AM-EXP-DT (WS-SUB1)
 11330                                 > PB-CERT-EFF-DT)
 11331                    AND (BK-AM-EFF-DT (WS-SUB1)
 11332                                 NOT > PB-CERT-EFF-DT)
 11333                    SET BANK-ACCT-FOUND TO TRUE
 11334                 END-IF
 11335              END-PERFORM
 11336              IF NOT BANK-ACCT-FOUND
 11337                 MOVE ZEROS      TO WS-BANK-FEE
 11338                                    WS-BANK-LFEE
 11339                 MOVE ER-2869    TO WS-ERROR
 11340                 PERFORM 9900-ERROR-FORMAT
 11341                                 THRU 9900-EXIT
 11342              ELSE
 11343                 PERFORM 5000-PROCESS-REPS
 11344                                 THRU 5000-EXIT
 11345                 IF AGENT-MASTER-FOUND
 11346                    MOVE +0      TO WS-BANK-FEE
 11347                                    WS-BANK-LFEE
 11348*                   MOVE AG-SPP-FEES (1)
 11349*                                TO PB-I-BANK-FEE
 11350*                                   WS-BANK-FEE
 11351                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11352                       (WS-SUB1 > +10)
 11353                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 208
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11354                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11355                       END-IF
 11356                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11357                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11358                       END-IF
 11359                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11360                          AG-SPP-FEES (WS-SUB1)
 11361                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11362                          AG-SPP-LFEES (WS-SUB1)
 11363                    END-PERFORM
 11364                    IF WS-AH-BEN-CATEGORY = 'G'
 11365                       MOVE WS-BANK-FEE
 11366                                 TO PB-I-BANK-FEE
 11367                    ELSE
 11368                       MOVE WS-BANK-LFEE
 11369                                 TO PB-I-BANK-FEE
 11370                    END-IF
 11371                 END-IF
 11372              END-IF
 11373           END-IF
 11374        ELSE
 11375           MOVE ER-2879          TO WS-ERROR
 11376           PERFORM 9900-ERROR-FORMAT
 11377                                 THRU 9900-EXIT
 11378        END-IF
 11379     ELSE
 11380        MOVE ER-2879             TO WS-ERROR
 11381        PERFORM 9900-ERROR-FORMAT
 11382                                 THRU 9900-EXIT
 11383     END-IF
 11384
 11385     IF WS-AH-BEN-CATEGORY = 'G'
 11386        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11387        + WS-BANK-FEE
 11388     ELSE
 11389        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11390        + WS-BANK-LFEE
 11391     END-IF
 11392
 11393     .
 11394 0400-FIND-STATE-RECORD.                                          ELC50PD
 11395                                                                  ELC50PD
 11396     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11397         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11398         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11399         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11400         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11401         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11402             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11403         ELSE                                                     ELC50PD
 11404             NEXT SENTENCE                                        ELC50PD
 11405     ELSE                                                         ELC50PD
 11406         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11407                                                                  ELC50PD
 11408     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11409     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11410     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11411     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 209
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11412                                                                  ELC50PD
 11413     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11414     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11415                                                                  ELC50PD
 11416     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11417        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11418        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11419        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11420                                    WS-TOL-AH-CLAIM               ELC50PD
 11421                                    WS-MINIMUM-REFUND             ELC50PD
 11422                                    WS-TOL-LF-PREM                ELC50PD
 11423                                    WS-TOL-AH-PREM                ELC50PD
 11424                                    WS-TOL-LF-REFUND              ELC50PD
 11425                                    WS-TOL-AH-REFUND              ELC50PD
 11426                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11427                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11428                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11429                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11430                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11431                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11432                                    EC-ST-TOL-PREM                ELC50PD
 11433                                    EC-ST-TOL-REFUND              ELC50PD
 11434                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11435                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11436                                    WS-ST-LF-PREM-TAX
 11437                                    WS-ST-AH-PREM-TAX-I
 11438                                    WS-ST-AH-PREM-TAX-G
 11439                                    WS-BANK-FEE
 11440                                    WS-BANK-LFEE
 11441                                    WS-TOL-CLP-PCT
 11442                                    WS-SPP-LEASE-COMM
 11443        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11444                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11445                                    WS-LF-REM-TERM-CALC           ELC50PD
 11446                                    WS-LF-REFUND-CALC             ELC50PD
 11447                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11448                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11449                                    WS-AH-REM-TERM-CALC           ELC50PD
 11450                                    WS-AH-REFUND-CALC
 11451                                    WS-LF-BEN-CATEGORY
 11452                                    WS-AH-BEN-CATEGORY
 11453                                    WS-CLP-STATE
 11454                                    WS-ST-REFUND-CLAIM-FLAG
 11455                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11456                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11457          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11458                                                                  ELC50PD
 11459     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11460                                                                  ELC50PD
 11461 0405-CONTINUE-EDIT.                                              ELC50PD
 11462
 11463     if pb-company-id = 'AHL'
 11464        continue
 11465     else
 11466        IF PB-CERT-PRIME NOT NUMERIC
 11467           MOVE ER-2722          TO WS-ERROR
 11468           PERFORM 9900-ERROR-FORMAT
 11469                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 210
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11470        end-if
 11471     END-IF
 11472
 11473*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11474*       MOVE +0                  TO SUB3
 11475*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11476*       IF SUB3 > +0
 11477*          MOVE ER-2722          TO WS-ERROR
 11478*          PERFORM 9900-ERROR-FORMAT
 11479*                                THRU 9900-EXIT
 11480*       END-IF
 11481*    END-IF
 11482
 11483
 11484*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11485*       IF PB-CERT-PRIME NOT NUMERIC
 11486*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11487*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11488*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11489*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11490*
 11491*          MOVE ER-2722          TO WS-ERROR
 11492*          PERFORM 9900-ERROR-FORMAT
 11493*                                THRU 9900-EXIT
 11494*       END-IF
 11495*    END-IF
 11496
 11497     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11498                                                                  ELC50PD
 11499     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11500        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11501                                    WS-TOL-AH-CLAIM.              ELC50PD
 11502                                                                  ELC50PD
 11503     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11504        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11505                                                                  ELC50PD
 11506     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11507        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11508                                                                  ELC50PD
 11509     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11510        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11511                                    WS-TOL-AH-PREM                ELC50PD
 11512        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11513                                                                  ELC50PD
 11514     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11515        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11516                                    WS-TOL-AH-REFUND              ELC50PD
 11517        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11518                                                                  ELC50PD
 11519     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11520        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11521        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11522                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11523                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11524                                                                  ELC50PD
 11525     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11526        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11527        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 211
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11528                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11529                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11530                                                                  ELC50PD
 11531     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11532        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11533        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11534                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11535                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11536                                                                  ELC50PD
 11537     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11538        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11539        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11540                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11541                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11542                                                                  ELC50PD
 11543     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11544     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11545                                                                  ELC50PD
 11546     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11547          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11548                                                                  ELC50PD
 11549     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11550     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11551
 11552     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11553                                                                  ELC50PD
 11554     IF CF-ST-LF-PREM-TAX NUMERIC
 11555        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11556     END-IF
 11557     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11558        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11559     END-IF
 11560     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11561        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11562     END-IF
 11563
 11564     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11565         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11566     END-IF.
 11567
 11568     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11569        GO TO 0410-CHECK-AH.                                      ELC50PD
 11570                                                                  ELC50PD
 11571     IF CF-ST-RT-CALC NOT = SPACES
 11572        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11573                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11574     END-IF
 11575
 11576     IF WS-LF-COVERAGE-TYPE = 'R'
 11577        IF WS-LF-EARNINGS-CALC = '5'
 11578           IF CF-ST-RF-LN-CALC > '0'
 11579              MOVE CF-ST-RF-LN-CALC
 11580                                 TO WS-LF-REFUND-CALC
 11581                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11582           END-IF
 11583        ELSE
 11584           IF CF-ST-RF-LR-CALC > '0'
 11585              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 212
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11586                                 TO WS-LF-REFUND-CALC
 11587                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11588           END-IF
 11589        END-IF
 11590     ELSE
 11591        IF CF-ST-RF-LL-CALC > '0'
 11592           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11593                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11594        END-IF
 11595     END-IF
 11596
 11597     IF CF-ST-RT-CALC NOT = SPACES
 11598        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11599                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11600     END-IF
 11601
 11602     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11603     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11604                                                                  ELC50PD
 11605     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11606                                                                  ELC50PD
 11607     IF NO-BENEFIT-FOUND                                          ELC50PD
 11608        GO TO 0410-CHECK-AH.                                      ELC50PD
 11609                                                                  ELC50PD
 11610     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11611        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11612                                 TO EC-ST-LF-REM-TERM-CALC
 11613                                    WS-LF-REM-TERM-CALC           ELC50PD
 11614     END-IF
 11615                                                                  ELC50PD
 11616     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11617        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11618                                 TO WS-LF-REFUND-CALC             ELC50PD
 11619                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11620     END-IF
 11621*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11622                                                                  ELC50PD
 11623     .                                                            ELC50PD
 11624 0410-CHECK-AH.                                                   ELC50PD
 11625                                                                  ELC50PD
 11626     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11627        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11628                                                                  ELC50PD
 11629     IF CF-ST-RT-CALC NOT = SPACES
 11630        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11631                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11632     END-IF
 11633
 11634     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11635        IF CF-ST-RF-CP-CALC > '0'
 11636           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11637                                    EC-ST-AH-REFUND-CALC
 11638        END-IF
 11639     ELSE
 11640        IF CF-ST-RF-AH-CALC > '0'
 11641           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11642                                    EC-ST-AH-REFUND-CALC
 11643        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 213
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11644     END-IF
 11645     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11646     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11647                                                                  ELC50PD
 11648     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11649                                                                  ELC50PD
 11650     IF NO-BENEFIT-FOUND                                          ELC50PD
 11651        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11652                                                                  ELC50PD
 11653     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11654        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11655                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11656                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11657     END-IF
 11658                                                                  ELC50PD
 11659     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11660        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11661                                 TO WS-AH-REFUND-CALC             ELC50PD
 11662                                    EC-ST-AH-REFUND-CALC
 11663     END-IF
 11664                                                                  ELC50PD
 11665*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11666                                                                  ELC50PD
 11667     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11668                                                                  ELC50PD
 11669 0499-STATE-NOT-FOUND.                                            ELC50PD
 11670                                                                  ELC50PD
 11671     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11673                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 214
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11675                                                                  ELC50PD
 11676 0500-SET-ACCOUNT.                                                ELC50PD
 11677
 11678*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11679
 11680     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11681        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11682        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11683        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11684        MOVE '3'                 TO CNTL-REC-TYPE
 11685        MOVE +0                  TO CNTL-SEQ-NO
 11686
 11687        MOVE '3'                 TO RC-SW-2
 11688        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11689
 11690        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11691           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11692           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11693           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11694                                    WS-ST-AH-PREM-TAX-I
 11695                                    WS-ST-AH-PREM-TAX-G
 11696        ELSE
 11697           IF CF-ST-LF-PREM-TAX NUMERIC
 11698              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11699           END-IF
 11700           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11701              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11702           END-IF
 11703           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11704              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11705           END-IF
 11706        END-IF
 11707        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11708     END-IF
 11709
 11710*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11711*  FOR DCC ONLY
 11712
 11713     IF PB-COMPANY-ID = 'DCC'
 11714
 11715     MOVE ' '                    TO STAT-MASTER-SW
 11716     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11717     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11718     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11719     MOVE PB-STATE               TO ELSTAT-STATE
 11720     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11721        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11722     END-IF
 11723
 11724     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11725     SET BIN-TO-GREG             TO TRUE
 11726     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11727     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11728     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11729
 11730     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11731     IF STAT-MASTER-FOUND
 11732        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 215
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11733        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11734        IF STAT-MASTER-FOUND
 11735           IF (ELSTAT-KEY-SAVE (1:12) =
 11736                        SF-CONTROL-PRIMARY (1:12))
 11737              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11738                 MOVE 'F'        TO STAT-MASTER-SW
 11739              ELSE
 11740                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11741                 IF (STAT-MASTER-FOUND)
 11742                    AND (ELSTAT-KEY-SAVE (1:12) =
 11743                        SF-CONTROL-PRIMARY (1:12))
 11744                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11745                    MOVE 'F'     TO STAT-MASTER-SW
 11746                 END-IF
 11747              END-IF
 11748           END-IF
 11749        END-IF
 11750     END-IF
 11751
 11752     IF STAT-MASTER-SW = 'F'
 11753        IF SF-ST-LF-PREM-TAX NUMERIC
 11754           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11755        END-IF
 11756        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11757           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11758        END-IF
 11759        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11760           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11761        END-IF
 11762     END-IF
 11763
 11764     END-IF
 11765
 11766     IF (PB-COMPANY-ID = 'DCC')
 11767        AND (PB-ISSUE)
 11768        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11769        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11770        AND (AM-GPCD = 06)
 11771        MOVE 'Y'                 TO WS-GOOD-HIN
 11772        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11773           MOVE PB-I-VIN         TO WS-WORK-VIN
 11774           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11775              (V1 > 16)
 11776              IF WS-WORK-VIN (V1:1) NUMERIC
 11777                 MOVE WS-WORK-VIN-N (V1)
 11778                                 TO WS-ROW-B-VAL (V1)
 11779              ELSE
 11780                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11781                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11782                    OR (V2 > 26)
 11783                 END-PERFORM
 11784                 IF V2 < 27
 11785                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11786                 ELSE
 11787                    MOVE 'N'     TO WS-GOOD-HIN
 11788                 END-IF
 11789              END-IF
 11790              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 216
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11791                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11792              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11793                 WS-ROW-D-VAL (V1)
 11794           END-PERFORM
 11795           MOVE ZEROS            TO WS-VIN-REMAINDER
 11796           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11797             REMAINDER WS-VIN-REMAINDER
 11798           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11799              CONTINUE
 11800           ELSE
 11801              MOVE 'N'           TO WS-GOOD-HIN
 11802           END-IF
 11803        ELSE
 11804           MOVE 'N'              TO WS-GOOD-HIN
 11805        END-IF
 11806        IF WS-GOOD-HIN NOT = 'Y'
 11807           MOVE ER-3826           TO WS-ERROR
 11808           PERFORM 9900-ERROR-FORMAT
 11809                                 THRU 9900-EXIT
 11810        END-IF
 11811     END-IF
 11812
 11813     IF (PB-COMPANY-ID = 'DCC')
 11814        AND (PB-ISSUE)
 11815        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11816        AND (AM-GPCD NOT = 06)
 11817        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11818          MOVE PB-I-VIN          TO WS-WORK-VIN
 11819          MOVE +8                TO V2
 11820          MOVE ZEROS             TO WS-VIN-TOTAL
 11821          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11822           (V1 > 17)
 11823             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11824                MOVE ER-3825     TO WS-ERROR
 11825                PERFORM 9900-ERROR-FORMAT
 11826                                 THRU 9900-EXIT
 11827             ELSE
 11828                IF V1 = 8
 11829                   MOVE 10       TO V2
 11830                END-IF
 11831                IF V1 = 9
 11832                   MOVE 0        TO V2
 11833                END-IF
 11834                IF V1 = 10
 11835                   MOVE 9        TO V2
 11836                END-IF
 11837                IF WS-WORK-VIN (V1:1) NUMERIC
 11838                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11839                    + (WS-WORK-VIN-N (V1) * V2)
 11840                ELSE
 11841                   MOVE WS-WORK-VIN (V1:1)
 11842                                 TO WS-HEX-BYTE
 11843                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11844                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11845                    + (WS-NUM (V3) * V2)
 11846                END-IF
 11847                COMPUTE V2 = V2 - 1
 11848             END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 217
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11849          END-PERFORM
 11850          MOVE ZEROS TO WS-VIN-REMAINDER
 11851          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11852             REMAINDER WS-VIN-REMAINDER
 11853          IF ((WS-WORK-VIN (9:1) = 'X')
 11854             AND (WS-VIN-REMAINDER = 10))
 11855                     OR
 11856             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11857             CONTINUE
 11858          ELSE
 11859             MOVE ER-3826        TO WS-ERROR
 11860             PERFORM 9900-ERROR-FORMAT
 11861                                 THRU 9900-EXIT
 11862          END-IF
 11863        ELSE
 11864          MOVE ER-3826           TO WS-ERROR
 11865          PERFORM 9900-ERROR-FORMAT
 11866                                 THRU 9900-EXIT
 11867        END-IF
 11868     END-IF
 11869
 11870
 11871
 11872******************************************************************ELC50PD
 11873******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11874******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11875******* METHODS.                                                  ELC50PD
 11876******************************************************************ELC50PD
 11877     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11878        IF PB-CANCELLATION                                        ELC50PD
 11879           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11880              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11881                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11882                IF FORM-MASTER-FOUND                              ELC50PD
 11883                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11884******************************************************************ELC50PD
 11885                                                                  ELC50PD
 11886     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11887     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11888                                                                  ELC50PD
 11889     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11890     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11891     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11892     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11893                                                                  ELC50PD
 11894                                                                  ELC50PD
 11895     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11896     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11897     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11898                                                                  ELC50PD
 11899     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11900         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11901                                                                  ELC50PD
 11902     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11903         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11904                                                                  ELC50PD
 11905     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11906         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 218
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11907                                                                  ELC50PD
 11908     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11909         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11910     ELSE                                                         ELC50PD
 11911         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11912                                                                  ELC50PD
 11913     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11914                                                                  ELC50PD
 11915     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11916         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11917                                                                  ELC50PD
 11918     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11919         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11920                                       WS-IG-OVRD                 ELC50PD
 11921     ELSE                                                         ELC50PD
 11922         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11923             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11924                                       WS-IG-OVRD                 ELC50PD
 11925         ELSE                                                     ELC50PD
 11926             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11927                                       WS-IG-OVRD.                ELC50PD
 11928                                                                  ELC50PD
 11929     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11930         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11931                                       WS-IG-OVRD                 ELC50PD
 11932     ELSE                                                         ELC50PD
 11933         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11934             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11935                                       WS-IG-OVRD                 ELC50PD
 11936         ELSE                                                     ELC50PD
 11937             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11938                                       WS-IG-OVRD.                ELC50PD
 11939                                                                  ELC50PD
 11940     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11941     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11942     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11943     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11944     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11945                                                                  ELC50PD
 11946     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11947     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11948     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11949     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11950                                                                  ELC50PD
 11951     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11952     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11953     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11954     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11955     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11956     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11957     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11958                                                                  ELC50PD
 11959     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11960        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11961     ELSE                                                         ELC50PD
 11962        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11963                                                                  ELC50PD
 11964     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 219
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11965        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11966     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11967        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11968                                                                  ELC50PD
 11969        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11970            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11971                                        WS-LF-REFUND-CALC.        ELC50PD
 11972                                                                  ELC50PD
 11973        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11974            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11975                                        WS-LF-REFUND-CALC.        ELC50PD
 11976                                                                  ELC50PD
 11977     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11978         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11979            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11980                                    WS-LF-REFUND-CALC.            ELC50PD
 11981     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11982         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11983            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11984                                    WS-LF-REFUND-CALC.            ELC50PD
 11985     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11986         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11987            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11988                                    WS-LF-REFUND-CALC.            ELC50PD
 11989     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11990         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11991            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11992                                    WS-LF-REFUND-CALC.            ELC50PD
 11993     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11994         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11995            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11996                                    WS-LF-REFUND-CALC.            ELC50PD
 11997     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11998         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11999            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12000                                    WS-LF-REFUND-CALC.            ELC50PD
 12001     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12002         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 12003            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12004                                    WS-LF-REFUND-CALC.            ELC50PD
 12005     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12006         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 12007            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12008                                    WS-LF-REFUND-CALC.            ELC50PD
 12009                                                                  ELC50PD
 12010     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 12011        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12012                                    WS-AH-REFUND-CALC.            ELC50PD
 12013     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 12014        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12015                                    WS-AH-REFUND-CALC.            ELC50PD
 12016     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 12017        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12018                                    WS-AH-REFUND-CALC.            ELC50PD
 12019     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 12020        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12021                                    WS-AH-REFUND-CALC.            ELC50PD
 12022     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 220
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12023        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12024                                    WS-AH-REFUND-CALC.            ELC50PD
 12025     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 12026        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12027                                    WS-AH-REFUND-CALC.            ELC50PD
 12028     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 12029        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12030                                    WS-AH-REFUND-CALC.            ELC50PD
 12031                                                                  ELC50PD
 12032     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 12033        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 12034                                    WS-TOL-AH-PREM.               ELC50PD
 12035                                                                  ELC50PD
 12036     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 12037                  AM-OVR-SHT-AMT > 0                              ELC50PD
 12038        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 12039                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 12040                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 12041                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 12042                                                                  ELC50PD
 12043     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 12044                    AM-OVR-SHT-PCT > 0                            ELC50PD
 12045        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 12046                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 12047                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 12048                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 12049                                                                  ELC50PD
 12050     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 12051                  AM-TOL-REF-PCT > 0                              ELC50PD
 12052        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 12053                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 12054                                                                  ELC50PD
 12055     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 12056                  AM-TOL-REF NUMERIC                              ELC50PD
 12057        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 12058                                    EC-AM-LF-TOL-REFUND           ELC50PD
 12059                                    WS-TOL-AH-REFUND              ELC50PD
 12060                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 12061                                                                  ELC50PD
 12062     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12063        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12064                                    WS-TOL-AH-CLAIM.              ELC50PD
 12065                                                                  ELC50PD
 12066     IF AM-CLP-TOL-PCT NOT NUMERIC
 12067        MOVE +0                  TO AM-CLP-TOL-PCT
 12068     END-IF
 12069
 12070     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12071        MOVE +0                  TO AM-SPP-LEASE-COMM
 12072     END-IF
 12073
 12074     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12075        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12076                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12077                                                                  ELC50PD
 12078     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12079        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12080                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 221
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12081                                                                  ELC50PD
 12082     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12083        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12084                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12085                                                                  ELC50PD
 12086     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12087        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12088                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12089                                                                  ELC50PD
 12090     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12091        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12092                                                                  ELC50PD
 12093     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12094        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12095                                                                  ELC50PD
 12096     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12097        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12098     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12099        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12100     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12101        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12102     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12103        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12104     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12105        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12106     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12107        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12108                                                                  ELC50PD
 12109     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12110        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12111                                                                  ELC50PD
 12112     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12113        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12114                                                                  ELC50PD
 12115     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12116     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12117                                                                  ELC50PD
 12118     IF PB-CANCELLATION                                           ELC50PD
 12119        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12120                                                                  ELC50PD
 12121     MOVE +1 TO SUB1.                                             ELC50PD
 12122     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12123     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12124                                                                  ELC50PD
 12125     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12126       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12127         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12128        ELSE                                                      ELC50PD
 12129         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12130                                                                  ELC50PD
 12131  0525-FIND-ACCT-COMM.                                            ELC50PD
 12132     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12133        NEXT SENTENCE                                             ELC50PD
 12134      ELSE                                                        ELC50PD
 12135         ADD +1 TO SUB1                                           ELC50PD
 12136         IF SUB1 LESS +11                                         ELC50PD
 12137            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12138          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 222
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12139             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12140                                                                  ELC50PD
 12141     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12142     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12143                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12144***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12145     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12146         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12147                                                                  ELC50PD
 12148     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12149     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12150                                                                  ELC50PD
 12151                                                                  ELC50PD
 12152 0530-GET-AH-COMP.                                                ELC50PD
 12153     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12154        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12155           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12156                                                                  ELC50PD
 12157     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12158        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12159         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12160         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12161         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12162         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12163     ELSE                                                         ELC50PD
 12164          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12165          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12166          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12167          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12168                                    WS-COMMISSION                 ELC50PD
 12169          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12170          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12171          IF WS-COMMISSION > ZEROS                                ELC50PD
 12172             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12173             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12174          END-IF                                                  ELC50PD
 12175          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12176          IF CTBL-TABLE-FOUND                                     ELC50PD
 12177             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12178                                        PB-I-AH-TERM              ELC50PD
 12179             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12180             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12181             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12182          ELSE                                                    ELC50PD
 12183             IF FIRST-TIME-THROUGH                                ELC50PD
 12184                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12185             ELSE                                                 ELC50PD
 12186                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12187                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12188                                                                  ELC50PD
 12189 0540-NEXT-READ-STEP.                                             ELC50PD
 12190     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12191     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12192                                                                  ELC50PD
 12193 0540-GET-LF-COMP.                                                ELC50PD
 12194     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12195        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12196           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 223
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12197                                                                  ELC50PD
 12198     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12199        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12200           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12201           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12202           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12203           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12204           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12205        ELSE                                                      ELC50PD
 12206           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12207           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12208           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12209           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12210                                        WS-COMMISSION             ELC50PD
 12211           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12212           IF WS-COMMISSION > ZEROS                               ELC50PD
 12213              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12214              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12215           END-IF                                                 ELC50PD
 12216           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12217           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12218           IF CTBL-TABLE-FOUND                                    ELC50PD
 12219              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12220              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12221              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12222              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12223           ELSE                                                   ELC50PD
 12224              IF FIRST-TIME-THROUGH                               ELC50PD
 12225                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12226              ELSE                                                ELC50PD
 12227                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12228                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12229                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12230                                                                  ELC50PD
 12231     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12232        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12233           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12234           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12235           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12236           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12237           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12238        ELSE                                                      ELC50PD
 12239           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12240           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12241           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12242           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12243                                        WS-COMMISSION             ELC50PD
 12244           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12245           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12246              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12247              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12248           END-IF                                                 ELC50PD
 12249           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12250           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12251           IF CTBL-TABLE-FOUND                                    ELC50PD
 12252              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12253              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12254              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 224
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12255              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12256           ELSE                                                   ELC50PD
 12257              IF FIRST-TIME-THROUGH                               ELC50PD
 12258                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12259              ELSE                                                ELC50PD
 12260                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12261                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12262                                                                  ELC50PD
 12263*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12264                                                                  ELC50PD
 12265 0560-EDIT-CONTINUE.                                              ELC50PD
 12266
 12267     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12268                                    WS-AH-PMF-COMM
 12269*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12270*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12271
 12272     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12273        (SUB1 > +10)
 12274        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12275           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12276           MOVE '0530'           TO CTBL-SW
 12277           MOVE ' '              TO WS-CTBL-READ-SW
 12278           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12279           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12280           MOVE '0540'           TO CTBL-SW
 12281           MOVE ' '              TO WS-CTBL-READ-SW
 12282           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12283        END-IF
 12284     END-PERFORM
 12285
 12286     GO TO 0564-EDIT-CONTINUE
 12287
 12288     .
 12289 0561-CHECK-AH.
 12290
 12291     IF (NO-AH-COVERAGE)
 12292        OR (NO-AH-BENEFIT-MATCH)
 12293        CONTINUE
 12294     ELSE
 12295        IF (AM-A-COM (SUB1) NUMERIC)
 12296           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12297           IF (AM-COM-TYP (SUB1) = 'A')
 12298              AND (WS-AH-PMF-COMM = ZEROS)
 12299              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12300           END-IF
 12301           CONTINUE
 12302        ELSE
 12303           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12304           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12305           MOVE PB-AH-OVERRIDE-L1
 12306                                 TO CTBL-BEN-TYPE
 12307           MOVE ZEROS            TO WS-SUB1
 12308                                    WS-COMMISSION
 12309           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12310           PERFORM 8300-READ-CTBL-TABLE
 12311                                 THRU 8300-EXIT
 12312           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 225
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12313              IF (AM-COM-TYP (SUB1) = 'A')
 12314                 AND (WS-AH-PMF-COMM = ZEROS)
 12315                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12316                                        PB-I-AH-TERM
 12317                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12318                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12319              END-IF
 12320              CONTINUE
 12321           ELSE
 12322              IF FIRST-TIME-THROUGH
 12323                 GO TO 0561-CHECK-AH
 12324              ELSE
 12325                 MOVE ER-2609    TO WS-ERROR
 12326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12327              END-IF
 12328           END-IF
 12329        END-IF
 12330     END-IF
 12331
 12332     .
 12333 0561-EXIT.
 12334     EXIT.
 12335
 12336 0563-CHECK-LF.
 12337
 12338     IF (NO-LIFE-COVERAGE)
 12339        OR (NO-LF-BENEFIT-MATCH)
 12340        CONTINUE
 12341     ELSE
 12342        IF WS-LF-JOINT-INDICATOR = 'J'
 12343           IF AM-J-COM (SUB1) NUMERIC
 12344              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12345              IF (AM-COM-TYP (SUB1) = 'A')
 12346                 AND (WS-LF-PMF-COMM = ZEROS)
 12347                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12348              END-IF
 12349              CONTINUE
 12350           ELSE
 12351              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12352              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12353              MOVE PB-LIFE-OVERRIDE-L1
 12354                                 TO CTBL-BEN-TYPE
 12355              MOVE ZEROS         TO WS-SUB1
 12356                                    WS-COMMISSION
 12357              MOVE AM-J-COMA (SUB1)
 12358                                 TO CTBL-TABLE
 12359              PERFORM 8300-READ-CTBL-TABLE
 12360                                 THRU 8300-EXIT
 12361              IF CTBL-TABLE-FOUND
 12362                 IF (AM-COM-TYP (SUB1) = 'A')
 12363                    AND (WS-LF-PMF-COMM = ZEROS)
 12364                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12365                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12366                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12367                 END-IF
 12368                 CONTINUE
 12369              ELSE
 12370                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 226
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12371                    GO TO 0563-CHECK-LF
 12372                 ELSE
 12373                    MOVE ER-2609 TO WS-ERROR
 12374                    PERFORM 9900-ERROR-FORMAT
 12375                                 THRU 9900-EXIT
 12376*                   GO TO 0560-EDIT-CONTINUE
 12377                 END-IF
 12378              END-IF
 12379           END-IF
 12380        ELSE
 12381           IF AM-L-COM (SUB1) NUMERIC
 12382              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12383              IF (AM-COM-TYP (SUB1) = 'A')
 12384                 AND (WS-LF-PMF-COMM = ZEROS)
 12385                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12386              END-IF
 12387              CONTINUE
 12388           ELSE
 12389              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12390              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12391              MOVE PB-LIFE-OVERRIDE-L1
 12392                                 TO CTBL-BEN-TYPE
 12393              MOVE ZEROS         TO WS-SUB1
 12394                                    WS-COMMISSION
 12395              MOVE AM-L-COMA (SUB1)
 12396                                 TO CTBL-TABLE
 12397              PERFORM 8300-READ-CTBL-TABLE
 12398                                 THRU 8300-EXIT
 12399              IF CTBL-TABLE-FOUND
 12400                 CONTINUE
 12401              ELSE
 12402                 IF FIRST-TIME-THROUGH
 12403                    GO TO 0563-CHECK-LF
 12404                 ELSE
 12405                    MOVE ER-2609 TO WS-ERROR
 12406                    PERFORM 9900-ERROR-FORMAT
 12407                                 THRU 9900-EXIT
 12408                 END-IF
 12409              END-IF
 12410           END-IF
 12411        END-IF
 12412     END-IF
 12413
 12414     .
 12415 0563-EXIT.
 12416     EXIT.
 12417
 12418 0564-EDIT-CONTINUE.
 12419                                                                  ELC50PD
 12420     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12421         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12422            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12423            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12424                                                                  ELC50PD
 12425*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12426*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12427*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12428*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 227
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12429*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12430*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12431*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12432*         ELSE                                                    ELC50PD
 12433*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12434*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12435
 12436     IF PB-I-BIRTHDAY > LOW-VALUES
 12437        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12438        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12439        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12440        PERFORM 8500-DATE-CONVERT
 12441                                 THRU 8500-EXIT
 12442        IF NO-CONVERSION-ERROR
 12443           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12444           IF PB-I-AGE > ZEROS
 12445              IF WS-WORK-AGE NOT = PB-I-AGE
 12446                 MOVE ER-9501    TO WS-ERROR
 12447                 PERFORM 9900-ERROR-FORMAT
 12448                                 THRU 9900-EXIT
 12449              END-IF
 12450           ELSE
 12451              MOVE WS-WORK-AGE   TO PB-I-AGE
 12452           END-IF
 12453        END-IF
 12454     END-IF
 12455
 12456     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12457                                   WS-INS-AGE-SET
 12458     IF PB-I-AGE = ZEROS                                          ELC50PD
 12459        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12460           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12461                                   WS-INS-AGE-SET
 12462           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12463                                                                  ELC50PD
 12464     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12465                                   WS-AH-EDIT-AGE.                ELC50PD
 12466                                                                  ELC50PD
 12467     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12468        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12469        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12470        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12471        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12472        IF NO-CONVERSION-ERROR
 12473           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12474           IF PB-I-JOINT-AGE > 0
 12475              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12476                 MOVE ER-9503    TO WS-ERROR
 12477                 PERFORM 9900-ERROR-FORMAT
 12478                                 THRU 9900-EXIT
 12479              END-IF
 12480           ELSE
 12481              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12482           END-IF
 12483        ELSE
 12484           MOVE ZEROS            TO PB-I-JOINT-AGE
 12485        END-IF
 12486     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 228
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12487
 12488     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12489        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12490                                                                  ELC50PD
 12491     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12492                                   WS-JNT-AGE-SET
 12493     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12494        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12495           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12496           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12497               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12498                                          WS-JNT-AGE-SET
 12499               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12500           END-IF
 12501        END-IF
 12502     END-IF
 12503                                                                  ELC50PD
 12504     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12505     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12506        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12507        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12508            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12509                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12510                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12511            ELSE                                                  ELC50PD
 12512                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12513                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12514                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12515                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12516                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12517                                                                  ELC50PD
 12518     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12519        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12520            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12521                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12522                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12523            ELSE                                                  ELC50PD
 12524                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12525                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12526                                           WS-EDIT-AGE
 12527                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12528                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12529                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12530                                                                  ELC50PD
 12531******************************************************************ELC50PD
 12532*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12533******************************************************************ELC50PD
 12534                                                                  ELC50PD
 12535     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12536        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12537        NEXT SENTENCE                                             ELC50PD
 12538     ELSE                                                         ELC50PD
 12539        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12540          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12541           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12542            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12543           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12544            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 229
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12545            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12546                                                                  ELC50PD
 12547     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12548        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12549         NEXT SENTENCE                                            ELC50PD
 12550     ELSE                                                         ELC50PD
 12551         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12552            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12553             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12554                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12555                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12556                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12557                                                                  ELC50PD
 12558     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12559        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12560           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12561           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12562               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12563                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12564                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12565                                                                  ELC50PD
 12566     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12567        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12568           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12569            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12570                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12571                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12572                                                                  ELC50PD
 12573     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12574        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12575           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12576              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12577              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12578              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12579                                                                  ELC50PD
 12580     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12581        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12582           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12583              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12584              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12585              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12586                                                                  ELC50PD
 12587     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12588         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12589            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12590              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12591              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12592
 12593     IF (WS-LF-JOINT-INDICATOR = 'J')
 12594        AND (WS-AH-JOINT-INDICATOR = 'J')
 12595        AND (PB-I-LF-TERM > 120)
 12596        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12597        MOVE ER-2783             TO WS-ERROR
 12598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12599     END-IF
 12600
 12601     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12602                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 230
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12603     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12604        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12606        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12607                                                                  ELC50PD
 12608     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12609        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12611        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12612                                                                  ELC50PD
 12613     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12614        NEXT SENTENCE                                             ELC50PD
 12615     ELSE                                                         ELC50PD
 12616        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12617                                                                  ELC50PD
 12618     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12619        IF WS-ERROR = ER-2666                                     ELC50PD
 12620           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12621           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12622
 12623     IF PB-COMPANY-ID = 'CID'
 12624        IF PB-STATE = 'UT' OR 'MO'
 12625           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12626                 OR '76' OR '77')
 12627                      OR
 12628               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12629                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12630                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12631                   OR '2K' OR '2L'))
 12632              AND PB-I-INDV-GRP-CD = 'I'
 12633              MOVE ER-2721             TO WS-ERROR
 12634              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12635           END-IF
 12636        END-IF
 12637     END-IF
 12638                                                                  ELC50PD
 12639     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12640     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12641        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12642     ELSE
 12643        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12644     END-IF
 12645
 12646*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12647*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12648     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12649                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12650                                                                  ELC50PD
 12651     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12652        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12653        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12654        PB-POLICY-IS-VOIDED                                       ELC50PD
 12655*       OR PB-MONTHLY-CERT
 12656         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12657                                                                  ELC50PD
 12658     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12659        IF WS-EDIT-AGE           > +65
 12660           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 231
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12661           PERFORM 9900-ERROR-FORMAT
 12662                                 THRU 9900-EXIT
 12663        ELSE
 12664           IF WS-EDIT-AGE        > +55
 12665              MOVE ER-2718       TO WS-ERROR
 12666              PERFORM 9900-ERROR-FORMAT
 12667                                 THRU 9900-EXIT
 12668           END-IF
 12669        END-IF
 12670
 12671     IF PB-COMPANY-ID = 'DCC'
 12672        IF WS-EDIT-AGE           > +65
 12673           MOVE ER-2709          TO WS-ERROR
 12674           PERFORM 9900-ERROR-FORMAT
 12675                                 THRU 9900-EXIT
 12676        END-IF
 12677     END-IF
 12678     .
 12679
 12680 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12681                                                                  ELC50PD
 12682     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12683        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12684                                    EC-AM-LF-MAX-TOT-BEN
 12685        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12686                                                                  ELC50PD
 12687     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12688                                                                  ELC50PD
 12689     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12690         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12691             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12692                                                                  ELC50PD
 12693     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12694        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12695        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12696        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12697                                                                  ELC50PD
 12698     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12699     MOVE +1                     TO SUB2.                         ELC50PD
 12700                                                                  ELC50PD
 12701     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12702        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12703           MOVE +5   TO SUB2                                      ELC50PD
 12704           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12705              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12706              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12707              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12708              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12709                                                                  ELC50PD
 12710     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12711                                                                  ELC50PD
 12712     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12713                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12714                                                                  ELC50PD
 12715 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12716                                                                  ELC50PD
 12717
 12718     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 232
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12719        PL-ATT-AGE > +0
 12720        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12721     END-IF
 12722
 12723
 12724
 12725*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12726*       PL-ATT-AGE > +0
 12727*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12728*       IF PB-I-BIRTHDAY > LOW-VALUES
 12729*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12730*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12731*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12732*          SET BIN-PLUS-ELAPSED  TO TRUE
 12733*          PERFORM 8500-DATE-CONVERT
 12734*                                THRU 8500-EXIT
 12735*          IF NO-CONVERSION-ERROR
 12736*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12737*             MOVE ER-2669       TO WS-ERROR
 12738*             PERFORM 9900-ERROR-FORMAT
 12739*                                THRU 9900-EXIT
 12740*          END-IF
 12741*       ELSE
 12742*          IF WS-ATT-AGE >= PL-ATT-AGE
 12743*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12744*             PERFORM 9900-ERROR-FORMAT
 12745*                                THRU 9900-EXIT
 12746*          END-IF
 12747*       END-IF
 12748*    END-IF
 12749
 12750     .
 12751 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12752                                                                  ELC50PD
 12753     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12754        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12755           IF SUB2 GREATER THAN +4                                ELC50PD
 12756              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12757              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12758              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12759                                                                  ELC50PD
 12760     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12761        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12762            SUB2 GREATER THAN +8                                  ELC50PD
 12763             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12764             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12765             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12766             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12767                                                                  ELC50PD
 12768     IF SUB2 > +8
 12769        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12770           AND (PB-I-SIG-SW = 'Y')
 12771           CONTINUE
 12772        ELSE
 12773           MOVE ER-2637          TO WS-ERROR
 12774           PERFORM 9900-ERROR-FORMAT
 12775                                 THRU 9900-EXIT
 12776        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 233
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12777        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12778     END-IF
 12779
 12780     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12781     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12782     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12783                                                                  ELC50PD
 12784     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12785        ADD +1  TO SUB2                                           ELC50PD
 12786        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12787                                                                  ELC50PD
 12788     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12789         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12790                                                                  ELC50PD
 12791     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12792        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12793        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12794           AND (PB-I-SIG-SW = 'Y')
 12795           CONTINUE
 12796        ELSE
 12797           MOVE ER-2637          TO WS-ERROR
 12798           PERFORM 9900-ERROR-FORMAT
 12799                                 THRU 9900-EXIT
 12800        END-IF
 12801     END-IF
 12802
 12803     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12804                                                                  ELC50PD
 12805                                                                  ELC50PD
 12806 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12807                                                                  ELC50PD
 12808     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12809        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12810         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12811                                                                  ELC50PD
 12812     IF APP-CERT-USED                                             ELC50PD
 12813         IF SUB2  LESS THAN  +5                                   ELC50PD
 12814             MOVE +5          TO SUB2                             ELC50PD
 12815             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12816                                                                  ELC50PD
 12817     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12818     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12819                                                                  ELC50PD
 12820     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12821                                                                  ELC50PD
 12822 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12823                                                                  ELC50PD
 12824     IF NOT APP-CERT-USED                                         ELC50PD
 12825         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12826                                                                  ELC50PD
 12827     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12828        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12829        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12830        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12831         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12832                                                                  ELC50PD
 12833     IF SUB2 GREATER THAN +4                                      ELC50PD
 12834         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 234
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12835            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12836            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12837            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12838             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12839             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12840             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12841         ELSE                                                     ELC50PD
 12842             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12843                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12844                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12845                                                                  ELC50PD
 12846     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12847       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12848          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12849           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12850           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12851           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12852                                                                  ELC50PD
 12853                                                                  ELC50PD
 12854 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12855                                                                  ELC50PD
 12856     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12857        IF PB-I-AH-BENEFIT-AMT > +1250
 12858           MOVE ER-2702          TO WS-ERROR
 12859           PERFORM 9900-ERROR-FORMAT
 12860                                 THRU 9900-EXIT
 12861        END-IF
 12862     END-IF
 12863
 12864     IF (PB-COMPANY-ID = 'DCC')
 12865        AND (PB-MONTHLY-CERT)
 12866        IF PB-I-AH-BENEFIT-AMT > +3000
 12867           MOVE ER-2881          TO WS-ERROR
 12868           PERFORM 9900-ERROR-FORMAT
 12869                                 THRU 9900-EXIT
 12870        END-IF
 12871     END-IF
 12872
 12873     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12874        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12875        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12876                                                                  ELC50PD
 12877     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12878                                                                  ELC50PD
 12879     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12880         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12881             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12882                                                                  ELC50PD
 12883     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12884        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12885        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12886        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12887                                                                  ELC50PD
 12888     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12889     MOVE +1                     TO SUB2.                         ELC50PD
 12890                                                                  ELC50PD
 12891     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12892        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 235
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12893           MOVE +5 TO SUB2                                        ELC50PD
 12894           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12895              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12896              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12897              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12898              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12899              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12900                                                                  ELC50PD
 12901     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12902                                                                  ELC50PD
 12903 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12904                                                                  ELC50PD
 12905     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12906        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12907        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12908     END-IF
 12909*       IF WS-ATT-AGE >= PL-ATT-AGE
 12910*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12911*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12912     .
 12913 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12914                                                                  ELC50PD
 12915     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12916        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12917           IF SUB2 GREATER THAN +4                                ELC50PD
 12918              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12919              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12920              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12921                                                                  ELC50PD
 12922     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12923        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12924            SUB2 GREATER THAN +8                                  ELC50PD
 12925             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12926             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12928             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12929                                                                  ELC50PD
 12930     IF SUB2 > +8
 12931        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12932           AND (PB-I-SIG-SW = 'Y')
 12933           CONTINUE
 12934        ELSE
 12935           MOVE ER-2638          TO WS-ERROR
 12936           PERFORM 9900-ERROR-FORMAT
 12937                                 THRU 9900-EXIT
 12938        END-IF
 12939        GO TO 3000-CONTINUE-EDIT
 12940     END-IF
 12941                                                                  ELC50PD
 12942     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12943        IF WS-ERROR = ER-2638                                     ELC50PD
 12944           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12945                                                                  ELC50PD
 12946     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12947     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12948     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12949     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12950                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 236
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12951     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12952        ADD +1                   TO SUB2                          ELC50PD
 12953        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12954                                                                  ELC50PD
 12955     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12956         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12957                                                                  ELC50PD
 12958     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12959        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12960        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12961                                 > PL-LM-AMT (SUB2))
 12962        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12963           AND (PB-I-SIG-SW = 'Y')
 12964           CONTINUE
 12965        ELSE
 12966           MOVE ER-2638          TO WS-ERROR
 12967           PERFORM 9900-ERROR-FORMAT
 12968                                 THRU 9900-EXIT
 12969        END-IF
 12970     END-IF
 12971                                                                  ELC50PD
 12972     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12973         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12974             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12975                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12976                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12977                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12978                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12979                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12980                                                                  ELC50PD
 12981     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12982        IF WS-ERROR = ER-2638                                     ELC50PD
 12983            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12984            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12985            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12986                                                                  ELC50PD
 12987     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12988                                                                  ELC50PD
 12989 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12990                                                                  ELC50PD
 12991     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12992        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12993        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12994                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12995         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12996                                                                  ELC50PD
 12997     IF APP-CERT-USED                                             ELC50PD
 12998         IF SUB2  LESS THAN  +5                                   ELC50PD
 12999             MOVE +5             TO SUB2                          ELC50PD
 13000             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 13001                                                                  ELC50PD
 13002     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 13003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13004                                                                  ELC50PD
 13005     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 13006                                                                  ELC50PD
 13007 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 13008                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 237
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13009     IF NOT APP-CERT-USED                                         ELC50PD
 13010         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13011                                                                  ELC50PD
 13012     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 13013        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 13014        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 13015        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 13016         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13017                                                                  ELC50PD
 13018     IF SUB2 GREATER THAN +4                                      ELC50PD
 13019         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 13020            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 13021            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 13022            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 13023             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 13024             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13025             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 13026         ELSE                                                     ELC50PD
 13027             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 13028                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 13029                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 13030                                                                  ELC50PD
 13031     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 13032       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 13033          NOT PB-I-POLICY-DECLINED                                ELC50PD
 13034           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 13035           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 13036           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 13037                                                                  ELC50PD
 13038******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 238
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13040                                                                  ELC50PD
 13041 3000-CONTINUE-EDIT.                                              ELC50PD
 13042                                                                  ELC50PD
 13043     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 13044     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 13045     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 13046     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 13047     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 13048                                                                  ELC50PD
 13049     IF BROWSE-STARTED                                            ELC50PD
 13050        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 13051        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 13052                                                                  ELC50PD
 13053     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 13054        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 13055        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 13056        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 13057*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 13058        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13059        IF DATE-CONVERSION-ERROR                                  ELC50PD
 13060           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 13061           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13062        ELSE                                                      ELC50PD
 13063           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13064              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13065              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13066           ELSE                                                   ELC50PD
 13067              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13068              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13069                                                                  ELC50PD
 13070     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13071     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13072     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13073*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13074     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13075     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13076        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13077     ELSE                                                         ELC50PD
 13078        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13079           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13080           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13081        ELSE                                                      ELC50PD
 13082           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13083              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13084              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13085           ELSE                                                   ELC50PD
 13086             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13087                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13088                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13089                                                                  ELC50PD
 13090 3005-EDIT-CONTINUE.                                              ELC50PD
 13091                                                                  ELC50PD
 13092     IF PB-CANCELLATION                                           ELC50PD
 13093         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13094                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 239
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13096******************************************************************ELC50PD
 13097*                  E D I T   I S S U E                           *ELC50PD
 13098******************************************************************ELC50PD
 13099                                                                  ELC50PD
 13100 3020-EDIT-ISSUE.                                                 ELC50PD
 13101                                                                  ELC50PD
 13102      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13103      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13104      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13105      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13106      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13107                                                                  ELC50PD
 13108     IF PB-ISSUE-FORCE
 13109        OR PB-ISSUE-DATE-FORCED
 13110        OR PB-FORCE-OFF
 13111        OR PB-OVERCHARGE-FORCE
 13112        CONTINUE
 13113     ELSE
 13114        MOVE ER-2670             TO WS-ERROR
 13115        PERFORM 9900-ERROR-FORMAT
 13116                                 THRU 9900-EXIT
 13117     END-IF
 13118
 13119     .
 13120 3022-SET-POLICY-STATUS.                                          ELC50PD
 13121                                                                  ELC50PD
 13122     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13123                                                                  ELC50PD
 13124     IF (PB-REISSUED-CERT)
 13125             OR
 13126        ((PB-COMPANY-ID NOT = 'DCC')
 13127         AND (PB-MONTHLY-CERT))
 13128         MOVE '5'                TO PB-I-ENTRY-STATUS
 13129         MOVE 'E'                TO PB-BATCH-ENTRY
 13130     END-IF
 13131
 13132     IF PB-COMPANY-ID = 'DCC'
 13133        IF PB-MONTHLY-CERT
 13134           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13135        END-IF
 13136     END-IF
 13137     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13138         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13139     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13140         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13141     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13142         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13143     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13144         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13145     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13146         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13147                                                                  ELC50PD
 13148     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13149                                                                  ELC50PD
 13150     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13151         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13153         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 240
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13154                                                                  ELC50PD
 13155     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13156        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13157           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13158                                                                  ELC50PD
 13159     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13160        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13161           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13162                                                                  ELC50PD
 13163     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13164         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13165         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13166         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13167         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13168         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13169         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13170         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13171     END-IF
 13172                                                                  ELC50PD
 13173     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13174        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13175         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13176                                                                  ELC50PD
 13177     IF (ACCOUNT-MAST-FOUND)
 13178        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13179        IF PB-REISSUED-CERT
 13180           CONTINUE
 13181        ELSE
 13182           MOVE ER-2608          TO WS-ERROR
 13183           PERFORM 9900-ERROR-FORMAT
 13184                                 THRU 9900-EXIT
 13185         END-IF
 13186     END-IF
 13187                                                                  ELC50PD
 13188     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13189        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13190        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13191                                                                  ELC50PD
 13192**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13193 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13194     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13195        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13196                                                                  ELC50PD
 13197*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13198*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13199*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13200                                                                  ELC50PD
 13201     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13202     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13203     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13204     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13205**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13206                                                                  ELC50PD
 13207     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13208     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13209     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13210     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13211**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 241
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13212                                                                  ELC50PD
 13213     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13214        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13216                                                                  ELC50PD
 13217     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13218                                                                  ELC50PD
 13219     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13220                                      WK-FULL-CERT-NO.            ELC50PD
 13221     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13222                                                                  ELC50PD
 13223     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13224                                                                  ELC50PD
 13225     IF PB-VALID-LIFE                                             ELC50PD
 13226        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13227     ELSE                                                         ELC50PD
 13228        IF PB-VALID-AH                                            ELC50PD
 13229          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13230                                                                  ELC50PD
 13231                                                                  ELC50PD
 13232     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13233     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13234     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13235                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13236                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13237                                      DCUA-RETURN-CODE.           ELC50PD
 13238                                                                  ELC50PD
 13239****************************************************************  ELC50PD
 13240*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13241***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13242***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13243***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13244***   TO THIS RECORD.                                        ***  ELC50PD
 13245****************************************************************  ELC50PD
 13246     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13247     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13248     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13249        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13250                                                                  ELC50PD
 13251     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13252        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13253        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13255        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13256                                                                  ELC50PD
 13257     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13258        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13259        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13261        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13262                                                                  ELC50PD
 13263     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13264        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13265        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13267        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13268                                                                  ELC50PD
 13269     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 242
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13270        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13271        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13273        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13274                                                                  ELC50PD
 13275     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13276        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13277        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13279        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13280                                                                  ELC50PD
 13281     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13282        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13283        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13285        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13286                                                                  ELC50PD
 13287     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13288        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13289        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13290        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13291        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13292                                                                  ELC50PD
 13293     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13294        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13295        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13297        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13298                                                                  ELC50PD
 13299     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13300        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13301        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13303        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13304                                                                  ELC50PD
 13305     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13306        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13307        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13309        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13310                                                                  ELC50PD
 13311     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13312        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13313        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13315        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13316                                                                  ELC50PD
 13317     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13318        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13319        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13321        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13322                                                                  ELC50PD
 13323     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13324        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13325        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13327        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 243
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13328                                                                  ELC50PD
 13329     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13330        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13331        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13333        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13334                                                                  ELC50PD
 13335     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13336        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13337        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13339        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13340                                                                  ELC50PD
 13341     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13342     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13343     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13344     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13345                                                                  ELC50PD
 13346 3024-EDIT-DL7-CONT.                                              ELC50PD
 13347                                                                  ELC50PD
 13348     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13349     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13350     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13351        NEXT SENTENCE                                             ELC50PD
 13352     ELSE                                                         ELC50PD
 13353        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13355                                                                  ELC50PD
 13356******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13357******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13358     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13359        NEXT SENTENCE                                             ELC50PD
 13360     ELSE                                                         ELC50PD
 13361        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13363                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 244
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13365****************************************************************  ELC50PD
 13366*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13367****************************************************************  ELC50PD
 13368     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13369     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13370                                                                  ELC50PD
 13371     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13372     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13373        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13374                                                                  ELC50PD
 13375     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13376        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13378        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13379                                                                  ELC50PD
 13380     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13381        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13383        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13384                                                                  ELC50PD
 13385     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13386        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13388        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13389                                                                  ELC50PD
 13390     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13391        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13393        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13394                                                                  ELC50PD
 13395     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13396     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13397                                                                  ELC50PD
 13398 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 245
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13400****************************************************************  ELC50PD
 13401*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13402****************************************************************  ELC50PD
 13403                                                                  ELC50PD
 13404     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13405     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13406     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13407     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13408        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13409                                                                  ELC50PD
 13410     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13411        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13413        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13414                                                                  ELC50PD
 13415     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13416        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13418        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13419                                                                  ELC50PD
 13420     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13421        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13423        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13424                                                                  ELC50PD
 13425     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13426        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13428        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13429                                                                  ELC50PD
 13430     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13431        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13433        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13434                                                                  ELC50PD
 13435     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13436     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13437     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13438                                                                  ELC50PD
 13439 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 246
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13441                                                                  ELC50PD
 13442****************************************************************  ELC50PD
 13443*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13444****************************************************************  ELC50PD
 13445                                                                  ELC50PD
 13446     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13447     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13448     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13449     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13450     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13451        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13452                                                                  ELC50PD
 13453     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13454        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13456        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13457                                                                  ELC50PD
 13458     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13459        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13461        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13462                                                                  ELC50PD
 13463     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13464        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13465        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13466        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13467                                                                  ELC50PD
 13468     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13469     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13470     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13471                                                                  ELC50PD
 13472 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 247
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13474                                                                  ELC50PD
 13475****************************************************************  ELC50PD
 13476*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13477****************************************************************  ELC50PD
 13478                                                                  ELC50PD
 13479     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13480     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13481     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13482        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13484                                                                  ELC50PD
 13485     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13486     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13487     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13488     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13489     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13490     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13491        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13492                                                                  ELC50PD
 13493     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13494        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13496        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13497                                                                  ELC50PD
 13498     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13499        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13501        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13502                                                                  ELC50PD
 13503     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13504        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13506        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13507                                                                  ELC50PD
 13508     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13509        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13511        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13512                                                                  ELC50PD
 13513     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13514        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13516        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13517                                                                  ELC50PD
 13518     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13519        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13521        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13522                                                                  ELC50PD
 13523     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13524     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13525     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13526                                                                  ELC50PD
 13527 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 248
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13529                                                                  ELC50PD
 13530     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13531        NEXT SENTENCE                                             ELC50PD
 13532     ELSE                                                         ELC50PD
 13533        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13535                                                                  ELC50PD
 13536     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13537     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13538     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13539                                                                  ELC50PD
 13540     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13541        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13543        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13544                                                                  ELC50PD
 13545     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13546        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13548        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13549                                                                  ELC50PD
 13550     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13551        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13553        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13554                                                                  ELC50PD
 13555     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13556        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13558        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13559                                                                  ELC50PD
 13560     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13561        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13563        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13564                                                                  ELC50PD
 13565     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13566        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13568                                                                  ELC50PD
 13569 3024-EDIT-DL01-CONT.                                             ELC50PD
 13570******************************************************************ELC50PD
 13571***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13572******************************************************************ELC50PD
 13573                                                                  ELC50PD
 13574      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13575      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13576      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13577      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13578        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13579        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13580                                                                  ELC50PD
 13581      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13582                                                                  ELC50PD
 13583      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13584         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13586         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 249
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13587                                                                  ELC50PD
 13588      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13589         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13591         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13592                                                                  ELC50PD
 13593      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13594         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13596         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13597                                                                  ELC50PD
 13598       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13599       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13600       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13601                                                                  ELC50PD
 13602******************************************************************ELC50PD
 13603***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13604******************************************************************ELC50PD
 13605                                                                  ELC50PD
 13606 3024-CHECK-VALID-RATE.                                           ELC50PD
 13607                                                                  ELC50PD
 13608     IF VALID-RATE-CODE                                           ELC50PD
 13609        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13610        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13611        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13612        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13613     ELSE                                                         ELC50PD
 13614         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13615                                                                  ELC50PD
 13616      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13617         IF PB-VALID-LIFE                                         ELC50PD
 13618             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13619             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13620         ELSE                                                     ELC50PD
 13621             IF PB-VALID-AH                                       ELC50PD
 13622                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13623                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13624                                                                  ELC50PD
 13625      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13626         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13628         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13629                                                                  ELC50PD
 13630      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13631         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13632         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13633         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13634                                                                  ELC50PD
 13635      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13636         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13637         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13638         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13639                                                                  ELC50PD
 13640      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13641         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13642            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13643            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13644            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 250
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13645          ELSE                                                    ELC50PD
 13646         IF PB-VALID-LIFE                                         ELC50PD
 13647            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13648          ELSE                                                    ELC50PD
 13649            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13650         END-IF                                                   ELC50PD
 13651         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13652         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13653         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13654         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13655             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13656             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13657           ELSE                                                   ELC50PD
 13658             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13659             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13660             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13661                                                                  ELC50PD
 13662       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13663       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13664       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13665                                                                  ELC50PD
 13666**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13667                                                                  ELC50PD
 13668 3025-EDIT-REINSURANCE.                                           ELC50PD
 13669     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13670         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13671                                                                  ELC50PD
 13672     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13673     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13674     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13675                                      REIN-CODE-2                 ELC50PD
 13676                                      REIN-CODE-3.                ELC50PD
 13677     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13678                                                                  ELC50PD
 13679     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13680                                                                  ELC50PD
 13681     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13682     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13683                                                                  ELC50PD
 13684     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13685     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13686         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13687                                                                  ELC50PD
 13688     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13689     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13690                                   WS-NSP-ST-CD-LF.               ELC50PD
 13691     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13692                                   WS-NSP-ST-CD-AH.               ELC50PD
 13693                                                                  ELC50PD
 13694     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13695                                                                  ELC50PD
 13696 3026-NO-SPEC-TABLE.                                              ELC50PD
 13697                                                                  ELC50PD
 13698     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13700     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13701                                                                  ELC50PD
 13702 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 251
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13703                                                                  ELC50PD
 13704     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13705       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13706                                                                  ELC50PD
 13707     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13708          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13709          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13710           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13711                                                                  ELC50PD
 13712     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13713     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13714     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13715     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13716                                                                  ELC50PD
 13717     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13718     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13719                                                                  ELC50PD
 13720     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13721     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13722         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13723                                                                  ELC50PD
 13724     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13725     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13726                                   WS-NSP-ST-CD-LF.               ELC50PD
 13727     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13728                                   WS-NSP-ST-CD-AH.               ELC50PD
 13729                                                                  ELC50PD
 13730     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13731                                                                  ELC50PD
 13732 3028-NO-REIN-TABLE.                                              ELC50PD
 13733                                                                  ELC50PD
 13734     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13736     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13737                                                                  ELC50PD
 13738 3040-EDIT-CONTINUE.                                              ELC50PD
 13739                                                                  ELC50PD
 13740     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13741         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13742                                                                  ELC50PD
 13743     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13744         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13745                                                                  ELC50PD
 13746     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13747        AND (NOT PB-MONTHLY-CERT)
 13748        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13749            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13750            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13751                                                                  ELC50PD
 13752     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13753        AND (NOT PB-MONTHLY-CERT)
 13754        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13755            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13756            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13757                                                                  ELC50PD
 13758 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13759
 13760     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 252
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13761     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13762         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13763                                                                  ELC50PD
 13764******************************************************************ELC50PD
 13765*                                                                *ELC50PD
 13766*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13767*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13768*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13769*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13770*                                                                *ELC50PD
 13771******************************************************************ELC50PD
 13772                                                                  ELC50PD
 13773     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13774        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13775                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13776                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13777        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13778        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13779        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13780        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13781        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13782*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13783        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13784        IF NO-CONVERSION-ERROR                                    ELC50PD
 13785           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13786                                                                  ELC50PD
 13787******************************************************************ELC50PD
 13788*                                                                *ELC50PD
 13789*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13790*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13791*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13792*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13793*                                                                *ELC50PD
 13794******************************************************************ELC50PD
 13795                                                                  ELC50PD
 13796     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13797          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13798                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13799                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13800          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13801          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13802          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13803          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13804          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13805*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13806          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13807          IF NO-CONVERSION-ERROR                                  ELC50PD
 13808             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13809                                                                  ELC50PD
 13810******************************************************************ELC50PD
 13811*                                                                *ELC50PD
 13812*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13813*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13814*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13815*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13816*                                                                *ELC50PD
 13817******************************************************************ELC50PD
 13818                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 253
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13819     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13820        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13821           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13822              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13823              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13824           ELSE                                                   ELC50PD
 13825              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13826              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13827        ELSE                                                      ELC50PD
 13828           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13829              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13830              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13831           ELSE                                                   ELC50PD
 13832              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13833              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13834                                                                  ELC50PD
 13835     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13836        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13837        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13838        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13839        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13840                                    DC-ODD-DAYS-OVER              ELC50PD
 13841          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13842          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13843*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13844          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13845          IF NO-CONVERSION-ERROR                                  ELC50PD
 13846             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13847                                                                  ELC50PD
 13848******************************************************************ELC50PD
 13849*                                                                *ELC50PD
 13850*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13851*                                                                *ELC50PD
 13852******************************************************************ELC50PD
 13853                                                                  ELC50PD
 13854     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13855        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13856                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13857        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13858                                                                  ELC50PD
 13859     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13860         NEXT SENTENCE                                            ELC50PD
 13861     ELSE                                                         ELC50PD
 13862         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13864         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13865                                                                  ELC50PD
 13866     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13867     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13868     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13869*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13870     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13871                                    DC-ELAPSED-DAYS               ELC50PD
 13872                                    DC-ODD-DAYS-OVER.             ELC50PD
 13873                                                                  ELC50PD
 13874     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13875                                                                  ELC50PD
 13876     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 254
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13877        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13878                                                                  ELC50PD
 13879     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13880
 13881     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13882        AND (WS-LF-COVERAGE-TYPE = 'L')
 13883        IF (DC-ELAPSED-MONTHS > 1)
 13884                      OR
 13885           ((DC-ELAPSED-MONTHS = 1)
 13886           AND (DC-ODD-DAYS-OVER > 0))
 13887           MOVE ER-2882          TO WS-ERROR
 13888           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889        END-IF
 13890     END-IF
 13891
 13892     if dc-elapsed-months > 0
 13893        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13894        + dc-odd-days-over
 13895     end-if
 13896
 13897     IF PB-EXT-DAYS-PROCESSING
 13898        CONTINUE
 13899     ELSE
 13900        IF DC-ELAPSED-MONTHS = +0
 13901           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13902        ELSE
 13903           IF (WS-LF-EARNINGS-CALC = '4')
 13904              AND (DC-ELAPSED-MONTHS > ZERO)
 13905              AND (DC-ELAPSED-DAYS > ZERO)
 13906              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13907           ELSE
 13908              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13909                                 THRU 6499-EXIT
 13910              MOVE WS-ODD-DAYS-OVER
 13911                                 TO PB-I-EXTENTION-DAYS
 13912           END-IF
 13913        END-IF
 13914     END-IF
 13915
 13916******************************************************************ELC50PD
 13917*                                                                *ELC50PD
 13918*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13919*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13920*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13921*            AND ANY ODD DAYS.                                   *ELC50PD
 13922*                                                                *ELC50PD
 13923******************************************************************ELC50PD
 13924                                                                  ELC50PD
 13925     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13926                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13927     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13928        IF DC-ELAPSED-DAYS > ZEROS
 13929           MOVE ER-2681          TO WS-ERROR
 13930           PERFORM 9900-ERROR-FORMAT
 13931                                 THRU 9900-EXIT
 13932        END-IF
 13933     END-IF
 13934                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 255
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13935     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13936        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13937           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13938           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13939                                                                  ELC50PD
 13940     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13941        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13942         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13943          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13944          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13945          IF WS-LF-EARNINGS-CALC = '4'
 13946             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13947             PB-I-PAY-FREQUENCY
 13948          END-IF
 13949          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13950                                    DC-ODD-DAYS-OVER              ELC50PD
 13951          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13952          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13953*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13954          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13955          IF NO-CONVERSION-ERROR                                  ELC50PD
 13956             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13957             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13958                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13959                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13960                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13961                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13962                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13963*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13964                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13965                  IF NO-CONVERSION-ERROR                          ELC50PD
 13966                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13967                                                                  ELC50PD
 13968* okay, i had to move the new att age edit down here because the
 13969* expiration date could get recalculated and i need the exp date
 13970
 13971
 13972     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13973        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13974        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13975        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13976           AND ZEROS
 13977           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13978           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13979           SET ELAPSED-BETWEEN-BIN TO TRUE
 13980           PERFORM 8500-DATE-CONVERT
 13981                                 THRU 8500-EXIT
 13982           IF NO-CONVERSION-ERROR
 13983              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13984                 MOVE ER-2669       TO WS-ERROR
 13985*                PERFORM 9900-ERROR-FORMAT
 13986*                                THRU 9900-EXIT
 13987              END-IF
 13988           END-IF
 13989        ELSE
 13990           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13991           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13992              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 256
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13993*             PERFORM 9900-ERROR-FORMAT
 13994*                                THRU 9900-EXIT
 13995           ELSE
 13996              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13997                 MOVE ER-1570    TO WS-ERROR
 13998                 PERFORM 9900-ERROR-FORMAT
 13999                                 THRU 9900-EXIT
 14000              END-IF
 14001           END-IF
 14002        END-IF
 14003
 14004        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14005           AND ZEROS
 14006           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14007           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14008           SET ELAPSED-BETWEEN-BIN TO TRUE
 14009           PERFORM 8500-DATE-CONVERT
 14010                                 THRU 8500-EXIT
 14011           IF NO-CONVERSION-ERROR
 14012              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 14013                 MOVE ER-2669       TO WS-ERROR
 14014*                PERFORM 9900-ERROR-FORMAT
 14015*                                THRU 9900-EXIT
 14016              END-IF
 14017           END-IF
 14018        ELSE
 14019           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14020             (PB-I-LF-TERM / 12)
 14021           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14022              MOVE ER-2669       TO WS-ERROR
 14023*             PERFORM 9900-ERROR-FORMAT
 14024*                                THRU 9900-EXIT
 14025           ELSE
 14026              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14027                 MOVE ER-1571    TO WS-ERROR
 14028                 PERFORM 9900-ERROR-FORMAT
 14029                                 THRU 9900-EXIT
 14030              END-IF
 14031           END-IF
 14032        END-IF
 14033        IF WS-ERROR = ER-2669
 14034           PERFORM 9900-ERROR-FORMAT
 14035                                 THRU 9900-EXIT
 14036        END-IF
 14037
 14038     END-IF
 14039
 14040     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 14041        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 14042         NOT NO-AH-COVERAGE                                       ELC50PD
 14043          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 14044             AND (PB-COMPANY-ID = 'DCC')
 14045             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 14046             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 14047          ELSE
 14048             IF WS-LF-EARNINGS-CALC = '4'
 14049                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 14050                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 257
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14051                PB-I-PAY-FREQUENCY
 14052             ELSE
 14053                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 14054                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 14055             END-IF
 14056          END-IF
 14057          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 14058                                         DC-ODD-DAYS-OVER         ELC50PD
 14059          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 14060          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 14061*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14062          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14063          IF NO-CONVERSION-ERROR                                  ELC50PD
 14064             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14065
 14066     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14067        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14068        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14069        IF PB-I-BIRTHDAY > LOW-VALUES
 14070           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14071           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14072           SET ELAPSED-BETWEEN-BIN TO TRUE
 14073           PERFORM 8500-DATE-CONVERT
 14074                                 THRU 8500-EXIT
 14075           IF NO-CONVERSION-ERROR
 14076              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14077                 MOVE ER-3054       TO WS-ERROR
 14078*                PERFORM 9900-ERROR-FORMAT
 14079*                                THRU 9900-EXIT
 14080              END-IF
 14081           END-IF
 14082        ELSE
 14083           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14084           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14085              MOVE ER-3054       TO WS-ERROR
 14086*             PERFORM 9900-ERROR-FORMAT
 14087*                                THRU 9900-EXIT
 14088           END-IF
 14089        END-IF
 14090
 14091        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14092           AND ZEROS
 14093           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14094           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14095           SET ELAPSED-BETWEEN-BIN TO TRUE
 14096           PERFORM 8500-DATE-CONVERT
 14097                                 THRU 8500-EXIT
 14098           IF NO-CONVERSION-ERROR
 14099              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14100                 MOVE ER-3054       TO WS-ERROR
 14101*                PERFORM 9900-ERROR-FORMAT
 14102*                                THRU 9900-EXIT
 14103              END-IF
 14104           END-IF
 14105        ELSE
 14106           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14107             (PB-I-AH-TERM / 12)
 14108           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 258
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14109              MOVE ER-3054       TO WS-ERROR
 14110*             PERFORM 9900-ERROR-FORMAT
 14111*                                THRU 9900-EXIT
 14112           END-IF
 14113        END-IF
 14114        IF WS-ERROR = ER-3054
 14115           PERFORM 9900-ERROR-FORMAT
 14116                                 THRU 9900-EXIT
 14117        END-IF
 14118
 14119     END-IF
 14120
 14121     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14122                                                                  ELC50PD
 14123     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14124        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14125                                                                     CL**6
 14126     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14127       AND                                                        ELC50PD
 14128        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14129        NEXT SENTENCE                                             ELC50PD
 14130     ELSE                                                            CL**6
 14131        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14132                                                                     CL**6
 14133     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14134        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14135        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14136     ELSE                                                         ELC50PD
 14137        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14138        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14139                                                                  ELC50PD
 14140     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14141*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14142     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14143     IF (NO-CONVERSION-ERROR)
 14144        AND (DC-ELAPSED-MONTHS > +1)
 14145        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14146        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14148                                                                  ELC50PD
 14149 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14150                                                                  ELC50PD
 14151     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14152        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14153         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14154     ELSE                                                         ELC50PD
 14155         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14156                                                                  ELC50PD
 14157     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14158         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14159     ELSE                                                         ELC50PD
 14160        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14161           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14162           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14163           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14164                                                                  ELC50PD
 14165     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14166        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 259
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14167        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14168         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14169                                                                  ELC50PD
 14170     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14171                                                                  ELC50PD
 14172 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14173                                                                  ELC50PD
 14174     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14175                                                                  ELC50PD
 14176     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14177         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14178     ELSE                                                         ELC50PD
 14179         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14180            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14181            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14182                                                                  ELC50PD
 14183     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14184                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14185     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14186         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14187                                                                  ELC50PD
 14188     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14189         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14191                                                                  ELC50PD
 14192                                                                  ELC50PD
 14193 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14194                                                                  ELC50PD
 14195******************************************************************ELC50PD
 14196*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14197******************************************************************ELC50PD
 14198                                                                  ELC50PD
 14199     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14200        NEXT SENTENCE                                             ELC50PD
 14201     ELSE                                                         ELC50PD
 14202        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14203           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14204              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14205              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14206              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14207                  NEXT SENTENCE                                   ELC50PD
 14208           ELSE                                                   ELC50PD
 14209              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14210              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14211                                                                  ELC50PD
 14212     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14213         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14214            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14215            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14216            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14217             NEXT SENTENCE                                        ELC50PD
 14218          ELSE                                                    ELC50PD
 14219              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14220              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14221                                                                  ELC50PD
 14222     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14223        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14224                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 260
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14225     IF POLICY-HAS-AH                                             ELC50PD
 14226       AND                                                        ELC50PD
 14227        POLICY-HAS-LIFE                                           ELC50PD
 14228       AND                                                        ELC50PD
 14229        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14230       AND                                                        ELC50PD
 14231        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14232        NEXT SENTENCE                                             ELC50PD
 14233     ELSE                                                         ELC50PD
 14234        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14235                                                                  ELC50PD
 14236     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14237     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14238        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14239                                                                  ELC50PD
 14240     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14241        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14243                                                                  ELC50PD
 14244 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14245                                                                  ELC50PD
 14246     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14247         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14248            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14249
 14250*    IF PB-COMPANY-ID NOT = 'DCC'
 14251*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14252*          AND 'V' AND 'W' AND 'X'
 14253*          GO TO 3125-EDIT-PMT-FREQ
 14254*       END-IF
 14255*    ELSE
 14256*       IF WS-AH-DCC-TRUNC = 'T'
 14257*          CONTINUE
 14258*       ELSE
 14259*          GO TO 3125-EDIT-PMT-FREQ
 14260*       END-IF
 14261*    END-IF
 14262
 14263
 14264
 14265     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14266                    OR
 14267        ((PB-COMPANY-ID = 'DCC')
 14268        AND (WS-AH-DCC-TRUNC = 'T'))
 14269        CONTINUE
 14270     ELSE
 14271        GO TO 3125-EDIT-PMT-FREQ
 14272     END-IF
 14273
 14274     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14275         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14276                                                                  ELC50PD
 14277     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14278        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14279*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14280        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14281         NEXT SENTENCE                                            ELC50PD
 14282     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 261
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14283         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14285                                                                  ELC50PD
 14286     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14287        MOVE ER-3058             TO WS-ERROR
 14288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14289     end-if
 14290                                                                  ELC50PD
 14291     IF WS-STATE-ABBREVIATION = 'NC'
 14292        IF PB-I-LOAN-TERM > +59
 14293           CONTINUE
 14294        ELSE
 14295           MOVE ER-2792          TO WS-ERROR
 14296           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14297        END-IF
 14298     END-IF
 14299                                                                  ELC50PD
 14300     .
 14301 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14302
 14303     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14304         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14305            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14306
 14307     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14308                    OR
 14309        ((PB-COMPANY-ID = 'DCC')
 14310        AND (WS-AH-DCC-TRUNC = 'T'))
 14311                    OR
 14312         (PB-COMPANY-ID = 'AHL')
 14313        CONTINUE
 14314     ELSE
 14315        IF (PB-I-LOAN-TERM > ZEROS)
 14316           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14317           MOVE ER-1575          TO WS-ERROR
 14318           PERFORM 9900-ERROR-FORMAT
 14319                                 THRU 9900-EXIT
 14320        END-IF
 14321     END-IF
 14322
 14323     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14324         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14325            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14326            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14327            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14328         ELSE                                                     ELC50PD
 14329            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14330                                                                  ELC50PD
 14331     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14332         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14333         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14334         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14335                                                                  ELC50PD
 14336     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14337         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14338         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14339         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14340                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 262
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14341     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14342         GIVING WS-TEX-FACT-2                                     ELC50PD
 14343             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14344                                                                  ELC50PD
 14345*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14346*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14347*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14348                                                                  ELC50PD
 14349                                                                  ELC50PD
 14350 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14351                                                                  ELC50PD
 14352     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14353        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14354           MOVE ER-2690          TO WS-ERROR
 14355           PERFORM 9900-ERROR-FORMAT
 14356                                 THRU 9900-EXIT
 14357        ELSE
 14358           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14359           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14360           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14361           MOVE PB-SV-STATE      TO LOFC-STATE
 14362           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14363           MOVE PB-I-LOAN-OFFICER
 14364                                 TO LOFC-CODE
 14365           PERFORM 8586-READ-LOAN-OFFICER
 14366                                 THRU 8586-EXIT
 14367           IF (NOT LOFC-MASTER-FOUND)
 14368              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14369              MOVE ER-3006       TO WS-ERROR
 14370              PERFORM 9900-ERROR-FORMAT
 14371                                 THRU 9900-EXIT
 14372           END-IF
 14373        END-IF
 14374     END-IF
 14375
 14376     .
 14377 3129-EDIT-APR.                                                   ELC50PD
 14378                                                                  ELC50PD
 14379     IF (WS-LF-BENEFIT-CD = ZERO)
 14380        OR (NO-LF-BENEFIT-MATCH)
 14381        IF PB-COMPANY-ID NOT = 'DCC'
 14382           GO TO 3130-EDIT-AGE
 14383*       ELSE
 14384*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14385*             GO TO 3130-EDIT-AGE
 14386*          END-IF
 14387        END-IF
 14388     END-IF
 14389                                                                  ELC50PD
 14390     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14391         AND (PB-I-RATE-CLASS NOT = 'L ')
 14392         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14393         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14394         GO TO 3129-APR-CONT.                                     ELC50PD
 14395                                                                  ELC50PD
 14396     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14397         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14398         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 263
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14399         GO TO 3129-APR-CONT.                                     ELC50PD
 14400                                                                  ELC50PD
 14401     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14402         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14403         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14404         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14405         GO TO 3129-APR-CONT.                                     ELC50PD
 14406                                                                  ELC50PD
 14407     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14408        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14409           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14410              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14411              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14412              GO TO 3130-EDIT-AGE.                                ELC50PD
 14413                                                                  ELC50PD
 14414     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14415        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14416        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14417        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14418        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14419        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14420         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14421                                                                  ELC50PD
 14422 3129-APR-CONT.                                                   ELC50PD
 14423     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14424         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14425         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14426                                                                  ELC50PD
 14427     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14428         WS-AH-BENEFIT-CD (1:1) = 'S')
 14429        AND (PB-COMPANY-ID = 'DCC')
 14430        AND (PB-I-LOAN-APR = ZERO)
 14431        MOVE ER-2657             TO WS-ERROR
 14432        PERFORM 9900-ERROR-FORMAT
 14433                                 THRU 9900-EXIT
 14434        GO TO 3130-EDIT-AGE
 14435     END-IF
 14436
 14437*    IF PB-I-LOAN-APR = ZERO
 14438*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14439*    END-IF
 14440                                                                  ELC50PD
 14441     if pb-i-loan-apr = +99.9999
 14442        move er-2656             to ws-error
 14443        PERFORM 9900-ERROR-FORMAT
 14444                                 THRU 9900-EXIT
 14445        GO TO 3130-EDIT-AGE
 14446     end-if
 14447
 14448*    IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14449*       MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14450*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14451*       GO TO 3130-EDIT-AGE.                                      ELC50PD
 14452                                                                  ELC50PD
 14453*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14454     if pb-i-loan-apr not = +99.9999
 14455        IF PB-I-LOAN-APR > +30.000
 14456           MOVE ER-2657          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 264
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14457           PERFORM 9900-ERROR-FORMAT
 14458                                 THRU 9900-EXIT
 14459        end-if
 14460     end-if
 14461
 14462     .
 14463 3130-EDIT-AGE.                                                   ELC50PD
 14464                                                                  ELC50PD
 14465******************************************************************ELC50PD
 14466*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14467******************************************************************ELC50PD
 14468                                                                  ELC50PD
 14469     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14470        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14471           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14472               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14473               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14474                                                                  ELC50PD
 14475     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14476        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14477           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14478               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14479               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14480                                                                  ELC50PD
 14481 3133-SEX-CODE.                                                   ELC50PD
 14482     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14483         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14484             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14485          ELSE                                                    ELC50PD
 14486             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14487             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14488                                                                  ELC50PD
 14489     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14490         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14491                                                                  ELC50PD
 14492     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14493         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14494                                                                  ELC50PD
 14495 3134-SIG-SW-EDIT.                                                ELC50PD
 14496     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14497         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14498                                                                  ELC50PD
 14499     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14500         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14501             NEXT SENTENCE                                        ELC50PD
 14502         ELSE                                                     ELC50PD
 14503             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14505     ELSE                                                         ELC50PD
 14506     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14507         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14508             NEXT SENTENCE                                        ELC50PD
 14509         ELSE                                                     ELC50PD
 14510             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14511             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14512     ELSE                                                         ELC50PD
 14513     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14514         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 265
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14515             NEXT SENTENCE                                        ELC50PD
 14516         ELSE                                                     ELC50PD
 14517             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14518             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14519     ELSE                                                         ELC50PD
 14520         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14521             NEXT SENTENCE                                        ELC50PD
 14522         ELSE                                                     ELC50PD
 14523             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14524             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14525                                                                  ELC50PD
 14526     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
 14527         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14528             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14529            PB-I-SIG-SW = 'N'                                     ELC50PD
 14530            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14531            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14532                                                                  ELC50PD
 14533 3135-NAME-EDIT.                                                  ELC50PD
 14534                                                                  ELC50PD
 14535     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14536        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14537        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14538           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14539                                 TO PB-I-JOINT-FIRST-NAME
 14540        END-PERFORM
 14541     END-IF
 14542
 14543     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14544        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14545        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14546           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14547                                 TO PB-I-JOINT-LAST-NAME
 14548        END-PERFORM
 14549     END-IF
 14550
 14551     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14552        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14553        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14554           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14555                                 TO PB-I-INSURED-FIRST-NAME
 14556        END-PERFORM
 14557     END-IF
 14558
 14559     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14560        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14561        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14562           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14563                                 TO PB-I-INSURED-LAST-NAME
 14564        END-PERFORM
 14565     END-IF
 14566
 14567     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14568       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14569       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14570           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14571           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14572                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 266
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14573 3136-EDIT-SEX.                                                   ELC50PD
 14574                                                                  ELC50PD
 14575******************************************************************ELC50PD
 14576*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14577******************************************************************ELC50PD
 14578                                                                  ELC50PD
 14579     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14580        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14581        NEXT SENTENCE                                             ELC50PD
 14582     ELSE                                                         ELC50PD
 14583        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14584           NEXT SENTENCE                                          ELC50PD
 14585        ELSE                                                      ELC50PD
 14586           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14587           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14588                                                                  ELC50PD
 14589 3137-EDIT-EFF-DATE.                                              ELC50PD
 14590                                                                  ELC50PD
 14591     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14592        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14593        PB-POLICY-IS-VOIDED                                       ELC50PD
 14594         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14595                                                                  ELC50PD
 14596     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14597                                    WS-2672-SW.                   ELC50PD
 14598                                                                  ELC50PD
 14599     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14600         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14601             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14602             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14603             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14604                                                                  ELC50PD
 14605     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14606         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14607                                                                  ELC50PD
 14608     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14609     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14610*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14611     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14612     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14613                                    DC-ELAPSED-DAYS.              ELC50PD
 14614     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14615                                                                  ELC50PD
 14616     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14617         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14618                                                                  ELC50PD
 14619     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14620         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14621         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14623     END-IF
 14624                                                                  ELC50PD
 14625     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14626        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14627        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14628        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14629        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14630                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 267
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14631     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14632      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14633         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14634         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14636         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14637                                    WS-2672-SW.                   ELC50PD
 14638                                                                  ELC50PD
 14639     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14640         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14641             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14642             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14643         ELSE                                                     ELC50PD
 14644             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14645             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14646                                                                  ELC50PD
 14647                                                                  ELC50PD
 14648 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14649                                                                  ELC50PD
 14650     if pb-company-id not = 'AHL'
 14651        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14652           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14653           MOVE ER-2787          TO WS-ERROR
 14654           PERFORM 9900-ERROR-FORMAT
 14655                                 THRU 9900-EXIT
 14656        END-IF
 14657     end-if
 14658
 14659     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14660        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14661                                 > 250000.00
 14662           MOVE ER-2719          TO WS-ERROR
 14663           PERFORM 9900-ERROR-FORMAT
 14664                                 THRU 9900-EXIT
 14665        END-IF
 14666     END-IF
 14667
 14668     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14669        PB-POLICY-IS-VOIDED                                       ELC50PD
 14670         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14671                                                                  ELC50PD
 14672     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14673        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14674         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14676                                                                  ELC50PD
 14677     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14678        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14679        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14680         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14681                                                                  ELC50PD
 14682     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14683        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14684        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14685         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14686                                                                  ELC50PD
 14687     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14688        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 268
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14689        MOVE ER-2631             TO WS-ERROR
 14690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14691     END-IF
 14692                                                                  ELC50PD
 14693                                                                  ELC50PD
 14694******************************************************************ELC50PD
 14695*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14696******************************************************************ELC50PD
 14697                                                                  ELC50PD
 14698     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14699        NEXT SENTENCE                                             ELC50PD
 14700     ELSE                                                         ELC50PD
 14701        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14702           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14703           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14704                                                                  ELC50PD
 14705                                                                  ELC50PD
 14706******************************************************************ELC50PD
 14707*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14708******************************************************************ELC50PD
 14709                                                                  ELC50PD
 14710     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14711        CONTINUE                                                  ELC50PD
 14712     ELSE                                                         ELC50PD
 14713        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14714           IF (NOT PB-COMP-LF-PREM)
 14715              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14716              MOVE ER-2633       TO WS-ERROR
 14717              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14718           END-IF
 14719        END-IF
 14720     END-IF
 14721
 14722     .                                                            ELC50PD
 14723 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14724                                                                  ELC50PD
 14725     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14726        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14727        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14728         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14729                                                                  ELC50PD
 14730     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14731        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14732        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14733        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14734         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14735                                                                  ELC50PD
 14736     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14737        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14738        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14739         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14740                                                                  ELC50PD
 14741     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14742         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14744                                                                  ELC50PD
 14745******************************************************************ELC50PD
 14746*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 269
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14747******************************************************************ELC50PD
 14748                                                                  ELC50PD
 14749     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14750        NEXT SENTENCE                                             ELC50PD
 14751     ELSE                                                         ELC50PD
 14752        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14753           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14755                                                                  ELC50PD
 14756******************************************************************ELC50PD
 14757*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14758******************************************************************ELC50PD
 14759                                                                  ELC50PD
 14760     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14761        NEXT SENTENCE                                             ELC50PD
 14762     ELSE                                                         ELC50PD
 14763        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14764            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14765                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14766                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14767                                                                  ELC50PD
 14768                                                                  ELC50PD
 14769 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14770* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14771     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14772                                     WS-RES-MUNI-TAX              ELC50PD
 14773                                     PB-I-STATE-TAX               ELC50PD
 14774                                     PB-I-MUNI-TAX.               ELC50PD
 14775                                                                  ELC50PD
 14776     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14777                                                                  ELC50PD
 14778     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14779        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14780                                                                  ELC50PD
 14781     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14782        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14783                                                                  ELC50PD
 14784     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14785        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14786                                                                  ELC50PD
 14787     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14788                             OR 'RIC')                            ELC50PD
 14789        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14790                                                                  ELC50PD
 14791     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14792        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14793            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14794        ELSE                                                      ELC50PD
 14795           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14796               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14797                                                                  ELC50PD
 14798     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14799        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14800                                                                  ELC50PD
 14801     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14802        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14803                                                                  ELC50PD
 14804     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 270
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14805        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14806           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14807             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14808           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14809           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14810              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14811              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14812              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14813           ELSE                                                   ELC50PD
 14814              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14815                                                                  ELC50PD
 14816 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
 14817                                                                  ELC50PD
 14818* DMD RATING TEST                                                 ELC50PD
 14819     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14820         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14821         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14822         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14823         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14824         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14825         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14826                                                                  ELC50PD
 14827     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14828         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14829             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14830                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14831                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14832                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14833                                                                  ELC50PD
 14834     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14835         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14836             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14837                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14838                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14839                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14840                                                                  ELC50PD
 14841     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14842        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14843            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14844              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14845                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14846                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14847                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14848                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14849                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14850                                                                  ELC50PD
 14851     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14852        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14853            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14854               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14855               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14856               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14857                                                                  ELC50PD
 14858     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14859        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14860            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14861                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14862                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 271
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14863                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14864                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14865                                                                  ELC50PD
 14866     IF WS-ERROR = ER-2693                                        ELC50PD
 14867        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14868           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14869           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14870           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14871                                                                  ELC50PD
 14872     IF WS-ERROR = ER-2693                                        ELC50PD
 14873        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14874           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
 14875           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14876           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14877                                                                  ELC50PD
 14878     IF WS-ERROR = ER-2693                                        ELC50PD
 14879        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14880           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14881           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14882           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14883                                                                  ELC50PD
 14884     IF WS-ERROR = ER-2693                                        ELC50PD
 14885        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14886           IF WS-LEVEL                                            ELC50PD
 14887              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14888              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14889                                                                  ELC50PD
 14890     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14891         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14892         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14893       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14894             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14895             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14896         NEXT SENTENCE                                            ELC50PD
 14897     ELSE                                                         ELC50PD
 14898         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14899                                                                  ELC50PD
 14900     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14901        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14902           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14904           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14905                                                                  ELC50PD
 14906     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14907        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14908           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14909           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14910           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14911                                                                  ELC50PD
 14912     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14913                                                                  ELC50PD
 14914     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14915         NEXT SENTENCE                                            ELC50PD
 14916     ELSE                                                         ELC50PD
 14917         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14918             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14919                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14920                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 272
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14921                                                                  ELC50PD
 14922     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14923       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14924         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14925         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14926         IF WS-ERROR = ER-2675                                    ELC50PD
 14927            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14928            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14929            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14930         ELSE                                                     ELC50PD
 14931            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14932            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14933                                                                  ELC50PD
 14934                                                                  ELC50PD
 14935     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14936         NEXT SENTENCE                                            ELC50PD
 14937     ELSE                                                         ELC50PD
 14938       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14939            NEXT SENTENCE
 14940       ELSE
 14941         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14942             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14943                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14944                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14945                                                                  ELC50PD
 14946     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14947       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14948         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14949         IF WS-ERROR = ER-2676                                    ELC50PD
 14950            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14951            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14952            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14953         ELSE                                                     ELC50PD
 14954            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14955            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14956                                                                  ELC50PD
 14957     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14958         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14959            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14960     ELSE                                                         ELC50PD
 14961         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14962             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14963                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14964                                                                  ELC50PD
 14965     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14966         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14967            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14968     ELSE                                                         ELC50PD
 14969         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14970             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14971                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14972                                                                  ELC50PD
 14973     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14974                                                                  ELC50PD
 14975     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14976                                                                  ELC50PD
 14977                                                                  ELC50PD
 14978 3215-EDIT-RATES.                                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 273
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14979     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14980         NEXT SENTENCE                                            ELC50PD
 14981     ELSE                                                         ELC50PD
 14982         GO TO 3999-END-EDIT.                                     ELC50PD
 14983                                                                  ELC50PD
 14984 3220-CHECK-LF-RATES.                                             ELC50PD
 14985                                                                  ELC50PD
 14986     IF PB-COMPANY-ID = 'DCC'
 14987        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14988        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14989        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14990           AND (NOT WS-LF-CASH))
 14991                           OR
 14992           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14993           AND (NOT WS-AH-CASH)))
 14994                       AND
 14995           (PB-I-ENTRY-STATUS NOT = '5')
 14996           MOVE 'M'              TO PB-BATCH-ENTRY
 14997                                    PB-I-ENTRY-STATUS
 14998        END-IF
 14999     END-IF
 15000
 15001
 15002
 15003     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 15004                                    PB-I-AH-PREM-CALC             ELC50PD
 15005                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 15006                                    PB-I-LF-ALT-RATE              ELC50PD
 15007                                    PB-I-LF-REI-RATE              ELC50PD
 15008                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 15009                                    PB-I-AH-REI-RATE
 15010                                    PB-I-TOT-FEES-CALC.
 15011                                                                  ELC50PD
 15012     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15013        NEXT SENTENCE                                             ELC50PD
 15014     ELSE                                                         ELC50PD
 15015        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 15016                                    PB-I-AH-RATE.                 ELC50PD
 15017                                                                  ELC50PD
 15018     IF PB-I-TOT-FEES NOT NUMERIC
 15019        MOVE ZEROS               TO PB-I-TOT-FEES
 15020     END-IF
 15021
 15022     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 15023         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 15024                                                                  ELC50PD
 15025     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 15026         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 15027                                                                  ELC50PD
 15028     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 15029        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 15030     END-IF
 15031                                                                  ELC50PD
 15032     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 15033        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 15034     END-IF
 15035                                                                  ELC50PD
 15036     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 274
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15037        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 15038            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 15039     ELSE                                                         ELC50PD
 15040            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 15041                                                                  ELC50PD
 15042     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 15043         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 15044                                                                  ELC50PD
 15045     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 15046         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 15047                                                                  ELC50PD
 15048     MOVE SPACES                 TO CP-BEN-CATEGORY
 15049     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 15050        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 15051        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 15052             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 15053        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 15054             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 15055        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 15056             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 15057        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 15058           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 15059           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 15060        ELSE                                                      ELC50PD
 15061           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 15062              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 15063               AM-MAX-TOT-BEN                                     ELC50PD
 15064               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 15065           ELSE                                                   ELC50PD
 15066              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 15067                 AM-MAX-TOT-BEN) AND                              ELC50PD
 15068                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 15069                 AM-MAX-TOT-BEN)                                  ELC50PD
 15070                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 15071              ELSE                                                ELC50PD
 15072                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 15073                                                                  ELC50PD
 15074     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15075         NEXT SENTENCE                                            ELC50PD
 15076     ELSE                                                         ELC50PD
 15077         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15078                                                                  ELC50PD
 15079*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15080                                                                  ELC50PD
 15081     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15082        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15083              OR                                                  ELC50PD
 15084           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15085           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15087           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15088                                                                  ELC50PD
 15089     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15090           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15091                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15092                                                                  ELC50PD
 15093     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15094         MOVE ER-2687             TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 275
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15095         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15096         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15097         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15098         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15099                                                                  ELC50PD
 15100     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15101        IF PB-I-LIVES = ZERO                                      ELC50PD
 15102           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15103           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15104                                                                  ELC50PD
 15105     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15106                                                                  ELC50PD
 15107     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15108     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15109     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15110     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15111     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15112     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15113     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15114     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15115     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15116     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15117                                                                  ELC50PD
 15118******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15119     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15120         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15121            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15122             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15123                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15124*******                                                           ELC50PD
 15125                                                                  ELC50PD
 15126     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15127     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15128     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15129     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15130     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15131     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15132                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15133     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15134         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15135                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15136     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15137     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15138     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15139     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15140     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15141     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15142     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15143     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15144     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15145                                    CP-REMAINING-TERM             ELC50PD
 15146                                    CP-LOAN-TERM.                 ELC50PD
 15147                                                                  ELC50PD
 15148     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15149         NEXT SENTENCE                                            ELC50PD
 15150     ELSE                                                         ELC50PD
 15151         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15152             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 276
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15153                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15154                                                                  ELC50PD
 15155     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15156        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15157           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15158                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15159                                                                  ELC50PD
 15160     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15161         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15162            CP-EARN-AS-NET-PAY                                    ELC50PD
 15163             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15164                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15165                                                                  ELC50PD
 15166     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15167        or ((pb-company-id = 'AHL')
 15168           and (pb-i-loan-term > pb-i-lf-term))
 15169        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15170                                                                  ELC50PD
 15171     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15172        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15173                                                                  ELC50PD
 15174     IF CP-TERM-IS-DAYS                                           ELC50PD
 15175         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15176     ELSE                                                         ELC50PD
 15177         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15178
 15179     IF PB-COMPANY-ID = 'DCC'
 15180        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15181        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15182        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15183        IF WS-LF-BEN-CATEGORY = 'D'
 15184           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15185           MOVE PB-I-LIFE-COMMISSION
 15186                                 TO CP-DCC-ACT-COMM
 15187           MOVE WS-LF-BEN-CATEGORY
 15188                                 TO CP-BEN-CATEGORY
 15189        END-IF
 15190        IF (CP-BENEFIT-CD (1:1) = 'P')
 15191           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15192           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15193           add pb-i-ah-premium-amt to cp-original-premium
 15194        END-IF
 15195     END-IF
 15196
 15197     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15198         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15199         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15200         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15201                                                                  ELC50PD
 15202     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15203        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15204                                                                  ELC50PD
 15205     IF (CP-SPECIAL-CALC-CD = 'H')
 15206        OR (PB-COMPANY-ID = 'DCC')
 15207         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15208                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15209         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15210                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 277
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15211
 15212     IF (PB-COMPANY-ID = 'CID')
 15213        AND (WS-LF-EARNINGS-CALC = 'B')
 15214        AND (CP-STATE-STD-ABBRV = 'MN')
 15215        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15216                                 TO CP-ALTERNATE-BENEFIT
 15217        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15218     END-IF
 15219
 15220     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15221     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15222     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15223                                                                  ELC50PD
 15224     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15225        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15226        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15227        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15228                                                                  ELC50PD
 15229     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15230        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15231           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15232              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15233              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15234                                                                  ELC50PD
 15235
 15236******************************************************************ELC50PD
 15237*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15238*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15239******************************************************************ELC50PD
 15240                                                                  ELC50PD
 15241* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15242                                                                  00031343
 15243     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15244          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15245                                                                  00031346
 15246*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15247*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15248*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15249*        MOVE ER-2709        TO WS-ERROR                          00031349
 15250*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15251*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15252                                                                  00031352
 15253*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15254*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15255*        MOVE ER-2718        TO WS-ERROR                          00031349
 15256*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15257*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15258                                                                  00031352
 15259* CALC A & H AGE AT EXPIRATION.                                   00031353
 15260                                                                  00031354
 15261     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15262          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15263                                                                  00031357
 15264*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15265*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15266*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15267*        MOVE ER-2709        TO WS-ERROR                          00031349
 15268*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 278
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15269*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15270                                                                  00031352
 15271*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15272*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15273*        MOVE ER-2718        TO WS-ERROR                          00031360
 15274*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15275*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15276
 15277     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15278        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15279                                                                  ELC50PD
 15280     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
 15281        GO TO 3221-CHECK-ERROR-RATE-OPEN
 15282     end-if
 15283                                                                  ELC50PD
 15284     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15285        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15286                                                                  ELC50PD
 15287     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15288         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15289         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15290         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15291                                                                  ELC50PD
 15292                                                                  00031363
 15293******************************************************************ELC50PD
 15294*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15295******************************************************************ELC50PD
 15296                                                                  ELC50PD
 15297 PREMIUM-EDITING-IS-BYPASSED.
 15298
 15299     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15300        AND (CP-R-MAX-ATT-AGE > +0)
 15301        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15302        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15303           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15304           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15305           MOVE '1'              TO DC-OPTION-CODE
 15306           PERFORM 8500-DATE-CONVERT
 15307                                 THRU 8500-EXIT
 15308           IF NO-CONVERSION-ERROR
 15309              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15310                 MOVE ER-2661       TO WS-ERROR
 15311*                PERFORM 9900-ERROR-FORMAT
 15312*                                THRU 9900-EXIT
 15313              END-IF
 15314           END-IF
 15315        ELSE
 15316           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15317           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15318              MOVE ER-2661       TO WS-ERROR
 15319*             PERFORM 9900-ERROR-FORMAT
 15320*                                THRU 9900-EXIT
 15321           ELSE
 15322              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15323                 MOVE ER-1570    TO WS-ERROR
 15324                 PERFORM 9900-ERROR-FORMAT
 15325                                 THRU 9900-EXIT
 15326              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 279
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15327           END-IF
 15328        END-IF
 15329
 15330        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15331           MOVE PB-I-JOINT-BIRTHDAY
 15332                                 TO DC-BIN-DATE-1
 15333           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15334           MOVE '1'              TO DC-OPTION-CODE
 15335           PERFORM 8500-DATE-CONVERT
 15336                                 THRU 8500-EXIT
 15337           IF NO-CONVERSION-ERROR
 15338              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15339                 MOVE ER-2661       TO WS-ERROR
 15340*                PERFORM 9900-ERROR-FORMAT
 15341*                                THRU 9900-EXIT
 15342              END-IF
 15343           ELSE
 15344              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15345           END-IF
 15346        ELSE
 15347           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15348             (PB-I-LF-TERM / 12)
 15349           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15350              MOVE ER-2661       TO WS-ERROR
 15351*             PERFORM 9900-ERROR-FORMAT
 15352*                                THRU 9900-EXIT
 15353           ELSE
 15354              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15355                 MOVE ER-1571    TO WS-ERROR
 15356                 PERFORM 9900-ERROR-FORMAT
 15357                                 THRU 9900-EXIT
 15358              END-IF
 15359           END-IF
 15360        END-IF
 15361        IF WS-ERROR = ER-2661
 15362           PERFORM 9900-ERROR-FORMAT
 15363                                 THRU 9900-EXIT
 15364        END-IF
 15365     END-IF
 15366
 15367*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15368*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15369*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15370                                                                  ELC50PD
 15371     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15372        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15374                                                                  ELC50PD
 15375     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15376        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15378                                                                  ELC50PD
 15379     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15380        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15382                                                                  ELC50PD
 15383 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15384                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 280
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15385     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15386         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15387                                                                  ELC50PD
 15388     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15389        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15390     END-IF
 15391
 15392     .
 15393 3221-CONTINUE.                                                   ELC50PD
 15394     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15395                                    WS-DCC-AH-RATE
 15396
 15397     IF PB-COMPANY-ID = 'DCC'
 15398        IF WS-LF-BEN-CATEGORY = 'D'
 15399           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15400              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15401        END-IF
 15402     END-IF
 15403
 15404     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15405
 15406*   X'A4FF' = 12/31/2009
 15407     IF (PB-COMPANY-ID = 'CID')
 15408        AND (WS-LF-EARNINGS-CALC = 'B')
 15409        AND (CP-STATE-STD-ABBRV = 'MN')
 15410        AND (PB-CERT-EFF-DT > X'A4FF')
 15411        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15412     END-IF
 15413
 15414     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15415                                                                  ELC50PD
 15416     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15417     IF (PB-COMPANY-ID = 'DCC')
 15418        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15419        AND (PB-I-POLICY-IS-MONTHLY)
 15420        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15421        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15422     END-IF
 15423     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15424     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15425     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15426     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15427
 15428     IF (PB-COMPANY-ID = 'DCC')
 15429        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15430        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15431        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15432        MOVE ER-2786             TO WS-ERROR
 15433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15434     END-IF
 15435                                                                  ELC50PD
 15436     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15437                                                                  ELC50PD
 15438******************************************************************ELC50PD
 15439*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15440******************************************************************ELC50PD
 15441     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15442        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 281
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15443                                                                  ELC50PD
 15444     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15445        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15446     ELSE                                                         ELC50PD
 15447       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15448          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15449          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15450                                                                  ELC50PD
 15451 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15452                                                                  ELC50PD
 15453     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15454        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15455        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15456         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15457                                                                  ELC50PD
 15458     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15459         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15460             AND PB-COMPANY-ID NOT = 'DCC')
 15461                   OR
 15462
 15463              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15464              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15465              AND PB-COMPANY-ID NOT = 'DCC')
 15466             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15468             GO TO 3225-RATING-CONT                               ELC50PD
 15469         ELSE                                                     ELC50PD
 15470             GO TO 3225-RATING-CONT.                              ELC50PD
 15471
 15472     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15473        AND (AM-GPCD = 01 OR 06 OR 15)
 15474        MOVE ER-2798             TO WS-ERROR
 15475        PERFORM 9900-ERROR-FORMAT
 15476                                 THRU 9900-EXIT
 15477*       GO TO 3225-RATING-CONT
 15478     END-IF
 15479
 15480     IF (PB-COMPANY-ID = 'CID')
 15481        AND (WS-LF-EARNINGS-CALC = 'B')
 15482        AND (CP-STATE-STD-ABBRV = 'MN')
 15483        AND (PB-CERT-EFF-DT > X'A4FF')
 15484        GO TO 3225-RATING-CONT
 15485     END-IF
 15486
 15487     IF PB-COMPANY-ID = 'DCC'
 15488        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15489           AND (PB-I-POLICY-IS-MONTHLY)
 15490           GO TO 3225-RATING-CONT
 15491        END-IF
 15492     END-IF
 15493
 15494     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15495        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15496        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15497        NEXT SENTENCE                                             ELC50PD
 15498     ELSE                                                         ELC50PD
 15499        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15500                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 282
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15501 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15502                                                                  ELC50PD
 15503     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15504                                                                  ELC50PD
 15505     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15506        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15507        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15508         NEXT SENTENCE                                            ELC50PD
 15509     ELSE                                                         ELC50PD
 15510         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15511                                                                  ELC50PD
 15512     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15513     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15514     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15515                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15516     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15517         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15518                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15519
 15520     IF PB-COMPANY-ID = 'DCC'
 15521        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15522     END-IF
 15523
 15524     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15525     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15526     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15527                                    CP-REMAINING-TERM             ELC50PD
 15528                                    CP-LOAN-TERM.                 ELC50PD
 15529     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15530        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15531                                    CP-REMAINING-TERM             ELC50PD
 15532                                    CP-LOAN-TERM.                 ELC50PD
 15533                                                                  ELC50PD
 15534     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15535     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15536                                                                  ELC50PD
 15537     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15538         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15540         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15541                                                                  ELC50PD
 15542     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15543     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15544                                                                  ELC50PD
 15545     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15546         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15547                                                                  ELC50PD
 15548     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15549                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15550                                                                  ELC50PD
 15551     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15552        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15553        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 15554        GO TO 3225-CONTINUE.                                      ELC50PD
 15555                                                                  ELC50PD
 15556     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15557        GO TO 3225-CONTINUE.                                      ELC50PD
 15558                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 283
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15559     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15560                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15561        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15562        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15564                                                                  ELC50PD
 15565 3225-CONTINUE.                                                   ELC50PD
 15566     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15567         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15568         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15569                                                                  ELC50PD
 15570     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15571        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
 15572        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15574                                                                  ELC50PD
 15575 3225-RATING-CONT.                                                ELC50PD
 15576                                                                  ELC50PD
 15577     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15578         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15579         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15580         IF (PB-COMPANY-ID = 'DCC')
 15581            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15582            CONTINUE
 15583         ELSE
 15584            MOVE ER-2687         TO WS-ERROR
 15585            PERFORM 9900-ERROR-FORMAT
 15586                                 THRU 9900-EXIT
 15587         END-IF
 15588         GO TO 3290-EDIT-LF-REIN-RATE
 15589     END-IF
 15590                                                                  ELC50PD
 15591* DMD RATING TEST                                                 ELC50PD
 15592     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15593         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15594         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15595         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15597         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15598                                                                  ELC50PD
 15599 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15600                                                                  ELC50PD
 15601     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15602     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15603*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15604     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15605     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15606                                                                  ELC50PD
 15607 C-POS-3230-MORT-CD.                                              ELC50PD
 15608     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15609        PB-SV-CARRIER = '2'                                       ELC50PD
 15610         NEXT SENTENCE                                            ELC50PD
 15611     ELSE                                                         ELC50PD
 15612         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15613                                                                  ELC50PD
 15614     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15615        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15616         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 284
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15617      ELSE                                                        ELC50PD
 15618         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15619                                                                  ELC50PD
 15620                                                                  ELC50PD
 15621 C-POS-3240-MORT-CD.                                              ELC50PD
 15622     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15623        PB-SV-CARRIER = '1'                                       ELC50PD
 15624         NEXT SENTENCE                                            ELC50PD
 15625     ELSE                                                         ELC50PD
 15626         GO TO 3230-CONTINUE.                                     ELC50PD
 15627                                                                  ELC50PD
 15628     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15629        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
 15630         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15631     ELSE                                                         ELC50PD
 15632         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15633                                                                  ELC50PD
 15634 3230-CONTINUE.                                                   ELC50PD
 15635
 15636     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15637        GO TO 3240-CONTINUE                                       00033065
 15638     END-IF
 15639
 15640     IF PB-CERT-EFF-DT > WS-971231
 15641        GO TO 3240-CONTINUE                                       00033065
 15642     END-IF
 15643
 15644     IF LF-BENEFIT-FOUND AND                                      00033066
 15645        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15646         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15647     ELSE                                                         00033069
 15648         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15649             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15650         ELSE                                                     00033072
 15651             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15652         END-IF
 15653     END-IF
 15654                                                                  00033074
 15655     .
 15656 3240-CONTINUE.                                                   ELC50PD
 15657
 15658     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15659         GO TO 3256-CONTINUE.                                     ELC50PD
 15660                                                                  ELC50PD
 15661     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15662         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15663     ELSE                                                         ELC50PD
 15664         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15665                                                                  ELC50PD
 15666 3256-CONTINUE.                                                   ELC50PD
 15667     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15668         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15669                                                                  ELC50PD
 15670     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15671         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15672     ELSE                                                         ELC50PD
 15673         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15674                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 285
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15675 3260-EDIT-CONTINUE.                                              ELC50PD
 15676     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15677                                                                  ELC50PD
 15678 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15679     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15680         GO TO 3290-RATING-CONT.                                  ELC50PD
 15681                                                                  ELC50PD
 15682     IF PB-COMPANY-ID = 'DCC'
 15683        GO TO 3290-RATING-CONT.
 15684
 15685     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15686     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15687     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
 15688     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15689     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15690                                                                  ELC50PD
 15691******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15692     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15693         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15694            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15695             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15696*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15697             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15698             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15699***  Y2K PROJ 7744                                                   CL*11
 15700             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15701                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15702***  Y2K PROJ 7744                                                   CL*11
 15703*******                                                           ELC50PD
 15704                                                                  ELC50PD
 15705     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15706     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15707     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15708     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15709                                   CP-RATE-DEV-PCT.               ELC50PD
 15710     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15711     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15712                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15713                                                                  ELC50PD
 15714************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15715     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15716         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15717            CP-EARN-AS-NET-PAY                                    ELC50PD
 15718             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15719                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15720************                                                      ELC50PD
 15721                                                                  ELC50PD
 15722     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15723         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15724                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15725     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15726     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15727     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15728     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15729     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15730     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15731     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15732     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 286
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15733                                   CP-REMAINING-TERM              ELC50PD
 15734                                   CP-LOAN-TERM.                  ELC50PD
 15735     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15736        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15737                                                                  ELC50PD
 15738     IF CP-TERM-IS-DAYS                                           ELC50PD
 15739         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15740     ELSE                                                         ELC50PD
 15741         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15742                                                                  ELC50PD
 15743
 15744     IF PB-COMPANY-ID = 'DCC'
 15745        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15746     END-IF
 15747
 15748     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15749          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15750                                                                  ELC50PD
 15751     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15752                                                                  ELC50PD
 15753     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15754     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15755                                                                  ELC50PD
 15756     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15757        IF PB-I-OB                                                ELC50PD
 15758           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15759           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15760           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15761        ELSE                                                      ELC50PD
 15762           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15763           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15764           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15765                                                                  ELC50PD
 15766     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15767                                                                  ELC50PD
 15768     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15769     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15770                                                                  ELC50PD
 15771     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15772         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15774                                                                  ELC50PD
 15775 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15776                                                                  ELC50PD
 15777     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15778        GO TO 3290-RATING-CONT.                                   ELC50PD
 15779                                                                  ELC50PD
 15780     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15781     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15782     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15783     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15784     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15785     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15786                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15787     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15788         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15789                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15790
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 287
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15791     IF PB-COMPANY-ID = 'DCC'
 15792        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15793     END-IF
 15794
 15795     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15796     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15797     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15798                                    CP-REMAINING-TERM             ELC50PD
 15799                                    CP-LOAN-TERM.                 ELC50PD
 15800     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15801        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15802                                    CP-REMAINING-TERM             ELC50PD
 15803                                    CP-LOAN-TERM.                 ELC50PD
 15804                                                                  ELC50PD
 15805     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15806     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15807                                                                  ELC50PD
 15808     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15809                                                                  ELC50PD
 15810     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15811         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15812         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15813                                                                  ELC50PD
 15814 3290-RATING-CONT.                                                ELC50PD
 15815                                                                  ELC50PD
 15816     IF PB-I-OB                                                   ELC50PD
 15817*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15818        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15819                                                                  ELC50PD
 15820 3299-EDIT-CONTINUE.                                              ELC50PD
 15821                                                                  ELC50PD
 15822     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15823         NEXT SENTENCE                                            ELC50PD
 15824     ELSE                                                         ELC50PD
 15825         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15826         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15827                                                                  ELC50PD
 15828 3300-CHECK-AH-RATES.                                             ELC50PD
 15829     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15830         NEXT SENTENCE                                            ELC50PD
 15831     ELSE                                                         ELC50PD
 15832         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15833                                                                  ELC50PD
 15834     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15835        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15836                (NO-DMD-RATING))                                  ELC50PD
 15837         IF (PB-COMPANY-ID = 'DCC')
 15838            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15839            CONTINUE
 15840         ELSE
 15841            MOVE ER-2687         TO WS-ERROR
 15842            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15843         END-IF
 15844         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15845         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15846     END-IF
 15847                                                                  ELC50PD
 15848     IF PB-I-OB                                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 288
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15849        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15850                                                                  ELC50PD
 15851     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15852         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15854         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15855         GO TO 3999-END-EDIT.                                     ELC50PD
 15856                                                                  ELC50PD
 15857*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15858
 15859     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15860        IF PB-I-AH-CRIT-PER = ZERO
 15861           IF PB-COMPANY-ID = 'DCC'
 15862              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15863              CONTINUE
 15864           ELSE
 15865              MOVE ER-2618       TO WS-ERROR
 15866              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15867              GO TO 3999-END-EDIT
 15868           END-IF
 15869        END-IF
 15870     END-IF
 15871
 15872     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15873     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15874     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15875     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15876     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15877     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15878     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15879     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15880     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15881*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15882     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15883     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15884     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15885     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15886                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15887     IF PB-COMPANY-ID = 'CID'
 15888               OR
 15889        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15890         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15891                                         PB-I-AH-TERM.            ELC50PD
 15892     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15893        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15894           AND (PB-I-POLICY-IS-MONTHLY)
 15895           MOVE PB-I-LF-BENEFIT-AMT
 15896                                 TO CP-NET-BENEFIT-AMT
 15897           move pb-i-ah-premium-amt to cp-original-premium
 15898           add pb-i-lf-premium-amt to cp-original-premium
 15899        END-IF
 15900     END-IF
 15901
 15902     MOVE SPACES                 TO CP-BEN-CATEGORY
 15903
 15904     IF PB-COMPANY-ID = 'DCC'
 15905        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15906        EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 289
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15907           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15908              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15909              MOVE PB-I-LF-BENEFIT-AMT
 15910                                 TO CP-RATING-BENEFIT-AMT
 15911              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15912           WHEN WS-AH-BEN-CATEGORY = 'G'
 15913              MOVE PB-I-UNPAID-CASH-PRICE
 15914                                 TO CP-RATING-BENEFIT-AMT
 15915           WHEN WS-AH-BEN-CATEGORY = 'D'
 15916              MOVE WS-AH-PMF-COMM
 15917                                 TO CP-DCC-PMF-COMM
 15918              MOVE PB-I-AH-COMMISSION
 15919                                 TO CP-DCC-ACT-COMM
 15920        END-EVALUATE
 15921     END-IF
 15922
 15923     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15924     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15925     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15926     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15927     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15928     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15929     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15930                                    CP-REMAINING-TERM             ELC50PD
 15931                                    WS-WORK-TERM.                 ELC50PD
 15932     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15933                                                                  ELC50PD
 15934     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15935     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15936*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15937     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15938     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15939                                                                  ELC50PD
 15940     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15941     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15942         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15943         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15944         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15945                                                                  ELC50PD
 15946     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15947         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15948                                                                  ELC50PD
 15949     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15950                                                                  ELC50PD
 15951     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15952         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15953     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15954         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15955     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15956         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15957     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15958         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15959     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15960         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15961                                                                  ELC50PD
 15962     MOVE 1                      TO SUB2.                         ELC50PD
 15963     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15964     MOVE WS-MONTH               TO SUB1.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 290
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15965     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15966     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15967                                                                  ELC50PD
 15968 3310-GET-SKIP-MO.                                                ELC50PD
 15969     IF SUB1 = 13                                                 ELC50PD
 15970         MOVE 1                  TO SUB1.                         ELC50PD
 15971                                                                  ELC50PD
 15972     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15973         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15974                                                                  ELC50PD
 15975     ADD 1 TO SUB2                                                ELC50PD
 15976              SUB1.                                               ELC50PD
 15977                                                                  ELC50PD
 15978 3320-RATE-CONTINUE.                                              ELC50PD
 15979                                                                  ELC50PD
 15980     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15981         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15982                                                                  ELC50PD
 15983     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15984                                    CP-LOAN-TERM.                 ELC50PD
 15985                                                                  ELC50PD
 15986     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15987         NEXT SENTENCE                                            ELC50PD
 15988     ELSE                                                         ELC50PD
 15989         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15990                                    PB-I-AH-REI-RATE.             ELC50PD
 15991                                                                  ELC50PD
 15992                                                                  ELC50PD
 15993     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15994        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15995                                                                  ELC50PD
 15996     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15997         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15998         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15999         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 16000         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 16001                                                                  ELC50PD
 16002     IF PB-COMPANY-ID = 'DCC'
 16003        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16004           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16005              PB-I-RATE-DEV-PCT-LF
 16006        END-IF
 16007        MOVE PB-I-LF-ALT-BENEFIT-AMT
 16008                                 TO CP-ALTERNATE-BENEFIT
 16009        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16010        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 16011        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 16012     END-IF
 16013
 16014     IF (PB-COMPANY-ID = 'CID')
 16015        AND (WS-LF-EARNINGS-CALC = 'B')
 16016        AND (CP-STATE-STD-ABBRV = 'MN')
 16017        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 16018     ELSE
 16019        MOVE ' '                 TO CP-AH-BALLOON-SW
 16020     END-IF
 16021
 16022     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 291
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16023     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16024     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16025                                                                  ELC50PD
 16026     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16027        IF PB-I-OB                                                ELC50PD
 16028           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 16029           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16030           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 16031        ELSE                                                      ELC50PD
 16032          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16033              NEXT SENTENCE
 16034          ELSE
 16035           MOVE ER-2642          TO WS-ERROR                      ELC50PD
 16036           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16037           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 16038                                                                  ELC50PD
 16039     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 16040        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 16041           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 16042           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16043                                                                  ELC50PD
 16044     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16045        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 16046           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 16047              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 16048              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 16049                                                                  ELC50PD
 16050     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16051        NEXT SENTENCE                                             ELC50PD
 16052     ELSE                                                         ELC50PD
 16053       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 16054          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 16055          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 16056                                                                  ELC50PD
 16057     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16058         IF WS-ERROR = ER-2640                                    ELC50PD
 16059             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16060
 16061     IF ACCOUNT-AH-CHECKED
 16062        CONTINUE
 16063     ELSE
 16064        IF (CP-R-MAX-ATT-AGE NUMERIC)
 16065           AND (CP-R-MAX-ATT-AGE > +0)
 16066           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 16067           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 16068              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 16069              MOVE PB-I-AH-EXPIRE-DT
 16070                                 TO DC-BIN-DATE-2
 16071              MOVE '1'           TO DC-OPTION-CODE
 16072              PERFORM 8500-DATE-CONVERT
 16073                                 THRU 8500-EXIT
 16074              IF NO-CONVERSION-ERROR
 16075                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16076                    MOVE ER-2661       TO WS-ERROR
 16077*                   PERFORM 9900-ERROR-FORMAT
 16078*                                THRU 9900-EXIT
 16079                 END-IF
 16080              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 292
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16081           ELSE
 16082              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16083              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16084                 MOVE ER-2661    TO WS-ERROR
 16085*                PERFORM 9900-ERROR-FORMAT
 16086*                                THRU 9900-EXIT
 16087              ELSE
 16088                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16089                    MOVE ER-1570 TO WS-ERROR
 16090                    PERFORM 9900-ERROR-FORMAT
 16091                                 THRU 9900-EXIT
 16092                 END-IF
 16093              END-IF
 16094           END-IF
 16095
 16096           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16097              MOVE PB-I-JOINT-BIRTHDAY
 16098                                    TO DC-BIN-DATE-1
 16099              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16100              MOVE '1'              TO DC-OPTION-CODE
 16101              PERFORM 8500-DATE-CONVERT
 16102                                    THRU 8500-EXIT
 16103              IF NO-CONVERSION-ERROR
 16104                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16105                    MOVE ER-2661       TO WS-ERROR
 16106*                   PERFORM 9900-ERROR-FORMAT
 16107*                                   THRU 9900-EXIT
 16108                 END-IF
 16109              END-IF
 16110           ELSE
 16111              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16112                (PB-I-AH-TERM / 12)
 16113              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16114                 MOVE ER-2661       TO WS-ERROR
 16115*                PERFORM 9900-ERROR-FORMAT
 16116*                                   THRU 9900-EXIT
 16117              ELSE
 16118                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16119                    MOVE ER-1571 TO WS-ERROR
 16120                    PERFORM 9900-ERROR-FORMAT
 16121                                 THRU 9900-EXIT
 16122                 END-IF
 16123              END-IF
 16124           END-IF
 16125           IF WS-ERROR = ER-2661
 16126              PERFORM 9900-ERROR-FORMAT
 16127                                    THRU 9900-EXIT
 16128           END-IF
 16129        END-IF
 16130     END-IF
 16131
 16132*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16133*       NEXT SENTENCE                                             ELC50PD
 16134*    ELSE                                                         ELC50PD
 16135*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16136*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16137*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16138                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 293
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16139     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16140        NEXT SENTENCE                                             ELC50PD
 16141     ELSE                                                         ELC50PD
 16142        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16143           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16144           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16145                                                                  ELC50PD
 16146     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16147        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16148         PB-POLICY-IS-VOIDED                                      ELC50PD
 16149        NEXT SENTENCE                                             ELC50PD
 16150     ELSE                                                         ELC50PD
 16151        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
 16152           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16153           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16154                                                                  ELC50PD
 16155     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16156         IF WS-ERROR = ER-2667                                    ELC50PD
 16157             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16158                                                                  ELC50PD
 16159     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16160        NEXT SENTENCE                                             ELC50PD
 16161     ELSE                                                         ELC50PD
 16162        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16163           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16164           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16165                                                                  ELC50PD
 16166     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16167         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16168                                                                  ELC50PD
 16169 3321-CONTINUE.                                                   ELC50PD
 16170     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16171     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16172
 16173     IF (PB-COMPANY-ID = 'DCC')
 16174        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16175        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16176                                    PB-I-LF-ALT-PREM-CALC
 16177        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16178        IF WS-AH-BEN-CATEGORY = 'G'
 16179           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16180           + PB-I-ADDL-CLP)
 16181           * (1 + WS-TOL-CLP-PCT)
 16182*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16183        ELSE
 16184           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16185           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16186*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16187        END-IF
 16188        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16189                                 TO PB-I-AH-PREM-CALC
 16190        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16191           MOVE ER-8152          TO WS-ERROR
 16192           PERFORM 9900-ERROR-FORMAT
 16193                                 THRU 9900-EXIT
 16194        ELSE
 16195           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16196                 PB-I-ADDL-CLP)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 294
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16197              MOVE ER-8148       TO WS-ERROR
 16198              PERFORM 9900-ERROR-FORMAT
 16199                                 THRU 9900-EXIT
 16200           END-IF
 16201        END-IF
 16202     END-IF
 16203     IF (PB-COMPANY-ID = 'DCC')
 16204        AND (PB-I-POLICY-IS-MONTHLY)
 16205        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16206        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16207        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16208           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16209        END-IF
 16210     END-IF
 16211
 16212     IF (PB-COMPANY-ID = 'DCC')
 16213        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16214        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16215        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16216        MOVE ER-2786             TO WS-ERROR
 16217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16218     END-IF
 16219
 16220     MOVE +0                     TO PB-I-AH-CLP
 16221     IF PB-COMPANY-ID = 'DCC'
 16222        IF WS-AH-BEN-CATEGORY = 'D'
 16223           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16224              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16225        ELSE
 16226           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16227              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16228           END-IF
 16229        END-IF
 16230     END-IF
 16231
 16232     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16233                                                                  ELC50PD
 16234     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16235         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16236                                                                  ELC50PD
 16237     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16238         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16239                                                                  ELC50PD
 16240     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16241         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16242            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16243             NEXT SENTENCE                                        ELC50PD
 16244         ELSE                                                     ELC50PD
 16245             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16246                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16247                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16248             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16249                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16250                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16251                                                                  ELC50PD
 16252     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16253       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16254           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 295
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16255       ELSE
 16256         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16258                                                                  ELC50PD
 16259     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16260     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16261     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16262     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16263     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16264     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16265                                                                  ELC50PD
 16266     IF (PB-COMPANY-ID = 'DCC')
 16267        AND (WS-AH-BEN-CATEGORY = 'G')
 16268        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16269        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16270        IF CP-DEVIATION-CODE NOT = '000'
 16271           MOVE '000'            TO CP-DEVIATION-CODE
 16272           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16273           IF NO-CP-ERROR
 16274              COMPUTE PB-I-DDF-IU-RATE-UP =
 16275              PB-I-AH-CLP - CP-CALC-PREMIUM
 16276           ELSE
 16277              MOVE ER-3057        TO WS-ERROR
 16278              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16279           END-IF
 16280        END-IF
 16281     END-IF
 16282
 16283     .
 16284 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16285     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16286         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16287                                                                  ELC50PD
 16288     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16289     IF PB-COMPANY-ID = 'DCC'
 16290         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16291
 16292     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16293     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16294     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16295     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16296     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16297     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16298                                    CP-RATE-DEV-PCT.              ELC50PD
 16299*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16300     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16301     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16302     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16303     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16304                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16305     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16306         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16307                                         PB-I-AH-TERM.            ELC50PD
 16308     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16309     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16310     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16311     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16312     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 296
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16313     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16314                                    CP-REMAINING-TERM             ELC50PD
 16315                                    WS-WORK-TERM.                 ELC50PD
 16316     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16317
 16318     IF PB-COMPANY-ID = 'DCC'
 16319        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16320     END-IF
 16321
 16322     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16323         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16324            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16325                                                                  ELC50PD
 16326     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16327          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16328                                                                  ELC50PD
 16329     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16330                                                                  ELC50PD
 16331     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16332                                                                  ELC50PD
 16333     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16334                                                                  ELC50PD
 16335     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16336     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16337                                                                  ELC50PD
 16338     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16339         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16341         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16342                                                                  ELC50PD
 16343     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16344                                                                  ELC50PD
 16345     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16346     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16347                                                                  ELC50PD
 16348     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16349         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16351                                                                  ELC50PD
 16352                                                                  ELC50PD
 16353 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16354                                                                  ELC50PD
 16355     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16356         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16357             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16358             GO TO 3999-END-EDIT.                                 ELC50PD
 16359                                                                  ELC50PD
 16360     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16361                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16362                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16363                         OR 'AHL'
 16364         NEXT SENTENCE                                            ELC50PD
 16365     ELSE                                                         ELC50PD
 16366         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16367             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16368                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16369                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16370                                     PB-I-LF-PREM-CALC * .90      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 297
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16371                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16372                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16373                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16374                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16375                                                                  ELC50PD
 16376     IF PB-COMP-LF-PREM                                           ELC50PD
 16377        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16378        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16379                                                                  ELC50PD
 16380     IF PB-COMP-AH-PREM                                           ELC50PD
 16381        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16382                                                                  ELC50PD
 16383 3340-CHECK-DCC-TOT-FEES.
 16384
 16385     IF (PB-COMPANY-ID = 'DCC')
 16386        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16387        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16388        AND (PB-I-POLICY-IS-MONTHLY)
 16389        CONTINUE
 16390     ELSE
 16391        GO TO 3340-EDIT-LF-AH-TOL
 16392     END-IF
 16393
 16394     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16395     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16396
 16397     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16398        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16399           PB-I-RATE-DEV-PCT-LF
 16400     END-IF
 16401     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16402        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16403           PB-I-RATE-DEV-PCT-AH
 16404     END-IF
 16405     MOVE 'N'                    TO CP-BEN-CATEGORY
 16406
 16407     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16408                                                                  ELC50PD
 16409     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16410     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16411     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16412     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16413     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16414     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16415     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16416     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16417     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16418     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16419                                                                  ELC50PD
 16420     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16421     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16422     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16423     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16424     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16425     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16426                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16427     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16428         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 298
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16429                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16430     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16431     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16432     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16433     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16434     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16435     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16436     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16437     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16438     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16439                                    CP-REMAINING-TERM             ELC50PD
 16440                                    CP-LOAN-TERM.                 ELC50PD
 16441
 16442     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 16443        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 16444           PB-I-LF-PREMIUM-AMT
 16445     end-if
 16446                                                                  ELC50PD
 16447     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16448        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16449                                                                  ELC50PD
 16450     IF CP-TERM-IS-DAYS                                           ELC50PD
 16451         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16452     ELSE                                                         ELC50PD
 16453         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16454                                                                  ELC50PD
 16455
 16456     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16457
 16458     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16459         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16460                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16461         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16462
 16463     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16464     MOVE 'R'                    TO CP-RATE-FILE
 16465     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16466
 16467     IF NOT CP-ERROR-RATE-NOT-FOUND
 16468        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16469        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16470           AND (CP-BENEFIT-CD (1:1) = 'S')
 16471           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16472                                    PB-I-LF-PREMIUM-AMT
 16473        END-IF
 16474     ELSE
 16475        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16476     END-IF
 16477
 16478     .
 16479 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16480                                                                  ELC50PD
 16481***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16482***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16483***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16484***                                                               ELC50PD
 16485     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16486         PB-I-AH-PREMIUM-AMT                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 299
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16487          GIVING WS-CALC-WORK.                                    ELC50PD
 16488                                                                  ELC50PD
 16489     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16490        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16491         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16493                                                                  ELC50PD
 16494     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16495             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16496                 GIVING WS-UNSIGN-WRK1.                              CL**2
 16497                                                                     CL**2
 16498     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16499             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16500                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16501                                                                     CL**2
 16502     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16503                                + WS-UNSIGN-WRK4.                    CL**2
 16504                                                                     CL**2
 16505     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16506             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16507                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16508                                                                  ELC50PD
 16509******************************************************************ELC50PD
 16510*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16511******************************************************************ELC50PD
 16512                                                                  ELC50PD
 16513     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16514         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16515                                                                  ELC50PD
 16516     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16517         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16518                                                                  ELC50PD
 16519     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16520             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16521                                                                  ELC50PD
 16522 3342-CONTINUE.                                                   ELC50PD
 16523                                                                  ELC50PD
 16524     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16525         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16526         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16527            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16528              NEXT SENTENCE                                       ELC50PD
 16529         ELSE                                                     ELC50PD
 16530             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16531                                                                  ELC50PD
 16532     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16533         NEXT SENTENCE                                            ELC50PD
 16534     ELSE                                                         ELC50PD
 16535     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16536        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16537           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16538               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16539               PB-POLICY-IS-VOIDED)                               ELC50PD
 16540              NEXT SENTENCE                                       ELC50PD
 16541           ELSE                                                   ELC50PD
 16542              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16543                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16544                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 300
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16545                 GO TO 3344-CHECK-AH                              ELC50PD
 16546              ELSE                                                ELC50PD
 16547                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16548                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16549                 GO TO 3344-CHECK-AH.                             ELC50PD
 16550                                                                  ELC50PD
 16551***                                                               ELC50PD
 16552***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16553***                                                               ELC50PD
 16554                                                                  ELC50PD
 16555     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16556         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16557            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16558             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16559         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16560            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16561             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16562     ELSE                                                         ELC50PD
 16563         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16564         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16565                                                                  ELC50PD
 16566***                                                               ELC50PD
 16567***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16568***                                                               ELC50PD
 16569                                                                  ELC50PD
 16570     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16571         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16572          WS-TOL-LF-PREM.                                         ELC50PD
 16573                                                                  ELC50PD
 16574     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16575         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16576          WS-TOL-LF-PREM.                                         ELC50PD
 16577                                                                  ELC50PD
 16578     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16579        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16580                                                                  ELC50PD
 16581     IF PB-REISSUED-CERT
 16582        or PB-POLICY-IS-DECLINED
 16583        or PB-POLICY-IS-VOIDED
 16584        continue
 16585     ELSE
 16586        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16587              > WS-TOL-LF-HIGH-PREM-AMT)
 16588           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16589              < WS-TOL-LF-LOW-PREM-AMT))
 16590                      or
 16591           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16592              > WS-TOL-LF-HIGH-PREM-PCT)
 16593           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16594              < WS-TOL-LF-LOW-PREM-PCT))
 16595           IF WS-PREM-REJECT-SW = SPACE
 16596              MOVE ER-2652       TO WS-ERROR
 16597              PERFORM 9900-ERROR-FORMAT
 16598                                 THRU 9900-EXIT
 16599           ELSE
 16600              MOVE ER-2650       TO WS-ERROR
 16601              PERFORM 9900-ERROR-FORMAT
 16602                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 301
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16603           end-if
 16604        end-if
 16605     end-if
 16606                                                                  ELC50PD
 16607*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16608*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16609*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16610*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16611                                                                  ELC50PD
 16612     IF WS-ERROR  =  ER-2650  OR  ER-2652
 16613        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16614                      OR
 16615           ((PB-COMPANY-ID = 'DCC')
 16616           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16617           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16618           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16619        END-IF
 16620     END-IF
 16621                                                                  ELC50PD
 16622     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16623        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16624           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16625              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16626                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16627                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16628                 NEXT SENTENCE                                    ELC50PD
 16629              ELSE                                                ELC50PD
 16630                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16631                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16632                                                                  ELC50PD
 16633 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16634                                                                  ELC50PD
 16635      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16636          GO TO 3344-CHECK-AH.                                    ELC50PD
 16637                                                                  ELC50PD
 16638      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16639          GO TO 3344-CHECK-AH.                                    ELC50PD
 16640                                                                  ELC50PD
 16641      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16642                                     WS-UNSIGN-WRK6.              ELC50PD
 16643                                                                  ELC50PD
 16644      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16645          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16646                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16647                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16648                                                                  ELC50PD
 16649      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16650          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16651                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16652                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16653                                                                  ELC50PD
 16654      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16655          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16656              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16657                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16658                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16659              ELSE                                                ELC50PD
 16660                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 302
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16661                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16662                                                                  ELC50PD
 16663      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16664          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16665              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16666                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16667                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16668              ELSE                                                ELC50PD
 16669                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16670                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16671                                                                  ELC50PD
 16672 3344-CHECK-AH.                                                   ELC50PD
 16673                                                                  ELC50PD
 16674****************************************************************  ELC50PD
 16675***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16676***                                                               ELC50PD
 16677                                                                  ELC50PD
 16678     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16679         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16680             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16681         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16682             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16683     ELSE                                                         ELC50PD
 16684         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16685         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16686                                                                  ELC50PD
 16687***                                                               ELC50PD
 16688***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16689***                                                               ELC50PD
 16690                                                                  ELC50PD
 16691     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16692         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16693                                                                  ELC50PD
 16694     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16695         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16696                                                                  ELC50PD
 16697     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16698        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16699                                                                  ELC50PD
 16700     IF (PB-REISSUED-CERT)
 16701        OR (PB-POLICY-IS-DECLINED)
 16702        OR (PB-POLICY-IS-VOIDED)
 16703        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16704        CONTINUE
 16705     ELSE
 16706        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16707              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16708                          or
 16709           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16710              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16711           IF WS-PREM-REJECT-SW = SPACE
 16712              MOVE ER-3052       TO WS-ERROR
 16713              PERFORM 9900-ERROR-FORMAT
 16714                                 THRU 9900-EXIT
 16715           ELSE
 16716              MOVE ER-3050       TO WS-ERROR
 16717              PERFORM 9900-ERROR-FORMAT
 16718                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 303
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16719           END-IF
 16720        END-IF
 16721     END-IF
 16722
 16723     if (pb-company-id = 'DCC')
 16724        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16725        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16726        and (pb-i-policy-is-monthly)
 16727        compute ws-tol-ah-high-prem-amt =
 16728           pb-i-tot-fees-calc + ws-tol-ah-prem
 16729        compute ws-tol-ah-low-prem-amt =
 16730           pb-i-tot-fees-calc - ws-tol-ah-prem
 16731        if ws-tol-ah-prem-pct > zeros
 16732           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16733              (1 + ws-tol-ah-prem-pct)
 16734           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16735              (1 - ws-tol-ah-prem-pct)
 16736        else
 16737           move +9999999.99      to ws-tol-ah-high-prem-pct
 16738           move +0               to ws-tol-ah-low-prem-pct
 16739        end-if
 16740        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16741            or
 16742           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16743                          or
 16744           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16745           or
 16746           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16747            move er-3049         to ws-error
 16748           perform 9900-error-format
 16749                                 thru 9900-exit
 16750
 16751        end-if
 16752     end-if
 16753
 16754     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16755         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16756             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16757             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16758                                                                  ELC50PD
 16759     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16760        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16761           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16762              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16763                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16764                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16765                 NEXT SENTENCE                                    ELC50PD
 16766              ELSE                                                ELC50PD
 16767                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16768                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16769                                                                  ELC50PD
 16770     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16771        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16772           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16773                                                                  ELC50PD
 16774     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16775        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16776           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 304
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16777           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16778                                                                  ELC50PD
 16779 3345-EDIT-CONTINUE.                                              ELC50PD
 16780                                                                  ELC50PD
 16781*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16782*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16783*          IF PB-ISSUE                                            ELC50PD
 16784*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16785*          ELSE                                                   ELC50PD
 16786*              IF PB-CANCELLATION                                 ELC50PD
 16787*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16788                                                                  ELC50PD
 16789*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16790*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16791*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16792*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16793*        ELSE                                                     ELC50PD
 16794*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16795*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16796                                                                  ELC50PD
 16797     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16798        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16799           PB-REISSUED-CERT  OR                                   ELC50PD
 16800           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16801           PB-POLICY-IS-VOIDED                                    ELC50PD
 16802            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16803            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16804        ELSE                                                      ELC50PD
 16805            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16806            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16807                                                                  ELC50PD
 16808     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16809        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16810           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16811           PB-POLICY-IS-VOIDED                                    ELC50PD
 16812            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16813            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16814        ELSE                                                      ELC50PD
 16815            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16816                                      PB-I-ENTRY-STATUS.          ELC50PD
 16817                                                                  ELC50PD
 16818     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16819        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16820           PB-REISSUED-CERT  OR                                   ELC50PD
 16821           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16822           PB-POLICY-IS-VOIDED                                    ELC50PD
 16823            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16824            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16825        ELSE                                                      ELC50PD
 16826            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16827                                      PB-I-ENTRY-STATUS.          ELC50PD
 16828                                                                  ELC50PD
 16829     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16830        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16831        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16832
 16833     IF PB-COMPANY-ID = 'DCC'
 16834        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 305
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16835        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16836        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16837           AND (NOT WS-LF-CASH))
 16838                           OR
 16839           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16840           AND (NOT WS-AH-CASH)))
 16841                       AND
 16842           (PB-I-ENTRY-STATUS NOT = '5')
 16843           MOVE 'M'              TO PB-BATCH-ENTRY
 16844                                    PB-I-ENTRY-STATUS
 16845        END-IF
 16846     END-IF
 16847
 16848     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16849         GO TO 3999-END-EDIT.                                     ELC50PD
 16850                                                                  ELC50PD
 16851     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16852        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16853        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16854        PB-I-OB                                                   ELC50PD
 16855         GO TO 3999-END-EDIT.                                     ELC50PD
 16856                                                                  ELC50PD
 16857     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16858         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16859         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16860         GO TO 3999-END-EDIT.                                     ELC50PD
 16861                                                                  ELC50PD
 16862     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16863     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16864                                                                  ELC50PD
 16865     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16866         GO TO 3999-END-EDIT.                                     ELC50PD
 16867                                                                  ELC50PD
 16868     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16869                                      FORM-MASTER-AH-SW.          ELC50PD
 16870                                                                  ELC50PD
 16871     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16872         MOVE  +1                 TO SUB6                         ELC50PD
 16873         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16874                                                                  ELC50PD
 16875     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16876         MOVE  +1                 TO SUB6                         ELC50PD
 16877         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16878                                                                  ELC50PD
 16879     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16880        AH-FORM-MASTER-FOUND                                      ELC50PD
 16881         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16882     ELSE                                                         ELC50PD
 16883         GO TO 3999-END-EDIT.                                     ELC50PD
 16884                                                                  ELC50PD
 16885******************************************************************ELC50PD
 16886*                  3350-GET-ERFORM                               *ELC50PD
 16887*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16888*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16889******************************************************************ELC50PD
 16890                                                                  ELC50PD
 16891 3350-GET-ERFORM.                                                 ELC50PD
 16892                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 306
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16893     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16894         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16895                                                                  ELC50PD
 16896     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16897     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16898     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16899     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16900                                                                  ELC50PD
 16901     IF PB-CANCELLATION                                           ELC50PD
 16902         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16903            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16904            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16905              GO TO 3350-EXIT                                     ELC50PD
 16906         ELSE                                                     ELC50PD
 16907             NEXT SENTENCE                                        ELC50PD
 16908     ELSE                                                         ELC50PD
 16909         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16910            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16911            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16912              GO TO 3350-EXIT.                                    ELC50PD
 16913                                                                  ELC50PD
 16914 3350-ERFORM-GETMAIN.                                             ELC50PD
 16915                                                                  ELC50PD
 16916     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16917     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16918                                                                  ELC50PD
 16919 3350-ERFORM-READ.                                                ELC50PD
 16920                                                                  ELC50PD
 16921     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16922     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16923     IF PB-CANCELLATION                                           ELC50PD
 16924         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16925     ELSE                                                         ELC50PD
 16926         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16927     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16928                                                                  ELC50PD
 16929     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16930                                                                  ELC50PD
 16931     IF FORM-MASTER-FOUND                                         ELC50PD
 16932       IF PB-CANCELLATION                                         ELC50PD
 16933          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16934             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16935             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16936              GO  TO 3350-EXIT                                    ELC50PD
 16937          ELSE                                                    ELC50PD
 16938              NEXT SENTENCE                                       ELC50PD
 16939       ELSE                                                       ELC50PD
 16940          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16941             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16942             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16943              GO  TO 3350-EXIT.                                   ELC50PD
 16944                                                                  ELC50PD
 16945     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16946     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16947     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16948                                                                  ELC50PD
 16949 3350-EXIT.                                                       ELC50PD
 16950      EXIT.                                                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 307
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16951                                                                  ELC50PD
 16952******************************************************************ELC50PD
 16953*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16954*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16955*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16956******************************************************************ELC50PD
 16957                                                                  ELC50PD
 16958 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16959                                                                  ELC50PD
 16960     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
 16961        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16962         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16963         GO TO   3355-EXIT.                                       ELC50PD
 16964                                                                  ELC50PD
 16965     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16966         ADD  +1      TO  SUB6                                    ELC50PD
 16967         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16968                                                                  ELC50PD
 16969     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16970     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16971                                                                  ELC50PD
 16972 3355-EXIT.                                                       ELC50PD
 16973      EXIT.                                                       ELC50PD
 16974                                                                  ELC50PD
 16975******************************************************************ELC50PD
 16976*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16977*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16978*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16979******************************************************************ELC50PD
 16980                                                                  ELC50PD
 16981 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16982                                                                  ELC50PD
 16983     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16984        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16985         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16986         GO TO  3356-EXIT.                                        ELC50PD
 16987                                                                  ELC50PD
 16988      IF  SUB6    LESS THAN     +40                               ELC50PD
 16989          ADD  +1      TO  SUB6                                   ELC50PD
 16990          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16991                                                                  ELC50PD
 16992     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16993     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16994                                                                  ELC50PD
 16995 3356-EXIT.                                                       ELC50PD
 16996      EXIT.                                                       ELC50PD
 16997                                                                  ELC50PD
 16998******************************************************************ELC50PD
 16999*                  3357-BENEFIT-SEARCH                           *ELC50PD
 17000*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 17001*   CANCELLATIONS ONLY.                                          *ELC50PD
 17002******************************************************************ELC50PD
 17003 3357-BENEFIT-SEARCH.                                             ELC50PD
 17004     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 17005         MOVE +1                          TO SUB6                 ELC50PD
 17006         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 17007                                                                  ELC50PD
 17008     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 308
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17009         MOVE +1                          TO SUB6                 ELC50PD
 17010         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 17011                                                                  ELC50PD
 17012 3357-EXIT.                                                       ELC50PD
 17013     EXIT.                                                        ELC50PD
 17014                                                                  ELC50PD
 17015******************************************************************ELC50PD
 17016*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 17017*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17018*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17019*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17020******************************************************************ELC50PD
 17021 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 17022     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 17023       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 17024         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17025           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17026              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17027                     IS GREATER THAN SPACES                       ELC50PD
 17028                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17029                                          WS-LF-REFUND-CALC       ELC50PD
 17030                 GO TO 3358-EXIT.                                 ELC50PD
 17031                                                                  ELC50PD
 17032     IF SUB6 LESS THAN +40                                        ELC50PD
 17033         ADD +1                 TO SUB6                           ELC50PD
 17034         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 17035                                                                  ELC50PD
 17036 3358-EXIT.                                                       ELC50PD
 17037     EXIT.                                                        ELC50PD
 17038******************************************************************ELC50PD
 17039*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 17040*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17041*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17042*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17043******************************************************************ELC50PD
 17044 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 17045     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 17046       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 17047         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17048           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17049              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17050                      IS GREATER THAN SPACES                      ELC50PD
 17051                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17052                                          WS-AH-REFUND-CALC       ELC50PD
 17053                 GO TO 3359-EXIT.                                 ELC50PD
 17054                                                                  ELC50PD
 17055     IF SUB6 LESS THAN +40                                        ELC50PD
 17056         ADD +1                 TO SUB6                           ELC50PD
 17057         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 17058                                                                  ELC50PD
 17059 3359-EXIT.                                                       ELC50PD
 17060     EXIT.                                                        ELC50PD
 17061                                                                  ELC50PD
 17062******************************************************************ELC50PD
 17063*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 17064*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17065*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17066******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 309
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17067                                                                  ELC50PD
 17068 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 17069                                                                  ELC50PD
 17070     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 17071         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17072                                                                  ELC50PD
 17073     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17074         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17075                                                                  ELC50PD
 17076 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
 17077                                                                  ELC50PD
 17078     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17079       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17080        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17081        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17082         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17083            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17084            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17085         ELSE                                                     ELC50PD
 17086            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17087            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17088                                                                  ELC50PD
 17089 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17090                                                                  ELC50PD
 17091     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17092                                                                  ELC50PD
 17093     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17094         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17095         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17096            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17097                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17098                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17099            ELSE                                                  ELC50PD
 17100                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17101                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17102                                                                  ELC50PD
 17103 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17104                                                                  ELC50PD
 17105     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17106         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17107         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17108            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17109                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17110                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17111            ELSE                                                  ELC50PD
 17112                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17113                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17114                                                                  ELC50PD
 17115 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17116                                                                  ELC50PD
 17117     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17118         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17119         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17120           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17121               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17122               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17123           ELSE                                                   ELC50PD
 17124               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 310
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17125               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17126                                                                  ELC50PD
 17127     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17128                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17129                                                                  ELC50PD
 17130     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17131         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17132         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17133             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17134                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
 17135                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17136             ELSE                                                 ELC50PD
 17137                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17138                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17139                                                                  ELC50PD
 17140******************************************************************ELC50PD
 17141*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17142*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17143*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17144******************************************************************ELC50PD
 17145                                                                  ELC50PD
 17146 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17147                                                                  ELC50PD
 17148     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17149         GO TO 3999-END-EDIT.                                     ELC50PD
 17150                                                                  ELC50PD
 17151 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17152                                                                  ELC50PD
 17153     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17154       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17155        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17156        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17157         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17158            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17159            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17160         ELSE                                                     ELC50PD
 17161            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17162            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17163                                                                  ELC50PD
 17164 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17165                                                                  ELC50PD
 17166     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17167                                                                  ELC50PD
 17168     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17169         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17170         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17171            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17172                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17173                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17174            ELSE                                                  ELC50PD
 17175                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17176                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17177                                                                  ELC50PD
 17178 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17179                                                                  ELC50PD
 17180     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17181         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17182         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 311
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17183            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17184                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17185                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17186            ELSE                                                  ELC50PD
 17187                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17188                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17189                                                                  ELC50PD
 17190 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17191                                                                  ELC50PD
 17192     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
 17193         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17194         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17195             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17196                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17197                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17198             ELSE                                                 ELC50PD
 17199                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17200                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17201                                                                  ELC50PD
 17202     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17203         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17204         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17205             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17206                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17207                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17208             ELSE                                                 ELC50PD
 17209                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17210                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17211                                                                  ELC50PD
 17212     GO TO 3999-END-EDIT.                                         ELC50PD
 17213                                                                  ELC50PD
 17214******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 312
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17216******************************************************************ELC50PD
 17217*                  E D I T   C A N C E L                         *ELC50PD
 17218******************************************************************ELC50PD
 17219                                                                  ELC50PD
 17220 3700-EDIT-CANCEL.                                                ELC50PD
 17221     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17222         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17223                                         WS-RES-MUNI-TAX          ELC50PD
 17224                                         PB-CI-STATE-TAX          ELC50PD
 17225                                         PB-CI-MUNI-TAX           ELC50PD
 17226         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17227                                                                  ELC50PD
 17228*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17229*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17230*          IF PB-CANCELLATION                                     ELC50PD
 17231*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17232*          ELSE                                                   ELC50PD
 17233*             IF PB-ISSUE                                         ELC50PD
 17234*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17235                                                                  ELC50PD
 17236     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17237        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17238     END-IF
 17239
 17240*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17241*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17242                                                                  ELC50PD
 17243     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17244        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17246        GO TO 3999-END-EDIT.                                      ELC50PD
 17247                                                                  ELC50PD
 17248     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17249        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17251        GO TO 3999-END-EDIT.                                      ELC50PD
 17252                                                                  ELC50PD
 17253     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17254        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17256                                                                  ELC50PD
 17257***************************************************************   ELC50PD
 17258*                                                             *   ELC50PD
 17259*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17260*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17261*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17262*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17263*                                                             *   ELC50PD
 17264***************************************************************   ELC50PD
 17265                                                                  ELC50PD
 17266     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17267                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17268                                                                  ELC50PD
 17269     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17270        NEXT SENTENCE                                             ELC50PD
 17271     ELSE                                                         ELC50PD
 17272        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17273           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 313
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17274           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17275               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17276               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17277               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17278                                                                  ELC50PD
 17279     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17280        NEXT SENTENCE                                             ELC50PD
 17281     ELSE                                                         ELC50PD
 17282        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17283           AND                                                    ELC50PD
 17284           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17285               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17286               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17287               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17288                                                                  ELC50PD
 17289     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17290        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17291                                                                  ELC50PD
 17292     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17293     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17294     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17295     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17296     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17297     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17298                                                                  ELC50PD
 17299     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17300                                      PB-C-AH-REF-CALC.           ELC50PD
 17301     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17302                                                                  ELC50PD
 17303******************************************************************ELC50PD
 17304*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17305*             TO VALIDATE COVERAGE.                              *ELC50PD
 17306******************************************************************ELC50PD
 17307                                                                  ELC50PD
 17308     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17309        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17310          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17311      ELSE                                                        ELC50PD
 17312          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17313                                                                  ELC50PD
 17314     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17315        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17316          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17317      ELSE                                                        ELC50PD
 17318          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17319                                                                  ELC50PD
 17320     EVALUATE TRUE                                                ELC50PD
 17321         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17322              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17323              PB-FORCE-OFF                                        ELC50PD
 17324                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17325                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17326                  END-IF                                          ELC50PD
 17327         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17328               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17329              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17330                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17331         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 314
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17332              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17333                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17334              ELSE                                                ELC50PD
 17335                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17336              END-IF                                              ELC50PD
 17337              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17338     END-EVALUATE.                                                ELC50PD
 17339                                                                  ELC50PD
 17340                                                                  ELC50PD
 17341*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17342*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17343*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17344*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17345*        ELSE                                                     ELC50PD
 17346*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17347                                                                  ELC50PD
 17348     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17349     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17350        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17351     ELSE
 17352        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17353     END-IF
 17354     .
 17355 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17356                                                                  ELC50PD
 17357     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17358        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17359         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17360         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17361                                 TO DC-BIN-DATE-2                 ELC50PD
 17362         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17363*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17364         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17365         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17366            NEXT SENTENCE                                         ELC50PD
 17367          ELSE                                                    ELC50PD
 17368             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17369                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17370                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17371                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17372                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17373                 ELSE                                             ELC50PD
 17374                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17375                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17376                                                                  ELC50PD
 17377     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17378        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17379         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17380         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17381                                 TO DC-BIN-DATE-2                 ELC50PD
 17382         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17383*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17384         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17385         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17386            NEXT SENTENCE                                         ELC50PD
 17387          ELSE                                                    ELC50PD
 17388             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17389                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 315
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17390                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17391                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17392                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17393                 ELSE                                             ELC50PD
 17394                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17395                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17396                                                                  ELC50PD
 17397     IF WS-ERROR = ER-2752                                        ELC50PD
 17398        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17399         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17400         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17401         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17402         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17403         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17404         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17405         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17406         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17407         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17408         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17409         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17410         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17411         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17412         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17413            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17414            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17415            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17416                                                                  ELC50PD
 17417     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17418        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17419        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17420             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17421             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17422                                                                  ELC50PD
 17423     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17424        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17425        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17426              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17427              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17428                                                                  ELC50PD
 17429     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17430        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17431        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17432           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17433            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17434              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17435               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17436               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17437                                                                  ELC50PD
 17438     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17439         GO TO 3999-END-EDIT.                                     ELC50PD
 17440                                                                  ELC50PD
 17441     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17442        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17443           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17444            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17445            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17446                                 TO DC-BIN-DATE-2                 ELC50PD
 17447            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 316
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17448*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17449            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17450            IF DATE-CONVERSION-ERROR                              ELC50PD
 17451               NEXT SENTENCE                                      ELC50PD
 17452             ELSE                                                 ELC50PD
 17453                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17454                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17455                                                                  ELC50PD
 17456     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17457        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17458           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17459            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17460            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17461                                 TO DC-BIN-DATE-2                 ELC50PD
 17462            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17463                                    DC-ELAPSED-MONTHS             ELC50PD
 17464            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17465*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17466            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17467            IF DATE-CONVERSION-ERROR                              ELC50PD
 17468               NEXT SENTENCE                                      ELC50PD
 17469             ELSE                                                 ELC50PD
 17470                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17471                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17472                                                                  ELC50PD
 17473     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17474                                    DC-ELAPSED-MONTHS.            ELC50PD
 17475                                                                  ELC50PD
 17476     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17477        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17478          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17479          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17480          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17481          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17482          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17483          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17484        ELSE                                                      ELC50PD
 17485          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17486                                     PB-C-LIVES                   ELC50PD
 17487          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17488             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17489                                                                  ELC50PD
 17490     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17491         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17492     ELSE                                                         ELC50PD
 17493         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17494                                                                  ELC50PD
 17495     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17496        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17497            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17498            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17499                                                                  ELC50PD
 17500     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17501        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17502         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17503            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17504               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17505               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 317
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17506                                                                  ELC50PD
 17507     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17508        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17509         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17510            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17511               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17512               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17513                                                                  ELC50PD
 17514     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17515        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17516         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17517            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17518            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17519                                                                  ELC50PD
 17520     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17521        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17522         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17523            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17524            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17525                                                                  ELC50PD
 17526     IF LF-COVERAGE-CANCELLED
 17527        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17528        if pb-ci-lf-expire-dt = low-values or spaces
 17529           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17530           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 17531           MOVE PB-CI-EXTENTION-DAYS
 17532                                 TO DC-ELAPSED-DAYS
 17533           SET BIN-PLUS-ELAPSED  TO TRUE
 17534           PERFORM 8500-DATE-CONVERT
 17535                                 THRU 8500-EXIT
 17536           IF DATE-CONVERSION-ERROR
 17537              move low-values    to dc-bin-date-2
 17538           end-if
 17539        else
 17540           move pb-ci-lf-expire-dt
 17541                                 to dc-bin-date-2
 17542        end-if
 17543        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 17544           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17545                             OR  'FIA'
 17546              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 17547           ELSE
 17548              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17549              MOVE ER-2731       TO WS-ERROR
 17550              PERFORM 9900-ERROR-FORMAT
 17551                                 THRU 9900-EXIT
 17552           end-if
 17553        end-if
 17554     end-if
 17555
 17556*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17557*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17558*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17559*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17560*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17561*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17562*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17563*        IF DATE-CONVERSION-ERROR                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 318
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17564*           NEXT SENTENCE                                         ELC50PD
 17565*         ELSE                                                    ELC50PD
 17566*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17567*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17568*                            OR  'FIA'                            ELC50PD
 17569*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17570*              ELSE                                               ELC50PD
 17571*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17572*               MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17573*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17574     .
 17575 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17576
 17577     IF AH-COVERAGE-CANCELLED
 17578        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 17579        if pb-ci-AH-expire-dt = low-values or spaces
 17580           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17581           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 17582           MOVE PB-CI-EXTENTION-DAYS
 17583                                 TO DC-ELAPSED-DAYS
 17584           SET BIN-PLUS-ELAPSED  TO TRUE
 17585           PERFORM 8500-DATE-CONVERT
 17586                                 THRU 8500-EXIT
 17587           IF DATE-CONVERSION-ERROR
 17588              move low-values    to dc-bin-date-2
 17589           end-if
 17590        else
 17591           move pb-ci-ah-expire-dt
 17592                                 to dc-bin-date-2
 17593        end-if
 17594        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 17595           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17596                             OR  'FIA'
 17597              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 17598           ELSE
 17599              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17600              MOVE ER-2771       TO WS-ERROR
 17601              PERFORM 9900-ERROR-FORMAT
 17602                                 THRU 9900-EXIT
 17603           end-if
 17604        end-if
 17605     end-if
 17606
 17607*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17608*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17609*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17610*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17611*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17612**       MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17613*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17614*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17615*        IF DATE-CONVERSION-ERROR                                 ELC50PD
 17616*           NEXT SENTENCE                                         ELC50PD
 17617*         ELSE                                                    ELC50PD
 17618*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17619*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17620*                             OR 'FIA'                            ELC50PD
 17621*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 319
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17622*             ELSE                                                ELC50PD
 17623*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17624*              MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17625*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17626     .
 17627 3705-EDIT-CONTINUED.                                             ELC50PD
 17628                                                                  ELC50PD
 17629*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17630*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17631*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17632*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17633*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17634*                                                                 ELC50PD
 17635*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17636*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17637*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17638*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17639*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17640*        ELSE                                                     ELC50PD
 17641*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17642*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17643*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17644                                                                  ELC50PD
 17645     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17646       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17647         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17648           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17649              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17650              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17651                                                                  ELC50PD
 17652     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17653        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17654            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17655            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17656            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17657                                                                  ELC50PD
 17658     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17659            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17660            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17661                                                                  ELC50PD
 17662     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17663         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17664            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17665            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17666                                                                  ELC50PD
 17667 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17668                                                                  ELC50PD
 17669     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17670         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17671             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17672                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17673                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17674                                                                  ELC50PD
 17675     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17676         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17677             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17678                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17679                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 320
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17680                                                                  ELC50PD
 17681 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17682                                                                  ELC50PD
 17683*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17684*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17685*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17686*           (NOT PB-CI-OB)                                        ELC50PD
 17687*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17688*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17689*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17690*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17691*                                                                 ELC50PD
 17692*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17693*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17694*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17695*           (NOT PB-CI-OB)                                        ELC50PD
 17696*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17697*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17698*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17699*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17700                                                                  ELC50PD
 17701     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17702         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17703            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17704             NEXT SENTENCE                                        ELC50PD
 17705         ELSE                                                     ELC50PD
 17706           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17707              NEXT SENTENCE                                       ELC50PD
 17708           ELSE                                                   ELC50PD
 17709              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17710              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17711                                                                  ELC50PD
 17712     IF CANCEL-FUTURE-DT                                          ELC50PD
 17713         GO TO 3999-END-EDIT.                                     ELC50PD
 17714                                                                  ELC50PD
 17715 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17716                                                                  ELC50PD
 17717     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17718        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17719        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17720                                                                  ELC50PD
 17721     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17722     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17723     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17724     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17725     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17726     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17727     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17728     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17729     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17730     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17731     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17732     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17733
 17734     IF (PB-COMPANY-ID = 'CID')
 17735        AND (CP-STATE-STD-ABBRV = 'WI')
 17736        MOVE '7'                 TO CP-REM-TERM-METHOD
 17737        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 321
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17738     ELSE
 17739        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17740        MOVE WS-REM-TRM-CALC-OPTION
 17741                                 TO CP-REM-TRM-CALC-OPTION
 17742     END-IF
 17743
 17744**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17745     IF (PB-COMPANY-ID = 'CID')
 17746        AND (CP-STATE-STD-ABBRV = 'MO')
 17747        AND (PB-CERT-EFF-DT >= X'9B41')
 17748        AND (PB-CERT-EFF-DT <= X'A2FB')
 17749        MOVE '7'                 TO CP-REM-TERM-METHOD
 17750        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17751     END-IF
 17752
 17753     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17754                                    CP-LOAN-TERM.                 ELC50PD
 17755     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17756        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17757                                                                  ELC50PD
 17758     IF CP-TERM-IS-DAYS                                           ELC50PD
 17759         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17760     ELSE                                                         ELC50PD
 17761         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17762                                                                  ELC50PD
 17763     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17764                                                                  ELC50PD
 17765     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17766                                                                  ELC50PD
 17767     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17768        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17769        NEXT SENTENCE                                             ELC50PD
 17770      ELSE                                                        ELC50PD
 17771          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17772                                                                  ELC50PD
 17773 3720-GET-LF-REFUND.                                              ELC50PD
 17774                                                                  ELC50PD
 17775     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17776        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17777        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17778                                                                  ELC50PD
 17779     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17780         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17781         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17782         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17783                                                                  ELC50PD
 17784     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17785        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17786         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17788         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17789         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17790         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17791                                                                  ELC50PD
 17792*    if (ws-lf-earnings-calc = '6')
 17793*       or (pb-c-lf-refund-override = '6')
 17794*       move cp-remaining-term-1 to cp-remaining-term-2
 17795*    end-if
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 322
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17796     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17797                                                                     CL**2
 17798     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17799     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17800     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17801     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17802     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17803     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17804
 17805     IF (PB-COMPANY-ID = 'DCC')
 17806        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17807
 17808        IF PDEF-MASTER-FOUND
 17809           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17810              (V1 > +8)
 17811              OR (PD-PROD-CODE (V1) = 'L')
 17812           END-PERFORM
 17813           IF V1 < +9
 17814              MOVE PD-MAX-AMT (V1)
 17815                           TO CP-R-MAX-TOT-BEN
 17816                              EC-AM-LF-MAX-TOT-BEN
 17817           END-IF
 17818        ELSE
 17819
 17820        MOVE ' '                 TO PDEF-MASTER-SW
 17821        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17822        MOVE PB-STATE            TO ERPDEF-STATE
 17823        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17824        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17825        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17826        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17827        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17828        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17829        IF PDEF-MASTER-FOUND
 17830           MOVE 'N'              TO PDEF-MASTER-SW
 17831           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17832           IF PDEF-MASTER-FOUND
 17833              IF (ERPDEF-KEY-SAVE (1:16) =
 17834                           PD-CONTROL-PRIMARY (1:16))
 17835                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17836                 CONTINUE
 17837              ELSE
 17838                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17839                 IF (ERPDEF-KEY-SAVE (1:16) =
 17840                           PD-CONTROL-PRIMARY (1:16))
 17841                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17842                    CONTINUE
 17843                 ELSE
 17844                    MOVE 'N'     TO PDEF-MASTER-SW
 17845                 END-IF
 17846              END-IF
 17847              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17848
 17849              IF PDEF-MASTER-FOUND
 17850                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17851                    (V1 > +8)
 17852                    OR (PD-PROD-CODE (V1) = 'L')
 17853                 END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 323
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17854                 IF V1 < +9
 17855                    MOVE PD-MAX-AMT (V1)
 17856                                 TO CP-R-MAX-TOT-BEN
 17857                                    EC-AM-LF-MAX-TOT-BEN
 17858                 END-IF
 17859              END-IF
 17860           END-IF
 17861           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17862        END-IF
 17863        END-IF
 17864     END-IF
 17865
 17866     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17867                                                                  ELC50PD
 17868     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17869                                                                  ELC50PD
 17870     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17871                                    PB-C-LF-REM-TERM.                CL**2
 17872                                                                     CL**2
 17873     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17874     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17875                                                                  ELC50PD
 17876     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17877        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17878           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17879           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17880                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17881                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17882           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17883              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17884              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17885           ELSE                                                   ELC50PD
 17886              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17887                                                                  ELC50PD
 17888     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17889                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17890                            OR '9' OR 'G'
 17891        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17892                                 TO CP-EARNING-METHOD.            ELC50PD
 17893                                                                  ELC50PD
 17894     if pb-company-id = 'AHL'
 17895        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17896        if cp-class-code = spaces
 17897           move zeros            to cp-class-code
 17898        end-if
 17899     ELSE
 17900        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17901     END-IF
 17902
 17903*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17904     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17905     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17906                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17907     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17908         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17909                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17910     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17911     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 324
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17912     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17913     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17914     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17915     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17916     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17917     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17918         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17919                                                                  ELC50PD
 17920****   N O T E   ****
 17921*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17922*      THE OH HARD CODING IN ELCRFNDP
 17923
 17924     IF PB-COMPANY-ID = 'CID'
 17925        IF CP-STATE-STD-ABBRV = 'OH'
 17926           MOVE WS-LF-EARNINGS-CALC
 17927                                 TO CP-EARNING-METHOD
 17928        END-IF
 17929     END-IF
 17930
 17931****   N O T E   ****
 17932
 17933     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17934         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17935            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17936                MOVE WS-DEFAULT-APR                               ELC50PD
 17937                                 TO  CP-LOAN-APR                  ELC50PD
 17938                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17939                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17940            ELSE                                                  ELC50PD
 17941                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17942                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17943
 17944*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17945
 17946     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17947                                                                  ELC50PD
 17948     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17949         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17950                                                                  ELC50PD
 17951     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17952        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17953        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17954        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17955                                                                  ELC50PD
 17956     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17957        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17958        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17959                                                                  ELC50PD
 17960     IF PB-COMPANY-ID = 'DCC'
 17961        AND PB-CI-ENTRY-STATUS = 'M'
 17962        MOVE +0                  TO PB-C-LF-REF-CALC
 17963     ELSE
 17964        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17965     END-IF
 17966                                                                  ELC50PD
 17967     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17968         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17969                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 325
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17970*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17971*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17972*                                   CP-REMAINING-TERM             ELC50PD
 17973*                                   CP-ORIGINAL-TERM.             ELC50PD
 17974                                                                  ELC50PD
 17975     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17976     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17977                                    CP-RATING-METHOD.             ELC50PD
 17978
 17979     IF PB-COMPANY-ID = 'CID'
 17980        IF (CP-STATE-STD-ABBRV = 'MN')
 17981           AND (PB-CERT-EFF-DT > X'A4FF')
 17982           AND (WS-LF-EARNINGS-CALC = 'B')
 17983           MOVE '5'              TO CP-EARNING-METHOD
 17984           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17985        END-IF
 17986     END-IF
 17987
 17988     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17989                                        CP-REMAINING-BENEFIT      ELC50PD
 17990                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17991     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17992         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17993                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17994     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17995     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17996                                                                  ELC50PD
 17997     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17998                                                                  ELC50PD
 17999     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18000        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18001        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18002        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18003                                                                  ELC50PD
 18004     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18005        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18007                                                                  ELC50PD
 18008     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 18009                                                                  ELC50PD
 18010******************************************************************ELC50PD
 18011                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 326
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18013 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 18014     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 18015        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 18016         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18017                                                                  ELC50PD
 18018     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 18019         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 18020            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 18021             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 18022                                                                  ELC50PD
 18023     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 18024     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 18025     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 18026     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 18027     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 18028     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 18029     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 18030     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 18031     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 18032     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 18033     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 18034     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 18035
 18036     IF (PB-COMPANY-ID = 'CID')
 18037        AND (CP-STATE-STD-ABBRV = 'WI')
 18038        MOVE '7'                 TO CP-REM-TERM-METHOD
 18039        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18040     ELSE
 18041        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 18042        MOVE WS-REM-TRM-CALC-OPTION
 18043                                 TO CP-REM-TRM-CALC-OPTION
 18044     END-IF
 18045
 18046     IF (PB-COMPANY-ID = 'CID')
 18047        AND (CP-STATE-STD-ABBRV = 'MO')
 18048        AND (PB-CERT-EFF-DT >= X'9B41')
 18049        AND (PB-CERT-EFF-DT <= X'A2FB')
 18050        MOVE '7'                 TO CP-REM-TERM-METHOD
 18051        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18052     END-IF
 18053
 18054     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 18055                                    CP-LOAN-TERM.                 ELC50PD
 18056     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 18057         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 18058                                                                  ELC50PD
 18059     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 18060                                                                  ELC50PD
 18061     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 18062                                                                  ELC50PD
 18063     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 18064        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 18065        NEXT SENTENCE                                             ELC50PD
 18066      ELSE                                                        ELC50PD
 18067         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18068                                                                  ELC50PD
 18069 3740-GET-AH-REFUND.                                              ELC50PD
 18070                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 327
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18071     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 18072        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18073        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18074                                                                  ELC50PD
 18075     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 18076         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 18077         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18078                                                                  ELC50PD
 18079     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 18080*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 18081     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 18082     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 18083     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 18084                                    PB-C-AH-REM-TERM.             ELC50PD
 18085     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 18086     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 18087                                                                  ELC50PD
 18088     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 18089        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 18090           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 18091           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 18092                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 18093           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 18094              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 18095              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 18096           ELSE                                                   ELC50PD
 18097              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 18098                                                                  ELC50PD
 18099     IF PB-COMPANY-ID = 'DCC'
 18100        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18101            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 18102           MOVE 'S'              TO CP-EARNING-METHOD
 18103        END-IF
 18104     END-IF
 18105
 18106     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 18107                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 18108                            OR '9' OR 'G' OR 'S'
 18109        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 18110                                 TO CP-EARNING-METHOD.            ELC50PD
 18111                                                                  ELC50PD
 18112     if pb-company-id = 'AHL'
 18113        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 18114        if cp-class-code = spaces
 18115           move zeros            to cp-class-code
 18116        end-if
 18117     ELSE
 18118        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 18119     END-IF
 18120*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 18121     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 18122     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 18123                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 18124     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18125         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 18126                                         PB-CI-AH-TERM.           ELC50PD
 18127     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 18128     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 328
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18129     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 18130     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 18131     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 18132     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 18133                                                                  ELC50PD
 18134     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18135        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18136                                AND 'CID' AND 'DCC' AND 'AHL')
 18137           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18138              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18139              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18140              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18141           END-IF
 18142        END-IF
 18143        IF PB-COMPANY-ID = 'CID'
 18144           IF NO-LIFE-COVERAGE
 18145              IF CP-CRITICAL-PERIOD
 18146                 MOVE '2'       TO CP-EARNING-METHOD
 18147              ELSE
 18148                 MOVE '6'       TO CP-EARNING-METHOD
 18149              END-IF
 18150           ELSE
 18151              IF WS-LF-COVERAGE-TYPE = 'L'
 18152                 MOVE '2'       TO CP-EARNING-METHOD
 18153              ELSE
 18154                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18155                    (WS-LF-EARNINGS-CALC = '5')
 18156                    IF CP-CRITICAL-PERIOD
 18157                       MOVE '2'  TO CP-EARNING-METHOD
 18158                    ELSE
 18159                       MOVE '6'  TO CP-EARNING-METHOD
 18160                    END-IF
 18161                 ELSE
 18162                    MOVE '1'     TO CP-EARNING-METHOD
 18163                 END-IF
 18164              END-IF
 18165           END-IF
 18166        END-IF
 18167     END-IF
 18168                                                                  ELC50PD
 18169*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18170*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18171*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18172*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18173*          ELSE                                                   ELC50PD
 18174*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18175                                                                  ELC50PD
 18176     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18177         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18178                                                                  ELC50PD
 18179     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18180         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18181            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18182                MOVE WS-DEFAULT-APR                               ELC50PD
 18183                                 TO  CP-LOAN-APR                  ELC50PD
 18184                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18185                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18186            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 329
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18187                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18188                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18189
 18190     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18191
 18192
 18193     IF PB-COMPANY-ID = 'DCC'
 18194        AND CP-CANCEL-REASON = 'R'
 18195        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18196        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18197     END-IF
 18198
 18199     IF PB-COMPANY-ID = 'DCC'
 18200        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18201        AND (CP-EARNING-METHOD = 'D')
 18202        AND (CP-CANCEL-REASON NOT = 'R')
 18203        CONTINUE
 18204     ELSE
 18205        GO TO 3750-CONTINUE
 18206     END-IF
 18207
 18208     MOVE ' '                    TO DD-IU-SW
 18209     IF NOT PDEF-MASTER-FOUND
 18210        MOVE ' '                 TO PDEF-MASTER-SW
 18211        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18212        MOVE PB-STATE            TO ERPDEF-STATE
 18213        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18214        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18215        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18216        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18217        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18218        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18219        IF PDEF-MASTER-FOUND
 18220           MOVE 'N'              TO PDEF-MASTER-SW
 18221           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18222           IF PDEF-MASTER-FOUND
 18223              IF (ERPDEF-KEY-SAVE (1:16) =
 18224                           PD-CONTROL-PRIMARY (1:16))
 18225                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18226                 CONTINUE
 18227              ELSE
 18228                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18229                 IF (ERPDEF-KEY-SAVE (1:16) =
 18230                           PD-CONTROL-PRIMARY (1:16))
 18231                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18232                    CONTINUE
 18233                 ELSE
 18234                    MOVE ER-2740 TO WS-ERROR
 18235                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18236                    GO TO 3770-CHECK-REFUNDS
 18237                 END-IF
 18238              END-IF
 18239           END-IF
 18240           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18241        END-IF
 18242     END-IF
 18243
 18244     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 330
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18245        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18246           (V1 > +8)
 18247           OR (PD-PROD-CODE (V1) = 'I')
 18248        END-PERFORM
 18249        IF V1 < +9
 18250           SET DD-IU-PRESENT        TO TRUE
 18251        END-IF
 18252        IF WS-AH-DCC-TRUNC = 'T'
 18253           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18254        ELSE
 18255           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18256        END-IF
 18257        EVALUATE TRUE
 18258           WHEN WS-TERM > +168
 18259              MOVE 15               TO V1
 18260           WHEN WS-TERM > +156
 18261              MOVE 14               TO V1
 18262           WHEN WS-TERM > +144
 18263              MOVE 13               TO V1
 18264           WHEN WS-TERM > +132
 18265              MOVE 12               TO V1
 18266           WHEN WS-TERM > +120
 18267              MOVE 11               TO V1
 18268           WHEN WS-TERM > +108
 18269              MOVE 10               TO V1
 18270           WHEN WS-TERM > +96
 18271              MOVE 9                TO V1
 18272           WHEN WS-TERM > +84
 18273              MOVE 8                TO V1
 18274           WHEN WS-TERM > +72
 18275              MOVE 7                TO V1
 18276           WHEN WS-TERM > +60
 18277              MOVE 6                TO V1
 18278           WHEN WS-TERM > +48
 18279              MOVE 5                TO V1
 18280           WHEN WS-TERM > +36
 18281              MOVE 4                TO V1
 18282           WHEN WS-TERM > +24
 18283              MOVE 3                TO V1
 18284           WHEN WS-TERM > +12
 18285              MOVE 2                TO V1
 18286           WHEN OTHER
 18287              MOVE 1                TO V1
 18288        END-EVALUATE
 18289
 18290        EVALUATE TRUE
 18291*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18292*             < +13)
 18293*             AND (DD-IU-PRESENT)
 18294*             MOVE 2                TO V2
 18295*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18296*             MOVE 1                TO V2
 18297           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18298              MOVE 2                TO V2
 18299           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18300              MOVE 3                TO V2
 18301           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18302              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 331
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18303           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18304              MOVE 5                TO V2
 18305           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18306              MOVE 6                TO V2
 18307           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18308              MOVE 7                TO V2
 18309           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18310              MOVE 8                TO V2
 18311           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18312              MOVE 9                TO V2
 18313           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18314              MOVE 10               TO V2
 18315           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18316              MOVE 11               TO V2
 18317           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18318              MOVE 12               TO V2
 18319           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18320              MOVE 13               TO V2
 18321           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18322              MOVE 14               TO V2
 18323           WHEN OTHER
 18324              MOVE 15               TO V2
 18325        END-EVALUATE
 18326
 18327        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18328                                 TO CP-DDF-LO-FACT
 18329        MOVE PD-UEP-FACTOR (V1 V2)
 18330                                 TO CP-DDF-HI-FACT
 18331
 18332        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18333        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18334
 18335        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18336           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18337        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18338        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18339
 18340        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18341           + PD-1ST-YR-ADMIN-ALLOW
 18342
 18343        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18344*       IF PI-CLP-YN = 'Y'
 18345*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18346*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18347*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18348*       END-IF
 18349
 18350        IF DD-IU-PRESENT
 18351           MOVE 'I'              TO CP-EARNING-METHOD
 18352        END-IF
 18353        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18354                                     CP-CLP-RATE-UP
 18355        IF CP-IU-RATE-UP NOT = ZEROS
 18356           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18357              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18358           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18359              / (1 - WS-WORK-FACT)
 18360        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 332
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18361     END-IF
 18362
 18363     .
 18364 3750-CONTINUE.
 18365
 18366     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18367                                                                  ELC50PD
 18368     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18369         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18370                                                                  ELC50PD
 18371     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18372        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18373        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18375                                                                  ELC50PD
 18376     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18377        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18379
 18380     IF PB-COMPANY-ID = 'DCC'
 18381        AND PB-CI-ENTRY-STATUS = 'M'
 18382        MOVE +0                  TO PB-C-AH-REF-CALC
 18383     ELSE
 18384        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18385     END-IF
 18386
 18387     IF PB-COMPANY-ID = 'DCC'
 18388        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18389        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18390        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18391        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18392        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18393        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18394        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18395        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18396        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18397     END-IF
 18398
 18399     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 333
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18401                                                                  ELC50PD
 18402 3770-CHECK-REFUNDS.                                              ELC50PD
 18403                                                                  ELC50PD
 18404     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18405        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18406           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18407           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18408           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18409           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18410              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18411                                                                  ELC50PD
 18412     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18413        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18414           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18415           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18416           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18417           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18418              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18419                                                                  ELC50PD
 18420     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18421        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18422        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18423           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18424              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18425                                                                  ELC50PD
 18426     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18427        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18428        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18429           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18430              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18431                                                                  ELC50PD
 18432     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18433             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18434     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18435             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18436                                                                  ELC50PD
 18437     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18438         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18439                                                                  ELC50PD
 18440     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18441         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18442                                                                  ELC50PD
 18443     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18444                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 334
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18446                                                                  ELC50PD
 18447 3772-CONTINUE.                                                   ELC50PD
 18448                                                                  ELC50PD
 18449**********************************                                ELC50PD
 18450*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18451*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18452*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18453***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18454**********************************                                ELC50PD
 18455     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18456     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18457         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18458             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18459             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18460           ELSE                                                   ELC50PD
 18461             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18462             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18463**********************************                                ELC50PD
 18464                                                                  ELC50PD
 18465 3773-CONTINUE.                                                   ELC50PD
 18466                                                                  ELC50PD
 18467     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18468        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18469           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18471                                                                  ELC50PD
 18472     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18473        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18474           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18475           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18476                                                                  ELC50PD
 18477     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18478         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18479             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18480     ELSE                                                         ELC50PD
 18481         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18482                                                                  ELC50PD
 18483     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18484         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18485             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18486     ELSE                                                         ELC50PD
 18487         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18488                                                                  ELC50PD
 18489     IF (PB-COMPANY-ID = 'DCC')
 18490        AND (PB-CI-ENTRY-STATUS = 'M')
 18491        AND (PB-C-LF-CANCEL-AMT > +0)
 18492        MOVE ER-3843             TO WS-ERROR
 18493        PERFORM 9900-ERROR-FORMAT
 18494                                 THRU 9900-EXIT
 18495     END-IF
 18496     EVALUATE TRUE                                                ELC50PD
 18497        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18498           CONTINUE                                               ELC50PD
 18499        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18500                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18501           CONTINUE                                               ELC50PD
 18502        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18503                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 335
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18504           CONTINUE                                               ELC50PD
 18505        WHEN OTHER                                                ELC50PD
 18506           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18507              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18508           END-IF                                                 ELC50PD
 18509           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18510                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18511                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18512              CONTINUE                                            ELC50PD
 18513           ELSE                                                   ELC50PD
 18514              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18515                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18516              END-IF                                              ELC50PD
 18517              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18518                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18519                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18520                 CONTINUE                                         ELC50PD
 18521              ELSE                                                ELC50PD
 18522                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18523                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18524                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18525                 ELSE                                             ELC50PD
 18526                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18527                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18528                 END-IF                                           ELC50PD
 18529              END-IF                                              ELC50PD
 18530           END-IF                                                 ELC50PD
 18531     END-EVALUATE.                                                ELC50PD
 18532                                                                  ELC50PD
 18533     EVALUATE TRUE                                                ELC50PD
 18534        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18535           CONTINUE                                               ELC50PD
 18536        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18537                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18538           CONTINUE                                               ELC50PD
 18539        WHEN OTHER                                                ELC50PD
 18540           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18541               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18542              CONTINUE                                            ELC50PD
 18543           ELSE                                                   ELC50PD
 18544              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18545               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18546                CONTINUE                                          ELC50PD
 18547              ELSE                                                ELC50PD
 18548                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18549                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18550                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18551                 ELSE                                             ELC50PD
 18552                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18553                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18554                 END-IF                                           ELC50PD
 18555              END-IF                                              ELC50PD
 18556           END-IF                                                 ELC50PD
 18557     END-EVALUATE.                                                ELC50PD
 18558                                                                  ELC50PD
 18559     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18560         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18561             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 336
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18562     ELSE                                                         ELC50PD
 18563         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18564                                                                  ELC50PD
 18565     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18566         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18567             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18568     ELSE                                                         ELC50PD
 18569         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18570                                                                  ELC50PD
 18571     IF (PB-COMPANY-ID = 'DCC')
 18572        AND (PB-CI-ENTRY-STATUS = 'M')
 18573        AND (PB-C-AH-CANCEL-AMT > +0)
 18574        MOVE ER-3843             TO WS-ERROR
 18575        PERFORM 9900-ERROR-FORMAT
 18576                                 THRU 9900-EXIT
 18577     END-IF
 18578     EVALUATE TRUE                                                ELC50PD
 18579        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18580           CONTINUE                                               ELC50PD
 18581*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18582*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18583        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18584                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18585           CONTINUE                                               ELC50PD
 18586        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18587                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18588           CONTINUE                                               ELC50PD
 18589        WHEN OTHER                                                ELC50PD
 18590           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18591              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18592           END-IF                                                 ELC50PD
 18593           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18594               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18595                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18596              CONTINUE                                            ELC50PD
 18597           ELSE                                                   ELC50PD
 18598              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18599                 MOVE +9999999.99 TO                              ELC50PD
 18600                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18601              END-IF                                              ELC50PD
 18602              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18603                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18604                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18605                 CONTINUE                                         ELC50PD
 18606              ELSE                                                ELC50PD
 18607                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18608                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18609                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18610                 ELSE                                             ELC50PD
 18611                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18612                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18613                 END-IF                                           ELC50PD
 18614              END-IF                                              ELC50PD
 18615           END-IF                                                 ELC50PD
 18616     END-EVALUATE.                                                ELC50PD
 18617                                                                  ELC50PD
 18618     EVALUATE TRUE                                                ELC50PD
 18619        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 337
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18620           CONTINUE                                               ELC50PD
 18621*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18622*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18623        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18624                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18625           CONTINUE                                               ELC50PD
 18626        WHEN OTHER                                                ELC50PD
 18627           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18628               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18629              CONTINUE                                            ELC50PD
 18630           ELSE                                                   ELC50PD
 18631              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18632                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18633                 CONTINUE                                         ELC50PD
 18634              ELSE                                                ELC50PD
 18635                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18636                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18637                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18638                 ELSE                                             ELC50PD
 18639                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18640                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18641                 END-IF                                           ELC50PD
 18642              END-IF                                              ELC50PD
 18643           END-IF                                                 ELC50PD
 18644     END-EVALUATE.                                                ELC50PD
 18645                                                                  ELC50PD
 18646     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18647        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18648        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18649           AND  PB-C-LF-REF-CALC < +1.00
 18650           AND  PB-C-AH-REF-CALC < +1.00
 18651           CONTINUE
 18652        ELSE
 18653           IF (PB-COMPANY-ID = 'DCC')
 18654              AND (PB-CI-ENTRY-STATUS = 'M')
 18655              CONTINUE
 18656           ELSE
 18657              MOVE ER-2741       TO WS-ERROR
 18658              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18659           END-IF
 18660        END-IF
 18661     END-IF
 18662                                                                  ELC50PD
 18663     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18664        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18665        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18666        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18667        OR                                                        ELC50PD
 18668        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18669        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18670        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18671             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18672                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18673                NEXT SENTENCE                                     ELC50PD
 18674             ELSE                                                 ELC50PD
 18675                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18676                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18677                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 338
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18678     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18679        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18680        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18681        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18682        OR                                                        ELC50PD
 18683        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18684        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18685        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18686             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18687                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18688                NEXT SENTENCE                                     ELC50PD
 18689             ELSE                                                 ELC50PD
 18690                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18691                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18692                                                                  ELC50PD
 18693 3775-OVER-REF-CHK.                                               ELC50PD
 18694                                                                  ELC50PD
 18695     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18696        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18697                                                                  ELC50PD
 18698     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18699                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18700                                                                  ELC50PD
 18701     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18702        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18703                                 PB-C-LF-REF-CALC                 ELC50PD
 18704      ELSE                                                        ELC50PD
 18705        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18706                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18707                                                                  ELC50PD
 18708     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18709        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18711                                                                  ELC50PD
 18712     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18713                                                                  ELC50PD
 18714     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18715        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18716                                 PB-C-AH-REF-CALC                 ELC50PD
 18717      ELSE                                                        ELC50PD
 18718        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18719                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18720                                                                  ELC50PD
 18721     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18722        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18724                                                                  ELC50PD
 18725     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18726        NEXT SENTENCE                                             ELC50PD
 18727       ELSE                                                       ELC50PD
 18728         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18729            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18730            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18731                                                                  ELC50PD
 18732 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18733                                                                  ELC50PD
 18734     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18735        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 339
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18737                                                                  ELC50PD
 18738     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18739         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18741                                                                  ELC50PD
 18742     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18743         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18744                                                                  ELC50PD
 18745     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18746         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18747                                                                  ELC50PD
 18748     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18749       AND                                                        ELC50PD
 18750        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18751       AND                                                        ELC50PD
 18752        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18753       AND                                                        ELC50PD
 18754        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18755            NEXT SENTENCE                                         ELC50PD
 18756       ELSE                                                       ELC50PD
 18757        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18758          AND                                                     ELC50PD
 18759***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18760***       AND                                                     ELC50PD
 18761           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18762            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18763               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18764               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18765               GO TO 3999-END-EDIT                                ELC50PD
 18766            ELSE                                                  ELC50PD
 18767               GO TO 3999-END-EDIT                                ELC50PD
 18768        ELSE                                                      ELC50PD
 18769            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18770               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18771               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18772               GO TO 3785-CHECK-NH.
 18773*              GO TO 3999-END-EDIT.                               ELC50PD
 18774                                                                  ELC50PD
 18775 3780-UPDATE-CONT-1.                                              ELC50PD
 18776     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18777                                                                  ELC50PD
 18778     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18779         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18780                                                                  ELC50PD
 18781     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18782         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18783
 18784     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18785                                                                  ELC50PD
 18786     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18787       AND                                                        ELC50PD
 18788        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18789       AND                                                        ELC50PD
 18790        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18791       AND                                                        ELC50PD
 18792        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18793            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 340
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18794       ELSE                                                       ELC50PD
 18795        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18796          AND                                                     ELC50PD
 18797***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18798***       AND                                                     ELC50PD
 18799           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18800           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18801            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18802               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18803               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18804               GO TO 3999-END-EDIT                                ELC50PD
 18805            ELSE                                                  ELC50PD
 18806               GO TO 3999-END-EDIT                                ELC50PD
 18807            END-IF
 18808           ELSE
 18809             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18810                MOVE ER-2890 TO WS-ERROR
 18811                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18812                GO TO 3999-END-EDIT
 18813             ELSE
 18814                GO TO 3785-CHECK-NH
 18815             END-IF
 18816           END-IF
 18817          ELSE                                                    ELC50PD
 18818            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18819              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18820                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18821                   MOVE ER-2890 TO WS-ERROR
 18822                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18823                   GO TO 3999-END-EDIT
 18824                ELSE
 18825                   MOVE ER-2765 TO WS-ERROR
 18826                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18827                   GO TO 3785-CHECK-NH
 18828                END-IF
 18829              ELSE
 18830               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18831               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18832               GO TO 3785-CHECK-NH.
 18833*              GO TO 3999-END-EDIT.                               ELC50PD
 18834                                                                  ELC50PD
 18835 3780-UPDATE-CONT-2.                                              ELC50PD
 18836                                                                  ELC50PD
 18837     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18838        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18839           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18841                                                                  ELC50PD
 18842     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18843        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18844           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18846                                                                  ELC50PD
 18847     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18848        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18849        AND                                                       ELC50PD
 18850        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18851         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 341
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18852           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18854                                                                  ELC50PD
 18855     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18856       AND                                                        ELC50PD
 18857        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18858             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18860                                                                  ELC50PD
 18861     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18862       AND                                                        ELC50PD
 18863        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18864             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18865             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18866                                                                  ELC50PD
 18867     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18868         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18869             OR 'CID' OR 'DCC' OR 'AHL'
 18870             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18871         ELSE                                                     ELC50PD
 18872             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18873                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18874                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18875             ELSE                                                 ELC50PD
 18876                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18877                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18878                                                                  ELC50PD
 18879     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18880        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18882
 18883 3785-CHECK-NH.
 18884
 18885     IF PB-STATE NOT = 'NH'
 18886        GO TO 3999-END-EDIT
 18887     END-IF
 18888
 18889     MOVE ER-2796                TO WS-ERROR
 18890     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18891
 18892     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18893        OR (CM-NH-INTERFACE-SW = 'Y')
 18894        MOVE ER-2793             TO WS-ERROR
 18895        PERFORM 9900-ERROR-FORMAT
 18896                                 THRU 9900-EXIT
 18897     END-IF
 18898
 18899     MOVE +0                     TO WS-PAYMENT-AMT
 18900     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18901        GO TO 3999-END-EDIT
 18902     END-IF
 18903
 18904     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18905        GO TO 3999-END-EDIT
 18906     END-IF
 18907
 18908     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18909     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 342
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18910
 18911     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18912        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18913     END-IF
 18914     MOVE '1'                    TO DC-OPTION-CODE
 18915     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18916     IF NO-CONVERSION-ERROR
 18917        IF DC-ELAPSED-DAYS < +16
 18918           GO TO 3999-END-EDIT
 18919        END-IF
 18920     END-IF
 18921
 18922     MOVE +0                     TO DC-ELAPSED-DAYS
 18923     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18924     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18925     MOVE '1'                    TO DC-OPTION-CODE
 18926     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18927     IF NO-CONVERSION-ERROR
 18928        IF DC-ELAPSED-DAYS > +30
 18929           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18930        ELSE
 18931           GO TO 3999-END-EDIT
 18932        END-IF
 18933     ELSE
 18934        GO TO 3999-END-EDIT
 18935     END-IF
 18936
 18937     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18938        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18939           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18940
 18941     IF WS-PAYMENT-AMT < 600.00
 18942        GO TO 3999-END-EDIT
 18943     END-IF
 18944
 18945     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18946                                                                  ELC50PD
 18947     IF (ERMAIL-FOUND = ' ')
 18948         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18949         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18950        GO TO 3999-END-EDIT
 18951     END-IF
 18952
 18953     MOVE ER-2795                TO WS-ERROR
 18954     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18955                                                                  ELC50PD
 18956     GO TO 3999-END-EDIT.                                         ELC50PD
 18957******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 343
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18959 3990-FILES-NOT-OPEN.                                             ELC50PD
 18960                                                                  ELC50PD
 18961     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18962     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18963     GO TO 9990-RETURN.                                           ELC50PD
 18964                                                                  ELC50PD
 18965 3999-END-EDIT.                                                   ELC50PD
 18966
 18967                                                                  ELC50PD
 18968     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18969                                                                  ELC50PD
 18970     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18971         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18972         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18973             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18974             GO TO 9990-RETURN                                    ELC50PD
 18975          ELSE                                                    ELC50PD
 18976             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18977             GO TO 9990-RETURN.                                   ELC50PD
 18978                                                                  ELC50PD
 18979     IF PB-CANCELLATION                                           ELC50PD
 18980          GO TO 9990-RETURN.                                      ELC50PD
 18981                                                                  ELC50PD
 18982     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18983        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18984                                                                  ELC50PD
 18985     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18986                                                                  ELC50PD
 18987     IF CERT-WAS-FOUND                                            ELC50PD
 18988         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18989             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18990          ELSE                                                    ELC50PD
 18991            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18992      ELSE                                                        ELC50PD
 18993         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18994
 18995     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18996        IF PB-COMPANY-ID = 'DCC' AND
 18997           (PB-CARRIER = '2' OR '4' OR '6')
 18998              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18999        END-IF
 19000     END-IF.
 19001
 19002     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 19003         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 19004     END-IF.
 19005
 19006     move ' '                    to ws-ins-age-defaulted
 19007     perform 8150-read-elcrtt    thru 8150-exit
 19008     if ws-ins-age-defaulted = 'Y'
 19009        move er-1573             to ws-error
 19010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19011     end-if
 19012
 19013     if ws-jnt-age-defaulted = 'Y'
 19014        move er-1574             to ws-error
 19015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19016     end-if
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 344
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19017
 19018     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 19019     IF ((PB-COMPANY-ID = 'DCC')
 19020        AND (WS-NO-SECURE-PAY))
 19021                  OR
 19022        (WS-LF-SPECIAL-CALC-CD = 'O'
 19023        OR WS-AH-SPECIAL-CALC-CD = 'O')
 19024        SET SKIP-ADDR-EDIT       TO TRUE
 19025     END-IF
 19026
 19027     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 19028        AND (NOT SKIP-ADDR-EDIT)
 19029        MOVE ER-2963             TO WS-ERROR
 19030        PERFORM 9900-ERROR-FORMAT
 19031                                 THRU 9900-EXIT
 19032        GO TO 9990-RETURN
 19033     END-IF
 19034
 19035     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 19036
 19037     IF ERPNDM-FOUND NOT = 'X'
 19038        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19039           OR (PM-CITY        = SPACES OR LOW-VALUES)
 19040           OR (PM-STATE       = SPACES OR LOW-VALUES)
 19041           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 19042           AND (NOT SKIP-ADDR-EDIT)
 19043           MOVE ER-2694          TO WS-ERROR
 19044           PERFORM 9900-ERROR-FORMAT
 19045                                 THRU 9900-EXIT
 19046        END-IF
 19047        MOVE ' '                 TO STATE-RECORD-ERROR
 19048        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19049        MOVE PM-STATE            TO CNTL-ACCESS
 19050        MOVE '3'                 TO CNTL-REC-TYPE
 19051        MOVE +0                  TO CNTL-SEQ-NO
 19052        MOVE '0'                 TO RC-SW-2
 19053        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19054        IF (NO-STATE-RECORD)
 19055           OR (CF-RECORD-TYPE NOT = '3')
 19056           OR (PM-STATE NOT = CF-STATE-CODE)
 19057           IF (PM-STATE = SPACES)
 19058              AND (SKIP-ADDR-EDIT)
 19059              CONTINUE
 19060           ELSE
 19061              MOVE ER-2963       TO WS-ERROR
 19062              PERFORM 9900-ERROR-FORMAT
 19063                                 THRU 9900-EXIT
 19064           END-IF
 19065        END-IF
 19066        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 19067           MOVE ER-2883          TO WS-ERROR
 19068           PERFORM 9900-ERROR-FORMAT
 19069                                 THRU 9900-EXIT
 19070        END-IF
 19071        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 19072           MOVE ' '                 TO STATE-RECORD-ERROR
 19073           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19074           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 345
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19075           MOVE '3'                 TO CNTL-REC-TYPE
 19076           MOVE +0                  TO CNTL-SEQ-NO
 19077           MOVE '0'                 TO RC-SW-2
 19078           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19079           IF NO-STATE-RECORD
 19080              OR (CF-RECORD-TYPE NOT = '3')
 19081              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 19082              MOVE ER-2964          TO WS-ERROR
 19083              PERFORM 9900-ERROR-FORMAT
 19084                                    THRU 9900-EXIT
 19085           END-IF
 19086        END-IF
 19087     ELSE
 19088        IF NOT SKIP-ADDR-EDIT
 19089           MOVE ER-2393          TO WS-ERROR
 19090           PERFORM 9900-ERROR-FORMAT
 19091                                 THRU 9900-EXIT
 19092        END-IF
 19093     END-IF
 19094                                                                  ELC50PD
 19095     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 19096                                                                  ELC50PD
 19097     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 19098        ERPNDM-FOUND = ' ')                                       ELC50PD
 19099        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 19100           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 19101           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 19102          OR                                                      ELC50PD
 19103           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 19104          OR                                                      ELC50PD
 19105           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 19106           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 19107           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 19108                                                                  ELC50PD
 19109
 19110     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 19111        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 19112                                                                  ELC50PD
 19113     IF PM-INSURED-LAST-NAME      = SPACES
 19114        AND PM-INSURED-FIRST-NAME = SPACES
 19115        AND PM-ADDRESS-LINE-1     = SPACES
 19116        AND PM-ADDRESS-LINE-2     = SPACES
 19117        AND PM-CITY-STATE         = SPACES
 19118        AND PM-CRED-BENE-NAME     = SPACES
 19119        AND PM-CRED-BENE-ADDR     = SPACES
 19120        AND PM-CRED-BENE-CTYST    = SPACES
 19121        GO TO 3999-UNLOCK-ERMAIL
 19122     END-IF
 19123                                                                  ELC50PD
 19124     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 19125                                                                  ELC50PD
 19126     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 19127     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 19128     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 19129     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 19130     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 19131     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 19132     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 346
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19133     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 19134                                                                  ELC50PD
 19135     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 19136     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 19137                                                                  ELC50PD
 19138     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19139        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 19140     ELSE                                                         ELC50PD
 19141        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 19142        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 19143        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 19144                                                                  ELC50PD
 19145
 19146     GO TO 9990-RETURN.                                           ELC50PD
 19147                                                                  ELC50PD
 19148 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19149     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19150        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19151                                                                  ELC50PD
 19152     GO TO 9990-RETURN.                                           ELC50PD
 19153******************************************************************ELC50PD
 19154                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 347
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19156 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19157     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19158        GO TO 4299-EXIT.                                          ELC50PD
 19159                                                                  ELC50PD
 19160*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19161
 19162     IF PB-C-NH-INT-ON-REFS > ZEROS
 19163        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19164     END-IF
 19165     IF PB-C-REF-INTERFACE-SW = 'Y'
 19166        MOVE PB-C-REF-INTERFACE-SW
 19167                                 TO CM-NH-INTERFACE-SW
 19168     END-IF
 19169
 19170     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19171     IF ERMAIL-FOUND = 'X'
 19172        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19173        OR (MA-CITY        = SPACES OR LOW-VALUES)
 19174        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 19175        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 19176           MOVE ER-2694          TO WS-ERROR
 19177           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19178     END-IF
 19179
 19180     IF PB-C-POST-CARD-IND = 'Y'
 19181        MOVE +8                  TO SUB
 19182*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19183        IF ERMAIL-FOUND = ' '
 19184           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19185              (SUB > +7)
 19186              OR (MA-MAIL-STATUS (SUB) = '1')
 19187           END-PERFORM
 19188        END-IF
 19189        IF (SUB > +7)
 19190           OR (ERMAIL-FOUND = 'X')
 19191           MOVE ER-3789          TO WS-ERROR
 19192           PERFORM 9900-ERROR-FORMAT
 19193                                 THRU 9900-EXIT
 19194        END-IF
 19195     ELSE
 19196        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19197     END-IF
 19198
 19199     IF ERMAIL-FOUND = ' '
 19200        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 19201     END-IF.
 19202
 19203     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19204                                                                  ELC50PD
 19205     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19206        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19207                                                                  ELC50PD
 19208     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19209         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19210     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19211         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19212                                                                  ELC50PD
 19213 4100-APPLY-LF-CANCEL.                                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 348
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19214                                                                  ELC50PD
 19215     MOVE +0                     TO WS-SUB.                       ELC50PD
 19216                                                                  ELC50PD
 19217 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19218                                                                  ELC50PD
 19219     ADD +1                       TO WS-SUB.                      ELC50PD
 19220                                                                  ELC50PD
 19221     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19222        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19223           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19224        ELSE                                                      ELC50PD
 19225           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19226                                                                  ELC50PD
 19227     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19228                                   ER-2729 OR                     ELC50PD
 19229                                   ER-2730 OR                     ELC50PD
 19230                                   ER-2731 OR                     ELC50PD
 19231                                   ER-2732 OR                     ELC50PD
 19232                                   ER-2737 OR                     ELC50PD
 19233                                   ER-2740 OR                     ELC50PD
 19234                                   ER-2743 OR                     ELC50PD
 19235                                   ER-2749 OR                     ELC50PD
 19236                                   ER-2750 OR                     ELC50PD
 19237                                   ER-2755 OR                     ELC50PD
 19238                                   ER-2757 OR                     ELC50PD
 19239                                   ER-2760 OR                     ELC50PD
 19240                                   ER-2772 OR                     ELC50PD
 19241                                   ER-2774 OR                     ELC50PD
 19242                                   ER-2776 OR                     ELC50PD
 19243                                   ER-2794                        ELC50PD
 19244        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19245                                                                  ELC50PD
 19246     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19247                                                                  ELC50PD
 19248 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19249                                                                  ELC50PD
 19250     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19251     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19252     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19253        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19254     END-IF
 19255     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19256                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19257     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19258         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19259                                                                  ELC50PD
 19260     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19261         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19262                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19263                                                                  ELC50PD
 19264     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19265                                                                  ELC50PD
 19266 4100-LF-CANCEL-CONT.                                             ELC50PD
 19267     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19268         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19269                                                                  ELC50PD
 19270     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19271         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 349
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19272                                                                  ELC50PD
 19273     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19274        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19275           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19276        ELSE                                                      ELC50PD
 19277           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19278                                                                  ELC50PD
 19279     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19280     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19281                                                                  ELC50PD
 19282     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19283         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19284                                                                  ELC50PD
 19285     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 19286        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19287         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19288         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19289                                                                  ELC50PD
 19290     IF PB-RECORD-RETURNED                                        ELC50PD
 19291        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19292      ELSE                                                        ELC50PD
 19293        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19294                                                                  ELC50PD
 19295 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19296                                                                  ELC50PD
 19297     MOVE +0                      TO WS-SUB.                      ELC50PD
 19298                                                                  ELC50PD
 19299 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19300                                                                  ELC50PD
 19301     ADD +1                       TO WS-SUB.                      ELC50PD
 19302                                                                  ELC50PD
 19303     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19304        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19305           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19306        ELSE                                                      ELC50PD
 19307           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19308                                                                  ELC50PD
 19309     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19310                                   ER-2729 OR                     ELC50PD
 19311                                   ER-2732 OR                     ELC50PD
 19312                                   ER-2737 OR                     ELC50PD
 19313                                   ER-2740 OR                     ELC50PD
 19314                                   ER-2744 OR                     ELC50PD
 19315                                   ER-2749 OR                     ELC50PD
 19316                                   ER-2750 OR                     ELC50PD
 19317                                   ER-2755 OR                     ELC50PD
 19318                                   ER-2757 OR                     ELC50PD
 19319                                   ER-2760 OR                     ELC50PD
 19320                                   ER-2771 OR                     ELC50PD
 19321                                   ER-2772 OR                     ELC50PD
 19322                                   ER-2773 OR                     ELC50PD
 19323                                   ER-2775 OR                     ELC50PD
 19324                                   ER-2777 OR                     ELC50PD
 19325                                   ER-2794                        ELC50PD
 19326        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19327                                                                  ELC50PD
 19328     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19329                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 350
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19330 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19331                                                                  ELC50PD
 19332     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19333     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19334     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19335     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19336                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19337     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19338         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19339                                                                  ELC50PD
 19340     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19341         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19342                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19343                                                                  ELC50PD
 19344     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19345         IF PB-RECORD-RETURNED                                    ELC50PD
 19346              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19347          ELSE                                                    ELC50PD
 19348              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19349                                                                  ELC50PD
 19350     GO TO 4299-EXIT.                                             ELC50PD
 19351                                                                  ELC50PD
 19352 4100-AH-CANCEL-CONT.                                             ELC50PD
 19353     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19354         GO TO 4299-EXIT.                                         ELC50PD
 19355                                                                  ELC50PD
 19356     if cm-credit-interface-sw-2 = ' '
 19357        if pb-fatal-errors or pb-unforced-errors
 19358           move '4'              to cm-credit-interface-sw-2
 19359        else
 19360           move '1'              to cm-credit-interface-sw-2
 19361        end-if
 19362     end-if
 19363
 19364     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19365         GO TO 4299-EXIT.                                         ELC50PD
 19366                                                                  ELC50PD
 19367     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19368        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19369           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19370        ELSE                                                      ELC50PD
 19371           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19372                                                                  ELC50PD
 19373     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19374     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19375                                                                  ELC50PD
 19376     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19377         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19378                                                                  ELC50PD
 19379     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19380         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19381         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19382                                                                  ELC50PD
 19383     IF PB-RECORD-RETURNED                                        ELC50PD
 19384        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19385      ELSE                                                        ELC50PD
 19386        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19387                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 351
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19388     GO TO 4299-EXIT.                                             ELC50PD
 19389                                                                  ELC50PD
 19390 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19391     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19392                                                                  ELC50PD
 19393     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19394        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19395                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19396     ELSE                                                         ELC50PD
 19397        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19398                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19399                                                                  ELC50PD
 19400     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19401        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19402                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19403     ELSE                                                         ELC50PD
 19404        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19405                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19406                                                                  ELC50PD
 19407     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19408        NEXT SENTENCE                                             ELC50PD
 19409     ELSE                                                         ELC50PD
 19410        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19411                                                                  ELC50PD
 19412     GO TO 4299-EXIT.                                             ELC50PD
 19413                                                                  ELC50PD
 19414 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19415     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19416                                                                  ELC50PD
 19417     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19418        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19419        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19420        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19421                                                                  ELC50PD
 19422     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19423                                                                  ELC50PD
 19424     IF PB-RECORD-RETURNED                                        ELC50PD
 19425        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19426       ELSE                                                       ELC50PD
 19427        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19428                                                                  ELC50PD
 19429 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19430       EXIT.                                                      ELC50PD
 19431                                                                  ELC50PD
 19432 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19433     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19434                                                                  ELC50PD
 19435     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19436        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19437        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19438        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19439                                                                  ELC50PD
 19440     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19441                                                                  ELC50PD
 19442     IF PB-RECORD-RETURNED                                        ELC50PD
 19443        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19444       ELSE                                                       ELC50PD
 19445        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 352
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19446                                                                  ELC50PD
 19447 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19448       EXIT.                                                      ELC50PD
 19449                                                                  ELC50PD
 19450 4299-EXIT.                                                       ELC50PD
 19451       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 353
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19453                                                                  ELC50PD
 19454 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19455     IF CERT-WAS-FOUND                                            ELC50PD
 19456         NEXT SENTENCE                                            ELC50PD
 19457       ELSE                                                       ELC50PD
 19458         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19459                                                                  ELC50PD
 19460     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19461         GO TO 4999-EXIT.                                         ELC50PD
 19462                                                                  ELC50PD
 19463     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19464         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19465                                                                  ELC50PD
 19466     IF CERT-ADDED-BATCH                                          ELC50PD
 19467        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19468            GO TO 4999-EXIT.                                      ELC50PD
 19469                                                                  ELC50PD
 19470 4520-BUILD-NEW-KEY.                                              ELC50PD
 19471* BUILD CONTROL PRIMARY                                           ELC50PD
 19472                                                                  ELC50PD
 19473     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19474                                       CM-COMPANY-CD-A1           ELC50PD
 19475                                       CM-COMPANY-CD-A2           ELC50PD
 19476                                       CM-COMPANY-CD-A4           ELC50PD
 19477                                       CM-COMPANY-CD-A5.          ELC50PD
 19478                                                                  ELC50PD
 19479     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19480     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19481     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19482     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19483     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19484     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19485     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19486                                                                  ELC50PD
 19487     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19488                                                                  ELC50PD
 19489     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19490     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19491     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19492     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19493                                                                  ELC50PD
 19494     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19495        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19496                                                                  ELC50PD
 19497     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19498         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19499         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19500         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19501         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19502     ELSE                                                         ELC50PD
 19503         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19504                                                                  ELC50PD
 19505     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19506         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19507         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19508         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19509         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19510         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 354
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19511                                                                  ELC50PD
 19512     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19513        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19514         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19515                                                                  ELC50PD
 19516     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19517        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19518            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19519                                           PB-I-MEMBER-NO         ELC50PD
 19520            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19521                                                                  ELC50PD
 19522     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19523        NEXT SENTENCE                                             ELC50PD
 19524     ELSE                                                         ELC50PD
 19525        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19526                                                                  ELC50PD
 19527******************************************************************ELC50PD
 19528*                                                                *ELC50PD
 19529*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19530*    FOR 'MON'.                                                  *ELC50PD
 19531*                                                                *ELC50PD
 19532******************************************************************ELC50PD
 19533                                                                  ELC50PD
 19534     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19535     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19536     MOVE +1                     TO WS-SUB1                       ELC50PD
 19537                                    WS-SUB2.                      ELC50PD
 19538                                                                  ELC50PD
 19539 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19540                                                                  ELC50PD
 19541     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19542        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19543        ADD +1                       TO WS-SUB2.                  ELC50PD
 19544                                                                  ELC50PD
 19545     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19546        ADD +1                       TO WS-SUB1                   ELC50PD
 19547        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19548                                                                  ELC50PD
 19549     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19550     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19551     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19552*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19553     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19554     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19555     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19556                                                                  ELC50PD
 19557     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19558                                                                  ELC50PD
 19559******************************************************************ELC50PD
 19560*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19561******************************************************************ELC50PD
 19562                                                                  ELC50PD
 19563 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19564                                                                  ELC50PD
 19565     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19566         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19567         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19568         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 355
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19569         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19570     ELSE                                                         ELC50PD
 19571         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19572                                                                  ELC50PD
 19573     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19574        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19575         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19576                                                                  ELC50PD
 19577 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19578                                                                  ELC50PD
 19579*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19580*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19581*    ELSE                                                         ELC50PD
 19582*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19583                                                                  ELC50PD
 19584     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19585        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19586        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19587                                                                  ELC50PD
 19588     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19589        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19590        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19591                                                                  ELC50PD
 19592     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19593     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19594                                                                  ELC50PD
 19595     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19596        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19597        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19598     ELSE                                                         ELC50PD
 19599        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19600        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19601                                                                  ELC50PD
 19602     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19603     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19604     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19605     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19606     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19607     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19608     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19609                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19610                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19611                                      CM-AH-ITD-AH-PMT            ELC50PD
 19612                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19613                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19614                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19615                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19616*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19617*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19618     if pb-i-loan-apr = +99.9999
 19619        move zeros                 to cm-loan-apr
 19620     else
 19621        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 19622     end-if
 19623     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19624     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19625     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19626     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 356
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19627     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19628     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19629     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19630     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
 19631     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19632     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19633     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19634                                                                  ELC50PD
 19635     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19636         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19637                                                                  ELC50PD
 19638     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19639         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19640                                                                  ELC50PD
 19641     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19642     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19643                                                                  ELC50PD
 19644     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19645         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19646         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19647                                                                  ELC50PD
 19648     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19649     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19650     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19651     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19652     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19653     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19654                                                                  ELC50PD
 19655     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19656        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19657     ELSE                                                         ELC50PD
 19658        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19659                                                                  ELC50PD
 19660     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19661        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19662        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19663     ELSE                                                         ELC50PD
 19664        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19665                                                                  ELC50PD
 19666     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19667     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19668     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19669     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19670     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19671     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19672     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19673     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19674     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19675                                                                  ELC50PD
 19676     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19677        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19678     ELSE                                                         ELC50PD
 19679        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19680                                                                  ELC50PD
 19681     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19682        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19683     ELSE                                                         ELC50PD
 19684        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 357
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19685                                                                  ELC50PD
 19686     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19687     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19688                                                                  ELC50PD
 19689     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19690                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19691                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19692                                                                  ELC50PD
 19693*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19694*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19695*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19696*                       'NCL'                                     ELC50PD
 19697     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19698                                                                  ELC50PD
 19699     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19700         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19701            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19702                                                                  ELC50PD
 19703     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19704         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19705            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19706                                                                  ELC50PD
 19707     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19708         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19709     ELSE                                                         ELC50PD
 19710         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19711         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19712                                                                  ELC50PD
 19713     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19714     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19715     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19716     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19717     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19718     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19719     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19720     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19721                                                                  ELC50PD
 19722     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19723         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19724     ELSE                                                         ELC50PD
 19725         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19726                                                                  ELC50PD
 19727     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19728     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19729                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19730                                                                  ELC50PD
 19731     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19732     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19733                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19734                                                                  ELC50PD
 19735     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19736                                                                  ELC50PD
 19737     IF PB-REISSUED-CERT                                          ELC50PD
 19738        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19739                                                                  ELC50PD
 19740     IF PB-MONTHLY-CERT                                           ELC50PD
 19741        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19742                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 358
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19743     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19744     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19745     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19746        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
 19747                                                                  ELC50PD
 19748     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19749        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19750                                                                  ELC50PD
 19751     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19752        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19753                                                                  ELC50PD
 19754     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19755        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19756                                                                  ELC50PD
 19757     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19758         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19759     ELSE                                                         ELC50PD
 19760         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19761                                                                  ELC50PD
 19762     IF PB-RECORD-RETURNED                                        ELC50PD
 19763        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19764      ELSE                                                        ELC50PD
 19765        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19766                                                                  ELC50PD
 19767     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19768        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19769                                                                  ELC50PD
 19770     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19771                                       CM-ENTRY-DT.               ELC50PD
 19772                                                                  ELC50PD
 19773 4999-EXIT.                                                       ELC50PD
 19774     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 359
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19776                                                                  ELC50PD
 19777 5000-PROCESS-REPS.
 19778
 19779     MOVE ' '                    TO AGTC-MASTER-SW
 19780     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19781     MOVE CO-TYPE                TO AGTC-TYPE
 19782     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19783     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19784
 19785     IF (AGTC-MASTER-SW NOT = 'N')
 19786        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19787        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19788        PERFORM 8583-READ-ERAGTC-NEXT
 19789                                 THRU 8583-EXIT
 19790     END-IF
 19791
 19792     IF AGTC-MASTER-SW = 'N'
 19793        CONTINUE
 19794     ELSE
 19795        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19796           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19797              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19798              MOVE 'Y'           TO AGTC-MASTER-SW
 19799           END-IF
 19800        END-IF
 19801     END-IF
 19802
 19803     .
 19804 5000-EXIT.
 19805     EXIT.
 19806
 19807
 19808 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19809     move ' ' to ws-benefit-cd-chg-sw
 19810     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19811        MOVE +1                  TO SUB                           ELC50PD
 19812        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19813        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19814        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19815        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19816        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19817                                                                  ELC50PD
 19818     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19819                                                                  ELC50PD
 19820     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19821     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19822*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19823     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19824     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19825     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19826     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19827                                                                  ELC50PD
 19828     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19829        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19830        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19831                                                                  ELC50PD
 19832     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19833     MOVE +1                     TO SUB.                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 360
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19834                                                                  ELC50PD
 19835 6370-SEARCH-LOOP.                                                ELC50PD
 19836     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19837         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19838                                                                  ELC50PD
 19839     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19840        if (pb-i-lf-benefit-cd not = zeros and spaces)
 19841           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 19842           set benefit-code-chg to true
 19843        end-if
 19844        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 19845        GO TO 6370-HER-NET-PAY-CHECK.
 19846                                                                  ELC50PD
 19847     ADD 1   TO SUB.                                              ELC50PD
 19848*    IF SUB GREATER 120                                           ELC50PD
 19849     IF SUB GREATER 200                                           ELC50PD
 19850         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19851                                                                  ELC50PD
 19852     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19853                                                                  ELC50PD
 19854 6370-NO-LF-FOUND.                                                ELC50PD
 19855                                                                  ELC50PD
 19856     if (pb-i-lf-benefit-cd not = zeros and spaces)
 19857        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 19858        set benefit-code-chg to true
 19859     end-if
 19860     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19861                                                                  ELC50PD
 19862 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19863                                                                  ELC50PD
 19864     IF PB-COMPANY-ID = 'CID'
 19865        IF PB-SV-STATE = 'CA' OR 'MN'
 19866           IF PB-I-LF-BENEFIT-CD = '02'
 19867              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19868           ELSE
 19869              IF PB-I-LF-BENEFIT-CD = '04'
 19870                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19871              END-IF
 19872           END-IF
 19873        END-IF
 19874     END-IF
 19875
 19876     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19877         GO TO 6370-EXIT.                                         ELC50PD
 19878                                                                  ELC50PD
 19879     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19880         GO TO 6370-EXIT.                                         ELC50PD
 19881                                                                  ELC50PD
 19882     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19883         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19884                                                                  ELC50PD
 19885     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19886         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19887                                                                  ELC50PD
 19888     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19889         GO TO 6370-EXIT.                                         ELC50PD
 19890                                                                  ELC50PD
 19891     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 361
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19892         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19893                                                                  ELC50PD
 19894     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19895         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19896                                                                  ELC50PD
 19897 6370-EXIT.                                                       ELC50PD
 19898     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 362
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19900                                                                  ELC50PD
 19901 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19902     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19903        MOVE +1                  TO SUB                           ELC50PD
 19904        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19905        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19906        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19907        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19908        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19909                                                                  ELC50PD
 19910     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19911                                                                  ELC50PD
 19912     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19913     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19914     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19915*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19916     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19917     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19918     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19919                                                                  ELC50PD
 19920     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19921        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19922        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19923                                                                  ELC50PD
 19924     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19925     MOVE +1 TO SUB.                                              ELC50PD
 19926                                                                  ELC50PD
 19927 6380-SEARCH-LOOP.                                                ELC50PD
 19928     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19929         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19930                                                                  ELC50PD
 19931     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19932         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19933         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19934                                                                  ELC50PD
 19935     ADD 1   TO SUB.                                              ELC50PD
 19936     IF SUB GREATER THAN 96                                       ELC50PD
 19937*    IF SUB GREATER THAN 300                                      ELC50PD
 19938         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19939                                                                  ELC50PD
 19940     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19941                                                                  ELC50PD
 19942 6380-NO-AH-FOUND.                                                ELC50PD
 19943                                                                  ELC50PD
 19944     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19945                                                                  ELC50PD
 19946     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19947         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19948     ELSE                                                         ELC50PD
 19949         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19950                                                                  ELC50PD
 19951 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19952                                                                  ELC50PD
 19953     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19954        NEXT SENTENCE                                             ELC50PD
 19955      ELSE                                                        ELC50PD
 19956        GO TO 6380-EXIT.                                          ELC50PD
 19957                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 363
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19958     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19959         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19960                                                                  ELC50PD
 19961                                                                  00041198
 19962     GO TO 6380-EXIT                                              00041198
 19963     .
 19964 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19965                                                                  00041203
 19966                                                                  ELC50PD
 19967     .                                                            ELC50PD
 19968 6380-EXIT.                                                       ELC50PD
 19969     EXIT.                                                        ELC50PD
 19970                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 364
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19972                                                                  ELC50PD
 19973 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19974                                                                  ELC50PD
 19975******************************************************************ELC50PD
 19976*                                                                *ELC50PD
 19977*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19978*                                                                *ELC50PD
 19979*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19980*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19981*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19982*    THE EXTENSION DAYS.                                         *ELC50PD
 19983*                                                                *ELC50PD
 19984******************************************************************ELC50PD
 19985                                                                  ELC50PD
 19986     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19987     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19988                                                                  ELC50PD
 19989******************************************************************ELC50PD
 19990*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19991*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19992******************************************************************ELC50PD
 19993                                                                  ELC50PD
 19994     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19995        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19996               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19997     ELSE                                                         ELC50PD
 19998        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19999                                                                  ELC50PD
 20000     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 20001           GO TO 6499-EXIT                                        ELC50PD
 20002     ELSE                                                         ELC50PD
 20003        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 20004           IF WS-WDF-MONTH = 02                                   ELC50PD
 20005              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 20006              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 20007              GO TO 6499-EXIT                                     ELC50PD
 20008           ELSE                                                   ELC50PD
 20009              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 20010                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 20011                 GO TO 6499-EXIT                                  ELC50PD
 20012               ELSE                                               ELC50PD
 20013                 GO TO 6499-EXIT                                  ELC50PD
 20014        ELSE                                                      ELC50PD
 20015           GO TO 6499-EXIT.                                       ELC50PD
 20016                                                                  ELC50PD
 20017 6412-CHECK-TO-DAY.                                               ELC50PD
 20018                                                                  ELC50PD
 20019        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 20020           IF WS-WDT-DAY = 28                                     ELC50PD
 20021              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 20022           ELSE                                                   ELC50PD
 20023              IF WS-WDT-DAY = 29                                  ELC50PD
 20024                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 20025              ELSE                                                ELC50PD
 20026                 NEXT SENTENCE                                    ELC50PD
 20027        ELSE                                                      ELC50PD
 20028           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 20029              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 365
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 20030                                                                  ELC50PD
 20031     GO TO 6499-EXIT.                                             ELC50PD
 20032                                                                  ELC50PD
 20033                                                                  ELC50PD
 20034 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 20035                                                                  ELC50PD
 20036     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 20037        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 20038                                                                  ELC50PD
 20039 6415-EXIT.                                                       ELC50PD
 20040     EXIT.                                                        ELC50PD
 20041                                                                  ELC50PD
 20042 6499-EXIT.                                                       ELC50PD
 20043      EXIT.                                                       ELC50PD
 20044                                                                  ELC50PD
 20045 6500-END.                                                        ELC50PD
 20046     EXIT.
 20047
 20048                                                                  ELC50PD
 20049******************************************************************ELC50PD
 20050************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 20051********************** ELC50PD END *******************************ELC50PD
 20052                                                                  ELC50PD
 20053*
 20054*
 20055**START***********************************************************
 20056*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20057*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 20058******************************************************************
 20059*
 20060 6600-GET-STATE-MUNICIPAL-TAX.
 20061
 20062     IF PB-COMPANY-ID NOT = 'DMD'
 20063         GO TO 6640-EXIT.
 20064
 20065     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 20066     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 20067     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 20068
 20069*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20070     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20071     MOVE SPACES TO DC-ALPHA-CENTURY.
 20072     SET BIN-TO-GREG          TO TRUE.
 20073     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20074
 20075     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20076     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20077
 20078     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 20079     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 20080                                 WS-SAVE-ERRESS-KEY.
 20081
 20082*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 20083*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 20084
 20085     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 20086
 20087     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 366
* EL517.cbl
 20088         MOVE ER-8002        TO WS-ERROR
 20089         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20090         GO TO 6640-EXIT.
 20091
 20092*GET RECORD WHERE POSITIONED
 20093
 20094 6600-READ-ERRESS-NEXT.
 20095     READ ERRESS NEXT RECORD.
 20096
 20097     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 20098         MOVE ER-8002        TO WS-ERROR
 20099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20100         GO TO 6640-EXIT.
 20101
 20102*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 20103
 20104     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 20105        NEXT SENTENCE
 20106     ELSE
 20107        MOVE ER-8002        TO WS-ERROR
 20108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20109        GO TO 6640-EXIT.
 20110
 20111     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 20112        NEXT SENTENCE
 20113     ELSE
 20114        GO TO 6600-READ-ERRESS-NEXT.
 20115
 20116*IS IT LIFE(1) OR IS IT P&C(2) ?????
 20117*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 20118
 20119     MOVE +2                     TO WS-SUB1.
 20120
 20121     IF PB-CANCELLATION
 20122        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 20123           MOVE +1               TO WS-SUB1.
 20124
 20125     IF PB-ISSUE
 20126        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 20127           MOVE +1               TO WS-SUB1.
 20128
 20129*
 20130*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 20131*
 20132     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 20133     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 20134     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 20135     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 20136
 20137
 20138*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 20139*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 20140*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 20141
 20142     ADD 1                    TO WS-YEAR-YY.
 20143
 20144     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 20145         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 367
* EL517.cbl
 20146                              TO WS-RES-STATE-TAX
 20147         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 20148                              TO WS-RES-MUNI-TAX
 20149     ELSE
 20150         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 20151                              TO WS-RES-STATE-TAX
 20152         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 20153                              TO WS-RES-MUNI-TAX.
 20154
 20155*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 20156
 20157     IF PB-CANCELLATION
 20158         GO TO 6640-CANCEL-TAX.
 20159
 20160     IF PB-I-LF-PREMIUM-AMT > ZEROS
 20161          COMPUTE PB-I-STATE-TAX ROUNDED =
 20162                                    PB-I-LF-PREMIUM-AMT
 20163                                  * WS-RES-STATE-TAX
 20164          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20165                                    PB-I-LF-PREMIUM-AMT
 20166                                  * WS-RES-MUNI-TAX
 20167     ELSE
 20168     IF PB-I-AH-PREMIUM-AMT > ZEROS
 20169          COMPUTE PB-I-STATE-TAX ROUNDED =
 20170                                    PB-I-AH-PREMIUM-AMT
 20171                                  * WS-RES-STATE-TAX
 20172          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20173                                    PB-I-AH-PREMIUM-AMT
 20174                                  * WS-RES-MUNI-TAX.
 20175
 20176     GO TO 6640-EXIT.
 20177
 20178 6640-CANCEL-TAX.
 20179     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 20180
 20181     IF PB-C-LF-CANCEL-AMT > ZEROS
 20182          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20183                                    PB-C-LF-CANCEL-AMT
 20184                                  * WS-RES-STATE-TAX
 20185          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20186                                    PB-C-LF-CANCEL-AMT
 20187                                  * WS-RES-MUNI-TAX
 20188     ELSE
 20189     IF PB-C-AH-CANCEL-AMT > ZEROS
 20190          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20191                                    PB-C-AH-CANCEL-AMT
 20192                                  * WS-RES-STATE-TAX
 20193          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20194                                    PB-C-AH-CANCEL-AMT
 20195                                  * WS-RES-MUNI-TAX.
 20196
 20197 6640-EXIT.
 20198     EXIT.
 20199
 20200 6650-GET-RES-STATE-COMM.
 20201
 20202     IF PB-COMPANY-ID NOT = 'DMD'
 20203         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 368
* EL517.cbl
 20204
 20205     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20206     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20207     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20208     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20209     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20210     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20211     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20212
 20213*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20214
 20215     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20216     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20217     SET BIN-TO-GREG          TO TRUE.
 20218     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20219
 20220     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20221     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20222
 20223     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20224
 20225*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20226*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20227*VALUE OF PB-CERT-EFF-DT
 20228
 20229     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20230     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20231
 20232     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20233         GO TO 6700-COMM-EXIT.
 20234
 20235*GET RECORD WHERE POSITIONED
 20236
 20237 6650-READ-ERRESC-NEXT.
 20238     READ ERRESC NEXT RECORD.
 20239
 20240     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20241         GO TO 6700-COMM-EXIT.
 20242
 20243     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20244        NEXT SENTENCE
 20245     ELSE
 20246         GO TO 6700-COMM-EXIT.
 20247
 20248     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20249         NEXT SENTENCE
 20250       ELSE
 20251         GO TO 6650-READ-ERRESC-NEXT.
 20252
 20253*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20254*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20255
 20256     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20257         GO TO 6700-COMM-EXIT.
 20258
 20259* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20260
 20261     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 369
* EL517.cbl
 20262
 20263     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20264
 20265     IF WS-SUB1 > ZERO
 20266         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20267             PERFORM 6680-SET-COMMISSION
 20268         ELSE
 20269             PERFORM 6680-SET-TABLE-CODE.
 20270
 20271     GO TO 6700-COMM-EXIT.
 20272
 20273 6680-SET-TABLE-CODE.
 20274     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20275        MOVE ZEROS             TO WS-SUB1
 20276     ELSE
 20277* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20278* TO COMPUTE AH COMMISSION.
 20279        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20280        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20281        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20282        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20283        PERFORM 6680-READ-CTBL-TABLE
 20284        IF ERCTBL-FILE-STATUS NOT = '00'
 20285           MOVE ZEROS          TO WS-SUB1.
 20286
 20287 6680-READ-CTBL-TABLE.
 20288*
 20289* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20290* TO COMPUTE LIFE COMMISSION
 20291
 20292     IF CTBL-SW = '0540'
 20293        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20294        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20295        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20296
 20297     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20298
 20299     IF CTBL-TABLE-FOUND
 20300        IF CTBL-SW = '0530'
 20301             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20302                                        PB-I-AH-TERM
 20303             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20304             MOVE WS-WK-RATE        TO WS-COMMISSION
 20305                                       PB-I-AH-COMMISSION
 20306        ELSE
 20307             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20308             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20309             MOVE WS-WK-RATE        TO WS-COMMISSION
 20310                                       PB-I-LIFE-COMMISSION
 20311     ELSE
 20312        IF FIRST-TIME-THROUGH
 20313            GO TO 6680-READ-CTBL-TABLE
 20314        ELSE
 20315            MOVE ZEROS         TO WS-SUB1.
 20316
 20317 6680-SET-COMMISSION.
 20318     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20319           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 370
* EL517.cbl
 20320       ELSE
 20321           MOVE RESC-COMMISSION-PER (WS-SUB)
 20322                             TO WS-COMMISSION
 20323           IF CTBL-SW = '0540'
 20324               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20325           ELSE
 20326               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20327
 20328 6680-SEARCH-CATEGORY.
 20329     ADD +1                   TO WS-SUB.
 20330     IF WS-SUB > +12
 20331         GO TO 6680-EXIT.
 20332
 20333     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20334          MOVE WS-SUB         TO WS-SUB1
 20335          GO TO 6680-EXIT.
 20336
 20337     GO TO 6680-SEARCH-CATEGORY.
 20338
 20339 6680-EXIT.
 20340     EXIT.
 20341
 20342 6700-COMM-EXIT.
 20343     EXIT.
 20344**END*************************************************************
 20345*      CUSTOM CODING FOR CLIENT "DMD"
 20346******************************************************************
 20347*
 20348 7000-GET-RATE.
 20349     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20350
 20351 7000-EXIT.
 20352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 371
* EL517.cbl
 20354
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 372
* EL517.cbl
 20356 7100-FIND-BENEFIT-IN-STATE.
 20357     MOVE 'N'                    TO BEN-SEARCH-SW.
 20358
 20359     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20360         VARYING SUB3 FROM 1 BY 1 UNTIL
 20361            ((SUB3 GREATER 50) OR
 20362              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20363               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20364
 20365     IF SUB3 NOT = 51
 20366         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20367             MOVE 'Y'            TO BEN-SEARCH-SW.
 20368
 20369     GO TO 7199-EXIT.
 20370
 20371 7100-BENEFIT-DUMMY.
 20372
 20373 7100-DUMMY-EXIT.
 20374     EXIT.
 20375
 20376 7199-EXIT.
 20377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 373
* EL517.cbl
 20379 7200-FIND-BENEFIT.
 20380     MOVE 'N'                    TO BEN-SEARCH-SW.
 20381
 20382     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20383         VARYING SUB3 FROM 1 BY 1 UNTIL
 20384            ((SUB3 GREATER 8) OR
 20385            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20386
 20387     IF SUB3 NOT = 9
 20388         MOVE 'Y'                TO BEN-SEARCH-SW.
 20389
 20390     GO TO 7200-EXIT.
 20391
 20392 7200-BENEFIT-DUMMY.
 20393
 20394     EXIT.
 20395 7200-DUMMY-EXIT.
 20396     EXIT.
 20397
 20398 7200-EXIT.
 20399     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 374
* EL517.cbl
 20401 7250-LOOK-FOR-RESCINDED-CLAIM.
 20402
 20403     IF ELMSTR-OPEN = ' '
 20404         OPEN INPUT ELMSTR
 20405         MOVE 'X'                TO ELMSTR-OPEN
 20406         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20407             NEXT SENTENCE
 20408         ELSE
 20409             MOVE ELMSTR-FILE-STATUS
 20410                                 TO WS-ABEND-FILE-STATUS
 20411             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20412             MOVE EMSG           TO WS-ABEND-MESSAGE
 20413             GO TO ABEND-PGM.
 20414
 20415     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20416                                    W-CL-COMP-CD.
 20417     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20418                                    W-CL-CERT-NO.
 20419     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20420     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20421
 20422     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20423
 20424     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20425         GO TO 7250-EXIT.
 20426
 20427     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20428         GO TO 7250-CLAIMS-ERROR.
 20429
 20430 7250-NEXT-CLAIM.
 20431
 20432     READ ELMSTR NEXT.
 20433
 20434     IF ELMSTR-FILE-STATUS = '10'
 20435         GO TO 7250-EXIT.
 20436
 20437     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20438         GO TO 7250-CLAIMS-ERROR.
 20439
 20440     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20441        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20442         GO TO 7250-EXIT.
 20443
 20444     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20445        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20446        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20447        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20448        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20449         GO TO 7250-NEXT-CLAIM.
 20450
 20451     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20452        OR (CL-CLAIM-TYPE = 'I')
 20453        OR (CL-CLAIM-TYPE = 'G')
 20454          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20455              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20456              GO TO 7250-EXIT
 20457          END-IF
 20458     END-IF.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 375
* EL517.cbl
 20459
 20460     GO TO 7250-NEXT-CLAIM.
 20461
 20462 7250-CLAIMS-ERROR.
 20463
 20464     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20465     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20466     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20467     GO TO ABEND-PGM.
 20468
 20469 7250-EXIT.
 20470     EXIT.
 20471 7300-CHECK-FOR-OPEN-CLMS.
 20472
 20473     IF ELMSTR-OPEN = ' '
 20474         OPEN INPUT ELMSTR
 20475         MOVE 'X'                TO ELMSTR-OPEN
 20476         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20477             NEXT SENTENCE
 20478         ELSE
 20479             MOVE ELMSTR-FILE-STATUS
 20480                                 TO WS-ABEND-FILE-STATUS
 20481             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20482             MOVE EMSG           TO WS-ABEND-MESSAGE
 20483             GO TO ABEND-PGM.
 20484
 20485     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20486                                    W-CL-COMP-CD.
 20487     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20488                                    W-CL-CERT-NO.
 20489     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20490     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20491
 20492     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20493
 20494     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20495         GO TO 7300-EXIT.
 20496
 20497     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20498         GO TO 7300-CLAIMS-ERROR.
 20499
 20500     MOVE 'Y'                    TO W-BROWSE-SW.
 20501
 20502 7300-NEXT-CLAIM.
 20503
 20504     READ ELMSTR NEXT.
 20505
 20506     IF ELMSTR-FILE-STATUS = '10'
 20507         GO TO 7300-EXIT.
 20508
 20509     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20510         GO TO 7300-CLAIMS-ERROR.
 20511
 20512     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20513        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20514         GO TO 7300-EXIT.
 20515
 20516     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 376
* EL517.cbl
 20517        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20518        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20519        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20520        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20521         GO TO 7300-NEXT-CLAIM.
 20522
 20523     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20524        OR 'I' OR 'G'
 20525        IF CLAIM-IS-OPEN
 20526           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20527             AND PB-C-AH-CANCEL-DT > SPACES
 20528              MOVE ER-2896        TO WS-ERROR
 20529              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20530           END-IF
 20531           EVALUATE TRUE
 20532             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20533                 MOVE ER-2884      TO WS-ERROR
 20534             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20535                 MOVE ER-2887      TO WS-ERROR
 20536             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20537                 MOVE ER-2886      TO WS-ERROR
 20538             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20539                 MOVE ER-2888      TO WS-ERROR
 20540             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20541                 MOVE ER-2885      TO WS-ERROR
 20542             WHEN OTHER
 20543                 MOVE ER-2768      TO WS-ERROR
 20544           END-EVALUATE
 20545           IF PB-C-AH-CANCEL-VOIDED OR
 20546              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20547                NOT AH-COVERAGE-CANCELLED)
 20548               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20549               MOVE ER-2768      TO WS-ERROR
 20550           END-IF
 20551           PERFORM 9900-ERROR-FORMAT
 20552                                 THRU 9900-EXIT
 20553           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20554              PB-FORCE-CODE NOT EQUAL '8'
 20555               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20556           END-IF
 20557           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20558           GO TO 7300-NEXT-CLAIM
 20559        ELSE
 20560           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20561*****THIS IS A RESCISSION OR REFORMATION
 20562              IF (AH-COVERAGE-CANCELLED AND
 20563                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20564                    MOVE ER-2890 TO WS-ERROR
 20565                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20566                    GO TO 7300-NEXT-CLAIM
 20567              END-IF
 20568           ELSE
 20569              IF CL-DENIAL-TYPE = '1'  AND
 20570                 CL-TOTAL-PAID-AMT = 0
 20571                    GO TO 7300-NEXT-CLAIM
 20572              END-IF
 20573              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20574               AND PB-C-AH-CANCEL-DT > SPACES
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 377
* EL517.cbl
 20575                 MOVE ER-2756       TO WS-ERROR
 20576                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20577                 GO TO 7300-NEXT-CLAIM
 20578              END-IF
 20579           END-IF
 20580        END-IF
 20581     ELSE
 20582        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20583           IF CLAIM-IS-OPEN
 20584              MOVE ER-2889    TO WS-ERROR
 20585              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20586              GO TO 7300-NEXT-CLAIM
 20587           ELSE
 20588              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20589*****THIS IS A RESCISSION OR REFORMATION
 20590                 IF (LF-COVERAGE-CANCELLED AND
 20591                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20592                       MOVE ER-2890 TO WS-ERROR
 20593                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20594                       GO TO 7300-NEXT-CLAIM
 20595                 END-IF
 20596              ELSE
 20597                 IF CL-DENIAL-TYPE = '1'  AND
 20598                    CL-TOTAL-PAID-AMT = 0
 20599                       GO TO 7300-NEXT-CLAIM
 20600                 END-IF
 20601                 IF (AH-COVERAGE-CANCELLED AND
 20602                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20603                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20604                    (LF-COVERAGE-CANCELLED AND
 20605                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20606                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20607                       MOVE ER-2965 TO WS-ERROR
 20608                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20609                       GO TO 7300-NEXT-CLAIM
 20610                 END-IF
 20611                 IF LF-COVERAGE-CANCELLED
 20612                  IF CL-TOTAL-PAID-AMT > 0
 20613                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20614                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20615                        MOVE ER-2891 TO WS-ERROR
 20616                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20617                        GO TO 7300-NEXT-CLAIM
 20618                      END-IF
 20619                    ELSE
 20620****only show this error if cert num matches exactly
 20621                      IF PB-CERT-NO = CL-CERT-NO
 20622                         MOVE ER-2892 TO WS-ERROR
 20623                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20624                         GO TO 7300-NEXT-CLAIM
 20625                      END-IF
 20626                    END-IF
 20627                  END-IF
 20628                 END-IF
 20629              END-IF
 20630           END-IF
 20631        END-IF
 20632     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 378
* EL517.cbl
 20633
 20634     GO TO 7300-NEXT-CLAIM.
 20635
 20636 7300-CLAIMS-ERROR.
 20637
 20638     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20639     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20640     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20641     GO TO ABEND-PGM.
 20642
 20643 7300-EXIT.
 20644     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 379
* EL517.cbl
 20646
 20647 7400-GET-REMAIN-TERM.
 20648     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20649
 20650 7400-EXIT.
 20651     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 380
* EL517.cbl
 20653
 20654 7500-GET-REMAIN-AMOUNT.
 20655     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20656
 20657 7500-EXIT.
 20658     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 381
* EL517.cbl
 20660
 20661 7600-GET-REFUND.
 20662     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20663
 20664 7600-EXIT.
 20665     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 382
* EL517.cbl
 20667
 20668 7700-CALL-DL1.
 20669     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20670     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20671
 20672 7700-EXIT.
 20673     EXIT.
 20674
 20675 7710-CALL-DL2.
 20676     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20677     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20678
 20679 7710-EXIT.
 20680     EXIT.
 20681
 20682 7720-CALL-DL3.
 20683     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20684     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20685
 20686 7720-EXIT.
 20687     EXIT.
 20688
 20689 7730-CALL-DL7.
 20690     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20691     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20692
 20693 7730-EXIT.
 20694     EXIT.
 20695
 20696 7740-CALL-DL11.
 20697     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20698     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20699
 20700 7740-EXIT.
 20701     EXIT.
 20702
 20703 7750-CALL-DL17.
 20704     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20705     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20706
 20707 7750-EXIT.
 20708     EXIT.
 20709
 20710 7755-CALL-DL19.
 20711     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20712     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20713
 20714 7755-EXIT.
 20715     EXIT.
 20716
 20717 7760-CALL-DL21.
 20718     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20719
 20720 7760-EXIT.
 20721     EXIT.
 20722
 20723 7770-CALL-DL22.
 20724     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 383
* EL517.cbl
 20725     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20726
 20727 7770-EXIT.
 20728     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 384
* EL517.cbl
 20730
 20731 7800-REWRITE-CERT.
 20732     REWRITE CERTIFICATE-MASTER.
 20733     ADD 1 TO WCER.
 20734
 20735 7800-EXIT.
 20736      EXIT.
 20737     EXIT.
 20738
 20739 8000-WRITE-CERT.
 20740
 20741     WRITE CERTIFICATE-MASTER.
 20742     ADD 1 TO WCER.
 20743     IF ELCERT-FILE-STATUS NOT = '00'
 20744         GO TO 8000-FREE-MAIN.
 20745
 20746 8000-FREE-MAIN.
 20747
 20748 8000-EXIT.
 20749     EXIT.
 20750      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 385
* EL517.cbl
 20752
 20753 8100-READ-ERPNDM.
 20754     IF ERPNDM-OPEN = ' '
 20755        OPEN INPUT ERPNDM
 20756        MOVE 'X' TO ERPNDM-OPEN
 20757        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20758           NEXT SENTENCE
 20759        ELSE
 20760           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20761           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20762           MOVE EMSG TO WS-ABEND-MESSAGE
 20763           GO TO ABEND-PGM.
 20764
 20765     MOVE SPACES                 TO ERPNDM-FOUND.
 20766     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20767     READ ERPNDM.
 20768
 20769     IF ERPNDM-FILE-STATUS  = '00'
 20770        CONTINUE
 20771     ELSE
 20772        MOVE 'X'                 TO ERPNDM-FOUND
 20773        MOVE ER-2694             TO WS-ERROR
 20774        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20775        MOVE ER-2883             TO WS-ERROR
 20776        PERFORM 9900-ERROR-FORMAT
 20777                                 THRU 9900-EXIT
 20778     END-IF
 20779
 20780     .
 20781 8100-EXIT.
 20782     EXIT.
 20783
 20784 8110-READ-ERMAIL.
 20785     IF ERMAIL-OPEN = ' '
 20786        OPEN  I-O ERMAIL
 20787        MOVE 'X' TO ERMAIL-OPEN
 20788        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20789           NEXT SENTENCE
 20790        ELSE
 20791            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20792            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20793            MOVE EMSG TO WS-ABEND-MESSAGE
 20794            GO TO ABEND-PGM.
 20795
 20796     MOVE SPACES                 TO ERMAIL-FOUND.
 20797     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20798     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20799     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20800     MOVE PB-SV-STATE            TO MA-STATE.
 20801
 20802     READ ERMAIL.
 20803
 20804     IF ERMAIL-FILE-STATUS  = '00'
 20805         NEXT SENTENCE
 20806       ELSE
 20807        MOVE 'X'                 TO ERMAIL-FOUND.
 20808
 20809 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 386
* EL517.cbl
 20810     EXIT.
 20811
 20812 8120-REWRITE-ERMAIL.
 20813     REWRITE MAILING-DATA.
 20814
 20815 8120-EXIT.
 20816     EXIT.
 20817
 20818 8130-WRITE-ERMAIL.
 20819     WRITE MAILING-DATA.
 20820
 20821 8130-EXIT.
 20822     EXIT.
 20823
 20824 8140-UNLOCK-ERMAIL.
 20825     MOVE SPACES                 TO ERMAIL-FOUND.
 20826
 20827 8140-EXIT.
 20828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 387
* EL517.cbl
 20830
 20831 8150-read-elcrtt.
 20832
 20833     IF ELCRTT-OPEN = ' '
 20834         OPEN input ELCRTT
 20835         MOVE 'X' TO ELCRTT-OPEN
 20836         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20837             continue
 20838         ELSE
 20839             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20840             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20841             MOVE EMSG               TO WS-ABEND-MESSAGE
 20842             GO TO ABEND-PGM
 20843         END-IF
 20844     END-IF
 20845
 20846     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20847     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20848     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20849
 20850     READ ELCRTT.
 20851
 20852     IF ELCRTT-FILE-STATUS  = '00'
 20853        move cs-ins-age-default-flag
 20854                                 to ws-ins-age-defaulted
 20855        move cs-jnt-age-default-flag
 20856                                 to ws-jnt-age-defaulted
 20857     END-IF
 20858
 20859     .
 20860 8150-exit.
 20861     exit.
 20862
 20863 8180-UPDATE-VIN-NUMBER.
 20864
 20865     IF ELCRTT-OPEN = ' '
 20866         OPEN I-O ELCRTT
 20867         MOVE 'X' TO ELCRTT-OPEN
 20868         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20869             NEXT SENTENCE
 20870         ELSE
 20871             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20872             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20873             MOVE EMSG               TO WS-ABEND-MESSAGE
 20874             GO TO ABEND-PGM
 20875         END-IF
 20876     END-IF.
 20877
 20878     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20879     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20880     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20881
 20882     READ ELCRTT.
 20883
 20884     IF ELCRTT-FILE-STATUS  = '00'
 20885        CONTINUE
 20886     ELSE
 20887        GO TO 8180-NOTFND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 388
* EL517.cbl
 20888     END-IF.
 20889
 20890     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20891         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20892         REWRITE CERTIFICATE-TRAILERS
 20893     END-IF.
 20894
 20895     GO TO 8180-EXIT.
 20896
 20897 8180-NOTFND.
 20898
 20899     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20900     MOVE 'CS'         TO CS-RECORD-ID.
 20901     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20902     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20903     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20904     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20905     WRITE CERTIFICATE-TRAILERS.
 20906
 20907 8180-EXIT.
 20908     EXIT.
 20909
 20910 8190-UPDATE-REFUND-CLAIM-FLAG.
 20911
 20912     IF ELCRTT-OPEN = ' '
 20913         OPEN I-O ELCRTT
 20914         MOVE 'X' TO ELCRTT-OPEN
 20915         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20916             NEXT SENTENCE
 20917         ELSE
 20918             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20919             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20920             MOVE EMSG               TO WS-ABEND-MESSAGE
 20921             GO TO ABEND-PGM
 20922         END-IF
 20923     END-IF.
 20924
 20925     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20926     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20927     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20928
 20929     READ ELCRTT.
 20930
 20931     IF ELCRTT-FILE-STATUS  = '00'
 20932        CONTINUE
 20933     ELSE
 20934        GO TO 8190-NOTFND
 20935     END-IF.
 20936
 20937     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20938     REWRITE CERTIFICATE-TRAILERS.
 20939
 20940     GO TO 8190-EXIT.
 20941
 20942 8190-NOTFND.
 20943
 20944     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20945     MOVE 'CS'         TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 389
* EL517.cbl
 20946     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20947     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20948     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20949     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20950     WRITE CERTIFICATE-TRAILERS.
 20951
 20952 8190-EXIT.
 20953     EXIT.
 20954
 20955 8195-UPDATE-AGE-FLAGS.
 20956     IF ELCRTT-OPEN = ' '
 20957         OPEN I-O ELCRTT
 20958         MOVE 'X' TO ELCRTT-OPEN
 20959         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20960             NEXT SENTENCE
 20961         ELSE
 20962             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20963             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20964             MOVE EMSG               TO WS-ABEND-MESSAGE
 20965             GO TO ABEND-PGM
 20966         END-IF
 20967     END-IF.
 20968
 20969     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20970     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20971     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20972
 20973     READ ELCRTT.
 20974
 20975     IF ELCRTT-FILE-STATUS  = '00'
 20976        CONTINUE
 20977     ELSE
 20978        GO TO 8195-NOTFND
 20979     END-IF.
 20980
 20981     IF WS-INS-AGE-SET = 'Y'
 20982        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20983     END-IF
 20984     IF WS-JNT-AGE-SET = 'Y'
 20985        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20986     END-IF
 20987
 20988     REWRITE CERTIFICATE-TRAILERS.
 20989
 20990     GO TO 8195-EXIT.
 20991
 20992 8195-NOTFND.
 20993
 20994     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20995     MOVE 'CS'         TO CS-RECORD-ID.
 20996     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20997     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20998     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20999     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21000     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21001     WRITE CERTIFICATE-TRAILERS.
 21002
 21003 8195-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 390
* EL517.cbl
 21004     EXIT.
 21005
 21006 8200-READ-REIN-TABLE.
 21007     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 21008     READ ERREIN.
 21009     ADD 1 TO RREI.
 21010
 21011     IF RE-CODE NOT = 'A'
 21012        PERFORM REIN-DATE-LOAD.
 21013
 21014     IF ERREIN-FILE-STATUS NOT = '00'
 21015          GO TO 8200-NOTFND.
 21016
 21017     GO TO 8200-EXIT.
 21018
 21019 8200-NOTFND.
 21020     MOVE 'N'                TO WS-REIN-READ-SW.
 21021
 21022 8200-EXIT.
 21023     EXIT.
 21024      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 391
* EL517.cbl
 21026
 21027 8300-READ-CTBL-TABLE.
 21028     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 21029     READ ERCTBL.
 21030     ADD 1 TO RCTB.
 21031
 21032     IF ERCTBL-FILE-STATUS NOT = '00'
 21033         GO TO 8300-NOTFND.
 21034
 21035     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21036
 21037     GO TO 8300-EXIT.
 21038
 21039 8300-NOTFND.
 21040     IF CTBL-SW = '0530'
 21041         MOVE 'AA'                     TO WS-AH-COMP-CD
 21042         MOVE '0550'                   TO CTBL-SW
 21043         MOVE '1'                      TO WS-CTBL-READ-SW
 21044         GO TO 8300-EXIT.
 21045
 21046     IF CTBL-SW = '0540'
 21047         MOVE 'AA'                     TO WS-LF-COMP-CD
 21048         MOVE '0550'                   TO CTBL-SW
 21049         MOVE '1'                      TO WS-CTBL-READ-SW
 21050         GO TO 8300-EXIT.
 21051
 21052     IF CTBL-SW = '0550'
 21053         MOVE '2'                      TO WS-CTBL-READ-SW
 21054         GO TO 8300-EXIT.
 21055
 21056 8300-EXIT.
 21057      EXIT.
 21058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 392
* EL517.cbl
 21060
 21061 8400-GETMAIN-ERFORM.
 21062*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21063     EXIT.
 21064 8400-EXIT.
 21065     EXIT.
 21066
 21067 8450-READ-FORM-MASTER.
 21068
 21069     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 21070
 21071     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 21072
 21073     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21074        GO TO 8450-FORM-NOT-FOUND.
 21075
 21076     READ ERFORM NEXT.
 21077
 21078     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21079        GO TO 8450-FORM-NOT-FOUND.
 21080
 21081     MOVE 'Y'                    TO FORM-MASTER-SW.
 21082     GO TO 8450-EXIT.
 21083
 21084 8450-FORM-NOT-FOUND.
 21085
 21086     MOVE 'N'                    TO FORM-MASTER-SW.
 21087
 21088 8450-EXIT.
 21089     EXIT.
 21090
 21091 8500-DATE-CONVERT.
 21092     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 21093
 21094 8500-EXIT.
 21095     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 393
* EL517.cbl
 21097
 21098 8555-RELOAD-CONTROL-FILE.
 21099     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 21100
 21101 8555-EXIT.
 21102     EXIT.
 21103
 21104 8557-GETMAIN-ERPLAN.
 21105*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21106     EXIT.
 21107 8557-EXIT.
 21108     EXIT.
 21109
 21110 8560-GETMAIN.
 21111      MOVE 999 TO ERACCT-POINTER.
 21112
 21113 8560-EXIT.
 21114     EXIT.
 21115
 21116 8570-START-ACCOUNT-MASTER.
 21117     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21118
 21119 8570-EXIT.
 21120     EXIT.
 21121
 21122 8580-READ-ACCOUNT-MASTER.
 21123     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21124
 21125     IF WS-BROWSE-STARTED-SW = 'Y'
 21126         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 21127
 21128     IF ERACCT-FILE-STATUS = '23'
 21129         MOVE HIGH-VALUE TO ERACCT-KEY
 21130         GO TO 8580-EXIT.
 21131
 21132     IF ERACCT-FILE-STAT-1 = '9'
 21133         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21134         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21135         MOVE RMSG TO WS-ABEND-MESSAGE
 21136         GO TO ABEND-PGM.
 21137
 21138     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 21139
 21140     READ ERACCT NEXT.
 21141     ADD 1 TO RACC.
 21142
*21143     COPY ELCACCTI.
 21144******************************************************************04/14/98
 21145*                                                                *ELCACCTI
 21146*                            ELCACCTI                            *   LV003
 21147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21148*                            VMOD=2.001                          *ELCACCTI
 21149*                                                                *ELCACCTI
 21150*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 21151*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 21152*                                                                *ELCACCTI
 21153*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 21154*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 394
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 21155******************************************************************ELCACCTI
 21156     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 21157     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 21158     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 21159     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 21160     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 21161     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 21162     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 21163     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 21164     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 21165
 21166     IF ERACCT-FILE-STAT-1 = '9'
 21167         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21168         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21169         MOVE RMSG TO WS-ABEND-MESSAGE
 21170         GO TO ABEND-PGM.
 21171
 21172     IF ERACCT-FILE-STATUS NOT = '00'
 21173         MOVE HIGH-VALUE TO ERACCT-KEY
 21174         GO TO 8580-EXIT.
 21175
 21176     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 21177
 21178 8580-EXIT.
 21179     EXIT.
 21180
 21181 8582-READ-COMPENSATION-MASTER.
 21182     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 21183
 21184     READ ERCOMP
 21185
 21186     IF ERCOMP-FILE-STATUS NOT = '00'
 21187        GO TO 8582-COMP-NOT-FOUND
 21188     END-IF
 21189
 21190     MOVE 'Y'                    TO COMP-MASTER-SW.
 21191     GO TO 8582-EXIT
 21192     .
 21193 8582-COMP-NOT-FOUND.
 21194
 21195     MOVE 'N'                    TO COMP-MASTER-SW.
 21196
 21197 8582-EXIT.
 21198     EXIT.
 21199
 21200 8583-READ-ERAGTC.
 21201
 21202     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 21203
 21204     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 21205
 21206     IF ERAGTC-FILE-STATUS NOT = '00'
 21207        GO TO 8583-AGTC-NOT-FOUND
 21208     END-IF
 21209
 21210     .
 21211 8583-READ-ERAGTC-NEXT.
 21212
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 395
* EL517.cbl
 21213     READ ERAGTC NEXT RECORD
 21214
 21215     IF ERAGTC-FILE-STATUS NOT = '00'
 21216        GO TO 8583-AGTC-NOT-FOUND
 21217     END-IF
 21218
 21219*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 21220     GO TO 8583-EXIT
 21221     .
 21222 8583-AGTC-NOT-FOUND.
 21223
 21224     MOVE 'N'                    TO AGTC-MASTER-SW.
 21225
 21226 8583-EXIT.
 21227     EXIT.
 21228
 21229 8584-READ-BANK-CROSS-REF.
 21230     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 21231
 21232     READ ERBXRF
 21233
 21234     IF ERBXRF-FILE-STATUS NOT = '00'
 21235        GO TO 8584-BXRF-NOT-FOUND
 21236     END-IF
 21237
 21238     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21239     GO TO 8584-EXIT
 21240     .
 21241 8584-BXRF-NOT-FOUND.
 21242
 21243     MOVE 'N'                    TO BXRF-MASTER-SW.
 21244
 21245 8584-EXIT.
 21246     EXIT.
 21247
 21248 8585-READ-PLAN-MASTER.
 21249
 21250     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21251
 21252     READ ERPLAN.
 21253
 21254     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21255        GO TO 8585-PLAN-NOT-FOUND.
 21256
 21257     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21258     GO TO 8585-EXIT.
 21259
 21260 8585-PLAN-NOT-FOUND.
 21261
 21262     MOVE 'N'                    TO PLAN-MASTER-SW.
 21263
 21264 8585-EXIT.
 21265     EXIT.
 21266
 21267 8586-READ-LOAN-OFFICER.
 21268
 21269     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21270
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 396
* EL517.cbl
 21271     READ ERLOFC
 21272
 21273     IF ERLOFC-FILE-STATUS NOT = '00'
 21274        MOVE 'N'                 TO LOFC-MASTER-SW
 21275     ELSE
 21276        MOVE 'Y'                 TO LOFC-MASTER-SW
 21277     END-IF
 21278
 21279     .
 21280 8586-EXIT.
 21281     EXIT.
 21282
 21283
 21284 8587-START-ERPDEF.
 21285
 21286     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21287
 21288     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21289     IF ERPDEF-FILE-STATUS NOT = '00'
 21290        MOVE 'N'                 TO PDEF-MASTER-SW
 21291     ELSE
 21292        MOVE 'Y'                 TO PDEF-MASTER-SW
 21293     END-IF
 21294
 21295
 21296     .
 21297 8587-EXIT.
 21298     EXIT.
 21299
 21300 8588-READ-ERPDEF.
 21301
 21302     READ ERPDEF NEXT RECORD
 21303
 21304     IF ERPDEF-FILE-STATUS NOT = '00'
 21305        MOVE 'N'                 TO PDEF-MASTER-SW
 21306     ELSE
 21307        MOVE 'Y'                 TO PDEF-MASTER-SW
 21308     END-IF
 21309
 21310     .
 21311 8588-EXIT.
 21312     EXIT.
 21313
 21314 8589-ENDBR-ERPDEF.
 21315
 21316     .
 21317 8589-EXIT.
 21318     EXIT.
 21319
 21320 8590-READ-CERT-MASTER.
 21321     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21322     READ ELCERT.
 21323     ADD 1 TO RCER.
 21324
 21325     IF ELCERT-FILE-STATUS NOT = '00'
 21326         NEXT SENTENCE
 21327     ELSE
 21328         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 397
* EL517.cbl
 21329
 21330     MOVE '1'                     TO CERT-STATUS-SW.
 21331
 21332     IF PB-COMPANY-ID = 'UCL'
 21333         IF WS-ERROR = ER-2799
 21334             GO TO 8590-EXIT.
 21335
 21336     IF PB-CANCELLATION
 21337        MOVE ER-2726              TO  WS-ERROR
 21338        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21339        IF ACCOUNT-MAST-FOUND
 21340           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21341           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21342           GO TO 8590-EXIT
 21343        ELSE
 21344           GO TO 8590-EXIT.
 21345
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 398
* EL517.cbl
 21347
 21348 8590-EXIT.
 21349     EXIT.
 21350
 21351 8750-START-ELSTAT.
 21352
 21353     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21354
 21355     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21356     IF ELSTAT-FILE-STATUS NOT = '00'
 21357        MOVE 'N'                 TO STAT-MASTER-SW
 21358     ELSE
 21359        MOVE 'Y'                 TO STAT-MASTER-SW
 21360     END-IF
 21361
 21362     .
 21363 8750-EXIT.
 21364     EXIT.
 21365
 21366 8752-READ-ELSTAT.
 21367
 21368     READ ELSTAT NEXT RECORD
 21369
 21370     IF ELSTAT-FILE-STATUS NOT = '00'
 21371        MOVE 'N'                 TO STAT-MASTER-SW
 21372     ELSE
 21373        MOVE 'Y'                 TO STAT-MASTER-SW
 21374     END-IF
 21375
 21376     .
 21377 8752-EXIT.
 21378     EXIT.
 21379
 21380 8800-GET-COMP-RATE.
 21381     MOVE +1 TO IB.
 21382     IF WS-COMM-CK-AMT > CT-TBF (1)
 21383         ADD +9 TO IB
 21384         IF WS-COMM-CK-AMT > CT-TBF (2)
 21385             ADD +9 TO IB
 21386             IF WS-COMM-CK-AMT > CT-TBF (3)
 21387                MOVE ZEROS       TO WS-WK-RATE
 21388                GO TO 8800-EXIT.
 21389
 21390     IF PB-I-AGE > CT-AGE (1)
 21391         ADD +3 TO IB
 21392         IF PB-I-AGE > CT-AGE (2)
 21393             ADD +3 TO IB
 21394             IF PB-I-AGE > CT-AGE (3)
 21395                MOVE ZEROS       TO WS-WK-RATE
 21396                GO TO 8800-EXIT.
 21397
 21398     IF WS-WORK-TERM > CT-TRM (1)
 21399         ADD +1 TO IB
 21400         IF WS-WORK-TERM > CT-TRM (2)
 21401             ADD +1 TO IB
 21402             IF WS-WORK-TERM > CT-TRM (3)
 21403                MOVE ZEROS       TO WS-WK-RATE
 21404                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 399
* EL517.cbl
 21405
 21406     IF CT-RT (IB) NOT NUMERIC
 21407         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21408         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21409         GO TO 8800-GET-COMP-RATE.
 21410
 21411     MOVE CT-RT (IB) TO WS-WK-RATE.
 21412
 21413 8800-EXIT.
 21414     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 400
* EL517.cbl
 21416
 21417 8900-ADDRESS-FILE.
 21418     EXIT.
 21419 8900-ADDRESS-EXIT.
 21420     EXIT.
 21421
 21422 9000-READ-CONTROL.
 21423     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21424     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21425
 21426     IF ELCNTL-FILE-STATUS NOT = '00'
 21427         GO TO 9000-NOTFND.
 21428
 21429     READ ELCNTL NEXT.
 21430     ADD 1 TO RCNT.
 21431
 21432     IF ELCNTL-FILE-STATUS NOT = '00'
 21433         GO TO 9000-NOTFND.
 21434
 21435     IF CNTL-REC-TYPE = '1'
 21436         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21437         MOVE 1            TO ELCNTL-POINTER.
 21438
 21439     IF CNTL-REC-TYPE = '6'
 21440         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21441         MOVE 6            TO ELCNTL-POINTER.
 21442
 21443     GO TO 9000-EXIT.
 21444
 21445 9000-NOTFND.
 21446     IF RC-SW-1 = '1'
 21447         MOVE ER-2616             TO WS-ERROR
 21448         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21449         GO TO 9000-EXIT.
 21450
 21451     IF RC-SW-1 = '2'
 21452         MOVE ER-2602             TO WS-ERROR
 21453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21454         GO TO 9000-EXIT.
 21455
 21456     GO TO 9000-EXIT.
 21457
 21458 9000-EXIT.
 21459     EXIT.
 21460      EXIT.
 21461
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 401
* EL517.cbl
 21463 9100-READ-CONTROL.
 21464     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21465     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21466
 21467     IF ELCNTL-FILE-STATUS NOT = '00'
 21468         GO TO 9100-NOTFND.
 21469
 21470     READ ELCNTL NEXT.
 21471     ADD 1 TO RCNT.
 21472
 21473     IF ELCNTL-FILE-STATUS NOT = '00'
 21474         GO TO 9100-NOTFND.
 21475
 21476     IF CNTL-REC-TYPE = '3'
 21477         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21478         MOVE 3            TO ELCNTL-POINTER
 21479         GO TO 9100-EXIT.
 21480
 21481     IF CNTL-REC-TYPE = '4'
 21482         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21483         MOVE 4            TO ELCNTL-POINTER
 21484         GO TO 9100-EXIT.
 21485
 21486     IF CNTL-REC-TYPE = '5'
 21487         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21488         MOVE 5            TO ELCNTL-POINTER
 21489         GO TO 9100-EXIT.
 21490
 21491     IF CNTL-REC-TYPE = 'L'
 21492         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21493         MOVE 10           TO ELCNTL-POINTER
 21494         GO TO 9100-EXIT.
 21495
 21496     IF CNTL-REC-TYPE = 'A'
 21497         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21498         MOVE 11           TO ELCNTL-POINTER
 21499         GO TO 9100-EXIT.
 21500
 21501 9100-NOTFND.
 21502     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21503
 21504     IF RC-SW-2 = '1'
 21505        MOVE '1'                 TO LF-BENEFIT-ERROR
 21506        MOVE ER-2604             TO WS-ERROR
 21507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21508        GO TO 9100-EXIT.
 21509
 21510     IF RC-SW-2 = '2'
 21511        MOVE '1'                 TO AH-BENEFIT-ERROR
 21512        MOVE ER-2605             TO WS-ERROR
 21513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21514        GO TO 9100-EXIT.
 21515
 21516     IF RC-SW-2 = '3'
 21517        MOVE ER-2603             TO WS-ERROR
 21518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21519        GO TO 9100-EXIT.
 21520
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 402
* EL517.cbl
 21521     IF RC-SW-2 = '4'
 21522         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21523         GO TO 9100-EXIT.
 21524
 21525     IF RC-SW-2 = '5'
 21526         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21527         IF WS-AH-INPUT-CD-1 = SPACE
 21528             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21529         ELSE
 21530             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21531
 21532 9100-EXIT.
 21533     EXIT.
 21534      EXIT.
 21535
 21536 9200-CONTROL-GETMAIN.
 21537*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21538     EXIT.
 21539 9200-EXIT.
 21540     EXIT.
 21541
 21542 9250-UNLOCK-RETURN.
 21543*  DUMMIED IN THE BATCH EL517 ....
 21544     EXIT.
 21545 9250-UNLOCK-EXIT.
 21546     EXIT.
 21547      EXIT.
 21548
 21549 9300-ACCUM-BATCH-TOTALS.
 21550         IF PB-ISSUE
 21551             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21552             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21553             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21554             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21555             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21556             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21557             ADD 1                       TO WS-ISSUE-CNT
 21558         ELSE
 21559             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21560             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21561             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21562             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21563             ADD 1                       TO WS-CANCEL-CNT.
 21564
 21565 9400-EXIT.
 21566     EXIT.
 21567
 21568 9990-RETURN.
 21569*    END BROUSE OF ACCOUNT FILE
 21570     EXIT.
 21571
 21572 9990-EXIT.
 21573     EXIT.
 21574
 21575
 21576****Check for CRTO record, add one if not found.
 21577 9991-CHECK-FOR-ELCRTO.
 21578     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 403
* EL517.cbl
 21579         OPEN I-O ELCRTO
 21580         MOVE 'X' TO ELCRTO-OPEN
 21581         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21582             NEXT SENTENCE
 21583         ELSE
 21584             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21585             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21586             MOVE EMSG               TO WS-ABEND-MESSAGE
 21587             GO TO ABEND-PGM
 21588         END-IF
 21589     END-IF.
 21590     IF ELCRTT-OPEN = ' '
 21591         OPEN I-O ELCRTT
 21592         MOVE 'X' TO ELCRTT-OPEN
 21593         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21594             NEXT SENTENCE
 21595         ELSE
 21596             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21597             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21598             MOVE EMSG               TO WS-ABEND-MESSAGE
 21599             GO TO ABEND-PGM
 21600         END-IF
 21601     END-IF.
 21602     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21603     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21604     MOVE +0                     TO ELCRTO-SEQ-NO
 21605     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21606
 21607     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21608
 21609     IF ELCRTO-FILE-STATUS NOT = '00'
 21610         GO TO 9991-CRTO-NOT-FOUND
 21611     END-IF.
 21612
 21613     READ ELCRTO NEXT.
 21614     IF ELCRTO-FILE-STATUS = '00'
 21615        AND (OC-CONTROL-PRIMARY (1:33) =
 21616                 PB-CONTROL-BY-ACCOUNT (1:33))
 21617        AND (OC-RECORD-TYPE = 'I')
 21618           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21619               GO TO 9991-CHECK-INDICATORS
 21620           ELSE
 21621               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21622               GO TO 9991-CRTO-ADD-REC
 21623           END-IF
 21624     END-IF.
 21625
 21626 9991-CRTO-NOT-FOUND.
 21627
 21628     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21629     MOVE 'OC'                TO OC-RECORD-ID
 21630     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21631                              TO OC-CONTROL-PRIMARY (1:33)
 21632     MOVE +4096               TO OC-KEY-SEQ-NO.
 21633
 21634 9991-CRTO-ADD-REC.
 21635
 21636     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 404
* EL517.cbl
 21637     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21638     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21639     MOVE 'I'                 TO OC-RECORD-TYPE
 21640     IF PB-ISSUE
 21641         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21642         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21643         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21644         MOVE PB-I-AGE               TO OC-INS-AGE
 21645         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21646         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21647         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21648         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21649         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21650         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21651         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21652         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21653         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21654         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21655         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21656         IF PB-I-JOINT-COMMISSION > +0
 21657             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21658         ELSE
 21659             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21660         END-IF
 21661         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21662         MOVE +0                     TO OC-LF-CANCEL-AMT
 21663                                        OC-LF-ITD-CANCEL-AMT
 21664         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21665         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21666         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21667         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21668         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21669         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21670         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21671         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21672         MOVE +0                     TO OC-AH-CANCEL-AMT
 21673                                        OC-AH-ITD-CANCEL-AMT
 21674         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21675         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21676         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21677     ELSE
 21678         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21679         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21680         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21681         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21682         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21683         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21684         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21685         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21686         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21687          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21688             MOVE SPACES             TO OC-LF-BENCD
 21689             MOVE ZEROS              TO OC-LF-TERM
 21690                                        OC-LF-BEN-AMT
 21691                                        OC-LF-PRM-AMT
 21692                                        OC-LF-ALT-BEN-AMT
 21693                                        OC-LF-ALT-PRM-AMT
 21694                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 405
* EL517.cbl
 21695                                        OC-LF-CANCEL-AMT
 21696             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21697             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21698         ELSE
 21699             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21700             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21701             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21702             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21703             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21704             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21705             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21706             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21707             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21708             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21709         END-IF
 21710         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21711         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21712          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21713             MOVE SPACES             TO OC-AH-BENCD
 21714             MOVE ZEROS              TO OC-AH-TERM
 21715                                        OC-AH-BEN-AMT
 21716                                        OC-AH-PRM-AMT
 21717                                        OC-AH-COMM-PCT
 21718                                        OC-AH-CANCEL-AMT
 21719                                        OC-AH-CP
 21720             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21721             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21722         ELSE
 21723             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21724             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21725             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21726             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21727             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21728             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21729             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21730             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21731             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21732         END-IF
 21733         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21734         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21735         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21736         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21737     END-IF
 21738     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21739
 21740     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21741     IF ERMAIL-FOUND = ' '
 21742         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21743     END-IF.
 21744
 21745     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21746     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21747     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21748
 21749     READ ELCRTT
 21750
 21751     IF ELCRTT-FILE-STATUS  = '00'
 21752         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 406
* EL517.cbl
 21753         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21754     END-IF.
 21755
 21756     WRITE ORIGINAL-CERTIFICATE.
 21757
 21758     GO TO 9991-EXIT.
 21759
 21760 9991-CHECK-INDICATORS.
 21761
 21762     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21763         GO TO 9991-EXIT
 21764     END-IF.
 21765
 21766     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21767         GO TO 9991-EXIT
 21768     END-IF.
 21769
 21770     IF PB-ISSUE
 21771        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21772        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21773        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21774        MOVE PB-I-AGE               TO OC-INS-AGE
 21775        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21776        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21777        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21778        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21779        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21780        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21781        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21782        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21783        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21784        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21785        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21786        IF PB-I-JOINT-COMMISSION > +0
 21787            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21788        ELSE
 21789            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21790        END-IF
 21791        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21792        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21793        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21794        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21795        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21796        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21797        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21798        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21799        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21800
 21801        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21802        IF ERMAIL-FOUND = ' '
 21803           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21804        END-IF
 21805
 21806        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21807        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21808        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21809        READ ELCRTT
 21810        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 407
* EL517.cbl
 21811           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21812           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21813        END-IF
 21814
 21815     ELSE
 21816        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21817           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21818           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21819           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21820        END-IF
 21821        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21822           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21823           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21824           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21825        END-IF
 21826        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21827     END-IF
 21828
 21829     REWRITE ORIGINAL-CERTIFICATE.
 21830
 21831 9991-EXIT.
 21832     EXIT.
 21833
 21834
 21835 9999-SET-PNDB-ERROR-FLAGS.
 21836
 21837     IF PB-BATCH-TRAILER
 21838        GO TO 9999-REWRITE-RECORD.
 21839
 21840     IF PB-COMMON-ERRORS = LOW-VALUES
 21841        GO TO 9999-SET-ERROR-FLAGS.
 21842
 21843 9999-FORMAT-ERRORS.
 21844
 21845     MOVE +0                     TO SUB1.
 21846
 21847 9999-ERROR-LOOP.
 21848
 21849     ADD +1                      TO SUB1.
 21850
 21851     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21852        GO TO 9999-SET-ERROR-FLAGS.
 21853
 21854     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21855
 21856     READ ELCERR.
 21857
 21858     IF ELCERR-FILE-STATUS NOT = '00'
 21859        ADD +1                       TO EMI-FATAL-CTR
 21860        GO TO  9999-ERROR-LOOP.
 21861
*21862                                 COPY ELCERRPD.
 21863******************************************************************04/15/98
 21864*                                                                *ELCERRPD
 21865*                                                                *ELCERRPD
 21866*                            ELCERRPD                            *   LV002
 21867*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21868*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 408
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21869*                                                                *ELCERRPD
 21870*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21871*                                                                *ELCERRPD
 21872******************************************************************ELCERRPD
 21873                                                                  ELCERRPD
 21874     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21875         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21876                                                                  ELCERRPD
 21877     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21878                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21879        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21880            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21881                                                                  ELCERRPD
 21882     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21883        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21884            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21885                                                                  ELCERRPD
 21886     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21887        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21888            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21889                                                                  ELCERRPD
 21890     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21891        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21892            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21893                                                                  ELCERRPD
 21894     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21895        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21896            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21897                                                                  ELCERRPD
 21898     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21899        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21900            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21901                                                                  ELCERRPD
 21902     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21903        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21904            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21905                                                                  ELCERRPD
 21906     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21907        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21908            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21909                                                                  ELCERRPD
 21910     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21911        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21912            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21913                                                                  ELCERRPD
 21914     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21915        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21916            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21917                                                                  ELCERRPD
 21918     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21919             OR                                                   ELCERRPD
 21920         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21921                                                                  ELCERRPD
 21922         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21923             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21924                                                                  ELCERRPD
 21925     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21926         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 409
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21927             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21928
 21929     IF E-CLIENT-ID = CLIENT-DCC
 21930        IF EM-MESSAGE-NUMBER = 2719
 21931           MOVE 'W'              TO EM-ERROR-SEVERITY
 21932        END-IF
 21933     END-IF
 21934
 21935     .
 21936
 21937     IF EM-ERROR-SEVERITY = 'W'
 21938        ADD +1                   TO EMI-WARNING-CTR
 21939        GO TO  9999-ERROR-LOOP.
 21940
 21941     IF EM-ERROR-SEVERITY = 'F'
 21942        ADD +1                   TO EMI-FORCABLE-CTR
 21943        GO TO  9999-ERROR-LOOP.
 21944
 21945     IF EM-ERROR-SEVERITY = 'X'
 21946        ADD +1                   TO EMI-FATAL-CTR.
 21947
 21948     GO TO 9999-ERROR-LOOP.
 21949
 21950 9999-SET-ERROR-FLAGS.
 21951
 21952     IF EMI-FATAL-CTR NOT = ZEROS
 21953        MOVE 'X'                 TO PB-FATAL-FLAG
 21954        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21955
 21956     IF EMI-FORCABLE-CTR NOT = ZEROS
 21957        IF PB-ISSUE
 21958           IF PB-ISSUE-FORCE
 21959              MOVE 'F'           TO PB-FORCE-ER-CD
 21960             ELSE
 21961              MOVE 'X'           TO PB-FORCE-ER-CD
 21962          ELSE
 21963           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21964              MOVE 'F'           TO PB-FORCE-ER-CD
 21965             ELSE
 21966              MOVE 'X'           TO PB-FORCE-ER-CD.
 21967
 21968 9999-CONT-SET-ERROR-FLAGS.
 21969
 21970     IF EMI-WARNING-CTR NOT = ZEROS
 21971        MOVE 'W'                 TO PB-WARN-ER-CD.
 21972
 21973     IF PB-UNFORCED-ERRORS OR
 21974        PB-FATAL-ERRORS    OR
 21975        PB-RECORD-ON-HOLD  OR
 21976        PB-RECORD-RETURNED
 21977*        OR
 21978*       PB-CANCELLATION
 21979          NEXT SENTENCE
 21980        ELSE
 21981          GO TO 9999-REWRITE-RECORD.
 21982
 21983     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21984     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 410
* EL517.cbl
 21985     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21986     MOVE PB-SV-STATE            TO CERT-STATE.
 21987
 21988     READ ELCERT.
 21989
 21990     IF PB-ISSUE
 21991     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21992        GO TO 9999-REWRITE-CERT-MASTER.
 21993
 21994     IF PB-ISSUE
 21995        IF PB-RECORD-RETURNED
 21996            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21997        ELSE
 21998             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21999
 22000     IF PB-CANCELLATION
 22001        IF PB-RECORD-RETURNED
 22002            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 22003        ELSE
 22004            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 22005               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 22006            ELSE
 22007               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 22008
 22009 9999-REWRITE-CERT-MASTER.
 22010
 22011     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22012        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22013        GO TO 9999-REWRITE-RECORD.
 22014
 22015     REWRITE CERTIFICATE-MASTER.
 22016     ADD 1 TO WCER.
 22017
 22018 9999-REWRITE-RECORD.
 22019     IF NOT PB-BATCH-TRAILER
 22020         IF PB-ISSUE
 22021             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22022             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22023             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22024             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22025             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 22026             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 22027             ADD 1                   TO WS-ISSUE-CNT
 22028         ELSE
 22029             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 22030             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 22031             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 22032             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 22033             ADD 1                   TO WS-CANCEL-CNT
 22034     ELSE
 22035         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 22036         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 22037         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 22038         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 22039         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 22040         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 22041         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 22042         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 411
* EL517.cbl
 22043         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 22044         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 22045         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 22046                                        WS-LF-ISS-ENTERED
 22047                                        WS-AH-ISS-COMPUTED
 22048                                        WS-AH-ISS-ENTERED
 22049                                        WS-LF-CAN-COMPUTED
 22050                                        WS-LF-CAN-ENTERED
 22051                                        WS-AH-CAN-COMPUTED
 22052                                        WS-AH-CAN-ENTERED
 22053                                        WS-ISSUE-CNT
 22054                                        WS-CANCEL-CNT
 22055         MOVE SPACE                  TO PB-FATAL-FLAG.
 22056
 22057     IF PB-BATCH-TRAILER
 22058         IF PB-B-LF-ISS-PRM-REMITTED =
 22059            PB-B-LF-ISS-PRM-ENTERED   AND
 22060            PB-B-LF-CAN-PRM-REMITTED =
 22061            PB-B-LF-CAN-PRM-ENTERED   AND
 22062            PB-B-AH-ISS-PRM-REMITTED =
 22063            PB-B-AH-ISS-PRM-ENTERED   AND
 22064            PB-B-AH-CAN-PRM-REMITTED =
 22065            PB-B-AH-CAN-PRM-ENTERED   AND
 22066            PB-B-ISSUE-CNT-REMITTED  =
 22067            PB-B-ISSUE-CNT-ENTERED    AND
 22068            PB-B-CANCEL-CNT-REMITTED =
 22069            PB-B-CANCEL-CNT-ENTERED
 22070             MOVE SPACE          TO PB-OUT-BAL-CD
 22071           ELSE
 22072             MOVE 'O'            TO PB-OUT-BAL-CD.
 22073
 22074     REWRITE PENDING-BUSINESS.
 22075
 22076     ADD 1 TO WPND.
 22077
 22078     GO TO 0100-READ-PENDING.
 22079
 22080 9999-EXIT.
 22081     EXIT.
 22082
 22083******************************************************************
 22084*                                                                *
 22085*            E R R O R   F O R M A T   R O U T I N E             *
 22086*                                                                *
 22087******************************************************************
 22088
 22089 9900-ERROR-FORMAT.
 22090
 22091     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 22092                   PB-COMMON-ERROR (2)  OR
 22093                   PB-COMMON-ERROR (3)  OR
 22094                   PB-COMMON-ERROR (4)  OR
 22095                   PB-COMMON-ERROR (5)  OR
 22096                   PB-COMMON-ERROR (6)  OR
 22097                   PB-COMMON-ERROR (7)  OR
 22098                   PB-COMMON-ERROR (8)  OR
 22099                   PB-COMMON-ERROR (9)  OR
 22100                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 412
* EL517.cbl
 22101        GO TO 9900-EXIT.
 22102
 22103     IF PB-NO-OF-ERRORS = +10
 22104        GO TO 9900-EXIT.
 22105
 22106     ADD +1                      TO PB-NO-OF-ERRORS.
 22107     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22108                                       (PB-NO-OF-ERRORS).
 22109
 22110
 22111 9900-EXIT.
 22112     EXIT.
 22113
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 413
* EL517.cbl
 22115 9999-DONE.
 22116*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 22117
 22118     IF DTE-CLIENT NOT EQUAL 'DMD'
 22119          GO TO 9999-DONE-CONT.
 22120
 22121     CLOSE ERRESS
 22122           ERRESC.
 22123
 22124     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 22125     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 22126     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 22127     IF DMPF-RETURN-CODE EQUAL 'Z3'
 22128         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22129         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 22130         MOVE CMSG               TO WS-ABEND-MESSAGE
 22131         GO TO ABEND-PGM.
 22132
 22133     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 22134     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 22135     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 22136     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22137         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22138         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 22139         MOVE CMSG               TO WS-ABEND-MESSAGE
 22140         GO TO ABEND-PGM.
 22141
 22142     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 22143     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 22144     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 22145     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22146         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22147         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 22148         MOVE CMSG               TO WS-ABEND-MESSAGE
 22149         GO TO ABEND-PGM.
 22150
 22151     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22152     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 22153     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22154     IF DCUA-RETURN-CODE EQUAL 'Z3'
 22155         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22156         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 22157         MOVE CMSG               TO WS-ABEND-MESSAGE
 22158         GO TO ABEND-PGM.
 22159
 22160     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 22161     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 22162     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 22163     IF DPRB-RETURN-CODE EQUAL 'Z3'
 22164         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22165         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 22166         MOVE CMSG               TO WS-ABEND-MESSAGE
 22167         GO TO ABEND-PGM.
 22168
 22169     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 22170     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 22171     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 22172     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 414
* EL517.cbl
 22173         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22174         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 22175         MOVE CMSG               TO WS-ABEND-MESSAGE
 22176         GO TO ABEND-PGM.
 22177
 22178     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 22179     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 22180     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 22181     IF DVSC-RETURN-CODE EQUAL 'Z3'
 22182         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22183         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 22184         MOVE CMSG               TO WS-ABEND-MESSAGE
 22185         GO TO ABEND-PGM.
 22186
 22187*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22188
 22189 9999-DONE-CONT.
 22190
 22191     IF ERPNDM-OPEN = 'X'
 22192        CLOSE ERPNDM.
 22193
 22194     IF ERMAIL-OPEN = 'X'
 22195        CLOSE ERMAIL.
 22196
 22197     IF ELMSTR-OPEN = 'X'
 22198        CLOSE ELMSTR.
 22199
 22200     IF ELCRTT-OPEN = 'X'
 22201        CLOSE ELCRTT
 22202     END-IF.
 22203
 22204     IF ELCRTO-OPEN = 'X'
 22205        CLOSE ELCRTO
 22206     END-IF.
 22207
 22208     CLOSE      ELCNTL
 22209                ELCERR
 22210                ERPNDB
 22211                ERREIN
 22212                ELCERT
 22213                ERCTBL
 22214                ERPLAN
 22215                ERACCT
 22216                ERBXRF
 22217                ERAGTC
 22218                ERCOMP.
 22219
 22220     IF DTE-CLIENT = 'DCC'
 22221        CLOSE ERPDEF ELSTAT
 22222        IF ERPDEF-FILE-STATUS NOT = '00'
 22223            MOVE ERPDEF-FILE-STATUS
 22224                                 TO WS-ABEND-FILE-STATUS
 22225            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 22226            MOVE CMSG            TO WS-ABEND-MESSAGE
 22227            GO TO ABEND-PGM
 22228        END-IF
 22229        IF ELSTAT-FILE-STATUS NOT = '00'
 22230            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 415
* EL517.cbl
 22231                                 TO WS-ABEND-FILE-STATUS
 22232            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22233            MOVE CMSG            TO WS-ABEND-MESSAGE
 22234            GO TO ABEND-PGM
 22235        END-IF
 22236     END-IF
 22237
 22238     IF ELCNTL-FILE-STATUS NOT = '00'
 22239         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22240         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22241         MOVE CMSG TO WS-ABEND-MESSAGE
 22242         GO TO ABEND-PGM.
 22243
 22244     IF ERPNDB-FILE-STATUS NOT = '00'
 22245         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22246         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22247         MOVE CMSG TO WS-ABEND-MESSAGE
 22248         GO TO ABEND-PGM.
 22249
 22250     IF ERREIN-FILE-STATUS NOT = '00'
 22251         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22252         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22253         MOVE CMSG TO WS-ABEND-MESSAGE
 22254         GO TO ABEND-PGM.
 22255
 22256     IF ELCERT-FILE-STATUS NOT = '00'
 22257         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22258         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22259         MOVE CMSG TO WS-ABEND-MESSAGE
 22260         GO TO ABEND-PGM.
 22261
 22262     IF ERMAIL-OPEN   = 'X'
 22263       IF ERMAIL-FILE-STATUS NOT = '00'
 22264           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22265           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22266           MOVE CMSG TO WS-ABEND-MESSAGE
 22267           GO TO ABEND-PGM.
 22268
 22269     IF ERPNDM-OPEN   = 'X'
 22270       IF ERPNDM-FILE-STATUS NOT = '00'
 22271            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22272            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22273            MOVE CMSG TO WS-ABEND-MESSAGE
 22274            GO TO ABEND-PGM.
 22275
 22276     IF ELCRTT-OPEN = 'X'
 22277         IF ELCRTT-FILE-STATUS NOT = '00'
 22278             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22279             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22280             MOVE CMSG TO WS-ABEND-MESSAGE
 22281             GO TO ABEND-PGM
 22282         END-IF
 22283     END-IF.
 22284
 22285     IF ELCRTO-OPEN = 'X'
 22286         IF ELCRTO-FILE-STATUS NOT = '00'
 22287             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22288             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 416
* EL517.cbl
 22289             MOVE CMSG TO WS-ABEND-MESSAGE
 22290             GO TO ABEND-PGM
 22291         END-IF
 22292     END-IF.
 22293
 22294     IF ERCTBL-FILE-STATUS NOT = '00'
 22295         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22296         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22297         MOVE CMSG TO WS-ABEND-MESSAGE
 22298         GO TO ABEND-PGM.
 22299
 22300     IF ERPLAN-FILE-STATUS NOT = '00'
 22301        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22302        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22303        MOVE CMSG TO WS-ABEND-MESSAGE
 22304        GO TO ABEND-PGM.
 22305
 22306     IF ERACCT-FILE-STATUS NOT = '00'
 22307         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22308         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22309         MOVE CMSG TO WS-ABEND-MESSAGE
 22310         GO TO ABEND-PGM.
 22311
 22312     IF ERCOMP-FILE-STATUS NOT = '00'
 22313         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22314         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22315         MOVE CMSG TO WS-ABEND-MESSAGE
 22316         GO TO ABEND-PGM.
 22317
 22318     IF ERBXRF-FILE-STATUS NOT = '00'
 22319         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22320         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22321         MOVE CMSG TO WS-ABEND-MESSAGE
 22322         GO TO ABEND-PGM.
 22323
 22324     IF ERAGTC-FILE-STATUS NOT = '00'
 22325         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22326         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22327         MOVE CMSG TO WS-ABEND-MESSAGE
 22328         GO TO ABEND-PGM.
 22329
 22330     IF ELCERR-FILE-STATUS NOT = '00'
 22331         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22332         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22333         MOVE CMSG TO WS-ABEND-MESSAGE
 22334         GO TO ABEND-PGM.
 22335
 22336     MOVE 'C'                     TO CP-IO-FUNCTION.
 22337     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22338
 22339     IF IO-ERROR
 22340        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22341        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22342        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22343        GO TO ABEND-PGM.
 22344
 22345     OPEN OUTPUT PRINT-FILE.
 22346
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 417
* EL517.cbl
 22347     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22348     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22349     MOVE ALPH-DATE              TO H3-DATE.
 22350     MOVE TRAN-CT                TO SUM-TOT.
 22351
 22352 7000-PRT-HDG.
 22353     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22354     PERFORM 7000-PRINT-LINE.
 22355     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22356     PERFORM 7000-PRINT-LINE.
 22357     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22358     PERFORM 7000-PRINT-LINE.
 22359     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22360     PERFORM 7000-PRINT-LINE.
 22361     GO TO 9999-END-JOB.
 22362
 22363 7000-HDG-XIT.
 22364     EXIT.
 22365
 22366 7000-PRINT-LINE.
*22367                     COPY ELCPRT2X.
 22368******************************************************************04/15/98
 22369*                                                                *ELCPRT2X
 22370*                                                                *ELCPRT2X
 22371*                            ELCPRT2X.                           *   LV002
 22372*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22373*                            VMOD=2.002                          *   CL**2
 22374*                                                                *ELCPRT2X
 22375*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22376*                                                                *ELCPRT2X
 22377*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22378*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22379*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22380*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22381*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22382*                                                                *ELCPRT2X
 22383*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22384*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22385******************************************************************ELCPRT2X
 22386                                                                  ELCPRT2X
 22387     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22388         FICH-OPEN   = SPACE                                      ELCPRT2X
 22389         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22390         OPEN OUTPUT FICH.                                        ELCPRT2X
 22391                                                                  ELCPRT2X
 22392     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22393         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22394             OPEN I-O ELREPT                                      ELCPRT2X
 22395             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22396                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22397                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22398                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22399                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22400                 GO TO ABEND-PGM                                  ELCPRT2X
 22401             ELSE                                                 ELCPRT2X
 22402                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22403                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22404                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 418
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22405                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22406                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22407                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22408                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22409                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22410                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22411                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22412                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22413                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22414                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22415                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22416                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22417                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22418                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22419                                                                  ELCPRT2X
 22420     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22421        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22422         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22423         GO TO ABEND-PGM.                                         ELCPRT2X
 22424                                                                  ELCPRT2X
 22425     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22426         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22427         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22428             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22429                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22430                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22431                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22432                     INVALID KEY                                  ELCPRT2X
 22433                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22434                         CLOSE ELREPT                             ELCPRT2X
 22435                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22436                                                                  ELCPRT2X
 22437     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22438         MOVE X                      TO  P-CTL                    ELCPRT2X
 22439         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22440                                                                  ELCPRT2X
 22441     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22442       MOVE X                        TO  P-CTL                    ELCPRT2X
 22443       IF P-CTL = ' '                                             ELCPRT2X
 22444         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22445       ELSE                                                       ELCPRT2X
 22446         IF P-CTL = '0'                                           ELCPRT2X
 22447           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22448         ELSE                                                     ELCPRT2X
 22449           IF P-CTL = '-'                                         ELCPRT2X
 22450             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22451           ELSE                                                   ELCPRT2X
 22452             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22453                                                                  ELCPRT2X
 22454     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22455                                                                  ELCPRT2X
 22456 DTE-REPORT-DELETE.                                               ELCPRT2X
 22457     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22458         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22459         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22460                                                                  ELCPRT2X
 22461     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22462           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 419
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22463                                                                  ELCPRT2X
 22464     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22465        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22466         DELETE ELREPT RECORD                                     ELCPRT2X
 22467         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22468                                                                  ELCPRT2X
 22469 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22470     EXIT.                                                        ELCPRT2X
 22471                                                                  ELCPRT2X
 22472 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22473     EXIT.                                                        ELCPRT2X
 22474******************************************************************ELCPRT2X
 22475
 22476 REIN-DATE-LOAD.
*22477     COPY ELCRENM1.
 22478******************************************************************04/15/98
 22479*                                                                *ELCRENM1
 22480*                                                                *ELCRENM1
 22481*                            ELCRENM1                            *   LV002
 22482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22483*                            VMOD=2.001                          *ELCRENM1
 22484*                                                                *ELCRENM1
 22485*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22486*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22487*                                                                *ELCRENM1
 22488******************************************************************ELCRENM1
 22489     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22490     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22491     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22492                                                                  ELCRENM1
 22493
 22494 7000-PRINT-LINE-XIT.
 22495      EXIT.
 22496
 22497 9999-END-JOB.
 22498     CLOSE PRINT-FILE.
*22499             COPY ELCPRTCX.
 22500******************************************************************04/15/98
 22501*                                                                *ELCPRTCX
 22502*                                                                *ELCPRTCX
 22503*                            ELCPRTCX.                           *   LV003
 22504*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22505*                            VMOD=2.003                          *   CL**3
 22506*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22507*                                                                *ELCPRTCX
 22508* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22509******************************************************************ELCPRTCX
 22510                                                                  ELCPRTCX
 22511      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22512          CLOSE FICH.                                             ELCPRTCX
 22513                                                                  ELCPRTCX
 22514      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22515          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22516          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22517          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22518          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22519          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22520          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 420
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22521          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22522          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22523              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22524              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22525              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22526                  UPON CONSOLE                                    ELCPRTCX
 22527              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22528                  UPON CONSOLE                                    ELCPRTCX
 22529            ELSE                                                  ELCPRTCX
 22530              DISPLAY '***************************************'   ELCPRTCX
 22531              DISPLAY '***************************************'   ELCPRTCX
 22532              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22533              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22534              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22535              DISPLAY '**                                   **'   ELCPRTCX
 22536              DISPLAY '***************************************'   ELCPRTCX
 22537              DISPLAY '***************************************'   ELCPRTCX
 22538              CLOSE ELREPT.                                       ELCPRTCX
 22539                                                                  ELCPRTCX
 22540      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22541          DISPLAY '***************************************'       ELCPRTCX
 22542          DISPLAY '***************************************'       ELCPRTCX
 22543          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22544          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22545          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22546          DISPLAY '**                                   **'       ELCPRTCX
 22547          DISPLAY '***************************************'       ELCPRTCX
 22548          DISPLAY '***************************************'       ELCPRTCX
 22549          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22550                                                                  ELCPRTCX
 22551      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22552          DISPLAY '***************************************'       ELCPRTCX
 22553          DISPLAY '***************************************'       ELCPRTCX
 22554          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22555          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22556          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22557          DISPLAY '**                                   **'       ELCPRTCX
 22558          DISPLAY '***************************************'       ELCPRTCX
 22559          DISPLAY '***************************************'       ELCPRTCX
 22560          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22561                                                                  ELCPRTCX
 22562                                                                  ELCPRTCX
 22563******************************************************************ELCPRTCX
 22564
 22565     GOBACK.
 22566
 22567 ABEND-PGM.
*                   COPY ELCABEND.
 22568***************************************************************** 04/14/98
 22569*                                                               * ELCABEND
 22570*                            ELCABEND.                          *    LV003
 22571*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22572*                            VMOD 2.002                              CL**2
 22573*                                                               * ELCABEND
 22574*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22575*            AND THEN ABENDS.                                   * ELCABEND
 22576*                                                               * ELCABEND
 22577*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-May-14 13:54 Page 421
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22578*                                                               * ELCABEND
 22579***************************************************************** ELCABEND
 22580*APS-010.                                                         ELCABEND
 22581     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22582     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22583                                                                  ELCABEND
 22584     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22585         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22586         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22587                                 UPON CONSOLE.                    ELCABEND
 22588                                                                  ELCABEND
 22589     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22590         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22591         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22592                                 UPON CONSOLE.                    ELCABEND
 22593                                                                  ELCABEND
 22594     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22595     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22596                                 UPON CONSOLE.                    ELCABEND
 22597                                                                  ELCABEND
 22598     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22599     CALL 'ABORTME'.
 22600                                                                  ELCABEND
 22601 APS-EXIT.                                                        ELCABEND
 22602     EXIT.                                                        ELCABEND
 22603
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116664     Code:       91770
