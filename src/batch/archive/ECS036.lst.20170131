* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS036.cbl
* Options: int("ECS036.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS036.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS036.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS036.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS036.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/28/95 11:10:55.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.014.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS036.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANSE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 120602    2002120500014  SMVA  MODIFY COPYBOOK MODULE PRTN036
    22* 012703                   SMVA  DATA SHOWING IN ECS036D RPT FROM
    23*                                PREVIOUS PASSES - CLEAR HD-6
    24* 112503                   SMVA  FIX PASS 4 INITIAL MISSING HEADER
    25* 012704    2004011500004  SMVA  REMOVE RMRO,UMB, & MFG FROM SYS050
    26*                                AND REMOVE ALL SYS051 PRINT
    27* 050504    2004042100005  SMVA  DROP CENTS FROM A&H BEN AMT FLD
    28* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
    29* 122804    2004101500005  PEMA  ADD ITD AND PYTD AND PL12
    30* 010306    2006010300002  PEMA  CORRECT PROBLEM WITH PYTD TOTALS
    31* 072709  CR2009042000001  AJRA  ADD PASS 6 FOR USER SELECT 2
    32* 082609  CR2009030400001  AJRA  ADD L12,YTD AND PYTD GRAND TOTALS
    33* 031511  CR2009082100002  AJRA  ADD PASS 7 FOR USER SELECT 5
    34* 091614  IR2014091000003  PEMA  FIX PYTD STATE TOTALS AHPRM
    35******************************************************************
    36*REMARKS.
    37*        PRINTS MONTHLY PRODUCTION REPORTS FOR LAST 12 MONTHS -
    38*
    39*  PASS 1 - STATE OVERALL................................ECS036A
    40*  PASS 2 - CARRIER/COMPANY WITHIN BUSINESS TYPE.........ECS036B
    41*  PASS 3 - CARRIER/COMPANY WITHIN AGENCY................ECS036C
    42*  PASS 4 - REPORT CODE 1 OVERALL........................ECS036D
    43*  PASS 5 - REPORT CODE 2 WITHIN CARRIER & GROUPING......ECS036E
    44*                 (STATE BREAKS)
    45*  PASS 6 - USER SELECT 2 ...............................ECS036F
    46*  PASS 7 - USER SELECT 5/REPORT CODE 1 .................ECS036G
    47*
    48*     -- FORMAT OPTIONS --
    49*        1 = PRINT ALL ECS035 REPORTS
    50*        2 = PRINT ECS036A ONLY - STATE OVERALL
    51*        3 = PRINT ECS036B ONLY - CARR/CO WITHIN BUS TYPE
    52*        4 = PRINT ECS036C ONLY - CARR/CO WITHIN AGENCY
    53*        5 = PRINT ECS036D ONLY - REPORT CODE 1 OVERALL
    54*        6 = PRINT ECS036E ONLY - REPORT CODE 2 WITHIN CARR
    55*
    56*     -- REPORT CODE TOTAL OPTIONS --
    57*        1 = NO REPORT CODING
    58*        2 = REPORT CODE 1 ONLY
    59*        3 = REPORT CODE 2 ONLY
    60*        4 = BOTH REPORT CODES
    61*        5 = REPORT CODE 1 ONLY (DETAIL)
    62*        6 = REPORT CODE 2 ONLY (DETAIL)
    63*        7 = BOTH REPORT CODES  (DETAIL)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS036.cbl
    65 ENVIRONMENT DIVISION.
    66 CONFIGURATION SECTION.
    67
    68 INPUT-OUTPUT SECTION.
    69 FILE-CONTROL.
    70
    71     SELECT SORT-FILE    ASSIGN TO SYS001.
    72     SELECT EARNED-PREM  ASSIGN TO SYS012-UT-FBA1-S-SYS012.
    73     SELECT PRNT         ASSIGN TO SYS008-UR-1403-S-SYS008.
    74     SELECT DISK-DATE    ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    75     SELECT FICH         ASSIGN TO SYS020-UT-2400-S-SYS020.
    76     SELECT SELECT-FILE  ASSIGN TO SYS050-UT-1403-S-SYS050.
    77
    78 DATA DIVISION.
    79 FILE SECTION.
    80
    81 FD  SELECT-FILE
    82     RECORDING MODE F.
    83
    84 01  SELECT-RECORD.
    85     05  SELECT-CC               PIC X.
    86     05  SLCT-FLD-1              PIC X(11).
    87     05  SLCT-FLD-2              PIC X(10).
    88     05  SLCT-REC                PIC X(111).
    89
    90*
    91 SD  SORT-FILE.
    92
    93 01  SORT-FILE-REC.
    94     05 SORT-CONTROL-74          PIC X(40).
    95     05  SORT-DATE               PIC X(04).
    96     05  FILLER                  PIC X(98).
    97     05  SORT-AM-EXPIRE          PIC X(06).
    98     05  SORT-AM-HI-CERT         PIC X(06).
    99     05  SORT-HI-CERT            PIC X(06).
   100     05  FILLER                  PIC X(36).
   101
   102 FD  EARNED-PREM
   103     BLOCK CONTAINS 0 RECORDS
   104     RECORDING MODE F.
   105
   106 01  EP-EXTR                     PIC X(196).
   107*01  EP-EXTR                     PIC X(166).
   108
   109 FD  PRNT
*  110     COPY ELCPRTFD.
   111******************************************************************04/15/98
   112*                                                                *ELCPRTFD
   113*                                                                *ELCPRTFD
   114*                            ELCPRTFD.                           *   LV003
   115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   116*                            VMOD=2.006                          *ELCPRTFD
   117******************************************************************ELCPRTFD
   118     RECORDING MODE F                                             ELCPRTFD
   119     LABEL RECORDS OMITTED                                        ELCPRTFD
   120     BLOCK CONTAINS 0 RECORDS
   121     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   122 01  PRT.                                                         ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS036.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
   123     12  P-CTL               PIC  X.                                 CL**2
   124     12  P-DATA              PIC  X(132).                         ELCPRTFD
   125******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS036.cbl
   127 FD  DISK-DATE
*  128     COPY ELCDTEFD.
   129******************************************************************04/15/98
   130*                                                                *ELCDTEFD
   131*                                                                *ELCDTEFD
   132*                            ELCDTEFD.                           *   LV002
   133*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   134*                            VMOD=2.007                          *   CL**2
   135*                                                                *ELCDTEFD
   136******************************************************************ELCDTEFD
   137     BLOCK CONTAINS 0 RECORDS
   138     RECORDING MODE F.                                            ELCDTEFD
   139                                                                  ELCDTEFD
   140 01  DATE-DISK.                                                   ELCDTEFD
   141     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   142     12  FILLER                      PIC  X(14).                  ELCDTEFD
   143     12  DD-CR1                      PIC  9.                      ELCDTEFD
   144     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   145     12  DD-CR2                      PIC  9.                      ELCDTEFD
   146     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   147     12  FILLER                      PIC  X(20).                  ELCDTEFD
   148                                                                  ELCDTEFD
   149 01  DATE-DISK-R.                                                 ELCDTEFD
   150     12  FILLER                      PIC  X(4).                   ELCDTEFD
   151     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   152                                     PIC  X(32).                  ELCDTEFD
   153                                                                  ELCDTEFD
   154 01  DATE-DISK-T.                                                 ELCDTEFD
   155     12  FILLER                      PIC  X(4).                   ELCDTEFD
   156     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   157                                     PIC  X(48).                  ELCDTEFD
   158                                                                  ELCDTEFD
   159 01  DATE-DISK-M.                                                 ELCDTEFD
   160     12  FILLER                      PIC  X(4).                   ELCDTEFD
   161     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   162                                     PIC  X(48).                  ELCDTEFD
   163                                                                  ELCDTEFD
   164 01  DATE-DISK-P.                                                 ELCDTEFD
   165     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   166     12  DD-IDX                      PIC  99.                     ELCDTEFD
   167     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   168     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   169         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   170                                     PIC  X.                      ELCDTEFD
   171         16  FILLER                  PIC  X(46).                  ELCDTEFD
   172     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   173         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   174             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   175             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   176             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   177             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   178         16  FILLER                  PIC  X(16).                  ELCDTEFD
   179                                                                  ELCDTEFD
   180 01  DATE-DISK-E.                                                 ELCDTEFD
   181     12  FILLER                      PIC  X(4).                   ELCDTEFD
   182     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   183                                     PIC  X(4).                   ELCDTEFD
   184                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   185 01  DATE-DISK-C.                                                 ELCDTEFD
   186     12  FILLER                      PIC  X(7).                   ELCDTEFD
   187     12  DD-CARR1-SECPAY-SW          PIC  X.
   188     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   189     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   190     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   191     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   192     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   193     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   194     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   195     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   196     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   197     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   198     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   199     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   200     12  DD-CARR2-SECPAY-SW          PIC  X.
   201     12  FILLER                      PIC  X(7).                   ELCDTEFD
   202                                                                  ELCDTEFD
   203 01  DATE-DISK-OPT.                                               ELCDTEFD
   204     12  FILLER                      PIC  X(04).                  ELCDTEFD
   205     12  DD-TLR-DATA.                                             ELCDTEFD
   206         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   207                                     PIC  X(03).                  ELCDTEFD
   208     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   209         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   210                                     PIC  X(06).                  ELCDTEFD
   211     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   212         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   213                                     PIC  X(07).                  ELCDTEFD
   214         16  FILLER                  PIC  X(05).                  ELCDTEFD
   215     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   216                                     PIC  X(96).                  ELCDTEFD
   217******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS036.cbl
   219 FD  FICH
*  220     COPY ELCFCHFD.
   221******************************************************************04/15/98
   222*                                                                *ELCFCHFD
   223*                            ELCFCHFD.                           *   LV003
   224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   225*                            VMOD=2.004                          *   CL**3
   226*                                                                *ELCFCHFD
   227******************************************************************ELCFCHFD
   228     BLOCK CONTAINS 0 RECORDS
   229     RECORDING MODE F.                                            ELCFCHFD
   230                                                                  ELCFCHFD
   231 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   232******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS036.cbl
   234 WORKING-STORAGE SECTION.
   235 77  FILLER  PIC X(32) VALUE '********************************'.
   236 77  FILLER  PIC X(32) VALUE '     ECS036 WORKING STORAGE     '.
   237 77  FILLER  PIC X(32) VALUE '******* VMOD=2.014 *************'.
   238
   239 77  SAVE-NAME                   PIC X(07)           VALUE SPACE.
   240 77  PRINT-SELECT-SW             PIC X(03)           VALUE 'NO '.
   241 77  CC-SW                       PIC X               VALUE SPACE.
   242 77  STATE-TOTAL-LINE            PIC X(30)           VALUE SPACE.
   243 77  SAVE-STATE                  PIC XX              VALUE SPACE.
   244 77  SKIP-HD-SW                  PIC X               VALUE SPACE.
   245 77  PASS-NUMBER                 PIC X               VALUE '1'.
   246 77  FIRST-TIME-SWITCH           PIC X               VALUE 'Y'.
   247     88  FIRST-TIME                                  VALUE 'Y'.
   248 77  LINE-CNT                    PIC S999  COMP-3    VALUE ZEROS.
   249 77  PAGE-CNT                    PIC S9(5) COMP-3    VALUE ZEROS.
   250 77  PGM-SUB                     PIC S999  COMP      VALUE +036.
   251 77  X                           PIC X.
   252 77  X1                          PIC S999  COMP      VALUE ZERO.
   253 77  DISP-X1                     PIC 999             VALUE ZEROS.
   254 77  Y1                          PIC S999  COMP      VALUE ZERO.
   255 77  EOF-EPX                     PIC X               VALUE SPACE.
   256 77  WRITE-AC-SW                 PIC X               VALUE SPACE.
   257 77  ST-SUB                      PIC 99              VALUE ZEROS.
   258 77  DT-SUB                      PIC S99   COMP      VALUE ZEROS.
   259 77  WORK-BUSC                   PIC XX.
   260 77  SET-CTR                     PIC S999  COMP-3    VALUE ZERO.
   261
   262 01  QTR-SW                      PIC X               VALUE SPACE.
   263     88  QTR-END                                     VALUE '1'.
   264
   265 01  QTR-COMP                    PIC X               VALUE SPACE.
   266     88  QTR-CO                                      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS036.cbl
   268 01  WS-EXTR-REC.
   269     05  EP-PASS-NO              PIC X.
   270     05  EP-CNTL.
   271         10  EP-CNTL-1.
   272             15  EP-CNTL-GA      PIC X(10).
   273             15  EP-CNTL-ACCT    PIC X(10).
   274         10  EP-CNTL-2.
   275             15  EP-CARR         PIC X.
   276             15  EP-GROUP        PIC X(6).
   277         10  FILLER              PIC X(12).
   278     05  EP-ALT-RPT-CNTL  REDEFINES  EP-CNTL.
   279         10  EP-A-RPT-CD-1       PIC X(10).
   280         10  EP-A-CARR           PIC X.
   281         10  EP-A-GROUP          PIC X(6).
   282         10  EP-A-RPT-CD-2       PIC X(10).
   283         10  EP-A-STATE          PIC XX.
   284         10  EP-A-ACCT           PIC X(10).
   285     05  EP-DTE                  PIC 9(07)  COMP-3.
   286     05  EP-CNTRS    COMP-3.
   287         10  EP-CERT             PIC S9(11)V99.
   288         10  EP-LBEN             PIC S9(11)V99.
   289         10  EP-LPRM             PIC S9(11)V99.
   290         10  EP-LCLM             PIC S9(11)V99.
   291         10  EP-ABEN             PIC S9(11)V99.
   292         10  EP-APRM             PIC S9(11)V99.
   293         10  EP-ACLM             PIC S9(11)V99.
   294         10  EP-TPRM             PIC S9(11)V99.
   295         10  EP-TCOM             PIC S9(11)V99.
   296     05  FILLER                  PIC X(4).
   297     05  EP-ACCT-STATUS          PIC X.
   298     05  EP-ACCT-NAME            PIC X(30).
   299     05  EP-ACC-EXPIRES          PIC 9(11)  COMP-3.
   300     05  EP-ACC-HI-CERT          PIC 9(11)  COMP-3.
   301     05  EP-MTH-HI-CERT          PIC 9(11)  COMP-3.
   302     05  EP-ISS-CNT              PIC S9(9) COMP-3.
   303     05  FILLER                  PIC X.
   304     05  EP-ACCT-CITY            PIC X(30).
   305
   306 01  PRINT-SWITCHES.
   307     05  P-ACC-SW                PIC X VALUE ' '.
   308     05  P-ST-SW                 PIC X VALUE ' '.
   309     05  P-GP-SW                 PIC X VALUE ' '.
   310     05  P-CA-SW                 PIC X VALUE ' '.
   311     05  P-RP-SW                 PIC X VALUE ' '.
   312     05  P-RP2-SW                PIC X VALUE ' '.
   313
   314 01  RUN-DT.
   315     05  RUN-DT-CCYY             PIC 9(04) VALUE ZEROS.
   316     05  RUN-DT-CCYR REDEFINES RUN-DT-CCYY.
   317         10  RUN-DT-CC           PIC 99.
   318         10  RUN-DT-YR           PIC 99.
   319     05  RUN-DT-MO               PIC 99  VALUE ZEROS.
   320
   321 01  RUN9DT REDEFINES RUN-DT     PIC 9(6).
   322
   323 01  WORK-ACCUM.
   324     05  CERT                    PIC S9(11)    COMP-3 VALUE ZEROS.
   325     05  ISS                     PIC S9(9)     COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS036.cbl
   326     05  LBEN                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   327     05  LPRM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   328     05  LCLM                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   329     05  ABEN                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   330     05  APRM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   331     05  ACLM                    PIC S9(12)V99 COMP-3 VALUE ZEROS.
   332     05  TPRM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   333     05  TCOM                    PIC S9(11)V99 COMP-3 VALUE ZEROS.
   334
   335 01  REPT-ACCUM.
   336     05  RPCERT                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   337     05  RPLBEN                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   338     05  RPLPRM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   339     05  RPLCLM                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   340     05  RPABEN                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   341     05  RPAPRM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   342     05  RPACLM                  PIC S9(12)V99 COMP-3 VALUE ZEROS.
   343     05  RPTPRM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   344     05  RPTCOM                  PIC S9(11)V99 COMP-3 VALUE ZEROS.
   345
   346 01  REPT2-ACCUM.
   347     05  RP2CERT                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   348     05  RP2LBEN                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   349     05  RP2LPRM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   350     05  RP2LCLM                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   351     05  RP2ABEN                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   352     05  RP2APRM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   353     05  RP2ACLM                 PIC S9(12)V99 COMP-3 VALUE ZEROS.
   354     05  RP2TPRM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
   355     05  RP2TCOM                 PIC S9(11)V99 COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS036.cbl
   357 01  HD-1-STATE.
   358     05  FILLER                  PIC X(46)   VALUE SPACES.
   359     05  HD-1-ST                 PIC X(10)   VALUE ' MONTHLY'.
   360     05  FILLER                  PIC X(6)    VALUE 'STATE '.
   361     05  FILLER                  PIC X(17)
   362                                 VALUE 'PRODUCTION REPORT'.
   363     05  FILLER                  PIC X(05)   VALUE SPACES.
   364     05  HD-1-ST-SINGLE-FEE      PIC X(21)   VALUE SPACES.
   365     05  FILLER                  PIC X(14)   VALUE SPACES.
   366     05  FILLER                  PIC X(7)    VALUE 'ECS036A'.
   367
   368 01  HD-1-BUSINESS.
   369     05  FILLER                  PIC X(44)   VALUE SPACES.
   370     05  HD-1-BUS                PIC X(10)   VALUE ' MONTHLY'.
   371     05  FILLER                  PIC X(9)    VALUE 'BUSINESS'.
   372     05  FILLER                  PIC X(17)
   373                                 VALUE 'PRODUCTION REPORT'.
   374     05  FILLER                  PIC X(05)   VALUE SPACES.
   375     05  HD-1-BUS-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   376     05  FILLER                  PIC X(13)   VALUE SPACES.
   377     05  FILLER                  PIC X(7)    VALUE 'ECS036B'.
   378
   379 01  HD-1-AGENCY.
   380     05  FILLER                  PIC X(45)   VALUE SPACES.
   381     05  HD-1-AGCY               PIC X(10)   VALUE ' MONTHLY'.
   382     05  FILLER                  PIC X(7)    VALUE 'AGENCY'.
   383     05  FILLER                  PIC X(17)
   384                                 VALUE 'PRODUCTION REPORT'.
   385     05  FILLER                  PIC X(05)   VALUE SPACES.
   386     05  HD-1-AGCY-SINGLE-FEE    PIC X(21)   VALUE SPACES.
   387     05  FILLER                  PIC X(14)   VALUE SPACES.
   388     05  FILLER                  PIC X(7)    VALUE 'ECS036C'.
   389
   390 01  HD-1-RPT-CODE-1.
   391     05  HD-1-SLCT-FLD-1         PIC X(11)   VALUE 'RPT CODE 1 '.
   392     05  HD-1-SLCT-FLD-2         PIC X(10)   VALUE SPACES.
   393     05  HD-1-SLCT-REC-POS1      PIC X(01)   VALUE SPACE.
   394     05  FILLER                  PIC X(22)   VALUE SPACES.
   395     05  HD-1-RC-1               PIC X(9)    VALUE ' MONTHLY'.
   396     05  HD-1-RPT-CD-1           PIC X(10)   VALUE SPACES.
   397     05  FILLER                  PIC X(18)
   398                                 VALUE ' PRODUCTION REPORT'.
   399     05  FILLER                  PIC X(05)   VALUE SPACES.
   400     05  HD-1-RC1-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   401     05  FILLER                  PIC X(12)   VALUE SPACES.
   402     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   403     05  HD-1-DF                 PIC X       VALUE 'D'.
   404
   405 01  HD-1-RPT-CODE-2.
   406     05  FILLER                  PIC X(44)   VALUE SPACES.
   407     05  HD-1-RC-2               PIC X(9)    VALUE ' MONTHLY'.
   408     05  HD-1-RPT-CD-2           PIC X(10)   VALUE SPACES.
   409     05  FILLER                  PIC X(18)
   410                                 VALUE ' PRODUCTION REPORT'.
   411     05  FILLER                  PIC X(05)   VALUE SPACES.
   412     05  HD-1-RC2-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   413     05  FILLER                  PIC X(12)   VALUE SPACES.
   414     05  FILLER                  PIC X(7)    VALUE 'ECS036E'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS036.cbl
   415
   416 01  HD-1-CARRIER.
   417     05  FILLER                  PIC X(45)   VALUE SPACES.
   418     05  HD-1-CAR                PIC X(10)   VALUE ' MONTHLY'.
   419     05  FILLER                  PIC X(8)    VALUE 'CARRIER'.
   420     05  FILLER                  PIC X(17)
   421                                 VALUE 'PRODUCTION REPORT'.
   422     05  FILLER                  PIC X(05)   VALUE SPACES.
   423     05  HD-1-CAR-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   424     05  FILLER                  PIC X(13)   VALUE SPACES.
   425     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   426     05  HD-1-CAR-SUF            PIC X       VALUE ' '.
   427
   428 01  HD-1-GROUPING.
   429     05  FILLER                  PIC X(45)   VALUE SPACES.
   430     05  HD-1-GRP                PIC X(8)    VALUE 'MONTHLY'.
   431     05  FILLER                  PIC X(9)    VALUE 'GROUPING'.
   432     05  FILLER                  PIC X(17)
   433                                 VALUE 'PRODUCTION REPORT'.
   434     05  FILLER                  PIC X(05)   VALUE SPACES.
   435     05  HD-1-GRP-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   436     05  FILLER                  PIC X(14)   VALUE SPACES.
   437     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   438     05  HD-1-GRP-SUF            PIC X       VALUE ' '.
   439
   440 01  HD-1-USER-SEL-2.
   441     05  HD-1-US2-FLD-1          PIC X(11)   VALUE 'USER SEL 2 '.
   442     05  HD-1-US2-FLD-2          PIC X(10)   VALUE SPACES.
   443     05  HD-1-US2-REC-POS1       PIC X(01)   VALUE SPACE.
   444     05  FILLER                  PIC X(22)   VALUE SPACES.
   445     05  HD-1-US2                PIC X(9)    VALUE ' MONTHLY'.
   446     05  HD-1-USERSEL2           PIC X(10)   VALUE 'USER SEL 2'.
   447     05  FILLER                  PIC X(18)
   448                                 VALUE ' PRODUCTION REPORT'.
   449     05  FILLER                  PIC X(05)   VALUE SPACES.
   450     05  HD-1-US2-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   451     05  FILLER                  PIC X(12)   VALUE SPACES.
   452     05  FILLER                  PIC X(7)    VALUE 'ECS036F'.
   453
   454 01  HD-1-USER-SEL-5.
   455     05  HD-1-US5-FLD-1          PIC X(11)   VALUE 'USER SEL 5 '.
   456     05  HD-1-US5-FLD-2          PIC X(10)   VALUE SPACES.
   457     05  HD-1-US5-REC-POS1       PIC X(01)   VALUE SPACE.
   458     05  FILLER                  PIC X(22)   VALUE SPACES.
   459     05  HD-1-US5                PIC X(9)    VALUE ' MONTHLY'.
   460     05  HD-1-USERSEL5           PIC X(10)   VALUE 'USER SEL 5'.
   461     05  FILLER                  PIC X(18)
   462                                 VALUE ' PRODUCTION REPORT'.
   463     05  FILLER                  PIC X(05)   VALUE SPACES.
   464     05  HD-1-US5-SINGLE-FEE     PIC X(21)   VALUE SPACES.
   465     05  FILLER                  PIC X(12)   VALUE SPACES.
   466     05  FILLER                  PIC X(7)    VALUE 'ECS036G'.
   467
   468 01  HD-1-GRAND-TOTALS.
   469     05  FILLER                  PIC X(47)   VALUE SPACES.
   470     05  FILLER                  PIC X(17)
   471                                 VALUE 'PRODUCTION REPORT'.
   472     05  FILLER                  PIC X(13)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS036.cbl
   473                                 VALUE ' GRAND TOTALS'.
   474     05  FILLER                  PIC X(05)   VALUE SPACES.
   475     05  HD-1-GT-SINGLE-FEE      PIC X(21)   VALUE SPACES.
   476     05  FILLER                  PIC X(16)   VALUE SPACES.
   477     05  FILLER                  PIC X(6)    VALUE 'ECS036'.
   478     05  HD-1-GT                 PIC X.
   479
   480 01  HD-2.
   481     05  HD-2-SLCT-FLD-1         PIC X(11)   VALUE SPACES.
   482     05  HD-2-SLCT-FLD-2         PIC X(10)   VALUE SPACES.
   483     05  HD-2-SLCT-REC-POS1      PIC X(01)   VALUE SPACE.
   484     05  FILLER                  PIC X(25)   VALUE SPACES.
   485     05  HD-COMPANY-NAME         PIC X(30)   VALUE SPACES.
   486     05  FILLER                  PIC X(42)   VALUE SPACES.
   487     05  HD-IPL-DATE             PIC X(8)    VALUE SPACES.
   488
   489 01  HD-3.
   490     05  HD-3-SLCT-FLD-1         PIC X(11)   VALUE SPACES.
   491     05  HD-3-SLCT-FLD-2         PIC X(10)   VALUE SPACES.
   492     05  HD-3-SLCT-REC-POS1      PIC X(01)   VALUE SPACE.
   493     05  FILLER                  PIC X(31)   VALUE SPACES.
   494     05  HD-ALPHA-DATE           PIC X(18)   VALUE SPACES.
   495     05  FILLER                  PIC X(48)   VALUE SPACES.
   496     05  FILLER                  PIC X(5)    VALUE 'PAGE '.
   497     05  HD-PAGE                 PIC ZZ,ZZ9.
   498
   499 01  HD-4.
   500     05  FILLER                  PIC X(8)    VALUE 'CARRIER'.
   501     05  HD-4-CARRIER            PIC X       VALUE SPACES.
   502     05  FILLER-HD-4             PIC X(10)   VALUE ' GROUPING'.
   503     05  HD-4-GROUPING           PIC X(6)    VALUE SPACES.
   504
   505 01  HD-4G.
   506     05  FILLER                  PIC X(10)   VALUE 'REPT CD 1'.
   507     05  HD-4G-REPT-CD-2         PIC X(10)   VALUE SPACES.
   508
   509 01  HD-5.
   510     05  FILLER                  PIC X(8)    VALUE 'ACCOUNT'.
   511     05  HD-ACCOUNT              PIC X(10)   VALUE SPACES.
   512     05  FILLER                  PIC XX      VALUE SPACES.
   513*    05  HD-ACCT-NAME            PIC X(20)   VALUE SPACES.
   514     05  HD-ACCT-NAME            PIC X(30)   VALUE SPACES.
   515     05  FILLER                  PIC X(6)    VALUE SPACES.
   516*    05  HD-ACCT-ADDRESS         PIC X(20)   VALUE SPACES.
   517     05  HD-ACCT-ADDRESS         PIC X(30)   VALUE SPACES.
   518
   519 01  HD-5A.
   520     05  FILLER                  PIC X(8)    VALUE 'CITY   '.
   521     05  FILLER                  PIC X(12)   VALUE SPACES.
   522     05  HD-5A-CITY              PIC X(30)   VALUE SPACES.
   523     05  FILLER                  PIC X(26)   VALUE SPACES.
   524
   525 01  HD-6.
   526     05  FILLER-HD-6.
   527       07  FILLER-HD-6-1         PIC X(6)    VALUE 'STATE'.
   528       07  FILLER-HD-6-2         PIC X(8)    VALUE SPACES.
   529     05  HD-6-NSTATE             PIC XX      VALUE SPACES.
   530     05  FILLER                  PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS036.cbl
   531     05  HD-STATE                PIC X(30)   VALUE SPACES.
   532     05  FILLER                  PIC X(92)   VALUE SPACES.
   533
   534 01  HD-7.
   535     05  FILLER-HD-7             PIC X(20)   VALUE SPACES.
   536     05  HD-7-DESC               PIC X(10)   VALUE SPACES.
   537     05  FILLER-HD-7A            PIC X(13)   VALUE SPACES.
   538     05  HD-CARRIER              PIC X       VALUE SPACES.
   539
   540 01  HD-8.
   541     05  FILLER                  PIC X(132)
   542                                 VALUE 'GRAND TOTALS'.
   543
   544 01  HD-8A.
   545     05  HD-8A-RPT-CD-1-CAPTION  PIC X(10)   VALUE SPACES.
   546     05  FILLER                  PIC X       VALUE SPACES.
   547     05  HD-8A-RPT-CODE-1        PIC X(10)   VALUE SPACES.
   548     05  FILLER                  PIC X(111)  VALUE SPACES.
   549
   550 01  HD-8B.
   551     05  HD-8B-RPT-CD-2-CAPTION  PIC X(10)   VALUE SPACES.
   552     05  FILLER                  PIC X       VALUE SPACES.
   553     05  HD-8B-RPT-CODE-2        PIC X(10)   VALUE SPACES.
   554     05  FILLER                  PIC X(111)  VALUE SPACES.
   555
   556 01  HD-8C.
   557     05  HD-8C-US2-CAPTION       PIC X(10)   VALUE 'USER SEL 2'.
   558     05  FILLER                  PIC X       VALUE SPACES.
   559     05  HD-8C-USER-SEL-2        PIC X(10)   VALUE SPACES.
   560     05  FILLER                  PIC X(111)  VALUE SPACES.
   561
   562 01  HD-8D.
   563     05  HD-8D-US5-CAPTION       PIC X(10)   VALUE 'USER SEL 5'.
   564     05  FILLER                  PIC X       VALUE SPACES.
   565     05  HD-8D-USER-SEL-5        PIC X(10)   VALUE SPACES.
   566     05  FILLER                  PIC X(111)  VALUE SPACES.
   567
   568 01  HD-9.
   569     05  HD-9-1          PIC X(20)   VALUE '               NET  '.
   570     05  FILLER          PIC X(5)    VALUE SPACES.
   571     05  HD-9-LF-OVRD-1  PIC X(6).
   572     05  FILLER          PIC X(8)    VALUE SPACES.
   573     05  HD-9-LF-OVRD-2  PIC X(6).
   574     05  FILLER          PIC X(9)    VALUE SPACES.
   575     05  HD-9-LF-OVRD-3  PIC X(6).
   576     05  FILLER          PIC X(8)    VALUE SPACES.
   577     05  HD-9-AH-OVRD-1  PIC X(6).
   578     05  FILLER          PIC X(8)    VALUE SPACES.
   579     05  HD-9-AH-OVRD-2  PIC X(6).
   580     05  FILLER          PIC X(9)    VALUE SPACES.
   581     05  HD-9-AH-OVRD-3  PIC X(6).
   582     05  FILLER          PIC X(9)    VALUE SPACES.
   583     05  FILLER          PIC X(20)   VALUE 'TOTAL        TOTAL  '.
   584
   585 01  HD-10.
   586     05  HD-10-1         PIC X(21)  VALUE '             ACTIVITY'.
   587     05  FILLER          PIC X(19)   VALUE '   BENEFITS       P'.
   588     05  FILLER          PIC X(20)   VALUE 'REMIUM        CLAIMS'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS036.cbl
   589     05  FILLER          PIC X(20)   VALUE '       BENEFITS     '.
   590     05  FILLER          PIC X(20)   VALUE '  PREMIUM        CLA'.
   591     05  FILLER          PIC X(20)   VALUE 'IMS        PREMIUM  '.
   592     05  FILLER          PIC X(12)   VALUE '  COMMISSION'.
   593
   594 01  HD-9-A.
   595     12  HD-9-A-1        PIC X(34)   VALUE
   596             '       HI-CERT    CERT        NET '.
   597     12  FILLER          PIC X(6)    VALUE SPACES.
   598     12  HD-9A-LF-OVRD-1 PIC X(6).
   599     12  FILLER          PIC X(8)    VALUE SPACES.
   600     12  HD-9A-LF-OVRD-2 PIC X(6).
   601     12  FILLER          PIC X(9)    VALUE SPACES.
   602     12  HD-9A-LF-OVRD-3 PIC X(6).
   603     12  FILLER          PIC X(7)    VALUE SPACES.
   604     12  HD-9A-AH-OVRD-1 PIC X(6).
   605     12  FILLER          PIC X(9)    VALUE SPACES.
   606     12  HD-9A-AH-OVRD-2 PIC X(6).
   607     12  FILLER          PIC X(29)   VALUE
   608             '        TOTAL         TOTAL  '.
   609
   610 01  HD-10-A.
   611     12  HD-10-A-1       PIC X(36)   VALUE
   612             '         DATE    COUNT      ACTIVITY'.
   613     12  FILLER          PIC X(8)   VALUE
   614             '   BENEF'.
   615     12  FILLER          PIC X(44)   VALUE
   616             'ITS       PREMIUM        CLAIMS       PREMIU'.
   617     12  FILLER          PIC X(44)   VALUE
   618             'M        CLAIMS        PREMIUM    COMMISSION'.
   619
   620 01  DETAIL-LINE.
   621     05  DET-TITLE.
   622         10  DET-DATE.
   623             15  DET-MO          PIC XXX     VALUE SPACES.
   624             15  FILLER          PIC X       VALUE SPACES.
   625             15  DET-YR          PIC XX      VALUE SPACES.
   626             15  FILLER          PIC X       VALUE SPACES.
   627         10  DET-CERTS           PIC ZZZ,ZZZ,Z99-.
   628     05  DET-LBEN                PIC ZZZZZ,ZZZ,Z99-.
   629     05  DET-LPRM                PIC ZZ,ZZZ,ZZ9.99-.
   630     05  DET-LCLM                PIC ZZ,ZZZ,ZZ9.99-.
   631     05  DET-ABEN                PIC ZZZZZZ,ZZZ,Z99-.
   632     05  DET-APRM                PIC ZZ,ZZZ,ZZ9.99-.
   633     05  DET-ACLM                PIC ZZ,ZZZ,ZZ9.99-.
   634     05  DET-TPRM                PIC ZZZ,ZZZ,ZZ9.99-.
   635     05  DET-TCOM                PIC ZZZZZ,ZZ9.99-.
   636
   637 01  DETAIL-LINE-2.
   638     12  DET-TITLE-2.
   639         16  DET-DATE-2.
   640             20  DET-MO-2        PIC XXX     VALUE SPACES.
   641             20  FILLER          PIC X       VALUE SPACES.
   642             20  DET-YR-2        PIC XX      VALUE SPACES.
   643             20  FILLER          PIC X(2)    VALUE SPACES.
   644         16  DET-HIGH-CERT.
   645             20  DET-HI-MO       PIC XX.
   646             20  DET-HI-SLASH    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS036.cbl
   647             20  DET-HI-YR       PIC XX.
   648             20  FILLER          PIC X(1)    VALUE SPACES.
   649         16  DET-FILL REDEFINES
   650             DET-HIGH-CERT       PIC X(6).
   651         16  DET-ISS-COUNT-2     PIC ZZZZZ99-.
   652         16  DET-CERTS-2         PIC ZZZ,ZZZ,Z99-.
   653     12  DET-LBEN-2              PIC ZZZZZ,ZZZ,Z99-.
   654     12  DET-LPRM-2              PIC ZZ,ZZZ,ZZ9.99-.
   655     12  DET-LCLM-2              PIC ZZ,ZZZ,ZZ9.99-.
   656     12  DET-APRM-2              PIC ZZ,ZZZ,ZZ9.99-.
   657     12  DET-ACLM-2              PIC ZZ,ZZZ,ZZ9.99-.
   658     12  DET-TPRM-2              PIC ZZZ,ZZZ,ZZ9.99-.
   659     12  DET-TCOM-2              PIC ZZZZZ,ZZ9.99-.
   660
   661 01  DET-DATE-LINE.
   662     12  DET-DATE-DESC           PIC X(17)   VALUE SPACES.
   663     12  DET-DATE-MO             PIC XX.
   664     12  DET-DATE-SLASH-1        PIC X       VALUE '/'.
   665     12  DET-DATE-DA             PIC XX.
   666     12  DET-DATE-SLASH-2        PIC X       VALUE '/'.
   667     12  DET-DATE-YR             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS036.cbl
   669 01  ACCUMULATORS.
   670*    12  ACCOUNT-ACCUM    OCCURS 13 TIMES.
   671     12  ACCOUNT-ACCUM    OCCURS 15 TIMES.
   672         16  AC-CERT             PIC S9(9)         COMP-3.
   673         16  AC-ISS              PIC S9(9)         COMP-3.
   674         16  AC-LBEN             PIC S9(11)V99     COMP-3.
   675         16  AC-LPRM             PIC S9(9)V99      COMP-3.
   676         16  AC-LCLM             PIC S9(9)V99      COMP-3.
   677         16  AC-ABEN             PIC S9(9)V99      COMP-3.
   678         16  AC-APRM             PIC S9(9)V99      COMP-3.
   679         16  AC-ACLM             PIC S9(9)V99      COMP-3.
   680         16  AC-TPRM             PIC S9(9)V99      COMP-3.
   681         16  AC-TCOM             PIC S9(9)V99      COMP-3.
   682         16  AC-DATE             PIC 9(11) COMP-3 VALUE 0.
   683         16  AC-DATE-R.
   684             20  FILLER          PIC 999.
   685             20  AC-DATE-CC      PIC 99.
   686             20  AC-DATE-YR      PIC 99.
   687             20  AC-DATE-MO      PIC 99.
   688             20  AC-DATE-DA      PIC 99.
   689*    12  GROUPING-ACCUM   OCCURS 13 TIMES.
   690     12  GROUPING-ACCUM   OCCURS 15 TIMES.
   691         16  GP-CERT             PIC S9(9)         COMP-3.
   692         16  GP-ISS              PIC S9(9)         COMP-3.
   693         16  GP-LBEN             PIC S9(11)V99     COMP-3.
   694         16  GP-LPRM             PIC S9(9)V99      COMP-3.
   695         16  GP-LCLM             PIC S9(9)V99      COMP-3.
   696         16  GP-ABEN             PIC S9(9)V99      COMP-3.
   697         16  GP-APRM             PIC S9(9)V99      COMP-3.
   698         16  GP-ACLM             PIC S9(9)V99      COMP-3.
   699         16  GP-TPRM             PIC S9(9)V99      COMP-3.
   700         16  GP-TCOM             PIC S9(9)V99      COMP-3.
   701         16  GP-DATE             PIC 9(11) COMP-3 VALUE 0.
   702         16  GP-DATE-R.
   703             20  FILLER          PIC 999.
   704             20  GP-DATE-CC      PIC 99.
   705             20  GP-DATE-YR      PIC 99.
   706             20  GP-DATE-MO      PIC 99.
   707             20  GP-DATE-DA      PIC 99.
   708*    12  CARRIER-ACCUM    OCCURS 13 TIMES.
   709     12  CARRIER-ACCUM    OCCURS 15 TIMES.
   710         16  CA-CERT             PIC S9(9)         COMP-3.
   711         16  CA-ISS              PIC S9(9)         COMP-3.
   712         16  CA-LBEN             PIC S9(11)V99     COMP-3.
   713         16  CA-LPRM             PIC S9(9)V99      COMP-3.
   714         16  CA-LCLM             PIC S9(9)V99      COMP-3.
   715         16  CA-ABEN             PIC S9(9)V99      COMP-3.
   716         16  CA-APRM             PIC S9(9)V99      COMP-3.
   717         16  CA-ACLM             PIC S9(9)V99      COMP-3.
   718         16  CA-TPRM             PIC S9(9)V99      COMP-3.
   719         16  CA-TCOM             PIC S9(9)V99      COMP-3.
   720         16  CA-DATE             PIC 9(11) COMP-3 VALUE 0.
   721         16  CA-DATE-R.
   722             20  FILLER          PIC 999.
   723             20  CA-DATE-CC      PIC 99.
   724             20  CA-DATE-YR      PIC 99.
   725             20  CA-DATE-MO      PIC 99.
   726             20  CA-DATE-DA      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS036.cbl
   727*    12  STATE-ACCUM      OCCURS 13 TIMES.
   728     12  STATE-ACCUM      OCCURS 15 TIMES.
   729         16  ST-CERT             PIC S9(9)         COMP-3.
   730         16  ST-ISS              PIC S9(9)         COMP-3.
   731         16  ST-LBEN             PIC S9(11)V99     COMP-3.
   732         16  ST-LPRM             PIC S9(9)V99      COMP-3.
   733         16  ST-LCLM             PIC S9(9)V99      COMP-3.
   734         16  ST-ABEN             PIC S9(9)V99      COMP-3.
   735         16  ST-APRM             PIC S9(9)V99      COMP-3.
   736         16  ST-ACLM             PIC S9(9)V99      COMP-3.
   737         16  ST-TPRM             PIC S9(9)V99      COMP-3.
   738         16  ST-TCOM             PIC S9(9)V99      COMP-3.
   739         16  ST-DATE             PIC X(6).
   740*    12  REPTCD-ACCUM     OCCURS 13 TIMES.
   741     12  REPTCD-ACCUM     OCCURS 15 TIMES.
   742         16  RP-CERT             PIC S9(9)         COMP-3.
   743         16  RP-ISS              PIC S9(9)         COMP-3.
   744         16  RP-LBEN             PIC S9(11)V99     COMP-3.
   745         16  RP-LPRM             PIC S9(9)V99      COMP-3.
   746         16  RP-LCLM             PIC S9(9)V99      COMP-3.
   747         16  RP-ABEN             PIC S9(9)V99      COMP-3.
   748         16  RP-APRM             PIC S9(9)V99      COMP-3.
   749         16  RP-ACLM             PIC S9(9)V99      COMP-3.
   750         16  RP-TPRM             PIC S9(9)V99      COMP-3.
   751         16  RP-TCOM             PIC S9(9)V99      COMP-3.
   752         16  RP-DATE             PIC 9(11) COMP-3 VALUE 0.
   753         16  RP-DATE-R.
   754             20  FILLER          PIC 999.
   755             20  RP-DATE-CC      PIC 99.
   756             20  RP-DATE-YR      PIC 99.
   757             20  RP-DATE-MO      PIC 99.
   758             20  RP-DATE-DA      PIC 99.
   759     12  REPTCD2-ACCUM     OCCURS 15 TIMES.
   760         16  RP2-CERT             PIC S9(9)         COMP-3.
   761         16  RP2-ISS              PIC S9(9)         COMP-3.
   762         16  RP2-LBEN             PIC S9(11)V99     COMP-3.
   763         16  RP2-LPRM             PIC S9(9)V99      COMP-3.
   764         16  RP2-LCLM             PIC S9(9)V99      COMP-3.
   765         16  RP2-ABEN             PIC S9(9)V99      COMP-3.
   766         16  RP2-APRM             PIC S9(9)V99      COMP-3.
   767         16  RP2-ACLM             PIC S9(9)V99      COMP-3.
   768         16  RP2-TPRM             PIC S9(9)V99      COMP-3.
   769         16  RP2-TCOM             PIC S9(9)V99      COMP-3.
   770         16  RP2-DATE             PIC 9(11) COMP-3 VALUE 0.
   771         16  RP2-DATE-R.
   772             20  FILLER          PIC 999.
   773             20  RP2-DATE-CC      PIC 99.
   774             20  RP2-DATE-YR      PIC 99.
   775             20  RP2-DATE-MO      PIC 99.
   776             20  RP2-DATE-DA      PIC 99.
   777     12  GRAND-TOTALS.
   778         16  GR-CERT             PIC S9(9)       COMP-3 VALUE +0.
   779         16  GR-ISS              PIC S9(9)       COMP-3 VALUE +0.
   780         16  GR-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   781         16  GR-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   782         16  GR-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   783         16  GR-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   784         16  GR-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS036.cbl
   785         16  GR-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   786         16  GR-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   787         16  GR-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   788*    12  GRAND-ACCUM      OCCURS 13 TIMES.
   789     12  GRAND-ACCUM      OCCURS 15 TIMES.
   790         16  GT-CERT             PIC S9(9)         COMP-3.
   791         16  GT-ISS              PIC S9(9)         COMP-3.
   792         16  GT-LBEN             PIC S9(11)V99     COMP-3.
   793         16  GT-LPRM             PIC S9(9)V99      COMP-3.
   794         16  GT-LCLM             PIC S9(9)V99      COMP-3.
   795         16  GT-ABEN             PIC S9(9)V99      COMP-3.
   796         16  GT-APRM             PIC S9(9)V99      COMP-3.
   797         16  GT-ACLM             PIC S9(9)V99      COMP-3.
   798         16  GT-TPRM             PIC S9(9)V99      COMP-3.
   799         16  GT-TCOM             PIC S9(9)V99      COMP-3.
   800         16  GT-DATE             PIC 9(11) COMP-3 VALUE 0.
   801         16  GT-DATE-R.
   802             20  FILLER          PIC 999.
   803             20  GT-DATE-CC      PIC 99.
   804             20  GT-DATE-YR      PIC 99.
   805             20  GT-DATE-MO      PIC 99.
   806             20  GT-DATE-DA      PIC 99.
   807     12  LAST-12-ACCOUNT-ACCUM.
   808         16  L12AC-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   809         16  L12AC-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   810         16  L12AC-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   811         16  L12AC-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   812         16  L12AC-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   813         16  L12AC-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   814         16  L12AC-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   815         16  L12AC-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   816     12  YTD-ACCOUNT-ACCUM.
   817         16  YTDAC-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   818         16  YTDAC-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   819         16  YTDAC-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   820         16  YTDAC-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   821         16  YTDAC-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   822         16  YTDAC-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   823         16  YTDAC-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   824         16  YTDAC-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   825     12  LAST-12-GROUPING-ACCUM.
   826         16  L12GP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   827         16  L12GP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   828         16  L12GP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   829         16  L12GP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   830         16  L12GP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   831         16  L12GP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   832         16  L12GP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   833         16  L12GP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   834     12  LAST-12-CARRIER-ACCUM.
   835         16  L12CA-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   836         16  L12CA-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   837         16  L12CA-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   838         16  L12CA-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   839         16  L12CA-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   840         16  L12CA-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   841         16  L12CA-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   842         16  L12CA-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS036.cbl
   843     12  LAST-12-STATE-ACCUM.
   844         16  L12ST-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   845         16  L12ST-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   846         16  L12ST-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   847         16  L12ST-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   848         16  L12ST-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   849         16  L12ST-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   850         16  L12ST-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   851         16  L12ST-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   852     12  LAST-12-REPTCD-ACCUM.
   853         16  L12RP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   854         16  L12RP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   855         16  L12RP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   856         16  L12RP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   857         16  L12RP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   858         16  L12RP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   859         16  L12RP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   860         16  L12RP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   861     12  LAST-12-REPTCD2-ACCUM.
   862         16  L12RP2-LBEN         PIC S9(11)V99   COMP-3 VALUE +0.
   863         16  L12RP2-LPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   864         16  L12RP2-LCLM         PIC S9(9)V99    COMP-3 VALUE +0.
   865         16  L12RP2-ABEN         PIC S9(9)V99    COMP-3 VALUE +0.
   866         16  L12RP2-APRM         PIC S9(9)V99    COMP-3 VALUE +0.
   867         16  L12RP2-ACLM         PIC S9(9)V99    COMP-3 VALUE +0.
   868         16  L12RP2-TPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   869         16  L12RP2-TCOM         PIC S9(9)V99    COMP-3 VALUE +0.
   870     12  LAST-12-GRAND-ACCUM.
   871         16  L12GT-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   872         16  L12GT-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   873         16  L12GT-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   874         16  L12GT-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   875         16  L12GT-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   876         16  L12GT-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   877         16  L12GT-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   878         16  L12GT-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   879     12  YTD-GROUPING-ACCUM.
   880         16  YTDGP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   881         16  YTDGP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   882         16  YTDGP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   883         16  YTDGP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   884         16  YTDGP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   885         16  YTDGP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   886         16  YTDGP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   887         16  YTDGP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   888     12  YTD-CARRIER-ACCUM.
   889         16  YTDCA-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   890         16  YTDCA-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   891         16  YTDCA-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   892         16  YTDCA-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   893         16  YTDCA-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   894         16  YTDCA-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   895         16  YTDCA-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   896         16  YTDCA-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   897     12  YTD-STATE-ACCUM.
   898         16  YTDST-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   899         16  YTDST-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   900         16  YTDST-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS036.cbl
   901         16  YTDST-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   902         16  YTDST-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   903         16  YTDST-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   904         16  YTDST-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   905         16  YTDST-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   906     12  YTD-REPTCD-ACCUM.
   907         16  YTDRP-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   908         16  YTDRP-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   909         16  YTDRP-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   910         16  YTDRP-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   911         16  YTDRP-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   912         16  YTDRP-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   913         16  YTDRP-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   914         16  YTDRP-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   915     12  YTD-REPTCD2-ACCUM.
   916         16  YTDRP2-LBEN         PIC S9(11)V99   COMP-3 VALUE +0.
   917         16  YTDRP2-LPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   918         16  YTDRP2-LCLM         PIC S9(9)V99    COMP-3 VALUE +0.
   919         16  YTDRP2-ABEN         PIC S9(9)V99    COMP-3 VALUE +0.
   920         16  YTDRP2-APRM         PIC S9(9)V99    COMP-3 VALUE +0.
   921         16  YTDRP2-ACLM         PIC S9(9)V99    COMP-3 VALUE +0.
   922         16  YTDRP2-TPRM         PIC S9(9)V99    COMP-3 VALUE +0.
   923         16  YTDRP2-TCOM         PIC S9(9)V99    COMP-3 VALUE +0.
   924     12  YTD-GRAND-ACCUM.
   925         16  YTDGT-LBEN          PIC S9(11)V99   COMP-3 VALUE +0.
   926         16  YTDGT-LPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   927         16  YTDGT-LCLM          PIC S9(9)V99    COMP-3 VALUE +0.
   928         16  YTDGT-ABEN          PIC S9(9)V99    COMP-3 VALUE +0.
   929         16  YTDGT-APRM          PIC S9(9)V99    COMP-3 VALUE +0.
   930         16  YTDGT-ACLM          PIC S9(9)V99    COMP-3 VALUE +0.
   931         16  YTDGT-TPRM          PIC S9(9)V99    COMP-3 VALUE +0.
   932         16  YTDGT-TCOM          PIC S9(9)V99    COMP-3 VALUE +0.
   933     12  ZERO-OCCURS-ACCUM.
   934         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   935         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   936         16  FILLER              PIC S9(11)V99  COMP-3  VALUE +0.
   937         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   938         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   939         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   940         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   941         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   942         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   943         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   944         16  FILLER              PIC X(6)       VALUE LOW-VALUES.
   945     12  ZERO-ACCUM.
   946         16  FILLER              PIC S9(11)V99  COMP-3  VALUE +0.
   947         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   948         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   949         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   950         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   951         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   952         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   953         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   954     12  ZERO-GRAND-TOTALS.
   955         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   956         16  FILLER              PIC S9(9)      COMP-3  VALUE +0.
   957         16  FILLER              PIC S9(11)V99  COMP-3  VALUE +0.
   958         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS036.cbl
   959         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   960         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   961         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   962         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   963         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   964         16  FILLER              PIC S9(9)V99   COMP-3  VALUE +0.
   965
   966
   967 01  PYTD-ACCOUNT-ACCUM.
   968     12  PYTDAC-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   969     12  PYTDAC-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   970     12  PYTDAC-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   971     12  PYTDAC-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   972     12  PYTDAC-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
   973     12  PYTDAC-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   974     12  PYTDAC-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   975     12  PYTDAC-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   976
   977 01  PYTD-GROUPING-ACCUM.
   978     12  PYTDGP-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   979     12  PYTDGP-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   980     12  PYTDGP-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   981     12  PYTDGP-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   982     12  PYTDGP-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
   983     12  PYTDGP-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   984     12  PYTDGP-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   985     12  PYTDGP-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   986
   987 01  PYTD-CARRIER-ACCUM.
   988     12  PYTDCA-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   989     12  PYTDCA-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   990     12  PYTDCA-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
   991     12  PYTDCA-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
   992     12  PYTDCA-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
   993     12  PYTDCA-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
   994     12  PYTDCA-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
   995     12  PYTDCA-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
   996
   997 01  PYTD-STATE-ACCUM.
   998     12  PYTDST-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
   999     12  PYTDST-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1000     12  PYTDST-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1001     12  PYTDST-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
  1002     12  PYTDST-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1003     12  PYTDST-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1004     12  PYTDST-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1005     12  PYTDST-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
  1006
  1007 01  PYTD-REPTCD-ACCUM.
  1008     12  PYTDRP-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
  1009     12  PYTDRP-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1010     12  PYTDRP-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1011     12  PYTDRP-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
  1012     12  PYTDRP-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1013     12  PYTDRP-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1014     12  PYTDRP-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1015     12  PYTDRP-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
  1016
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS036.cbl
  1017 01  PYTD-REPTCD2-ACCUM.
  1018     12  PYTDRP2-LBEN            PIC S9(11)V99   COMP-3 VALUE +0.
  1019     12  PYTDRP2-LPRM            PIC S9(9)V99    COMP-3 VALUE +0.
  1020     12  PYTDRP2-LCLM            PIC S9(9)V99    COMP-3 VALUE +0.
  1021     12  PYTDRP2-ABEN            PIC S9(9)V99    COMP-3 VALUE +0.
  1022     12  PYTDRP2-APRM            PIC S9(9)V99    COMP-3 VALUE +0.
  1023     12  PYTDRP2-ACLM            PIC S9(9)V99    COMP-3 VALUE +0.
  1024     12  PYTDRP2-TPRM            PIC S9(9)V99    COMP-3 VALUE +0.
  1025     12  PYTDRP2-TCOM            PIC S9(9)V99    COMP-3 VALUE +0.
  1026
  1027 01  PYTD-GRAND-ACCUM.
  1028     12  PYTDGT-LBEN             PIC S9(11)V99   COMP-3 VALUE +0.
  1029     12  PYTDGT-LPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1030     12  PYTDGT-LCLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1031     12  PYTDGT-ABEN             PIC S9(9)V99    COMP-3 VALUE +0.
  1032     12  PYTDGT-APRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1033     12  PYTDGT-ACLM             PIC S9(9)V99    COMP-3 VALUE +0.
  1034     12  PYTDGT-TPRM             PIC S9(9)V99    COMP-3 VALUE +0.
  1035     12  PYTDGT-TCOM             PIC S9(9)V99    COMP-3 VALUE +0.
  1036
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS036.cbl
  1038 01  PRINT-DECISION-TABLE COMP-3.
  1039     05  PRINT-TABLE      OCCURS 12 TIMES.
  1040         10  PLBEN               PIC S9(9)V99.
  1041         10  PLPRM               PIC S9(9)V99.
  1042         10  PLCLM               PIC S9(9)V99.
  1043         10  PABEN               PIC S9(9)V99.
  1044         10  PAPRM               PIC S9(9)V99.
  1045         10  PACLM               PIC S9(9)V99.
  1046         10  PTCOM               PIC S9(9)V99.
  1047
  1048 01  PRINT-ZERO-TABLE  COMP-3.
  1049     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1050     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1051     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1052     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1053     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1054     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1055     05  FILLER                  PIC S9(9)V99    VALUE ZEROS.
  1056
  1057 01  WS.
  1058     12  WS-RETURN-CODE          PIC S9(4)    COMP   VALUE ZERO.
  1059     12  WS-ZERO                 PIC S9              VALUE ZERO.
  1060     12  WS-ABEND-MESSAGE        PIC X(80)           VALUE SPACES.
  1061     12  WS-ABEND-FILE-STATUS    PIC XX              VALUE ZERO.
  1062     12  WS-EP-ACC-EXPIRES       PIC 9(11).
  1063     12  WS-EP-ACC-EXPIRES-R REDEFINES WS-EP-ACC-EXPIRES.
  1064         16  FILLER              PIC 999.
  1065         16  EP-ACC-EXP-CC       PIC 99.
  1066         16  EP-ACC-EXP-YR       PIC 99.
  1067         16  EP-ACC-EXP-MO       PIC 99.
  1068         16  EP-ACC-EXP-DA       PIC 99.
  1069     12  WS-EP-ACC-HI-CERT       PIC 9(11).
  1070     12  WS-EP-ACC-HI-CERT-R REDEFINES WS-EP-ACC-HI-CERT.
  1071         16  FILLER              PIC 999.
  1072         16  EP-ACC-HI-CC        PIC 99.
  1073         16  EP-ACC-HI-YR        PIC 99.
  1074         16  EP-ACC-HI-MO        PIC 99.
  1075         16  EP-ACC-HI-DA        PIC 99.
  1076     12  WS-EP-MTH-HI-CERT       PIC 9(11).
  1077     12  WS-EP-MTH-HI-CERT-R REDEFINES WS-EP-MTH-HI-CERT.
  1078         16  FILLER              PIC 999.
  1079         16  EP-MTH-HI-CC        PIC 99.
  1080         16  EP-MTH-HI-YR        PIC 99.
  1081         16  EP-MTH-HI-MO        PIC 99.
  1082         16  EP-MTH-HI-DA        PIC 99.
  1083     12  WS-EP-DTE               PIC 9(07).
  1084     12  WS-EP-DTE-R REDEFINES WS-EP-DTE.
  1085         16  FILLER              PIC 9.
  1086         16  EP-RUN-CC           PIC 99.
  1087         16  EP-RUN-YR           PIC 99.
  1088         16  EP-RUN-MO           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS036.cbl
  1090 01  CONVERSION-DATE             PIC 9(08) VALUE ZEROS.
  1091 01  CONVERSION-DATE-R REDEFINES CONVERSION-DATE.
  1092     05  CONV-CC                 PIC XX.
  1093     05  CONV-YR                 PIC XX.
  1094     05  CONV-MO                 PIC XX.
  1095     05  CONV-DA                 PIC XX.
  1096
  1097 01  COMPARE-DATE-TABLE.
  1098*    05  COMPARE-DTS    OCCURS 13 TIMES.
  1099     05  COMPARE-DTS    OCCURS 15 TIMES.
  1100         10  COMPARE-DT.
  1101             15  COMP-CCYY       PIC 9(4).
  1102             15  COMP-CCYR REDEFINES COMP-CCYY.
  1103                 20  COMP-CC     PIC 99.
  1104                 20  COMP-YR     PIC 99.
  1105             15  COMP-MO         PIC 99.
  1106
  1107 01  COMPARE-DATE9TABLE REDEFINES COMPARE-DATE-TABLE.
  1108*    05  COMPARE9DTS    OCCURS 13 TIMES.
  1109     05  COMPARE9DTS    OCCURS 15 TIMES.
  1110         10  COMPARE9DT          PIC 9(06).
  1111
  1112 01  YEAR-END-DT                 PIC 9(06)  VALUE ZEROS.
  1113 01  TWO-YEAR-ENDS-AGO           PIC 9(06)  VALUE ZEROS.
  1114 01  TWO-YEARS-AGO               PIC 9(06)  VALUE ZEROS.
  1115 01  YEAR-OLD-DATE               PIC 9(06).
  1116
  1117 01  FISCAL-DATE         REDEFINES YEAR-OLD-DATE.
  1118     05  FISCAL-CCYY             PIC 9(04).
  1119     05  FISCAL-CCYR REDEFINES FISCAL-CCYY.
  1120         10  FISCAL-CC           PIC 99.
  1121         10  FISCAL-YR           PIC 99.
  1122     05  FISCAL-MO               PIC 99.
  1123
  1124 01  SAVE-EPX.
  1125     12  SAVE-CNTL.
  1126         16  S-EPX-CNTL-1.
  1127             20  S-EPX-CNTL-GA       PIC X(10).
  1128             20  S-EPX-CNTL-ACCT     PIC X(10).
  1129         16  S-EPX-CNTL-2.
  1130             20  S-EPX-CARR          PIC X.
  1131             20  S-EPX-GRP           PIC X(6).
  1132         16  FILLER                  PIC X(12).
  1133     12  SAVE-ALT-CNTL  REDEFINES  SAVE-CNTL.
  1134         16  S-EPX-A-RPT-CD-1        PIC X(10).
  1135         16  S-EPX-A-CARR            PIC X.
  1136         16  S-EPX-A-GROUP           PIC X(6).
  1137         16  S-EPX-A-RPT-CD-2        PIC X(10).
  1138         16  S-EPX-A-STATE           PIC XX.
  1139         16  S-EPX-A-ACCT            PIC X(10).
  1140
  1141 01  SAVE-ACCT-STATUS            PIC X(12).
  1142 01  SAVE-ACCT-NAME              PIC X(30).
  1143 01  SAVE-ACCT-CITY              PIC X(30).
  1144
  1145 01  SAVE-DATES.
  1146     05  SAVE-AM-EXPIRES         PIC 9(11).
  1147     05  SAVE-AM-EXPIRES-R REDEFINES SAVE-AM-EXPIRES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS036.cbl
  1148         12  FILLER              PIC 999.
  1149         12  SAVE-AM-EXP-CC      PIC 99.
  1150         12  SAVE-AM-EXP-YR      PIC 99.
  1151         12  SAVE-AM-EXP-MO      PIC 99.
  1152         12  SAVE-AM-EXP-DA      PIC 99.
  1153     05  SAVE-AM-HI-CERT         PIC 9(11).
  1154     05  SAVE-AM-HI-CERT-R REDEFINES SAVE-AM-HI-CERT.
  1155         12  FILLER              PIC 999.
  1156         12  SAVE-AM-HI-CC       PIC 99.
  1157         12  SAVE-AM-HI-YR       PIC 99.
  1158         12  SAVE-AM-HI-MO       PIC 99.
  1159         12  SAVE-AM-HI-DA       PIC 99.
  1160     05  SAVE-HER-HI-CERT        PIC 9(11).
  1161     05  SAVE-HER-HI-CERT-R REDEFINES SAVE-HER-HI-CERT.
  1162         12  FILLER              PIC 999.
  1163         12  SAVE-HER-HI-CC      PIC 99.
  1164         12  SAVE-HER-HI-YR      PIC 99.
  1165         12  SAVE-HER-HI-MO      PIC 99.
  1166         12  SAVE-HER-HI-DA      PIC 99.
  1167
  1168 01  EP-DATE.
  1169     05  E-CC                    PIC 99      VALUE ZEROS.
  1170     05  E-YR                    PIC 99      VALUE ZEROS.
  1171     05  E-MO                    PIC 99      VALUE ZEROS.
  1172
  1173 01  EP9DATE REDEFINES EP-DATE   PIC 9(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS036.cbl
  1175 01  WS-BIN-DATES.
  1176     12  BIN-AC-DATE             PIC XX      VALUE SPACES.
  1177     12  BIN-EP-HI-CERT          PIC XX      VALUE SPACES.
  1178     12  BIN-MTH-HI-CERT         PIC XX      VALUE SPACES.
  1179     12  BIN-GP-DATE             PIC XX      VALUE SPACES.
  1180     12  BIN-RP-DATE             PIC XX      VALUE SPACES.
  1181     12  BIN-CA-DATE             PIC XX      VALUE SPACES.
  1182     12  BIN-GT-DATE             PIC XX      VALUE SPACES.
  1183
* 1184 COPY ELCDATE.
  1185******************************************************************06/11/98
  1186*                                                                *ELCDATE
  1187*                                                                *ELCDATE
  1188*                            ELCDATE.                            *   LV023
  1189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1190*                            VMOD=2.003                           ELCDATE
  1191*                                                                *ELCDATE
  1192*                                                                *ELCDATE
  1193*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1194*                 LENGTH = 200                                   *   CL*19
  1195******************************************************************ELCDATE
  1196                                                                  ELCDATE
  1197 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1198     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1199     12  DC-OPTION-CODE                PIC X.                        CL*15
  1200         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1201         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1202         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1203         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1204         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1205         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1206         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1207         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1208         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1209         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1210         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1211         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1212         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1213         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1214         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1215         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1216         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1217         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1218         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1219         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1220         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1221         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1222         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1223         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1224         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1225         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1226         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1227         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1228         88  THREE-CHARACTER-BIN                                  ELCDATE
  1229                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1230         88  GREGORIAN-TO-BIN                                        CL**2
  1231                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1232         88  BIN-TO-GREGORIAN                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1233                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1234         88  JULIAN-TO-BINARY                                        CL**2
  1235                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1236     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1237         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1238         88  DATE-CONVERSION-ERROR                                ELCDATE
  1239                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1240         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1241         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1242         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1243         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1244         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1245         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1246         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1247         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1248         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1249         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1250     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1251         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1252     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1253         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1254         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1255         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1256     12  FILLER                        PIC X.                        CL*15
  1257     12  DC-CONVERSION-DATES.                                        CL*15
  1258         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1259         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1260         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1261         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1262                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1263             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1264             20  SLASH1-1              PIC X.                        CL*15
  1265             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1266             20  SLASH1-2              PIC X.                        CL*15
  1267             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1268         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1269         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1270                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1271             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1272             20  SLASH2-1              PIC X.                        CL*15
  1273             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1274             20  SLASH2-2              PIC X.                        CL*15
  1275             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1276         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1277         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1278                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1279             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1280             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1281             20  DC-YMD-DAY            PIC 99.                       CL*15
  1282         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1283         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1284                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1285             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1286             20  DC-MDY-DAY            PIC 99.                       CL*15
  1287             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1288         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1289             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1290             20  DC-ALPHA-DAY          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1291             20  FILLER                PIC XX.                       CL*15
  1292             20  DC-ALPHA-CENTURY.                                   CL*15
  1293                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1294             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1295         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1296         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1297         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1298         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1299         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1300                                       PIC 9(05).                    CL*20
  1301         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1302             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1303             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1304         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1305         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1306         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1307     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1308         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1309         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1310             20  FILLER                PIC 9(3).                     CL*15
  1311             20  HOLD-CEN-1-CCYY.                                    CL*15
  1312                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1313                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1314             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1315             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1316         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1317             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1318             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1319             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1320                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1321                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1322             20  FILLER                PIC 9(3).                     CL*15
  1323         16  HOLD-CENTURY-1-X.                                       CL*15
  1324             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1325             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1326                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1327                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1328             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1329             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1330         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1331             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1332             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1333             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1334                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1335                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1336             20  FILLER                PIC XXX.                      CL*23
  1337         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1338         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1339         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1340         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1341             20  DC-JULIAN-1-CCYY.                                   CL*15
  1342                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1343                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1344             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1345         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1346         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1347             20  DC-JULIAN-2-CCYY.                                   CL*15
  1348                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1349                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1350             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1351         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1352             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1353             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1354             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1355             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1356             20  DC-EDITA-CCYY.                                      CL*15
  1357                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1358                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1359         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1360             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1361             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1362             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1363             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1364             20  DC-EDITB-CCYY.                                      CL*15
  1365                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1366                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1367         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1368         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1369                              DC-GREG-DATE-CYMD.                  ELCDATE
  1370             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1371             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1372             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1373             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1374         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1375         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1376                              DC-GREG-DATE-MDCY.                  ELCDATE
  1377             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1378             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1379             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1380             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1381    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1382        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1383    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1384    12  FILLER                         PIC X(28).                    CL*26
  1385
* 1386                                 COPY ELCDTECX.
  1387******************************************************************06/05/98
  1388*                                                                *ELCDTECX
  1389*                            ELCDTECX.                           *   LV005
  1390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1391*                            VMOD=2.015                          *ELCDTECX
  1392*                                                                *ELCDTECX
  1393*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1394*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1395*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1396*                                                                *ELCDTECX
  1397******************************************************************ELCDTECX
  1398******************************************************************
  1399*                   C H A N G E   L O G
  1400*
  1401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1402*-----------------------------------------------------------------
  1403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1404* EFFECTIVE    NUMBER
  1405*-----------------------------------------------------------------
  1406* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1407*                                  BENEFIT CODES FROM 300 TO 900
  1408* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1409* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1410* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1411******************************************************************
  1412 01  DATE-CARD.                                                   ELCDTECX
  1413     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1414     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1415     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1416     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1417     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1418     12  EP-SW                       PIC  X.                      ELCDTECX
  1419         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1420     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1421         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1422     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1423     12  RUN-CENTURY.                                             ELCDTECX
  1424         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1425     12  FILLER                      PIC  X.                         CL**4
  1426     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1427     12  FILLER                      PIC  XXX.                    ELCDTECX
  1428     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1429                                                                  ELCDTECX
  1430 01  FILLER                          PIC  X(7)                       CL**6
  1431                                          VALUE 'OPTIONS'.        ELCDTECX
  1432 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1433     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1434     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1435     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1436         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1437         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1438     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1439     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1440     12  FILLER                      PIC  X.                      ELCDTECX
  1441     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1442     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1443     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1444     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1445     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1446     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1447     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1448     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1449     12  FILLER                      PIC  X.                      ELCDTECX
  1450     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1451     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1452     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1453     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1454     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1455     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1456     12  FILLER                      PIC  X.                      ELCDTECX
  1457     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1458     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1459     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1460     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1461     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1462     12  DTE-R78                     PIC  X.                      ELCDTECX
  1463     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1464     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1465     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1466     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1467     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1468     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1469     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1470                                     PIC  X.                      ELCDTECX
  1471         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1472                                                 ' '.             ELCDTECX
  1473         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1474         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1475     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1476         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1477         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1478     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1479     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1480                                     PIC  9.                         CL**4
  1481     12  DTE-SYSTEM.                                              ELCDTECX
  1482         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1483         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1484         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1485         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1486         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1487         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1488         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1489         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1490         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1491         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1492         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1493         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1494         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1495         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1496         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1497         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1498         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1499         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1500         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1501         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1502         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1503         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1504         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1505         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1506         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1507         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1508     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1509         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1510                                     PIC  X.                      ELCDTECX
  1511     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1512                                                                  ELCDTECX
  1513 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1514     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1515     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1516     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1517*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1518     12  FILLER                      PIC  X.                      ELCDTECX
  1519     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1520     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1521     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1522     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1523     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1524     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1525     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1526                                                                  ELCDTECX
  1527     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1528     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1529     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1530     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1531                                                                  ELCDTECX
  1532     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1533     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1534     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1535     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1536                                                                  ELCDTECX
  1537     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1538     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1539                                                                  ELCDTECX
  1540     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1541     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1542                                                                  ELCDTECX
  1543     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1544                                                                  ELCDTECX
  1545 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1546     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1547     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1548     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1549     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1550     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1551     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1552     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1553                                                                  ELCDTECX
  1554 01  FILLER                          PIC  X(12)                   ELCDTECX
  1555                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1556 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1557     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1558         16  CNT-ID                  PIC  X.                      ELCDTECX
  1559         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1560                                                                  ELCDTECX
  1561 01  FILLER                          PIC  X(11)                   ELCDTECX
  1562                                          VALUE 'STATE NAMES'.    ELCDTECX
  1563 01  STATE-NAMES.                                                 ELCDTECX
  1564     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1565         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1566         16  STATE-PIC1.                                          ELCDTECX
  1567             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1568             20  FILLER              PIC  XXX.                    ELCDTECX
  1569             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1570             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1571             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1572             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1573                                                                  ELCDTECX
  1574 01  FILLER                          PIC  X(13)                   ELCDTECX
  1575                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1576 01  CARRIER-NAMES.                                               ELCDTECX
  1577     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1578         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1579         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1580         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1581         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1582         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1583         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1584*        16  FILLER                  PIC  X.                      ELCDTECX
  1585         16  CARRIER-SEC-PAY         PIC  X.
  1586             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1587                                                                  ELCDTECX
  1588 01  FILLER                          PIC  X(9)                       CL**6
  1589                                          VALUE 'INS TYPES'.      ELCDTECX
  1590 01  CLAS-INS-TYPES.                                              ELCDTECX
  1591*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1592     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1593         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1594         16  CLAS-I-AB3.                                          ELCDTECX
  1595             20  FILLER              PIC  X.                      ELCDTECX
  1596             20  CLAS-I-AB2.                                      ELCDTECX
  1597                 24  FILLER          PIC  X.                      ELCDTECX
  1598                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1599         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1600             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1601             20  FILLER              PIC  X.                         CL**4
  1602         16  CLAS-I-AB10.                                         ELCDTECX
  1603             20  FILLER              PIC  X(9).                   ELCDTECX
  1604             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1605         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1606         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1607         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1608         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1609             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1610         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1611         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1612         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1613         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1614         16  CLAS-I-REFUND-METHOD    PIC  X.
  1615         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1616         16  FILLER                  PIC  XXX.
  1617                                                                  ELCDTECX
  1618 01  FILLER                          PIC  X(16)                   ELCDTECX
  1619                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1620 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1621     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1622                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1623         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1624         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1625         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1626         16  CLAS-MORT-DESC.                                      ELCDTECX
  1627             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1628             20  FILLER              PIC  XX.                        CL**5
  1629             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1630             20  FILLER              PIC  X.                         CL**5
  1631             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1632             20  FILLER              PIC  X.                         CL**5
  1633             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1634             20  FILLER              PIC  X.                         CL**5
  1635             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1636             20  FILLER              PIC  X(5).                      CL**6
  1637                                                                  ELCDTECX
  1638 01  FILLER                          PIC  X(15)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1639                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1640 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1641     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1642         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1643         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1644         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1645         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1646         16  FILLER                  PIC  X(4).                      CL**6
  1647                                                                  ELCDTECX
  1648 01  FILLER                          PIC  X(7)                       CL**6
  1649                                     VALUE 'INDEXES'.             ELCDTECX
  1650 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1651     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1652     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1653     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1654     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1655     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1656     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1657     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1658     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1659     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1660     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1661     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1662     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1663     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1664     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1665     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1666     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1667     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1668                                                                  ELCDTECX
  1669 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1670     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1671     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1672     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1673     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1674     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1675     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1676     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1677     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1678     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1679     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1680     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1681                                                                  ELCDTECX
  1682 01  FILLER                          PIC  X(13)                   ELCDTECX
  1683                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1684 01  CLAS-MISC.                                                   ELCDTECX
  1685     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1686         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1687         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1688         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1689     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1690     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1691     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1692     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1693     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1694     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1695     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1696     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1697     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1698     12  STATE-L                     PIC  XX.                     ELCDTECX
  1699     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1700     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1701     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1702         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1703         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1704     12  DTE-ABEND-WORK.                                          ELCDTECX
  1705         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1706         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1707                                                                  ELCDTECX
  1708 01  FILLER                          PIC  X(12)                   ELCDTECX
  1709                                     VALUE 'WORKING DATE'.        ELCDTECX
  1710 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1711     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1712         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1713         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1714         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1715     12  WS-CURRENT-DATE.                                         ELCDTECX
  1716         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1717         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1718         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1719         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1720         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1721     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1722         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1723         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1724                                                                  ELCDTECX
  1725 01  FILLER                          PIC  X(12)                   ELCDTECX
  1726                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1727 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1728     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1729         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1730         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1731         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1732                                                                  ELCDTECX
  1733 01  FILLER                          PIC  X(10)                   ELCDTECX
  1734                                     VALUE 'STATE TLRS'.          ELCDTECX
  1735 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1736     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1737         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1738         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1739                                                                  ELCDTECX
  1740 01  FILLER                          PIC  X(13)                   ELCDTECX
  1741                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1742 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1743     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1744         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1745                                                                  ELCDTECX
  1746 01  FILLER                          PIC  X(13)                   ELCDTECX
  1747                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1748 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1749     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1750     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1751     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1752                                     PIC  X.                         CL**5
  1753     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1754     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1755     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1756     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1757     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1758     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1759     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1760     12  FILLER                      PIC  X(75).                  ELCDTECX
  1761******************************************************************ELCDTECX
  1762*01  MISC-CARR-PCT-DATA.                                          00001521
  1763*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1764*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1765*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1766*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1767*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1768*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1769******************************************************************ELCDTECX
  1770
* 1771                                 COPY ELCDTEVR.
  1772***************************************************************** 04/15/98
  1773*                                                                *ELCDTEVR
  1774*                                                                *ELCDTEVR
  1775*                            ELCDTEVR.                           *   LV003
  1776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1777*                            VMOD=2.001                          *   CL**2
  1778*                                                                *ELCDTEVR
  1779*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1780*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1781*                                                                *ELCDTEVR
  1782******************************************************************ELCDTEVR
  1783 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1784     05  WS-RUN-DATE.                                             ELCDTEVR
  1785         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1786         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1787         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1788             15  RUN-CC              PIC  99.                     ELCDTEVR
  1789             15  RUN-YR              PIC  99.                     ELCDTEVR
  1790         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1791         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1792     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1793            WS-RUN-DATE              PIC 9(11).                      CL**2
  1794     05  WS-EP-DT.                                                ELCDTEVR
  1795         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1796         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1797         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1798             15  EP-CC               PIC  99.                     ELCDTEVR
  1799             15  EP-YR               PIC  99.                     ELCDTEVR
  1800         10  EP-MO                   PIC  99.                     ELCDTEVR
  1801         10  EP-DA                   PIC  99.                     ELCDTEVR
  1802     05  WS-EP-DT-N REDEFINES                                        CL**2
  1803            WS-EP-DT                 PIC 9(11).                      CL**2
  1804     05  WS-DTE-CONV-DT.                                             CL**4
  1805         10  FILLER                  PIC  9(03).                     CL**4
  1806         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1807         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1808             15  DTE-CONV-CC         PIC  99.                        CL**4
  1809             15  DTE-CONV-YR         PIC  99.                        CL**4
  1810         10  DTE-CONV-MO             PIC  99.                        CL**4
  1811         10  DTE-CONV-DA             PIC  99.                        CL**4
  1812     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1813            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1814 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1815     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1816         10  FILLER                            PIC 999.           ELCDTEVR
  1817         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1818         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1819             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1820             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1821         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1822         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1823     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1824            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1825     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1826         10  FILLER                            PIC 999.           ELCDTEVR
  1827         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1828         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1829         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1830         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1831     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1832            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1833 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1834     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1835         10  FILLER                            PIC 999.           ELCDTEVR
  1836         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1837         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1838             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1839             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1840         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1841         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1842     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1843            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1844     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1845         10  FILLER                            PIC 999.           ELCDTEVR
  1846         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1847         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1848             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1849             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1850         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1851         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1852     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1853            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1854     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1855         10  FILLER                            PIC 999.           ELCDTEVR
  1856         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1857         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1858             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1859             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1860         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1861         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1862     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1863            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1864 01  WS-RATE-RECORD.                                              ELCDTEVR
  1865         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1866             10  FILLER                        PIC 999.           ELCDTEVR
  1867             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1868             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1869                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1870                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1871             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1872             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1873         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1874                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1875 LINKAGE SECTION.
  1876
  1877 01  PARM.
  1878     05  PARM-LENGTH BINARY  PICTURE IS S9(4).
  1879     05  PARM-VALUE  DISPLAY PICTURE IS X(100).
  1880
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS036.cbl
  1882 PROCEDURE DIVISION USING PARM.
  1883
  1884 0000-START-HERE.
* 1885                    COPY ELCDTERX.
  1886******************************************************************04/15/98
  1887*                                                                *ELCDTERX
  1888*                                                                *ELCDTERX
  1889*                            ELCDTERX.                           *   LV002
  1890*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1891*                            VMOD=2.007                          *ELCDTERX
  1892*                                                                *ELCDTERX
  1893*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1894*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1895*      = ELCDTEFD)                                               *ELCDTERX
  1896*                                                                *ELCDTERX
  1897******************************************************************ELCDTERX
  1898                                                                  ELCDTERX
  1899     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1900                                                                  ELCDTERX
  1901     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1902     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1903     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1904                                                                  ELCDTERX
  1905     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1906                                                                  ELCDTERX
  1907******************************************************************ELCDTERX
  1908*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1909*          WARNING MESSAGES.                                      ELCDTERX
  1910******************************************************************ELCDTERX
  1911     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1912         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1913                                                                  ELCDTERX
  1914     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1915                                                                  ELCDTERX
  1916     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1917                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1918                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1919                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1920                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1921                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1922                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1923                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1924                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1925                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1926                                                                  ELCDTERX
  1927     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1928                                                                  ELCDTERX
  1929     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1930                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1931                                                                  ELCDTERX
  1932     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1933     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1934     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1935     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1936                                                                  ELCDTERX
  1937     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1938         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1939     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1940         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1941                                                                  ELCDTERX
  1942     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1943         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1944     ELSE                                                         ELCDTERX
  1945         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1946                                                                  ELCDTERX
  1947 0005-READ--CARD.                                                 ELCDTERX
  1948     READ DISK-DATE                                               ELCDTERX
  1949         AT END CLOSE DISK-DATE                                   ELCDTERX
  1950             GO TO 0060-READ--TEST.                               ELCDTERX
  1951                                                                  ELCDTERX
  1952     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1953                                                                  ELCDTERX
  1954     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1955         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1956         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1957         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1958         GO TO 0005-READ--CARD.                                   ELCDTERX
  1959                                                                  ELCDTERX
  1960     IF DD-ID = 'CLAD'                                            ELCDTERX
  1961         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1962         GO TO 0005-READ--CARD.                                   ELCDTERX
  1963                                                                  ELCDTERX
  1964     IF DD-ID = 'CLAX'                                            ELCDTERX
  1965         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1966         GO TO 0005-READ--CARD.                                   ELCDTERX
  1967                                                                  ELCDTERX
  1968     IF DD-ID = 'CLAF'                                            ELCDTERX
  1969         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1970         GO TO 0005-READ--CARD.                                   ELCDTERX
  1971                                                                  ELCDTERX
  1972     IF DD-ID = 'CLAC'                                            ELCDTERX
  1973         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1974                                                                  ELCDTERX
  1975     IF DD-ID = 'CARR'                                            ELCDTERX
  1976         GO TO 0015-READ--CARR.                                   ELCDTERX
  1977                                                                  ELCDTERX
  1978     IF DD-ID = 'STAT'                                            ELCDTERX
  1979         GO TO 0020-READ--STAT.                                   ELCDTERX
  1980                                                                  ELCDTERX
  1981     IF DD-ID = 'BUSC'                                            ELCDTERX
  1982         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1983                                                                  ELCDTERX
  1984     IF DD-ID = 'MORT'                                            ELCDTERX
  1985         GO TO 0030-READ--MORT.                                   ELCDTERX
  1986                                                                  ELCDTERX
  1987     IF DD-ID = 'CLAI'                                            ELCDTERX
  1988         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1989                                                                  ELCDTERX
  1990     IF DD-ID = 'COLC'                                            ELCDTERX
  1991         GO TO 0065-READ--COLC.                                   ELCDTERX
  1992                                                                  ELCDTERX
  1993     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1994        DD-IDA = 'CL'                                             ELCDTERX
  1995         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1996                                                                  ELCDTERX
  1997     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1998        DD-IDA = 'PO'                                             ELCDTERX
  1999         GO TO 0050-READ--POXX.                                   ELCDTERX
  2000                                                                  ELCDTERX
  2001     IF DD-ID = 'OPCA'                                            ELCDTERX
  2002         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2003                                                                  ELCDTERX
  2004     IF DD-ID = 'OPST'                                            ELCDTERX
  2005         GO TO 0072-READ--OPST.                                   ELCDTERX
  2006                                                                  ELCDTERX
  2007     IF DD-ID = 'OPBS'                                            ELCDTERX
  2008         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2009                                                                  ELCDTERX
  2010     IF DD-ID = 'OPMS'                                            ELCDTERX
  2011         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2012                                                                  ELCDTERX
  2013     GO TO 0005-READ--CARD.                                       ELCDTERX
  2014                                                                  ELCDTERX
  2015 0010-READ--CLAC.                                                 ELCDTERX
  2016     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2017     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2018     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2019     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2020     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2021     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2022     GO TO 0005-READ--CARD.                                       ELCDTERX
  2023                                                                  ELCDTERX
  2024 0015-READ--CARR.                                                 ELCDTERX
  2025     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2026     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2027        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2028        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2029        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2030        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2031        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2032        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2033        MOVE DD-CARR1-SECPAY-SW
  2034                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2035     END-IF
  2036                                                                  ELCDTERX
  2037     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2038     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2039        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2040        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2041        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2042        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2043        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2044        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2045        MOVE DD-CARR2-SECPAY-SW
  2046                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2047     END-IF
  2048                                                                  ELCDTERX
  2049                                                                  ELCDTERX
  2050     GO TO 0005-READ--CARD.                                       ELCDTERX
  2051                                                                  ELCDTERX
  2052 0020-READ--STAT.                                                 ELCDTERX
  2053     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2054     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2055        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2056         GO TO 0005-READ--CARD.                                   ELCDTERX
  2057                                                                  ELCDTERX
  2058     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2059     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2060     GO TO 0020-READ--STAT.                                       ELCDTERX
  2061                                                                  ELCDTERX
  2062 0025-READ--BUSC.                                                 ELCDTERX
  2063     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2064     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2065        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2066         GO TO 0005-READ--CARD.                                   ELCDTERX
  2067                                                                  ELCDTERX
  2068     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2069     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2070     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2071                                                                  ELCDTERX
  2072 0030-READ--MORT.                                                 ELCDTERX
  2073     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2074     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2075        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2076         GO TO 0005-READ--CARD.                                   ELCDTERX
  2077                                                                  ELCDTERX
  2078     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2079     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2080     GO TO 0030-READ--MORT.                                       ELCDTERX
  2081                                                                  ELCDTERX
  2082 0035-READ--CLXX.                                                 ELCDTERX
  2083     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2084          GO TO 0005-READ--CARD.                                  ELCDTERX
  2085                                                                  ELCDTERX
  2086     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2087         DISPLAY '***********************************************'ELCDTERX
  2088         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2089         DISPLAY '***********************************************'ELCDTERX
  2090         GO TO 0055-READ--STOP.                                   ELCDTERX
  2091                                                                  ELCDTERX
  2092     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2093        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2094         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2095                                                                  ELCDTERX
  2096     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2097        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2098         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2099                                                                  ELCDTERX
  2100*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2101     GO TO 0005-READ--CARD.                                       ELCDTERX
  2102                                                                  ELCDTERX
  2103 0040-READ--CLAI.                                                 ELCDTERX
  2104     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2105     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2106        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2107         GO TO 0005-READ--CARD.                                   ELCDTERX
  2108                                                                  ELCDTERX
  2109     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2110     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2111     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2112                                                                  ELCDTERX
  2113 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2114     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2115     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2116                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2117     PERFORM ABEND-PGM.                                           ELCDTERX
  2118                                                                  ELCDTERX
  2119 0050-READ--POXX.                                                 ELCDTERX
  2120     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2121         GO TO 0005-READ--CARD.                                   ELCDTERX
  2122                                                                  ELCDTERX
  2123     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2124         DISPLAY '***********************************************'ELCDTERX
  2125         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2126         DISPLAY '***********************************************'ELCDTERX
  2127         GO TO 0055-READ--STOP.                                   ELCDTERX
  2128                                                                  ELCDTERX
  2129     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2130     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2131     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2132     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2133                                                                  ELCDTERX
  2134     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2135         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2136     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2137         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2138                                                                  ELCDTERX
  2139     GO TO 0005-READ--CARD.                                       ELCDTERX
  2140                                                                  ELCDTERX
  2141 0055-READ--STOP.                                                 ELCDTERX
  2142     GOBACK.                                                      ELCDTERX
  2143                                                                  ELCDTERX
  2144 0060-READ--TEST.                                                 ELCDTERX
  2145     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2146        CLAX-ID         = SPACE  OR                               ELCDTERX
  2147        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2148         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2149                                                                  ELCDTERX
  2150     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2151     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2152                                                                  ELCDTERX
  2153 0065-READ--COLC.                                                 ELCDTERX
  2154     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2155     GO TO 0005-READ--CARD.                                       ELCDTERX
  2156                                                                  ELCDTERX
  2157 0070-READ--OPCA.                                                 ELCDTERX
  2158                                                                  ELCDTERX
  2159     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2160                                                                  ELCDTERX
  2161     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2162             OR                                                   ELCDTERX
  2163         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2164         GO TO 0005-READ--CARD.                                   ELCDTERX
  2165                                                                  ELCDTERX
  2166     ADD 1                       TO INDEXCA.                      ELCDTERX
  2167     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2168                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2169     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2170                                                                  ELCDTERX
  2171 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS036.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2172                                                                  ELCDTERX
  2173     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2174                                                                  ELCDTERX
  2175     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2176             OR                                                   ELCDTERX
  2177         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2178         GO TO 0005-READ--CARD.                                   ELCDTERX
  2179                                                                  ELCDTERX
  2180     ADD 1                       TO INDEXST.                      ELCDTERX
  2181     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2182                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2183     GO TO 0072-READ--OPST.                                       ELCDTERX
  2184                                                                  ELCDTERX
  2185 0074-READ--OPBS.                                                 ELCDTERX
  2186                                                                  ELCDTERX
  2187     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2188                                                                  ELCDTERX
  2189     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2190             OR                                                   ELCDTERX
  2191         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2192         GO TO 0005-READ--CARD.                                   ELCDTERX
  2193                                                                  ELCDTERX
  2194     ADD 1                       TO INDEXBS.                      ELCDTERX
  2195     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2196     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2197                                                                  ELCDTERX
  2198 0079-READ--EXIT.                                                 ELCDTERX
  2199*    EXIT.                                                        ELCDTERX
  2200******************************************************************ELCDTERX
  2201
  2202     MOVE 0                      TO SAVE-HER-HI-CERT.
  2203     MOVE LIFE-OVERRIDE-L6       TO  HD-9A-LF-OVRD-1
  2204                                     HD-9A-LF-OVRD-2
  2205                                     HD-9A-LF-OVRD-3
  2206                                     HD-9-LF-OVRD-1
  2207                                     HD-9-LF-OVRD-2
  2208                                     HD-9-LF-OVRD-3.
  2209     MOVE AH-OVERRIDE-L6         TO  HD-9A-AH-OVRD-1
  2210                                     HD-9A-AH-OVRD-2
  2211                                     HD-9-AH-OVRD-1
  2212                                     HD-9-AH-OVRD-2
  2213                                     HD-9-AH-OVRD-3.
  2214     MOVE CLAS-REPORT-CD1-CAPTION
  2215                                 TO HD-1-RPT-CD-1
  2216                                    HD-8A-RPT-CD-1-CAPTION.
  2217     MOVE CLAS-REPORT-CD2-CAPTION
  2218                                 TO HD-1-RPT-CD-2
  2219                                    HD-8B-RPT-CD-2-CAPTION.
  2220
  2221     MOVE DTE-CONV-DT            TO CONVERSION-DATE.
  2222     MOVE WS-CURRENT-DATE        TO HD-IPL-DATE.
  2223     MOVE COMPANY-NAME           TO HD-COMPANY-NAME.
  2224     MOVE ALPH-DATE              TO HD-ALPHA-DATE.
  2225
  2226     IF DTE-QTR-CO = '1'
  2227         MOVE '1'                TO QTR-COMP.
  2228     IF PARM-LENGTH > +0
  2229        IF PARM-VALUE = 'SPECIAL'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS036.cbl
  2230           MOVE 'SINGLE FEE EQUIVALENT'  TO
  2231                HD-1-ST-SINGLE-FEE
  2232                HD-1-RC1-SINGLE-FEE
  2233                HD-1-RC2-SINGLE-FEE
  2234                HD-1-GRP-SINGLE-FEE
  2235                HD-1-CAR-SINGLE-FEE
  2236                HD-1-BUS-SINGLE-FEE
  2237                HD-1-AGCY-SINGLE-FEE
  2238                HD-1-GT-SINGLE-FEE
  2239                HD-1-US2-SINGLE-FEE
  2240                HD-1-US5-SINGLE-FEE
  2241        END-IF
  2242     END-IF
  2243
  2244     .
  2245 0100-SORT-ROUTINE SECTION.
  2246
  2247     SORT SORT-FILE ASCENDING KEY SORT-CONTROL-74
  2248                       SORT-HI-CERT
  2249         USING EARNED-PREM
  2250         OUTPUT PROCEDURE 0200-PRINT-ROUTINE THRU 9099-EXIT.
  2251
  2252     IF SORT-RETURN NOT = ZEROS
  2253         MOVE '0101'             TO WS-RETURN-CODE
  2254         GO TO ABEND-PGM.
  2255
  2256     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS036.cbl
  2258 0200-PRINT-ROUTINE SECTION.
  2259
  2260     OPEN OUTPUT PRNT.
  2261     OPEN OUTPUT SELECT-FILE.
  2262
  2263 0210-CLEAR-CNTRS.
  2264     MOVE ZERO                   TO X1.
  2265     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  2266     MOVE ZERO                   TO X1.
  2267*    PERFORM 0230-ZERO-ACCUM-ACC 13 TIMES.
  2268     PERFORM 0230-ZERO-ACCUM-ACC 15 TIMES.
  2269     MOVE ZERO                   TO X1.
  2270*    PERFORM 0240-ZERO-ACCUM-GRP 13 TIMES.
  2271     PERFORM 0240-ZERO-ACCUM-GRP 15 TIMES.
  2272     MOVE ZERO                   TO X1.
  2273     PERFORM 0250-ZERO-ACCUM-CARR 15 TIMES.
  2274     MOVE ZERO                   TO X1.
  2275     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  2276     MOVE ZERO                   TO X1.
  2277     PERFORM 0260-ZERO-ACCUM-REPT 15 TIMES.
  2278     MOVE ZERO                   TO X1.
  2279     PERFORM 0270-ZERO-ACCUM-GRAND 15 TIMES.
  2280     MOVE ZERO-GRAND-TOTALS      TO GRAND-TOTALS.
  2281     MOVE ZEROS                  TO EP-CNTL.
  2282     GO TO 0280-FIND-DATE-RANGE.
  2283
  2284 0220-ZERO-PRINT-TABLE.
  2285     ADD +1 TO X1.
  2286     MOVE PRINT-ZERO-TABLE       TO PRINT-TABLE (X1).
  2287
  2288 0230-ZERO-ACCUM-ACC.
  2289     ADD +1 TO X1.
  2290     MOVE ZERO-OCCURS-ACCUM      TO ACCOUNT-ACCUM (X1).
  2291
  2292 0240-ZERO-ACCUM-GRP.
  2293     ADD +1 TO X1.
  2294     MOVE ZERO-OCCURS-ACCUM      TO GROUPING-ACCUM (X1).
  2295
  2296 0250-ZERO-ACCUM-CARR.
  2297     ADD +1 TO X1.
  2298     MOVE ZERO-OCCURS-ACCUM      TO CARRIER-ACCUM (X1).
  2299
  2300 0255-ZERO-ACCUM-STATE.
  2301     ADD +1 TO X1.
  2302     MOVE ZERO-OCCURS-ACCUM      TO STATE-ACCUM (X1).
  2303
  2304 0256-ZERO-ACCUM-REPT2.
  2305     ADD +1 TO X1.
  2306     MOVE ZERO-OCCURS-ACCUM      TO REPTCD2-ACCUM (X1).
  2307
  2308 0260-ZERO-ACCUM-REPT.
  2309     ADD +1 TO X1.
  2310     MOVE ZERO-OCCURS-ACCUM      TO REPTCD-ACCUM (X1).
  2311
  2312 0270-ZERO-ACCUM-GRAND.
  2313     ADD +1 TO X1.
  2314     MOVE ZERO-OCCURS-ACCUM      TO GRAND-ACCUM (X1).
  2315
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS036.cbl
  2316 0280-FIND-DATE-RANGE.
  2317     IF QTR-CO
  2318         IF RUN-MO = 03 OR 06 OR 09 OR 12
  2319             MOVE '1'            TO QTR-SW.
  2320
  2321     MOVE RUN-MO                 TO RUN-DT-MO.
  2322     MOVE RUN-CCYY               TO RUN-DT-CCYY.
  2323     MOVE +1                     TO X1.
  2324     MOVE +0                     TO Y1.
  2325
  2326     IF QTR-CO AND QTR-END
  2327         MOVE 'QUARTERLY'        TO HD-1-AGCY HD-1-ST HD-1-GRP
  2328                                    HD-1-CAR HD-1-BUS HD-1-RC-1
  2329                                    HD-1-RC-2
  2330         COMPUTE COMPARE9DT (X1) = RUN9DT - 300
  2331     ELSE
  2332         COMPUTE COMPARE9DT (X1) = RUN9DT - 100.
  2333
  2334     COMPUTE YEAR-OLD-DATE = RUN9DT - 100.
  2335     COMPUTE TWO-YEARS-AGO = RUN9DT - 200
  2336
  2337     IF DTE-CLIENT = 'AFL'
  2338         MOVE 06                  TO FISCAL-MO
  2339         IF RUN-MO GREATER 06
  2340            MOVE RUN-CCYY       TO FISCAL-CCYY
  2341         ELSE
  2342            COMPUTE FISCAL-CCYY = RUN-CCYY - 1.
  2343
  2344 0290-BUILD-DATE-TABLE.
  2345
  2346     IF (COMP-MO (X1) = 12)
  2347        AND (TWO-YEAR-ENDS-AGO = ZEROS)
  2348        COMPUTE TWO-YEAR-ENDS-AGO = COMPARE9DT (X1) - 100
  2349        MOVE COMPARE9DT (X1)     TO YEAR-END-DT
  2350     END-IF
  2351
  2352     ADD +1 TO X1 Y1.
  2353
  2354     IF X1 GREATER +13
  2355        MOVE TWO-YEARS-AGO       TO COMPARE9DT (14)
  2356        MOVE TWO-YEAR-ENDS-AGO   TO COMPARE9DT (15)
  2357        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  2358           X1 > 15
  2359           MOVE X1               TO DISP-X1
  2360           DISPLAY ' COMPARE DATE ' DISP-X1 ' ' COMPARE9DT (X1)
  2361        END-PERFORM
  2362        DISPLAY ' YEAR END DATE ' YEAR-END-DT
  2363        GO TO 0310-READ-EARNED-PREM-EXTRACT
  2364     END-IF
  2365
  2366     IF QTR-CO AND QTR-END
  2367         COMPUTE COMPARE9DT (X1) = COMPARE9DT (Y1) + 0003
  2368     ELSE
  2369         COMPUTE COMPARE9DT (X1) = COMPARE9DT (Y1) + 0001.
  2370
  2371     IF COMP-MO (X1) GREATER 12
  2372         COMPUTE COMPARE9DT (X1) = COMPARE9DT (X1) + 0088.
  2373
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS036.cbl
  2374     GO TO 0290-BUILD-DATE-TABLE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS036.cbl
  2376 0310-READ-EARNED-PREM-EXTRACT.
  2377     RETURN SORT-FILE INTO WS-EXTR-REC
  2378                          AT END MOVE '1' TO EOF-EPX
  2379                                 GO TO 1500-PASS-NUMBER-CHANGE.
  2380     IF DTE-FMT-OPT = 2
  2381         IF EP-PASS-NO NOT = '1'
  2382             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2383
  2384     IF DTE-FMT-OPT = 3
  2385         IF EP-PASS-NO NOT = '2'
  2386             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2387
  2388     IF DTE-FMT-OPT = 4
  2389         IF EP-PASS-NO NOT = '3'
  2390             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2391
  2392     IF DTE-FMT-OPT = 5
  2393         IF EP-PASS-NO NOT = '4'
  2394             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2395
  2396     IF DTE-FMT-OPT = 6
  2397         IF EP-PASS-NO NOT = '5'
  2398             GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2399
  2400     IF FIRST-TIME
  2401         MOVE EP-PASS-NO         TO PASS-NUMBER
  2402         MOVE 'N'                TO FIRST-TIME-SWITCH
  2403         GO TO 0340-ACCUMULATE.
  2404
  2405 0320-CHECK-EXTRACT-SEQ.
  2406     IF EP-PASS-NO NOT = PASS-NUMBER
  2407         GO TO 1500-PASS-NUMBER-CHANGE.
  2408
  2409     IF EP-CNTL LESS THAN SAVE-EPX
  2410         DISPLAY 'EARNED PREMIUM EXTRACT OUT OF SEQUENCE'
  2411         DISPLAY 'SAVE = ' SAVE-EPX
  2412         DISPLAY 'READ = ' EP-CNTL
  2413         MOVE '0610'             TO WS-RETURN-CODE
  2414         GO TO ABEND-PGM.
  2415
  2416 0330-COMPARE-RECORDS.
  2417     IF PASS-NUMBER = '1'
  2418         IF S-EPX-CNTL-1 NOT = EP-CNTL-1
  2419             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2420             GO TO 0340-ACCUMULATE.
  2421
  2422     IF PASS-NUMBER = '3'
  2423         IF S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  2424             IF S-EPX-CNTL-ACCT = EP-CNTL-ACCT  AND
  2425                S-EPX-CNTL-2    = EP-CNTL-2
  2426                 NEXT SENTENCE
  2427             ELSE
  2428                 PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2429                 GO TO 0340-ACCUMULATE.
  2430
  2431     IF PASS-NUMBER = '4'
  2432         IF DTE-TOT-OPT = 1 OR 3 OR 6
  2433             GO TO 0310-READ-EARNED-PREM-EXTRACT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS036.cbl
  2434         ELSE
  2435             IF DTE-TOT-OPT = 5 OR 7
  2436                 IF EP-CNTL NOT = SAVE-CNTL
  2437                     PERFORM 0700-REPTCD-BREAK
  2438                         THRU 0790-ZERO-REPTCD.
  2439
  2440     IF PASS-NUMBER = '5'
  2441         IF DTE-TOT-OPT = 1 OR 2 OR 5
  2442             GO TO 0310-READ-EARNED-PREM-EXTRACT
  2443         ELSE
  2444             IF DTE-TOT-OPT = 6 OR 7
  2445                 IF EP-CNTL NOT = SAVE-CNTL
  2446                     PERFORM 0700-REPTCD-BREAK
  2447                         THRU 0790-ZERO-REPTCD.
  2448
  2449     IF PASS-NUMBER = '6'
  2450         IF DTE-TOT-OPT = 1 OR 3 OR 6
  2451             GO TO 0310-READ-EARNED-PREM-EXTRACT
  2452         ELSE
  2453             IF DTE-TOT-OPT = 5 OR 7
  2454                 IF EP-CNTL NOT = SAVE-CNTL
  2455                     PERFORM 0700-REPTCD-BREAK
  2456                         THRU 0790-ZERO-REPTCD.
  2457
  2458     IF PASS-NUMBER = '4'
  2459       IF S-EPX-A-RPT-CD-1 = EP-A-RPT-CD-1
  2460         GO TO 0340-ACCUMULATE
  2461        ELSE
  2462         MOVE '1'            TO  SKIP-HD-SW
  2463         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2464         GO TO 0340-ACCUMULATE.
  2465
  2466     IF PASS-NUMBER = '6'
  2467       IF S-EPX-A-RPT-CD-1 = EP-A-RPT-CD-1
  2468         GO TO 0340-ACCUMULATE
  2469        ELSE
  2470         MOVE '1'            TO  SKIP-HD-SW
  2471         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2472         GO TO 0340-ACCUMULATE.
  2473
  2474     IF PASS-NUMBER = '7'
  2475       IF S-EPX-A-RPT-CD-1 = EP-A-RPT-CD-1
  2476         IF S-EPX-A-RPT-CD-2 = EP-A-RPT-CD-2
  2477            IF EP-CNTL = SAVE-CNTL
  2478               GO TO 0340-ACCUMULATE
  2479            ELSE
  2480               MOVE ' '     TO  SKIP-HD-SW
  2481               PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2482               GO TO 0340-ACCUMULATE
  2483            END-IF
  2484         ELSE
  2485             MOVE ' '        TO  SKIP-HD-SW
  2486             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2487             MOVE '1'        TO  SKIP-HD-SW
  2488             PERFORM 1700-REPTCD2-BREAK THRU 1790-ZERO-REPTCD2
  2489             GO TO 0340-ACCUMULATE
  2490         END-IF
  2491       ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS036.cbl
  2492         MOVE ' '            TO  SKIP-HD-SW
  2493         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2494         MOVE '1'        TO  SKIP-HD-SW
  2495         PERFORM 1700-REPTCD2-BREAK THRU 1790-ZERO-REPTCD2
  2496         MOVE '2'            TO  SKIP-HD-SW
  2497         PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  2498         GO TO 0340-ACCUMULATE
  2499       END-IF
  2500     END-IF.
  2501
  2502
  2503     IF PASS-NUMBER = '5'
  2504     IF S-EPX-A-CARR NOT = EP-A-CARR
  2505         MOVE '1'            TO  SKIP-HD-SW
  2506         PERFORM 0600-CARRIER-BREAK THRU 0680-ZERO-CARRIER
  2507         GO TO 0340-ACCUMULATE.
  2508
  2509     IF PASS-NUMBER = '5'
  2510     IF S-EPX-A-GROUP NOT = EP-A-GROUP
  2511         MOVE '1'            TO  SKIP-HD-SW
  2512         PERFORM 0500-GROUPING-BREAK THRU 0580-ZERO-GROUPING
  2513         GO TO 0340-ACCUMULATE.
  2514
  2515     IF PASS-NUMBER = '5'
  2516         IF S-EPX-A-CARR     = EP-A-CARR  AND
  2517            S-EPX-A-GROUP    = EP-A-GROUP AND
  2518            S-EPX-A-RPT-CD-2 = EP-A-RPT-CD-2
  2519            IF S-EPX-A-STATE = EP-A-STATE
  2520             GO TO 0340-ACCUMULATE
  2521           ELSE
  2522             MOVE '1'            TO  SKIP-HD-SW
  2523             PERFORM 0375-STATE-BREAK THRU 0380-ZERO-STATE
  2524             MOVE ' '            TO  SKIP-HD-SW
  2525             GO TO 0340-ACCUMULATE
  2526         ELSE
  2527             MOVE '1'            TO  SKIP-HD-SW
  2528             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  2529             GO TO 0340-ACCUMULATE.
  2530
  2531 0335-NOT-5.
  2532     IF S-EPX-CNTL-1 NOT = EP-CNTL-1
  2533         PERFORM 0600-CARRIER-BREAK THRU 0680-ZERO-CARRIER
  2534         GO TO 0340-ACCUMULATE.
  2535
  2536     IF S-EPX-CARR NOT = EP-CARR
  2537         PERFORM 0500-GROUPING-BREAK THRU 0580-ZERO-GROUPING
  2538         GO TO 0340-ACCUMULATE.
  2539
  2540     IF S-EPX-GRP NOT = EP-GROUP
  2541         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  2542
  2543 0340-ACCUMULATE.
  2544     MOVE +0                     TO X1.
  2545
  2546 0350-ACCUMULATE-B.
  2547     ADD +1 TO X1.
  2548
  2549     IF X1 GREATER 15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS036.cbl
  2550*    IF X1 GREATER 13
  2551*        DISPLAY 'DATE TABLE ERROR OR EP-RUN-DATE ERROR'
  2552*        DISPLAY 'EP-DATE ' EP-DTE
  2553*        DISPLAY 'RUN-DT  ' RUN-DT
  2554*        DISPLAY 'COMPARE-DATE-TABLE ' COMPARE-DATE-TABLE
  2555*        MOVE '0301'             TO WS-RETURN-CODE
  2556*        GO TO ABEND-PGM.
  2557         GO TO 0310-READ-EARNED-PREM-EXTRACT
  2558     END-IF
  2559
  2560     IF COMPARE9DT (X1) NOT = EP-DTE
  2561         GO TO 0350-ACCUMULATE-B.
  2562
  2563     IF EP-MTH-HI-CERT  GREATER  AC-DATE (X1)
  2564         MOVE EP-MTH-HI-CERT     TO  AC-DATE (X1)
  2565                                     AC-DATE-R(X1).
  2566
  2567     ADD EP-CERT                 TO  AC-CERT (X1)  RP-CERT (X1)
  2568                                     RP2-CERT (X1)
  2569                                     ST-CERT (X1).
  2570     ADD EP-ISS-CNT              TO  AC-ISS  (X1)  RP-ISS  (X1)
  2571                                     RP2-ISS (X1)
  2572                                     ST-ISS  (X1).
  2573     ADD EP-LBEN                 TO  AC-LBEN (X1)  RP-LBEN (X1)
  2574                                     RP2-LBEN (X1)
  2575                                     ST-LBEN (X1).
  2576     ADD EP-LPRM                 TO  AC-LPRM (X1)  RP-LPRM (X1)
  2577                                     RP2-LPRM (X1)
  2578                                     ST-LPRM (X1).
  2579     ADD EP-LCLM                 TO  AC-LCLM (X1)  RP-LCLM (X1)
  2580                                     RP2-LCLM (X1)
  2581                                     ST-LCLM (X1).
  2582     ADD EP-ABEN                 TO  AC-ABEN (X1)  RP-ABEN (X1)
  2583                                     RP2-ABEN (X1)
  2584                                     ST-ABEN (X1).
  2585     ADD EP-APRM                 TO  AC-APRM (X1)  RP-APRM (X1)
  2586                                     RP2-APRM (X1)
  2587                                     ST-APRM (X1).
  2588     ADD EP-ACLM                 TO  AC-ACLM (X1)  RP-ACLM (X1)
  2589                                     RP2-ACLM (X1)
  2590                                     ST-ACLM (X1).
  2591     ADD EP-TPRM                 TO  AC-TPRM (X1)  RP-TPRM (X1)
  2592                                     RP2-TPRM (X1)
  2593                                     ST-TPRM (X1).
  2594     ADD EP-TCOM                 TO  AC-TCOM (X1)  RP-TCOM (X1)
  2595                                     RP2-TCOM (X1)
  2596                                     ST-TCOM (X1).
  2597     MOVE EP-CNTL                TO SAVE-EPX.
  2598     EVALUATE EP-ACCT-STATUS
  2599        WHEN 'A'
  2600           MOVE 'ACTIVE'         TO SAVE-ACCT-STATUS
  2601        WHEN 'I'
  2602           MOVE 'INACTIVE'       TO SAVE-ACCT-STATUS
  2603        WHEN 'T'
  2604           MOVE 'TRANSFERRED'    TO SAVE-ACCT-STATUS
  2605        WHEN 'C'
  2606           MOVE 'CANCELLED'      TO SAVE-ACCT-STATUS
  2607        WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS036.cbl
  2608           MOVE 'UNKNOWN'        TO SAVE-ACCT-STATUS
  2609     END-EVALUATE
  2610
  2611     MOVE EP-ACCT-NAME           TO SAVE-ACCT-NAME.
  2612     MOVE EP-ACCT-CITY           TO SAVE-ACCT-CITY.
  2613     MOVE EP-ACC-EXPIRES         TO SAVE-AM-EXPIRES.
  2614     MOVE EP-ACC-HI-CERT         TO SAVE-AM-HI-CERT.
  2615
  2616     IF X1 < +15
  2617        GO TO 0350-ACCUMULATE-B
  2618     END-IF
  2619
  2620     GO TO 0310-READ-EARNED-PREM-EXTRACT
  2621
  2622     .
  2623 0375-STATE-BREAK.
  2624     MOVE +0                     TO X1.
  2625     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  2626     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  2627
  2628     MOVE 'TOTALS'               TO STATE-TOTAL-LINE.
  2629
  2630     IF P-ST-SW = '1'
  2631         MOVE ' '                TO P-ST-SW
  2632     ELSE
  2633         IF DTE-CLIENT  =  'NCL'
  2634             MOVE SPACES         TO  STATE-TOTAL-LINE
  2635             GO TO 0380-ZERO-STATE
  2636         ELSE
  2637             GO TO 0380-ZERO-STATE.
  2638
  2639     PERFORM 0900-HEAD-RTN  THRU 0999-EXIT.
  2640     MOVE +1                     TO X1.
  2641     MOVE +0                     TO Y1.
  2642
  2643 0375-STATE-BREAK-PRINT.
  2644     ADD +1 TO X1 Y1.
  2645
  2646     IF X1 GREATER THAN 13
  2647         GO TO 0375-PRINT-LAST-ST-12.
  2648
  2649     COMPUTE CERT = ST-CERT (X1) - ST-CERT (Y1).
  2650     COMPUTE ISS  = ST-ISS  (X1) - ST-ISS  (Y1).
  2651     COMPUTE LBEN = ST-LBEN (X1) - ST-LBEN (Y1).
  2652     COMPUTE LPRM = ST-LPRM (X1) - ST-LPRM (Y1).
  2653     COMPUTE LCLM = ST-LCLM (X1) - ST-LCLM (Y1).
  2654     COMPUTE ABEN = ST-ABEN (X1) - ST-ABEN (Y1).
  2655     COMPUTE APRM = ST-APRM (X1) - ST-APRM (Y1).
  2656     COMPUTE ACLM = ST-ACLM (X1) - ST-ACLM (Y1).
  2657     COMPUTE TCOM = ST-TCOM (X1) - ST-TCOM (Y1).
  2658     COMPUTE TPRM = LPRM + APRM.
  2659
  2660     MOVE COMP-YR (X1)           TO DET-YR.
  2661     MOVE COMP-MO (X1)           TO DET-MO.
  2662
  2663     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  2664
  2665     MOVE CERT                   TO DET-CERTS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS036.cbl
  2666     MOVE LBEN                   TO DET-LBEN.
  2667     MOVE LPRM                   TO DET-LPRM.
  2668     MOVE LCLM                   TO DET-LCLM.
  2669     MOVE ABEN                   TO DET-ABEN.
  2670     MOVE APRM                   TO DET-APRM.
  2671     MOVE ACLM                   TO DET-ACLM.
  2672     MOVE TPRM                   TO DET-TPRM.
  2673     MOVE TCOM                   TO DET-TCOM.
  2674
  2675     IF COMP-YR (X1) = CONV-YR AND
  2676        COMP-MO (X1) = CONV-MO
  2677         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  2678                       DET-ABEN  DET-APRM DET-LCLM
  2679                       DET-ACLM  DET-TPRM DET-TCOM
  2680     ELSE
  2681         PERFORM 0385-ADD-TO-OTHERS THRU 0385-EXIT.
  2682
  2683     MOVE DETAIL-LINE            TO P-DATA.
  2684
  2685     IF X1 = 2
  2686         MOVE '0'                TO X
  2687     ELSE
  2688         MOVE ' '                TO X.
  2689
  2690     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  2691     GO TO 0375-STATE-BREAK-PRINT.
  2692
  2693 0375-PRINT-LAST-ST-12.
  2694     MOVE L12ST-LBEN             TO DET-LBEN.
  2695     MOVE L12ST-LPRM             TO DET-LPRM.
  2696     MOVE L12ST-LCLM             TO DET-LCLM.
  2697     MOVE L12ST-ABEN             TO DET-ABEN.
  2698     MOVE L12ST-APRM             TO DET-APRM.
  2699     MOVE L12ST-ACLM             TO DET-ACLM.
  2700     MOVE L12ST-TPRM             TO DET-TPRM.
  2701     MOVE L12ST-TCOM             TO DET-TCOM.
  2702     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  2703
  2704     MOVE '0'                    TO X.
  2705     MOVE DETAIL-LINE            TO P-DATA.
  2706     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  2707
  2708*  PRINT PRIOR L12
  2709
  2710*    MOVE PL12ST-LBEN             TO DET-LBEN
  2711*    MOVE PL12ST-LPRM             TO DET-LPRM
  2712*    MOVE PL12ST-LCLM             TO DET-LCLM
  2713*    MOVE PL12ST-ABEN             TO DET-ABEN
  2714*    MOVE PL12ST-APRM             TO DET-APRM
  2715*    MOVE PL12ST-ACLM             TO DET-ACLM
  2716*    MOVE PL12ST-TPRM             TO DET-TPRM
  2717*    MOVE PL12ST-TCOM             TO DET-TCOM
  2718*    MOVE 'PRIOR L12         '   TO DET-TITLE
  2719*    MOVE ' '                    TO X
  2720*    MOVE DETAIL-LINE            TO P-DATA
  2721*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  2722     .
  2723 0375-PRINT-ST-YTD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS036.cbl
  2724     MOVE YTDST-LBEN             TO DET-LBEN.
  2725     MOVE YTDST-LPRM             TO DET-LPRM.
  2726     MOVE YTDST-LCLM             TO DET-LCLM.
  2727     MOVE YTDST-ABEN             TO DET-ABEN.
  2728     MOVE YTDST-APRM             TO DET-APRM.
  2729     MOVE YTDST-ACLM             TO DET-ACLM.
  2730     MOVE YTDST-TPRM             TO DET-TPRM.
  2731     MOVE YTDST-TCOM             TO DET-TCOM.
  2732     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  2733     MOVE ' '                    TO X.
  2734     MOVE DETAIL-LINE            TO P-DATA.
  2735     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  2736     MOVE SPACES                 TO DET-TITLE.
  2737
  2738*  PRINT PRIOR YTD
  2739
  2740     MOVE PYTDST-LBEN             TO DET-LBEN
  2741     MOVE PYTDST-LPRM             TO DET-LPRM
  2742     MOVE PYTDST-LCLM             TO DET-LCLM
  2743     MOVE PYTDST-ABEN             TO DET-ABEN
  2744     MOVE PYTDST-APRM             TO DET-APRM
  2745     MOVE PYTDST-ACLM             TO DET-ACLM
  2746     MOVE PYTDST-TPRM             TO DET-TPRM
  2747     MOVE PYTDST-TCOM             TO DET-TCOM
  2748     MOVE 'PRIOR YTD         '   TO DET-TITLE
  2749     MOVE ' '                    TO X
  2750     MOVE DETAIL-LINE            TO P-DATA
  2751     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  2752     MOVE SPACES                 TO DET-TITLE
  2753     .
  2754 0376-PRINT-ST-ITD.
  2755
  2756*    MOVE ITDST-LBEN             TO DET-LBEN
  2757*    MOVE ITDST-LPRM             TO DET-LPRM
  2758*    MOVE ITDST-LCLM             TO DET-LCLM
  2759*    MOVE ITDST-ABEN             TO DET-ABEN
  2760*    MOVE ITDST-APRM             TO DET-APRM
  2761*    MOVE ITDST-ACLM             TO DET-ACLM
  2762*    MOVE ITDST-TPRM             TO DET-TPRM
  2763*    MOVE ITDST-TCOM             TO DET-TCOM
  2764*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE
  2765*    MOVE ' '                    TO X
  2766*    MOVE DETAIL-LINE            TO P-DATA
  2767*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  2768
  2769     MOVE SPACES                 TO DET-TITLE
  2770
  2771     MOVE ZERO-ACCUM             TO LAST-12-STATE-ACCUM
  2772                                    YTD-STATE-ACCUM
  2773*                                   ITD-STATE-ACCUM
  2774                                    PYTD-STATE-ACCUM
  2775*                                   PL12-STATE-ACCUM
  2776     .
  2777 0380-ZERO-STATE.
  2778     MOVE +0                     TO X1.
  2779     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  2780
  2781 0380-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS036.cbl
  2782     GO TO 0310-READ-EARNED-PREM-EXTRACT.
  2783
  2784 0385-ADD-TO-OTHERS.
  2785
  2786*  THIS IS COMPARING THE HIGH CERT DATE
  2787     IF AC-DATE (X1)  GREATER  GP-DATE (Y1)
  2788         MOVE AC-DATE (X1)       TO  GP-DATE (Y1)
  2789                                     GP-DATE-R(Y1).
  2790
  2791     IF AC-DATE (X1)  GREATER  CA-DATE (Y1)
  2792         MOVE AC-DATE (X1)       TO  CA-DATE (Y1)
  2793                                     CA-DATE-R(Y1).
  2794
  2795     IF AC-DATE (X1)  GREATER  RP-DATE (Y1)
  2796         MOVE AC-DATE (X1)       TO  RP-DATE (Y1)
  2797                                     RP-DATE-R (Y1).
  2798
  2799
  2800     IF AC-DATE (X1)  GREATER  GT-DATE (Y1)
  2801         MOVE AC-DATE (X1)       TO  GT-DATE (Y1)
  2802                                     GT-DATE-R (Y1).
  2803
  2804     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  2805         ADD LBEN TO L12ST-LBEN
  2806         ADD LPRM TO L12ST-LPRM
  2807         ADD LCLM TO L12ST-LCLM
  2808         ADD ABEN TO L12ST-ABEN
  2809         ADD APRM TO L12ST-APRM
  2810         ADD ACLM TO L12ST-ACLM
  2811         ADD TPRM TO L12ST-TPRM
  2812         ADD TCOM TO L12ST-TCOM.
  2813
  2814     IF RUN-YR = COMP-YR (X1)
  2815         ADD LBEN TO YTDST-LBEN
  2816         ADD LPRM TO YTDST-LPRM
  2817                     YTDST-TPRM
  2818         ADD LCLM TO YTDST-LCLM
  2819         ADD TCOM TO YTDST-TCOM
  2820         ADD ABEN TO YTDST-ABEN
  2821         ADD APRM TO YTDST-APRM
  2822                     YTDST-TPRM
  2823         ADD ACLM TO YTDST-ACLM.
  2824
  2825*    IF X1 = 13
  2826*       COMPUTE ITDST-LBEN = ITDST-LBEN + ST-LBEN (X1)
  2827*       COMPUTE ITDST-LPRM = ITDST-LPRM + ST-LPRM (X1)
  2828*       COMPUTE ITDST-LCLM = ITDST-LCLM + ST-LCLM (X1)
  2829*       COMPUTE ITDST-ABEN = ITDST-ABEN + ST-ABEN (X1)
  2830*       COMPUTE ITDST-APRM = ITDST-APRM + ST-APRM (X1)
  2831*       COMPUTE ITDST-ACLM = ITDST-ACLM + ST-ACLM (X1)
  2832*       COMPUTE ITDST-TPRM = ITDST-TPRM + ST-TPRM (X1)
  2833*       COMPUTE ITDST-TCOM = ITDST-TCOM + ST-TCOM (X1)
  2834*    END-IF
  2835
  2836     IF X1 = 13
  2837        COMPUTE PYTDST-LBEN = PYTDST-LBEN +
  2838           (ST-LBEN (1) - ST-LBEN (15))
  2839        COMPUTE PYTDST-LPRM = PYTDST-LPRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS036.cbl
  2840           (ST-LPRM (1) - ST-LPRM (15))
  2841        COMPUTE PYTDST-LCLM = PYTDST-LCLM +
  2842           (ST-LCLM (1) - ST-LCLM (15))
  2843        COMPUTE PYTDST-ABEN = PYTDST-ABEN +
  2844           (ST-ABEN (1) - ST-ABEN (15))
  2845        COMPUTE PYTDST-APRM = PYTDST-APRM +
  2846           (ST-APRM (1) - ST-APRM (15))
  2847        COMPUTE PYTDST-ACLM = PYTDST-ACLM +
  2848           (ST-ACLM (1) - ST-ACLM (15))
  2849        COMPUTE PYTDST-TPRM = PYTDST-TPRM +
  2850           (ST-TPRM (1) - ST-TPRM (15))
  2851        COMPUTE PYTDST-TCOM = PYTDST-TCOM +
  2852           (ST-TCOM (1) - ST-TCOM (15))
  2853     END-IF
  2854
  2855*    IF X1 = 13
  2856*       COMPUTE PL12ST-LBEN = PL12ST-LBEN +
  2857*          (ST-LBEN (1) - ST-LBEN (14))
  2858*       COMPUTE PL12ST-LPRM = PL12ST-LPRM +
  2859*          (ST-LPRM (1) - ST-LPRM (14))
  2860*       COMPUTE PL12ST-LCLM = PL12ST-LCLM +
  2861*          (ST-LCLM (1) - ST-LCLM (14))
  2862*       COMPUTE PL12ST-ABEN = PL12ST-ABEN +
  2863*          (ST-ABEN (1) - ST-ABEN (14))
  2864*       COMPUTE PL12ST-APRM = PL12ST-APRM +
  2865*          (ST-APRM (1) - ST-ABEN (14))
  2866*       COMPUTE PL12ST-ACLM = PL12ST-ACLM +
  2867*          (ST-ACLM (1) - ST-ACLM (14))
  2868*       COMPUTE PL12ST-TPRM = PL12ST-TPRM +
  2869*          (ST-TPRM (1) - ST-TPRM (14))
  2870*       COMPUTE PL12ST-TCOM = PL12ST-TCOM +
  2871*          (ST-TCOM (1) - ST-TCOM (14))
  2872*    END-IF
  2873
  2874     .
  2875 0385-EXIT.
  2876      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS036.cbl
  2878 0400-ACCOUNT-BREAK.
  2879     IF PASS-NUMBER = '5'
  2880         PERFORM 0375-STATE-BREAK THRU 0380-ZERO-STATE.
  2881
  2882     MOVE +0                     TO X1.
  2883     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  2884     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  2885
  2886     IF P-ACC-SW = '1'
  2887         MOVE ' '                TO  P-ACC-SW
  2888     ELSE
  2889         GO TO 0495-ZERO-ACCOUNT.
  2890
  2891     IF PASS-NUMBER = '5'
  2892        IF DTE-CLIENT  =  'NCL'
  2893            MOVE S-EPX-A-STATE   TO SAVE-STATE
  2894        ELSE
  2895            MOVE S-EPX-A-STATE   TO SAVE-STATE
  2896            MOVE ' '             TO S-EPX-A-STATE.
  2897
  2898     PERFORM 0900-HEAD-RTN  THRU 0999-EXIT.
  2899
  2900     IF PASS-NUMBER = '5'
  2901         MOVE SAVE-STATE         TO S-EPX-A-STATE.
  2902
  2903     MOVE +1                     TO X1.
  2904     MOVE +0                     TO Y1.
  2905
  2906 0410-ACCOUNT-BREAK-PRINT.
  2907     ADD +1                      TO X1 Y1.
  2908
  2909     IF X1 GREATER THAN 13
  2910         GO TO 0460-PRINT-LAST-AC-12.
  2911
  2912     MOVE AC-DATE (X1)           TO  SAVE-HER-HI-CERT.
  2913
  2914     COMPUTE CERT = AC-CERT (X1) - AC-CERT (Y1).
  2915     COMPUTE ISS  = AC-ISS  (X1) - AC-ISS  (Y1).
  2916     COMPUTE LBEN = AC-LBEN (X1) - AC-LBEN (Y1).
  2917     COMPUTE LPRM = AC-LPRM (X1) - AC-LPRM (Y1).
  2918     COMPUTE LCLM = AC-LCLM (X1) - AC-LCLM (Y1).
  2919     COMPUTE ABEN = AC-ABEN (X1) - AC-ABEN (Y1).
  2920     COMPUTE APRM = AC-APRM (X1) - AC-APRM (Y1).
  2921     COMPUTE ACLM = AC-ACLM (X1) - AC-ACLM (Y1).
  2922     COMPUTE TCOM = AC-TCOM (X1) - AC-TCOM (Y1).
  2923     COMPUTE TPRM = LPRM + APRM.
  2924
  2925     IF DTE-CLIENT = 'HER'
  2926         MOVE COMP-YR (X1)       TO  DET-YR-2
  2927         MOVE COMP-MO (X1)       TO  DET-MO-2
  2928     ELSE
  2929         MOVE COMP-YR (X1)       TO  DET-YR
  2930         MOVE COMP-MO (X1)       TO  DET-MO.
  2931
  2932     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  2933
  2934     IF DTE-CLIENT = 'HER'
  2935         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS036.cbl
  2936     ELSE
  2937         GO TO 0420-CONTINUE.
  2938
  2939     IF (CERT = ZEROS
  2940        OR ISS EQUAL ZEROS)
  2941         MOVE SPACES             TO  DET-FILL
  2942     ELSE
  2943         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  2944         MOVE '/'                TO  DET-HI-SLASH
  2945         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  2946         MOVE 0                  TO  SAVE-HER-HI-CERT.
  2947
  2948     MOVE CERT                   TO  DET-CERTS-2.
  2949     MOVE ISS                    TO  DET-ISS-COUNT-2.
  2950     MOVE LBEN                   TO  DET-LBEN-2.
  2951     MOVE LPRM                   TO  DET-LPRM-2.
  2952     MOVE LCLM                   TO  DET-LCLM-2.
  2953     MOVE APRM                   TO  DET-APRM-2.
  2954     MOVE ACLM                   TO  DET-ACLM-2.
  2955     MOVE TPRM                   TO  DET-TPRM-2.
  2956     MOVE TCOM                   TO  DET-TCOM-2.
  2957
  2958     IF COMP-YR (X1) = CONV-YR AND
  2959        COMP-MO (X1) = CONV-MO
  2960         MOVE ZEROS              TO  DET-CERTS-2  DET-LBEN-2
  2961                                     DET-LPRM-2   DET-LCLM-2
  2962                                     DET-APRM-2   DET-ACLM-2
  2963                                     DET-TPRM-2   DET-TCOM-2
  2964                                     DET-ISS-COUNT-2
  2965     ELSE
  2966         PERFORM 0430-ADD-TO-OTHERS  THRU  0450-EXIT.
  2967
  2968     MOVE DETAIL-LINE-2          TO  P-DATA.
  2969
  2970     IF X1  =  2
  2971         MOVE '0'                TO  X
  2972     ELSE
  2973         MOVE ' '                TO  X.
  2974
  2975     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  2976
  2977     GO TO 0410-ACCOUNT-BREAK-PRINT.
  2978
  2979 0420-CONTINUE.
  2980     MOVE CERT                   TO DET-CERTS.
  2981     MOVE LBEN                   TO DET-LBEN.
  2982     MOVE LPRM                   TO DET-LPRM.
  2983     MOVE LCLM                   TO DET-LCLM.
  2984     MOVE ABEN                   TO DET-ABEN.
  2985     MOVE APRM                   TO DET-APRM.
  2986     MOVE ACLM                   TO DET-ACLM.
  2987     MOVE TPRM                   TO DET-TPRM.
  2988     MOVE TCOM                   TO DET-TCOM.
  2989
  2990     IF COMP-YR (X1) = CONV-YR AND
  2991        COMP-MO (X1) = CONV-MO
  2992         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  2993                       DET-ABEN DET-APRM DET-LCLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS036.cbl
  2994                       DET-ACLM DET-TPRM DET-TCOM
  2995       ELSE
  2996         PERFORM 0430-ADD-TO-OTHERS THRU 0450-EXIT.
  2997
  2998     MOVE DETAIL-LINE            TO P-DATA.
  2999
  3000     IF X1 = 2
  3001         MOVE '0'                TO X
  3002     ELSE
  3003         MOVE ' '                TO X.
  3004
  3005     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3006     GO TO 0410-ACCOUNT-BREAK-PRINT.
  3007
  3008 0430-ADD-TO-OTHERS.
  3009     IF PASS-NUMBER = '3'
  3010         IF S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  3011             GO TO 0440-ADD-CONTINUE.
  3012
  3013     IF BIN-AC-DATE   GREATER  BIN-GP-DATE
  3014         MOVE AC-DATE (X1)       TO  GP-DATE (Y1)
  3015                                     GP-DATE-R (Y1).
  3016
  3017     IF BIN-AC-DATE   GREATER  BIN-CA-DATE
  3018         MOVE AC-DATE (X1)       TO  CA-DATE (Y1)
  3019                                     CA-DATE-R (Y1).
  3020
  3021     IF BIN-AC-DATE   GREATER  BIN-RP-DATE
  3022         MOVE AC-DATE (X1)       TO  RP-DATE (Y1)
  3023                                     RP-DATE-R (Y1).
  3024
  3025     IF BIN-AC-DATE   GREATER  BIN-GT-DATE
  3026         MOVE AC-DATE (X1)       TO  GT-DATE (Y1)
  3027                                     GT-DATE-R (Y1).
  3028
  3029     ADD CERT TO GP-CERT (Y1) CA-CERT (Y1) GR-CERT GT-CERT (Y1).
  3030     ADD ISS  TO GP-ISS  (Y1) CA-ISS  (Y1) GR-ISS  GT-ISS  (Y1).
  3031     ADD LBEN TO GP-LBEN (Y1) CA-LBEN (Y1) GR-LBEN GT-LBEN (Y1).
  3032     ADD LPRM TO GP-LPRM (Y1) CA-LPRM (Y1) GR-LPRM GT-LPRM (Y1).
  3033     ADD LCLM TO GP-LCLM (Y1) CA-LCLM (Y1) GR-LCLM GT-LCLM (Y1).
  3034     ADD ABEN TO GP-ABEN (Y1) CA-ABEN (Y1) GR-ABEN GT-ABEN (Y1).
  3035     ADD APRM TO GP-APRM (Y1) CA-APRM (Y1) GR-APRM GT-APRM (Y1).
  3036     ADD ACLM TO GP-ACLM (Y1) CA-ACLM (Y1) GR-ACLM GT-ACLM (Y1).
  3037     ADD TPRM TO GP-TPRM (Y1) CA-TPRM (Y1) GR-TPRM GT-TPRM (Y1).
  3038     ADD TCOM TO GP-TCOM (Y1) CA-TCOM (Y1) GR-TCOM GT-TCOM (Y1).
  3039
  3040 0440-ADD-CONTINUE.
  3041     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  3042         ADD LBEN TO L12AC-LBEN
  3043         ADD LPRM TO L12AC-LPRM
  3044         ADD LCLM TO L12AC-LCLM
  3045         ADD ABEN TO L12AC-ABEN
  3046         ADD APRM TO L12AC-APRM
  3047         ADD ACLM TO L12AC-ACLM
  3048         ADD TPRM TO L12AC-TPRM
  3049         ADD TCOM TO L12AC-TCOM
  3050         IF PASS-NUMBER = '3'  AND
  3051            S-EPX-CNTL-ACCT NOT = HIGH-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS036.cbl
  3052             NEXT SENTENCE
  3053         ELSE
  3054             IF (PASS-NUMBER = '4' OR '5')  AND
  3055                (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3056                 NEXT SENTENCE
  3057             ELSE
  3058                 ADD LBEN TO L12GP-LBEN L12CA-LBEN
  3059                             L12GT-LBEN
  3060                 ADD LPRM TO L12GP-LPRM L12CA-LPRM
  3061                             L12GT-LPRM
  3062                 ADD LCLM TO L12GP-LCLM L12CA-LCLM
  3063                             L12GT-LCLM
  3064                 ADD ABEN TO L12GP-ABEN L12CA-ABEN
  3065                             L12GT-ABEN
  3066                 ADD APRM TO L12GP-APRM L12CA-APRM
  3067                             L12GT-APRM
  3068                 ADD ACLM TO L12GP-ACLM L12CA-ACLM
  3069                             L12GT-ACLM
  3070                 ADD TPRM TO L12GP-TPRM L12CA-TPRM
  3071                             L12GT-TPRM
  3072                 ADD TCOM TO L12GP-TCOM L12CA-TCOM .
  3073                 ADD TCOM TO L12GT-TCOM.
  3074
  3075     IF RUN-YR = COMP-YR (X1)
  3076         ADD LBEN TO YTDAC-LBEN
  3077         ADD LPRM TO YTDAC-LPRM
  3078                     YTDAC-TPRM
  3079         ADD LCLM TO YTDAC-LCLM
  3080         ADD TCOM TO YTDAC-TCOM
  3081         ADD ABEN TO YTDAC-ABEN
  3082         ADD APRM TO YTDAC-APRM
  3083                     YTDAC-TPRM
  3084         ADD ACLM TO YTDAC-ACLM
  3085         IF PASS-NUMBER = '3'  AND
  3086            S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  3087             NEXT SENTENCE
  3088         ELSE
  3089             IF (PASS-NUMBER = '4' OR '5') AND
  3090                (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3091                 NEXT SENTENCE
  3092             ELSE
  3093                 ADD LBEN TO YTDGP-LBEN YTDCA-LBEN
  3094                             YTDGT-LBEN
  3095                 ADD LPRM TO YTDGP-LPRM YTDCA-LPRM
  3096                             YTDGP-TPRM YTDCA-TPRM
  3097                             YTDGT-LPRM YTDGT-TPRM
  3098                 ADD LCLM TO YTDGP-LCLM YTDCA-LCLM
  3099                             YTDGT-LCLM
  3100                 ADD TCOM TO YTDGP-TCOM YTDCA-TCOM
  3101                             YTDGT-TCOM
  3102                 ADD ABEN TO YTDGP-ABEN YTDCA-ABEN
  3103                             YTDGT-ABEN
  3104                 ADD APRM TO YTDGP-APRM YTDCA-APRM
  3105                             YTDGP-TPRM YTDCA-TPRM
  3106                             YTDGT-APRM YTDGT-TPRM
  3107                 ADD ACLM TO YTDGP-ACLM YTDCA-ACLM.
  3108                 ADD ACLM TO YTDGT-ACLM.
  3109
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS036.cbl
  3110*    IF X1 = 13
  3111*       COMPUTE ITDAC-LBEN = ITDAC-LBEN + AC-LBEN (X1)
  3112*       COMPUTE ITDAC-LPRM = ITDAC-LPRM + AC-LPRM (X1)
  3113*       COMPUTE ITDAC-LCLM = ITDAC-LCLM + AC-LCLM (X1)
  3114*       COMPUTE ITDAC-ABEN = ITDAC-ABEN + AC-ABEN (X1)
  3115*       COMPUTE ITDAC-APRM = ITDAC-APRM + AC-APRM (X1)
  3116*       COMPUTE ITDAC-ACLM = ITDAC-ACLM + AC-ACLM (X1)
  3117*       COMPUTE ITDAC-TPRM = ITDAC-TPRM + AC-TPRM (X1)
  3118*       COMPUTE ITDAC-TCOM = ITDAC-TCOM + AC-TCOM (X1)
  3119*       IF (PASS-NUMBER = '3')
  3120*          AND (S-EPX-CNTL-ACCT NOT = HIGH-VALUES)
  3121*          CONTINUE
  3122*       ELSE
  3123*          IF (PASS-NUMBER = '4' OR '5')
  3124*             AND (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3125*             CONTINUE
  3126*          ELSE
  3127*             ADD ITDAC-LBEN TO ITDGP-LBEN ITDCA-LBEN
  3128*             ADD ITDAC-LPRM TO ITDGP-LPRM ITDCA-LPRM
  3129*             ADD ITDAC-LCLM TO ITDGP-LCLM ITDCA-LCLM
  3130*             ADD ITDAC-ABEN TO ITDGP-ABEN ITDCA-ABEN
  3131*             ADD ITDAC-APRM TO ITDGP-APRM ITDCA-APRM
  3132*             ADD ITDAC-ACLM TO ITDGP-ACLM ITDCA-ACLM
  3133*             ADD ITDAC-TPRM TO ITDGP-TPRM ITDCA-TPRM
  3134*             ADD ITDAC-TCOM TO ITDGP-TCOM ITDCA-TCOM
  3135*          END-IF
  3136*       END-IF
  3137*    END-IF
  3138
  3139     IF X1 = 13
  3140        COMPUTE PYTDAC-LBEN = PYTDAC-LBEN +
  3141           (AC-LBEN (1) - AC-LBEN (15))
  3142        COMPUTE PYTDAC-LPRM = PYTDAC-LPRM +
  3143           (AC-LPRM (1) - AC-LPRM (15))
  3144        COMPUTE PYTDAC-LCLM = PYTDAC-LCLM +
  3145           (AC-LCLM (1) - AC-LCLM (15))
  3146        COMPUTE PYTDAC-ABEN = PYTDAC-ABEN +
  3147           (AC-ABEN (1) - AC-ABEN (15))
  3148        COMPUTE PYTDAC-APRM = PYTDAC-APRM +
  3149           (AC-APRM (1) - AC-APRM (15))
  3150        COMPUTE PYTDAC-ACLM = PYTDAC-ACLM +
  3151           (AC-ACLM (1) - AC-ACLM (15))
  3152        COMPUTE PYTDAC-TPRM = PYTDAC-TPRM +
  3153           (AC-TPRM (1) - AC-TPRM (15))
  3154        COMPUTE PYTDAC-TCOM = PYTDAC-TCOM +
  3155           (AC-TCOM (1) - AC-TCOM (15))
  3156        IF (PASS-NUMBER = '3')
  3157           AND (S-EPX-CNTL-ACCT NOT = HIGH-VALUES)
  3158           CONTINUE
  3159        ELSE
  3160           IF (PASS-NUMBER = '4' OR '5')
  3161              AND (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3162              CONTINUE
  3163           ELSE
  3164              ADD PYTDAC-LBEN TO PYTDGP-LBEN PYTDCA-LBEN
  3165                                 PYTDGT-LBEN
  3166              ADD PYTDAC-LPRM TO PYTDGP-LPRM PYTDCA-LPRM
  3167                                 PYTDGT-LPRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS036.cbl
  3168              ADD PYTDAC-LCLM TO PYTDGP-LCLM PYTDCA-LCLM
  3169                                 PYTDGT-LCLM
  3170              ADD PYTDAC-ABEN TO PYTDGP-ABEN PYTDCA-ABEN
  3171                                 PYTDGT-ABEN
  3172              ADD PYTDAC-APRM TO PYTDGP-APRM PYTDCA-APRM
  3173                                 PYTDGT-APRM
  3174              ADD PYTDAC-ACLM TO PYTDGP-ACLM PYTDCA-ACLM
  3175                                 PYTDGT-ACLM
  3176              ADD PYTDAC-TPRM TO PYTDGP-TPRM PYTDCA-TPRM
  3177                                 PYTDGT-TPRM
  3178              ADD PYTDAC-TCOM TO PYTDGP-TCOM PYTDCA-TCOM
  3179                                 PYTDGT-TCOM
  3180           END-IF
  3181        END-IF
  3182     END-IF
  3183
  3184*    IF X1 = 13
  3185*       COMPUTE PL12AC-LBEN = PL12AC-LBEN +
  3186*          (AC-LBEN (1) - AC-LBEN (14))
  3187*       COMPUTE PL12AC-LPRM = PL12AC-LPRM +
  3188*          (AC-LPRM (1) - AC-LPRM (14))
  3189*       COMPUTE PL12AC-LCLM = PL12AC-LCLM +
  3190*          (AC-LCLM (1) - AC-LCLM (14))
  3191*       COMPUTE PL12AC-ABEN = PL12AC-ABEN +
  3192*          (AC-ABEN (1) - AC-ABEN (14))
  3193*       COMPUTE PL12AC-APRM = PL12AC-APRM +
  3194*          (AC-APRM (1) - AC-APRM (14))
  3195*       COMPUTE PL12AC-ACLM = PL12AC-ACLM +
  3196*          (AC-ACLM (1) - AC-ACLM (14))
  3197*       COMPUTE PL12AC-TPRM = PL12AC-TPRM +
  3198*          (AC-TPRM (1) - AC-TPRM (14))
  3199*       COMPUTE PL12AC-TCOM = PL12AC-TCOM +
  3200*          (AC-TCOM (1) - AC-TCOM (14))
  3201*       IF (PASS-NUMBER = '3')
  3202*          AND (S-EPX-CNTL-ACCT NOT = HIGH-VALUES)
  3203*          CONTINUE
  3204*       ELSE
  3205*          IF (PASS-NUMBER = '4' OR '5')
  3206*             AND (DTE-TOT-OPT NOT = 5 AND 6 AND 7)
  3207*             CONTINUE
  3208*          ELSE
  3209*             ADD PL12AC-LBEN TO PL12GP-LBEN PL12CA-LBEN
  3210*             ADD PL12AC-LPRM TO PL12GP-LPRM PL12CA-LPRM
  3211*             ADD PL12AC-LCLM TO PL12GP-LCLM PL12CA-LCLM
  3212*             ADD PL12AC-ABEN TO PL12GP-ABEN PL12CA-ABEN
  3213*             ADD PL12AC-APRM TO PL12GP-APRM PL12CA-APRM
  3214*             ADD PL12AC-ACLM TO PL12GP-ACLM PL12CA-ACLM
  3215*             ADD PL12AC-TPRM TO PL12GP-TPRM PL12CA-TPRM
  3216*             ADD PL12AC-TCOM TO PL12GP-TCOM PL12CA-TCOM
  3217*          END-IF
  3218*       END-IF
  3219*    END-IF
  3220
  3221
  3222
  3223     .
  3224 0450-EXIT.
  3225      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS036.cbl
  3226
  3227 0460-PRINT-LAST-AC-12.
  3228     IF DTE-CLIENT = 'HER'
  3229         NEXT SENTENCE
  3230     ELSE
  3231         GO TO 0480-PRINT-LAST-AC-12.
  3232
  3233     MOVE L12AC-LBEN             TO  DET-LBEN-2.
  3234     MOVE L12AC-LPRM             TO  DET-LPRM-2.
  3235     MOVE L12AC-LCLM             TO  DET-LCLM-2.
  3236     MOVE L12AC-APRM             TO  DET-APRM-2.
  3237     MOVE L12AC-ACLM             TO  DET-ACLM-2.
  3238     MOVE L12AC-TPRM             TO  DET-TPRM-2.
  3239     MOVE L12AC-TCOM             TO  DET-TCOM-2.
  3240     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  3241     MOVE '0'                    TO  X.
  3242     MOVE DETAIL-LINE-2          TO  P-DATA.
  3243
  3244     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3245
  3246     MOVE ZERO-ACCUM             TO  LAST-12-ACCOUNT-ACCUM.
  3247
  3248 0470-PRINT-AC-YTD.
  3249     MOVE YTDAC-LBEN             TO  DET-LBEN-2.
  3250     MOVE YTDAC-LPRM             TO  DET-LPRM-2.
  3251     MOVE YTDAC-LCLM             TO  DET-LCLM-2.
  3252     MOVE YTDAC-APRM             TO  DET-APRM-2.
  3253     MOVE YTDAC-ACLM             TO  DET-ACLM-2.
  3254     MOVE YTDAC-TPRM             TO  DET-TPRM-2.
  3255     MOVE YTDAC-TCOM             TO  DET-TCOM-2.
  3256     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  3257     MOVE ' '                    TO  X.
  3258     MOVE DETAIL-LINE-2          TO  P-DATA.
  3259
  3260     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3261
  3262     MOVE SPACES                 TO  DET-TITLE-2.
  3263     MOVE ZERO-ACCUM             TO  YTD-ACCOUNT-ACCUM.
  3264
  3265     GO TO 0495-ZERO-ACCOUNT.
  3266
  3267 0480-PRINT-LAST-AC-12.
  3268
  3269     MOVE L12AC-LBEN             TO DET-LBEN.
  3270     MOVE L12AC-LPRM             TO DET-LPRM.
  3271     MOVE L12AC-LCLM             TO DET-LCLM.
  3272     MOVE L12AC-ABEN             TO DET-ABEN.
  3273     MOVE L12AC-APRM             TO DET-APRM.
  3274     MOVE L12AC-ACLM             TO DET-ACLM.
  3275     MOVE L12AC-TPRM             TO DET-TPRM.
  3276     MOVE L12AC-TCOM             TO DET-TCOM.
  3277     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  3278
  3279     IF DTE-CLIENT = 'AFL'
  3280         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  3281
  3282     MOVE '0'                    TO X.
  3283     MOVE DETAIL-LINE            TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS036.cbl
  3284     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3285     MOVE ZERO-ACCUM             TO LAST-12-ACCOUNT-ACCUM.
  3286
  3287********   PRINT PRIOR L12 MO
  3288
  3289*    MOVE PL12AC-LBEN            TO DET-LBEN
  3290*    MOVE PL12AC-LPRM            TO DET-LPRM
  3291*    MOVE PL12AC-LCLM            TO DET-LCLM
  3292*    MOVE PL12AC-ABEN            TO DET-ABEN
  3293*    MOVE PL12AC-APRM            TO DET-APRM
  3294*    MOVE PL12AC-ACLM            TO DET-ACLM
  3295*    MOVE PL12AC-TPRM            TO DET-TPRM
  3296*    MOVE PL12AC-TCOM            TO DET-TCOM
  3297*    MOVE 'PRIOR L12         '   TO DET-TITLE
  3298
  3299*    MOVE ' '                    TO X
  3300*    MOVE DETAIL-LINE            TO P-DATA
  3301*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  3302
  3303*    MOVE ZERO-ACCUM             TO PL12-ACCOUNT-ACCUM
  3304     .
  3305 0490-PRINT-AC-YTD.
  3306
  3307     MOVE YTDAC-LBEN             TO DET-LBEN.
  3308     MOVE YTDAC-LPRM             TO DET-LPRM.
  3309     MOVE YTDAC-LCLM             TO DET-LCLM.
  3310     MOVE YTDAC-ABEN             TO DET-ABEN.
  3311     MOVE YTDAC-APRM             TO DET-APRM.
  3312     MOVE YTDAC-ACLM             TO DET-ACLM.
  3313     MOVE YTDAC-TPRM             TO DET-TPRM.
  3314     MOVE YTDAC-TCOM             TO DET-TCOM.
  3315     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  3316     MOVE ' '                    TO X.
  3317     MOVE DETAIL-LINE            TO P-DATA.
  3318     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3319     MOVE SPACES                 TO DET-TITLE.
  3320
  3321********   PRINT PRIOR YTD
  3322
  3323     MOVE PYTDAC-LBEN            TO DET-LBEN
  3324     MOVE PYTDAC-LPRM            TO DET-LPRM
  3325     MOVE PYTDAC-LCLM            TO DET-LCLM
  3326     MOVE PYTDAC-ABEN            TO DET-ABEN
  3327     MOVE PYTDAC-APRM            TO DET-APRM
  3328     MOVE PYTDAC-ACLM            TO DET-ACLM
  3329     MOVE PYTDAC-TPRM            TO DET-TPRM
  3330     MOVE PYTDAC-TCOM            TO DET-TCOM
  3331     MOVE 'PRIOR YTD         '   TO DET-TITLE
  3332
  3333     MOVE ' '                    TO X
  3334     MOVE DETAIL-LINE            TO P-DATA
  3335     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  3336     MOVE SPACES                 TO DET-TITLE
  3337     .
  3338 0492-PRINT-ITD-AC.
  3339
  3340*    MOVE ITDAC-LBEN             TO DET-LBEN
  3341*    MOVE ITDAC-LPRM             TO DET-LPRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS036.cbl
  3342*    MOVE ITDAC-LCLM             TO DET-LCLM
  3343*    MOVE ITDAC-ABEN             TO DET-ABEN
  3344*    MOVE ITDAC-APRM             TO DET-APRM
  3345*    MOVE ITDAC-ACLM             TO DET-ACLM
  3346*    MOVE ITDAC-TPRM             TO DET-TPRM
  3347*    MOVE ITDAC-TCOM             TO DET-TCOM
  3348*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE
  3349*    MOVE ' '                    TO X
  3350*    MOVE DETAIL-LINE            TO P-DATA
  3351*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  3352
  3353     MOVE SPACES                 TO DET-TITLE
  3354
  3355     IF DTE-CLIENT = 'MON'
  3356         IF PASS-NUMBER = '3'
  3357             IF SAVE-AM-EXPIRES = ZEROS AND
  3358                SAVE-AM-HI-CERT = ZEROS
  3359                 NEXT SENTENCE
  3360             ELSE
  3361                 MOVE 'HIGH CERT DATE'
  3362                                     TO  DET-DATE-DESC
  3363                 MOVE SAVE-AM-HI-MO  TO  DET-DATE-MO
  3364                 MOVE SAVE-AM-HI-DA  TO  DET-DATE-DA
  3365                 MOVE SAVE-AM-HI-YR  TO  DET-DATE-YR
  3366                 MOVE '/'            TO  DET-DATE-SLASH-1
  3367                                         DET-DATE-SLASH-2
  3368                 MOVE ' '            TO  X
  3369                 MOVE DET-DATE-LINE  TO  P-DATA
  3370                 PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  3371                 MOVE SPACES         TO  DET-DATE-LINE
  3372                 MOVE 'EXPIRATION DATE'
  3373                                     TO  DET-DATE-DESC
  3374                 MOVE SAVE-AM-EXP-MO TO  DET-DATE-MO
  3375                 MOVE SAVE-AM-EXP-DA TO  DET-DATE-DA
  3376                 MOVE SAVE-AM-EXP-YR TO  DET-DATE-YR
  3377                 MOVE '/'            TO  DET-DATE-SLASH-1
  3378                                         DET-DATE-SLASH-2
  3379                 MOVE ' '            TO  X
  3380                 MOVE DET-DATE-LINE  TO  P-DATA
  3381                 PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  3382                 MOVE SPACES         TO  DET-DATE-LINE.
  3383
  3384     MOVE ZERO-ACCUM             TO YTD-ACCOUNT-ACCUM
  3385                                    YTD-STATE-ACCUM
  3386                                    LAST-12-STATE-ACCUM
  3387*                                   ITD-ACCOUNT-ACCUM
  3388                                    PYTD-ACCOUNT-ACCUM
  3389*                                   PL12-ACCOUNT-ACCUM
  3390     MOVE +0                     TO X1.
  3391     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  3392
  3393 0495-ZERO-ACCOUNT.
  3394     MOVE ' '                    TO SKIP-HD-SW.
  3395     MOVE +0                     TO X1.
  3396     PERFORM 0230-ZERO-ACCUM-ACC 15 TIMES.
  3397
  3398 0499-ACCOUNT-RETURN.
  3399     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS036.cbl
  3401 0500-GROUPING-BREAK.
  3402     PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  3403
  3404 0510-GROUPING-BREAK-1.
  3405     IF P-GP-SW = '1'
  3406         MOVE ' '                TO P-GP-SW
  3407     ELSE
  3408         GO TO 0580-ZERO-GROUPING.
  3409
  3410     PERFORM 1010-GP-HD.
  3411     MOVE +1                     TO X1.
  3412
  3413 0520-GROUPING-BREAK-2.
  3414     IF DTE-CLIENT = 'HER'
  3415         NEXT SENTENCE
  3416     ELSE
  3417         GO TO 0550-GROUPING-BREAK-2.
  3418
  3419     IF X1 GREATER 12
  3420         GO TO 0530-PRINT-LAST-GP-12.
  3421
  3422     MOVE GP-DATE (X1)           TO  SAVE-HER-HI-CERT.
  3423
  3424     IF (GP-CERT (X1) = ZEROS
  3425        OR GP-ISS (X1) EQUAL ZEROS)
  3426         MOVE SPACES             TO  DET-FILL
  3427     ELSE
  3428         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  3429         MOVE '/'                TO  DET-HI-SLASH
  3430         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  3431         MOVE 0                  TO  SAVE-HER-HI-CERT.
  3432
  3433     MOVE GP-CERT (X1)           TO  DET-CERTS-2.
  3434     MOVE GP-ISS  (X1)           TO  DET-ISS-COUNT-2.
  3435     MOVE GP-LBEN (X1)           TO  DET-LBEN-2.
  3436     MOVE GP-LPRM (X1)           TO  DET-LPRM-2.
  3437     MOVE GP-LCLM (X1)           TO  DET-LCLM-2.
  3438     MOVE GP-APRM (X1)           TO  DET-APRM-2.
  3439     MOVE GP-ACLM (X1)           TO  DET-ACLM-2.
  3440     MOVE GP-TPRM (X1)           TO  DET-TPRM-2.
  3441     MOVE GP-TCOM (X1)           TO  DET-TCOM-2.
  3442     ADD +1                      TO  X1.
  3443     MOVE COMP-YR (X1)           TO  DET-YR-2.
  3444     MOVE COMP-MO (X1)           TO  DET-MO-2.
  3445
  3446     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  3447
  3448     MOVE DETAIL-LINE-2          TO  P-DATA.
  3449
  3450     IF X1 = 2
  3451         MOVE '0'                TO  X
  3452     ELSE
  3453         MOVE ' '                TO  X.
  3454
  3455     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3456
  3457     GO TO 0520-GROUPING-BREAK-2.
  3458
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS036.cbl
  3459 0530-PRINT-LAST-GP-12.
  3460     MOVE L12GP-LBEN             TO  DET-LBEN-2.
  3461     MOVE L12GP-LPRM             TO  DET-LPRM-2.
  3462     MOVE L12GP-LCLM             TO  DET-LCLM-2.
  3463     MOVE L12GP-APRM             TO  DET-APRM-2.
  3464     MOVE L12GP-ACLM             TO  DET-ACLM-2.
  3465     MOVE L12GP-TPRM             TO  DET-TPRM-2.
  3466     MOVE L12GP-TCOM             TO  DET-TCOM-2.
  3467     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  3468     MOVE '0'                    TO  X.
  3469     MOVE DETAIL-LINE-2          TO  P-DATA.
  3470
  3471     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3472
  3473     MOVE ZERO-ACCUM             TO  LAST-12-GROUPING-ACCUM.
  3474
  3475 0540-PRINT-GP-YTD.
  3476     MOVE YTDGP-LBEN             TO  DET-LBEN-2.
  3477     MOVE YTDGP-LPRM             TO  DET-LPRM-2.
  3478     MOVE YTDGP-LCLM             TO  DET-LCLM-2.
  3479     MOVE YTDGP-APRM             TO  DET-APRM-2.
  3480     MOVE YTDGP-ACLM             TO  DET-ACLM-2.
  3481     MOVE YTDGP-TPRM             TO  DET-TPRM-2.
  3482     MOVE YTDGP-TCOM             TO  DET-TCOM-2.
  3483     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  3484     MOVE ' '                    TO  X.
  3485     MOVE DETAIL-LINE-2          TO  P-DATA.
  3486
  3487     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3488
  3489     MOVE SPACES                 TO  DET-TITLE-2.
  3490     MOVE ZERO-ACCUM             TO  YTD-GROUPING-ACCUM.
  3491
  3492     GO TO 0580-ZERO-GROUPING.
  3493
  3494 0550-GROUPING-BREAK-2.
  3495     IF X1 GREATER 12
  3496         GO TO 0560-PRINT-LAST-GP-12.
  3497
  3498     MOVE GP-CERT (X1)           TO DET-CERTS.
  3499     MOVE GP-LBEN (X1)           TO DET-LBEN.
  3500     MOVE GP-LPRM (X1)           TO DET-LPRM.
  3501     MOVE GP-LCLM (X1)           TO DET-LCLM.
  3502     MOVE GP-ABEN (X1)           TO DET-ABEN.
  3503     MOVE GP-APRM (X1)           TO DET-APRM.
  3504     MOVE GP-ACLM (X1)           TO DET-ACLM.
  3505     MOVE GP-TPRM (X1)           TO DET-TPRM.
  3506     MOVE GP-TCOM (X1)           TO DET-TCOM.
  3507     ADD +1 TO X1.
  3508     MOVE COMP-YR (X1)           TO DET-YR.
  3509     MOVE COMP-MO (X1)           TO DET-MO.
  3510
  3511     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  3512
  3513     MOVE DETAIL-LINE            TO P-DATA.
  3514
  3515     IF X1 = 2
  3516         MOVE '0'                TO X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS036.cbl
  3517     ELSE
  3518         MOVE ' '                TO X.
  3519
  3520     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3521     GO TO 0550-GROUPING-BREAK-2.
  3522
  3523 0560-PRINT-LAST-GP-12.
  3524     MOVE L12GP-LBEN             TO DET-LBEN.
  3525     MOVE L12GP-LPRM             TO DET-LPRM.
  3526     MOVE L12GP-LCLM             TO DET-LCLM.
  3527     MOVE L12GP-ABEN             TO DET-ABEN.
  3528     MOVE L12GP-APRM             TO DET-APRM.
  3529     MOVE L12GP-ACLM             TO DET-ACLM.
  3530     MOVE L12GP-TPRM             TO DET-TPRM.
  3531     MOVE L12GP-TCOM             TO DET-TCOM.
  3532     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  3533
  3534     IF DTE-CLIENT = 'AFL'
  3535         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  3536
  3537     MOVE '0'                    TO X.
  3538     MOVE DETAIL-LINE            TO P-DATA.
  3539     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3540     MOVE ZERO-ACCUM             TO LAST-12-GROUPING-ACCUM.
  3541
  3542*    MOVE PL12GP-LBEN             TO DET-LBEN.
  3543*    MOVE PL12GP-LPRM             TO DET-LPRM.
  3544*    MOVE PL12GP-LCLM             TO DET-LCLM.
  3545*    MOVE PL12GP-ABEN             TO DET-ABEN.
  3546*    MOVE PL12GP-APRM             TO DET-APRM.
  3547*    MOVE PL12GP-ACLM             TO DET-ACLM.
  3548*    MOVE PL12GP-TPRM             TO DET-TPRM.
  3549*    MOVE PL12GP-TCOM             TO DET-TCOM.
  3550*    MOVE 'PRIOR L12         '   TO DET-TITLE.
  3551*    MOVE ' '                    TO X.
  3552*    MOVE DETAIL-LINE            TO P-DATA.
  3553*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3554*    MOVE ZERO-ACCUM             TO PL12-GROUPING-ACCUM
  3555     .
  3556 0570-PRINT-GP-YTD.
  3557     MOVE YTDGP-LBEN             TO DET-LBEN.
  3558     MOVE YTDGP-LPRM             TO DET-LPRM.
  3559     MOVE YTDGP-LCLM             TO DET-LCLM.
  3560     MOVE YTDGP-ABEN             TO DET-ABEN.
  3561     MOVE YTDGP-APRM             TO DET-APRM.
  3562     MOVE YTDGP-ACLM             TO DET-ACLM.
  3563     MOVE YTDGP-TPRM             TO DET-TPRM.
  3564     MOVE YTDGP-TCOM             TO DET-TCOM.
  3565     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  3566     MOVE ' '                    TO X.
  3567     MOVE DETAIL-LINE            TO P-DATA.
  3568     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3569     MOVE SPACES                 TO DET-TITLE.
  3570     MOVE ZERO-ACCUM             TO YTD-GROUPING-ACCUM.
  3571
  3572     MOVE PYTDGP-LBEN             TO DET-LBEN.
  3573     MOVE PYTDGP-LPRM             TO DET-LPRM.
  3574     MOVE PYTDGP-LCLM             TO DET-LCLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS036.cbl
  3575     MOVE PYTDGP-ABEN             TO DET-ABEN.
  3576     MOVE PYTDGP-APRM             TO DET-APRM.
  3577     MOVE PYTDGP-ACLM             TO DET-ACLM.
  3578     MOVE PYTDGP-TPRM             TO DET-TPRM.
  3579     MOVE PYTDGP-TCOM             TO DET-TCOM.
  3580     MOVE 'PRIOR YTD         '   TO DET-TITLE.
  3581     MOVE ' '                    TO X.
  3582     MOVE DETAIL-LINE            TO P-DATA.
  3583     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3584
  3585     MOVE ZERO-ACCUM             TO PYTD-GROUPING-ACCUM
  3586
  3587*    MOVE ITDGP-LBEN             TO DET-LBEN.
  3588*    MOVE ITDGP-LPRM             TO DET-LPRM.
  3589*    MOVE ITDGP-LCLM             TO DET-LCLM.
  3590*    MOVE ITDGP-ABEN             TO DET-ABEN.
  3591*    MOVE ITDGP-APRM             TO DET-APRM.
  3592*    MOVE ITDGP-ACLM             TO DET-ACLM.
  3593*    MOVE ITDGP-TPRM             TO DET-TPRM.
  3594*    MOVE ITDGP-TCOM             TO DET-TCOM.
  3595*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE.
  3596*    MOVE ' '                    TO X.
  3597*    MOVE DETAIL-LINE            TO P-DATA.
  3598*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3599
  3600     MOVE SPACES                 TO DET-TITLE.
  3601*    MOVE ZERO-ACCUM             TO ITD-GROUPING-ACCUM.
  3602
  3603 0580-ZERO-GROUPING.
  3604     MOVE +0                     TO X1.
  3605     PERFORM 0240-ZERO-ACCUM-GRP 15 TIMES.
  3606
  3607 0590-GROUPING-RETURN.
  3608     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS036.cbl
  3610 0600-CARRIER-BREAK.
  3611     PERFORM 0400-ACCOUNT-BREAK    THRU 0495-ZERO-ACCOUNT.
  3612 0605-CARRIER-BREAK-5.
  3613     PERFORM 0510-GROUPING-BREAK-1 THRU 0580-ZERO-GROUPING.
  3614
  3615 0610-CARRIER-BREAK-1.
  3616     IF P-CA-SW = '1'
  3617         MOVE ' '                TO P-CA-SW
  3618     ELSE
  3619         GO TO 0680-ZERO-CARRIER.
  3620
  3621     PERFORM 1020-CA-HD.
  3622     MOVE +1                     TO X1.
  3623
  3624 0620-CARRIER-BREAK-2.
  3625     IF DTE-CLIENT = 'HER'
  3626         NEXT SENTENCE
  3627     ELSE
  3628         GO TO 0650-CARRIER-BREAK-2.
  3629
  3630     IF X1 GREATER 12
  3631         GO TO 0630-PRINT-LAST-CA-12.
  3632
  3633     MOVE CA-DATE (X1)           TO  SAVE-HER-HI-CERT.
  3634
  3635     IF (CA-CERT (X1) = ZEROS
  3636        OR CA-ISS (X1) EQUAL ZEROS)
  3637         MOVE SPACES             TO  DET-FILL
  3638     ELSE
  3639         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  3640         MOVE '/'                TO  DET-HI-SLASH
  3641         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  3642         MOVE 0                  TO  SAVE-HER-HI-CERT.
  3643
  3644     MOVE CA-CERT (X1)           TO  DET-CERTS-2.
  3645     MOVE CA-ISS  (X1)           TO  DET-ISS-COUNT-2.
  3646     MOVE CA-LBEN (X1)           TO  DET-LBEN-2.
  3647     MOVE CA-LPRM (X1)           TO  DET-LPRM-2.
  3648     MOVE CA-LCLM (X1)           TO  DET-LCLM-2.
  3649     MOVE CA-APRM (X1)           TO  DET-APRM-2.
  3650     MOVE CA-ACLM (X1)           TO  DET-ACLM-2.
  3651     MOVE CA-TPRM (X1)           TO  DET-TPRM-2.
  3652     MOVE CA-TCOM (X1)           TO  DET-TCOM-2.
  3653     ADD +1                      TO  X1.
  3654     MOVE COMP-YR (X1)           TO  DET-YR-2.
  3655     MOVE COMP-MO (X1)           TO  DET-MO-2.
  3656
  3657     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  3658
  3659     MOVE DETAIL-LINE-2          TO  P-DATA.
  3660
  3661     IF X1 = 2
  3662         MOVE '0'                TO  X
  3663     ELSE
  3664         MOVE ' '                TO  X.
  3665
  3666     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3667
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS036.cbl
  3668     GO TO 0620-CARRIER-BREAK-2.
  3669
  3670 0630-PRINT-LAST-CA-12.
  3671     MOVE L12CA-LBEN             TO  DET-LBEN-2.
  3672     MOVE L12CA-LPRM             TO  DET-LPRM-2.
  3673     MOVE L12CA-LCLM             TO  DET-LCLM-2.
  3674     MOVE L12CA-APRM             TO  DET-APRM-2.
  3675     MOVE L12CA-ACLM             TO  DET-ACLM-2.
  3676     MOVE L12CA-TPRM             TO  DET-TPRM-2.
  3677     MOVE L12CA-TCOM             TO  DET-TCOM-2.
  3678     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  3679     MOVE '0'                    TO  X.
  3680     MOVE DETAIL-LINE-2          TO  P-DATA.
  3681
  3682     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3683
  3684     MOVE ZERO-ACCUM             TO  LAST-12-CARRIER-ACCUM.
  3685
  3686 0640-PRINT-CA-YTD.
  3687     MOVE YTDCA-LBEN             TO  DET-LBEN-2.
  3688     MOVE YTDCA-LPRM             TO  DET-LPRM-2.
  3689     MOVE YTDCA-LCLM             TO  DET-LCLM-2.
  3690     MOVE YTDCA-APRM             TO  DET-APRM-2.
  3691     MOVE YTDCA-ACLM             TO  DET-ACLM-2.
  3692     MOVE YTDCA-TPRM             TO  DET-TPRM-2.
  3693     MOVE YTDCA-TCOM             TO  DET-TCOM-2.
  3694     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  3695     MOVE ' '                    TO  X.
  3696     MOVE DETAIL-LINE-2          TO  P-DATA.
  3697
  3698
  3699     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  3700
  3701     MOVE SPACES                 TO  DET-TITLE-2.
  3702     MOVE ZERO-ACCUM             TO  YTD-CARRIER-ACCUM.
  3703
  3704     GO TO 0680-ZERO-CARRIER.
  3705
  3706 0650-CARRIER-BREAK-2.
  3707     IF X1 GREATER 12
  3708         GO TO 0660-PRINT-LAST-CA-12.
  3709
  3710     MOVE CA-CERT (X1)           TO DET-CERTS.
  3711     MOVE CA-LBEN (X1)           TO DET-LBEN.
  3712     MOVE CA-LPRM (X1)           TO DET-LPRM.
  3713     MOVE CA-LCLM (X1)           TO DET-LCLM.
  3714     MOVE CA-ABEN (X1)           TO DET-ABEN.
  3715     MOVE CA-APRM (X1)           TO DET-APRM.
  3716     MOVE CA-ACLM (X1)           TO DET-ACLM.
  3717     MOVE CA-TPRM (X1)           TO DET-TPRM.
  3718     MOVE CA-TCOM (X1)           TO DET-TCOM.
  3719     ADD +1 TO X1.
  3720     MOVE COMP-YR (X1)           TO DET-YR.
  3721     MOVE COMP-MO (X1)           TO DET-MO.
  3722
  3723     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  3724
  3725     MOVE DETAIL-LINE            TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS036.cbl
  3726
  3727     IF X1 = 2
  3728         MOVE '0'                TO X
  3729     ELSE
  3730         MOVE ' '                TO X.
  3731
  3732     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3733     GO TO 0650-CARRIER-BREAK-2.
  3734
  3735 0660-PRINT-LAST-CA-12.
  3736     MOVE L12CA-LBEN             TO DET-LBEN.
  3737     MOVE L12CA-LPRM             TO DET-LPRM.
  3738     MOVE L12CA-LCLM             TO DET-LCLM.
  3739     MOVE L12CA-ABEN             TO DET-ABEN.
  3740     MOVE L12CA-APRM             TO DET-APRM.
  3741     MOVE L12CA-ACLM             TO DET-ACLM.
  3742     MOVE L12CA-TPRM             TO DET-TPRM.
  3743     MOVE L12CA-TCOM             TO DET-TCOM.
  3744     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  3745
  3746     IF DTE-CLIENT = 'AFL'
  3747         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  3748
  3749     MOVE '0'                    TO X.
  3750     MOVE DETAIL-LINE            TO P-DATA.
  3751     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3752     MOVE ZERO-ACCUM             TO LAST-12-CARRIER-ACCUM.
  3753
  3754*    MOVE PL12CA-LBEN             TO DET-LBEN.
  3755*    MOVE PL12CA-LPRM             TO DET-LPRM.
  3756*    MOVE PL12CA-LCLM             TO DET-LCLM.
  3757*    MOVE PL12CA-ABEN             TO DET-ABEN.
  3758*    MOVE PL12CA-APRM             TO DET-APRM.
  3759*    MOVE PL12CA-ACLM             TO DET-ACLM.
  3760*    MOVE PL12CA-TPRM             TO DET-TPRM.
  3761*    MOVE PL12CA-TCOM             TO DET-TCOM.
  3762*    MOVE 'PRIOR L12         '   TO DET-TITLE.
  3763*    MOVE ' '                    TO X.
  3764*    MOVE DETAIL-LINE            TO P-DATA.
  3765*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3766*    MOVE ZERO-ACCUM             TO PL12-CARRIER-ACCUM.
  3767
  3768 0670-PRINT-CA-YTD.
  3769     MOVE YTDCA-LBEN             TO DET-LBEN.
  3770     MOVE YTDCA-LPRM             TO DET-LPRM.
  3771     MOVE YTDCA-LCLM             TO DET-LCLM.
  3772     MOVE YTDCA-ABEN             TO DET-ABEN.
  3773     MOVE YTDCA-APRM             TO DET-APRM.
  3774     MOVE YTDCA-ACLM             TO DET-ACLM.
  3775     MOVE YTDCA-TPRM             TO DET-TPRM.
  3776     MOVE YTDCA-TCOM             TO DET-TCOM.
  3777     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  3778     MOVE ' '                    TO X.
  3779     MOVE DETAIL-LINE            TO P-DATA.
  3780     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3781     MOVE SPACES                 TO DET-TITLE.
  3782     MOVE ZERO-ACCUM             TO YTD-CARRIER-ACCUM.
  3783
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS036.cbl
  3784     MOVE PYTDCA-LBEN             TO DET-LBEN.
  3785     MOVE PYTDCA-LPRM             TO DET-LPRM.
  3786     MOVE PYTDCA-LCLM             TO DET-LCLM.
  3787     MOVE PYTDCA-ABEN             TO DET-ABEN.
  3788     MOVE PYTDCA-APRM             TO DET-APRM.
  3789     MOVE PYTDCA-ACLM             TO DET-ACLM.
  3790     MOVE PYTDCA-TPRM             TO DET-TPRM.
  3791     MOVE PYTDCA-TCOM             TO DET-TCOM.
  3792     MOVE 'PRIOR YTD         '   TO DET-TITLE.
  3793     MOVE ' '                    TO X.
  3794     MOVE DETAIL-LINE            TO P-DATA.
  3795     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3796
  3797     MOVE ZERO-ACCUM             TO PYTD-CARRIER-ACCUM.
  3798
  3799*    MOVE ITDCA-LBEN             TO DET-LBEN.
  3800*    MOVE ITDCA-LPRM             TO DET-LPRM.
  3801*    MOVE ITDCA-LCLM             TO DET-LCLM.
  3802*    MOVE ITDCA-ABEN             TO DET-ABEN.
  3803*    MOVE ITDCA-APRM             TO DET-APRM.
  3804*    MOVE ITDCA-ACLM             TO DET-ACLM.
  3805*    MOVE ITDCA-TPRM             TO DET-TPRM.
  3806*    MOVE ITDCA-TCOM             TO DET-TCOM.
  3807*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE.
  3808*    MOVE ' '                    TO X.
  3809*    MOVE DETAIL-LINE            TO P-DATA.
  3810*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3811
  3812
  3813     MOVE SPACES                 TO DET-TITLE.
  3814*    MOVE ZERO-ACCUM             TO ITD-CARRIER-ACCUM.
  3815
  3816 0680-ZERO-CARRIER.
  3817     MOVE +0                     TO X1.
  3818     PERFORM 0250-ZERO-ACCUM-CARR 15 TIMES.
  3819
  3820 0690-CARRIER-RETURN.
  3821     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS036.cbl
  3823 0700-REPTCD-BREAK.
  3824     MOVE +0                     TO X1.
  3825     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  3826     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  3827
  3828     IF P-RP-SW = '1'
  3829         MOVE ' '                TO P-RP-SW
  3830     ELSE
  3831         GO TO 0790-ZERO-REPTCD.
  3832
  3833     PERFORM 0900-HEAD-RTN THRU 0999-EXIT.
  3834
  3835     MOVE +1                     TO X1.
  3836     MOVE +0                     TO Y1.
  3837
  3838 0710-REPTCD-BREAK-PRINT.
  3839     IF DTE-CLIENT = 'HER'
  3840         NEXT SENTENCE
  3841     ELSE
  3842         GO TO 0720-REPTCD-BREAK-POINT.
  3843
  3844     ADD +1 TO X1 Y1.
  3845
  3846     IF X1 GREATER THAN 13
  3847         GO TO 0750-PRINT-LAST-RP-12.
  3848
  3849     COMPUTE RPCERT = RP-CERT (X1) - RP-CERT (Y1).
  3850     COMPUTE RPLBEN = RP-LBEN (X1) - RP-LBEN (Y1).
  3851     COMPUTE RPLPRM = RP-LPRM (X1) - RP-LPRM (Y1).
  3852     COMPUTE RPLCLM = RP-LCLM (X1) - RP-LCLM (Y1).
  3853     COMPUTE RPABEN = RP-ABEN (X1) - RP-ABEN (Y1).
  3854     COMPUTE RPAPRM = RP-APRM (X1) - RP-APRM (Y1).
  3855     COMPUTE RPACLM = RP-ACLM (X1) - RP-ACLM (Y1).
  3856     COMPUTE RPTCOM = RP-TCOM (X1) - RP-TCOM (Y1).
  3857     COMPUTE RPTPRM = RPLPRM  + RPAPRM.
  3858
  3859     MOVE COMP-YR (X1)           TO  DET-YR-2.
  3860     MOVE COMP-MO (X1)           TO  DET-MO-2.
  3861
  3862     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  3863
  3864     MOVE RP-DATE (X1)           TO  SAVE-HER-HI-CERT.
  3865
  3866     IF RP-CERT (X1) = ZEROS
  3867         MOVE SPACES             TO  DET-FILL
  3868     ELSE
  3869         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  3870         MOVE '/'                TO  DET-HI-SLASH
  3871         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  3872         MOVE 0                  TO  SAVE-HER-HI-CERT.
  3873
  3874     MOVE RPCERT                 TO  DET-CERTS-2.
  3875     MOVE RPLBEN                 TO  DET-LBEN-2.
  3876     MOVE RPLPRM                 TO  DET-LPRM-2.
  3877     MOVE RPLCLM                 TO  DET-LCLM-2.
  3878     MOVE RPAPRM                 TO  DET-APRM-2.
  3879     MOVE RPACLM                 TO  DET-ACLM-2.
  3880     MOVE RPTPRM                 TO  DET-TPRM-2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS036.cbl
  3881     MOVE RPTCOM                 TO  DET-TCOM-2.
  3882
  3883     IF COMP-YR (X1) = CONV-YR
  3884       AND COMP-MO (X1) = CONV-MO
  3885         MOVE ZEROS              TO  DET-CERTS-2  DET-LBEN-2
  3886                                     DET-LPRM-2   DET-APRM-2
  3887                                     DET-LCLM-2   DET-ACLM-2
  3888                                     DET-TPRM-2   DET-TCOM-2
  3889                                     DET-ISS-COUNT-2
  3890     ELSE
  3891         PERFORM 0730-ADD-TO-L12-YTD  THRU  0740-EXIT.
  3892
  3893     MOVE DETAIL-LINE-2          TO  P-DATA.
  3894
  3895     IF X1 = 2
  3896         MOVE '0'                TO  X
  3897     ELSE
  3898         MOVE ' '                TO  X.
  3899
  3900     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3901
  3902     GO TO 0710-REPTCD-BREAK-PRINT.
  3903
  3904 0720-REPTCD-BREAK-POINT.
  3905     ADD +1 TO X1 Y1.
  3906
  3907     IF X1 GREATER THAN 13
  3908         GO TO 0750-PRINT-LAST-RP-12.
  3909
  3910     COMPUTE RPCERT = RP-CERT (X1) - RP-CERT (Y1).
  3911     COMPUTE RPLBEN = RP-LBEN (X1) - RP-LBEN (Y1).
  3912     COMPUTE RPLPRM = RP-LPRM (X1) - RP-LPRM (Y1).
  3913     COMPUTE RPLCLM = RP-LCLM (X1) - RP-LCLM (Y1).
  3914     COMPUTE RPABEN = RP-ABEN (X1) - RP-ABEN (Y1).
  3915     COMPUTE RPAPRM = RP-APRM (X1) - RP-APRM (Y1).
  3916     COMPUTE RPACLM = RP-ACLM (X1) - RP-ACLM (Y1).
  3917     COMPUTE RPTCOM = RP-TCOM (X1) - RP-TCOM (Y1).
  3918     COMPUTE RPTPRM = RPLPRM  + RPAPRM.
  3919     MOVE COMP-YR (X1)           TO DET-YR.
  3920     MOVE COMP-MO (X1)           TO DET-MO.
  3921     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  3922
  3923     MOVE RPCERT                 TO DET-CERTS.
  3924     MOVE RPLBEN                 TO DET-LBEN.
  3925     MOVE RPLPRM                 TO DET-LPRM.
  3926     MOVE RPLCLM                 TO DET-LCLM.
  3927     MOVE RPABEN                 TO DET-ABEN.
  3928     MOVE RPAPRM                 TO DET-APRM.
  3929     MOVE RPACLM                 TO DET-ACLM.
  3930     MOVE RPTPRM                 TO DET-TPRM.
  3931     MOVE RPTCOM                 TO DET-TCOM.
  3932
  3933     IF COMP-YR (X1) = CONV-YR AND
  3934        COMP-MO (X1) = CONV-MO
  3935         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  3936                       DET-ABEN DET-APRM DET-LCLM
  3937                       DET-ACLM DET-TPRM DET-TCOM
  3938        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS036.cbl
  3939          PERFORM 0730-ADD-TO-L12-YTD THRU 0740-EXIT.
  3940
  3941     MOVE DETAIL-LINE            TO P-DATA.
  3942
  3943     IF X1 = 2
  3944         MOVE '0'                TO X
  3945     ELSE
  3946         MOVE ' '                TO X.
  3947
  3948     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  3949     GO TO 0720-REPTCD-BREAK-POINT.
  3950
  3951 0730-ADD-TO-L12-YTD.
  3952     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  3953         ADD RPLBEN TO L12RP-LBEN
  3954         ADD RPLPRM TO L12RP-LPRM
  3955         ADD RPLCLM TO L12RP-LCLM
  3956         ADD RPABEN TO L12RP-ABEN
  3957         ADD RPAPRM TO L12RP-APRM
  3958         ADD RPACLM TO L12RP-ACLM
  3959         ADD RPTPRM TO L12RP-TPRM
  3960         ADD RPTCOM TO L12RP-TCOM.
  3961
  3962     IF RUN-YR = COMP-YR (X1)
  3963         ADD RPLBEN TO YTDRP-LBEN
  3964         ADD RPLPRM TO YTDRP-LPRM
  3965                       YTDRP-TPRM
  3966         ADD RPLCLM TO YTDRP-LCLM
  3967         ADD RPTCOM TO YTDRP-TCOM
  3968         ADD RPABEN TO YTDRP-ABEN
  3969         ADD RPAPRM TO YTDRP-APRM
  3970                       YTDRP-TPRM
  3971         ADD RPACLM TO YTDRP-ACLM.
  3972
  3973*    IF X1 = 13
  3974*       COMPUTE ITDRP-LBEN = ITDRP-LBEN + RP-LBEN (X1)
  3975*       COMPUTE ITDRP-LPRM = ITDRP-LPRM + RP-LPRM (X1)
  3976*       COMPUTE ITDRP-LCLM = ITDRP-LCLM + RP-LCLM (X1)
  3977*       COMPUTE ITDRP-ABEN = ITDRP-ABEN + RP-ABEN (X1)
  3978*       COMPUTE ITDRP-APRM = ITDRP-APRM + RP-APRM (X1)
  3979*       COMPUTE ITDRP-ACLM = ITDRP-ACLM + RP-ACLM (X1)
  3980*       COMPUTE ITDRP-TPRM = ITDRP-TPRM + RP-TPRM (X1)
  3981*       COMPUTE ITDRP-TCOM = ITDRP-TCOM + RP-TCOM (X1)
  3982*    END-IF
  3983
  3984     IF X1 = 13
  3985        COMPUTE PYTDRP-LBEN = PYTDRP-LBEN +
  3986           (RP-LBEN (1) - RP-LBEN (15))
  3987        COMPUTE PYTDRP-LPRM = PYTDRP-LPRM +
  3988           (RP-LPRM (1) - RP-LPRM (15))
  3989        COMPUTE PYTDRP-LCLM = PYTDRP-LCLM +
  3990           (RP-LCLM (1) - RP-LCLM (15))
  3991        COMPUTE PYTDRP-ABEN = PYTDRP-ABEN +
  3992           (RP-ABEN (1) - RP-ABEN (15))
  3993        COMPUTE PYTDRP-APRM = PYTDRP-APRM +
  3994           (RP-APRM (1) - RP-APRM (15))
  3995        COMPUTE PYTDRP-ACLM = PYTDRP-ACLM +
  3996           (RP-ACLM (1) - RP-ACLM (15))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS036.cbl
  3997        COMPUTE PYTDRP-TPRM = PYTDRP-TPRM +
  3998           (RP-TPRM (1) - RP-TPRM (15))
  3999        COMPUTE PYTDRP-TCOM = PYTDRP-TCOM +
  4000           (RP-TCOM (1) - RP-TCOM (15))
  4001     END-IF
  4002
  4003*    IF X1 = 13
  4004*       COMPUTE PL12RP-LBEN = PL12RP-LBEN +
  4005*          (RP-LBEN (1) - RP-LBEN (14))
  4006*       COMPUTE PL12RP-LPRM = PL12RP-LPRM +
  4007*          (RP-LPRM (1) - RP-LPRM (14))
  4008*       COMPUTE PL12RP-LCLM = PL12RP-LCLM +
  4009*          (RP-LCLM (1) - RP-LCLM (14))
  4010*       COMPUTE PL12RP-ABEN = PL12RP-ABEN +
  4011*          (RP-ABEN (1) - RP-ABEN (14))
  4012*       COMPUTE PL12RP-APRM = PL12RP-APRM +
  4013*          (RP-APRM (1) - RP-APRM (14))
  4014*       COMPUTE PL12RP-ACLM = PL12RP-ACLM +
  4015*          (RP-ACLM (1) - RP-ACLM (14))
  4016*       COMPUTE PL12RP-TPRM = PL12RP-TPRM +
  4017*          (RP-TPRM (1) - RP-TPRM (14))
  4018*       COMPUTE PL12RP-TCOM = PL12RP-TCOM +
  4019*          (RP-TCOM (1) - RP-TCOM (14))
  4020*    END-IF
  4021
  4022     .
  4023 0740-EXIT.
  4024      EXIT.
  4025
  4026 0750-PRINT-LAST-RP-12.
  4027     IF DTE-CLIENT = 'HER'
  4028         NEXT SENTENCE
  4029     ELSE
  4030         GO TO 0770-PRINT-LAST-RP-12.
  4031
  4032     MOVE L12RP-LBEN             TO  DET-LBEN-2.
  4033     MOVE L12RP-LPRM             TO  DET-LPRM-2.
  4034     MOVE L12RP-LCLM             TO  DET-LCLM-2.
  4035     MOVE L12RP-APRM             TO  DET-APRM-2.
  4036     MOVE L12RP-ACLM             TO  DET-ACLM-2.
  4037     MOVE L12RP-TPRM             TO  DET-TPRM-2.
  4038     MOVE L12RP-TCOM             TO  DET-TCOM-2.
  4039     MOVE 'LAST 12 MONTHS'       TO  DET-TITLE-2.
  4040     MOVE '0'                    TO  X.
  4041     MOVE DETAIL-LINE-2          TO  P-DATA.
  4042
  4043     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4044
  4045     MOVE ZERO-ACCUM             TO  LAST-12-REPTCD-ACCUM.
  4046
  4047 0760-PRINT-RP-YTD.
  4048     MOVE YTDRP-LBEN             TO  DET-LBEN-2.
  4049     MOVE YTDRP-LPRM             TO  DET-LPRM-2.
  4050     MOVE YTDRP-LCLM             TO  DET-LCLM-2.
  4051     MOVE YTDRP-APRM             TO  DET-APRM-2.
  4052     MOVE YTDRP-ACLM             TO  DET-ACLM-2.
  4053     MOVE YTDRP-TPRM             TO  DET-TPRM-2.
  4054     MOVE YTDRP-TCOM             TO  DET-TCOM-2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS036.cbl
  4055     MOVE 'YEAR TO DATE'         TO  DET-TITLE-2.
  4056     MOVE ' '                    TO  X.
  4057     MOVE DETAIL-LINE-2          TO  P-DATA.
  4058
  4059     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4060
  4061     MOVE SPACES                 TO  DET-TITLE-2.
  4062     MOVE ZERO-ACCUM             TO  YTD-REPTCD-ACCUM.
  4063
  4064     GO TO 0790-ZERO-REPTCD.
  4065
  4066 0770-PRINT-LAST-RP-12.
  4067     MOVE L12RP-LBEN             TO DET-LBEN.
  4068     MOVE L12RP-LPRM             TO DET-LPRM.
  4069     MOVE L12RP-LCLM             TO DET-LCLM.
  4070     MOVE L12RP-ABEN             TO DET-ABEN.
  4071     MOVE L12RP-APRM             TO DET-APRM.
  4072     MOVE L12RP-ACLM             TO DET-ACLM.
  4073     MOVE L12RP-TPRM             TO DET-TPRM.
  4074     MOVE L12RP-TCOM             TO DET-TCOM.
  4075     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  4076
  4077     IF DTE-CLIENT = 'AFL'
  4078         MOVE 'FISCAL TO DATE'   TO DET-TITLE.
  4079
  4080     MOVE '0'                    TO X.
  4081     MOVE DETAIL-LINE            TO P-DATA.
  4082     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4083     MOVE ZERO-ACCUM             TO LAST-12-REPTCD-ACCUM.
  4084
  4085*    MOVE PL12RP-LBEN             TO DET-LBEN
  4086*    MOVE PL12RP-LPRM             TO DET-LPRM
  4087*    MOVE PL12RP-LCLM             TO DET-LCLM
  4088*    MOVE PL12RP-ABEN             TO DET-ABEN
  4089*    MOVE PL12RP-APRM             TO DET-APRM
  4090*    MOVE PL12RP-ACLM             TO DET-ACLM
  4091*    MOVE PL12RP-TPRM             TO DET-TPRM
  4092*    MOVE PL12RP-TCOM             TO DET-TCOM
  4093*    MOVE 'PRIOR L12         '   TO DET-TITLE
  4094*    MOVE ' '                    TO X
  4095*    MOVE DETAIL-LINE            TO P-DATA
  4096*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4097
  4098     MOVE SPACES                 TO DET-TITLE
  4099*    MOVE ZERO-ACCUM             TO PL12-REPTCD-ACCUM
  4100     .
  4101 0780-PRINT-RP-YTD.
  4102     MOVE YTDRP-LBEN             TO DET-LBEN.
  4103     MOVE YTDRP-LPRM             TO DET-LPRM.
  4104     MOVE YTDRP-LCLM             TO DET-LCLM.
  4105     MOVE YTDRP-ABEN             TO DET-ABEN.
  4106     MOVE YTDRP-APRM             TO DET-APRM.
  4107     MOVE YTDRP-ACLM             TO DET-ACLM.
  4108     MOVE YTDRP-TPRM             TO DET-TPRM.
  4109     MOVE YTDRP-TCOM             TO DET-TCOM.
  4110     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  4111     MOVE ' '                    TO X.
  4112     MOVE DETAIL-LINE            TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS036.cbl
  4113     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4114     MOVE SPACES                 TO DET-TITLE.
  4115     MOVE ZERO-ACCUM             TO YTD-REPTCD-ACCUM.
  4116
  4117     MOVE PYTDRP-LBEN             TO DET-LBEN
  4118     MOVE PYTDRP-LPRM             TO DET-LPRM
  4119     MOVE PYTDRP-LCLM             TO DET-LCLM
  4120     MOVE PYTDRP-ABEN             TO DET-ABEN
  4121     MOVE PYTDRP-APRM             TO DET-APRM
  4122     MOVE PYTDRP-ACLM             TO DET-ACLM
  4123     MOVE PYTDRP-TPRM             TO DET-TPRM
  4124     MOVE PYTDRP-TCOM             TO DET-TCOM
  4125     MOVE 'PRIOR YTD         '   TO DET-TITLE
  4126     MOVE ' '                    TO X
  4127     MOVE DETAIL-LINE            TO P-DATA
  4128     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4129
  4130     MOVE SPACES                 TO DET-TITLE
  4131     MOVE ZERO-ACCUM             TO PYTD-REPTCD-ACCUM.
  4132 0782-PRINT-RP-ITD.
  4133
  4134*    MOVE ITDRP-LBEN             TO DET-LBEN
  4135*    MOVE ITDRP-LPRM             TO DET-LPRM
  4136*    MOVE ITDRP-LCLM             TO DET-LCLM
  4137*    MOVE ITDRP-ABEN             TO DET-ABEN
  4138*    MOVE ITDRP-APRM             TO DET-APRM
  4139*    MOVE ITDRP-ACLM             TO DET-ACLM
  4140*    MOVE ITDRP-TPRM             TO DET-TPRM
  4141*    MOVE ITDRP-TCOM             TO DET-TCOM
  4142*    MOVE 'INCEPTION TO DATE '   TO DET-TITLE
  4143*    MOVE ' '                    TO X
  4144*    MOVE DETAIL-LINE            TO P-DATA
  4145*    PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4146
  4147*    MOVE ZERO-ACCUM             TO ITD-REPTCD-ACCUM
  4148     .
  4149 0790-ZERO-REPTCD.
  4150     MOVE +0                     TO X1.
  4151     PERFORM 0260-ZERO-ACCUM-REPT 15 TIMES.
  4152
  4153 0799-REPTCD-RETURN.
  4154     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS036.cbl
  4156 0800-PRINT-DECISION.
  4157     MOVE +1                     TO X1.
  4158     MOVE +0                     TO Y1.
  4159
  4160 0810-PRINT-DECISION-1.
  4161     ADD +1 TO X1 Y1.
  4162
  4163     IF X1 GREATER 13
  4164         MOVE +0                 TO X1
  4165         GO TO 0820-PRINT-DECISION-2.
  4166
  4167     COMPUTE LBEN = AC-LBEN (X1) - AC-LBEN (Y1).
  4168     COMPUTE LPRM = AC-LPRM (X1) - AC-LPRM (Y1).
  4169     COMPUTE LCLM = AC-LCLM (X1) - AC-LCLM (Y1).
  4170     COMPUTE ABEN = AC-ABEN (X1) - AC-ABEN (Y1).
  4171     COMPUTE APRM = AC-APRM (X1) - AC-APRM (Y1).
  4172     COMPUTE ACLM = AC-ACLM (X1) - AC-ACLM (Y1).
  4173     COMPUTE TCOM = AC-TCOM (X1) - AC-TCOM (Y1).
  4174
  4175     IF COMP-YR (X1) = CONV-YR AND
  4176        COMP-MO (X1) = CONV-MO
  4177         MOVE ZEROS TO LBEN LPRM LCLM ABEN APRM ACLM TCOM.
  4178
  4179     IF DTE-CLIENT  =  'NCL'
  4180         MOVE LBEN               TO PLBEN (Y1)
  4181         MOVE LPRM               TO PLPRM (Y1)
  4182         MOVE LCLM               TO PLCLM (Y1)
  4183         MOVE ABEN               TO PABEN (Y1)
  4184         MOVE APRM               TO PAPRM (Y1)
  4185         MOVE ACLM               TO PACLM (Y1)
  4186         MOVE TCOM               TO PTCOM (Y1)
  4187     ELSE
  4188         MOVE LBEN               TO PLBEN (X1)
  4189         MOVE LPRM               TO PLPRM (X1)
  4190         MOVE LCLM               TO PLCLM (X1)
  4191         MOVE ABEN               TO PABEN (X1)
  4192         MOVE APRM               TO PAPRM (X1)
  4193         MOVE ACLM               TO PACLM (X1)
  4194         MOVE TCOM               TO PTCOM (X1).
  4195
  4196     GO TO 0810-PRINT-DECISION-1.
  4197
  4198 0820-PRINT-DECISION-2.
  4199     ADD +1 TO X1.
  4200
  4201     IF X1 GREATER 12
  4202         GO TO 0899-EXIT.
  4203
  4204     IF (PRINT-ZERO-TABLE NOT = PRINT-TABLE (X1))
  4205        OR ((AC-LPRM (1) - AC-LPRM (15)) NOT = ZEROS)
  4206        OR ((AC-APRM (1) - AC-APRM (15)) NOT = ZEROS)
  4207        OR ((AC-LCLM (1) - AC-LCLM (15)) NOT = ZEROS)
  4208        OR ((AC-ACLM (1) - AC-ACLM (15)) NOT = ZEROS)
  4209         MOVE '1'             TO P-ACC-SW P-ST-SW P-GP-SW P-CA-SW
  4210                                 P-RP-SW
  4211                                 P-RP2-SW
  4212         GO TO 0899-EXIT.
  4213
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS036.cbl
  4214     GO TO 0820-PRINT-DECISION-2.
  4215
  4216 0899-EXIT.
  4217     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS036.cbl
  4219 0900-HEAD-RTN.
  4220     IF DTE-PGM-OPT NOT = 2
  4221         GO TO 0910-HEAD-RTN-A.
  4222
  4223     IF SET-CTR = +1
  4224         MOVE '-'                TO X
  4225         MOVE SPACES             TO P-DATA
  4226         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4227         MOVE SPACES             TO P-DATA
  4228         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4229         MOVE ZERO               TO SET-CTR
  4230         MOVE ' '                TO X
  4231         GO TO 0920-HEAD-RTN-B.
  4232
  4233     MOVE +1                     TO SET-CTR.
  4234
  4235 0910-HEAD-RTN-A.
  4236     ADD +1 TO PAGE-CNT.
  4237     MOVE PAGE-CNT               TO HD-PAGE.
  4238     MOVE '1'                    TO X.
  4239
  4240     IF PASS-NUMBER = '1'
  4241         MOVE 'A'                TO HD-1-GRP-SUF
  4242                                    HD-1-CAR-SUF
  4243                                    HD-1-GT
  4244         MOVE HD-1-STATE         TO P-DATA.
  4245
  4246     IF PASS-NUMBER = '2'
  4247         MOVE 'B'                TO HD-1-GRP-SUF
  4248                                    HD-1-CAR-SUF
  4249                                    HD-1-GT
  4250         MOVE HD-1-BUSINESS      TO P-DATA.
  4251
  4252     IF PASS-NUMBER = '3'
  4253         MOVE 'C'                TO HD-1-GRP-SUF
  4254                                    HD-1-CAR-SUF
  4255                                    HD-1-GT
  4256         MOVE HD-1-AGENCY        TO P-DATA.
  4257
  4258     IF PASS-NUMBER = '4'
  4259         MOVE 'RPT CODE 1 '      TO HD-1-SLCT-FLD-1
  4260         MOVE S-EPX-A-RPT-CD-1   TO HD-1-SLCT-FLD-2
  4261         MOVE 'Y'                TO HD-1-SLCT-REC-POS1
  4262         MOVE 'D'                TO HD-1-DF
  4263                                    HD-1-GRP-SUF
  4264                                    HD-1-CAR-SUF
  4265                                    HD-1-GT
  4266         MOVE HD-1-RPT-CODE-1    TO P-DATA
  4267         MOVE 'RPT CODE 1 '      TO HD-2-SLCT-FLD-1
  4268         MOVE S-EPX-A-RPT-CD-1   TO HD-2-SLCT-FLD-2
  4269         MOVE 'Y'                TO HD-2-SLCT-REC-POS1
  4270         MOVE 'RPT CODE 1 '      TO HD-3-SLCT-FLD-1
  4271         MOVE S-EPX-A-RPT-CD-1   TO HD-3-SLCT-FLD-2
  4272         MOVE 'Y'                TO HD-3-SLCT-REC-POS1.
  4273
  4274     IF PASS-NUMBER = '5'
  4275         MOVE 'E'                TO HD-1-GRP-SUF
  4276                                    HD-1-CAR-SUF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS036.cbl
  4277                                    HD-1-GT
  4278         MOVE HD-1-RPT-CODE-2    TO P-DATA.
  4279
  4280     IF PASS-NUMBER = '6'
  4281         MOVE 'USER SEL 2 '      TO HD-1-US2-FLD-1
  4282         MOVE S-EPX-A-RPT-CD-1   TO HD-1-US2-FLD-2
  4283         MOVE 'Y'                TO HD-1-US2-REC-POS1
  4284         MOVE 'F'                TO HD-1-GRP-SUF
  4285                                    HD-1-CAR-SUF
  4286                                    HD-1-GT
  4287         MOVE HD-1-USER-SEL-2    TO P-DATA
  4288         MOVE 'USER SEL 2 '      TO HD-2-SLCT-FLD-1
  4289         MOVE S-EPX-A-RPT-CD-1   TO HD-2-SLCT-FLD-2
  4290         MOVE 'Y'                TO HD-2-SLCT-REC-POS1
  4291         MOVE 'USER SEL 2 '      TO HD-3-SLCT-FLD-1
  4292         MOVE S-EPX-A-RPT-CD-1   TO HD-3-SLCT-FLD-2
  4293         MOVE 'Y'                TO HD-3-SLCT-REC-POS1.
  4294
  4295     IF PASS-NUMBER = '7'
  4296         MOVE 'USER SEL 5 '      TO HD-1-US5-FLD-1
  4297         MOVE S-EPX-A-RPT-CD-1   TO HD-1-US5-FLD-2
  4298         MOVE 'Y'                TO HD-1-US5-REC-POS1
  4299         MOVE 'G'                TO HD-1-GRP-SUF
  4300                                    HD-1-CAR-SUF
  4301                                    HD-1-GT
  4302         MOVE HD-1-USER-SEL-5    TO P-DATA
  4303         MOVE 'USER SEL 5 '      TO HD-2-SLCT-FLD-1
  4304         MOVE S-EPX-A-RPT-CD-1   TO HD-2-SLCT-FLD-2
  4305         MOVE 'Y'                TO HD-2-SLCT-REC-POS1
  4306         MOVE 'USER SEL 5 '      TO HD-3-SLCT-FLD-1
  4307         MOVE S-EPX-A-RPT-CD-1   TO HD-3-SLCT-FLD-2
  4308         MOVE 'Y'                TO HD-3-SLCT-REC-POS1.
  4309
  4310     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4311     MOVE ' '                    TO X.
  4312     MOVE HD-2                   TO P-DATA.
  4313     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4314     MOVE ' '                    TO X.
  4315     MOVE HD-3                   TO P-DATA.
  4316     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4317     MOVE '-'                    TO X.
  4318
  4319 0920-HEAD-RTN-B.
  4320     IF PASS-NUMBER = '1'
  4321         MOVE ' '                TO X
  4322         MOVE S-EPX-CNTL-1       TO STATE-L
  4323                                    HD-6-NSTATE
  4324         PERFORM 1400-STATE-LOOKUP THRU 1499-EXIT
  4325         IF STATE-L = SPACES
  4326             MOVE 'INVALID STATE'         TO HD-STATE
  4327             MOVE HD-6                    TO P-DATA
  4328             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4329          ELSE
  4330             MOVE STATE-PIC (CLAS-INDEXS) TO HD-STATE
  4331             MOVE HD-6                    TO P-DATA
  4332             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4333
  4334     IF PASS-NUMBER = '2'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS036.cbl
  4335         MOVE S-EPX-CNTL-1       TO HD-6-NSTATE
  4336         MOVE 'BUSINESS TYPE'    TO FILLER-HD-6
  4337         PERFORM 1510-BUSS-LOOKUP THRU 1599-EXIT
  4338         MOVE ' '                TO X
  4339         MOVE HD-6               TO P-DATA
  4340         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4341
  4342     IF PASS-NUMBER = '3'
  4343         MOVE SPACE              TO HD-6-NSTATE
  4344         MOVE 'AGENCY'           TO FILLER-HD-6
  4345         MOVE S-EPX-CNTL-GA      TO HD-STATE
  4346         MOVE ' '                TO X
  4347         MOVE HD-6               TO P-DATA
  4348         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4349         IF S-EPX-CNTL-ACCT NOT = HIGH-VALUES
  4350             MOVE S-EPX-CNTL-ACCT   TO HD-ACCOUNT
  4351             MOVE SAVE-ACCT-NAME    TO HD-ACCT-NAME
  4352             MOVE SAVE-ACCT-STATUS  TO HD-ACCT-ADDRESS
  4353             MOVE ' '               TO X
  4354             MOVE HD-5              TO P-DATA
  4355*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4356             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4357                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4358                 MOVE ' '               TO X
  4359                 MOVE HD-5A             TO P-DATA
  4360                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4361
  4362     IF PASS-NUMBER = '4'
  4363         MOVE S-EPX-A-RPT-CD-1   TO HD-8A-RPT-CODE-1
  4364         MOVE ' '                TO X
  4365         MOVE HD-8A              TO P-DATA
  4366         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4367********************************
  4368         IF SKIP-HD-SW = '1'
  4369             NEXT SENTENCE
  4370         ELSE
  4371         IF DTE-TOT-OPT = 5 OR 6 OR 7
  4372             MOVE S-EPX-A-CARR       TO HD-4-CARRIER
  4373             MOVE S-EPX-A-GROUP      TO HD-4-GROUPING
  4374             MOVE HD-4               TO P-DATA
  4375             MOVE ' '                TO X
  4376             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4377             MOVE SPACES             TO HD-6
  4378             MOVE 'STATE '           TO FILLER-HD-6-1
  4379             MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4380             MOVE HD-6               TO P-DATA
  4381             MOVE ' '                TO X
  4382             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4383             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4384             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4385             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4386             MOVE HD-5               TO P-DATA
  4387             MOVE ' '                TO X
  4388*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4389             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4390                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4391                 MOVE ' '               TO X
  4392                 MOVE HD-5A             TO P-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS036.cbl
  4393                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4394********************************
  4395
  4396     IF PASS-NUMBER = '5'
  4397         MOVE S-EPX-A-CARR       TO HD-4-CARRIER
  4398         MOVE S-EPX-A-GROUP      TO HD-4-GROUPING
  4399         MOVE HD-4               TO P-DATA
  4400         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4401         MOVE 'STATE'            TO FILLER-HD-6
  4402         MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4403         MOVE STATE-TOTAL-LINE   TO FILLER-HD-6-2
  4404         MOVE SPACES             TO STATE-TOTAL-LINE
  4405                                    HD-STATE
  4406         MOVE HD-6               TO P-DATA
  4407         MOVE ' '                TO X
  4408         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4409         MOVE S-EPX-A-RPT-CD-2   TO HD-8B-RPT-CODE-2
  4410         MOVE ' '                TO X
  4411         MOVE HD-8B              TO P-DATA
  4412         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4413********************************
  4414         IF SKIP-HD-SW = '1'
  4415             NEXT SENTENCE
  4416         ELSE
  4417         IF DTE-TOT-OPT = 6 OR 7
  4418             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4419             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4420             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4421             MOVE HD-5               TO P-DATA
  4422*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4423             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4424                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4425                 MOVE ' '               TO X
  4426                 MOVE HD-5A             TO P-DATA
  4427                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4428********************************
  4429
  4430     IF PASS-NUMBER = '6'
  4431         MOVE S-EPX-A-RPT-CD-1   TO HD-8C-USER-SEL-2
  4432         MOVE ' '                TO X
  4433         MOVE HD-8C              TO P-DATA
  4434         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4435********************************
  4436         IF SKIP-HD-SW = '1'
  4437             NEXT SENTENCE
  4438         ELSE
  4439         IF DTE-TOT-OPT = 5 OR 6 OR 7
  4440             MOVE S-EPX-A-CARR       TO HD-4-CARRIER
  4441             MOVE S-EPX-A-GROUP      TO HD-4-GROUPING
  4442             MOVE HD-4               TO P-DATA
  4443             MOVE ' '                TO X
  4444             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4445             MOVE SPACES             TO HD-6
  4446             MOVE 'STATE '           TO FILLER-HD-6-1
  4447             MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4448             MOVE HD-6               TO P-DATA
  4449             MOVE ' '                TO X
  4450             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS036.cbl
  4451             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4452             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4453             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4454             MOVE HD-5               TO P-DATA
  4455             MOVE ' '                TO X
  4456*            PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4457             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4458                 MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4459                 MOVE ' '               TO X
  4460                 MOVE HD-5A             TO P-DATA
  4461                 PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4462
  4463
  4464     IF PASS-NUMBER = '7'
  4465         MOVE S-EPX-A-RPT-CD-1   TO HD-8D-USER-SEL-5
  4466         MOVE ' '                TO X
  4467         MOVE HD-8D              TO P-DATA
  4468         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4469         IF SKIP-HD-SW = '2'
  4470             NEXT SENTENCE
  4471         ELSE
  4472             MOVE S-EPX-A-RPT-CD-2   TO HD-4G-REPT-CD-2
  4473             MOVE HD-4G              TO P-DATA
  4474             MOVE ' '                TO X
  4475             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4476         END-IF
  4477         IF SKIP-HD-SW = '1'
  4478             NEXT SENTENCE
  4479         ELSE
  4480           IF DTE-TOT-OPT = 5 OR 6 OR 7
  4481             MOVE SPACES             TO HD-6
  4482             MOVE 'STATE '           TO FILLER-HD-6-1
  4483             MOVE S-EPX-A-STATE      TO HD-6-NSTATE
  4484             MOVE HD-6               TO P-DATA
  4485             MOVE ' '                TO X
  4486             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4487             MOVE S-EPX-A-ACCT       TO HD-ACCOUNT
  4488             MOVE SAVE-ACCT-NAME     TO HD-ACCT-NAME
  4489             MOVE SAVE-ACCT-STATUS   TO HD-ACCT-ADDRESS
  4490             MOVE HD-5               TO P-DATA
  4491             MOVE ' '                TO X
  4492             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4493             MOVE SAVE-ACCT-CITY    TO HD-5A-CITY
  4494             MOVE ' '               TO X
  4495             MOVE HD-5A             TO P-DATA
  4496             PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  4497           END-IF
  4498         END-IF
  4499     END-IF.
  4500
  4501     IF PASS-NUMBER NOT = '1' AND '4' AND '5'
  4502        AND '6' AND '7'
  4503         MOVE S-EPX-CARR         TO HD-4-CARRIER
  4504         MOVE S-EPX-GRP          TO HD-4-GROUPING
  4505         MOVE HD-4               TO P-DATA
  4506         PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4507
  4508     MOVE '0'                    TO X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS036.cbl
  4509
  4510     IF DTE-CLIENT = 'HER'
  4511         MOVE HD-9-A             TO  P-DATA
  4512         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4513         MOVE ' '                TO  X
  4514         MOVE HD-10-A            TO  P-DATA
  4515         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4516     ELSE
  4517         MOVE HD-9               TO  P-DATA
  4518         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4519         MOVE ' '                TO  X
  4520         MOVE HD-10              TO  P-DATA
  4521         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4522
  4523 0999-EXIT.
  4524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS036.cbl
  4526 1000-GR-HD.
  4527     MOVE ZERO                   TO SET-CTR.
  4528     ADD +1 TO PAGE-CNT.
  4529     MOVE PAGE-CNT               TO HD-PAGE.
  4530     MOVE '1'                    TO X.
  4531     MOVE HD-1-GRAND-TOTALS      TO P-DATA.
  4532     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4533     MOVE ' '                    TO X.
  4534     MOVE HD-2                   TO P-DATA.
  4535     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4536     MOVE ' '                    TO X.
  4537     MOVE HD-3                   TO P-DATA.
  4538     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4539     MOVE '-'                    TO X.
  4540
  4541     IF DTE-CLIENT = 'HER'
  4542         MOVE HD-9-A             TO  P-DATA
  4543         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4544         MOVE ' '                TO  X
  4545         MOVE HD-10-A            TO  P-DATA
  4546         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4547     ELSE
  4548         MOVE SPACES             TO HD-9-1 HD-10-1
  4549         MOVE HD-9               TO  P-DATA
  4550         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4551         MOVE ' '                TO  X
  4552         MOVE HD-10              TO  P-DATA
  4553         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4554
  4555     MOVE '                NET '  TO  HD-9-1.
  4556     MOVE '             ACTIVITY'  TO  HD-10-1.
  4557     MOVE '       HI-CERT    CERT        NET '
  4558                                 TO  HD-9-A-1.
  4559     MOVE '         DATE    COUNT      ACTIVITY'
  4560                                 TO  HD-10-A-1.
  4561
  4562 1010-GP-HD.
  4563     MOVE ZERO                   TO SET-CTR.
  4564     ADD +1 TO PAGE-CNT.
  4565     MOVE PAGE-CNT               TO HD-PAGE.
  4566     MOVE '1'                    TO X.
  4567     MOVE HD-1-GROUPING          TO P-DATA.
  4568
  4569     IF PASS-NUMBER = '5'
  4570         MOVE HD-1-RPT-CODE-2    TO P-DATA.
  4571
  4572     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4573
  4574     MOVE ' '                    TO X.
  4575     MOVE HD-2                   TO P-DATA.
  4576     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4577     MOVE ' '                    TO X.
  4578     MOVE HD-3                   TO P-DATA.
  4579     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4580     MOVE '-'                    TO X.
  4581
  4582     IF PASS-NUMBER = '2'
  4583         MOVE 'TOTAL BUSINESS TYPE'  TO FILLER-HD-7
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS036.cbl
  4584     ELSE
  4585     IF PASS-NUMBER = '5'
  4586         MOVE 'TOTAL GROUPING'       TO FILLER-HD-7
  4587     ELSE
  4588         MOVE 'TOTAL AGENCY'         TO FILLER-HD-7.
  4589
  4590     MOVE ' FOR CARRIER'         TO FILLER-HD-7A.
  4591     MOVE S-EPX-CNTL-1           TO HD-7-DESC.
  4592     MOVE S-EPX-CARR             TO HD-CARRIER.
  4593     IF PASS-NUMBER = '5'
  4594         MOVE S-EPX-A-GROUP      TO HD-7-DESC
  4595         MOVE S-EPX-A-CARR       TO HD-CARRIER.
  4596     MOVE HD-7                   TO P-DATA.
  4597     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4598     MOVE '0'                    TO X.
  4599
  4600     MOVE '                NET '  TO  HD-9-1.
  4601     MOVE '             ACTIVITY'  TO  HD-10-1.
  4602     MOVE '       HI-CERT    CERT        NET '
  4603                                 TO  HD-9-A-1.
  4604     MOVE '         DATE    COUNT      ACTIVITY'
  4605                                 TO  HD-10-A-1.
  4606
  4607     IF DTE-CLIENT = 'HER'
  4608         MOVE HD-9-A             TO  P-DATA
  4609         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4610         MOVE ' '                TO  X
  4611         MOVE HD-10-A            TO  P-DATA
  4612         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4613     ELSE
  4614         MOVE HD-9               TO  P-DATA
  4615         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4616         MOVE ' '                TO  X
  4617         MOVE HD-10              TO  P-DATA
  4618         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4619
  4620 1020-CA-HD.
  4621     MOVE ZERO                   TO SET-CTR.
  4622     ADD +1 TO PAGE-CNT.
  4623     MOVE PAGE-CNT               TO HD-PAGE.
  4624     MOVE '1'                    TO X.
  4625     MOVE HD-1-CARRIER           TO P-DATA.
  4626     IF PASS-NUMBER = '5'
  4627         MOVE HD-1-RPT-CODE-2    TO P-DATA.
  4628     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4629     MOVE ' '                    TO X.
  4630     MOVE HD-2                   TO P-DATA.
  4631     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4632     MOVE ' '                    TO X.
  4633     MOVE HD-3                   TO P-DATA.
  4634     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4635     MOVE '-'                    TO X.
  4636
  4637     IF PASS-NUMBER = '2'
  4638         MOVE 'TOTAL BUSINESS TYPE'  TO FILLER-HD-7
  4639     ELSE
  4640     IF PASS-NUMBER = '5'
  4641         MOVE 'TOTAL CARRIER'        TO FILLER-HD-7
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS036.cbl
  4642     ELSE
  4643         MOVE 'TOTAL AGENCY'         TO FILLER-HD-7.
  4644
  4645     MOVE SPACE                  TO FILLER-HD-7A.
  4646     MOVE S-EPX-CNTL-1           TO HD-7-DESC.
  4647     IF PASS-NUMBER = '5'
  4648         MOVE S-EPX-A-CARR       TO HD-7-DESC.
  4649     MOVE SPACE                  TO HD-CARRIER.
  4650     MOVE HD-7                   TO P-DATA.
  4651     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4652     MOVE '0'                    TO X.
  4653
  4654     MOVE '                NET '  TO  HD-9-1.
  4655     MOVE '             ACTIVITY'  TO  HD-10-1.
  4656     MOVE '       HI-CERT    CERT        NET '
  4657                                 TO  HD-9-A-1.
  4658     MOVE '         DATE    COUNT      ACTIVITY'
  4659                                 TO  HD-10-A-1.
  4660
  4661     IF DTE-CLIENT = 'HER'
  4662         MOVE HD-9-A             TO  P-DATA
  4663         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4664         MOVE ' '                TO  X
  4665         MOVE HD-10-A            TO  P-DATA
  4666         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4667     ELSE
  4668         MOVE HD-9               TO  P-DATA
  4669         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT
  4670         MOVE ' '                TO  X
  4671         MOVE HD-10              TO  P-DATA
  4672         PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4673
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS036.cbl
  4675 1100-WRITE-PRINT.
  4676*              COPY ELCPRT2.
* 4677               COPY PRTN036.
  4678*
  4679*
  4680*                    PRTN036
  4681*
  4682*  MOD BOOK NUMBER "LGC136" FOR ADDITIONAL INFO ON THIS MODULE.
  4683*
  4684******************************************************************
  4685*                   C H A N G E   L O G
  4686*
  4687* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4688*-----------------------------------------------------------------
  4689*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4690* EFFECTIVE    NUMBER
  4691*-----------------------------------------------------------------
  4692*         CR2000042100002  DANA  ADDED MIDWEST
  4693* 120602  CR2002120500014  SMVA  ADD KBA TO PRINT SELECT
  4694* 112503                   SMVA  FIX SELECT-RECORD INITIAL HEADER
  4695* 012704  CR2004011500004  SMVA  REMOVE RMRO,UMB & MFG FROM SELECT-PRINT
  4696*                                AND REMOVE ALL MFG2ND PRINT
  4697* 073004  CR2004072300002  SMVA  REMOVE RPT CD 1 HORNICK & RASSMITH
  4698*                                FROM SYS008 ONLY
  4699* 102704    2004101400003  PEMA  REMOVE IARO RMRO-N RMRO-S
  4700******************************************************************
  4701*
  4702*  THE "COPY" STMT. WAS CHANGED TO COPY "PRTN036" INTO ECS036.
  4703*
  4704*  CID WISHES TO PRINT ONLY SELECTED ACCOUNT REPORTS ON 1 COPY OF
  4705*    THE PAPER REPORT AND YET ALLOW ALL RECORDS PRINT ON A SECOND
  4706*    PAPER REPORT AND ON THE FICH REPORT.
  4707*
  4708*  CID WANTS 1 COPY EACH OF BOTH REPORT CODES, AND A SECOND COPY
  4709*  OF THE SELECTED ACCOUNTS FOR BOTH REPORT CODES.
  4710*
  4711*  THE CHANGES TO DO THIS HAVE BEEN ADDED IN THIS ROUTINE, AS
  4712*    WELL AS IN OTHER ROUTINES IN THIS PROGRAM.
  4713*
  4714*  SELECTED ACCOUNTS ARE WRITTEN TO SYS050 FOR PRINTING.
  4715*
  4716******************************************************************
  4717*                                                                *
  4718*                         ELCPRTN                                *
  4719*                         VMOD=2.002                             *
  4720*                                                                *
  4721******************************************************************
  4722
  4723     MOVE PRT TO SELECT-RECORD.
  4724
  4725     IF SLCT-REC (1:2) = 'Y '
  4726         MOVE SPACES TO P-DATA (1:22)
  4727     END-IF.
  4728
  4729     IF DTE-FICH NOT = SPACE AND
  4730        FICH-OPEN    = SPACE
  4731         MOVE 'X' TO FICH-OPEN
  4732         OPEN OUTPUT FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS036.cbl (/apps/prod/cid1p/copy/PRTN036)
  4733
  4734     IF DTE-FICH NOT = SPACE
  4735         MOVE X TO P-CTL
  4736         WRITE FICH-REC FROM PRT.
  4737
  4738     IF SLCT-FLD-1 = 'RPT CODE 1 ' OR 'RPT CODE 2 '
  4739        NEXT SENTENCE
  4740      ELSE
  4741         GO TO 9025-CK-SELECT-PRT.
  4742
  4743     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4744      IF SLCT-FLD-2 = 'LATIMER   '
  4745        MOVE 'YES' TO PRINT-SELECT-SW
  4746          GO TO 9025-CK-SELECT-PRT.
  4747
  4748
  4749     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4750      IF SLCT-FLD-2 = 'HODGE     '
  4751        MOVE 'YES' TO PRINT-SELECT-SW
  4752          GO TO 9025-CK-SELECT-PRT.
  4753
  4754     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4755      IF SLCT-FLD-2 = 'MIDWEST   '
  4756        MOVE 'YES' TO PRINT-SELECT-SW
  4757          GO TO 9025-CK-SELECT-PRT.
  4758
  4759     IF SLCT-FLD-1 = 'RPT CODE 1 '
  4760      IF SLCT-FLD-2 = 'KBA       '
  4761        MOVE 'YES' TO PRINT-SELECT-SW
  4762          GO TO 9025-CK-SELECT-PRT.
  4763
  4764 9015-CK-RPT-CODE-2.
  4765
  4766     IF SLCT-FLD-1 = 'RPT CODE 2 '
  4767      IF SLCT-FLD-2 = 'KENT      '
  4768        MOVE 'YES' TO PRINT-SELECT-SW
  4769         GO TO 9025-CK-SELECT-PRT.
  4770
  4771 9020-NO-MATCH.
  4772
  4773     MOVE 'NO ' TO PRINT-SELECT-SW.
  4774
  4775
  4776 9025-CK-SELECT-PRT.
  4777
  4778     IF  PRINT-SELECT-SW  =  'YES'
  4779          IF SLCT-REC (1:2) = 'Y '
  4780              MOVE SPACES TO SLCT-FLD-1
  4781              MOVE SPACES TO SLCT-FLD-2
  4782              MOVE SPACE  TO SLCT-REC (1:1)
  4783          END-IF
  4784
  4785          MOVE X TO SELECT-CC
  4786
  4787          EVALUATE SELECT-CC
  4788          WHEN ' '
  4789              WRITE SELECT-RECORD AFTER ADVANCING 1 LINE
  4790          WHEN '0'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS036.cbl (/apps/prod/cid1p/copy/PRTN036)
  4791              WRITE SELECT-RECORD AFTER ADVANCING 2 LINE
  4792          WHEN '-'
  4793              WRITE SELECT-RECORD AFTER ADVANCING 3 LINE
  4794          WHEN OTHER
  4795              WRITE SELECT-RECORD AFTER ADVANCING PAGE
  4796          END-EVALUATE
  4797     END-IF
  4798
  4799     MOVE SPACES TO SELECT-RECORD.
  4800
  4801**
  4802**  BYPASS PRINTING THE "A", "B", AND "C" REPORTS.
  4803**
  4804     IF HD-1-GRP-SUF = 'A' OR 'B' OR 'C'
  4805         GO TO 9030-EXIT
  4806     END-IF.
  4807
  4808     IF HD-1-SLCT-FLD-1 = 'RPT CODE 1 '
  4809        AND (HD-1-SLCT-FLD-2 = 'HORNICK   '
  4810             OR 'RASSMITH  '
  4811             OR 'IARO      ' OR 'RMRO-N    '
  4812             OR 'RMRO-S    ')
  4813         GO TO 9030-EXIT
  4814     END-IF.
  4815
  4816     IF DTE-FICH = SPACE OR '2'
  4817         MOVE X                    TO  P-CTL
  4818         EVALUATE P-CTL
  4819         WHEN ' '
  4820             WRITE PRT AFTER ADVANCING 1 LINE
  4821         WHEN '0'
  4822             WRITE PRT AFTER ADVANCING 2 LINE
  4823         WHEN '-'
  4824             WRITE PRT AFTER ADVANCING 3 LINE
  4825         WHEN OTHER
  4826             WRITE PRT AFTER ADVANCING PAGE
  4827         END-EVALUATE
  4828     END-IF.
  4829
  4830
  4831 9030-EXIT.
  4832     EXIT.
  4833
  4834******************************************************************
  4835
  4836 1199-EXIT.
  4837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS036.cbl
  4839 1200-LOAD-ALPHA-MONTH.
  4840     IF DTE-CLIENT = 'HER'
  4841         NEXT SENTENCE
  4842     ELSE
  4843         GO TO 1210-LOAD-ALPHA-MONTH.
  4844
  4845     IF DET-MO-2 = '01 '
  4846         MOVE 'JAN'              TO  DET-MO-2.
  4847
  4848     IF DET-MO-2 = '02 '
  4849         MOVE 'FEB'              TO  DET-MO-2.
  4850
  4851     IF DET-MO-2 = '03 '
  4852         MOVE 'MAR'              TO  DET-MO-2.
  4853
  4854     IF DET-MO-2 = '04 '
  4855         MOVE 'APR'              TO  DET-MO-2.
  4856
  4857     IF DET-MO-2 = '05 '
  4858         MOVE 'MAY'              TO  DET-MO-2.
  4859
  4860     IF DET-MO-2 = '06 '
  4861         MOVE 'JUN'              TO  DET-MO-2.
  4862
  4863     IF DET-MO-2 = '07 '
  4864         MOVE 'JUL'              TO  DET-MO-2.
  4865
  4866     IF DET-MO-2 = '08 '
  4867         MOVE 'AUG'              TO  DET-MO-2.
  4868
  4869     IF DET-MO-2 = '09 '
  4870         MOVE 'SEP'              TO  DET-MO-2.
  4871
  4872     IF DET-MO-2 = '10 '
  4873         MOVE 'OCT'              TO  DET-MO-2.
  4874
  4875     IF DET-MO-2 = '11 '
  4876         MOVE 'NOV'              TO  DET-MO-2.
  4877
  4878     IF DET-MO-2 = '12 '
  4879         MOVE 'DEC'              TO  DET-MO-2.
  4880
  4881     GO TO 1299-EXIT.
  4882
  4883 1210-LOAD-ALPHA-MONTH.
  4884     IF DET-MO = '01 ' MOVE 'JAN' TO DET-MO.
  4885     IF DET-MO = '02 ' MOVE 'FEB' TO DET-MO.
  4886     IF DET-MO = '03 ' MOVE 'MAR' TO DET-MO.
  4887     IF DET-MO = '04 ' MOVE 'APR' TO DET-MO.
  4888     IF DET-MO = '05 ' MOVE 'MAY' TO DET-MO.
  4889     IF DET-MO = '06 ' MOVE 'JUN' TO DET-MO.
  4890     IF DET-MO = '07 ' MOVE 'JUL' TO DET-MO.
  4891     IF DET-MO = '08 ' MOVE 'AUG' TO DET-MO.
  4892     IF DET-MO = '09 ' MOVE 'SEP' TO DET-MO.
  4893     IF DET-MO = '10 ' MOVE 'OCT' TO DET-MO.
  4894     IF DET-MO = '11 ' MOVE 'NOV' TO DET-MO.
  4895     IF DET-MO = '12 ' MOVE 'DEC' TO DET-MO.
  4896
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS036.cbl
  4897 1299-EXIT.
  4898      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS036.cbl
  4900 1300-PRINT-GRAND-TOTALS.
  4901     IF ZERO-GRAND-TOTALS = GRAND-TOTALS
  4902         GO TO 1399-EXIT.
  4903
  4904     PERFORM 1000-GR-HD.
  4905     MOVE +1                     TO X1.
  4906
  4907 1310-GRAND-TOTAL-1.
  4908     IF DTE-CLIENT = 'HER'
  4909         NEXT SENTENCE
  4910     ELSE
  4911         GO TO 1330-GRAND-TOTAL-1.
  4912
  4913     IF X1 GREATER 12
  4914         GO TO 1320-GRAND-TOTAL-2.
  4915
  4916     MOVE GT-DATE (X1)           TO  SAVE-HER-HI-CERT.
  4917
  4918     IF (GT-CERT (X1) = ZEROS
  4919        OR GT-ISS (X1) EQUAL ZEROS)
  4920         MOVE SPACES             TO  DET-FILL
  4921     ELSE
  4922         MOVE SAVE-HER-HI-MO     TO  DET-HI-MO
  4923         MOVE '/'                TO  DET-HI-SLASH
  4924         MOVE SAVE-HER-HI-YR     TO  DET-HI-YR
  4925         MOVE 0                  TO  SAVE-HER-HI-CERT.
  4926
  4927     MOVE GT-CERT (X1)           TO  DET-CERTS-2.
  4928     MOVE GT-ISS  (X1)           TO  DET-ISS-COUNT-2.
  4929     MOVE GT-LBEN (X1)           TO  DET-LBEN-2.
  4930     MOVE GT-LPRM (X1)           TO  DET-LPRM-2.
  4931     MOVE GT-LCLM (X1)           TO  DET-LCLM-2.
  4932     MOVE GT-APRM (X1)           TO  DET-APRM-2.
  4933     MOVE GT-ACLM (X1)           TO  DET-ACLM-2.
  4934     MOVE GT-TPRM (X1)           TO  DET-TPRM-2.
  4935     MOVE GT-TCOM (X1)           TO  DET-TCOM-2.
  4936
  4937     ADD +1                      TO  X1.
  4938
  4939     MOVE COMP-YR (X1)           TO  DET-YR-2.
  4940     MOVE COMP-MO (X1)           TO  DET-MO-2.
  4941
  4942     PERFORM 1200-LOAD-ALPHA-MONTH  THRU  1299-EXIT.
  4943
  4944     MOVE DETAIL-LINE-2          TO  P-DATA.
  4945
  4946     IF X1 = 2
  4947         MOVE '0'                TO  X
  4948     ELSE
  4949         MOVE ' '                TO  X.
  4950
  4951     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4952
  4953     GO TO 1310-GRAND-TOTAL-1.
  4954
  4955 1320-GRAND-TOTAL-2.
  4956     MOVE 'GRAND TOTALS'         TO  DET-TITLE-2.
  4957     MOVE '-'                    TO  X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS036.cbl
  4958     MOVE GR-LBEN                TO  DET-LBEN-2.
  4959     MOVE GR-LPRM                TO  DET-LPRM-2.
  4960     MOVE GR-LCLM                TO  DET-LCLM-2.
  4961     MOVE GR-APRM                TO  DET-APRM-2.
  4962     MOVE GR-ACLM                TO  DET-ACLM-2.
  4963     MOVE GR-TPRM                TO  DET-TPRM-2.
  4964     MOVE GR-TCOM                TO  DET-TCOM-2.
  4965     MOVE DETAIL-LINE-2          TO  P-DATA.
  4966
  4967     PERFORM 1100-WRITE-PRINT  THRU  1199-EXIT.
  4968
  4969     MOVE SPACES                 TO  DET-TITLE-2.
  4970     MOVE ZERO-GRAND-TOTALS      TO  GRAND-TOTALS.
  4971
  4972     GO TO 1399-EXIT.
  4973
  4974 1330-GRAND-TOTAL-1.
  4975     IF X1 GREATER 12
  4976         GO TO 1340-GRAND-TOTAL-2.
  4977
  4978     MOVE GT-LBEN (X1)           TO DET-LBEN.
  4979     MOVE GT-LPRM (X1)           TO DET-LPRM.
  4980     MOVE GT-LCLM (X1)           TO DET-LCLM.
  4981     MOVE GT-ABEN (X1)           TO DET-ABEN.
  4982     MOVE GT-APRM (X1)           TO DET-APRM.
  4983     MOVE GT-ACLM (X1)           TO DET-ACLM.
  4984     MOVE GT-TPRM (X1)           TO DET-TPRM.
  4985     MOVE GT-TCOM (X1)           TO DET-TCOM.
  4986     ADD +1 TO X1.
  4987     MOVE COMP-YR (X1)           TO DET-YR.
  4988     MOVE COMP-MO (X1)           TO DET-MO.
  4989     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  4990     MOVE DETAIL-LINE            TO P-DATA.
  4991
  4992     IF X1 = 2
  4993         MOVE '0' TO X
  4994     ELSE
  4995         MOVE ' ' TO X.
  4996
  4997     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  4998     GO TO 1330-GRAND-TOTAL-1.
  4999
  5000 1340-GRAND-TOTAL-2.
  5001     MOVE L12GT-LBEN             TO DET-LBEN.
  5002     MOVE L12GT-LPRM             TO DET-LPRM.
  5003     MOVE L12GT-LCLM             TO DET-LCLM.
  5004     MOVE L12GT-ABEN             TO DET-ABEN.
  5005     MOVE L12GT-APRM             TO DET-APRM.
  5006     MOVE L12GT-ACLM             TO DET-ACLM.
  5007     MOVE L12GT-TPRM             TO DET-TPRM.
  5008     MOVE L12GT-TCOM             TO DET-TCOM.
  5009     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  5010
  5011     MOVE '0'                    TO X.
  5012     MOVE DETAIL-LINE            TO P-DATA.
  5013     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5014     MOVE ZERO-ACCUM             TO LAST-12-GRAND-ACCUM.
  5015
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS036.cbl
  5016 1350-PRINT-GRAND-YTD.
  5017     MOVE YTDGT-LBEN             TO DET-LBEN.
  5018     MOVE YTDGT-LPRM             TO DET-LPRM.
  5019     MOVE YTDGT-LCLM             TO DET-LCLM.
  5020     MOVE YTDGT-ABEN             TO DET-ABEN.
  5021     MOVE YTDGT-APRM             TO DET-APRM.
  5022     MOVE YTDGT-ACLM             TO DET-ACLM.
  5023     MOVE YTDGT-TPRM             TO DET-TPRM.
  5024     MOVE YTDGT-TCOM             TO DET-TCOM.
  5025     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  5026     MOVE ' '                    TO X.
  5027     MOVE DETAIL-LINE            TO P-DATA.
  5028     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5029     MOVE SPACES                 TO DET-TITLE.
  5030     MOVE ZERO-ACCUM             TO YTD-GRAND-ACCUM.
  5031
  5032     MOVE PYTDGT-LBEN            TO DET-LBEN.
  5033     MOVE PYTDGT-LPRM            TO DET-LPRM.
  5034     MOVE PYTDGT-LCLM            TO DET-LCLM.
  5035     MOVE PYTDGT-ABEN            TO DET-ABEN.
  5036     MOVE PYTDGT-APRM            TO DET-APRM.
  5037     MOVE PYTDGT-ACLM            TO DET-ACLM.
  5038     MOVE PYTDGT-TPRM            TO DET-TPRM.
  5039     MOVE PYTDGT-TCOM            TO DET-TCOM.
  5040     MOVE 'PRIOR YTD         '   TO DET-TITLE.
  5041     MOVE ' '                    TO X.
  5042     MOVE DETAIL-LINE            TO P-DATA.
  5043     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5044     MOVE SPACES                 TO DET-TITLE.
  5045     MOVE ZERO-ACCUM             TO PYTD-GRAND-ACCUM
  5046
  5047*02722      MOVE 'GRAND TOTALS'         TO DET-TITLE.
  5048*02723      MOVE '-'                    TO X.
  5049*02724      MOVE GR-LBEN                TO DET-LBEN.
  5050*02725      MOVE GR-LPRM                TO DET-LPRM.
  5051*02726      MOVE GR-LCLM                TO DET-LCLM.
  5052*02727      MOVE GR-ABEN                TO DET-ABEN.
  5053*02728      MOVE GR-APRM                TO DET-APRM.
  5054*02729      MOVE GR-ACLM                TO DET-ACLM.
  5055*02730      MOVE GR-TPRM                TO DET-TPRM.
  5056*02731      MOVE GR-TCOM                TO DET-TCOM.
  5057*02732      MOVE DETAIL-LINE            TO P-DATA.
  5058*02733      PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5059     MOVE ZERO-GRAND-TOTALS      TO GRAND-TOTALS.
  5060
  5061 1399-EXIT.
  5062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS036.cbl
  5064 1400-STATE-LOOKUP.
* 5065                             COPY ECSSTLOK.
  5066******************************************************************07/10/97
  5067*                                                                *ECSSTLOK
  5068*                            ECSSTLOK                            *   LV001
  5069*                            VMOD=2.001                         * ECSSTLOK
  5070*                                                                *ECSSTLOK
  5071*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  5072*                                                                *ECSSTLOK
  5073******************************************************************ECSSTLOK
  5074 STATE--START.                                                    ECSSTLOK
  5075     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  5076                                                                  ECSSTLOK
  5077 STATE--LOOP.                                                     ECSSTLOK
  5078     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  5079     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  5080         MOVE SPACE TO STATE-L                                    ECSSTLOK
  5081         GO TO STATE--EXIT.                                       ECSSTLOK
  5082                                                                  ECSSTLOK
  5083     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  5084         GO TO STATE--LOOP.                                       ECSSTLOK
  5085                                                                  ECSSTLOK
  5086 STATE--EXIT.                                                     ECSSTLOK
  5087     EXIT.
  5088******************************************************************ECSSTLOK
  5089 1499-EXIT.
  5090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS036.cbl
  5092 1500-PASS-NUMBER-CHANGE.
  5093     MOVE ZERO                   TO SET-CTR.
  5094
  5095     IF PASS-NUMBER = '4'
  5096         IF DTE-TOT-OPT = 1 OR 3 OR 6
  5097             NEXT SENTENCE
  5098         ELSE
  5099         IF DTE-TOT-OPT = 5 OR 7
  5100             PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5101             MOVE '1'            TO SKIP-HD-SW
  5102             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5103         ELSE
  5104             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  5105
  5106     IF PASS-NUMBER = '5'
  5107         IF DTE-TOT-OPT = 1 OR 2 OR 5
  5108             NEXT SENTENCE
  5109         ELSE
  5110         IF DTE-TOT-OPT = 6 OR 7
  5111             PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5112             MOVE '1'            TO SKIP-HD-SW
  5113             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5114           ELSE
  5115             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  5116
  5117     IF PASS-NUMBER = '6'
  5118         IF DTE-TOT-OPT = 1 OR 3 OR 6
  5119             NEXT SENTENCE
  5120         ELSE
  5121         IF DTE-TOT-OPT = 5 OR 7
  5122             PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5123             MOVE '1'            TO SKIP-HD-SW
  5124             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5125         ELSE
  5126             PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT.
  5127
  5128     IF PASS-NUMBER = '7'
  5129         MOVE ' '                TO SKIP-HD-SW
  5130         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5131         MOVE '1'                TO SKIP-HD-SW
  5132         PERFORM 1700-REPTCD2-BREAK THRU 1790-ZERO-REPTCD2
  5133         MOVE '2'            TO  SKIP-HD-SW
  5134         PERFORM 0700-REPTCD-BREAK  THRU 0790-ZERO-REPTCD
  5135     END-IF.
  5136
  5137     IF PASS-NUMBER = '1'
  5138         PERFORM 0400-ACCOUNT-BREAK THRU 0495-ZERO-ACCOUNT
  5139     ELSE
  5140         IF PASS-NUMBER = '4' OR '6' OR '7'
  5141             NEXT SENTENCE
  5142         ELSE
  5143         IF PASS-NUMBER = '5'
  5144             PERFORM 0605-CARRIER-BREAK-5 THRU 0680-ZERO-CARRIER
  5145         ELSE
  5146             PERFORM 0600-CARRIER-BREAK THRU 0680-ZERO-CARRIER.
  5147
  5148     PERFORM 1300-PRINT-GRAND-TOTALS THRU 1399-EXIT.
  5149
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS036.cbl
  5150     IF EOF-EPX = '1'
  5151         GO TO 9000-END-OF-JOB.
  5152
  5153     IF PASS-NUMBER = '7'
  5154         GO TO 9000-END-OF-JOB.
  5155
  5156     MOVE ZERO                   TO PAGE-CNT
  5157                                    X1.
  5158     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  5159     MOVE +0                     TO X1.
  5160     PERFORM 0230-ZERO-ACCUM-ACC 15 TIMES.
  5161     MOVE +0                     TO X1.
  5162     PERFORM 0240-ZERO-ACCUM-GRP 15 TIMES.
  5163     MOVE +0                     TO X1.
  5164     PERFORM 0250-ZERO-ACCUM-CARR 15 TIMES.
  5165     MOVE +0                     TO X1.
  5166     PERFORM 0255-ZERO-ACCUM-STATE 15 TIMES.
  5167     MOVE +0                     TO X1.
  5168     PERFORM 0256-ZERO-ACCUM-REPT2 15 TIMES.
  5169     MOVE +0                     TO X1.
  5170     PERFORM 0260-ZERO-ACCUM-REPT 15 TIMES.
  5171     MOVE +0                     TO X1.
  5172     PERFORM 0270-ZERO-ACCUM-GRAND 15 TIMES.
  5173     MOVE ZERO-GRAND-TOTALS      TO GRAND-TOTALS.
  5174     MOVE ZERO-ACCUM TO LAST-12-ACCOUNT-ACCUM YTD-ACCOUNT-ACCUM
  5175                    LAST-12-GROUPING-ACCUM  LAST-12-CARRIER-ACCUM
  5176                    LAST-12-REPTCD-ACCUM    LAST-12-STATE-ACCUM
  5177                    YTD-GROUPING-ACCUM      YTD-CARRIER-ACCUM
  5178                    YTD-REPTCD-ACCUM        YTD-STATE-ACCUM
  5179                    PYTD-GROUPING-ACCUM     PYTD-CARRIER-ACCUM
  5180                    PYTD-REPTCD-ACCUM       PYTD-STATE-ACCUM
  5181                    LAST-12-GRAND-ACCUM     YTD-GRAND-ACCUM
  5182                    PYTD-GRAND-ACCUM
  5183                    LAST-12-REPTCD2-ACCUM   YTD-REPTCD2-ACCUM
  5184                    PYTD-REPTCD2-ACCUM
  5185*                   PL12-GROUPING-ACCUM     PL12-CARRIER-ACCUM
  5186*                   PL12-REPTCD-ACCUM       PL12-STATE-ACCUM
  5187*                   ITD-GROUPING-ACCUM      ITD-CARRIER-ACCUM
  5188*                   ITD-REPTCD-ACCUM        ITD-STATE-ACCUM.
  5189     MOVE ZERO                   TO CERT
  5190                                    LBEN
  5191                                    LPRM
  5192                                    LCLM
  5193                                    ABEN
  5194                                    APRM
  5195                                    ACLM
  5196                                    TPRM
  5197                                    TCOM
  5198                                    ISS.
  5199
  5200     MOVE SPACE                  TO DET-TITLE.
  5201
  5202     MOVE EP-PASS-NO             TO PASS-NUMBER.
  5203
  5204     GO TO 0340-ACCUMULATE.
  5205
  5206 1510-BUSS-LOOKUP.
  5207     MOVE CLAS-STARTB            TO CLAS-INDEXB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS036.cbl
  5208     MOVE S-EPX-CNTL-1           TO WORK-BUSC.
  5209
  5210 1520-BUSS-LOOP.
  5211     IF CLAS-INDEXB GREATER CLAS-MAXB
  5212         MOVE 'INVALID BUS TYPE' TO HD-STATE
  5213         GO TO 1599-EXIT.
  5214
  5215     IF WORK-BUSC = CLAS-BUSC-CODE (CLAS-INDEXB)
  5216         MOVE CLAS-BUSC-DESC (CLAS-INDEXB) TO HD-STATE
  5217         GO TO 1599-EXIT.
  5218
  5219     ADD +1 TO CLAS-INDEXB.
  5220     GO TO 1520-BUSS-LOOP.
  5221
  5222 1599-EXIT.
  5223     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS036.cbl
  5225 1700-REPTCD2-BREAK.
  5226     MOVE +0                     TO X1.
  5227     PERFORM 0220-ZERO-PRINT-TABLE 12 TIMES.
  5228     PERFORM 0800-PRINT-DECISION THRU 0899-EXIT.
  5229
  5230     IF P-RP2-SW = '1'
  5231         MOVE ' '                TO P-RP2-SW
  5232     ELSE
  5233         GO TO 1790-ZERO-REPTCD2.
  5234
  5235     PERFORM 0900-HEAD-RTN THRU 0999-EXIT.
  5236
  5237     MOVE +1                     TO X1.
  5238     MOVE +0                     TO Y1.
  5239
  5240 1720-REPTCD2-BREAK-POINT.
  5241     ADD +1 TO X1 Y1.
  5242
  5243     IF X1 GREATER THAN 13
  5244         GO TO 1770-PRINT-LAST-RP2-12.
  5245
  5246     COMPUTE RP2CERT = RP2-CERT (X1) - RP2-CERT (Y1).
  5247     COMPUTE RP2LBEN = RP2-LBEN (X1) - RP2-LBEN (Y1).
  5248     COMPUTE RP2LPRM = RP2-LPRM (X1) - RP2-LPRM (Y1).
  5249     COMPUTE RP2LCLM = RP2-LCLM (X1) - RP2-LCLM (Y1).
  5250     COMPUTE RP2ABEN = RP2-ABEN (X1) - RP2-ABEN (Y1).
  5251     COMPUTE RP2APRM = RP2-APRM (X1) - RP2-APRM (Y1).
  5252     COMPUTE RP2ACLM = RP2-ACLM (X1) - RP2-ACLM (Y1).
  5253     COMPUTE RP2TCOM = RP2-TCOM (X1) - RP2-TCOM (Y1).
  5254     COMPUTE RP2TPRM = RP2LPRM  + RP2APRM.
  5255     MOVE COMP-YR (X1)           TO DET-YR.
  5256     MOVE COMP-MO (X1)           TO DET-MO.
  5257     PERFORM 1200-LOAD-ALPHA-MONTH THRU 1299-EXIT.
  5258
  5259     MOVE RP2CERT                TO DET-CERTS.
  5260     MOVE RP2LBEN                TO DET-LBEN.
  5261     MOVE RP2LPRM                TO DET-LPRM.
  5262     MOVE RP2LCLM                TO DET-LCLM.
  5263     MOVE RP2ABEN                TO DET-ABEN.
  5264     MOVE RP2APRM                TO DET-APRM.
  5265     MOVE RP2ACLM                TO DET-ACLM.
  5266     MOVE RP2TPRM                TO DET-TPRM.
  5267     MOVE RP2TCOM                TO DET-TCOM.
  5268
  5269     IF COMP-YR (X1) = CONV-YR AND
  5270        COMP-MO (X1) = CONV-MO
  5271         MOVE ZEROS TO DET-CERTS DET-LBEN DET-LPRM
  5272                       DET-ABEN DET-APRM DET-LCLM
  5273                       DET-ACLM DET-TPRM DET-TCOM
  5274        ELSE
  5275          PERFORM 1730-ADD-TO-L12-YTD THRU 1740-EXIT.
  5276
  5277     MOVE DETAIL-LINE            TO P-DATA.
  5278
  5279     IF X1 = 2
  5280         MOVE '0'                TO X
  5281     ELSE
  5282         MOVE ' '                TO X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS036.cbl
  5283
  5284     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5285     GO TO 1720-REPTCD2-BREAK-POINT.
  5286
  5287 1730-ADD-TO-L12-YTD.
  5288     IF COMPARE9DT (X1) GREATER YEAR-OLD-DATE
  5289         ADD RP2LBEN TO L12RP2-LBEN
  5290         ADD RP2LPRM TO L12RP2-LPRM
  5291         ADD RP2LCLM TO L12RP2-LCLM
  5292         ADD RP2ABEN TO L12RP2-ABEN
  5293         ADD RP2APRM TO L12RP2-APRM
  5294         ADD RP2ACLM TO L12RP2-ACLM
  5295         ADD RP2TPRM TO L12RP2-TPRM
  5296         ADD RP2TCOM TO L12RP2-TCOM.
  5297
  5298     IF RUN-YR = COMP-YR (X1)
  5299         ADD RP2LBEN TO YTDRP2-LBEN
  5300         ADD RP2LPRM TO YTDRP2-LPRM
  5301                        YTDRP2-TPRM
  5302         ADD RP2LCLM TO YTDRP2-LCLM
  5303         ADD RP2TCOM TO YTDRP2-TCOM
  5304         ADD RP2ABEN TO YTDRP2-ABEN
  5305         ADD RP2APRM TO YTDRP2-APRM
  5306                        YTDRP2-TPRM
  5307         ADD RP2ACLM TO YTDRP2-ACLM.
  5308
  5309     IF X1 = 13
  5310        COMPUTE PYTDRP2-LBEN = PYTDRP2-LBEN +
  5311           (RP2-LBEN (1) - RP2-LBEN (15))
  5312        COMPUTE PYTDRP2-LPRM = PYTDRP2-LPRM +
  5313           (RP2-LPRM (1) - RP2-LPRM (15))
  5314        COMPUTE PYTDRP2-LCLM = PYTDRP2-LCLM +
  5315           (RP2-LCLM (1) - RP2-LCLM (15))
  5316        COMPUTE PYTDRP2-ABEN = PYTDRP2-ABEN +
  5317           (RP2-ABEN (1) - RP2-ABEN (15))
  5318        COMPUTE PYTDRP2-APRM = PYTDRP2-APRM +
  5319           (RP2-APRM (1) - RP2-APRM (15))
  5320        COMPUTE PYTDRP2-ACLM = PYTDRP2-ACLM +
  5321           (RP2-ACLM (1) - RP2-ACLM (15))
  5322        COMPUTE PYTDRP2-TPRM = PYTDRP2-TPRM +
  5323           (RP2-TPRM (1) - RP2-TPRM (15))
  5324        COMPUTE PYTDRP2-TCOM = PYTDRP2-TCOM +
  5325           (RP2-TCOM (1) - RP2-TCOM (15))
  5326     END-IF
  5327
  5328     .
  5329 1740-EXIT.
  5330      EXIT.
  5331
  5332 1770-PRINT-LAST-RP2-12.
  5333     MOVE L12RP2-LBEN            TO DET-LBEN.
  5334     MOVE L12RP2-LPRM            TO DET-LPRM.
  5335     MOVE L12RP2-LCLM            TO DET-LCLM.
  5336     MOVE L12RP2-ABEN            TO DET-ABEN.
  5337     MOVE L12RP2-APRM            TO DET-APRM.
  5338     MOVE L12RP2-ACLM            TO DET-ACLM.
  5339     MOVE L12RP2-TPRM            TO DET-TPRM.
  5340     MOVE L12RP2-TCOM            TO DET-TCOM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS036.cbl
  5341     MOVE 'LAST 12 MONTHS'       TO DET-TITLE.
  5342
  5343     MOVE '0'                    TO X.
  5344     MOVE DETAIL-LINE            TO P-DATA.
  5345     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5346     MOVE ZERO-ACCUM             TO LAST-12-REPTCD2-ACCUM.
  5347
  5348     MOVE SPACES                 TO DET-TITLE
  5349     .
  5350 1780-PRINT-RP2-YTD.
  5351     MOVE YTDRP2-LBEN            TO DET-LBEN.
  5352     MOVE YTDRP2-LPRM            TO DET-LPRM.
  5353     MOVE YTDRP2-LCLM            TO DET-LCLM.
  5354     MOVE YTDRP2-ABEN            TO DET-ABEN.
  5355     MOVE YTDRP2-APRM            TO DET-APRM.
  5356     MOVE YTDRP2-ACLM            TO DET-ACLM.
  5357     MOVE YTDRP2-TPRM            TO DET-TPRM.
  5358     MOVE YTDRP2-TCOM            TO DET-TCOM.
  5359     MOVE 'YEAR TO DATE'         TO DET-TITLE.
  5360     MOVE ' '                    TO X.
  5361     MOVE DETAIL-LINE            TO P-DATA.
  5362     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT.
  5363     MOVE SPACES                 TO DET-TITLE.
  5364     MOVE ZERO-ACCUM             TO YTD-REPTCD2-ACCUM.
  5365
  5366     MOVE PYTDRP2-LBEN           TO DET-LBEN
  5367     MOVE PYTDRP2-LPRM           TO DET-LPRM
  5368     MOVE PYTDRP2-LCLM           TO DET-LCLM
  5369     MOVE PYTDRP2-ABEN           TO DET-ABEN
  5370     MOVE PYTDRP2-APRM           TO DET-APRM
  5371     MOVE PYTDRP2-ACLM           TO DET-ACLM
  5372     MOVE PYTDRP2-TPRM           TO DET-TPRM
  5373     MOVE PYTDRP2-TCOM           TO DET-TCOM
  5374     MOVE 'PRIOR YTD         '   TO DET-TITLE
  5375     MOVE ' '                    TO X
  5376     MOVE DETAIL-LINE            TO P-DATA
  5377     PERFORM 1100-WRITE-PRINT THRU 1199-EXIT
  5378
  5379     MOVE SPACES                 TO DET-TITLE
  5380     MOVE ZERO-ACCUM             TO PYTD-REPTCD2-ACCUM.
  5381     .
  5382 1790-ZERO-REPTCD2.
  5383     MOVE +0                     TO X1.
  5384     PERFORM 0256-ZERO-ACCUM-REPT2 15 TIMES.
  5385
  5386 1799-REPTCD2-RETURN.
  5387     GO TO 0310-READ-EARNED-PREM-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS036.cbl
* 5389 COPY ELCDCS.
  5390****************************************************************  04/15/98
  5391*                                                              *  ELCDCS
  5392*                                                              *  ELCDCS
  5393*                            ELCDCS.                           *     LV003
  5394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5395*                            VMOD=2.002                        *     CL**3
  5396*                                                              *  ELCDCS
  5397*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5398****************************************************************. ELCDCS
  5399                                                                  ELCDCS
  5400 8510-DATE-CONVERSION.                                            ELCDCS
  5401     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5402                                                                  ELCDCS
  5403 8590-EXIT.                                                       ELCDCS
  5404     EXIT.                                                        ELCDCS
  5405                                                                  ELCDCS
  5406 9000-END-OF-JOB.
* 5407                             COPY ELCPRTC.
  5408******************************************************************04/15/98
  5409*                                                                *ELCPRTC
  5410*                                                                *ELCPRTC
  5411*                            ELCPRTC.                            *   LV003
  5412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5413*                            VMOD=2.002                          *   CL**2
  5414*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5415*                                                                *ELCPRTC
  5416* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5417******************************************************************ELCPRTC
  5418                                                                  ELCPRTC
  5419      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5420          CLOSE FICH.                                             ELCPRTC
  5421                                                                  ELCPRTC
  5422******************************************************************ELCPRTC
  5423     CLOSE PRNT.
  5424     CLOSE SELECT-FILE.
  5425
  5426 9099-EXIT.
  5427     EXIT.
  5428
  5429 ABEND-PGM SECTION.
*                                      COPY ELCABEND.
  5430***************************************************************** 04/14/98
  5431*                                                               * ELCABEND
  5432*                            ELCABEND.                          *    LV003
  5433*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5434*                            VMOD 2.002                              CL**2
  5435*                                                               * ELCABEND
  5436*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  5437*            AND THEN ABENDS.                                   * ELCABEND
  5438*                                                               * ELCABEND
  5439*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  5440*                                                               * ELCABEND
  5441***************************************************************** ELCABEND
  5442*APS-010.                                                         ELCABEND
  5443     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  5444     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  5445                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS036.cbl (/apps/prod/cid1p/copy/ELCABEND)
  5446     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  5447         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5448         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5449                                 UPON CONSOLE.                    ELCABEND
  5450                                                                  ELCABEND
  5451     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  5452         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5453         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5454                                 UPON CONSOLE.                    ELCABEND
  5455                                                                  ELCABEND
  5456     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5457     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5458                                 UPON CONSOLE.                    ELCABEND
  5459                                                                  ELCABEND
  5460     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  5461     CALL 'ABORTME'.
  5462                                                                  ELCABEND
  5463 APS-EXIT.                                                        ELCABEND
  5464     EXIT.                                                        ELCABEND
  5465
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       63452     Code:       32909
