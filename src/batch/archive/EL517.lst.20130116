* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL517 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 06/08/94 08:12:06.
     8*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     9*                            VMOD=2.040.
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   2
* EL517.cbl
    14*DATE-COMPILED.
    15
    16*SECURITY.   *****************************************************
    17*            *                                                   *
    18*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25
    26*REMARKS.
    27*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    28*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    39* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    40*                                IS OPEN OR CNC DT < PD THRU
    41*                                ALSO ADD ALTERNATE KEY CLAUSE
    42* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    43* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    44* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    45* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    46* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    47* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    48* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    49* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    50* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    51* 061412  CR2011022800001  AJRA  NAPERSOFT
    52* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    53* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    54* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    55******************************************************************
    56
    57 ENVIRONMENT DIVISION.
    58
    59 INPUT-OUTPUT SECTION.
    60
    61 FILE-CONTROL.
    62
    63     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    64
    65     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    66                             ORGANIZATION IS INDEXED
    67                             ACCESS IS DYNAMIC
    68                             RECORD KEY IS CF-CONTROL-PRIMARY
    69                             FILE STATUS IS ELCNTL-FILE-STATUS.
    70
    71     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   3
* EL517.cbl
    72                             ORGANIZATION IS INDEXED
    73                             ACCESS IS SEQUENTIAL
    74                             RECORD KEY IS PB-CONTROL-PRIMARY
    75                             ALTERNATE RECORD KEY IS
    76                                 PB-CONTROL-BY-ACCOUNT
    77                             FILE STATUS IS ERPNDB-FILE-STATUS.
    78
    79     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    80                             ORGANIZATION IS INDEXED
    81                             ACCESS IS DYNAMIC
    82                             RECORD KEY IS RE-CONTROL-PRIMARY
    83                             FILE STATUS IS ERREIN-FILE-STATUS.
    84
    85     SELECT ELCERT
*                                  COPY ELCCERTS.
    86******************************************************************04/15/98
    87*                                                                *ELCCERTS
    88*                            ELCCERTS.                           *   LV002
    89*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    90*                            VMOD=2.001                          *ELCCERTS
    91*                                                                *ELCCERTS
    92*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    93*                                                                *ELCCERTS
    94*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
    95******************************************************************ELCCERTS
    96                                                                  ELCCERTS
    97         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
    98         ORGANIZATION IS INDEXED                                  ELCCERTS
    99         ACCESS IS DYNAMIC                                        ELCCERTS
   100         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   101         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   102                                                                  ELCCERTS
   103
   104     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   105                             ORGANIZATION IS INDEXED
   106                             ACCESS IS DYNAMIC
   107                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   108                             FILE STATUS IS ELMSTR-FILE-STATUS.
   109
   110     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   111                             ORGANIZATION IS INDEXED
   112                             ACCESS IS DYNAMIC
   113                             RECORD KEY IS CT-CONTROL-PRIMARY
   114                             FILE STATUS IS ERCTBL-FILE-STATUS.
   115
   116     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   117                             ORGANIZATION IS INDEXED
   118                             ACCESS IS DYNAMIC
   119                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   120                             FILE STATUS IS ERACCT-FILE-STATUS.
   121
   122     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   123                             ORGANIZATION IS INDEXED
   124                             ACCESS IS DYNAMIC
   125                             RECORD KEY IS EM-CONTROL-PRIMARY
   126                             FILE STATUS IS ELCERR-FILE-STATUS.
   127
   128     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   4
* EL517.cbl
   129                             ORGANIZATION IS INDEXED
   130                             ACCESS IS DYNAMIC
   131                             RECORD KEY IS PM-CONTROL-PRIMARY
   132                             FILE STATUS IS ERPNDM-FILE-STATUS.
   133
   134     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   135                             ORGANIZATION IS INDEXED
   136                             ACCESS IS DYNAMIC
   137                             RECORD KEY IS MA-CONTROL-PRIMARY
   138                             FILE STATUS IS ERMAIL-FILE-STATUS.
   139
   140     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   141                             ORGANIZATION IS INDEXED
   142                             ACCESS IS DYNAMIC
   143                             RECORD KEY IS PL-CONTROL-PRIMARY
   144                             FILE STATUS IS ERPLAN-FILE-STATUS.
   145
   146     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   147                             ORGANIZATION IS INDEXED
   148                             ACCESS IS DYNAMIC
   149                             RECORD KEY IS FO-CONTROL-PRIMARY
   150                             FILE STATUS IS ERFORM-FILE-STATUS.
   151
   152     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   153
   154     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   155
   156     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   157                             ORGANIZATION IS INDEXED
   158                             ACCESS IS DYNAMIC
   159                             RECORD KEY IS RF-CONTROL-PRIMARY
   160                             FILE STATUS IS DTE-VSAM-FLAGS.
   161
   162     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   163                             ORGANIZATION IS INDEXED
   164                             ACCESS IS DYNAMIC
   165                             RECORD KEY IS ERRESS-PRIMARY-KEY
   166                             FILE STATUS IS ERRESS-FILE-STATUS.
   167
   168     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   169                             ORGANIZATION IS INDEXED
   170                             ACCESS IS DYNAMIC
   171                             RECORD KEY IS ERRESC-RECORD-KEY
   172                             FILE STATUS IS ERRESC-FILE-STATUS.
   173
   174     SELECT ERCOMP           ASSIGN TO             ERCOMP
   175                             ORGANIZATION IS INDEXED
   176                             ACCESS IS DYNAMIC
   177                             RECORD KEY IS CO-CONTROL-PRIMARY
   178                             FILE STATUS IS ERCOMP-FILE-STATUS.
   179
   180     SELECT ERLOFC           ASSIGN TO             ERLOFC
   181                             ORGANIZATION IS INDEXED
   182                             ACCESS IS DYNAMIC
   183                             RECORD KEY IS LO-CONTROL-PRIMARY
   184                             FILE STATUS IS ERLOFC-FILE-STATUS.
   185
   186     SELECT ERBXRF           ASSIGN TO             ERBXRF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   5
* EL517.cbl
   187                             ORGANIZATION IS INDEXED
   188                             ACCESS IS DYNAMIC
   189                             RECORD KEY IS BK-CONTROL-PRIMARY
   190                             FILE STATUS IS ERBXRF-FILE-STATUS.
   191
   192     SELECT ERAGTC           ASSIGN TO             ERAGTC
   193                             ORGANIZATION IS INDEXED
   194                             ACCESS IS DYNAMIC
   195                             RECORD KEY IS AG-CONTROL-PRIMARY
   196                             FILE STATUS IS ERAGTC-FILE-STATUS.
   197
   198     SELECT ELCRTT           ASSIGN TO             ELCRTT
   199                             ORGANIZATION IS INDEXED
   200                             ACCESS IS DYNAMIC
   201                             RECORD KEY IS CS-CONTROL-PRIMARY
   202                             FILE STATUS IS ELCRTT-FILE-STATUS.
   203
   204     SELECT ERPDEF           ASSIGN TO ERPDEF
   205                             ACCESS IS DYNAMIC
   206                             ORGANIZATION IS INDEXED
   207                             FILE STATUS IS ERPDEF-FILE-STATUS
   208                             RECORD KEY IS PD-CONTROL-PRIMARY.
   209
   210     SELECT ELSTAT           ASSIGN TO ELSTAT
   211                             ACCESS IS DYNAMIC
   212                             ORGANIZATION IS INDEXED
   213                             FILE STATUS IS ELSTAT-FILE-STATUS
   214                             RECORD KEY IS SF-CONTROL-PRIMARY.
   215
   216     SELECT ELCRTO           ASSIGN TO ELCRTO
   217                             ACCESS IS DYNAMIC
   218                             ORGANIZATION IS INDEXED
   219                             FILE STATUS IS ELCRTO-FILE-STATUS
   220                             RECORD KEY IS OC-CONTROL-PRIMARY.
   221
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   6
* EL517.cbl
   223 DATA DIVISION.
   224
   225 FILE SECTION.
   226
   227 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   228******************************************************************04/15/98
   229*                                                                *ELCDTEFD
   230*                                                                *ELCDTEFD
   231*                            ELCDTEFD.                           *   LV002
   232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   233*                            VMOD=2.007                          *   CL**2
   234*                                                                *ELCDTEFD
   235******************************************************************ELCDTEFD
   236     BLOCK CONTAINS 0 RECORDS
   237     RECORDING MODE F.                                            ELCDTEFD
   238                                                                  ELCDTEFD
   239 01  DATE-DISK.                                                   ELCDTEFD
   240     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   241     12  FILLER                      PIC  X(14).                  ELCDTEFD
   242     12  DD-CR1                      PIC  9.                      ELCDTEFD
   243     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   244     12  DD-CR2                      PIC  9.                      ELCDTEFD
   245     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   246     12  FILLER                      PIC  X(20).                  ELCDTEFD
   247                                                                  ELCDTEFD
   248 01  DATE-DISK-R.                                                 ELCDTEFD
   249     12  FILLER                      PIC  X(4).                   ELCDTEFD
   250     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   251                                     PIC  X(32).                  ELCDTEFD
   252                                                                  ELCDTEFD
   253 01  DATE-DISK-T.                                                 ELCDTEFD
   254     12  FILLER                      PIC  X(4).                   ELCDTEFD
   255     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   256                                     PIC  X(48).                  ELCDTEFD
   257                                                                  ELCDTEFD
   258 01  DATE-DISK-M.                                                 ELCDTEFD
   259     12  FILLER                      PIC  X(4).                   ELCDTEFD
   260     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   261                                     PIC  X(48).                  ELCDTEFD
   262                                                                  ELCDTEFD
   263 01  DATE-DISK-P.                                                 ELCDTEFD
   264     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   265     12  DD-IDX                      PIC  99.                     ELCDTEFD
   266     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   267     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   268         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   269                                     PIC  X.                      ELCDTEFD
   270         16  FILLER                  PIC  X(46).                  ELCDTEFD
   271     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   272         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   273             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   274             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   275             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   276             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   277         16  FILLER                  PIC  X(16).                  ELCDTEFD
   278                                                                  ELCDTEFD
   279 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   280     12  FILLER                      PIC  X(4).                   ELCDTEFD
   281     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   282                                     PIC  X(4).                   ELCDTEFD
   283                                                                  ELCDTEFD
   284 01  DATE-DISK-C.                                                 ELCDTEFD
   285     12  FILLER                      PIC  X(7).                   ELCDTEFD
   286     12  DD-CARR1-SECPAY-SW          PIC  X.
   287     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   288     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   289     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   290     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   291     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   292     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   293     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   294     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   295     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   296     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   297     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   298     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   299     12  DD-CARR2-SECPAY-SW          PIC  X.
   300     12  FILLER                      PIC  X(7).                   ELCDTEFD
   301                                                                  ELCDTEFD
   302 01  DATE-DISK-OPT.                                               ELCDTEFD
   303     12  FILLER                      PIC  X(04).                  ELCDTEFD
   304     12  DD-TLR-DATA.                                             ELCDTEFD
   305         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   306                                     PIC  X(03).                  ELCDTEFD
   307     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   308         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   309                                     PIC  X(06).                  ELCDTEFD
   310     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   311         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   312                                     PIC  X(07).                  ELCDTEFD
   313         16  FILLER                  PIC  X(05).                  ELCDTEFD
   314     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   315                                     PIC  X(96).                  ELCDTEFD
   316******************************************************************ELCDTEFD
   317
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   8
* EL517.cbl
   319 FD  ELCNTL.
*  320                                 COPY ELCCNTL.
   321******************************************************************
   322*                                                                *
   323*                                                                *
   324*                            ELCCNTL.                            *
   325*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   326*                            VMOD=2.059                          *
   327*                                                                *
   328*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   329*                                                                *
   330*   FILE TYPE = VSAM,KSDS                                        *
   331*   RECORD SIZE = 750  RECFORM = FIXED                           *
   332*                                                                *
   333*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   334*       ALTERNATE INDEX = NONE                                   *
   335*                                                                *
   336*   LOG = YES                                                    *
   337*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   338******************************************************************
   339*                   C H A N G E   L O G
   340*
   341* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   342*-----------------------------------------------------------------
   343*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   344* EFFECTIVE    NUMBER
   345*-----------------------------------------------------------------
   346* 082503                   PEMA  ADD BENEFIT GROUP
   347* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   348* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   349* 092705    2005050300006  PEMA  ADD SPP LEASES
   350* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   351* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   352* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   353* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   354* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   355* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   356******************************************************************
   357*
   358 01  CONTROL-FILE.
   359     12  CF-RECORD-ID                       PIC XX.
   360         88  VALID-CF-ID                        VALUE 'CF'.
   361
   362     12  CF-CONTROL-PRIMARY.
   363         16  CF-COMPANY-ID                  PIC XXX.
   364         16  CF-RECORD-TYPE                 PIC X.
   365             88  CF-COMPANY-MASTER              VALUE '1'.
   366             88  CF-PROCESSOR-MASTER            VALUE '2'.
   367             88  CF-STATE-MASTER                VALUE '3'.
   368             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   369             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   370             88  CF-CARRIER-MASTER              VALUE '6'.
   371             88  CF-MORTALITY-MASTER            VALUE '7'.
   372             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   373             88  CF-TERMINAL-MASTER             VALUE '9'.
   374             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   375             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   376             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   9
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   377             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   378             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   379             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   380             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   381             88  CF-REMINDERS-MASTER            VALUE 'R'.
   382             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   383         16  CF-ACCESS-CD-GENL              PIC X(4).
   384         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   385             20  CF-PROCESSOR               PIC X(4).
   386         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   387             20  CF-STATE-CODE              PIC XX.
   388             20  FILLER                     PIC XX.
   389         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   390             20  FILLER                     PIC XX.
   391             20  CF-HI-BEN-IN-REC           PIC XX.
   392         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   393             20  FILLER                     PIC XXX.
   394             20  CF-CARRIER-CNTL            PIC X.
   395         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   396             20  FILLER                     PIC XX.
   397             20  CF-HI-TYPE-IN-REC          PIC 99.
   398         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   399             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   400                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   401             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   402             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   403         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   404             20  FILLER                     PIC X.
   405             20  CF-CUSTOM-REPORT-NO        PIC 999.
   406         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   407             20  FILLER                     PIC XX.
   408             20  CF-MORTGAGE-PLAN           PIC XX.
   409         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   410
   411     12  CF-LAST-MAINT-DT                   PIC XX.
   412     12  CF-LAST-MAINT-BY                   PIC X(4).
   413     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   414
   415     12  CF-RECORD-BODY                     PIC X(728).
   416
   417
   418****************************************************************
   419*             COMPANY MASTER RECORD                            *
   420****************************************************************
   421
   422     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   423         16  CF-COMPANY-ADDRESS.
   424             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   425             20  CF-CL-IN-CARE-OF           PIC X(30).
   426             20  CF-CL-ADDR-LINE-1          PIC X(30).
   427             20  CF-CL-ADDR-LINE-2          PIC X(30).
   428             20  CF-CL-CITY-STATE           PIC X(30).
   429             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   430             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   431         16  CF-COMPANY-CD                  PIC X.
   432         16  CF-COMPANY-PASSWORD            PIC X(8).
   433         16  CF-SECURITY-OPTION             PIC X.
   434             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  10
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   435             88  COMPANY-VERIFY                 VALUE '2'.
   436             88  PROCESSOR-VERIFY               VALUE '3'.
   437             88  NO-SECURITY                    VALUE '4'.
   438             88  ALL-BUT-TERM                   VALUE '5'.
   439         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   440             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   441         16  CF-LGX-INTERFACE-CNTL          PIC X.
   442             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   443         16  CF-INFORCE-LOCATION            PIC X.
   444             88  CERTS-ARE-ONLINE               VALUE '1'.
   445             88  CERTS-ARE-OFFLINE              VALUE '2'.
   446             88  NO-CERTS-AVAILABLE             VALUE '3'.
   447         16  CF-LOWER-CASE-LETTERS          PIC X.
   448         16  CF-CERT-ACCESS-CONTROL         PIC X.
   449             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   450             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   451             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   452             88  CF-ACCNT-CNTL                  VALUE '3'.
   453             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   454
   455         16  CF-FORMS-PRINTER-ID            PIC X(4).
   456         16  CF-CHECK-PRINTER-ID            PIC X(4).
   457
   458         16  CF-LGX-CREDIT-USER             PIC X.
   459             88  CO-IS-NOT-USER                 VALUE 'N'.
   460             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   461
   462         16 CF-CREDIT-CALC-CODES.
   463             20  CF-CR-REM-TERM-CALC PIC X.
   464               88  CR-EARN-AFTER-15TH           VALUE '1'.
   465               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   466               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   467               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   468               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   469               88  CR-EARN-AFTER-14TH           VALUE '6'.
   470               88  CR-EARN-AFTER-16TH           VALUE '7'.
   471             20  CF-CR-R78-METHOD           PIC X.
   472               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   473               88  DONT-USE-PLUS-ONE            VALUE '1'.
   474
   475         16  CF-CLAIM-CONTROL-COUNTS.
   476             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   477                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   478
   479             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   480                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   481
   482             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   483                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   484
   485             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   486                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   487
   488         16  CF-CURRENT-MONTH-END           PIC XX.
   489
   490         16  CF-CO-CALC-QUOTE-TOLERANCE.
   491             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   492             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  11
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   493             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   494             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   495                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   496                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   497             20  CF-CO-PREM-REJECT-SW       PIC X.
   498                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   499                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   500             20  CF-CO-REF-REJECT-SW        PIC X.
   501                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   502                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   503
   504         16  CF-CO-REPORTING-DT             PIC XX.
   505         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   506         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   507           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   508           88  CF-CO-MONTH-END                  VALUE '1'.
   509
   510         16  CF-LGX-CLAIM-USER              PIC X.
   511             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   512             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   513
   514         16  CF-CREDIT-EDIT-CONTROLS.
   515             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   516             20  CF-MIN-AGE                 PIC 99.
   517             20  CF-DEFAULT-AGE             PIC 99.
   518             20  CF-MIN-TERM                PIC S999      COMP-3.
   519             20  CF-MAX-TERM                PIC S999      COMP-3.
   520             20  CF-DEFAULT-SEX             PIC X.
   521             20  CF-JOINT-AGE-INPUT         PIC X.
   522                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   523             20  CF-BIRTH-DATE-INPUT        PIC X.
   524                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   525             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   526                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   527                 88  CF-ZERO-CARRIER            VALUE '1'.
   528                 88  CF-ZERO-GROUPING           VALUE '2'.
   529                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   530             20  CF-EDIT-SW                 PIC X.
   531                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   532             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   533             20  CF-CR-PR-METHOD            PIC X.
   534               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   535               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   536             20  FILLER                     PIC X.
   537
   538         16  CF-CREDIT-MISC-CONTROLS.
   539             20  CF-REIN-TABLE-SW           PIC X.
   540                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   541             20  CF-COMP-TABLE-SW           PIC X.
   542                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   543             20  CF-EXPERIENCE-RETENTION-AGE
   544                                            PIC S9        COMP-3.
   545             20  CF-CONVERSION-DT           PIC XX.
   546             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   547             20  CF-RUN-FREQUENCY-SW        PIC X.
   548                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   549                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   550
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  12
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   551             20  CF-CR-CHECK-NO-CONTROL.
   552                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   553                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   554                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   555                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   556                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   557                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   558
   559                 24  CF-CR-CHECK-COUNT       REDEFINES
   560                     CF-CR-CHECK-COUNTER      PIC X(4).
   561
   562                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   563                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   564
   565                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   566                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   567                 24  CF-MAIL-PROCESSING       PIC X.
   568                     88  MAIL-PROCESSING          VALUE 'Y'.
   569
   570         16  CF-MISC-SYSTEM-CONTROL.
   571             20  CF-SYSTEM-C                 PIC X.
   572                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   573             20  CF-SYSTEM-D                 PIC X.
   574                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   575             20  CF-SOC-SEC-NO-SW            PIC X.
   576                 88  SOC-SEC-NO-USED             VALUE '1'.
   577             20  CF-MEMBER-NO-SW             PIC X.
   578                 88  MEMBER-NO-USED              VALUE '1'.
   579             20  CF-TAX-ID-NUMBER            PIC X(11).
   580             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   581             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   582                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   583                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   584                 88  CF-ALL-APPROVED             VALUE 'Y'.
   585                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   586             20  CF-SYSTEM-E                 PIC X.
   587                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   588
   589         16  CF-LGX-LIFE-USER               PIC X.
   590             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   591             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   592
   593         16  CF-CR-MONTH-END-DT             PIC XX.
   594
   595         16  CF-FILE-MAINT-DATES.
   596             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   597                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   598             20  CF-LAST-BATCH       REDEFINES
   599                 CF-LAST-BATCH-NO               PIC X(4).
   600             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   601             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   602             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   603             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   604             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   605             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   606             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   607             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   608             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  13
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   609             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   610
   611         16  CF-NEXT-COMPANY-ID             PIC XXX.
   612         16  FILLER                         PIC X.
   613
   614         16  CF-ALT-MORT-CODE               PIC X(4).
   615         16  CF-MEMBER-CAPTION              PIC X(10).
   616
   617         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   618             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   619             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   620             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   621             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   622             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   623
   624         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   625
   626         16  CF-LIFE-OVERRIDE-L1            PIC X.
   627         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   628         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   629         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   630
   631         16  CF-AH-OVERRIDE-L1              PIC X.
   632         16  CF-AH-OVERRIDE-L2              PIC XX.
   633         16  CF-AH-OVERRIDE-L6              PIC X(6).
   634         16  CF-AH-OVERRIDE-L12             PIC X(12).
   635
   636         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   637         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   638
   639         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   640         16  CF-AR-LAST-EL860-DT            PIC XX.
   641         16  CF-MP-MONTH-END-DT             PIC XX.
   642
   643         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   644         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   645             88  CF-CLAIM-PAID-TO               VALUE '1'.
   646
   647         16  CF-AR-MONTH-END-DT             PIC XX.
   648
   649         16  CF-CRDTCRD-USER                PIC X.
   650             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   651             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   652
   653         16  CF-CC-MONTH-END-DT             PIC XX.
   654
   655         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   656
   657         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   658             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   659             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   660             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   661         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   662         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   663         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   664         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   665             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   666             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  14
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   667         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   668         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   669         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   670             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   671         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   672
   673         16  CF-CL-ZIP-CODE.
   674             20  CF-CL-ZIP-PRIME.
   675                 24  CF-CL-ZIP-1ST          PIC X.
   676                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   677                 24  FILLER                 PIC X(4).
   678             20  CF-CL-ZIP-PLUS4            PIC X(4).
   679         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   680             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   681             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   682             20  FILLER                     PIC XXX.
   683
   684         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   685         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   686         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   687         16  CF-CO-OPTION-START-DATE        PIC XX.
   688         16  CF-REM-TRM-CALC-OPTION         PIC X.
   689           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   690                                                      '3' '4'.
   691           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   692           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   693           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   694           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   695           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   696           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   697
   698         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   699
   700         16  CF-PAYMENT-APPROVAL-LEVELS.
   701             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   702             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   703             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   704             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   705             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   706             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   707
   708         16  CF-END-USER-REPORTING-USER     PIC X.
   709             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   710             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   711
   712         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   713             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   714             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   715
   716         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   717
   718         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   719         16  FILLER                         PIC X.
   720
   721         16  CF-CREDIT-ARCHIVE-CNTL.
   722             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   723             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   724             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  15
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   725
   726         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   727
   728         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   729             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   730             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   731
   732         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   733             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   734             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   735
   736         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   737
   738         16  CF-CO-ACH-ID-CODE              PIC  X.
   739             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   740             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   741             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   742         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   743         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   744         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   745         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   746         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   747         16  CF-CO-ACH-RECV-NO              PIC X(08).
   748         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   749         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   750         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   751                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   752         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   753                 CF-CO-ACH-TRACE-NO         PIC X(4).
   754
   755         16  CF-CO-OVER-SHORT.
   756             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   757             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   758
   759*         16  FILLER                         PIC X(102).
   760         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   761             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   762             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   763
   764         16  CF-AH-APPROVAL-DAYS.
   765             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   766             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   767             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   768             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   769
   770         16  FILLER                         PIC X(82).
   771****************************************************************
   772*             PROCESSOR/USER RECORD                            *
   773****************************************************************
   774
   775     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   776         16  CF-PROCESSOR-NAME              PIC X(30).
   777         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   778         16  CF-PROCESSOR-TITLE             PIC X(26).
   779         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   780                 88  MESSAGE-YES                VALUE 'Y'.
   781                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   782
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  16
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   783*****************************************************
   784****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   785****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   786****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   787****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   788*****************************************************
   789
   790         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   791             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   792             20  CF-APPLICATION-FORCE       PIC X.
   793             20  CF-INDIVIDUAL-APP.
   794                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   795                     28  CF-BROWSE-APP      PIC X.
   796                     28  CF-UPDATE-APP      PIC X.
   797
   798         16  CF-CURRENT-TERM-ON             PIC X(4).
   799         16  CF-PROCESSOR-LIMITS-CLAIMS.
   800             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   801             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   802             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   803             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   804             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   805             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   806             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   807         16  CF-PROCESSOR-CARRIER           PIC X.
   808             88  NO-CARRIER-SECURITY            VALUE ' '.
   809         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   810             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   811         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   812             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   813         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   814             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   815
   816         16  CF-PROC-SYS-ACCESS-SW.
   817             20  CF-PROC-CREDIT-CLAIMS-SW.
   818                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   819                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   820                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   821                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   822             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   823                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   824                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   825             20  CF-PROC-LIFE-GNRLDGR-SW.
   826                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   827                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   828                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   829                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   830             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   831                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   832                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   833         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   834             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   835             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   836         16  CF-PROCESSOR-PRINTER               PIC X(4).
   837
   838         16  CF-APPROVAL-LEVEL                  PIC X.
   839             88  APPROVAL-LEVEL-1                   VALUE '1'.
   840             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  17
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   841             88  APPROVAL-LEVEL-3                   VALUE '3'.
   842             88  APPROVAL-LEVEL-4                   VALUE '4'.
   843
   844         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   845
   846         16  CF-LANGUAGE-TYPE                   PIC X.
   847             88  CF-LANG-IS-ENG                     VALUE 'E'.
   848             88  CF-LANG-IS-FR                      VALUE 'F'.
   849
   850         16  CF-CSR-IND                         PIC X.
   851         16  FILLER                             PIC X(239).
   852
   853****************************************************************
   854*             PROCESSOR/REMINDERS RECORD                       *
   855****************************************************************
   856
   857     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   858         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   859             20  CF-START-REMIND-DT         PIC XX.
   860             20  CF-END-REMIND-DT           PIC XX.
   861             20  CF-REMINDER-TEXT           PIC X(50).
   862         16  FILLER                         PIC X(296).
   863
   864
   865****************************************************************
   866*             STATE MASTER RECORD                              *
   867****************************************************************
   868
   869     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   870         16  CF-STATE-ABBREVIATION          PIC XX.
   871         16  CF-STATE-NAME                  PIC X(25).
   872         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   873         16  CF-ST-CALC-QUOTE-TOLERANCE.
   874             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   875             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   876             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   877             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   878                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   879                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   880             20  CF-ST-PREM-REJECT-SW       PIC X.
   881                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   882                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   883             20  CF-ST-REF-REJECT-SW        PIC X.
   884                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   885                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   886         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   887         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   888         16  CF-ST-REFUND-RULES.
   889             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   890             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   891             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   892         16  CF-ST-FST-PMT-EXTENSION.
   893             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   894             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   895                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   896                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   897                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   898                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  18
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   899         16  CF-ST-STATE-CALL.
   900             20  CF-ST-CALL-UNEARNED        PIC X.
   901             20  CF-ST-CALL-RPT-CNTL        PIC X.
   902             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   903         16  CF-REPLACEMENT-LAW-SW          PIC X.
   904             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   905             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   906         16  CF-REPLACEMENT-LETTER          PIC X(4).
   907         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   908         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   909         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   910         16  CF-ST-SPLIT-PAYMENT            PIC X.
   911         16  FILLER                         PIC X.
   912         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   913             20  CF-ST-BENEFIT-CD           PIC XX.
   914             20  CF-ST-BENEFIT-KIND         PIC X.
   915                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   916                 88  CF-ST-AH-KIND              VALUE 'A'.
   917             20  CF-ST-REM-TERM-CALC        PIC X.
   918                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   919                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   920                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   921                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   922                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   923                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   924                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   925                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   926
   927             20  CF-ST-REFUND-CALC          PIC X.
   928                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   929                 88  ST-REFD-BY-R78             VALUE '1'.
   930                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   931                 88  ST-REFD-AS-CALIF           VALUE '3'.
   932                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   933                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   934                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   935                 88  ST-REFD-UTAH               VALUE '7'.
   936                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   937                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   938                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   939
   940             20  CF-ST-EARNING-CALC         PIC X.
   941                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   942                 88  ST-EARN-BY-R78             VALUE '1'.
   943                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   944                 88  ST-EARN-AS-CALIF           VALUE '3'.
   945                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   946                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   947                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   948                 88  ST-EARN-MEAN               VALUE '8'.
   949                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   950
   951             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   952                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   953                 88  ST-OVRD-BY-R78             VALUE '1'.
   954                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   955                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   956                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  19
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   957                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   958                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   959                 88  ST-OVRD-MEAN               VALUE '8'.
   960                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   961             20  FILLER                     PIC X.
   962
   963         16  CF-ST-COMMISSION-CAPS.
   964             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   965             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   966             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   967             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   968         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   969                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   970
   971         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   972
   973         16  CF-ST-STATUTORY-INTEREST.
   974             20  CF-ST-STAT-DATE-FROM       PIC X.
   975                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   976                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   977             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   978             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   979             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   980             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   981             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   982
   983         16  CF-ST-OVER-SHORT.
   984             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   985             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
   986
   987         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
   988
   989         16  CF-ST-RT-CALC                  PIC X.
   990
   991         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
   992         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
   993         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
   994         16  CF-ST-RF-LR-CALC               PIC X.
   995         16  CF-ST-RF-LL-CALC               PIC X.
   996         16  CF-ST-RF-LN-CALC               PIC X.
   997         16  CF-ST-RF-AH-CALC               PIC X.
   998         16  CF-ST-RF-CP-CALC               PIC X.
   999*        16  FILLER                         PIC X(206).
  1000*CIDMOD         16  FILLER                         PIC X(192).
  1001         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1002             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1003         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1004         16  CF-ST-VFY-2ND-BENE             PIC X.
  1005         16  FILLER                         PIC X(186).
  1006
  1007****************************************************************
  1008*             BENEFIT MASTER RECORD                            *
  1009****************************************************************
  1010
  1011     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1012         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1013             20  CF-BENEFIT-CODE            PIC XX.
  1014             20  CF-BENEFIT-NUMERIC  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  20
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1015                 CF-BENEFIT-CODE            PIC XX.
  1016             20  CF-BENEFIT-ALPHA           PIC XXX.
  1017             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1018             20  CF-BENEFIT-COMMENT         PIC X(10).
  1019
  1020             20  CF-LF-COVERAGE-TYPE        PIC X.
  1021                 88  CF-REDUCING                VALUE 'R'.
  1022                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1023
  1024             20  CF-SPECIAL-CALC-CD         PIC X.
  1025                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1026                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1027                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1028                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1029                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1030                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1031                 88  CF-FARM-PLAN               VALUE 'F'.
  1032                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1033                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1034                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1035                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1036                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1037                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1038                 88  CF-PRUDENTIAL              VALUE 'P'.
  1039                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1040                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1041                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1042                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1043                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1044                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1045
  1046             20  CF-JOINT-INDICATOR         PIC X.
  1047                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1048
  1049*            20  FILLER                     PIC X(12).
  1050             20  FILLER                     PIC X(11).
  1051             20  CF-BENEFIT-CATEGORY        PIC X.
  1052             20  CF-LOAN-TYPE               PIC X(8).
  1053
  1054             20  CF-CO-REM-TERM-CALC        PIC X.
  1055                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1056                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1057                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1058                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1059                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1060
  1061             20  CF-CO-EARNINGS-CALC        PIC X.
  1062                 88  CO-EARN-BY-R78             VALUE '1'.
  1063                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1064                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1065                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1066                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1067                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1068                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1069                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1070
  1071             20  CF-CO-REFUND-CALC          PIC X.
  1072                 88  CO-REFUND-NOT-USED         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  21
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1073                 88  CO-REFD-BY-R78             VALUE '1'.
  1074                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1075                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1076                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1077                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1078                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1079                 88  CO-REFD-MEAN               VALUE '8'.
  1080                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1081                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1082                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1083
  1084             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1085                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1086                 88  CO-OVRD-BY-R78             VALUE '1'.
  1087                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1088                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1089                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1090                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1091                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1092                 88  CO-OVRD-MEAN               VALUE '8'.
  1093                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1094
  1095             20  CF-CO-BEN-I-G-CD           PIC X.
  1096                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1097                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1098                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1099
  1100         16  FILLER                         PIC X(304).
  1101
  1102
  1103****************************************************************
  1104*             CARRIER MASTER RECORD                            *
  1105****************************************************************
  1106
  1107     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1108         16  CF-ADDRESS-DATA.
  1109             20  CF-MAIL-TO-NAME            PIC X(30).
  1110             20  CF-IN-CARE-OF              PIC X(30).
  1111             20  CF-ADDRESS-LINE-1          PIC X(30).
  1112             20  CF-ADDRESS-LINE-2          PIC X(30).
  1113             20  CF-CITY-STATE              PIC X(30).
  1114             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1115             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1116
  1117         16  CF-CLAIM-NO-CONTROL.
  1118             20  CF-CLAIM-NO-METHOD         PIC X.
  1119                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1120                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1121                 88  CLAIM-NO-SEQ               VALUE '3'.
  1122                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1123             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1124                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1125                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1126                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1127
  1128         16  CF-CHECK-NO-CONTROL.
  1129             20  CF-CHECK-NO-METHOD         PIC X.
  1130                 88  CHECK-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  22
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1131                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1132                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1133                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1134             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1135                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1136
  1137         16  CF-DOMICILE-STATE              PIC XX.
  1138
  1139         16  CF-EXPENSE-CONTROLS.
  1140             20  CF-EXPENSE-METHOD          PIC X.
  1141                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1142                 88  DOLLARS-PER-PMT            VALUE '2'.
  1143                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1144                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1145             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1146             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1147
  1148         16  CF-CORRESPONDENCE-CONTROL.
  1149             20  CF-LETTER-RESEND-OPT       PIC X.
  1150                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1151                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1152             20  FILLER                     PIC X(4).
  1153
  1154         16  CF-RESERVE-CONTROLS.
  1155             20  CF-MANUAL-SW               PIC X.
  1156                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1157             20  CF-FUTURE-SW               PIC X.
  1158                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1159             20  CF-PTC-SW                  PIC X.
  1160                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1161             20  CF-IBNR-SW                 PIC X.
  1162                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1163             20  CF-PTC-LF-SW               PIC X.
  1164                 88  CF-LF-PTC-USED             VALUE '1'.
  1165             20  CF-CDT-ACCESS-METHOD       PIC X.
  1166                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1167                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1168                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1169             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1170
  1171         16  CF-CLAIM-CALC-METHOD           PIC X.
  1172             88  360-PLUS-MONTHS                VALUE '1'.
  1173             88  365-PLUS-MONTHS                VALUE '2'.
  1174             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1175             88  360-DAILY                      VALUE '4'.
  1176             88  365-DAILY                      VALUE '5'.
  1177
  1178         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1179         16  FILLER                         PIC X(11).
  1180
  1181         16  CF-LIMIT-AMOUNTS.
  1182             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1183             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1184             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1185             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1186             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1187             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1188             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  23
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1189             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1190             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1191             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1192
  1193         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1194         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1195         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1196
  1197         16  CF-ZIP-CODE.
  1198             20  CF-ZIP-PRIME.
  1199                 24  CF-ZIP-1ST             PIC X.
  1200                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1201                 24  FILLER                 PIC X(4).
  1202             20  CF-ZIP-PLUS4               PIC X(4).
  1203         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1204             20  CF-CAN-POSTAL-1            PIC XXX.
  1205             20  CF-CAN-POSTAL-2            PIC XXX.
  1206             20  FILLER                     PIC XXX.
  1207
  1208         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1209         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1210         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1211
  1212         16  CF-RATING-SWITCH               PIC X.
  1213             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1214             88  CF-NO-RATING                   VALUE 'N'.
  1215
  1216         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1217
  1218         16  CF-CARRIER-OVER-SHORT.
  1219             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1220             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1221
  1222         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1223         16  CF-SECPAY-SWITCH               PIC X.
  1224             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1225             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1226         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1227         16  FILLER                         PIC X(448).
  1228*        16  FILLER                         PIC X(452).
  1229
  1230
  1231****************************************************************
  1232*             MORTALITY MASTER RECORD                          *
  1233****************************************************************
  1234
  1235     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1236         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1237                                INDEXED BY CF-MORT-NDX.
  1238             20  CF-MORT-TABLE              PIC X(5).
  1239             20  CF-MORT-TABLE-TYPE         PIC X.
  1240                 88  CF-MORT-JOINT              VALUE 'J'.
  1241                 88  CF-MORT-SINGLE             VALUE 'S'.
  1242                 88  CF-MORT-COMBINED           VALUE 'C'.
  1243                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1244                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1245             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1246             20  CF-MORT-AGE-METHOD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  24
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1247                 88  CF-AGE-LAST                VALUE 'AL'.
  1248                 88  CF-AGE-NEAR                VALUE 'AN'.
  1249             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1250             20  CF-MORT-ADJUSTMENT-DIRECTION
  1251                                            PIC X.
  1252                 88  CF-MINUS                   VALUE '-'.
  1253                 88  CF-PLUS                    VALUE '+'.
  1254             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1255             20  CF-MORT-JOINT-CODE         PIC X.
  1256                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1257             20  CF-MORT-PC-Q               PIC X.
  1258                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1259             20  CF-MORT-TABLE-CODE         PIC X(4).
  1260             20  CF-MORT-COMMENTS           PIC X(15).
  1261             20  FILLER                     PIC X(14).
  1262
  1263         16  FILLER                         PIC X(251).
  1264
  1265
  1266****************************************************************
  1267*             BUSSINESS TYPE MASTER RECORD                     *
  1268****************************************************************
  1269
  1270     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1271* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1272* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1273* AND RECORD 05 IS TYPES 81-99
  1274         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1275             20  CF-BUSINESS-TITLE          PIC  X(19).
  1276             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1277                                            PIC S9V9(4) COMP-3.
  1278             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1279             20  FILLER                     PIC  X.
  1280         16  FILLER                         PIC  X(248).
  1281
  1282
  1283****************************************************************
  1284*             TERMINAL MASTER RECORD                           *
  1285****************************************************************
  1286
  1287     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1288
  1289         16  CF-COMPANY-TERMINALS.
  1290             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1291                                  PIC X(4).
  1292         16  FILLER               PIC X(248).
  1293
  1294
  1295****************************************************************
  1296*             LIFE EDIT MASTER RECORD                          *
  1297****************************************************************
  1298
  1299     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1300         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1301             20  CF-LIFE-CODE-IN            PIC XX.
  1302             20  CF-LIFE-CODE-OUT           PIC XX.
  1303         16  FILLER                         PIC X(248).
  1304
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  25
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1305
  1306****************************************************************
  1307*             AH EDIT MASTER RECORD                            *
  1308****************************************************************
  1309
  1310     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1311         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1312             20  CF-AH-CODE-IN              PIC XXX.
  1313             20  CF-AH-CODE-OUT             PIC XX.
  1314         16  FILLER                         PIC X(248).
  1315
  1316
  1317****************************************************************
  1318*             CREDIBILITY TABLES                               *
  1319****************************************************************
  1320
  1321     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1322         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1323                             INDEXED BY CF-CRDB-NDX.
  1324             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1325             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1326             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1327         16  FILLER                         PIC  X(332).
  1328
  1329
  1330****************************************************************
  1331*             REPORT CUSTOMIZATION RECORD                      *
  1332****************************************************************
  1333
  1334     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1335         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1336             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1337             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1338             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1339**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1340****       A T-TRANSFER.                                   ****
  1341             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1342
  1343         16  FILLER                         PIC XX.
  1344
  1345         16  CF-CARRIER-CNTL-OPT.
  1346             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1347                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1348                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1349             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1350                                            PIC X.
  1351         16  CF-GROUP-CNTL-OPT.
  1352             20  CF-GROUP-OPT-SEQ           PIC 9.
  1353                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1354                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1355             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1356                                            PIC X(6).
  1357         16  CF-STATE-CNTL-OPT.
  1358             20  CF-STATE-OPT-SEQ           PIC 9.
  1359                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1360                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1361             20  CF-STATE-SELECT OCCURS 3 TIMES
  1362                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  26
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1363         16  CF-ACCOUNT-CNTL-OPT.
  1364             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1365                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1366                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1367             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1368                                            PIC X(10).
  1369         16  CF-BUS-TYP-CNTL-OPT.
  1370             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1371                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1372                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1373             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1374                                            PIC XX.
  1375         16  CF-LF-TYP-CNTL-OPT.
  1376             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1377                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1378                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1379             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1380                                            PIC XX.
  1381         16  CF-AH-TYP-CNTL-OPT.
  1382             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1383                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1384                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1385             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1386                                            PIC XX.
  1387         16  CF-REPTCD1-CNTL-OPT.
  1388             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1389                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1390                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1391             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1392                                            PIC X(10).
  1393         16  CF-REPTCD2-CNTL-OPT.
  1394             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1395                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1396                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1397             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1398                                            PIC X(10).
  1399         16  CF-USER1-CNTL-OPT.
  1400             20  CF-USER1-OPT-SEQ           PIC 9.
  1401                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1402                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1403             20  CF-USER1-SELECT OCCURS 3 TIMES
  1404                                            PIC X(10).
  1405         16  CF-USER2-CNTL-OPT.
  1406             20  CF-USER2-OPT-SEQ           PIC 9.
  1407                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1408                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1409             20  CF-USER2-SELECT OCCURS 3 TIMES
  1410                                            PIC X(10).
  1411         16  CF-USER3-CNTL-OPT.
  1412             20  CF-USER3-OPT-SEQ           PIC 9.
  1413                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1414                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1415             20  CF-USER3-SELECT OCCURS 3 TIMES
  1416                                            PIC X(10).
  1417         16  CF-USER4-CNTL-OPT.
  1418             20  CF-USER4-OPT-SEQ           PIC 9.
  1419                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1420                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  27
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1421             20  CF-USER4-SELECT OCCURS 3 TIMES
  1422                                            PIC X(10).
  1423         16  CF-USER5-CNTL-OPT.
  1424             20  CF-USER5-OPT-SEQ           PIC 9.
  1425                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1426                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1427             20  CF-USER5-SELECT OCCURS 3 TIMES
  1428                                            PIC X(10).
  1429         16  CF-REINS-CNTL-OPT.
  1430             20  CF-REINS-OPT-SEQ           PIC 9.
  1431                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1432                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1433             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1434                 24  CF-REINS-PRIME         PIC XXX.
  1435                 24  CF-REINS-SUB           PIC XXX.
  1436
  1437         16  CF-AGENT-CNTL-OPT.
  1438             20  CF-AGENT-OPT-SEQ           PIC 9.
  1439                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1440                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1441             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1442                                            PIC X(10).
  1443
  1444         16  FILLER                         PIC X(43).
  1445
  1446         16  CF-LOSS-RATIO-SELECT.
  1447             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1448             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1449         16  CF-ENTRY-DATE-SELECT.
  1450             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1451             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1452         16  CF-EFFECTIVE-DATE-SELECT.
  1453             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1454             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1455
  1456         16  CF-EXCEPTION-LIST-IND          PIC X.
  1457             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1458
  1459         16  FILLER                         PIC X(318).
  1460
  1461****************************************************************
  1462*                  EXCEPTION REPORTING RECORD                  *
  1463****************************************************************
  1464
  1465     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1466         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1467             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1468
  1469         16  CF-COMBINED-LIFE-AH-OPT.
  1470             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1471             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1472             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1473             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1474
  1475         16  CF-LIFE-OPT.
  1476             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1477             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1478             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  28
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1479             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1480             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1481             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1482             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1483             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1484             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1485             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1486
  1487         16  CF-AH-OPT.
  1488             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1489             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1490             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1491             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1492             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1493             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1494             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1495             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1496             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1497             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1498
  1499         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1500             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1501             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1502             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1503
  1504         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1505
  1506         16  FILLER                         PIC X(673).
  1507
  1508
  1509****************************************************************
  1510*             MORTGAGE SYSTEM PLAN RECORD                      *
  1511****************************************************************
  1512
  1513     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1514         16  CF-PLAN-TYPE                   PIC X.
  1515             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1516             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1517             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1518         16  CF-PLAN-ABBREV                 PIC XXX.
  1519         16  CF-PLAN-DESCRIPT               PIC X(10).
  1520         16  CF-PLAN-NOTES                  PIC X(20).
  1521         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1522         16  CF-PLAN-UNDERWRITING.
  1523             20  CF-PLAN-TERM-DATA.
  1524                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1525                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1526             20  CF-PLAN-AGE-DATA.
  1527                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1528                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1529                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1530             20  CF-PLAN-BENEFIT-DATA.
  1531                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1532                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1533                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1534                                            PIC S9(7)V99  COMP-3.
  1535         16  CF-PLAN-POLICY-FORMS.
  1536             20  CF-POLICY-FORM             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  29
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1537             20  CF-MASTER-APPLICATION      PIC X(12).
  1538             20  CF-MASTER-POLICY           PIC X(12).
  1539         16  CF-PLAN-RATING.
  1540             20  CF-RATE-CODE               PIC X(5).
  1541             20  CF-SEX-RATING              PIC X.
  1542                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1543                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1544             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1545             20  CF-SUB-STD-TYPE            PIC X.
  1546                 88  CF-PCT-OF-PREM            VALUE '1'.
  1547                 88  CF-PCT-OF-BENE            VALUE '2'.
  1548         16  CF-PLAN-PREM-TOLERANCES.
  1549             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1550             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1551         16  CF-PLAN-PYMT-TOLERANCES.
  1552             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1553             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1554         16  CF-PLAN-MISC-DATA.
  1555             20  FILLER                     PIC X.
  1556             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1557             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1558         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1559         16  CF-PLAN-IND-GRP                PIC X.
  1560             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1561                                                     '1'.
  1562             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1563                                                     '2'.
  1564         16  CF-MIB-SEARCH-SW               PIC X.
  1565             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1566             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1567             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1568             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1569         16  CF-ALPHA-SEARCH-SW             PIC X.
  1570             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1571             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1572             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1573             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1574             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1575             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1576             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1577             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1578             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1579             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1580                                                     'A' 'B' 'C'
  1581                                                     'X' 'Y' 'Z'.
  1582         16  CF-EFF-DT-RULE-SW              PIC X.
  1583             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1584             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1585             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1586             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1587             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1588         16  FILLER                         PIC X(4).
  1589         16  CF-HEALTH-QUESTIONS            PIC X.
  1590             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1591         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1592         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1593         16  CF-PLAN-SNGL-JNT               PIC X.
  1594             88  CF-COMBINED-PLAN              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  30
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1595             88  CF-JNT-PLAN                   VALUE 'J'.
  1596             88  CF-SNGL-PLAN                  VALUE 'S'.
  1597         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1598         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1599         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1600         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1601         16  CF-RERATE-CNTL                 PIC  X.
  1602             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1603             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1604             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1605             88  CF-AUTO-RECALC                 VALUE '4'.
  1606         16  CF-BENEFIT-TYPE                PIC  X.
  1607             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1608             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1609         16  CF-POLICY-FEE                  PIC S999V99
  1610                                                    COMP-3.
  1611         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1612         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1613         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1614         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1615         16  FILLER                         PIC  X(32).
  1616         16  CF-TERMINATION-FORM            PIC  X(04).
  1617         16  FILLER                         PIC  X(08).
  1618         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1619                                                       COMP-3.
  1620         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1621         16  CF-ISSUE-LETTER                PIC  X(4).
  1622         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1623         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1624             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1625             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1626         16  CF-MP-REFUND-CALC              PIC X.
  1627             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1628             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1629             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1630             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1631             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1632             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1633             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1634             88  CF-MP-REFD-MEAN                VALUE '8'.
  1635         16  CF-ALT-RATE-CODE               PIC  X(5).
  1636
  1637
  1638         16  FILLER                         PIC X(498).
  1639****************************************************************
  1640*             MORTGAGE COMPANY MASTER RECORD                   *
  1641****************************************************************
  1642
  1643     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1644         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1645         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1646             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1647             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1648             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1649             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1650             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1651
  1652         16  CF-MORTG-CONVERSION-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  31
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1653         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1654         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1655         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1656         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1657
  1658         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1659             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1660         16  CF-MP-RECON-USE-IND            PIC X(1).
  1661             88  CF-MP-USE-RECON             VALUE 'Y'.
  1662         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1663             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1664         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1665             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1666             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1667         16  FILLER                         PIC X(1).
  1668         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1669             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1670         16  CF-MORTG-MIB-VERSION           PIC X.
  1671             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1672             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1673             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1674         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1675             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1676                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1677             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1678                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1679             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1680                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1681             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1682                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1683             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1684                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1685             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1686                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1687         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1688         16  FILLER                         PIC X(7).
  1689         16  CF-MORTG-DESTINATION-SYMBOL.
  1690             20  CF-MORTG-MIB-COMM          PIC X(5).
  1691             20  CF-MORTG-MIB-TERM          PIC X(5).
  1692         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1693             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1694         16  FILLER                         PIC X(03).
  1695         16  CF-MP-CHECK-NO-CONTROL.
  1696             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1697                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1698                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1699                                                ' ' LOW-VALUES.
  1700                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1701                                               VALUE '3'.
  1702         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1703         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1704         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1705             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1706                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1707             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1708                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1709             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1710                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  32
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1711             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1712                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1713             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1714                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1715             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1716                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1717         16  CF-MORTG-BILLING-AREA.
  1718             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1719                                            PIC X.
  1720         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1721         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1722         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1723         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1724             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1725             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1726         16  FILLER                         PIC X.
  1727         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1728             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1729             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1730         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1731         16  FILLER                         PIC X(8).
  1732         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1733         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1734         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1735         16  CF-ACH-COMPANY-ID.
  1736             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1737                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1738                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1739                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1740             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1741         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1742             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1743         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1744             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1745             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1746         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1747         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1748         16  FILLER                         PIC X(536).
  1749
  1750****************************************************************
  1751*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1752****************************************************************
  1753
  1754     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1755         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1756             20  CF-FEMALE-HEIGHT.
  1757                 24  CF-FEMALE-FT           PIC 99.
  1758                 24  CF-FEMALE-IN           PIC 99.
  1759             20  CF-FEMALE-MIN-WT           PIC 999.
  1760             20  CF-FEMALE-MAX-WT           PIC 999.
  1761         16  FILLER                         PIC X(428).
  1762
  1763     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1764         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1765             20  CF-MALE-HEIGHT.
  1766                 24  CF-MALE-FT             PIC 99.
  1767                 24  CF-MALE-IN             PIC 99.
  1768             20  CF-MALE-MIN-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  33
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1769             20  CF-MALE-MAX-WT             PIC 999.
  1770         16  FILLER                         PIC X(428).
  1771******************************************************************
  1772*             AUTOMATIC ACTIVITY RECORD                          *
  1773******************************************************************
  1774     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1775         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1776             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1777             20  CF-SYS-LETTER-ID           PIC X(04).
  1778             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1779             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1780             20  CF-SYS-RESET-SW            PIC X(01).
  1781             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1782             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1783
  1784         16  FILLER                         PIC X(50).
  1785
  1786         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1787             20  CF-USER-ACTIVE-SW          PIC X(01).
  1788             20  CF-USER-LETTER-ID          PIC X(04).
  1789             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1790             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1791             20  CF-USER-RESET-SW           PIC X(01).
  1792             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1793             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1794             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1795
  1796         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  34
* EL517.cbl
  1798 FD  ERPNDB.
* 1799                                  COPY ERCPNDB.
  1800******************************************************************
  1801*                                                                *
  1802*                                                                *
  1803*                            ERCPNDB.                            *
  1804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1805*                            VMOD=2.025                          *
  1806*                                                                *
  1807*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1808*                                                                *
  1809******************************************************************
  1810*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1811*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1812******************************************************************
  1813*                                                                *
  1814*                                                                *
  1815*   FILE TYPE = VSAM,KSDS                                        *
  1816*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1817*                                                                *
  1818*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1819*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1820*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1821*                                                 RKP=13,LEN=36  *
  1822*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1823*                                      AND CHG-SEQ.)             *
  1824*                                                RKP=49,LEN=11   *
  1825*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1826*                                      AND CHG-SEQ.)             *
  1827*                                                RKP=60,LEN=15   *
  1828*                                                                *
  1829*   LOG = NO                                                     *
  1830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1831******************************************************************
  1832******************************************************************
  1833*                   C H A N G E   L O G
  1834*
  1835* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1836*-----------------------------------------------------------------
  1837*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1838* EFFECTIVE    NUMBER
  1839*-----------------------------------------------------------------
  1840* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1841* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1842* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1843* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1844* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1845* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1846* 032306                   PEMA  ADD BOW LOAN NUMBER
  1847* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1848* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1849* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1850* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1851* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1852* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1853* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1854* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1855******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1856
  1857 01  PENDING-BUSINESS.
  1858     12  PB-RECORD-ID                     PIC XX.
  1859         88  VALID-PB-ID                        VALUE 'PB'.
  1860
  1861     12  PB-CONTROL-PRIMARY.
  1862         16  PB-COMPANY-CD                PIC X.
  1863         16  PB-ENTRY-BATCH               PIC X(6).
  1864         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1865         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1866
  1867     12  PB-CONTROL-BY-ACCOUNT.
  1868         16  PB-COMPANY-CD-A1             PIC X.
  1869         16  PB-CARRIER                   PIC X.
  1870         16  PB-GROUPING.
  1871             20  PB-GROUPING-PREFIX       PIC XXX.
  1872             20  PB-GROUPING-PRIME        PIC XXX.
  1873         16  PB-STATE                     PIC XX.
  1874         16  PB-ACCOUNT.
  1875             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1876             20  PB-ACCOUNT-PRIME         PIC X(6).
  1877         16  PB-CERT-EFF-DT               PIC XX.
  1878         16  PB-CERT-NO.
  1879             20  PB-CERT-PRIME            PIC X(10).
  1880             20  PB-CERT-SFX              PIC X.
  1881         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1882
  1883         16  PB-RECORD-TYPE               PIC X.
  1884             88  PB-MAILING-DATA                VALUE '0'.
  1885             88  PB-ISSUE                       VALUE '1'.
  1886             88  PB-CANCELLATION                VALUE '2'.
  1887             88  PB-BATCH-TRAILER               VALUE '9'.
  1888
  1889     12  PB-CONTROL-BY-ORIG-BATCH.
  1890         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1891         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1892         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1893         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1894
  1895     12  PB-CONTROL-BY-CSR.
  1896         16  PB-CSR-COMPANY-CD            PIC X.
  1897         16  PB-CSR-ID                    PIC X(4).
  1898         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1899         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1900         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1901******************************************************************
  1902*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1903******************************************************************
  1904
  1905     12  PB-LAST-MAINT-DT                 PIC XX.
  1906     12  PB-LAST-MAINT-BY                 PIC X(4).
  1907     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1908
  1909     12  PB-RECORD-BODY                   PIC X(375).
  1910
  1911     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1912         16  PB-CERT-ORIGIN               PIC X.
  1913             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1914         16  PB-I-NAME.
  1915             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1916             20  PB-I-INSURED-FIRST-NAME.
  1917                 24  PB-I-INSURED-1ST-INIT PIC X.
  1918                 24  FILLER                PIC X(9).
  1919             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1920         16  PB-I-AGE                     PIC S99   COMP-3.
  1921         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1922         16  PB-I-BIRTHDAY                PIC XX.
  1923         16  PB-I-INSURED-SEX             PIC X.
  1924             88  PB-SEX-MALE     VALUE 'M'.
  1925             88  PB-SEX-FEMALE   VALUE 'F'.
  1926
  1927         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1928         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1929         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1930         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1931         16  PB-I-SKIP-CODE               PIC X.
  1932             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1933             88  PB-SKIP-JULY              VALUE '1'.
  1934             88  PB-SKIP-AUGUST            VALUE '2'.
  1935             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1936             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1937             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1938             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1939             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1940             88  PB-SKIP-JUNE              VALUE '8'.
  1941             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1942             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1943             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1944         16  PB-I-TERM-TYPE               PIC X.
  1945             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1946             88  PB-PAID-WEEKLY            VALUE 'W'.
  1947             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1948             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1949             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1950         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1951         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1952         16  PB-I-DATA-ENTRY-SW           PIC X.
  1953             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1954             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1955             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1956             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1957         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1958         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1959*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1960         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1961         16  FILLER                       PIC X.
  1962
  1963         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1964             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1965             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1966                                                   '90' THRU '99'.
  1967         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1968                                          PIC XX.
  1969         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1970         16  PB-I-AMOUNT-FINANCED REDEFINES
  1971                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1972         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1973         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1974                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1975         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1976         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1977         16  PB-I-CLP-AMOUNT REDEFINES
  1978                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1979         16  PB-I-LF-CALC-FLAG            PIC X.
  1980             88 PB-COMP-LF-PREM               VALUE '?'.
  1981         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1982         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1983         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1984         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1985         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1986         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1987         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1988         16  PB-I-LF-ABBR                 PIC XXX.
  1989         16  PB-I-LF-INPUT-CD             PIC XX.
  1990
  1991         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1992             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1993             88  PB-INVALID-AH               VALUE '  ' '00'
  1994                                                   '90' THRU '99'.
  1995         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1996         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1997         16  PB-I-AH-CALC-FLAG            PIC X.
  1998             88 PB-COMP-AH-PREM                  VALUE '?'.
  1999         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2000         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2001         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2002         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2003         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2004         16  PB-I-AH-ABBR                 PIC XXX.
  2005         16  PB-I-AH-INPUT-CD             PIC XXX.
  2006
  2007         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2008         16  PB-I-REIN-TABLE              PIC XXX.
  2009         16  PB-I-BUSINESS-TYPE           PIC 99.
  2010         16  PB-I-INDV-GRP-CD             PIC X.
  2011         16  PB-I-MORT-CODE.
  2012             20  PB-I-TABLE               PIC X.
  2013             20  PB-I-INTEREST            PIC XX.
  2014             20  PB-I-MORT-TYP            PIC X.
  2015         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2016         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2017         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2018         16  PB-I-INDV-GRP-OVRD           PIC X.
  2019         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2020         16  PB-I-SIG-SW                  PIC X.
  2021             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2022         16  PB-I-RATE-CLASS              PIC XX.
  2023         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2024         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2025         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2026         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2027         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2028         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2029         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2030         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2031         16  PB-I-OB-FLAG                 PIC X.
  2032             88  PB-I-OB                      VALUE 'B'.
  2033             88  PB-I-SUMMARY                 VALUE 'Z'.
  2034         16  PB-I-ENTRY-STATUS            PIC X.
  2035             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2036                                              'M' '5' '9' '2'.
  2037             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2038             88  PB-I-POLICY-PENDING          VALUE '2'.
  2039             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2040             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2041             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2042             88  PB-I-REIN-ONLY               VALUE '9'.
  2043             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2044             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2045             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2046             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2047         16  PB-I-INT-CODE                PIC X.
  2048             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2049             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2050         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2051         16  PB-I-SOC-SEC-NO              PIC X(11).
  2052         16  PB-I-MEMBER-NO               PIC X(12).
  2053         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2054*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2055         16  PB-I-OLD-LOF                 PIC XXX.
  2056         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2057         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2058         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2059         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2060         16  PB-I-LIFE-INDICATOR          PIC X.
  2061             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2062         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2063         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2064                                          PIC S9(5)V99    COMP-3.
  2065         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2066             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2067             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2068         16  PB-I-1ST-PMT-DT              PIC XX.
  2069         16  PB-I-JOINT-INSURED.
  2070             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2071             20 PB-I-JOINT-FIRST-NAME.
  2072                24  PB-I-JOINT-FIRST-INIT PIC X.
  2073                24  FILLER                PIC X(9).
  2074             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2075*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2076         16  PB-I-BENEFICIARY-NAME.
  2077             20  PB-I-BANK-NUMBER         PIC X(10).
  2078             20  FILLER                   PIC X(15).
  2079         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2080         16  PB-I-REFERENCE               PIC X(12).
  2081         16  FILLER REDEFINES PB-I-REFERENCE.
  2082             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2083             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2084             20  PB-I-CLP-STATE           PIC XX.
  2085         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2086             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2087             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2088             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2089         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2090         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2091         16  PB-I-RESIDENT-STATE          PIC XX.
  2092         16  PB-I-RATE-CODE               PIC X(4).
  2093         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2094         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2095         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2096         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2097         16  PB-I-BANK-NOCHRGB            PIC 99.
  2098         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2099         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2100
  2101     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2102         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2103             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2104         16  PB-C-CANCEL-ORIGIN           PIC X.
  2105             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2106         16  PB-C-LF-CANCEL-DT            PIC XX.
  2107         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2108         16  PB-C-LF-CALC-REQ             PIC X.
  2109             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2110         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2111         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2112         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2113             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2114         16  PB-C-AH-CANCEL-DT            PIC XX.
  2115         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2116         16  PB-C-AH-CALC-REQ             PIC X.
  2117             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2118         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2119         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2120         16  PB-C-LAST-NAME               PIC X(15).
  2121         16  PB-C-REFUND-SW               PIC X.
  2122             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2123             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2124         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2125         16  PB-C-PAYEE-CODE              PIC X(6).
  2126         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2127         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2128         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2129         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2130         16  PB-C-REFERENCE               PIC X(12).
  2131         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2132         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2133         16  PB-C-POST-CARD-IND           PIC X.
  2134         16  PB-C-CANCEL-REASON           PIC X.
  2135         16  PB-C-REF-INTERFACE-SW        PIC X.
  2136         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2137         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2138         16  FILLER                       PIC X(01).
  2139*        16  FILLER                       PIC X(18).
  2140         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2141*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2142         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2143         16  PB-CANCELED-CERT-DATA.
  2144             20  PB-CI-INSURED-NAME.
  2145                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2146                 24  PB-CI-INITIALS       PIC XX.
  2147             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2148             20  PB-CI-INSURED-SEX        PIC X.
  2149             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2150             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2151             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2152             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2153             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2154             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2155             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2156             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2157             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2158             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2159             20  PB-CI-RATE-CLASS         PIC XX.
  2160             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2161             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2162             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2163             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2164             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2165             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2166             20  PB-CI-LF-ABBR            PIC X(3).
  2167             20  PB-CI-AH-ABBR            PIC X(3).
  2168             20  PB-CI-OB-FLAG            PIC X.
  2169                 88  PB-CI-OB                VALUE 'B'.
  2170             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2171                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2172                                           'M' '4' '5' '9' '2'.
  2173                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2174                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2175                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2176                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2177                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2178                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2179                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2180                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2181                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2182                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2183                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2184                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2185             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2186                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2187                                           'M' '4' '5' '9' '2'.
  2188                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2189                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2190                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2191                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2192                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2193                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2194                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2195                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2196                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2197                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2198                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2199                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2200             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2201             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2202             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2203             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2204             20  PB-CI-INT-CODE           PIC X.
  2205                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2206                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2207             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2208             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2209             20  PB-CI-COMP-EXCP-SW       PIC X.
  2210                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2211                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2212             20  PB-CI-ENTRY-STATUS       PIC X.
  2213             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2214             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2215             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2216             20  PB-CI-DEATH-DT           PIC XX.
  2217             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2218             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2219             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2220             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2221             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2222             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2223             20  PB-CI-ENTRY-DT              PIC XX.
  2224             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2225             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2226             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2227             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2228             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2229             20  PB-CI-OLD-LOF               PIC XXX.
  2230*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2231             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2232             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2233             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2234             20  PB-CI-INDV-GRP-CD           PIC X.
  2235             20  PB-CI-BENEFICIARY-NAME.
  2236                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2237                 24  FILLER                  PIC X(15).
  2238             20  PB-CI-NOTE-SW               PIC X.
  2239             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2240             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2241             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2242             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2243             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2244             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2245             20  PB-CI-FIRST-NAME            PIC X(10).
  2246             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2247
  2248         16  FILLER                       PIC X(13).
  2249*032306  16  FILLER                       PIC X(27).
  2250*        16  FILLER                       PIC X(46).
  2251
  2252     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2253         16  FILLER                       PIC X(10).
  2254         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2255         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2256         16  PB-M-INSURED-MID-INIT        PIC X.
  2257         16  PB-M-INSURED-AGE             PIC 99.
  2258         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2259         16  PB-M-INSURED-SEX             PIC X.
  2260         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2261         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2262         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2263         16  PB-M-INSURED-CITY-STATE.
  2264             20  PB-M-INSURED-CITY        PIC X(28).
  2265             20  PB-M-INSURED-STATE       PIC XX.
  2266         16  PB-M-INSURED-ZIP-CODE.
  2267             20  PB-M-INSURED-ZIP-PRIME.
  2268                 24  PB-M-INSURED-ZIP-1   PIC X.
  2269                     88  PB-M-CANADIAN-POST-CODE
  2270                                             VALUE 'A' THRU 'Z'.
  2271                 24  FILLER               PIC X(4).
  2272             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2273         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2274                                        PB-M-INSURED-ZIP-CODE.
  2275             20  PM-M-INS-CAN-POST1       PIC XXX.
  2276             20  PM-M-INS-CAN-POST2       PIC XXX.
  2277             20  FILLER                   PIC XXX.
  2278         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2279         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2280         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2281         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2282         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2283         16  PB-M-CRED-BENE-CITYST.
  2284             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2285             20  PB-M-CRED-BENE-STATE     PIC XX.
  2286
  2287         16  FILLER                       PIC X(92).
  2288
  2289     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2290         16  FILLER                       PIC X(10).
  2291         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2292         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2293         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2294         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2295         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2296         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2297         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2298         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2299         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2300         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2301         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2302         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2303         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2304         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2305         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2306         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2307         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2308         16  PB-ACCOUNT-NAME              PIC X(30).
  2309         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2310         16  PB-REFERENCE                 PIC X(12).
  2311         16  PB-B-RECEIVED-DT             PIC XX.
  2312         16  FILLER                       PIC X(234).
  2313
  2314     12  PB-RECORD-STATUS.
  2315         16  PB-CREDIT-SELECT-DT          PIC XX.
  2316         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2317         16  PB-BILLED-DT                 PIC XX.
  2318         16  PB-BILLING-STATUS            PIC X.
  2319             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2320             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2321             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2322         16  PB-RECORD-BILL               PIC X.
  2323             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2324             88  PB-RECORD-RETURNED           VALUE 'R'.
  2325             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2326             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2327             88  PB-OVERRIDE-AH               VALUE 'A'.
  2328             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2329         16  PB-BATCH-ENTRY               PIC X.
  2330             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2331             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2332             88  PB-REISSUED-CERT             VALUE 'E'.
  2333             88  PB-MONTHLY-CERT              VALUE 'M'.
  2334             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2335             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2336             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2337         16  PB-FORCE-CODE                PIC X.
  2338             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2339             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2340             88  PB-CANCEL-FORCE              VALUE '8'.
  2341             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2342             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2343             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2344             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2345             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2346             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2347             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2348         16  PB-FATAL-FLAG                PIC X.
  2349             88  PB-FATAL-ERRORS              VALUE 'X'.
  2350         16  PB-FORCE-ER-CD               PIC X.
  2351             88  PB-FORCE-ERRORS              VALUE 'F'.
  2352             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2353         16  PB-WARN-ER-CD                PIC X.
  2354             88  PB-WARNING-ERRORS            VALUE 'W'.
  2355         16  FILLER                       PIC X.
  2356         16  PB-OUT-BAL-CD                PIC X.
  2357             88  PB-OUT-OF-BAL                VALUE 'O'.
  2358         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2359         16  PB-AH-OVERRIDE-L1            PIC X.
  2360         16  PB-INPUT-DT                  PIC XX.
  2361         16  PB-INPUT-BY                  PIC X(4).
  2362         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2363         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2364         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2365         16  PB-LF-EARNING-METHOD         PIC X.
  2366         16  PB-AH-EARNING-METHOD         PIC X.
  2367         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2368         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2369         16  PB-REIN-CD                   PIC XXX.
  2370         16  PB-LF-REFUND-TYPE            PIC X.
  2371         16  PB-AH-REFUND-TYPE            PIC X.
  2372         16  PB-ACCT-EFF-DT               PIC XX.
  2373         16  PB-ACCT-EXP-DT               PIC XX.
  2374         16  PB-COMPANY-ID                PIC X(3).
  2375         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2376         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2377         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2378         16  PB-SV-GROUPING               PIC X(6).
  2379         16  PB-SV-STATE                  PIC XX.
  2380         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2381         16  PB-GA-BILLING-INFO.
  2382             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2383                                          PIC XX.
  2384         16  PB-SV-REMIT-TO  REDEFINES
  2385             PB-GA-BILLING-INFO           PIC X(10).
  2386         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2387         16  PB-I-LOAN-OFFICER            PIC X(5).
  2388         16  PB-I-VIN                     PIC X(17).
  2389
  2390         16  FILLER                       PIC X(04).
  2391         16  IMNET-BYPASS-SW              PIC X.
  2392
  2393******************************************************************
  2394*                COMMON EDIT ERRORS                              *
  2395******************************************************************
  2396
  2397     12  PB-COMMON-ERRORS.
  2398         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2399                                           PIC S9(4)     COMP.
  2400
  2401******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  45
* EL517.cbl
  2403 FD  ERREIN.
* 2404                                  COPY ERCREIN.
  2405******************************************************************07/27/93
  2406*                                                                *ERCREIN
  2407*                            ERCREIN                             *   LV009
  2408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2409*                            VMOD=2.010                          *   CL**9
  2410*                                                                *ERCREIN
  2411*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2412*                                                                *ERCREIN
  2413*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2414*                                                                *ERCREIN
  2415*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2416*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2417*                                                                *ERCREIN
  2418*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2419*       ALTERNATE PATH = NONE                                    *ERCREIN
  2420*                                                                *ERCREIN
  2421*   LOG = NO                                                     *ERCREIN
  2422*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2423*                                                                *ERCREIN
  2424******************************************************************ERCREIN
  2425*                   C H A N G E   L O G
  2426*
  2427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2428*-----------------------------------------------------------------
  2429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2430* EFFECTIVE    NUMBER
  2431*-----------------------------------------------------------------
  2432* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2433* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2434******************************************************************
  2435 01  REINSURANCE-RECORD.                                          ERCREIN
  2436     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2437         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2438                                                                  ERCREIN
  2439     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2440         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2441         16  RE-KEY.                                              ERCREIN
  2442             20  RE-CODE                   PIC X.                 ERCREIN
  2443                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2444                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2445             20  RE-TABLE                  PIC XXX.               ERCREIN
  2446             20  FILLER                    PIC XXX.               ERCREIN
  2447         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2448             20  FILLER                    PIC X.                 ERCREIN
  2449             20  RE-COMPANY.                                      ERCREIN
  2450                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2451                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2452                                                                  ERCREIN
  2453     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2454         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2455         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2456         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2457         16  FILLER                        PIC X(10).             ERCREIN
  2458                                                                  ERCREIN
  2459     12  RE-TABLE-DATA.                                           ERCREIN
  2460         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2461                                                                  ERCREIN
  2462         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2463             20  RE-REI-COMP-NO.                                  ERCREIN
  2464                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2465                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2466             20  RE-LF-QC                  PIC X.                 ERCREIN
  2467             20  RE-AH-QC                  PIC X.                 ERCREIN
  2468             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2469             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2470             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2471             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2472             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2473             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2474             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2475             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2476             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2477             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2478             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2479             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2480             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2481             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2482             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2483             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2484             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2485             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2486             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2487             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2488             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2489             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2490             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2491             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2492             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2493             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2494             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2495             20  RE-REMAINING              PIC X.                 ERCREIN
  2496             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2497             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2498             20  FILLER                    PIC X(19).                  000
  2499                                                                  ERCREIN
  2500         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2501         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2502         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2503         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2504             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2505                                                                  ERCREIN
  2506         16  FILLER                        PIC X(27).             ERCREIN
  2507                                                                  ERCREIN
  2508     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2509         16  RE-NAME                       PIC X(30).             ERCREIN
  2510         16  RE-LF-PE                      PIC X.                 ERCREIN
  2511         16  RE-AH-PE                      PIC X.                 ERCREIN
  2512         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2513         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2514         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2515         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2516         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2517         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2518         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2519         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2520         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2521         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2522         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2523         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2524         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2525         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2526         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2527         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2528         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2529         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2530                                                                  ERCREIN
  2531         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2532             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2533                                                                  ERCREIN
  2534         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2535             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2536                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2537                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2538                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2539                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2540             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2541                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2542                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2543                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2544                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2545                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2546                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2547                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2548                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2549             20  FILLER                    PIC XXX.               ERCREIN
  2550             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2551                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2552                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2553                                                                  ERCREIN
  2554         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2555             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2556                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2557                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2558                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2559                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2560             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2561                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2562                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2563                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2564                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2565                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2566                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2567                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2568                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2569             20  FILLER                    PIC XXX.               ERCREIN
  2570             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2571                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2572                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2573                                                                  ERCREIN
  2574         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2575                                                                  ERCREIN
  2576         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2577                                                                  ERCREIN
  2578         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2579         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2580         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2581         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2582         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2583         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2584         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2585         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2586         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2587             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2588             88  RE-CEDED                          VALUE 'C'.        CL**2
  2589             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2590             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2591                                                                  ERCREIN
  2592         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2593             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2594         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2595             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2596         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2597             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2598         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2599             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2600         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2601             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2602                                                                     CL**3
  2603         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2604                                                                     CL**5
  2605         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2606                                                                     CL**8
  2607         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2608                                                                     CL**8
  2609         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2610                                                                     CL**9
  2611         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2612             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2613             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2614
  2615         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2616             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2617                                                                     CL**9
  2618         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2619         16  FILLER                        PIC X(2281).              CL**9
  2620                                                                  ERCREIN
  2621         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2622                                                                  ERCREIN
  2623******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  49
* EL517.cbl
  2625 FD  ELCERT.
* 2626                                  COPY ELCCERT.
  2627******************************************************************04/15/98
  2628*                                                                *ELCCERT
  2629*                            ELCCERT.                            *   LV002
  2630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2631*                            VMOD=2.013                          *   CL**2
  2632*                                                                *ELCCERT
  2633*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2634*                                                                *ELCCERT
  2635*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2636*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2637*                                                                *ELCCERT
  2638*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2639*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2640*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2641*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2642*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2643*                                                                *ELCCERT
  2644*   LOG = YES                                                    *ELCCERT
  2645*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2646******************************************************************
  2647*                   C H A N G E   L O G
  2648*
  2649* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2650*-----------------------------------------------------------------
  2651*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2652* EFFECTIVE    NUMBER
  2653*-----------------------------------------------------------------
  2654* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2655* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2656* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2657* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2658* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2659* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2660* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2661* 032612  CR2011110200001  PEMA  AHL CHANGES
  2662******************************************************************
  2663                                                                  ELCCERT
  2664 01  CERTIFICATE-MASTER.                                          ELCCERT
  2665     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2666         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2667                                                                  ELCCERT
  2668     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2669         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2670         16  CM-CARRIER                    PIC X.                 ELCCERT
  2671         16  CM-GROUPING.                                         ELCCERT
  2672             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2673             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2674         16  CM-STATE                      PIC XX.                ELCCERT
  2675         16  CM-ACCOUNT.                                          ELCCERT
  2676             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2677             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2678         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2679         16  CM-CERT-NO.                                          ELCCERT
  2680             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2681             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2682                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2683     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2684         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2685         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2686         16  CM-INSURED-INITIALS.                                 ELCCERT
  2687             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2688             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2689                                                                  ELCCERT
  2690     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2691         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2692         16  CM-SOC-SEC-NO.                                       ELCCERT
  2693             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2694             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2695             20  CM-SSN-LN3.                                      ELCCERT
  2696                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2697                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2698                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2699                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2700                                                                  ELCCERT
  2701     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2702         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2703         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2704                                                                  ELCCERT
  2705     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2706         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2707         16  CM-MEMBER-NO.                                        ELCCERT
  2708             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2709             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2710             20  CM-MEMB-LN4.                                     ELCCERT
  2711                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2712                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2713                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2714                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2715                                                                  ELCCERT
  2716     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2717         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2718             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2719             20  FILLER                    PIC X(9).              ELCCERT
  2720         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2721         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2722             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2723             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2724         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2725         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2726             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2727             20  CM-JT-FIRST-NAME.                                ELCCERT
  2728                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2729                 24  FILLER                PIC X(9).              ELCCERT
  2730             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2731                                                                  ELCCERT
  2732     12  CM-LIFE-DATA.                                            ELCCERT
  2733         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2734         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2735         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2736         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2737         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2738         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2739         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2740         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2741         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2742         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2743         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2744         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2745         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2746         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2747         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2748         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2749         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2750         16  FILLER                        PIC XX.                ELCCERT
  2751                                                                  ELCCERT
  2752     12  CM-AH-DATA.                                              ELCCERT
  2753         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2754         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2755         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2756         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2757         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2758         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2759         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2760         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2761         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2762         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2763         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2764         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2765             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2766         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2767         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2768         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2769         16  FILLER                        PIC X.                 ELCCERT
  2770                                                                  ELCCERT
  2771     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2772         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2773         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2774                                           PIC S9(5)V99  COMP-3.
  2775         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2776         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2777         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2778         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2779         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2780         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2781         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2782         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2783         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2784         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2785             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2786             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2787         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2788             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2789             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2790             20  FILLER                    PIC XX.                ELCCERT
  2791         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2792             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2793             20  FILLER                    PIC XXX.               ELCCERT
  2794         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2795         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2796             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2797         16  CM-POST-CARD-IND              PIC X.
  2798         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2799         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2800             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2801             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2802             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2803         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2804             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2805             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2806         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2807             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2808             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2809             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2810             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2811             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2812             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2813             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2814             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2815             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2816             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2817             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2818             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2819         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2820             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2821             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2822             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2823             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2824             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2825         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2826         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2827         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2828*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2829         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2830         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2831         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2832         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2833         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2834                                                                  ELCCERT
  2835     12  CM-STATUS-DATA.                                          ELCCERT
  2836         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2837         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2838                                                                  ELCCERT
  2839         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2840         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2841         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2842                                                                  ELCCERT
  2843         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2844         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2845         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2846                                                                  ELCCERT
  2847         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2848             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2849                                                'M' '4' '5' '9'.  ELCCERT
  2850             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2851             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2852             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2853             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2854             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2855             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2856             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2857             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2858             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2859             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2860             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2861             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2862                                                                  ELCCERT
  2863         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2864         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2865         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2866                                                                  ELCCERT
  2867         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2868         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2869         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2870                                                                  ELCCERT
  2871         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2872             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2873                                                'M' '4' '5' '9'.  ELCCERT
  2874             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2875             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2876             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2877             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2878             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2879             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2880             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2881             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2882             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2883             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2884             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2885             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2886                                                                  ELCCERT
  2887         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2888             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2889             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2890             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2891         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2892                                                                  ELCCERT
  2893         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2894         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2895         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2896         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2897                                                                  ELCCERT
  2898     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2899         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2900         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2901         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2902         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2903         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2904         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2905         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2906         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2907     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2908         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2909         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2910     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2911         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2912         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2913                                                                  ELCCERT
  2914*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2915     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2916     12  FILLER                            PIC X.
  2917                                                                  ELCCERT
  2918*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2919     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2920     12  FILLER                            PIC X.
  2921*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2922     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2923                                                                  ELCCERT
  2924     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2925         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2926         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2927         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2928         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2929         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2930     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2931         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2932         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2933         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2934         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2935         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2936         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2937         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2938         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2939                                                                  ELCCERT
  2940     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2941         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2942         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2943                                                                  ELCCERT
  2944     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2945     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2946     12  CM-CLP-STATE                      PIC XX.
  2947     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2948     12  CM-USER-RESERVED                  PIC XXX.
  2949     12  FILLER REDEFINES CM-USER-RESERVED.
  2950         16  CM-AH-CLASS-CD                PIC XX.
  2951         16  F                             PIC X.
  2952******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  55
* EL517.cbl
  2954 FD  ELMSTR.
* 2955                                  COPY ELCMSTR.
  2956******************************************************************04/15/98
  2957*                                                                *ELCMSTR
  2958*                            ELCMSTR.                            *   LV002
  2959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2960*                            VMOD=2.012                          *   CL**2
  2961*                                                                *ELCMSTR
  2962*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2963*                                                                *ELCMSTR
  2964*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2965*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2966*                                                                *ELCMSTR
  2967*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2968*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2969*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2970*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2971*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2972*                                                 RKP=75,LEN=21  *ELCMSTR
  2973*                                                                *ELCMSTR
  2974*   **** NOTE ****                                               *ELCMSTR
  2975*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2976*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2977*                                                                *ELCMSTR
  2978*   LOG = YES                                                    *ELCMSTR
  2979*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2980******************************************************************
  2981*                   C H A N G E   L O G
  2982*
  2983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2984*-----------------------------------------------------------------
  2985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2986* EFFECTIVE    NUMBER
  2987*-----------------------------------------------------------------
  2988* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2989* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2990******************************************************************ELCMSTR
  2991 01  CLAIM-MASTER.                                                ELCMSTR
  2992     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  2993         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  2994                                                                  ELCMSTR
  2995     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  2996         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  2997         16  CL-CARRIER              PIC X.                       ELCMSTR
  2998         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  2999         16  CL-CERT-NO.                                          ELCMSTR
  3000             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3001             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3002                                                                  ELCMSTR
  3003     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3004         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3005         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3006         16  CL-INSURED-NAME.                                     ELCMSTR
  3007             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3008             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3009                                                                  ELCMSTR
  3010     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  3011         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3012         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3013             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3014             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3015             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3016                                                                  ELCMSTR
  3017     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3018         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3019         16  CL-CERT-NO-A4.                                       ELCMSTR
  3020             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3021             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3022                                                                  ELCMSTR
  3023     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3024         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3025         16  CL-CCN-A5.                                           ELCMSTR
  3026             20  CL-CCN.                                          ELCMSTR
  3027                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3028                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3029             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3030                                                                  ELCMSTR
  3031     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3032         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3033         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3034             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3035             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3036             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3037         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3038         16  FILLER                  PIC X(5).                    ELCMSTR
  3039                                                                  ELCMSTR
  3040     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3041         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3042         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3043             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3044             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3045         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3046*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3047*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3048*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3049*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3050*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3051         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3052             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3053             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3054             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3055         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3056         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3057         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3058         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3059         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3060         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3061         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3062         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3063         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3064         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3065         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3066             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3067             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3068             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  3069         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3070                                                                  ELCMSTR
  3071         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3072             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3073             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3074                                                                  ELCMSTR
  3075         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3076             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3077             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3078                                                                  ELCMSTR
  3079         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3080         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3081         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3082                                                                  ELCMSTR
  3083         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3084         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3085         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3086             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3087             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3088             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3089             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3090             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3091             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3092         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3093         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3094         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3095             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3096         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3097         16  FILLER                  PIC X.
  3098                                                                  ELCMSTR
  3099     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3100         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3101             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3102             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3103             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3104         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3105             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3106             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3107             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3108             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3109                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3110                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3111             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3112                                                                  ELCMSTR
  3113     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3114         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3115             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3116             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3117         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3118             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3119             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3120         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3121         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3122         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3123         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3124         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3125         16  FILLER                  PIC XX.                      ELCMSTR
  3126         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3127         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3128         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3129         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3130             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3131             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3132             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3133             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3134             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3135             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3136             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3137             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3138             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3139         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3140         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3141         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3142         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3143         16  CL-DENIAL-TYPE          PIC X.
  3144             88  CL-TYPE-DENIAL          VALUE '1'.
  3145             88  CL-TYPE-RESCISSION      VALUE '2'.
  3146             88  CL-TYPE-REFORMATION     VALUE '3'.
  3147             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3148             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3149         16  FILLER                  PIC X(5).                    ELCMSTR
  3150                                                                  ELCMSTR
  3151     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3152         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3153             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3154             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3155             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3156         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3157         16  FILLER                  PIC XX.                      ELCMSTR
  3158         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3159         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3160             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3161                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3162             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3163                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3164             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3165                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3166             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3167                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3168             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3169                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3170             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3171                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3172             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3173                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3174                                                                  ELCMSTR
  3175     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3176         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3177         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3178                                                                  ELCMSTR
  3179     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3180                                                                  ELCMSTR
  3181     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  3182         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3183             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3184         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3185             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3186                                                                  ELCMSTR
  3187     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3188                                                                  ELCMSTR
  3189     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3190         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3191         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3192         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3193         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3194                                                                  ELCMSTR
  3195     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3196         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3197         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3198         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3199         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3200                                                                  ELCMSTR
  3201     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3202     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3203     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3204                                                                  ELCMSTR
  3205     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3206     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3207     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3208     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3209                                                                  ELCMSTR
  3210*    12  FILLER                      PIC X(5).                    ELCMSTR
  3211     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3212     12  FILLER                      PIC X(4).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  60
* EL517.cbl
  3214 FD  ERCTBL.
* 3215                                 COPY ERCCTBL.
  3216******************************************************************04/29/98
  3217*                                                                *ERCCTBL
  3218*                                                                *ERCCTBL
  3219*                            ERCCTBL                             *   LV002
  3220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3221*                            VMOD=2.003                              CL**2
  3222*                                                                *ERCCTBL
  3223*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3224*                                                                *ERCCTBL
  3225*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3226*                                                                *ERCCTBL
  3227*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3228*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3229*                                                                *ERCCTBL
  3230*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3231*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3232*                                                                *ERCCTBL
  3233*   LOG = NO                                                     *ERCCTBL
  3234*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3235*                                                                *ERCCTBL
  3236*                                                                *ERCCTBL
  3237******************************************************************ERCCTBL
  3238                                                                  ERCCTBL
  3239 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3240     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3241         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3242                                                                  ERCCTBL
  3243     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3244         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3245         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3246         16  CT-CNTRL-2.                                          ERCCTBL
  3247             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3248             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3249                                                                  ERCCTBL
  3250     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3251         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3252         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3253         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3254         16  FILLER                        PIC X(31).             ERCCTBL
  3255                                                                  ERCCTBL
  3256     12  CT-LIMITS.                                               ERCCTBL
  3257         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3258                                                                  ERCCTBL
  3259         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3260                                                                  ERCCTBL
  3261         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3262                                                                  ERCCTBL
  3263     12  CT-RATES.                                                ERCCTBL
  3264         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3265             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3266             20  CT-RT-R   REDEFINES                              ERCCTBL
  3267                 CT-RT                     PIC XXX.               ERCCTBL
  3268                                                                  ERCCTBL
  3269     12  FILLER                            PIC  X(42).            ERCCTBL
  3270                                                                  ERCCTBL
  3271******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  61
* EL517.cbl
  3272
  3273 FD  ERACCT.
* 3274                                 COPY ERCACCT.
  3275******************************************************************04/19/98
  3276*                                                                *ERCACCT
  3277*                                                                *ERCACCT
  3278*                            ERCACCT                             *   LV031
  3279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3280*                            VMOD=2.031                          *ERCACCT
  3281*                                                                *ERCACCT
  3282*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3283*                                                                *ERCACCT
  3284*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3285*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3286*                                                                *ERCACCT
  3287*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3288*                                                                *ERCACCT
  3289*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3290*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3291*                                                                *ERCACCT
  3292*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3293*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3294*                                                                *ERCACCT
  3295*   LOG = NO                                                     *ERCACCT
  3296*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3297*                                                                *ERCACCT
  3298*                                                                *ERCACCT
  3299******************************************************************ERCACCT
  3300*                   C H A N G E   L O G
  3301*
  3302* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3303*-----------------------------------------------------------------
  3304*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3305* EFFECTIVE    NUMBER
  3306*-----------------------------------------------------------------
  3307* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3308* 092705    2005050300006  PEMA  ADD SPP LEASES
  3309* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3310* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3311* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3312* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3313* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3314******************************************************************
  3315                                                                  ERCACCT
  3316 01  ACCOUNT-MASTER.                                              ERCACCT
  3317     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3318         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3319                                                                  ERCACCT
  3320     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3321         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3322         16  AM-MSTR-CNTRL.                                       ERCACCT
  3323             20  AM-CONTROL-A.                                    ERCACCT
  3324                 24  AM-CARRIER            PIC X.                 ERCACCT
  3325                 24  AM-GROUPING.                                 ERCACCT
  3326                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3327                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3328                 24  AM-STATE              PIC XX.                ERCACCT
  3329                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3330                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3331                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3332             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3333                                           PIC X(19).             ERCACCT
  3334             20  AM-CNTRL-B.                                      ERCACCT
  3335                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3336                 24  FILLER                PIC X(4).              ERCACCT
  3337             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3338                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3339                                                                  ERCACCT
  3340     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3341         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3342         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3343         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3344         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3345         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3346         16  AM-VG-DATE.                                          ERCACCT
  3347             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3348             20  FILLER                    PIC X(4).              ERCACCT
  3349         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3350                                           PIC 9(11)      COMP-3. ERCACCT
  3351     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3352         16  FILLER                        PIC X(10).
  3353         16  AM-VG-KEY3.
  3354             20  AM-VG3-ACCOUNT            PIC X(10).
  3355             20  AM-VG3-EXP-DT             PIC XX.
  3356         16  FILLER                        PIC X(4).
  3357     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3358         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3359         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3360         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3361         16  FILLER                        PIC XX.                ERCACCT
  3362                                                                  ERCACCT
  3363     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3364     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3365                                                                  ERCACCT
  3366     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3367         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3368         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3369                                                                  ERCACCT
  3370     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3371     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3372                                                                  ERCACCT
  3373     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3374     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3375                                                                  ERCACCT
  3376     12  AM-NAME                           PIC X(30).             ERCACCT
  3377     12  AM-PERSON                         PIC X(30).             ERCACCT
  3378     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3379     12  AM-CITY.
  3380         16  AM-ADDR-CITY                  PIC X(28).
  3381         16  AM-ADDR-STATE                 PIC XX.
  3382     12  AM-ZIP.                                                  ERCACCT
  3383         16  AM-ZIP-PRIME.                                        ERCACCT
  3384             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3385                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3386             20  FILLER                    PIC X(4).              ERCACCT
  3387         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3388     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3389         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3390         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3391         16  FILLER                        PIC XXX.               ERCACCT
  3392     12  AM-TEL-NO.                                               ERCACCT
  3393         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3394         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3395         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3396     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3397         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3398         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3399                                                                  ERCACCT
  3400     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3401         16  AM-DEFN-1.                                           ERCACCT
  3402             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3403                 24  AM-AGT.                                      ERCACCT
  3404                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3405                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3406                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3407                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3408                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3409                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3410                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3411                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3412                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3413                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3414                 24  FILLER                PIC X(01).             ERCACCT
  3415         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3416             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3417                 24  FILLER                PIC X(11).             ERCACCT
  3418                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3419                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3420                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3421                 24  FILLER                PIC X(6).              ERCACCT
  3422                                                                  ERCACCT
  3423     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3424         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3425                                                                  ERCACCT
  3426     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3427                                                                  ERCACCT
  3428     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3429         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3430         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3431     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3432         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3433         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3434     12  AM-GPCD                           PIC 99.                ERCACCT
  3435     12  AM-IG                             PIC X.                 ERCACCT
  3436         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3437         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3438     12  AM-STATUS                         PIC X.                 ERCACCT
  3439         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3440         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3441         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3442         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3443         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3444         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3445     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3446     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3447                                                                  ERCACCT
  3448     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3449     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3450     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3451     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3452     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3453     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3454     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3455     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3456     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3457                                                                  ERCACCT
  3458     12  AM-USER-FIELDS.                                          ERCACCT
  3459         16  AM-FLD-1                      PIC XX.                ERCACCT
  3460         16  AM-FLD-2                      PIC XX.                ERCACCT
  3461         16  AM-FLD-3                      PIC XX.                ERCACCT
  3462         16  AM-FLD-4                      PIC XX.                ERCACCT
  3463         16  AM-FLD-5                      PIC XX.                ERCACCT
  3464                                                                  ERCACCT
  3465     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3466         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3467         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3468         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3469     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3470     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3471         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3472         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3473         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3474     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3475     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3476     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3477     12  AM-INACTIVE-DATE.                                        ERCACCT
  3478         16  AM-INA-MO                     PIC 99.                ERCACCT
  3479         16  AM-INA-DA                     PIC 99.                ERCACCT
  3480         16  AM-INA-YR                     PIC 99.                ERCACCT
  3481     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3482                                                                  ERCACCT
  3483     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3484     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3485                                                                  ERCACCT
  3486     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3487         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3488         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3489         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3490         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3491                                                                  ERCACCT
  3492     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3493         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3494         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3495                                                                  ERCACCT
  3496     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3497                                                                  ERCACCT
  3498     12  AM-OVER-SHORT.                                           ERCACCT
  3499         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3500         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3501                                                                  ERCACCT
  3502     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3503     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3504                                                                  ERCACCT
  3505     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3506     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3507                                                                  ERCACCT
  3508     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3509     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3510     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3511     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3512     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3513     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3514     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3515     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3516     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3517     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3518     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3519     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3520     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3521     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3522     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3523     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3524                                                                  ERCACCT
  3525     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3526                                                                  ERCACCT
  3527     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3528     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3529                                                                  ERCACCT
  3530     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3531     12  AM-EARN-METHODS.                                         ERCACCT
  3532         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3533             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3534             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3535             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3536             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3537         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3538             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3539             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3540             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3541             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3542         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3543             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3544             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3545             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3546             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3547             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3548             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3549                                                                  ERCACCT
  3550     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3551     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3552     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3553                                                                  ERCACCT
  3554     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3555     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3556     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3557     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3558     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3559     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3560         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3561         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3562     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3563         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3564         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3565         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3566     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3567         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3568         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3569     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3570         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3571         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3572         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3573     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3574     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3575                                                                  ERCACCT
  3576     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3577         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3578         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3579         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3580         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3581         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3582                                                                  ERCACCT
  3583     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3584                                                                  ERCACCT
  3585     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3586                                                                  ERCACCT
  3587     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3588         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3589                                                                  ERCACCT
  3590     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3591         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3592         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3593                                                                  ERCACCT
  3594     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3595         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3596                                                                  ERCACCT
  3597     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3598         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3599         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3600                                                                  ERCACCT
  3601     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3602                                                                  ERCACCT
  3603     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3604     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3605     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3606     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3607     12  AM-DCC-UEF-STATE                  PIC XX.
  3608     12  FILLER                            PIC XXX.
  3609     12  AM-REPORT-CODE-3                  PIC X(10).
  3610*    12  FILLER                            PIC X(22).             ERCACCT
  3611                                                                  ERCACCT
  3612     12  AM-RESERVE-DATE.                                         ERCACCT
  3613         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3614         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3615         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3616                                                                  ERCACCT
  3617     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3618     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3619         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3620         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3621         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3622         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3623                                                                  ERCACCT
  3624     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3625         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3626         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3627         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3628         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3629                                                                  ERCACCT
  3630     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3631         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3632             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3633             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3634             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3635             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3636             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3637             20  FILLER                    PIC XX.                ERCACCT
  3638         16  FILLER                        PIC X(80).             ERCACCT
  3639                                                                  ERCACCT
  3640     12  AM-TRANSFER-DATA.                                        ERCACCT
  3641         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3642             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3643             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3644                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3645                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3646             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3647             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3648                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3649                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3650             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3651         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3652             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3653             20  AM-TRNTO-GROUPING.                               ERCACCT
  3654                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3655                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3656             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3657             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3658                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3659                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3660             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3661         16  FILLER                        PIC X(10).             ERCACCT
  3662                                                                  ERCACCT
  3663     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3664                                                                  ERCACCT
  3665     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3666         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3667             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3668                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3669                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3670                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3671                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3672                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3673                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3674                 24  FILLER                PIC X.                 ERCACCT
  3675                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3676                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3677                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3678         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3679             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3680                 24  FILLER                PIC X(11).             ERCACCT
  3681                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3682                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3683                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3684                 24  FILLER                PIC X(6).              ERCACCT
  3685                                                                  ERCACCT
  3686     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3687         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3688            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3689            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3690            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3691                                                                  ERCACCT
  3692     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3693     12  FILLER                            PIC X(120).            ERCACCT
  3694                                                                  ERCACCT
  3695     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3696         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3697         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3698             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3699             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3700                                                          COMP-3. ERCACCT
  3701             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3702                                                          COMP-3. ERCACCT
  3703         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3704             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3705             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3706                                                          COMP-3. ERCACCT
  3707             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3708                                                          COMP-3. ERCACCT
  3709                                                                  ERCACCT
  3710     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3711         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3712         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3713         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3714         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3715             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3716                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3717                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3718             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3719                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3720                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3721             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3722                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3723                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3724         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3725             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3726                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3727                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3728                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3729             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3730                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3731                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3732             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3733                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3734                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3735                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3736     12  AM-COMMENTS.                                             ERCACCT
  3737         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3738                                                                  ERCACCT
  3739     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3740         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3741         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3742         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3743         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3744         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3745             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3746             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3747             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3748             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3749         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3750             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3751             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3752             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3753         16  FILLER                        PIC X(102).            ERCACCT
  3754                                                                  ERCACCT
  3755     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3756         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3757             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3758             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3759             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3760             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3761             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3762         16  FILLER                          PIC X(10).           ERCACCT
  3763******************************************************************ERCACCT
  3764
  3765 FD  ELCERR.
* 3766                                 COPY ELCERRS.
  3767******************************************************************04/15/98
  3768*                                                                *ELCERRS
  3769*                                                                *ELCERRS
  3770*                            ELCERRS.                            *   LV002
  3771*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3772*                            VMOD 2.002                          *   CL**2
  3773*                                                                *ELCERRS
  3774*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3775*                                                                *ELCERRS
  3776*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3777*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3778*                                                                *ELCERRS
  3779*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3780*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3781*                                                                *ELCERRS
  3782*   LOG = NO                                                     *ELCERRS
  3783*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3784******************************************************************ELCERRS
  3785 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3786     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3787         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3788                                                                  ELCERRS
  3789     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3790         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3791                                                                  ELCERRS
  3792     12  EM-ERROR-TEXT.                                           ELCERRS
  3793         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3794         16  FILLER                  PIC X(59).                   ELCERRS
  3795                                                                  ELCERRS
  3796     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3797         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3798         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3799         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3800         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3801                                                                  ELCERRS
  3802******************************************************************ELCERRS
  3803
  3804 FD  ERPNDM.
* 3805                                 COPY ERCPNDM.
  3806******************************************************************
  3807*                                                                *
  3808*                                                                *
  3809*                            ERCPNDM                             *
  3810*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3811*                            VMOD=2.003                          *
  3812*                                                                *
  3813*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3814*                                                                *
  3815*   FILE TYPE = VSAM,KSDS                                        *
  3816*   RECORD SIZE = 374   RECFORM = FIX                            *
  3817*                                                                *
  3818*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3819*   ALTERNATE PATH    = NOT USED                                 *
  3820*                                                                *
  3821*   LOG = YES                                                    *
  3822*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3823******************************************************************
  3824*                   C H A N G E   L O G
  3825*
  3826* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3827*-----------------------------------------------------------------
  3828*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3829* EFFECTIVE    NUMBER
  3830*-----------------------------------------------------------------
  3831* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3832* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3833* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3834******************************************************************
  3835
  3836 01  PENDING-MAILING-DATA.
  3837     12  PM-RECORD-ID                      PIC XX.
  3838         88  VALID-MA-ID                       VALUE 'PM'.
  3839
  3840     12  PM-CONTROL-PRIMARY.
  3841         16  PM-COMPANY-CD                 PIC X.
  3842         16  PM-ENTRY-BATCH                PIC X(6).
  3843         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3844         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3845
  3846     12  FILLER                            PIC X(14).
  3847
  3848     12  PM-ACCESS-CONTROL.
  3849         16  PM-SOURCE-SYSTEM              PIC XX.
  3850             88  PM-FROM-CREDIT                VALUE 'CR'.
  3851             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3852             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3853             88  PM-FROM-OTHER                 VALUE 'OT'.
  3854         16  PM-RECORD-ADD-DT              PIC XX.
  3855         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3856         16  PM-LAST-MAINT-DT              PIC XX.
  3857         16  PM-LAST-MAINT-BY              PIC XXXX.
  3858         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3859
  3860     12  PM-PROFILE-INFO.
  3861         16  PM-QUALIFY-CODE-1             PIC XX.
  3862         16  PM-QUALIFY-CODE-2             PIC XX.
  3863         16  PM-QUALIFY-CODE-3             PIC XX.
  3864         16  PM-QUALIFY-CODE-4             PIC XX.
  3865         16  PM-QUALIFY-CODE-5             PIC XX.
  3866
  3867         16  PM-INSURED-LAST-NAME          PIC X(15).
  3868         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3869         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3870         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3871         16  PM-INSURED-BIRTH-DT           PIC XX.
  3872         16  PM-INSURED-SEX                PIC X.
  3873             88  PM-SEX-MALE                   VALUE 'M'.
  3874             88  PM-SEX-FEMALE                 VALUE 'F'.
  3875         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3876
  3877         16  PM-ADDRESS-CORRECTED          PIC X.
  3878         16  PM-JOINT-BIRTH-DT             PIC XX.
  3879*        16  FILLER                        PIC X(12).
  3880
  3881         16  PM-ADDRESS-LINE-1             PIC X(30).
  3882         16  PM-ADDRESS-LINE-2             PIC X(30).
  3883         16  PM-CITY-STATE.
  3884             20  PM-CITY                   PIC X(28).
  3885             20  PM-STATE                  PIC XX.
  3886         16  PM-ZIP.
  3887             20  PM-ZIP-CODE.
  3888                 24  PM-ZIP-1              PIC X.
  3889                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3890                 24  FILLER                PIC X(4).
  3891             20  PM-ZIP-PLUS4              PIC X(4).
  3892         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3893             20  PM-CAN-POST1              PIC XXX.
  3894             20  PM-CAN-POST2              PIC XXX.
  3895             20  FILLER                    PIC XXX.
  3896
  3897         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3898
  3899         16  FILLER                        PIC X(03).
  3900
  3901     12  PM-CRED-BENE-INFO.
  3902         16  PM-CRED-BENE-NAME             PIC X(25).
  3903         16  PM-CRED-BENE-ADDR             PIC X(30).
  3904         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3905         16  PM-CRED-BENE-CTYST.
  3906             20  PM-CRED-BENE-CITY         PIC X(28).
  3907             20  PM-CRED-BENE-STATE        PIC XX.
  3908         16  PM-CRED-BENE-ZIP.
  3909             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3910                 24  PM-CB-ZIP-1           PIC X.
  3911                     88  PM-CB-CANADIAN-POST-CODE
  3912                                  VALUE 'A' THRU 'Z'.
  3913                 24  FILLER                PIC X(4).
  3914             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3915         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3916             20  PM-CB-CAN-POST1           PIC XXX.
  3917             20  PM-CB-CAN-POST2           PIC XXX.
  3918             20  FILLER                    PIC XXX.
  3919     12  PM-POST-CARD-MAIL-DATA.
  3920         16  PM-MAIL-DATA OCCURS 7.
  3921             20  PM-MAIL-TYPE              PIC X.
  3922                 88  PM-12MO-MAILING           VALUE '1'.
  3923                 88  PM-EXP-MAILING            VALUE '2'.
  3924             20  PM-MAIL-STATUS            PIC X.
  3925                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3926                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3927                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3928             20  PM-MAIL-DATE              PIC XX.
  3929     12  FILLER                            PIC XX.
  3930     12  FILLER                            PIC X(12).
  3931*    12  FILLER                            PIC X(30).
  3932
  3933******************************************************************
  3934
  3935 FD  ERMAIL.
* 3936                                 COPY ERCMAIL.
  3937******************************************************************
  3938*                                                                *
  3939*                                                                *
  3940*                            ERCMAIL                             *
  3941*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3942*                            VMOD=2.003                          *
  3943*                                                                *
  3944*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3945*                                                                *
  3946*   FILE TYPE = VSAM,KSDS                                        *
  3947*   RECORD SIZE = 374   RECFORM = FIX                            *
  3948*                                                                *
  3949*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3950*   ALTERNATE PATH    = NOT USED                                 *
  3951*                                                                *
  3952*   LOG = YES                                                    *
  3953*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3954******************************************************************
  3955*                   C H A N G E   L O G
  3956*
  3957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3958*-----------------------------------------------------------------
  3959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3960* EFFECTIVE    NUMBER
  3961*-----------------------------------------------------------------
  3962* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3963* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3964* 111108                   PEMA  ADD CRED BENE ADDR2
  3965******************************************************************
  3966
  3967 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3968     12  MA-RECORD-ID                      PIC XX.
  3969         88  VALID-MA-ID                       VALUE 'MA'.
  3970
  3971     12  MA-CONTROL-PRIMARY.
  3972         16  MA-COMPANY-CD                 PIC X.
  3973         16  MA-CARRIER                    PIC X.
  3974         16  MA-GROUPING.
  3975             20  MA-GROUPING-PREFIX        PIC XXX.
  3976             20  MA-GROUPING-PRIME         PIC XXX.
  3977         16  MA-STATE                      PIC XX.
  3978         16  MA-ACCOUNT.
  3979             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3980             20  MA-ACCOUNT-PRIME          PIC X(6).
  3981         16  MA-CERT-EFF-DT                PIC XX.
  3982         16  MA-CERT-NO.
  3983             20  MA-CERT-PRIME             PIC X(10).
  3984             20  MA-CERT-SFX               PIC X.
  3985
  3986     12  FILLER                            PIC XX.
  3987
  3988     12  MA-ACCESS-CONTROL.
  3989         16  MA-SOURCE-SYSTEM              PIC XX.
  3990             88  MA-FROM-CREDIT                VALUE 'CR'.
  3991             88  MA-FROM-VSI                   VALUE 'VS'.
  3992             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3993             88  MA-FROM-OTHER                 VALUE 'OT'.
  3994         16  MA-RECORD-ADD-DT              PIC XX.
  3995         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3996         16  MA-LAST-MAINT-DT              PIC XX.
  3997         16  MA-LAST-MAINT-BY              PIC XXXX.
  3998         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3999
  4000     12  MA-PROFILE-INFO.
  4001         16  MA-QUALIFY-CODE-1             PIC XX.
  4002         16  MA-QUALIFY-CODE-2             PIC XX.
  4003         16  MA-QUALIFY-CODE-3             PIC XX.
  4004         16  MA-QUALIFY-CODE-4             PIC XX.
  4005         16  MA-QUALIFY-CODE-5             PIC XX.
  4006
  4007         16  MA-INSURED-LAST-NAME          PIC X(15).
  4008         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4009         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4010         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4011         16  MA-INSURED-BIRTH-DT           PIC XX.
  4012         16  MA-INSURED-SEX                PIC X.
  4013             88  MA-SEX-MALE                   VALUE 'M'.
  4014             88  MA-SEX-FEMALE                 VALUE 'F'.
  4015         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4016
  4017         16  MA-ADDRESS-CORRECTED          PIC X.
  4018         16  MA-JOINT-BIRTH-DT             PIC XX.
  4019*        16  FILLER                        PIC X(12).
  4020
  4021         16  MA-ADDRESS-LINE-1             PIC X(30).
  4022         16  MA-ADDRESS-LINE-2             PIC X(30).
  4023         16  MA-CITY-STATE.
  4024             20  MA-CITY                   PIC X(28).
  4025             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4026         16  MA-ZIP.
  4027             20  MA-ZIP-CODE.
  4028                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4029                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4030                 24  FILLER                PIC X(4).
  4031             20  MA-ZIP-PLUS4              PIC X(4).
  4032         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4033             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4034             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4035             20  FILLER                    PIC X(3).
  4036
  4037         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4038
  4039         16  FILLER                        PIC XXX.
  4040*        16  FILLER                        PIC X(10).
  4041
  4042
  4043     12  MA-CRED-BENE-INFO.
  4044         16  MA-CRED-BENE-NAME                 PIC X(25).
  4045         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4046         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4047         16  MA-CRED-BENE-CTYST.
  4048             20  MA-CRED-BENE-CITY             PIC X(28).
  4049             20  MA-CRED-BENE-STATE            PIC XX.
  4050         16  MA-CRED-BENE-ZIP.
  4051             20  MA-CB-ZIP-CODE.
  4052                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4053                     88  MA-CB-CANADIAN-POST-CODE
  4054                                           VALUE 'A' THRU 'Z'.
  4055                 24  FILLER                    PIC X(4).
  4056             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4057         16  MA-CB-CANADIAN-POSTAL-CODE
  4058                            REDEFINES MA-CRED-BENE-ZIP.
  4059             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4060             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4061             20  FILLER                        PIC X(3).
  4062     12  MA-POST-CARD-MAIL-DATA.
  4063         16  MA-MAIL-DATA OCCURS 7.
  4064             20  MA-MAIL-TYPE              PIC X.
  4065                 88  MA-12MO-MAILING           VALUE '1'.
  4066                 88  MA-EXP-MAILING            VALUE '2'.
  4067             20  MA-MAIL-STATUS            PIC X.
  4068                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4069                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4070                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4071             20  MA-MAIL-DATE              PIC XX.
  4072     12  FILLER                            PIC XX.
  4073     12  FILLER                            PIC XX.
  4074*    12  FILLER                            PIC X(30).
  4075******************************************************************
  4076
  4077 FD  ERPLAN.
* 4078                                 COPY ERCPLAN.
  4079******************************************************************04/29/98
  4080*                                                                *ERCPLAN
  4081*                                                                *ERCPLAN
  4082*                            ERCPLAN                             *   LV003
  4083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4084*                            VMOD=2.003                          *   CL**2
  4085*                                                                *ERCPLAN
  4086*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4087*                                                                *ERCPLAN
  4088*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4089*   PLAN MASTER                                                  *ERCPLAN
  4090*                                                                *ERCPLAN
  4091*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4092*                                                                *ERCPLAN
  4093*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4094*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4095*                                                                *ERCPLAN
  4096*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4097*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4098*                                                                *ERCPLAN
  4099*   LOG = NO                                                     *ERCPLAN
  4100*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4101*                                                                *ERCPLAN
  4102*                                                                *ERCPLAN
  4103******************************************************************ERCPLAN
  4104                                                                  ERCPLAN
  4105 01  PLAN-MASTER.                                                 ERCPLAN
  4106     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4107         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4108                                                                  ERCPLAN
  4109     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4110         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4111         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4112             20  PL-CONTROL-A.                                    ERCPLAN
  4113                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4114                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4115                 24  PL-STATE              PIC XX.                ERCPLAN
  4116                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4117             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4118             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4119             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4120                                                                  ERCPLAN
  4121     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4122         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4123         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4124         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4125         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4126         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4127         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4128         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4129         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4130                                                                  ERCPLAN
  4131     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4132         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4133         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4134         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4135         16  FILLER                        PIC XX.                ERCPLAN
  4136                                                                  ERCPLAN
  4137     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4138         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4139         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4140             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4141             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4142             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4143             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4144                                                                  ERCPLAN
  4145     12  FILLER                            PIC X(30).             ERCPLAN
  4146                                                                  ERCPLAN
  4147     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4148         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4149         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4150         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4151     12  FILLER                            PIC X(24).             ERCPLAN
  4152     12  PL-TOLERANCES.                                           ERCPLAN
  4153         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4154         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4155         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4156         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4157         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4158         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4159     12  PL-OVER-SHORT.                                           ERCPLAN
  4160         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4161         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4162     12  FILLER                            PIC X(24).             ERCPLAN
  4163     12  PLAN-MISC.                                               ERCPLAN
  4164         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4165         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4166         16  PL-IG                         PIC X.                 ERCPLAN
  4167         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4168         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4169         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4170         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4171         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4172         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4173         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4174         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4175                                                                  ERCPLAN
  4176         16  FILLER                        PIC X(99).             ERCPLAN
  4177******************************************************************ERCPLAN
  4178 FD  ERFORM.
* 4179                                 COPY ERCFORM.
  4180******************************************************************04/29/98
  4181*                                                                *ERCFORM
  4182*                                                                *ERCFORM
  4183*                            ERCFORM.                            *   LV002
  4184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4185*                            VMOD=2.003                          *   CL**2
  4186*                                                                *ERCFORM
  4187*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4188*                                                                *ERCFORM
  4189*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4190*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4191*                                                                *ERCFORM
  4192*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4193*                                                                *ERCFORM
  4194*    LOG = YES                                                   *ERCFORM
  4195*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4196******************************************************************ERCFORM
  4197 01  FORM-MASTER.                                                 ERCFORM
  4198    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4199        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4200                                                                  ERCFORM
  4201    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4202        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4203        16  FO-STATE                 PIC X(02).                   ERCFORM
  4204        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4205        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4206                                                                  ERCFORM
  4207    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4208        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4209        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4210        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4211        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4212        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4213        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4214        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4215        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4216        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4217        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4218        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4219        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4220        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4221        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4222        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4223        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4224                                                                  ERCFORM
  4225    12  FILLER                       PIC X(29).                   ERCFORM
  4226                                                                  ERCFORM
  4227    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4228        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4229            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4230            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4231            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4232            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4233                                     PIC X.                       ERCFORM
  4234                                                                  ERCFORM
  4235    12  FILLER                       PIC X(30).                   ERCFORM
  4236                                                                  ERCFORM
  4237    12  FO-COMMENTS-AREA.                                         ERCFORM
  4238        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4239                                                                  ERCFORM
  4240    12  FILLER                       PIC X(20).                   ERCFORM
  4241                                                                  ERCFORM
  4242    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4243        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4244        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4245        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4246
  4247 FD  PRINT-FILE
* 4248                                 COPY ELCPRTFD.
  4249******************************************************************04/15/98
  4250*                                                                *ELCPRTFD
  4251*                                                                *ELCPRTFD
  4252*                            ELCPRTFD.                           *   LV003
  4253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4254*                            VMOD=2.006                          *ELCPRTFD
  4255******************************************************************ELCPRTFD
  4256     RECORDING MODE F                                             ELCPRTFD
  4257     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4258     BLOCK CONTAINS 0 RECORDS
  4259     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4260 01  PRT.                                                         ELCPRTFD
  4261     12  P-CTL               PIC  X.                                 CL**2
  4262     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4263******************************************************************ELCPRTFD
  4264 FD  FICH
* 4265                                 COPY ELCFCHFD.
  4266******************************************************************04/15/98
  4267*                                                                *ELCFCHFD
  4268*                            ELCFCHFD.                           *   LV003
  4269*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4270*                            VMOD=2.004                          *   CL**3
  4271*                                                                *ELCFCHFD
  4272******************************************************************ELCFCHFD
  4273     BLOCK CONTAINS 0 RECORDS
  4274     RECORDING MODE F.                                            ELCFCHFD
  4275                                                                  ELCFCHFD
  4276 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4277******************************************************************ELCFCHFD
  4278
  4279 FD  ELREPT.
* 4280                                 COPY ELCREPT.
  4281******************************************************************04/15/98
  4282*                                                                *ELCREPT
  4283*                                                                *ELCREPT
  4284*                            ELCREPT.                            *   LV002
  4285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4286*                            VMOD=2.002                          *   CL**2
  4287*                                                                *ELCREPT
  4288*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4289*                                                                *ELCREPT
  4290*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4291*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4292*                                                                *ELCREPT
  4293*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4294*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4295*                                                                *ELCREPT
  4296*   LOG = NO                                                     *ELCREPT
  4297*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4298******************************************************************ELCREPT
  4299 01  REPORT-SAVE-FILE.                                            ELCREPT
  4300     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4301         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4302                                                                  ELCREPT
  4303     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4304         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4305         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4306             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4307             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4308         16  RF-REPORT-ID.                                        ELCREPT
  4309             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4310                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4311                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4312             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4313         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4314     12  RF-REPORT-LINE-133.                                      ELCREPT
  4315         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4316         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4317         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4318             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4319             20  FILLER              PIC X(52).                   ELCREPT
  4320         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4321             20  FILLER              PIC X(53).                   ELCREPT
  4322             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4323     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4324         16  FILLER                  PIC X.                       ELCREPT
  4325         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4326         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4327         16  FILLER                  PIC X(115).                  ELCREPT
  4328         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4329******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  80
* EL517.cbl
  4331
  4332 FD  ERRESS.
* 4333                                 COPY ERCRESS.
  4334******************************************************************04/29/98
  4335*                                                                *ERCRESS
  4336*                            ERCRESS                             *   LV002
  4337*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4338*                            VMOD=2.002                          *   CL**2
  4339*                                                                *ERCRESS
  4340*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4341*                                                                *ERCRESS
  4342*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4343*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4344*                                                                *ERCRESS
  4345*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4346*                                                                *ERCRESS
  4347*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4348*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4349*                                                                *ERCRESS
  4350*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4351*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4352*                                                                *ERCRESS
  4353*   LOG = NO                                                     *ERCRESS
  4354*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4355*                                                                *ERCRESS
  4356*                                                                *ERCRESS
  4357******************************************************************ERCRESS
  4358                                                                  ERCRESS
  4359 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4360                                                                  ERCRESS
  4361     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4362         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4363         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4364         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4365         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4366*                                      YYYYMMDD                   ERCRESS
  4367*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4368                                                                  ERCRESS
  4369     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4370                                                                  ERCRESS
  4371         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4372         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4373         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4374         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4375                                                                  ERCRESS
  4376     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4377         88 RECALC                VALUE 'Y'.                      ERCRESS
  4378         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4379     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4380     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4381     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4382*                                      YYYYMMDD                   ERCRESS
  4383
  4384 FD  ERRESC.
* 4385                                 COPY ERCRESC.
  4386******************************************************************04/29/98
  4387*                                                                *ERCRESC
  4388*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4390*                            VMOD=2.003                          *   CL**2
  4391*                                                                *ERCRESC
  4392*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4393*                                                                *ERCRESC
  4394*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4395*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4396*                                                                *ERCRESC
  4397*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4398*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4399*                                                                *ERCRESC
  4400*   LOG = NO                                                     *ERCRESC
  4401*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4402*                                                                *ERCRESC
  4403******************************************************************ERCRESC
  4404                                                                  ERCRESC
  4405 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4406                                                                  ERCRESC
  4407     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4408         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4409         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4410         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4411         15  RESC-STATE                PIC   XX.                  ERCRESC
  4412         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4413         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4414         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4415         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4416*                                           YYYYMMDD              ERCRESC
  4417     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4418                                                                  ERCRESC
  4419     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4420         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4421             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4422             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4423             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4424                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4425                                                                  ERCRESC
  4426     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4427     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4428     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4429*                                          YYYYMMDD               ERCRESC
  4430
  4431 FD  ERCOMP.
* 4432                                 COPY ERCCOMP.
  4433******************************************************************
  4434*                                                                *
  4435*                                                                *
  4436*                            ERCCOMP                             *
  4437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4438*                            VMOD=2.019                          *
  4439*                                                                *
  4440*   ONLINE CREDIT SYSTEM                                         *
  4441*                                                                *
  4442*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4443*                                                                *
  4444*   FILE TYPE = VSAM,KSDS                                        *
  4445*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4446*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4447*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4448*       ALTERNATE PATH = NONE                                    *
  4449*                                                                *
  4450*   LOG = NO                                                     *
  4451*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4452*                                                                *
  4453******************************************************************
  4454*                   C H A N G E   L O G
  4455*
  4456* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4457*-----------------------------------------------------------------
  4458*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4459* EFFECTIVE    NUMBER
  4460*-----------------------------------------------------------------
  4461* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4462* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4463* 092205    2005050300006  PEMA  ADD LEASE FEE
  4464* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4465* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4466* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4467* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4468* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4469* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4470******************************************************************
  4471
  4472 01  COMPENSATION-MASTER.
  4473     12  CO-RECORD-ID                          PIC XX.
  4474         88  VALID-CO-ID                          VALUE 'CO'.
  4475
  4476     12  CO-CONTROL-PRIMARY.
  4477         16  CO-COMPANY-CD                     PIC X.
  4478         16  CO-CONTROL.
  4479             20  CO-CTL-1.
  4480                 24  CO-CARR-GROUP.
  4481                     28  CO-CARRIER            PIC X.
  4482                     28  CO-GROUPING.
  4483                         32  CO-GROUP-PREFIX   PIC XXX.
  4484                         32  CO-GROUP-PRIME    PIC XXX.
  4485                 24  CO-RESP-NO.
  4486                     28  CO-RESP-PREFIX        PIC X(4).
  4487                     28  CO-RESP-PRIME         PIC X(6).
  4488             20  CO-CTL-2.
  4489                 24  CO-ACCOUNT.
  4490                     28  CO-ACCT-PREFIX        PIC X(4).
  4491                     28  CO-ACCT-PRIME         PIC X(6).
  4492         16  CO-TYPE                           PIC X.
  4493             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4494             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4495             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4496
  4497     12  CO-MAINT-INFORMATION.
  4498         16  CO-LAST-MAINT-DT                  PIC XX.
  4499         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4500         16  CO-LAST-MAINT-USER                PIC X(4).
  4501     12  FILLER                                PIC XX.
  4502     12  CO-STMT-TYPE                          PIC XXX.
  4503     12  CO-COMP-TYPE                          PIC X.
  4504         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4505     12  CO-STMT-OWNER                         PIC X(4).
  4506     12  CO-BALANCE-CONTROL                    PIC X.
  4507         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4508         88  CO-NO-BALANCE                        VALUE 'N'.
  4509
  4510     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4511         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4512         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4513         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4514
  4515     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4516         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4517         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4518
  4519     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4520     12  CO-GA-DIRECT-DEP                      PIC X.
  4521     12  CO-FUTURE-SPACE                       PIC X.
  4522         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4523
  4524     12  CO-ACCT-NAME                          PIC X(30).
  4525     12  CO-MAIL-NAME                          PIC X(30).
  4526     12  CO-ADDR-1                             PIC X(30).
  4527     12  CO-ADDR-2                             PIC X(30).
  4528     12  CO-ADDR-3.
  4529         16  CO-ADDR-CITY                      PIC X(27).
  4530         16  CO-ADDR-STATE                     PIC XX.
  4531     12  CO-CSO-1099                           PIC X.
  4532     12  CO-ZIP.
  4533         16  CO-ZIP-PRIME.
  4534             20  CO-ZIP-PRI-1ST                PIC X.
  4535                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4536             20  FILLER                        PIC X(4).
  4537         16  CO-ZIP-PLUS4                      PIC X(4).
  4538     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4539         16  CO-CAN-POSTAL-1                   PIC XXX.
  4540         16  CO-CAN-POSTAL-2                   PIC XXX.
  4541         16  FILLER                            PIC XXX.
  4542     12  CO-SOC-SEC                            PIC X(13).
  4543     12  CO-TELEPHONE.
  4544         16  CO-AREA-CODE                      PIC XXX.
  4545         16  CO-PREFIX                         PIC XXX.
  4546         16  CO-PHONE                          PIC X(4).
  4547
  4548     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4549
  4550     12  CO-AR-BAL-LEVEL                       PIC X.
  4551         88  CO-AR-REF-LVL                        VALUE '1'.
  4552         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4553         88  CO-AR-BILL-LVL                       VALUE '2'.
  4554         88  CO-AR-AGT-LVL                        VALUE '3'.
  4555         88  CO-AR-FR-LVL                         VALUE '4'.
  4556
  4557     12  CO-AR-NORMAL-PRINT                    PIC X.
  4558         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4559         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4560
  4561     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4562
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4563     12  CO-AR-REPORTING                       PIC X.
  4564         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4565         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4566
  4567     12  CO-AR-PULL-CHECK                      PIC X.
  4568         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4569         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4570
  4571     12  CO-AR-BALANCE-PRINT                   PIC X.
  4572         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4573
  4574     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4575         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4576         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4577         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4578
  4579     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4580
  4581     12  CO-USER-CODE                          PIC X.
  4582     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4583
  4584******************************************************************
  4585*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4586*    THE LAST MONTH END RUN.
  4587******************************************************************
  4588
  4589     12  CO-LAST-ACTIVITY-DATE.
  4590         16  CO-ACT-YEAR                       PIC 99.
  4591         16  CO-ACT-MONTH                      PIC 99.
  4592         16  CO-ACT-DAY                        PIC 99.
  4593
  4594     12  CO-LAST-STMT-DT.
  4595         16  CO-LAST-STMT-YEAR                 PIC 99.
  4596         16  CO-LAST-STMT-MONTH                PIC 99.
  4597         16  CO-LAST-STMT-DAY                  PIC 99.
  4598
  4599     12  CO-MO-END-TOTALS.
  4600         16  CO-MONTHLY-TOTALS.
  4601             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4602             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4603             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4604             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4605             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4606
  4607         16  CO-AGING-TOTALS.
  4608             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4609             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4610             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4611             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4612
  4613         16  CO-YTD-TOTALS.
  4614             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4615             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4616
  4617         16  CO-OVER-UNDER-TOTALS.
  4618             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4619             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4620
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4621     12  CO-MISCELLANEOUS-TOTALS.
  4622         16  CO-FICA-TOTALS.
  4623             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4624             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4625
  4626         16  CO-CLAIM-TOTALS.
  4627             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4628             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4629
  4630******************************************************************
  4631*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4632*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4633******************************************************************
  4634
  4635     12  CO-CURRENT-TOTALS.
  4636         16  CO-CURRENT-LAST-STMT-DT.
  4637             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4638             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4639             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4640
  4641         16  CO-CURRENT-MONTHLY-TOTALS.
  4642             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4643             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4644             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4645             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4646             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4647
  4648         16  CO-CURRENT-AGING-TOTALS.
  4649             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4650             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4651             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4652             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4653
  4654         16  CO-CURRENT-YTD-TOTALS.
  4655             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4656             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4657
  4658     12  CO-PAID-COMM-TOTALS.
  4659         16  CO-YTD-PAID-COMMS.
  4660             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4661             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4662
  4663     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4664         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4665         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4666
  4667     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4668         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4669         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4670         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4671         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4672         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4673         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4674         88  CO-FINAL-LETTER                  VALUE 'F'.
  4675         88  CO-RECONCILING                   VALUE 'R'.
  4676         88  CO-PHONE-CALL                    VALUE 'P'.
  4677         88  CO-LEGAL                         VALUE 'L'.
  4678         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4679         88  CO-WRITE-OFF                     VALUE 'W'.
  4680         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4681
  4682     12  CO-CSR-CODE                       PIC X(4).
  4683
  4684     12  CO-GA-STATUS-INFO.
  4685         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4686         16  CO-GA-TERMINATION-DT          PIC XX.
  4687         16  CO-GA-STATUS-CODE             PIC X.
  4688             88  CO-GA-ACTIVE                 VALUE 'A'.
  4689             88  CO-GA-INACTIVE               VALUE 'I'.
  4690             88  CO-GA-PENDING                VALUE 'P'.
  4691         16  CO-GA-COMMENTS.
  4692             20  CO-GA-COMMENT-1           PIC X(40).
  4693             20  CO-GA-COMMENT-2           PIC X(40).
  4694             20  CO-GA-COMMENT-3           PIC X(40).
  4695             20  CO-GA-COMMENT-4           PIC X(40).
  4696
  4697     12  CO-RPTCD2                         PIC X(10).
  4698     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4699         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4700         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4701
  4702     12  CO-TYPE-AGENT                     PIC X(01).
  4703         88  CO-CORPORATION                   VALUE 'C'.
  4704         88  CO-PARTNERSHIP                   VALUE 'P'.
  4705         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4706         88  CO-TRUST                         VALUE 'T'.
  4707         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4708
  4709     12  CO-FAXNO.
  4710         16  CO-FAX-AREA-CODE                  PIC XXX.
  4711         16  CO-FAX-PREFIX                     PIC XXX.
  4712         16  CO-FAX-PHONE                      PIC X(4).
  4713
  4714     12  CO-BANK-INFORMATION.
  4715         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4716         16  CO-BANK-TRANSIT-NON REDEFINES
  4717             CO-BANK-TRANSIT-NO                PIC 9(8).
  4718
  4719         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4720     12  CO-MISC-DEDUCT-INFO REDEFINES
  4721                  CO-BANK-INFORMATION.
  4722         16  CO-MD-GL-ACCT                     PIC X(10).
  4723         16  CO-MD-DIV                         PIC XX.
  4724         16  CO-MD-CENTER                      PIC X(4).
  4725         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4726         16  CO-CREATE-AP-CHECK                PIC X.
  4727         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4728         16  FILLER                            PIC XXX.
  4729     12  CO-ACH-STATUS                         PIC X.
  4730         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4731         88  CO-ACH-PENDING                        VALUE 'P'.
  4732
  4733     12  CO-BILL-SW                            PIC X.
  4734     12  CO-CONTROL-NAME                       PIC X(30).
  4735     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4736     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4737     12  CO-CLP-STATE                          PIC XX.
  4738     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4739     12  CO-SPP-REFUND-EDIT                    PIC X.
  4740
  4741******************************************************************
  4742
  4743 FD  ERLOFC.
* 4744                                 COPY ERCLOFC.
  4745******************************************************************12/04/92
  4746*                                                                *ERCLOFC
  4747*                                                                *ERCLOFC
  4748*                            ERCLOFC                             *   LV002
  4749*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4750*                            VMOD=2.003                          *   CL**2
  4751*                                                                *ERCLOFC
  4752*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4753*                                                                *ERCLOFC
  4754*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4755*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4756*                                                                *ERCLOFC
  4757*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4758*                                                                *ERCLOFC
  4759*   LOG = YES                                                    *ERCLOFC
  4760*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4761*                                                                *ERCLOFC
  4762******************************************************************ERCLOFC
  4763                                                                  ERCLOFC
  4764 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4765     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4766         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4767                                                                  ERCLOFC
  4768     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4769         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4770         16  LO-CARRIER              PIC X.                       ERCLOFC
  4771         16  LO-GROUPING.                                         ERCLOFC
  4772             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4773             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4774         16  LO-STATE                PIC XX.                      ERCLOFC
  4775         16  LO-ACCOUNT.                                          ERCLOFC
  4776             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4777             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4778         16  LO-OFFICER-CODE         PIC X(5).
  4779                                                                  ERCLOFC
  4780     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4781                                                                  ERCLOFC
  4782     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4783     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4784     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4785                                                                  ERCLOFC
  4786     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4787             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4788             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4789     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4790             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4791             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4792                                                                  ERCLOFC
  4793     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4794     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4795     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4796                                                                  ERCLOFC
  4797     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4798     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4799                                                                  ERCLOFC
  4800     12  LO-OFFICER-INFO.                                         ERCLOFC
  4801         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4802             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4803             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4804             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4805             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4806             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4807             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4808             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4809             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4810     12  FILLER                      PIC X(198).
  4811******************************************************************ERCLOFC
  4812
  4813 FD  ERBXRF.
* 4814                                 COPY ERCBXRF.
  4815******************************************************************04/29/98
  4816*                                                                *ERCBXRF
  4817*                                                                *ERCBXRF
  4818*                            ERCBXRF                             *   LV002
  4819*                                                                *ERCBXRF
  4820*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4821*                                                                *ERCBXRF
  4822*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4823*                                                                *ERCBXRF
  4824*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4825*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4826*                                                                *ERCBXRF
  4827*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4828*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4829*                                                                *ERCBXRF
  4830*   LOG = NO                                                     *ERCBXRF
  4831*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4832*                                                                *ERCBXRF
  4833******************************************************************ERCBXRF
  4834                                                                  ERCBXRF
  4835 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4836     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4837         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4838                                                                  ERCBXRF
  4839     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4840         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4841         16  BK-CARRIER              PIC X.                       ERCBXRF
  4842         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4843         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4844                                                                  ERCBXRF
  4845     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4846         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4847         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4848         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4849         16  FILLER                  PIC X(9).                    ERCBXRF
  4850                                                                  ERCBXRF
  4851     12  FILLER                      PIC X(37).                   ERCBXRF
  4852                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4853     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4854                                                                  ERCBXRF
  4855     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4856                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4857         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4858         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4859         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4860         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4861         16  FILLER                  PIC X(20).                   ERCBXRF
  4862                                                                  ERCBXRF
  4863******************************************************************ERCBXRF
  4864
  4865 FD  ERAGTC.
* 4866                                 COPY ERCAGTC.
  4867******************************************************************
  4868*                                                                *
  4869*                                                                *
  4870*                            ERCAGTC                             *
  4871*                            VMOD=2.001                          *
  4872*                                                                *
  4873*   ONLINE CREDIT SYSTEM                                         *
  4874*                                                                *
  4875*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4876*                                                                *
  4877*   FILE TYPE = VSAM,KSDS                                        *
  4878*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4879*                                                                *
  4880*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4881*       ALTERNATE PATH = NONE                                    *
  4882*                                                                *
  4883*   LOG = NO                                                     *
  4884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4885*                                                                *
  4886******************************************************************
  4887*                   C H A N G E   L O G
  4888*
  4889* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4890*-----------------------------------------------------------------
  4891*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4892* EFFECTIVE    NUMBER
  4893*-----------------------------------------------------------------
  4894* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4895* 111004                         NEW FILE AND COPYBOOK
  4896* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4897******************************************************************
  4898
  4899 01  AGENT-COMMISSIONS.
  4900     12  AG-RECORD-ID                          PIC XX.
  4901         88  VALID-CO-ID                          VALUE 'AG'.
  4902
  4903     12  AG-CONTROL-PRIMARY.
  4904         16  AG-COMPANY-CD                     PIC X.
  4905         16  AG-CONTROL.
  4906             20  AG-CTL-1.
  4907                 24  AG-CARR-GROUP.
  4908                     28  AG-CARRIER            PIC X.
  4909                     28  AG-GROUPING           PIC X(6).
  4910                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4911             20  AG-CTL-2.
  4912                 24  AG-EXP-DT                 PIC XX.
  4913         16  AG-TYPE                           PIC X.
  4914             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4915             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4916
  4917     12  AG-MAINT-INFORMATION.
  4918         16  AG-LAST-MAINT-DT                  PIC XX.
  4919         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4920         16  AG-LAST-MAINT-USER                PIC X(4).
  4921         16  FILLER                            PIC X(10).
  4922
  4923     12  AG-EFF-DT                             PIC XX.
  4924     12  AG-COMM-STRUCTURE.
  4925         16  AG-AGT-COMMS OCCURS 10.
  4926             20  AG-AGT                PIC X(10).
  4927             20  AG-COM-TYP            PIC X.
  4928             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4929             20  AG-RECALC-LV-INDIC    PIC X.
  4930             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4931             20  AG-LRCALC-LV-INDIC    PIC X.
  4932             20  FILLER                PIC X(05).
  4933
  4934     12  FILLER                  PIC X(145).
  4935******************************************************************
  4936
  4937 FD  ELCRTT.
* 4938                                 COPY ELCCRTT.
  4939******************************************************************
  4940*                                                                *ELCCRTT
  4941*                            ELCCRTT.                            *
  4942*                                                                *ELCCRTT
  4943*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4944*                                                                *ELCCRTT
  4945*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4946*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4947*                                                                *ELCCRTT
  4948*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4949*                                                                *ELCCRTT
  4950*   LOG = YES                                                    *ELCCRTT
  4951*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4952******************************************************************
  4953*                   C H A N G E   L O G
  4954*
  4955* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4956*-----------------------------------------------------------------
  4957*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4958* EFFECTIVE    NUMBER
  4959*-----------------------------------------------------------------
  4960* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4961* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4962* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4963******************************************************************
  4964                                                                  ELCCRTT
  4965 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4966     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  4967         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  4968                                                                  ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4969     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  4970         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  4971         16  CS-CARRIER                    PIC X.                 ELCCRTT
  4972         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  4973         16  CS-STATE                      PIC XX.                ELCCRTT
  4974         16  CS-ACCOUNT                    PIC X(10).
  4975         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  4976         16  CS-CERT-NO.                                          ELCCRTT
  4977             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  4978             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  4979         16  CS-TRAILER-TYPE               PIC X.
  4980             88  COMM-TRLR           VALUE 'A'.
  4981             88  FUTURE-TRLR         VALUE 'B'.
  4982             88  CERT-DATA-TRLR      VALUE 'C'.
  4983                                                                  ELCCRTT
  4984     12  CS-DATA-AREA                      PIC X(516).
  4985
  4986     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4987         16  CS-BANK-COMMISSION-AREA.
  4988             20  CS-BANK-COMMS       OCCURS 10.
  4989                 24  CS-AGT                PIC X(10).
  4990                 24  CS-COM-TYP            PIC X.
  4991                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4992                 24  CS-RECALC-LV-INDIC    PIC X.
  4993                 24  FILLER                PIC X(10).
  4994
  4995         16  FILLER                        PIC X(256).
  4996
  4997     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4998         16  CS-VIN-NUMBER                 PIC X(17).
  4999         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5000         16  FILLER                        PIC X(498).
  5001
  5002******************************************************************ELCCRTT
  5003
  5004 FD  ERPDEF.
  5005
* 5006                                 COPY ERCPDEF.
  5007******************************************************************
  5008*                                                                *
  5009*                                                                *
  5010*                            ERCPDEF.                            *
  5011*                                                                *
  5012*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5013*                                                                *
  5014*    FILE TYPE = VSAM,KSDS                                       *
  5015*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5016*                                                                *
  5017*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5018*                                                                *
  5019*    LOG = YES                                                   *
  5020*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5021******************************************************************
  5022 01  PRODUCT-MASTER.
  5023    12  PD-RECORD-ID                 PIC X(02).
  5024        88  VALID-PD-ID                  VALUE 'PD'.
  5025
  5026    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  92
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5027        16  PD-COMPANY-CD            PIC X.
  5028        16  PD-STATE                 PIC XX.
  5029        16  PD-PRODUCT-CD            PIC XXX.
  5030        16  PD-FILLER                PIC X(7).
  5031        16  PD-BEN-TYPE              PIC X.
  5032        16  PD-BEN-CODE              PIC XX.
  5033        16  PD-PROD-EXP-DT           PIC XX.
  5034
  5035    12  FILLER                       PIC X(50).
  5036
  5037    12  PD-PRODUCT-DATA OCCURS 8.
  5038        16  PD-PROD-CODE             PIC X.
  5039            88  PD-PROD-LIFE           VALUE 'L'.
  5040            88  PD-PROD-PROP           VALUE 'P'.
  5041            88  PD-PROD-AH             VALUE 'A'.
  5042            88  PD-PROD-IU             VALUE 'I'.
  5043            88  PD-PROD-GAP            VALUE 'G'.
  5044        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5045        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5046        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5047        16  PD-MAX-TERM              PIC S999        COMP-3.
  5048        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5049        16  FILLER                   PIC X.
  5050        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5051        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5052        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5053        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5054        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5055        16  PD-REC-CRIT-PERIOD       PIC X.
  5056        16  PD-RTW-MOS               PIC 99.
  5057        16  FILLER                   PIC X(5).
  5058
  5059    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5060
  5061    12  PD-TERM-LIMITS OCCURS 15.
  5062        16  PD-LOW-TERM              PIC S999        COMP-3.
  5063        16  PD-HI-TERM               PIC S999        COMP-3.
  5064
  5065*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5066    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5067        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5068        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5069
  5070    12  PD-EARN-FACTORS.
  5071        16  FILLER OCCURS 15.
  5072            20  FILLER OCCURS 15.
  5073                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5074
  5075    12  PD-PRODUCT-DESC              PIC X(80).
  5076    12  PD-TRUNCATED                 PIC X.
  5077    12  FILLER                       PIC X(59).
  5078
  5079    12  PD-MAINT-INFORMATION.
  5080        16  PD-LAST-MAINT-DT         PIC X(02).
  5081        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5082        16  PD-LAST-MAINT-BY         PIC X(04).
  5083
  5084 FD  ELSTAT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  93
* EL517.cbl
  5085
* 5086                                 COPY ELCSTATE.
  5087******************************************************************
  5088*                                                                *
  5089*                                                                *
  5090*                            ELCSTATE.                           *
  5091*                                                                *
  5092*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5093*                                                                *
  5094*   FILE TYPE = VSAM,KSDS                                        *
  5095*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5096*                                                                *
  5097*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5098*       ALTERNATE INDEX = NONE                                   *
  5099*                                                                *
  5100*   LOG = YES                                                    *
  5101*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5102******************************************************************
  5103*                   C H A N G E   L O G
  5104*
  5105* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5106*-----------------------------------------------------------------
  5107*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5108* EFFECTIVE    NUMBER
  5109*-----------------------------------------------------------------
  5110* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5111******************************************************************
  5112*
  5113 01  STATE-FILE.
  5114     12  SF-RECORD-ID                       PIC XX.
  5115         88  VALID-CF-ID                        VALUE 'SF'.
  5116
  5117     12  SF-CONTROL-PRIMARY.
  5118         16  SF-COMPANY-ID                  PIC XXX.
  5119         16  SF-CARRIER-CODE                PIC X.
  5120         16  SF-GROUPING                    PIC X(6).
  5121         16  SF-STATE-CODE                  PIC XX.
  5122         16  SF-EXPIRE-DATE                 PIC 9(8).
  5123
  5124****************************************************************
  5125*             STATE CONTROLS
  5126****************************************************************
  5127
  5128     12  SF-LAST-MAINT-DT                   PIC XX.
  5129     12  SF-LAST-MAINT-BY                   PIC X(4).
  5130     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5131
  5132     12  SF-STATE-RT-CONTROLS.
  5133         16  SF-ST-RT-CALC                  PIC X.
  5134
  5135     12  SF-ST-TAX-CONTROLS.
  5136         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5137         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5138         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5139
  5140     12  SF-ST-REFUND-OPTIONS.
  5141         16  SF-ST-RF-LR-CALC               PIC X.
  5142         16  SF-ST-RF-LL-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5143         16  SF-ST-RF-LN-CALC               PIC X.
  5144         16  SF-ST-RF-AH-CALC               PIC X.
  5145         16  SF-ST-RF-CP-CALC               PIC X.
  5146
  5147     12  SF-ST-UNEARN-PREM-OPTIONS.
  5148         16  SF-ST-LUEP-R78                 PIC X.
  5149         16  SF-ST-LUEP-PRO                 PIC X.
  5150         16  SF-ST-LUEP-ST                  PIC X.
  5151         16  SF-ST-LUEP-DOM                 PIC X.
  5152         16  SF-ST-AUEP-R78                 PIC X.
  5153         16  SF-ST-AUEP-PRO                 PIC X.
  5154         16  SF-ST-AUEP-ST                  PIC X.
  5155         16  SF-ST-AUEP-DOM                 PIC X.
  5156         16  SF-ST-CUEP-R78                 PIC X.
  5157         16  SF-ST-CUEP-PRO                 PIC X.
  5158         16  SF-ST-CUEP-ST                  PIC X.
  5159         16  SF-ST-CUEP-DOM                 PIC X.
  5160
  5161     12  SF-ST-EARN-PREM-OPTIONS.
  5162         16  SF-ST-LEP-R78                  PIC X.
  5163         16  SF-ST-LEP-PRO                  PIC X.
  5164         16  SF-ST-LEP-ST                   PIC X.
  5165         16  SF-ST-LEP-DOM                  PIC X.
  5166         16  SF-ST-AEP-R78                  PIC X.
  5167         16  SF-ST-AEP-PRO                  PIC X.
  5168         16  SF-ST-AEP-ST                   PIC X.
  5169         16  SF-ST-AEP-DOM                  PIC X.
  5170         16  SF-ST-CEP-R78                  PIC X.
  5171         16  SF-ST-CEP-PRO                  PIC X.
  5172         16  SF-ST-CEP-ST                   PIC X.
  5173         16  SF-ST-CEP-DOM                  PIC X.
  5174
  5175     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5176
  5177 FD  ELCRTO.
  5178
* 5179                                 COPY ELCCRTO.
  5180******************************************************************
  5181*                                                                *
  5182*                            ELCCRTO.                            *
  5183*                                                                *
  5184*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5185*                                                                *
  5186*   FILE TYPE = VSAM,KSDS                                        *
  5187*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5188*                                                                *
  5189*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5190*                                                                *
  5191*   LOG = YES                                                    *
  5192*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5193******************************************************************
  5194*                   C H A N G E   L O G
  5195*
  5196* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5197*-----------------------------------------------------------------
  5198*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5199* EFFECTIVE    NUMBER
  5200*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5201* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5202* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5203* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5204******************************************************************
  5205
  5206 01  ORIGINAL-CERTIFICATE.
  5207     12  OC-RECORD-ID                      PIC XX.
  5208         88  VALID-OC-ID                      VALUE 'OC'.
  5209
  5210     12  OC-CONTROL-PRIMARY.
  5211         16  OC-COMPANY-CD                 PIC X.
  5212         16  OC-CARRIER                    PIC X.
  5213         16  OC-GROUPING                   PIC X(6).
  5214         16  OC-STATE                      PIC XX.
  5215         16  OC-ACCOUNT                    PIC X(10).
  5216         16  OC-CERT-EFF-DT                PIC XX.
  5217         16  OC-CERT-NO.
  5218             20  OC-CERT-PRIME             PIC X(10).
  5219             20  OC-CERT-SFX               PIC X.
  5220         16  OC-RECORD-TYPE                PIC X.
  5221         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5222
  5223     12  OC-LAST-MAINT-DT                  PIC XX.
  5224     12  OC-LAST-MAINT-BY                  PIC X(4).
  5225     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5226
  5227     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5228     12  FILLER                            PIC X(49).
  5229
  5230     12  OC-ORIG-REC.
  5231         16  OC-INS-LAST-NAME              PIC X(15).
  5232         16  OC-INS-FIRST-NAME             PIC X(10).
  5233         16  OC-INS-MIDDLE-INIT            PIC X.
  5234         16  OC-INS-AGE                    PIC S999     COMP-3.
  5235         16  OC-JNT-LAST-NAME              PIC X(15).
  5236         16  OC-JNT-FIRST-NAME             PIC X(10).
  5237         16  OC-JNT-MIDDLE-INIT            PIC X.
  5238         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5239         16  OC-LF-BENCD                   PIC XX.
  5240         16  OC-LF-TERM                    PIC S999      COMP-3.
  5241         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5242         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5243         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5244         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5245         16  OC-LF-EXP-DT                  PIC XX.
  5246         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5247         16  OC-LF-CANCEL-DT               PIC XX.
  5248         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5249         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5250         16  OC-AH-BENCD                   PIC XX.
  5251         16  OC-AH-TERM                    PIC S999      COMP-3.
  5252         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5253         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5254         16  OC-AH-EXP-DT                  PIC XX.
  5255         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5256         16  OC-AH-CP                      PIC 99.
  5257         16  OC-AH-CANCEL-DT               PIC XX.
  5258         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5259         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5260         16  OC-CRED-BENE-NAME             PIC X(25).
  5261         16  OC-1ST-PMT-DT                 PIC XX.
  5262         16  FILLER                        PIC X(215).
  5263
  5264     12  FILLER                            PIC X(50).
  5265
  5266******************************************************************
  5267
  5268 WORKING-STORAGE SECTION.
  5269 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5270 77  FILLER   PIC X(32) VALUE '********************************'.
  5271 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5272 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5273
  5274 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5275 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5276 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5277 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5278
  5279 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5280 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5281 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5282 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5283 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5284 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5285 77  X                      PIC X                  VALUE ' '.
  5286 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5287
  5288 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5289 01  TRAN-CX REDEFINES TRAN-CT.
  5290     12  FILLER             PIC XX.
  5291     12  TCX                PIC 999.
  5292 01  SEQ-NO                 PIC 9999               VALUE 0.
  5293 01  RPND                   PIC 9(5)               VALUE 0.
  5294 01  WPND                   PIC 9(5)               VALUE 0.
  5295 01  RREI                   PIC 9(5)               VALUE 0.
  5296 01  RCTB                   PIC 9(5)               VALUE 0.
  5297 01  RACC                   PIC 9(5)               VALUE 0.
  5298 01  RCER                   PIC 9(5)               VALUE 0.
  5299 01  RCNT                   PIC 9(5)               VALUE 0.
  5300 01  WCER                   PIC 9(5)               VALUE 0.
  5301 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5302 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5303 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5304 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5305 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5306 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5307 01  EMSG.
  5308     12  WS-FILE-ERROR-MESSAGE.
  5309         16  FILLER              PIC X(24)   VALUE
  5310             'ERROR OCCURED OPENING - '.
  5311         16  WS-FEM-FILE-NAME    PIC X(8).
  5312
  5313 01  CMSG.
  5314     12  WS-FILE-ERROR-MESSAGE.
  5315         16  FILLER              PIC X(24)   VALUE
  5316             'ERROR OCCURED CLOSING - '.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  97
* EL517.cbl
  5317         16  WS-CEM-FILE-NAME    PIC X(8).
  5318
  5319 01  RMSG.
  5320     12  WS-FILE-ERROR-MESSAGE.
  5321         16  FILLER              PIC X(24)   VALUE
  5322             'ERROR OCCURED READING - '.
  5323         16  WS-REM-FILE-NAME    PIC X(8).
  5324
  5325 01  HDG1.
  5326     12  FILLER                  PIC X(50)       VALUE ' '.
  5327     12  FILLER                  PIC X(28)       VALUE
  5328                   'PENDING BUSINESS FILE EDIT '.
  5329     12  ER-ONLY                 PIC X(47)       VALUE
  5330          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5331     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5332
  5333 01  HDG2.
  5334     12  FILLER              PIC X(52)              VALUE SPACE.
  5335     12  H2-COMP             PIC X(30).
  5336     12  FILLER              PIC X(42)              VALUE SPACE.
  5337     12  H2-DATE             PIC X(8).
  5338
  5339 01  HDG3.
  5340     12  FILLER              PIC X(54)              VALUE SPACE.
  5341     12  H3-DATE             PIC X(18).
  5342     12  FILLER              PIC X(49)              VALUE SPACE.
  5343
  5344 01  SUM1.
  5345     12  FILLER              PIC XX                 VALUE ' '.
  5346     12  SUM-TOT             PIC ZZ,ZZZ.
  5347     12  FILLER              PIC X(3)               VALUE SPACE.
  5348     12  FILLER              PIC X(30)              VALUE
  5349          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  98
* EL517.cbl
  5351
  5352 01  WX-AREA.
  5353     12  PH-COBOL            PIC X.
  5354     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5355
  5356 01  STATUS-SWITCH.
  5357     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5358     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5359     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5360     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5361     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5362     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5363     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5364     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5365     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5366     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5367     12  ERACCT-FILE-STATUS.
  5368         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5369         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5370     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5371     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5372     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5373     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5374     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5375     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5376     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5377     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5378     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5379     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5380     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5381
  5382     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5383     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5384     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5385     12  WS-SW-1                  PIC X  VALUE ' '.
  5386     12  WS-SW-2                  PIC X  VALUE ' '.
  5387
  5388     12  WS-COMPUTED-TOTALS      COMP-3.
  5389         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5390         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5391         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5392         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5393         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5394         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5395         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5396         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5397         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5398         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5399     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5400         88  CO-HAS-CLAIMS                     VALUE '2'.
  5401
  5402     12  EIBDATE                 PIC S9(7)     COMP-3.
  5403
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  99
* EL517.cbl
  5405
  5406* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5407     COPY ELC50W1.
  5408******************************************************************04/19/98
  5409*                                                                *ELC50W1
  5410*                                                                *ELC50W1
  5411*                             ELC50W1                            *   LV005
  5412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5413*                            VMOD=2.004                          *   CL**5
  5414*                                                                *ELC50W1
  5415*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5416*                                                                *ELC50W1
  5417*                                                                *ELC50W1
  5418******************************************************************ELC50W1
  5419                                                                  ELC50W1
  5420     12  WK-WORK-AREA.                                            ELC50W1
  5421         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5422         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5423         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5424         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5425         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5426         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5427         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5428         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5429         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5430         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5431         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5432         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5433         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5434         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5435         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5436         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5437             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5438             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5439             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5440             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5441             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5442             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5443         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5444         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5445             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5446             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5447             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5448         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5449             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5450         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5451         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5452     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5453         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5454         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5455         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5456         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5457         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5458         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5459         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5460         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5461     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5462         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 100
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5463         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5464         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5465             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5466         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5467
  5468         16  WK-CONV-GREG.
  5469             24  WCG-CENT             PIC XX.
  5470             24  WCG-REST             PIC X(4).
  5471         16  WORK-GREGORIAN-DATE.
  5472             24  WK-GREG-CENT         PIC XX.
  5473             24  WK-GREG-DATE-YYMMDD.
  5474                 28  WK-GREG-YYMM     PIC X(4).
  5475                 28  WK-GREG-DD       PIC XX.
  5476
  5477         16  WORK-SELECT-DATE.
  5478             24  WK-SELECT-CENT           PIC XX.
  5479             24  WK-SELECT-DATE-YYMMDD.
  5480                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5481                 28  FILLER               PIC XX.
  5482
  5483         16  WK-FORM-NO.
  5484             24  WK-FORM-BANK-ID       PIC X(5).
  5485             24  WK-FORM-UNDRWRTR      PIC X(1).
  5486             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5487
  5488         16  WK-MEMBER-NO.
  5489             24  WK-MEMBER-1-6        PIC X(6).
  5490             24  WK-MEMBER-7-12       PIC X(6).
  5491
  5492         16  WK-FULL-CERT-NO.
  5493             24  WK-CERT-POS-1-2      PIC X(2).
  5494             24  WK-CERT-POS-3        PIC X(1).
  5495             24  WK-CERT-POS-4        PIC X(1).
  5496             24  WK-CERT-POS-5-6      PIC X(2).
  5497             24  WK-CERT-POS-7        PIC X(1).
  5498             24  WK-CERT-POS-8-11     PIC X(4).
  5499
  5500         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5501             88  VALID-RATE-CODE     VALUE 'Y'.
  5502             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5503
  5504     12  WK-BATCH-NO.
  5505         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5506         16  FILLER                   PIC XXX       VALUE SPACES.
  5507
* 5508                                  COPY ELCEDITC.
  5509******************************************************************04/15/98
  5510*                                                                *ELCEDITC
  5511*                                                                *ELCEDITC
  5512*                            ELCEDITC                            *   LV002
  5513*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5514*                            VMOD=2.012                          *   CL**2
  5515*                                                                *ELCEDITC
  5516*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5517*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5518*                                                                *ELCEDITC
  5519******************************************************************ELCEDITC
  5520******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5521*                   C H A N G E   L O G
  5522*
  5523* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5524*-----------------------------------------------------------------
  5525*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5526* EFFECTIVE    NUMBER
  5527*-----------------------------------------------------------------
  5528* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5529******************************************************************
  5530                                                                  ELCEDITC
  5531     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5532         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5533         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5534         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5535         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5536         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5537         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5538         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5539         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5540         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5541         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5542               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5543               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5544               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5545               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5546                                                                  ELCEDITC
  5547         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5548               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5549               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5550               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5551               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5552               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5553               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5554               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5555               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5556               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5557               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5558                                                                  ELCEDITC
  5559         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5560               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5561               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5562               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5563               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5564               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5565               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5566               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5567               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5568                                                                  ELCEDITC
  5569         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5570                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5571                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5572                                                                  ELCEDITC
  5573         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5574                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5575                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5576                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5577                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5578                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5579                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5580                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5581                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5582                                                                  ELCEDITC
  5583         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5584               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5585               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5586                                                                  ELCEDITC
  5587         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5588         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5589         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5590         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5591         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5592                                                                  ELCEDITC
  5593         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5594               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5595               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5596               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5597               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5598                                                                  ELCEDITC
  5599         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5600               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5601               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5602               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5603               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5604                                                                  ELCEDITC
  5605         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5606                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5607                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5608                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5609                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5610                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5611                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5612                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5613                                                                  ELCEDITC
  5614         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5615                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5616                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5617                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5618                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5619                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5620                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5621                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5622                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5623                                                                  ELCEDITC
  5624         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5625                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5626                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5627                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5628                                                                  ELCEDITC
  5629         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5630                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5631                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5632                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5633                                                                  ELCEDITC
  5634         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5635         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5636         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5637         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5638                                                                  ELCEDITC
  5639         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5640         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5641                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5642                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5643                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5644                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5645                                                                  ELCEDITC
  5646         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5647               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5648               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5649               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5650               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5651               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5652                                                                  ELCEDITC
  5653         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5654               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5655               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5656               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5657               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5658               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5659                                                                  ELCEDITC
  5660         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5661                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5662                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5663                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5664                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5665                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5666                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5667                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5668                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5669                                                                  ELCEDITC
  5670         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5671                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5672                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5673                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5674                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5675                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5676                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5677                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5678                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5679                                                                  ELCEDITC
  5680         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5681         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5682         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5683         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5684         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5685         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5686         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5687         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5688         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5689         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5690         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5691         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5692                                                                  ELCEDITC
  5693         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5694                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5695                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5696                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5697                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5698                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5699                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5700                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5701                                                                  ELCEDITC
  5702         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5703                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5704                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5705                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5706                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5707                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5708                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5709                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5710                                                                  ELCEDITC
  5711         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5712                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5713                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5714                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5715                                                                  ELCEDITC
  5716         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5717         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5718         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5719         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5720         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5721         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5722         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5723         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5724         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5725                                                                  ELCEDITC
  5726         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5727         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5728         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5729         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5730         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5731         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5732         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5733         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5734         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5735         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5736         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5737         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5738         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5739         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5740         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5741                                                                  ELCEDITC
  5742         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5743             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5744                                             'M' '5' '9' '2'.     ELCEDITC
  5745             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5746             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5747             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5748             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5749             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5750             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5751             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5752             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5753             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5754             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5755                                                                  ELCEDITC
  5756         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5757             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5758                                             'M' '5' '9' '2'.     ELCEDITC
  5759             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5760             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5761             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5762             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5763             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5764             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5765             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5766             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5767             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5768             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5769                                                                  ELCEDITC
  5770         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5771         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5772         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5773         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5774         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5775                                                                  ELCEDITC
  5776*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5777*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5778         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5779                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5780                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5781                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5782                                                                  ELCEDITC
  5783         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5784         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5785         16  FILLER                    PIC X.                     ELCEDITC
  5786*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5787         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5788             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5789             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5790             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5791             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5792             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5793             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5794             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5795             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5796             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5797         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 106
* EL517.cbl
* 5799                                  COPY ELC50WS.
  5800*****************************************************************
  5801*                                                               *
  5802*                            ELC50WS.                           *
  5803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5804*                            VMOD=2.061.                        *
  5805*                                                               *
  5806*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5807*                                   EL517                       *
  5808*****************************************************************
  5809******************************************************************
  5810*                   C H A N G E   L O G
  5811*
  5812* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5813*-----------------------------------------------------------------
  5814*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5815* EFFECTIVE    NUMBER
  5816*-----------------------------------------------------------------
  5817* 123102                   PEMA  ADD DCC PROCESSING
  5818* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5819* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5820* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5821* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5822* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5823* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5824* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5825* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5826* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5827* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5828* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5829* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5830* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5831* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5832* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5833* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5834* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5835* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5836* 030309  CR2009021700001  PEMA  ADD ER-2883
  5837* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5838* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5839* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5840* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5841* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5842* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5843* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5844* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5845* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5846* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5847* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5848* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5849* 061412  CR2011022800001  AJRA  NAPERSOFT
  5850*-----------------------------------------------------------------
  5851
  5852 01  WORK-AREAS.
  5853
  5854*****************************************************************
  5855*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5856*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 107
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5857
  5858     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5859     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5860     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5861     12  WS-NAME-EDIT-WORK-AREA.
  5862         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5863         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5864             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5865         16  WS-WORK-NAME.
  5866             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5867             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5868             20  FILLER           PIC X(10)     VALUE SPACES.
  5869         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5870             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5871
  5872*****************************************************************
  5873*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5874*****************************************************************
  5875
  5876     12  WS-ERRESC-KEY.
  5877         16 WS-ERRESC-SEARCH-KEY.
  5878             20  WS-ERRESC-COMPANY-CD PIC  X.
  5879             20  WS-ERRESC-CARRIER    PIC  X.
  5880             20  WS-ERRESC-GROUP      PIC X(6).
  5881             20  WS-ERRESC-STATE      PIC XX.
  5882             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5883         16 WS-ERRESC-RESIDUAL-KEY.
  5884             20  WS-ERRESC-AGENT      PIC X(10).
  5885             20  WS-ERRESC-RES-STATE  PIC XX.
  5886             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5887*                                          YYYYMMDD
  5888     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5889     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5890
  5891*RESIDENT STATE TAX MASTER(ERRESS)
  5892*
  5893     12  WS-ERRESS-KEY.
  5894         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5895         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5896         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5897         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5898*                                          YYYYMMDD
  5899
  5900     12  WS-CONTRACT-DATE              PIC 9(8).
  5901*                                          YYYYMMDD
  5902     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5903     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5904         16 WS-YEAR-YY                 PIC   9999.
  5905         16 FILLER                     PIC 9(4).
  5906*                                          YYYYMMDD
  5907     12  WS-SAVE-ERRESS-KEY            PIC X(9).
  5908     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5909     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5910     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5911
  5912     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5913         88  DPRB-1ST-TIME                      VALUE ' '.
  5914
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 108
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5915*****************************************************************
  5916*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5917*****************************************************************
  5918
  5919     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5920     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5921     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5922     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5923     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5924     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5925     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5926     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5927     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5928     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5929         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5930         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5931     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5932         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5933         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5934     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5935
  5936     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5937     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  5938
  5939     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  5940     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  5941     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5942     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5943     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5944     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5945     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5946     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5947     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5948     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5949     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5950     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5951     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  5952     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  5953     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  5954     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  5955     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  5956     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  5957     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  5958     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  5959     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  5960     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  5961     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  5962     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  5963     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  5964     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  5965     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  5966     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  5967     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  5968     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  5969     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  5970     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  5971     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  5972     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 109
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5973     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  5974     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  5975     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  5976     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  5977     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  5978     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  5979     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  5980     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  5981     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  5982     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  5983     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  5984     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  5985     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  5986     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  5987     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  5988     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  5989     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  5990     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  5991     12  WS-2671-SW               PIC X         VALUE SPACE.
  5992     12  WS-2672-SW               PIC X         VALUE SPACE.
  5993     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  5994         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  5995     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  5996         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  5997     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  5998
  5999     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6000         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6001         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6002         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6003         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6004
  6005     12  WS-CREDIT-EDIT-CONTROLS.
  6006         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6007         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6008         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6009         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6010         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6011         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6012
  6013     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6014         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6015         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6016         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6017         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
  6018         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6019         16  FILLER                      PIC XX.
  6020
  6021     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
  6022     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6023     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6024     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6025     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6026     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6027     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6028     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6029     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6030     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 110
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6031
  6032     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6033     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6034     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6035     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6036     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6037     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6038     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6039     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6040         88  WS-REDUCING              VALUE 'R'.
  6041         88  WS-LEVEL                 VALUE 'L' 'P'.
  6042     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6043
  6044     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6045     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6046     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6047     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6048     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6049     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6050     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6051     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6052     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6053
  6054     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6055     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6056     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6057     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6058     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6059     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6060     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6061     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6062     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6063     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6064     12  WS-ACCT-SIG-SW.
  6065         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6066         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6067     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6068     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6069     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6070     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6071     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6072     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6073     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6074     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6075     12  WS-INITIALS.
  6076         16  WS-INIT-1            PIC X         VALUE SPACES.
  6077         16  WS-INIT-2            PIC X         VALUE SPACES.
  6078
  6079     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
  6080     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6081     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6082     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6083     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6084*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6085     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6086     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6087     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6088     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 111
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6089     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6090     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6091     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6092     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6093     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6094     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6095     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6096     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6097     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6098     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6099     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6100     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6101     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6102     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6103     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6104     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6105     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6106     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6107******** FLA
  6108     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6109     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6110     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6111     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6112     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6113********
  6114     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6115     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6116     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6117     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6118     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6119     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6120     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6121     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6122     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6123     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6124
  6125     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6126         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6127                                         '0' THRU '9'.
  6128
  6129     12  NUMBER-OF-MONTHS.
  6130         16  SK-MO OCCURS 12 TIMES PIC X.
  6131
  6132     12  WS-WORK-DATE.
  6133         16  WS-YEAR            PIC 99    VALUE 00.
  6134         16  WS-MONTH           PIC 99    VALUE 00.
  6135         16  WS-DAY             PIC 99    VALUE 00.
  6136
  6137     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
  6138     12  WS-WORK-CRIT-DEV       REDEFINES
  6139         WS-WORK-LF-CRIT-PER    PIC X(03).
  6140
  6141     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6142     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6143
  6144     12  WS-WORK-DATE-FROM.
  6145         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6146         16  FILLER             PIC X  VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 112
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6147         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6148         16  FILLER             PIC X         VALUE SPACE.
  6149         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6150
  6151     12  WS-WORK-DATE-THRU.
  6152         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6153         16  FILLER             PIC X         VALUE SPACE.
  6154         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6155         16  FILLER             PIC X         VALUE SPACE.
  6156         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6157
  6158     12  WS-LF-INPUT-CD.
  6159         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6160         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6161
  6162     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6163     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6164         16  WS-AH-INPUT-CD-1   PIC X.
  6165         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6166
  6167     12  WS-SWITCHES.
  6168         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6169         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6170             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6171         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6172             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6173         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6174             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6175         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6176             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6177         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6178             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6179         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6180             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6181         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6182             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6183         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6184             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6185         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6186             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6187         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6188             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6189         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6190             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6191         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
  6192             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6193         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6194             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6195         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
  6196             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6197         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6198             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6199         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6200             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6201         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6202             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6203         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6204             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 113
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6205         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6206             88  AH-BENEFIT-FOUND         VALUE ' '.
  6207             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6208         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6209             88  LF-BENEFIT-FOUND         VALUE ' '.
  6210             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6211         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6212             88  NO-STATE-RECORD          VALUE '1'.
  6213         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6214             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6215         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6216             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6217         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6218             88  CERT-WAS-FOUND           VALUE ' '.
  6219             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6220         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6221             88  BROWSE-STARTED           VALUE 'Y'.
  6222         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6223             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6224         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6225             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6226         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6227             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6228         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6229             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6230         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6231             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6232         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6233             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6234         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6235             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6236             88  FIRST-TIME-THROUGH       VALUE '1'.
  6237             88  CTBL-NOT-FOUND           VALUE '2'.
  6238
  6239         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6240             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6241
  6242         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6243             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6244
  6245********FLA
  6246     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6247     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6248********
  6249     12  RC-SW-1                  PIC X           VALUE '0'.
  6250     12  RC-SW-2                  PIC X           VALUE '0'.
  6251     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6252     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6253     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
  6254     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6255     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6256     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6257     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6258     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6259     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6260     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6261     12  LIT-SPACES               PIC X           VALUE SPACES.
  6262     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 114
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6263     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6264     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6265     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6266     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6267     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6268     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6269         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6270         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6271     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6272         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6273
  6274 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6275     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6276     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6277 01  WS-CRI-SSN-WORK-AREA.
  6278     05  WS-CRI-SOC-SEC-NO.
  6279         10  WS-SS-REPT-CD       PIC X(5).
  6280         10  WS-SS-LAST-NAME     PIC X(5).
  6281         10  WS-SS-INITIAL       PIC X.
  6282
  6283     05  WS-CRI-REPORT-CODE.
  6284         10  FILLER              PIC X(5).
  6285         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6286
  6287     05  WS-CRI-LAST-NAME.
  6288         10  WS-CRI-NAME-MOVE    PIC X(5).
  6289         10  FILLER              PIC X(10).
  6290
  6291 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6292     '12345678012345070923456789'.
  6293 01  FILLER REDEFINES WS-NUM-TABLE.
  6294     05  WS-NUM OCCURS 26        PIC 9.
  6295 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6296 01  V1                          PIC S999 COMP-3.
  6297 01  V2                          PIC S999 COMP-3.
  6298 01  V3                          PIC S999 COMP-3.
  6299 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6300 01  FILLER REDEFINES WS-WORK-VIN.
  6301     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6302 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6303 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6304 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6305 01  WS-HEX-WORK.
  6306     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6307     05  WS-HEX-BYTE             PIC X.
  6308 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6309 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6310
  6311 01  WS-WORK-HIN-ROW-B.
  6312     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6313
  6314 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6315 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6316     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6317 01  WS-ROW-D-TABLE.
  6318     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6319
  6320 01  WS-HIN-TABLE-B.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 115
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6321     05  F                       PIC XX VALUE 'A2'.
  6322     05  F                       PIC XX VALUE 'B3'.
  6323     05  F                       PIC XX VALUE 'C4'.
  6324     05  F                       PIC XX VALUE 'D5'.
  6325     05  F                       PIC XX VALUE 'E6'.
  6326     05  F                       PIC XX VALUE 'F7'.
  6327     05  F                       PIC XX VALUE 'G8'.
  6328     05  F                       PIC XX VALUE 'H9'.
  6329     05  F                       PIC XX VALUE 'I1'.
  6330     05  F                       PIC XX VALUE 'J2'.
  6331     05  F                       PIC XX VALUE 'K3'.
  6332     05  F                       PIC XX VALUE 'L4'.
  6333     05  F                       PIC XX VALUE 'M5'.
  6334     05  F                       PIC XX VALUE 'N6'.
  6335     05  F                       PIC XX VALUE 'O0'.
  6336     05  F                       PIC XX VALUE 'P7'.
  6337     05  F                       PIC XX VALUE 'Q0'.
  6338     05  F                       PIC XX VALUE 'R8'.
  6339     05  F                       PIC XX VALUE 'S9'.
  6340     05  F                       PIC XX VALUE 'T2'.
  6341     05  F                       PIC XX VALUE 'U3'.
  6342     05  F                       PIC XX VALUE 'V4'.
  6343     05  F                       PIC XX VALUE 'W5'.
  6344     05  F                       PIC XX VALUE 'X6'.
  6345     05  F                       PIC XX VALUE 'Y7'.
  6346     05  F                       PIC XX VALUE 'Z8'.
  6347 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6348     05  WS-VAL-IN               PIC X.
  6349     05  WS-VAL-OUT              PIC 9.
  6350 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6351
  6352 01  WS-COMPARE-BINARY-DATES.
  6353     05  WS-971231                PIC XX VALUE X'92FF'.
  6354     05  WS-931231                PIC XX VALUE X'8CFF'.
  6355     05  WS-791231                PIC XX VALUE X'77FF'.
  6356     05  WS-771001                PIC XX VALUE X'74A1'.
  6357     05  WS-820301                PIC XX VALUE X'7B41'.
  6358     05  WS-831031                PIC XX VALUE X'7DBF'.
  6359     05  WS-831231                PIC XX VALUE X'7DFF'.
  6360     05  WS-810831                PIC XX VALUE X'7A7F'.
  6361     05  WS-830901                PIC XX VALUE X'7D81'.
  6362
  6363 01  FILE-ACCESS-IDS.
  6364     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6365     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6366     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6367     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6368     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6369     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
  6370     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6371     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6372     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6373     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6374     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6375     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6376     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6377     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6378     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 116
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6379     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6380     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6381
  6382 01  DD-IU-SW                    PIC X   VALUE ' '.
  6383     88  DD-IU-PRESENT                 VALUE 'Y'.
  6384
  6385 01  ACCESS-KEYS.
  6386     12  ELMSTR-KEY.
  6387         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6388         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6389     12  W-CLAIM-KEY.
  6390         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6391         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6392
  6393     12  ELCNTL-KEY.
  6394         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6395         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6396         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6397         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6398
  6399     12  ELCERT-KEY.
  6400         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6401         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6402         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6403         16  CERT-STATE           PIC XX      VALUE SPACES.
  6404         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6405         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6406         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6407
  6408     12  ELCERT2-KEY.
  6409         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6410         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6411
  6412     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6413
  6414     12  ELCERT-SAVE.
  6415         16  FILLER                      PIC XX    VALUE SPACES.
  6416
  6417         16  WCS-CONTROL-PRIMARY.
  6418             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6419             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6420             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6421             20  WCS-STATE               PIC XX    VALUE SPACES.
  6422             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6423             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6424             20  WCS-CERT-NO.
  6425                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6426                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6427
  6428         16  CS-CONTROL-BY-NAME.
  6429             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6430             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6431             20  CS-INSURED-INITIALS.
  6432                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6433                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6434
  6435         16  CS-CONTROL-BY-SSN.
  6436             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 117
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6437             20  CS-SOC-SEC-NO.
  6438                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6439                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6440                 24  CS-SSN-LN3.
  6441                     28 CS-INSURED-INITIALS-A2   PIC XX
  6442                                     VALUE SPACES.
  6443                     28 CS-PART-LAST-NAME-A2     PIC X
  6444                                     VALUE SPACE.
  6445
  6446         16  CS-CONTROL-BY-CERT-NO.
  6447             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6448             20  CS-CERT-NO-A4           PIC X(11)
  6449                                     VALUE SPACES.
  6450
  6451         16  CS-CONTROL-BY-MEMB.
  6452             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6453             20  CS-MEMBER-NO.
  6454                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6455                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6456                 24  CS-MEMB-LN4.
  6457                     28 CS-INSURED-INITIALS-A5   PIC XX
  6458                                      VALUE SPACES.
  6459                     28 CS-PART-LAST-NAME-A5     PIC XX
  6460                                      VALUE SPACES.
  6461
  6462         16  FILLER              PIC X(360) VALUE SPACES.
  6463
  6464     12  ERACCT-KEY.
  6465         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6466         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6467         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6468         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6469         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6470         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6471
  6472     12  ERCOMP-KEY.
  6473         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6474         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6475         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6476         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6477         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6478         16  COMP-TYPE            PIC X     VALUE SPACES.
  6479
  6480     12  ERLOFC-KEY.
  6481         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6482         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6483         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6484         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6485         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
  6486         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6487
  6488     12  WS-ELCRTT-KEY.
  6489         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6490         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6491
  6492     12  ERBXRF-KEY.
  6493         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6494         16  BXRF-CARRIER         PIC X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 118
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6495         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6496         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6497
  6498     12  ERAGTC-KEY.
  6499         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6500         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6501         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6502         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6503         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6504         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6505
  6506     12  ERPLAN-KEY.
  6507         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6508         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6509         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6510         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6511         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6512         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6513         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6514         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6515
  6516     12  ERFORM-KEY.
  6517         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6518         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6519         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6520         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6521
  6522     12  ERREIN-KEY.
  6523         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6524         16  REIN-TYPE            PIC X     VALUE SPACES.
  6525         16  REIN-TABLE-CO.
  6526             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6527             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6528             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6529         16  FILLER               PIC X(3)  VALUE SPACES.
  6530
  6531     12  ERCTBL-KEY.
  6532         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6533         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6534         16  CTBL-CNTRL-2.
  6535             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6536             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6537
  6538     12  ELCRTO-KEY.
  6539         16  ELCRTO-COMPANY-CD       PIC X.
  6540         16  ELCRTO-CARRIER          PIC X.
  6541         16  ELCRTO-GROUPING         PIC X(6).
  6542         16  ELCRTO-STATE            PIC XX.
  6543         16  ELCRTO-ACCOUNT          PIC X(10).
  6544         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6545         16  ELCRTO-CERT-NO.
  6546             20  ELCRTO-CERT-PRIME   PIC X(10).
  6547             20  ELCRTO-CERT-SFX     PIC X.
  6548         16  ELCRTO-RECORD-TYPE      PIC X.
  6549         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6550
  6551
  6552     12  WS-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 119
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6553         16  FILLER               PIC XX    VALUE SPACES.
  6554         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6555
  6556     12  WS-CARR-ACCESS.
  6557         16  FILLER               PIC X(3)  VALUE SPACES.
  6558         16  WS-CARR              PIC X     VALUE SPACE.
  6559*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6560*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6561     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6562         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6563         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6564         88  WS-DMD-NO-RATING   VALUE 'N'.
  6565
  6566
  6567     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6568         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6569                                         'NJ' 'NL'
  6570                                         'PJ' 'PL'
  6571                                         'SJ' 'SL'.
  6572     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6573         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6574                                         'NI' 'NJ' 'NL' 'NU'
  6575                                         'PJ' 'PL' 'PI' 'PU'
  6576                                         'SI' 'SJ' 'SL' 'SU'
  6577                                         'MX' 'MY' 'MZ'.
  6578
  6579 01  ERPDEF-KEY-SAVE             PIC X(18).
  6580 01  ERPDEF-KEY.
  6581     12  ERPDEF-COMPANY-CD       PIC X.
  6582     12  ERPDEF-STATE            PIC XX.
  6583     12  ERPDEF-PROD-CD          PIC XXX.
  6584     12  F                       PIC X(7).
  6585     12  ERPDEF-BEN-TYPE         PIC X.
  6586     12  ERPDEF-BEN-CODE         PIC XX.
  6587     12  ERPDEF-EXP-DT           PIC XX.
  6588
  6589 01  ELSTAT-KEY-SAVE             PIC X(20).
  6590 01  ELSTAT-KEY.
  6591     12  ELSTAT-COMPANY-ID       PIC XXX.
  6592     12  ELSTAT-CARRIER          PIC X.
  6593     12  ELSTAT-GROUP            PIC X(6).
  6594     12  ELSTAT-STATE            PIC XX.
  6595     12  ELSTAT-EXP-DT           PIC 9(8).
  6596
  6597 01  WS-ERROR-VALUES.
  6598     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6599     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6600     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6601     12  ER-1891                     PIC S9(4)   VALUE +1891.
  6602     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6603     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6604     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6605     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6606     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6607     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6608     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6609     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6610     12  ER-1900                     PIC S9(4)   VALUE +1900.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 120
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6611     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6612     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6613     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6614     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6615     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6616     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6617     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6618     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6619     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6620     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6621     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6622     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6623     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6624     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6625     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6626     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6627     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6628     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6629     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6630     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6631     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6632     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6633     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6634     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6635     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6636     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6637     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6638     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6639     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6640     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6641     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6642     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6643     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6644     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6645     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6646     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6647     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6648     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6649     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6650     12  ER-2612                     PIC S9(4)   VALUE +2612.
  6651     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6652     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6653     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6654     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6655     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6656     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6657     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6658     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6659     12  ER-2621                     PIC S9(4)   VALUE +2621.
  6660     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6661     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6662     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6663     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6664     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6665     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6666     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6667     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6668     12  ER-2630                     PIC S9(4)   VALUE +2630.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 121
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6669     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6670     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6671     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6672     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6673     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6674     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6675     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6676     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6677     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6678     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6679     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6680     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6681     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6682     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6683     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6684     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6685     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6686     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6687     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6688     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6689     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6690     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6691     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6692     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6693     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6694     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6695     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6696     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6697     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6698     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6699     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6700     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6701     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6702     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6703     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6704     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6705     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6706     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6707     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6708     12  ER-2670                     PIC S9(4)   VALUE +2670.
  6709     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6710     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6711     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6712     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6713     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6714     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6715     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6716     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6717     12  ER-2679                     PIC S9(4)   VALUE +2679.
  6718     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6719     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6720     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6721     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6722     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6723     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6724     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6725     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6726     12  ER-2688                     PIC S9(4)   VALUE +2688.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 122
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6727     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6728     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6729     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6730     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6731     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6732     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6733     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6734     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6735     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6736     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6737     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6738     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6739     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6740     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6741     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6742     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6743     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6744     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6745     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6746     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6747     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6748     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6749     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6750     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6751     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6752     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6753     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6754     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6755     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6756     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6757     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6758     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6759     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6760     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6761     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6762     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6763     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6764     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6765     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6766     12  ER-2738                     PIC S9(4)   VALUE +2738.
  6767     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6768     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6769     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6770     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6771     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6772     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6773     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6774     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6775     12  ER-2747                     PIC S9(4)   VALUE +2747.
  6776     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6777     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6778     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6779     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6780     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6781     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6782     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6783     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6784     12  ER-2756                     PIC S9(4)   VALUE +2756.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 123
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6785     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6786     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6787     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6788     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6789     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6790     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6791     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6792     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6793     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6794     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6795     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6796     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6797     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6798     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6799     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6800     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6801     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6802     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6803     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6804     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6805     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6806     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6807     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6808     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6809     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6810     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6811     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6812     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6813     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6814     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6815     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6816     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6817     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6818     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6819     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6820     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6821     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6822     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6823     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6824     12  ER-2879                     PIC S9(4)   VALUE +2879.
  6825     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6826     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6827     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6828     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6829     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6830     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6831     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6832     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6833     12  ER-2889                     PIC S9(4)   VALUE +2889.
  6834     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6835     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6836     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6837     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6838     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6839     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6840     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6841     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6842     12  ER-3050                     PIC S9(4)   VALUE +3050.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 124
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6843     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6844     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6845     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6846     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6847     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6848     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6849     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6850     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6851     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6852     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6853     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6854     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6855     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6856     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6857     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6858     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6859     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6860     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6861     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6862     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6863     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6864     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6865     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6866     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6867     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6868     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6869     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6870     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6871     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6872     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6873     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6874     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6875     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6876     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6877     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6878     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6879     12  ER-8067                     PIC S9(4)   VALUE +8067.
  6880     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6881     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6882     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6883     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6884     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6885     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6886     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6887     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6888     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6889     12  ER-8078                     PIC S9(4)   VALUE +8078.
  6890     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6891     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6892     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6893     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6894     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6895     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6896     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6897     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6898     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6899     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6900     12  ER-8089                     PIC S9(4)   VALUE +8089.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 125
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6901     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6902     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6903     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6904     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6905     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6906     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6907     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6908     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6909     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6910     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6911     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6912     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6913     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6914     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6915     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6916     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6917     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6918     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6919     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6920     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6921     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6922     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6923     12  ER-8303                     PIC S9(4)   VALUE +8303.
  6924     12  ER-8304                     PIC S9(4)   VALUE +8304.
  6925     12  ER-8310                     PIC S9(4)   VALUE +8310.
  6926     12  ER-8311                     PIC S9(4)   VALUE +8311.
  6927     12  ER-8312                     PIC S9(4)   VALUE +8312.
  6928     12  ER-8313                     PIC S9(4)   VALUE +8313.
  6929     12  ER-8314                     PIC S9(4)   VALUE +8314.
  6930     12  ER-8315                     PIC S9(4)   VALUE +8315.
  6931     12  ER-8316                     PIC S9(4)   VALUE +8316.
  6932     12  ER-8317                     PIC S9(4)   VALUE +8317.
  6933     12  ER-9236                     PIC S9(4)   VALUE +9236.
  6934     12  ER-9501                     PIC S9(4)   VALUE +9501.
  6935     12  ER-9503                     PIC S9(4)   VALUE +9503.
  6936     12  ER-9263                     PIC S9(4)   VALUE +9263.
  6937     12  ER-9999                     PIC S9(4)   VALUE +9999.
  6938******************************************************************
  6939***************   END OF ELC50WS     ****************************
  6940******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 126
* EL517.cbl
  6942 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 127
* EL517.cbl
  6944*DLB001
  6945 01  WS-DLB-MASTER-POLICY-FORM.
  6946     12  DMPF-PROCESS-TYPE         PIC X.
  6947         88  DMPF-OPEN-FILES                   VALUE 'O'.
  6948         88  DMPF-REG-PROCESS                  VALUE 'P'.
  6949         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  6950     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  6951     12  DMPF-RETURN-CODE          PIC XX.
  6952         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  6953         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  6954         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  6955         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  6956         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  6957         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  6958         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  6959
  6960*DLB002
  6961 01  WS-DLB-INTERNAL-POLICY-FORM.
  6962     12  DIPF-PROCESS-TYPE         PIC X.
  6963         88  DIPF-OPEN-FILES                   VALUE 'O'.
  6964         88  DIPF-REG-PROCESS                  VALUE 'P'.
  6965         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  6966     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  6967     12  DIPF-RETURN-CODE          PIC XX.
  6968         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  6969         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  6970         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  6971         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  6972         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  6973         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  6974         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  6975
  6976*DLB003
  6977 01  WS-DLB-VALID-BANK-ID.
  6978     12  DVBI-PROCESS-TYPE         PIC X.
  6979         88  DVBI-OPEN-FILES                   VALUE 'O'.
  6980         88  DVBI-REG-PROCESS                  VALUE 'P'.
  6981         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  6982     12  DVBI-BANK-ID              PIC X(5).
  6983     12  DVBI-BANK-ID-TYPE         PIC X.
  6984         88  DVBI-BILLING-BANK                 VALUE 'B'.
  6985         88  DVBI-PLAN-BANK                    VALUE 'P'.
  6986         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  6987         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  6988         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  6989     12  DVBI-RETURN-CODE          PIC XX.
  6990         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  6991         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  6992         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  6993         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  6994         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  6995         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  6996         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  6997         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  6998         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  6999         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7000
  7001*DLB007
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 128
* EL517.cbl
  7002 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7003     12  DCUA-PROCESS-TYPE         PIC X.
  7004         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7005         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7006         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7007     12  DCUA-RES-STATE            PIC XX.
  7008     12  DCUA-BEN-TYPE             PIC XX.
  7009     12  DCUA-SYS-IDENT            PIC X.
  7010         88  DCUA-CLAIM                        VALUE 'C'.
  7011         88  DCUA-PREMIUM                      VALUE 'P'.
  7012     12  DCUA-COVERAGE-RULE        PIC X.
  7013     12  DCUA-CLIENT-ID            PIC X(10).
  7014     12  DCUA-EFF-DATE             PIC X(8).
  7015     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7016     12  DCUA-RETURN-CODE          PIC XX.
  7017         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7018         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7019         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7020     12  DCUA-CERT-NUMBER          PIC X(11).
  7021     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7022     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7023
  7024*DLB011
  7025 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7026     12  DPRB-PROCESS-TYPE         PIC X.
  7027         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7028         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7029         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7030     12  DPRB-RATE-CODE            PIC X(4).
  7031     12  DPRB-COVERAGE-CATEG       PIC X.
  7032     12  DPRB-RETURN-CODE          PIC XX.
  7033         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7034         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7035         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7036         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7037         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7038         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7039         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7040         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7041     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7042     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7043     12  DPRB-BEN-TYPE             PIC XX.
  7044
  7045*DLB017
  7046 01  WS-DLB-VALID-RATE-CODE.
  7047     12  DVRC-PROCESS-TYPE         PIC X.
  7048         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7049         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7050         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7051     12  DVRC-RATE-CODE            PIC X(4).
  7052     12  DVRC-RETURN-CODE          PIC XX.
  7053         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7054         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7055         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7056         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7057         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7058         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7059         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 129
* EL517.cbl
  7060
  7061*DLB019
  7062 01  WS-DLB-ORIG-COV-CAT.
  7063     12  DOCC-PROCESS-TYPE         PIC X.
  7064         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7065         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7066         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7067     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7068     12  DOCC-RETURN-CODE          PIC XX.
  7069     12  DOCC-ORIG-COV-CAT         PIC X.
  7070     12  DOCC-UNDERWRITER          PIC XX.
  7071     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7072     12  DOCC-CREDIT-IND           PIC X.
  7073     12  DOCC-PRODUCT-CD           PIC XX.
  7074     12  DOCC-TERM                 PIC XXX.
  7075
  7076*DLB021
  7077 01  WS-DLB-VALID-LOAN-OFFICER.
  7078     12  DVLO-LOAN-OFFICER         PIC X(3).
  7079     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7080         16  DVLO-BILL-TYPE        PIC X.
  7081         16  DVLO-BILL-SOURCE      PIC X.
  7082         16  DVLO-BATCH-TYPE       PIC X.
  7083     12  DVLO-RETURN-CODE          PIC XX.
  7084         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7085         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7086         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7087         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7088         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7089         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7090
  7091*DLB022
  7092 01  WS-DLB-VALID-STATE-CODE.
  7093     12  DVSC-PROCESS-TYPE         PIC X.
  7094         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7095         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7096         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7097     12  DVSC-STATE-CODE           PIC XX.
  7098     12  DVSC-RETURN-CODE          PIC XX.
  7099         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7100         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7101         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7102         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7103         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7104         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7105         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7106
  7107*DLB023
  7108 01  WS-DLB-VALID-CODE-VALUES.
  7109     12  DVCV-PROCESS-TYPE         PIC X.
  7110         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7111         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7112         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7113     12  DVCV-SYSTEM-ID            PIC XX.
  7114         88  DVCV-CLAIMS                       VALUE 'CL'.
  7115         88  DVCV-CREDIT                       VALUE 'CR'.
  7116     12  DVCV-RECORD-TYPE          PIC XX.
  7117         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 130
* EL517.cbl
  7118         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7119         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7120         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7121         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7122         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7123         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7124         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7125     12  DVCV-RECORD-KEY           PIC X(6).
  7126     12  DVCV-RETURN-CODE          PIC XX.
  7127         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7128         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7129         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7130         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7131         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7132         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7133         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7134         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7135         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7136         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7137     12  DVCV-CODE-DESC            PIC X(60).
  7138     12  DVCV-GEN-DESC-1           PIC X(20).
  7139     12  DVCV-GEN-DESC-2           PIC X(20).
  7140     12  DVCV-GEN-DESC-3           PIC X(20).
  7141
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 131
* EL517.cbl
  7143
  7144 01  PARMLIST.
  7145     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7146     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7147     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7148**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7149**
  7150**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7151     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7152
  7153 01  PLAN-RECORDS.
  7154     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7155     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7156
* 7157                                  COPY ELCDATE.
  7158******************************************************************06/11/98
  7159*                                                                *ELCDATE
  7160*                                                                *ELCDATE
  7161*                            ELCDATE.                            *   LV023
  7162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7163*                            VMOD=2.003                           ELCDATE
  7164*                                                                *ELCDATE
  7165*                                                                *ELCDATE
  7166*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7167*                 LENGTH = 200                                   *   CL*19
  7168******************************************************************ELCDATE
  7169                                                                  ELCDATE
  7170 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7171     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7172     12  DC-OPTION-CODE                PIC X.                        CL*15
  7173         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7174         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7175         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7176         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7177         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7178         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7179         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7180         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7181         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7182         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7183         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7184         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7185         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7186         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7187         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7188         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7189         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7190         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7191         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7192         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7193         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7194         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7195         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7196         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7197         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7198         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7199         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7200         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 132
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7201         88  THREE-CHARACTER-BIN                                  ELCDATE
  7202                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7203         88  GREGORIAN-TO-BIN                                        CL**2
  7204                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7205         88  BIN-TO-GREGORIAN                                        CL**2
  7206                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7207         88  JULIAN-TO-BINARY                                        CL**2
  7208                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7209     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7210         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7211         88  DATE-CONVERSION-ERROR                                ELCDATE
  7212                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7213         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7214         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7215         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7216         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7217         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7218         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7219         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7220         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7221         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7222         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7223     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7224         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7225     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7226         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7227         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7228         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7229     12  FILLER                        PIC X.                        CL*15
  7230     12  DC-CONVERSION-DATES.                                        CL*15
  7231         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7232         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7233         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7234         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7235                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7236             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7237             20  SLASH1-1              PIC X.                        CL*15
  7238             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7239             20  SLASH1-2              PIC X.                        CL*15
  7240             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7241         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7242         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7243                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7244             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7245             20  SLASH2-1              PIC X.                        CL*15
  7246             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7247             20  SLASH2-2              PIC X.                        CL*15
  7248             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7249         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7250         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7251                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7252             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7253             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7254             20  DC-YMD-DAY            PIC 99.                       CL*15
  7255         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7256         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7257                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7258             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 133
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7259             20  DC-MDY-DAY            PIC 99.                       CL*15
  7260             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7261         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7262             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7263             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7264             20  FILLER                PIC XX.                       CL*15
  7265             20  DC-ALPHA-CENTURY.                                   CL*15
  7266                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7267             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7268         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7269         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7270         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7271         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7272         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7273                                       PIC 9(05).                    CL*20
  7274         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7275             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7276             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7277         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7278         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7279         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7280     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7281         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7282         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7283             20  FILLER                PIC 9(3).                     CL*15
  7284             20  HOLD-CEN-1-CCYY.                                    CL*15
  7285                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7286                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7287             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7288             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7289         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7290             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7291             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7292             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7293                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7294                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7295             20  FILLER                PIC 9(3).                     CL*15
  7296         16  HOLD-CENTURY-1-X.                                       CL*15
  7297             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7298             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7299                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7300                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7301             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7302             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7303         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7304             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7305             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7306             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7307                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7308                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7309             20  FILLER                PIC XXX.                      CL*23
  7310         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7311         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7312         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7313         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7314             20  DC-JULIAN-1-CCYY.                                   CL*15
  7315                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7316                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7317             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7318         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7319         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7320             20  DC-JULIAN-2-CCYY.                                   CL*15
  7321                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7322                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7323             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7324         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7325             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7326             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7327             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7328             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7329             20  DC-EDITA-CCYY.                                      CL*15
  7330                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7331                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7332         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7333             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7334             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7335             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7336             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7337             20  DC-EDITB-CCYY.                                      CL*15
  7338                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7339                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7340         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7341         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7342                              DC-GREG-DATE-CYMD.                  ELCDATE
  7343             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7344             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7345             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7346             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7347         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7348         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7349                              DC-GREG-DATE-MDCY.                  ELCDATE
  7350             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7351             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7352             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7353             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7354    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7355        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7356    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7357    12  FILLER                         PIC X(28).                    CL*26
  7358
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 135
* EL517.cbl
* 7360                                  COPY ELCCALC.
  7361******************************************************************04/15/98
  7362*                                                                *ELCCALC
  7363*                           ELCCALC.                            *    LV003
  7364*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7365*                            VMOD=2.025                          *   CL**3
  7366*                                                                *   CL**2
  7367*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7368*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7369*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7370*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7371*                                                                *   CL**2
  7372*  PASSED TO ELRTRM                                              *   CL**2
  7373*  -----------------                                             *   CL**2
  7374*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7375*  ORIGINAL TERM                                                 *   CL**2
  7376*  BEGINNING DATE                                                *   CL**2
  7377*  ENDING DATE                                                   *   CL**2
  7378*  COMPANY I.D.                                                  *   CL**2
  7379*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7380*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7381*  FREE LOOK DAYS                                                *   CL**2
  7382*                                                                *   CL**2
  7383*  RETURNED FROM ELRTRM                                          *   CL**2
  7384*  ---------------------                                         *   CL**2
  7385*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7386*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7387*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7388*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7389*----------------------------------------------------------------*   CL**2
  7390*  PASSED TO ELRAMT                                              *   CL**2
  7391*  ----------------                                              *   CL**2
  7392*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7393*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7394*  ORIGINAL AMOUNT                                               *   CL**2
  7395*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7396*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7397*  METHOD                                                            CL**2
  7398*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7399*  COMPANY I.D.                                                  *   CL**2
  7400*  BENEFIT TYPE                                                  *   CL**2
  7401*                                                                *   CL**2
  7402*  RETURNED FROM ELRAMT                                          *   CL**2
  7403*  --------------------                                          *   CL**2
  7404*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7405*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7406*  REMAINING AMOUNT FACTOR                                           CL**2
  7407*----------------------------------------------------------------*   CL**2
  7408*  PASSED TO ELRESV                                              *   CL**2
  7409*  -----------------                                             *   CL**2
  7410*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7411*  VALUATION DATE                                                *   CL**2
  7412*  PAID THRU DATE                                                *   CL**2
  7413*  BENEFIT                                                       *   CL**2
  7414*  INCURRED DATE                                                 *   CL**2
  7415*  REPORTED DATE                                                 *   CL**2
  7416*  ISSUE AGE                                                     *   CL**2
  7417*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7418*  CDT PERCENT                                                   *   CL**2
  7419*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7420* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7421* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7422* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7423*                                                                *   CL**2
  7424*  RETURNED FROM ELRESV                                          *   CL**2
  7425*  --------------------                                          *   CL**2
  7426*  CDT TABLE USED                                                *   CL**2
  7427*  CDT FACTOR USED                                               *   CL**2
  7428*  PAY TO CURRENT RESERVE                                        *   CL**2
  7429*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7430*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7431*----------------------------------------------------------------*   CL**2
  7432*  PASSED TO ELRATE                                              *   CL**2
  7433*  ----------------                                              *   CL**2
  7434*  CERT ISSUE DATE                                               *   CL**2
  7435*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7436*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7437*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7438*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7439*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7440*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7441*  DEVIATION CODE                                                *   CL**2
  7442*  ISSUE AGE                                                     *   CL**2
  7443*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7444*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7445*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7446*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7447*  A.P.R.                                                        *   CL**2
  7448*  METHOD                                                            CL**2
  7449*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7450*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7451*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7452*  BENEFIT CODE                                                  *   CL**2
  7453*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7454*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7455*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7456*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7457*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7458*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7459*                                                                *   CL**2
  7460*  RETURNED FROM ELRATE                                          *   CL**2
  7461*  --------------------                                          *   CL**2
  7462*  CALCULATED PREMIUM                                            *   CL**2
  7463*  PREMIUM RATE                                                  *   CL**2
  7464*  MORTALITY CODE                                                *   CL**2
  7465*  MAX ATTAINED AGE                                              *   CL**2
  7466*  MAX AGE                                                       *   CL**2
  7467*  MAX TERM                                                      *   CL**2
  7468*  MAX MONTHLY BENEFIT                                           *   CL**2
  7469*  MAX TOTAL BENIFIT                                             *   CL**2
  7470*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7471*----------------------------------------------------------------*   CL**2
  7472*  PASSED TO ELRFND                                              *   CL**2
  7473*  ----------------                                              *   CL**2
  7474*  CERT ISSUE DATE                                               *   CL**2
  7475*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 137
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7476*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7477*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7478*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7479*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7480*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7481*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7482*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7483*  DEVIATION CODE                                                *   CL**2
  7484*  ISSUE AGE                                                     *   CL**2
  7485*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7486*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7487*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7488*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7489*  A.P.R.                                                        *   CL**2
  7490*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7491*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7492*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7493*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7494*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7495*  BENEFIT CODE                                                  *   CL**2
  7496*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7497*                                                                *   CL**2
  7498*  RETURNED FROM ELRFND                                          *   CL**2
  7499*  --------------------                                          *   CL**2
  7500*  CALCULATED REFUND                                             *   CL**2
  7501*----------------------------------------------------------------*   CL**2
  7502*  PASSED TO ELEARN                                              *   CL**2
  7503*  ----------------                                              *   CL**2
  7504*  CERT ISSUE DATE                                               *   CL**2
  7505*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7506*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7507*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7508*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7509*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7510*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7511*  DEVIATION CODE                                                *   CL**2
  7512*  ISSUE AGE                                                     *   CL**2
  7513*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7514*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7515*  A.P.R.                                                        *   CL**2
  7516*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7517*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7518*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7519*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7520*  BENEFIT CODE                                                  *   CL**2
  7521*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7522*                                                                *   CL**2
  7523*  RETURNED FROM ELEARN                                          *   CL**2
  7524*  --------------------                                          *   CL**2
  7525*  INDICATED  EARNINGS                                           *   CL**2
  7526*----------------------------------------------------------------*   CL**2
  7527*                 LENGTH = 450                                   *   CL**2
  7528*                                                                *   CL**2
  7529******************************************************************   CL**2
  7530******************************************************************
  7531*                   C H A N G E   L O G
  7532*
  7533* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7534*-----------------------------------------------------------------
  7535*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7536* EFFECTIVE    NUMBER
  7537*-----------------------------------------------------------------
  7538* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7539* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7540* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7541* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7542* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7543* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7544* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7545* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7546* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7547******************************************************************
  7548                                                                     CL**2
  7549 01  CALCULATION-PASS-AREA.                                          CL**2
  7550     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7551                                     COMP.                           CL**2
  7552                                                                     CL**2
  7553     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7554       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7555       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7556                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7557       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7558       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7559       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7560       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7561       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7562       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7563       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7564       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7565       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7566       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7567       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7568       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7569       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7570       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7571       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7572       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7573       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7574                                                                     CL**2
  7575     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7576       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7577***********************  INPUT AREAS ****************************    CL**2
  7578                                                                     CL**2
  7579     12  CP-CALCULATION-AREA.                                        CL**2
  7580         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7581         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7582         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7583         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7584         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7585           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7586                                                   'I' 'U'.          CL**2
  7587           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7588           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7589         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7590         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7591         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7592         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7593         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7594                                     COMP-3.                         CL**2
  7595         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7596                                     COMP-3.                         CL**2
  7597         16  CP-CDT-METHOD         PIC X.                            CL**2
  7598           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7599           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7600           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7601         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7602           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7603           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7604         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7605                                     COMP-3.                         CL**2
  7606         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7607                                     COMP-3.                         CL**2
  7608         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7609                                     COMP-3.                         CL**2
  7610         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7611                                     COMP-3.                         CL**2
  7612         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7613                                     COMP-3.                         CL**2
  7614         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7615                                     COMP-3.                         CL**2
  7616         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7617                                     COMP-3.                         CL**2
  7618         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7619           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7620           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7621           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7622           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7623           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7624           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7625           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7626         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7627           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7628           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7629           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7630           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7631           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7632           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7633           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7634           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7635           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7636           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7637           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7638           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7639           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7640           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7641         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7642           88  CP-CLAIM                            VALUE '1'.        CL**2
  7643           88  CP-CANCEL                           VALUE '2'.        CL**2
  7644           88  CP-ISSUE                            VALUE '3'.        CL**2
  7645         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7646           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7647           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7648           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7649           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7650           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7651           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7652           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7653           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7654           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7655           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7656           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7657           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7658           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7659           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7660           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7661           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7662           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7663           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7664                                                     'W' 'X'.        CL**2
  7665           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7666           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7667           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7668           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7669           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7670           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7671           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7672           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7673           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7674           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7675           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7676           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7677           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7678                                                                     CL**2
  7679         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7680                                     COMP-3.                         CL**2
  7681         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7682         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7683         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7684         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7685         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7686           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7687               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7688         16  CP-R78-OPTION         PIC X.                            CL**2
  7689           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7690           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7691                                                                     CL**2
  7692         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7693         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7694         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7695         16  CP-RATE-FILE          PIC X.                            CL**2
  7696         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7697                                     COMP-3.                         CL**2
  7698                                                                     CL**2
  7699         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7700         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7701                                                                     CL**2
  7702         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7703                                     COMP-3.
  7704         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7705                                   PIC S9(5)V99 COMP-3.
  7706         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7707                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7708         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7709                                     COMP-3.                         CL**2
  7710         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7711                                     COMP-3.
  7712         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7713                                  PIC S9(7)V99 COMP-3.
  7714                                                                     CL**2
  7715         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7716         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7717         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7718           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7719           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7720           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7721           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7722         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7723         16  CP-CARRIER            PIC X.                            CL**2
  7724         16  CP-REIN-FLAG          PIC X.                            CL**2
  7725         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7726           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7727                      '2' '3' '4' '5'.                               CL**2
  7728           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7729           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7730           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7731           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7732           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7733           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7734           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7735           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7736         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7737         16  CP-RATING-METHOD      PIC X.                            CL**2
  7738           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7739           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7740           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7741           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7742           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7743           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7744           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7745           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7746           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7747         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7748                                     COMP-3.                         CL**2
  7749         16  CP-BEN-CATEGORY       PIC X.
  7750         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7751         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7752                                   PIC S99V9(5) COMP-3.
  7753         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7754         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7755                                   PIC S99V9(5) COMP-3.
  7756         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7757         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7758         16  CP-EXPIRE-DT          PIC XX.
  7759         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7760         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7761         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7762         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7763         16  CP-DDF-SPEC-CALC      PIC X.
  7764             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7765             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7766         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7767         16  CP-CANCEL-REASON      PIC X.
  7768         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7769         16  CP-PMT-MODE           PIC X.
  7770         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7771         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7772         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7773         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7774         16  FILLER                PIC X.
  7775                                                                     CL**2
  7776***************    OUTPUT FROM ELRESV   ************************     CL**2
  7777                                                                     CL**2
  7778         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7779                                                                     CL**2
  7780         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7781                                     COMP-3.                         CL**2
  7782         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7783                                     COMP-3.                         CL**2
  7784         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7785                                     COMP-3.                         CL**2
  7786         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7787                                     COMP-3.                         CL**2
  7788         16  FILLER                PIC X(09).                        CL**2
  7789***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7790                                                                     CL**2
  7791         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7792                                     COMP-3.                         CL**2
  7793         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7794                                     COMP-3.                         CL**2
  7795         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7796                                     COMP-3.                         CL**2
  7797         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7798                                     COMP-3.                         CL**2
  7799         16  FILLER                PIC X(12).                        CL**2
  7800                                                                     CL**2
  7801***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7802                                                                     CL**2
  7803         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7804                                     COMP-3.                         CL**2
  7805         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7806                                     COMP-3.                         CL**2
  7807         16  FILLER                PIC X(12).                        CL**2
  7808                                                                     CL**2
  7809***************    OUTPUT FROM ELRATE   *************************    CL**2
  7810                                                                     CL**2
  7811         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7812                                     COMP-3.                         CL**2
  7813         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7814                                     COMP-3.                         CL**2
  7815         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7816         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7817             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7818         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7819                                     COMP-3.                         CL**2
  7820         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7821         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7822         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7823                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7824         16  FILLER                PIC X(07).                        CL**2
  7825                                                                     CL**2
  7826***************    OUTPUT FROM ELRFND   *************************    CL**2
  7827                                                                     CL**2
  7828         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7829                                     COMP-3.                         CL**2
  7830         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7831           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7832           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7833           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7834           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7835           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7836           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7837           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7838           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7839           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7840           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7841           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7842           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7843           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7844           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7845         16  FILLER                PIC X(12).                        CL**2
  7846                                                                     CL**2
  7847***************    OUTPUT FROM ELEARN   *************************    CL**2
  7848                                                                     CL**2
  7849         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7850                                     COMP-3.                         CL**2
  7851         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7852                                     COMP-3.                         CL**2
  7853         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7854                                     COMP-3.                         CL**2
  7855         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7856                                     COMP-3.                         CL**2
  7857         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7858                                     COMP-3.                         CL**2
  7859         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7860                                     COMP-3.                         CL**2
  7861         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7862           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7863           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7864           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7865           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7866           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7867           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7868           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7869           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7870           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7871         16  FILLER                PIC X(12).                        CL**2
  7872                                                                     CL**2
  7873***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7874                                                                     CL**2
  7875         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7876                                     COMP-3.                         CL**2
  7877         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7878                                     COMP-3.                         CL**2
  7879         16  FILLER                PIC X(12).                        CL**2
  7880                                                                     CL**2
  7881***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7882         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7883                                     COMP-3.                         CL**2
  7884         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7885                                     COMP-3.                         CL**2
  7886         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7887                                     COMP-3.                         CL**2
  7888         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7889                                     COMP-3.                         CL**2
  7890         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7891                                     COMP-3.                         CL**2
  7892         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7893                                     COMP-3.                         CL**2
  7894         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7895             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7896             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7897             88  IO-ERROR                         VALUE 'E'.         CL**2
  7898                                                                     CL**2
  7899         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7900                                                                     CL**2
  7901         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7902                                                                     CL**2
  7903         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7904                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7905                                     COMP-3.                         CL**2
  7906                                                                     CL**2
  7907         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7908                                                                     CL**2
  7909         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7910                                     COMP-3.                         CL**2
  7911                                                                     CL**2
  7912         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7913                                     COMP-3.                         CL**2
  7914                                                                     CL**2
  7915         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7916                                     COMP-3.                         CL**2
  7917                                                                     CL**2
  7918         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7919                                     COMP-3.                         CL**2
  7920                                                                     CL**2
  7921         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7922                                     COMP-3.                         CL**2
  7923                                                                     CL**2
  7924         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  7925                                     COMP-3.                         CL**2
  7926                                                                     CL**2
  7927         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  7928                                     COMP-3.                         CL**2
  7929                                                                     CL**2
  7930         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  7931             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  7932                                                                     CL**2
  7933         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  7934                                     COMP-3.                         CL**2
  7935         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  7936                                     COMP-3.
  7937         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  7938         16  FILLER                PIC X(15).                        CL**2
  7939******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 145
* EL517.cbl
  7940
* 7941                                  COPY ELCDTECX.
  7942******************************************************************06/05/98
  7943*                                                                *ELCDTECX
  7944*                            ELCDTECX.                           *   LV005
  7945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7946*                            VMOD=2.015                          *ELCDTECX
  7947*                                                                *ELCDTECX
  7948*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  7949*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  7950*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  7951*                                                                *ELCDTECX
  7952******************************************************************ELCDTECX
  7953******************************************************************
  7954*                   C H A N G E   L O G
  7955*
  7956* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7957*-----------------------------------------------------------------
  7958*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7959* EFFECTIVE    NUMBER
  7960*-----------------------------------------------------------------
  7961* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  7962*                                  BENEFIT CODES FROM 300 TO 900
  7963* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  7964* 051304    2003080800002  SMVA  ADD REFUND METHOD
  7965******************************************************************
  7966 01  DATE-CARD.                                                   ELCDTECX
  7967     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  7968     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  7969     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  7970     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  7971     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  7972     12  EP-SW                       PIC  X.                      ELCDTECX
  7973         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  7974     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  7975         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  7976     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  7977     12  RUN-CENTURY.                                             ELCDTECX
  7978         16 RUN-CENTURY-N            PIC  99.                        CL**4
  7979     12  FILLER                      PIC  X.                         CL**4
  7980     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  7981     12  FILLER                      PIC  XXX.                    ELCDTECX
  7982     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  7983                                                                  ELCDTECX
  7984 01  FILLER                          PIC  X(7)                       CL**6
  7985                                          VALUE 'OPTIONS'.        ELCDTECX
  7986 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  7987     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  7988     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  7989     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  7990         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  7991         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  7992     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  7993     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  7994     12  FILLER                      PIC  X.                      ELCDTECX
  7995     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  7996     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  7997     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7998     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  7999     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8000     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8001     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8002     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8003     12  FILLER                      PIC  X.                      ELCDTECX
  8004     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8005     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8006     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8007     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8008     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8009     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8010     12  FILLER                      PIC  X.                      ELCDTECX
  8011     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8012     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8013     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8014     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8015     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8016     12  DTE-R78                     PIC  X.                      ELCDTECX
  8017     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8018     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8019     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8020     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8021     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8022     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8023     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8024                                     PIC  X.                      ELCDTECX
  8025         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8026                                                 ' '.             ELCDTECX
  8027         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8028         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8029     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8030         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8031         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8032     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8033     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8034                                     PIC  9.                         CL**4
  8035     12  DTE-SYSTEM.                                              ELCDTECX
  8036         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8037         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8038         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8039         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8040         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8041         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8042         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8043         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8044         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8045         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8046         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8047         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8048         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8049         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8050         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8051         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8052         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8053         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8054         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8055         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 147
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8056         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8057         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8058         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8059         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8060         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8061         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8062     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8063         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8064                                     PIC  X.                      ELCDTECX
  8065     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8066                                                                  ELCDTECX
  8067 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8068     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8069     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8070     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8071*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8072     12  FILLER                      PIC  X.                      ELCDTECX
  8073     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8074     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8075     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8076     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8077     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8078     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8079     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8080                                                                  ELCDTECX
  8081     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8082     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8083     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8084     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8085                                                                  ELCDTECX
  8086     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8087     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8088     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8089     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8090                                                                  ELCDTECX
  8091     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8092     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8093                                                                  ELCDTECX
  8094     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8095     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8096                                                                  ELCDTECX
  8097     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8098                                                                  ELCDTECX
  8099 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8100     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8101     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8102     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8103     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8104     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8105     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8106     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8107                                                                  ELCDTECX
  8108 01  FILLER                          PIC  X(12)                   ELCDTECX
  8109                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8110 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8111     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8112         16  CNT-ID                  PIC  X.                      ELCDTECX
  8113         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8114                                                                  ELCDTECX
  8115 01  FILLER                          PIC  X(11)                   ELCDTECX
  8116                                          VALUE 'STATE NAMES'.    ELCDTECX
  8117 01  STATE-NAMES.                                                 ELCDTECX
  8118     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8119         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8120         16  STATE-PIC1.                                          ELCDTECX
  8121             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8122             20  FILLER              PIC  XXX.                    ELCDTECX
  8123             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8124             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8125             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8126             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8127                                                                  ELCDTECX
  8128 01  FILLER                          PIC  X(13)                   ELCDTECX
  8129                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8130 01  CARRIER-NAMES.                                               ELCDTECX
  8131     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8132         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8133         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8134         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8135         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8136         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8137         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8138*        16  FILLER                  PIC  X.                      ELCDTECX
  8139         16  CARRIER-SEC-PAY         PIC  X.
  8140             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8141                                                                  ELCDTECX
  8142 01  FILLER                          PIC  X(9)                       CL**6
  8143                                          VALUE 'INS TYPES'.      ELCDTECX
  8144 01  CLAS-INS-TYPES.                                              ELCDTECX
  8145*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8146     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8147         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8148         16  CLAS-I-AB3.                                          ELCDTECX
  8149             20  FILLER              PIC  X.                      ELCDTECX
  8150             20  CLAS-I-AB2.                                      ELCDTECX
  8151                 24  FILLER          PIC  X.                      ELCDTECX
  8152                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8153         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8154             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8155             20  FILLER              PIC  X.                         CL**4
  8156         16  CLAS-I-AB10.                                         ELCDTECX
  8157             20  FILLER              PIC  X(9).                   ELCDTECX
  8158             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8159         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8160         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8161         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8162         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8163             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8164         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8165         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8166         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8167         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8168         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8169         16  FILLER                  PIC  X(05).
  8170                                                                  ELCDTECX
  8171 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8172                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8173 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8174     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8175                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8176         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8177         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8178         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8179         16  CLAS-MORT-DESC.                                      ELCDTECX
  8180             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8181             20  FILLER              PIC  XX.                        CL**5
  8182             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8183             20  FILLER              PIC  X.                         CL**5
  8184             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8185             20  FILLER              PIC  X.                         CL**5
  8186             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8187             20  FILLER              PIC  X.                         CL**5
  8188             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8189             20  FILLER              PIC  X(5).                      CL**6
  8190                                                                  ELCDTECX
  8191 01  FILLER                          PIC  X(15)                   ELCDTECX
  8192                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8193 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8194     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8195         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8196         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8197         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8198         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8199         16  FILLER                  PIC  X(4).                      CL**6
  8200                                                                  ELCDTECX
  8201 01  FILLER                          PIC  X(7)                       CL**6
  8202                                     VALUE 'INDEXES'.             ELCDTECX
  8203 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8204     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8205     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8206     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8207     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8208     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8209     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8210     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8211     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8212     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8213     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8214     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8215     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8216     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8217     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8218     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8219     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8220     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8221                                                                  ELCDTECX
  8222 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8223     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8224     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8225     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8226     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8227     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8228     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8229     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8230     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8231     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8232     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8233     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8234                                                                  ELCDTECX
  8235 01  FILLER                          PIC  X(13)                   ELCDTECX
  8236                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8237 01  CLAS-MISC.                                                   ELCDTECX
  8238     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8239         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8240         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8241         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8242     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8243     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8244     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8245     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8246     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8247     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8248     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8249     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8250     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8251     12  STATE-L                     PIC  XX.                     ELCDTECX
  8252     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8253     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8254     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8255         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8256         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8257     12  DTE-ABEND-WORK.                                          ELCDTECX
  8258         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8259         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8260                                                                  ELCDTECX
  8261 01  FILLER                          PIC  X(12)                   ELCDTECX
  8262                                     VALUE 'WORKING DATE'.        ELCDTECX
  8263 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8264     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8265         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8266         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8267         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8268     12  WS-CURRENT-DATE.                                         ELCDTECX
  8269         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8270         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8271         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8272         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8273         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8274     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8275         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8276         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8277                                                                  ELCDTECX
  8278 01  FILLER                          PIC  X(12)                   ELCDTECX
  8279                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8280 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8281     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8282         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8283         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8284         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8285                                                                  ELCDTECX
  8286 01  FILLER                          PIC  X(10)                   ELCDTECX
  8287                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8288 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8289     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8290         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8291         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8292                                                                  ELCDTECX
  8293 01  FILLER                          PIC  X(13)                   ELCDTECX
  8294                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8295 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8296     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8297         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8298                                                                  ELCDTECX
  8299 01  FILLER                          PIC  X(13)                   ELCDTECX
  8300                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8301 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8302     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8303     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8304     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8305                                     PIC  X.                         CL**5
  8306     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8307     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8308     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8309     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8310     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8311     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8312     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8313     12  FILLER                      PIC  X(75).                  ELCDTECX
  8314******************************************************************ELCDTECX
  8315*01  MISC-CARR-PCT-DATA.                                          00001521
  8316*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8317*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8318*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8319*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8320*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8321*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8322******************************************************************ELCDTECX
  8323
* 8324                                  COPY ELCDTEVR.
  8325***************************************************************** 04/15/98
  8326*                                                                *ELCDTEVR
  8327*                                                                *ELCDTEVR
  8328*                            ELCDTEVR.                           *   LV003
  8329*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8330*                            VMOD=2.001                          *   CL**2
  8331*                                                                *ELCDTEVR
  8332*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8333*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8334*                                                                *ELCDTEVR
  8335******************************************************************ELCDTEVR
  8336 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8337     05  WS-RUN-DATE.                                             ELCDTEVR
  8338         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8339         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8340         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8341             15  RUN-CC              PIC  99.                     ELCDTEVR
  8342             15  RUN-YR              PIC  99.                     ELCDTEVR
  8343         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8344         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8345     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8346            WS-RUN-DATE              PIC 9(11).                      CL**2
  8347     05  WS-EP-DT.                                                ELCDTEVR
  8348         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8349         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8350         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8351             15  EP-CC               PIC  99.                     ELCDTEVR
  8352             15  EP-YR               PIC  99.                     ELCDTEVR
  8353         10  EP-MO                   PIC  99.                     ELCDTEVR
  8354         10  EP-DA                   PIC  99.                     ELCDTEVR
  8355     05  WS-EP-DT-N REDEFINES                                        CL**2
  8356            WS-EP-DT                 PIC 9(11).                      CL**2
  8357     05  WS-DTE-CONV-DT.                                             CL**4
  8358         10  FILLER                  PIC  9(03).                     CL**4
  8359         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8360         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8361             15  DTE-CONV-CC         PIC  99.                        CL**4
  8362             15  DTE-CONV-YR         PIC  99.                        CL**4
  8363         10  DTE-CONV-MO             PIC  99.                        CL**4
  8364         10  DTE-CONV-DA             PIC  99.                        CL**4
  8365     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8366            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8367 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8368     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8369         10  FILLER                            PIC 999.           ELCDTEVR
  8370         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8371         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8372             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8373             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8374         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8375         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8376     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8377            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8378     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8379         10  FILLER                            PIC 999.           ELCDTEVR
  8380         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8381         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8382         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8383         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8384     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8385            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8386 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8387     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8388         10  FILLER                            PIC 999.           ELCDTEVR
  8389         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8390         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8391             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8392             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8393         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8394         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8395     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8396            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8397     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8398         10  FILLER                            PIC 999.           ELCDTEVR
  8399         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8400         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8401             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8402             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8403         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8404         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8405     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8406            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8407     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8408         10  FILLER                            PIC 999.           ELCDTEVR
  8409         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8410         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8411             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8412             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8413         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8414         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8415     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8416            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8417 01  WS-RATE-RECORD.                                              ELCDTEVR
  8418         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8419             10  FILLER                        PIC 999.           ELCDTEVR
  8420             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8421             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8422                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8423                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8424             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8425             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8426         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8427                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8428
* 8429                                  COPY ELCREINV.
  8430******************************************************************04/18/98
  8431*                                                                *ELCREINV
  8432*                                                                *ELCREINV
  8433*                            ELCREINV                            *   LV003
  8434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8435*                            VMOD=2.001                          *ELCREINV
  8436*                                                                *ELCREINV
  8437*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8438*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8439*                                                                *ELCREINV
  8440******************************************************************ELCREINV
  8441                                                                  ELCREINV
  8442 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8443     05  WS-RE-LO-DATE.                                              CL**3
  8444         10 FILLER                     PIC 999.                      CL**3
  8445         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8446         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8447            15 RE-LO-CC                PIC 99.                       CL**3
  8448            15 RE-LO-YR                PIC 99.                       CL**3
  8449         10 RE-LO-MO                   PIC 99.                       CL**3
  8450         10 RE-LO-DA                   PIC 99.                       CL**3
  8451     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8452            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8453     05  WS-RE-HI-DATE.                                              CL**3
  8454         10 FILLER                     PIC 999.                      CL**3
  8455         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8456         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8457            15 RE-HI-CC                PIC 99.                       CL**3
  8458            15 RE-HI-YR                PIC 99.                       CL**3
  8459         10 RE-HI-MO                   PIC 99.                       CL**3
  8460         10 RE-HI-DA                   PIC 99.                       CL**3
  8461     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8462            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8463     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8464         10 FILLER                     PIC 999.                   ELCREINV
  8465         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8466         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8467            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8468            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8469         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8470         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8471     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8472            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8473     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8474         10  FILLER                    PIC 999.                   ELCREINV
  8475         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8476         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8477             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8478             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8479         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8480         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8481     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8482            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8483     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8484         10  FILLER                    PIC 999.                   ELCREINV
  8485         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8486         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8487             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8488             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8489         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8490         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8491     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8492            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8493
* 8494                                  COPY ELCACCTV.
  8495******************************************************************04/14/98
  8496*                                                                *ELCACCTV
  8497*                            ELCACCTV                            *   LV002
  8498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8499*                            VMOD=2.001                          *ELCACCTV
  8500*                                                                *ELCACCTV
  8501*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8502*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8503*                                                                *ELCACCTV
  8504*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8505*                                                                *ELCACCTV
  8506******************************************************************ELCACCTV
  8507                                                                  ELCACCTV
  8508 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8509                                                                  ELCACCTV
  8510     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8511         10  FILLER            PIC 999.                           ELCACCTV
  8512         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8513         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8514             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8515             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8516         10  AM-EXP-MO         PIC 99.                               CL**5
  8517         10  AM-EXP-DA         PIC 99.                               CL**5
  8518     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8519            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8520     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8521         10  FILLER                    PIC 999.                   ELCACCTV
  8522         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8523         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8524             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8525             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8526         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8527         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8528     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8529            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8530     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8531         10  FILLER                    PIC 999.                   ELCACCTV
  8532         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8533         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8534             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8535             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8536         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8537         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8538     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8539            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8540     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8541         10 FILLER                     PIC 999.                   ELCACCTV
  8542         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8543         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8544            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8545            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8546         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8547         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8548     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8549            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8550     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8551         10 FILLER                     PIC 999.                   ELCACCTV
  8552         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8553         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8554            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8555            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8556         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8557         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8558     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8559            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8560     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8561         10  FILLER                    PIC 999.                   ELCACCTV
  8562         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8563         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8564             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8565             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8566         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8567         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8568     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8569            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8570     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8571         10  FILLER                    PIC 999.                   ELCACCTV
  8572         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8573         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8574             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8575             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8576         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8577         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8578     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8579            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8580     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8581         10  FILLER                    PIC 999.                   ELCACCTV
  8582         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8583         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8584             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8585             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8586         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8587         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8588     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8589            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8590     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8591         10  FILLER                    PIC 999.                   ELCACCTV
  8592         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8593         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8594             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8595             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8596         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8597         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8598     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8599            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 157
* EL517.cbl
* 8601                                  COPY ELCDIFRD.
  8602******************************************************************04/15/98
  8603*                                                                *ELCDIFRD
  8604*                                                                *ELCDIFRD
  8605*                            ELCDIFRD.                           *   LV003
  8606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8607*                            VMOD=2.004                          *   CL**3
  8608*                                                                *ELCDIFRD
  8609*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8610*                                                                *ELCDIFRD
  8611******************************************************************ELCDIFRD
  8612*                                                                 ELCDIFRD
  8613  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8614        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8615        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8616        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8617        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8618        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8619        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8620        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8621        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8622        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8623        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8624        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 158
* EL517.cbl
* 8626                                  COPY ELCERRWS.
  8627******************************************************************04/15/98
  8628*                                                                *ELCERRWS
  8629*                                                                *ELCERRWS
  8630*                            ELCERRWS                            *   LV002
  8631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8632*                            VMOD=2.005                          *   CL**2
  8633*                                                                *ELCERRWS
  8634*                                                                *ELCERRWS
  8635*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8636*                                                                *ELCERRWS
  8637******************************************************************ELCERRWS
  8638                                                                  ELCERRWS
  8639 01  W-ERROR-WORK.                                                ELCERRWS
  8640     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8641     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8642     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8643     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8644     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8645     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8646     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8647     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8648     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8649     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8650     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8651     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8652     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8653     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8654     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8655     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8656     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8657                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 159
* EL517.cbl
  8659
  8660 PROCEDURE DIVISION.
  8661
  8662 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8663******************************************************************04/15/98
  8664*                                                                *ELCDTERX
  8665*                                                                *ELCDTERX
  8666*                            ELCDTERX.                           *   LV002
  8667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8668*                            VMOD=2.007                          *ELCDTERX
  8669*                                                                *ELCDTERX
  8670*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8671*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8672*      = ELCDTEFD)                                               *ELCDTERX
  8673*                                                                *ELCDTERX
  8674******************************************************************ELCDTERX
  8675                                                                  ELCDTERX
  8676     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8677                                                                  ELCDTERX
  8678     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8679     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8680     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8681                                                                  ELCDTERX
  8682     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8683                                                                  ELCDTERX
  8684******************************************************************ELCDTERX
  8685*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8686*          WARNING MESSAGES.                                      ELCDTERX
  8687******************************************************************ELCDTERX
  8688     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8689         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8690                                                                  ELCDTERX
  8691     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8692                                                                  ELCDTERX
  8693     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8694                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8695                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8696                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8697                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8698                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8699                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8700                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8701                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8702                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8703                                                                  ELCDTERX
  8704     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8705                                                                  ELCDTERX
  8706     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8707                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8708                                                                  ELCDTERX
  8709     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8710     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8711     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8712     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8713                                                                  ELCDTERX
  8714     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8715         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 160
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8716     ELSE                                                         ELCDTERX
  8717         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8718                                                                  ELCDTERX
  8719     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8720         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8721     ELSE                                                         ELCDTERX
  8722         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8723                                                                  ELCDTERX
  8724 0005-READ--CARD.                                                 ELCDTERX
  8725     READ DISK-DATE                                               ELCDTERX
  8726         AT END CLOSE DISK-DATE                                   ELCDTERX
  8727             GO TO 0060-READ--TEST.                               ELCDTERX
  8728                                                                  ELCDTERX
  8729     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8730                                                                  ELCDTERX
  8731     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8732         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8733         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8734         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8735         GO TO 0005-READ--CARD.                                   ELCDTERX
  8736                                                                  ELCDTERX
  8737     IF DD-ID = 'CLAD'                                            ELCDTERX
  8738         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8739         GO TO 0005-READ--CARD.                                   ELCDTERX
  8740                                                                  ELCDTERX
  8741     IF DD-ID = 'CLAX'                                            ELCDTERX
  8742         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8743         GO TO 0005-READ--CARD.                                   ELCDTERX
  8744                                                                  ELCDTERX
  8745     IF DD-ID = 'CLAF'                                            ELCDTERX
  8746         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8747         GO TO 0005-READ--CARD.                                   ELCDTERX
  8748                                                                  ELCDTERX
  8749     IF DD-ID = 'CLAC'                                            ELCDTERX
  8750         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8751                                                                  ELCDTERX
  8752     IF DD-ID = 'CARR'                                            ELCDTERX
  8753         GO TO 0015-READ--CARR.                                   ELCDTERX
  8754                                                                  ELCDTERX
  8755     IF DD-ID = 'STAT'                                            ELCDTERX
  8756         GO TO 0020-READ--STAT.                                   ELCDTERX
  8757                                                                  ELCDTERX
  8758     IF DD-ID = 'BUSC'                                            ELCDTERX
  8759         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8760                                                                  ELCDTERX
  8761     IF DD-ID = 'MORT'                                            ELCDTERX
  8762         GO TO 0030-READ--MORT.                                   ELCDTERX
  8763                                                                  ELCDTERX
  8764     IF DD-ID = 'CLAI'                                            ELCDTERX
  8765         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8766                                                                  ELCDTERX
  8767     IF DD-ID = 'COLC'                                            ELCDTERX
  8768         GO TO 0065-READ--COLC.                                   ELCDTERX
  8769                                                                  ELCDTERX
  8770     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8771        DD-IDA = 'CL'                                             ELCDTERX
  8772         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8773                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 161
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8774     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8775        DD-IDA = 'PO'                                             ELCDTERX
  8776         GO TO 0050-READ--POXX.                                   ELCDTERX
  8777                                                                  ELCDTERX
  8778     IF DD-ID = 'OPCA'                                            ELCDTERX
  8779         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8780                                                                  ELCDTERX
  8781     IF DD-ID = 'OPST'                                            ELCDTERX
  8782         GO TO 0072-READ--OPST.                                   ELCDTERX
  8783                                                                  ELCDTERX
  8784     IF DD-ID = 'OPBS'                                            ELCDTERX
  8785         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8786                                                                  ELCDTERX
  8787     IF DD-ID = 'OPMS'                                            ELCDTERX
  8788         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8789                                                                  ELCDTERX
  8790     GO TO 0005-READ--CARD.                                       ELCDTERX
  8791                                                                  ELCDTERX
  8792 0010-READ--CLAC.                                                 ELCDTERX
  8793     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8794     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8795     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8796     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8797     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8798     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8799     GO TO 0005-READ--CARD.                                       ELCDTERX
  8800                                                                  ELCDTERX
  8801 0015-READ--CARR.                                                 ELCDTERX
  8802     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8803     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8804        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8805        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8806        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8807        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8808        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8809        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8810        MOVE DD-CARR1-SECPAY-SW
  8811                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8812     END-IF
  8813                                                                  ELCDTERX
  8814     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8815     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8816        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8817        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8818        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8819        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8820        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8821        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8822        MOVE DD-CARR2-SECPAY-SW
  8823                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8824     END-IF
  8825                                                                  ELCDTERX
  8826                                                                  ELCDTERX
  8827     GO TO 0005-READ--CARD.                                       ELCDTERX
  8828                                                                  ELCDTERX
  8829 0020-READ--STAT.                                                 ELCDTERX
  8830     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8831     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8832        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8833         GO TO 0005-READ--CARD.                                   ELCDTERX
  8834                                                                  ELCDTERX
  8835     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8836     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8837     GO TO 0020-READ--STAT.                                       ELCDTERX
  8838                                                                  ELCDTERX
  8839 0025-READ--BUSC.                                                 ELCDTERX
  8840     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8841     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8842        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8843         GO TO 0005-READ--CARD.                                   ELCDTERX
  8844                                                                  ELCDTERX
  8845     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8846     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8847     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8848                                                                  ELCDTERX
  8849 0030-READ--MORT.                                                 ELCDTERX
  8850     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8851     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8852        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8853         GO TO 0005-READ--CARD.                                   ELCDTERX
  8854                                                                  ELCDTERX
  8855     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8856     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8857     GO TO 0030-READ--MORT.                                       ELCDTERX
  8858                                                                  ELCDTERX
  8859 0035-READ--CLXX.                                                 ELCDTERX
  8860     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8861          GO TO 0005-READ--CARD.                                  ELCDTERX
  8862                                                                  ELCDTERX
  8863     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8864         DISPLAY '***********************************************'ELCDTERX
  8865         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8866         DISPLAY '***********************************************'ELCDTERX
  8867         GO TO 0055-READ--STOP.                                   ELCDTERX
  8868                                                                  ELCDTERX
  8869     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8870        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8871         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8872                                                                  ELCDTERX
  8873     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8874        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8875         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8876                                                                  ELCDTERX
  8877*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8878     GO TO 0005-READ--CARD.                                       ELCDTERX
  8879                                                                  ELCDTERX
  8880 0040-READ--CLAI.                                                 ELCDTERX
  8881     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8882     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8883        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8884         GO TO 0005-READ--CARD.                                   ELCDTERX
  8885                                                                  ELCDTERX
  8886     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8887     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8888     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8889                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8890 0045-READ--DUMP.                                                 ELCDTERX
  8891     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8892     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8893                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8894     PERFORM ABEND-PGM.                                           ELCDTERX
  8895                                                                  ELCDTERX
  8896 0050-READ--POXX.                                                 ELCDTERX
  8897     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8898         GO TO 0005-READ--CARD.                                   ELCDTERX
  8899                                                                  ELCDTERX
  8900     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8901         DISPLAY '***********************************************'ELCDTERX
  8902         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8903         DISPLAY '***********************************************'ELCDTERX
  8904         GO TO 0055-READ--STOP.                                   ELCDTERX
  8905                                                                  ELCDTERX
  8906     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8907     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8908     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8909     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8910                                                                  ELCDTERX
  8911     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8912         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8913     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8914         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8915                                                                  ELCDTERX
  8916     GO TO 0005-READ--CARD.                                       ELCDTERX
  8917                                                                  ELCDTERX
  8918 0055-READ--STOP.                                                 ELCDTERX
  8919     GOBACK.                                                      ELCDTERX
  8920                                                                  ELCDTERX
  8921 0060-READ--TEST.                                                 ELCDTERX
  8922     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8923        CLAX-ID         = SPACE  OR                               ELCDTERX
  8924        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  8925         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8926                                                                  ELCDTERX
  8927     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  8928     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8929                                                                  ELCDTERX
  8930 0065-READ--COLC.                                                 ELCDTERX
  8931     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8932     GO TO 0005-READ--CARD.                                       ELCDTERX
  8933                                                                  ELCDTERX
  8934 0070-READ--OPCA.                                                 ELCDTERX
  8935                                                                  ELCDTERX
  8936     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8937                                                                  ELCDTERX
  8938     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8939             OR                                                   ELCDTERX
  8940         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8941         GO TO 0005-READ--CARD.                                   ELCDTERX
  8942                                                                  ELCDTERX
  8943     ADD 1                       TO INDEXCA.                      ELCDTERX
  8944     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8945                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8946     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8947                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8948 0072-READ--OPST.                                                 ELCDTERX
  8949                                                                  ELCDTERX
  8950     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8951                                                                  ELCDTERX
  8952     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8953             OR                                                   ELCDTERX
  8954         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8955         GO TO 0005-READ--CARD.                                   ELCDTERX
  8956                                                                  ELCDTERX
  8957     ADD 1                       TO INDEXST.                      ELCDTERX
  8958     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8959                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8960     GO TO 0072-READ--OPST.                                       ELCDTERX
  8961                                                                  ELCDTERX
  8962 0074-READ--OPBS.                                                 ELCDTERX
  8963                                                                  ELCDTERX
  8964     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8965                                                                  ELCDTERX
  8966     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8967             OR                                                   ELCDTERX
  8968         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8969         GO TO 0005-READ--CARD.                                   ELCDTERX
  8970                                                                  ELCDTERX
  8971     ADD 1                       TO INDEXBS.                      ELCDTERX
  8972     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8973     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8974                                                                  ELCDTERX
  8975 0079-READ--EXIT.                                                 ELCDTERX
  8976*    EXIT.                                                        ELCDTERX
  8977******************************************************************ELCDTERX
  8978
  8979     MOVE DTE-CLIENT TO E-CLIENT-ID.
  8980
  8981     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  8982     MOVE WS-CD-DD               TO DC-MDY-DAY.
  8983     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  8984
  8985     MOVE 4                      TO DC-OPTION-CODE.
  8986     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8987     MOVE DC-JULIAN-DATE         TO EIBDATE.
  8988     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  8989     MOVE WORK-AREAS             TO HOLD-WORK.
  8990
  8991     IF DTE-PRC-OPT = '2'
  8992         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  8993
  8994     OPEN INPUT ELCNTL.
  8995     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  8996         NEXT SENTENCE
  8997       ELSE
  8998         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8999         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9000         MOVE EMSG               TO WS-ABEND-MESSAGE
  9001         GO TO ABEND-PGM.
  9002
  9003     OPEN  I-O ERPNDB.
  9004     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9005         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 165
* EL517.cbl
  9006       ELSE
  9007         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9008         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9009         MOVE EMSG               TO WS-ABEND-MESSAGE
  9010         GO TO ABEND-PGM.
  9011
  9012     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9013     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9014
  9015     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9016
  9017     IF ERPNDB-FILE-STATUS NOT = '00'
  9018         GO TO 9999-DONE.
  9019
  9020     OPEN INPUT ERREIN.
  9021     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9022         NEXT SENTENCE
  9023       ELSE
  9024         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9025         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9026         MOVE EMSG               TO WS-ABEND-MESSAGE
  9027         GO TO ABEND-PGM.
  9028
  9029     IF DTE-CLIENT = 'DCC'
  9030        OPEN INPUT ERPDEF ELSTAT
  9031        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9032           CONTINUE
  9033        ELSE
  9034           MOVE ERPDEF-FILE-STATUS
  9035                                 TO WS-ABEND-FILE-STATUS
  9036           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9037           MOVE EMSG             TO WS-ABEND-MESSAGE
  9038           GO TO ABEND-PGM
  9039        END-IF
  9040        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9041           CONTINUE
  9042        ELSE
  9043           MOVE ELSTAT-FILE-STATUS
  9044                                 TO WS-ABEND-FILE-STATUS
  9045           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9046           MOVE EMSG             TO WS-ABEND-MESSAGE
  9047           GO TO ABEND-PGM
  9048        END-IF
  9049     END-IF
  9050
  9051     OPEN I-O   ELCERT.
  9052******************************************************************
  9053*                                                                *
  9054*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9055*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9056*                                                                *
  9057*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9058*                                                                *
  9059*               EL631 - EL6311 - EL6312 - EL6313                 *
  9060*                                                                *
  9061******************************************************************
  9062
  9063     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 166
* EL517.cbl
  9064         NEXT SENTENCE
  9065       ELSE
  9066         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9067         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9068         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9069         GO TO ABEND-PGM.
  9070
  9071     OPEN INPUT ERCTBL.
  9072     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9073         NEXT SENTENCE
  9074       ELSE
  9075         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9076         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9077         MOVE EMSG               TO WS-ABEND-MESSAGE
  9078         GO TO ABEND-PGM.
  9079
  9080     OPEN INPUT ERACCT.
  9081     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9082         NEXT SENTENCE
  9083       ELSE
  9084         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9085         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9086         MOVE EMSG               TO WS-ABEND-MESSAGE
  9087         GO TO ABEND-PGM.
  9088
  9089     OPEN INPUT ERCOMP.
  9090     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9091         NEXT SENTENCE
  9092       ELSE
  9093         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9094         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9095         MOVE EMSG               TO WS-ABEND-MESSAGE
  9096         GO TO ABEND-PGM.
  9097
  9098     OPEN INPUT ERLOFC
  9099     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9100        CONTINUE
  9101     ELSE
  9102        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9103        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9104        MOVE EMSG                TO WS-ABEND-MESSAGE
  9105        GO TO ABEND-PGM
  9106     END-IF
  9107
  9108     OPEN INPUT ERBXRF.
  9109     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9110         NEXT SENTENCE
  9111       ELSE
  9112         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9113         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9114         MOVE EMSG               TO WS-ABEND-MESSAGE
  9115         GO TO ABEND-PGM.
  9116
  9117     OPEN INPUT ERAGTC.
  9118     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9119         NEXT SENTENCE
  9120       ELSE
  9121         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 167
* EL517.cbl
  9122         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9123         MOVE EMSG               TO WS-ABEND-MESSAGE
  9124         GO TO ABEND-PGM.
  9125
  9126     OPEN INPUT ERPLAN.
  9127     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9128        NEXT SENTENCE
  9129     ELSE
  9130        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9131        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9132        MOVE EMSG                TO WS-ABEND-MESSAGE
  9133        GO TO ABEND-PGM.
  9134
  9135     OPEN INPUT ERFORM.
  9136     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9137        OR '9%'
  9138        NEXT SENTENCE
  9139     ELSE
  9140        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9141        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9142        MOVE EMSG                TO WS-ABEND-MESSAGE
  9143        GO TO ABEND-PGM.
  9144
  9145     OPEN INPUT ELCERR.
  9146     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9147         NEXT SENTENCE
  9148       ELSE
  9149         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9150         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9151         MOVE EMSG               TO WS-ABEND-MESSAGE
  9152         GO TO ABEND-PGM.
  9153
  9154     MOVE 'R'                     TO CP-RATE-FILE.
  9155     MOVE 'O'                     TO CP-IO-FUNCTION.
  9156     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9157
  9158     IF IO-ERROR
  9159        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9160        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9161        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9162        GO TO ABEND-PGM.
  9163
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 168
* EL517.cbl
  9165*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9166*
  9167     IF DTE-CLIENT NOT = 'DMD'
  9168         GO TO 0100-READ-PENDING.
  9169
  9170     OPEN INPUT ERRESS ERRESC.
  9171
  9172     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9173         NEXT SENTENCE
  9174     ELSE
  9175         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9176         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9177         MOVE EMSG               TO WS-ABEND-MESSAGE
  9178         GO TO ABEND-PGM.
  9179
  9180     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9181         NEXT SENTENCE
  9182     ELSE
  9183         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9184         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9185         MOVE EMSG               TO WS-ABEND-MESSAGE
  9186         GO TO ABEND-PGM.
  9187
  9188     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9189     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9190     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9191     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9192         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9193         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9194         MOVE EMSG               TO WS-ABEND-MESSAGE
  9195         GO TO ABEND-PGM.
  9196
  9197     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9198     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9199     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9200     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9201         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9202         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9203         MOVE EMSG               TO WS-ABEND-MESSAGE
  9204         GO TO ABEND-PGM.
  9205
  9206     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9207     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9208     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9209     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9210         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9211         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9212         MOVE EMSG               TO WS-ABEND-MESSAGE
  9213         GO TO ABEND-PGM.
  9214
  9215     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9216     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9217     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9218     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9219         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9220         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9221         MOVE EMSG               TO WS-ABEND-MESSAGE
  9222         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 169
* EL517.cbl
  9223
  9224     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9225     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9226     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9227     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9228         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9229         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9230         MOVE EMSG               TO WS-ABEND-MESSAGE
  9231         GO TO ABEND-PGM.
  9232
  9233     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9234     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9235     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9236     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9237         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9238         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9239         MOVE EMSG               TO WS-ABEND-MESSAGE
  9240         GO TO ABEND-PGM.
  9241
  9242     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9243     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9244     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9245     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9246         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9247         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9248         MOVE EMSG               TO WS-ABEND-MESSAGE
  9249         GO TO ABEND-PGM.
  9250
  9251*
  9252*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9253*
  9254 0100-READ-PENDING.
  9255
  9256     MOVE HOLD-WORK TO WORK-AREAS.
  9257
  9258     MOVE ZEROS                  TO EMI-WARNING-CTR
  9259                                    EMI-FORCABLE-CTR
  9260                                    EMI-FATAL-CTR.
  9261 0101-READ-PENDING.
  9262     READ ERPNDB.
  9263     ADD 1 TO RPND.
  9264
  9265     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9266         GO TO 9999-DONE.
  9267
  9268     IF ERPNDB-FILE-STATUS NOT = '00'
  9269         GO TO 9999-DONE.
  9270
  9271     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9272     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9273     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9274
  9275     IF PB-BATCH-TRAILER
  9276         GO TO 9999-REWRITE-RECORD.
  9277
  9278     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9279        GO TO 0100-READ-PENDING.
  9280
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 170
* EL517.cbl
  9281     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9282        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9283        GO TO 0100-READ-PENDING.
  9284
  9285     IF WK-BATCH-PREFIX = '#CL'
  9286        GO TO 0100-READ-PENDING.
  9287
  9288     IF DTE-PRC-OPT = '2'
  9289         NEXT SENTENCE
  9290     ELSE
  9291         IF NOT PB-FATAL-ERRORS
  9292             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9293             GO TO 0100-READ-PENDING.
  9294
  9295     ADD 1 TO TRAN-CT.
  9296
  9298 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 171
* EL517.cbl
*                           COPY ELC50PD.
  9299******************************************************************04/22/98
  9300*                                                                *ELC50PD
  9301*                            ELC50PD                             *   LV012
  9302*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9303*                            VMOD=2.188                          *   CL**7
  9304*                                                                *ELC50PD
  9305******************************************************************
  9306*                   C H A N G E   L O G
  9307*
  9308* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9309*-----------------------------------------------------------------
  9310*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9311* EFFECTIVE    NUMBER
  9312*-----------------------------------------------------------------
  9313* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9314* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9315* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9316*                             2709 AND 2718
  9317* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9318* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9319* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9320* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9321* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9322*                                IS OPEN OR CNC DT < PD THRU
  9323* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9324* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9325* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9326* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9327* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9328* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9329* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9330* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9331* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9332* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9333* 020906                   PEMA  EXPAND LOAN OFFICER
  9334* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9335* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9336* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9337* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9338* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9339* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9340* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9341* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9342* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9343* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9344* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9345* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9346* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9347* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9348* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9349* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9350* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9351* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9352* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9353* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9354* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9355* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 172
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9356* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9357* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9358* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9359*                                UPDATE VIN ON CERT TRAILER
  9360* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9361* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9362* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9363* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9364* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9365* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9366* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9367* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9368* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9369* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9370* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9371* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9372* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9373* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9374* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9375* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9376* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9377* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9378* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9379* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9380* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9381* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9382* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9383* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9384* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9385* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9386* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9387* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9388* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9389* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9390* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9391* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9392* 032912  CR2011110200001  PEMA  AHL CHANGES
  9393* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9394* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9395* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9396* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9397* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9398* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9399* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9400* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9401******************************************************************ELC50PD
  9402************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9403******************************************************************ELC50PD
  9404                                                                  ELC50PD
  9405     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9406                                                                  ELC50PD
  9407     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9408                                    PB-FORCE-ER-CD                ELC50PD
  9409                                    PB-WARN-ER-CD                 ELC50PD
  9410                                    PB-OUT-BAL-CD.                ELC50PD
  9411                                                                  ELC50PD
  9412     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9413                                    WS-IG-OVRD-LF                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 173
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9414                                    WS-IG-OVRD-AM                 ELC50PD
  9415                                    WS-IG-OVRD                    ELC50PD
  9416                                    WS-IG-OVRD-AH-PL              ELC50PD
  9417                                    WS-IG-OVRD-LF-PL              ELC50PD
  9418                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9419                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9420                                                                  ELC50PD
  9421******************************************************************ELC50PD
  9422*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9423******************************************************************ELC50PD
  9424                                                                  ELC50PD
  9425     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9426     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9427                                                                  ELC50PD
  9428******************************************************************ELC50PD
  9429                                                                  ELC50PD
  9430     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9431     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9432*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9433     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9434     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9435                                                                  ELC50PD
  9436     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9437                                                                  ELC50PD
  9438 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9439                                                                  ELC50PD
  9440     ADD +1                      TO  SUB4.                        ELC50PD
  9441                                                                  ELC50PD
  9442     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9443         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9444                                                                  ELC50PD
  9445     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9446         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9447                                                                  ELC50PD
  9448     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9449                                                                  ELC50PD
  9450 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9451                                                                  ELC50PD
  9452     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9453        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9454                                         WS-AH-REM-TERM-CALC      ELC50PD
  9455                                         EC-CO-REM-TERM-CALC      ELC50PD
  9456        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9457        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9458        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9459                                         WS-TOL-AH-CLAIM          ELC50PD
  9460        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9461                                         WS-TOL-AH-PREM           ELC50PD
  9462                                         EC-CO-TOL-PREM           ELC50PD
  9463        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9464                                         WS-TOL-AH-REFUND         ELC50PD
  9465                                         EC-CO-TOL-REFUND         ELC50PD
  9466        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9467                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9468                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9469        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9470                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9471                                         EC-CO-TOL-PREM-PCT       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9472        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9473                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9474                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9475        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9476                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9477                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9478        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9479        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9480        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9481        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9482        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9483        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9484        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9485        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9486        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9487        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9488        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9489        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9490                                         EC-CO-MONTH-END-DT       ELC50PD
  9491        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9492          GO TO 0100-READ-ACCT.                                   ELC50PD
  9493                                                                  ELC50PD
  9494     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9495     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9496     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9497     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9498                                                                  ELC50PD
  9499     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9500     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9501     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9502         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9503                                   WK-CO-TOL-CLAIM                ELC50PD
  9504                                   WK-CO-TOL-REFUND               ELC50PD
  9505                                   WK-REFUND-OVS-AMT              ELC50PD
  9506                                   WK-REFUND-OVS-PCT              ELC50PD
  9507                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9508                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9509                                   WK-DEFAULT-APR                 ELC50PD
  9510                                   WK-CO-MAX-CAP                  ELC50PD
  9511        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9512                                   WK-CR-R78-METHOD               ELC50PD
  9513                                   WK-CO-REF-REJECT-SW            ELC50PD
  9514                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9515                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9516                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9517                                   WK-JOINT-AGE-INPUT             ELC50PD
  9518        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9519        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9520        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9521        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9522          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9523                                                                  ELC50PD
  9524     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9525        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9526     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9527        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9528     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9529        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9530     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9531        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9532                                                                  ELC50PD
  9533     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9534     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9535     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9536     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9537     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9538     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9539     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9540     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9541     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9542     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9543     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9544     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9545                                                                  ELC50PD
  9546     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9547          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9548        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9549                                                                  ELC50PD
  9550     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9551          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9552        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9553                                                                  ELC50PD
  9554     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9555         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9556     ELSE                                                         ELC50PD
  9557         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9558                                                                  ELC50PD
  9559     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9560     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9561     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9562     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9563                                                                  ELC50PD
  9564     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9565                                                                  ELC50PD
  9566 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9567                                                                  ELC50PD
  9568     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9570                                                                  ELC50PD
  9571 0100-READ-ACCT.                                                  ELC50PD
  9572                                                                  ELC50PD
  9573     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9574                                                                  ELC50PD
  9575     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9576        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9577                                                                  ELC50PD
  9578     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9579     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9580     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9581                                                                  ELC50PD
  9582     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9583        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9584        GO TO 0105-READ-ACCT
  9585     END-IF
  9586                                                                  ELC50PD
  9587     IF PB-CARRIER NOT = SPACES                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9588        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9589           GO TO 0105-READ-ACCT.                                  ELC50PD
  9590                                                                  ELC50PD
  9591     IF PB-STATE NOT = SPACES                                     ELC50PD
  9592        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9593           GO TO 0105-READ-ACCT.                                  ELC50PD
  9594                                                                  ELC50PD
  9595     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9596        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9597           GO TO 0105-READ-ACCT.                                  ELC50PD
  9598                                                                  ELC50PD
  9599     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9600                                                                  ELC50PD
  9601     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9602        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9603        GO TO 0105-READ-ACCT.                                     ELC50PD
  9604                                                                  ELC50PD
  9605     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9606        GO TO 0105-READ-ACCT.                                     ELC50PD
  9607                                                                  ELC50PD
  9608     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9609                                                                  ELC50PD
  9610 0102-ACCT-GETMAIN.                                               ELC50PD
  9611     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9612     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9613                                                                  ELC50PD
  9614 0105-READ-ACCT.                                                  ELC50PD
  9615     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9616     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9617     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9618     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9619     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9620     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9621                                                                  ELC50PD
  9622     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9623                                                                  ELC50PD
  9624     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9625                                                                  ELC50PD
  9626 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9627
  9628     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9629                                                                  ELC50PD
  9630     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9631        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9632        GO TO 0199-ACCT-NOT-FOUND
  9633     END-IF
  9634     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9635        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9636           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9637                                                                  ELC50PD
  9638     IF PB-STATE NOT = SPACES                                     ELC50PD
  9639        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9640           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9641                                                                  ELC50PD
  9642     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9643        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9644           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9645                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9646     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9647                                                                  ELC50PD
  9648     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9649        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9650        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9651                                                                  ELC50PD
  9652     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9653        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9654                                                                  ELC50PD
  9655 0180-ACCOUNT-FOUND.                                              ELC50PD
  9656
  9657     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9658     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9659     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9660     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9661                                                                  ELC50PD
  9662     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9663        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9664                                                                  ELC50PD
  9665     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9666        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9667                                                                  ELC50PD
  9668     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9669        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9670                                                                  ELC50PD
  9671     IF AM-CLP-TOL-PCT NOT NUMERIC
  9672        MOVE +0                  TO AM-CLP-TOL-PCT
  9673     END-IF
  9674     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9675        MOVE +0                  TO AM-SPP-LEASE-COMM
  9676     END-IF
  9677     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9678        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9679        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9680                                                                  ELC50PD
  9681     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9682        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9684                                                                  ELC50PD
  9685     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9686        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9687        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9688        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9689         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9690                                                                  ELC50PD
  9691     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9692     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9693     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9694     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9695     IF AM-CLP-TOL-PCT NOT = ZEROS
  9696        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9697     END-IF
  9698     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9699        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9700     END-IF
  9701
  9702
  9703
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9704
  9705*    IF PB-COMPANY-ID = 'DCC'
  9706*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9707*                                   WS-ADMIN-FEES
  9708*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9709*          (SUB5 > +10)
  9710*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9711*             AND (AM-A-COM (SUB5) NUMERIC)
  9712*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9713*                + (AM-A-COM (SUB5) * 1000)
  9714*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9715*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9716*                + (AM-A-COM (SUB5) * 1000)
  9717*             END-IF
  9718*             IF AM-COM-TYP (SUB5) = 'N'
  9719*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9720*                + (AM-A-COM (SUB5) * 1000)
  9721*             END-IF
  9722*          END-IF
  9723*       END-PERFORM
  9724*    END-IF
  9725
  9726     IF (PB-COMPANY-ID = 'DCC')
  9727        AND (PB-ISSUE)
  9728        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9729        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9730           (SUB5 > +10)
  9731           MOVE +0 TO WS-WK-RATE
  9732           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9733              IF (AM-A-COM (SUB5) NUMERIC)
  9734                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9735                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9736              ELSE
  9737                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9738                 IF PB-ISSUE
  9739                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9740                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9741                 ELSE
  9742                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9743                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9744                 END-IF
  9745                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9746                 MOVE ZEROS             TO WS-SUB1
  9747                                           WS-COMMISSION
  9748                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9749                 MOVE '0530'               TO CTBL-SW
  9750                 MOVE ' '                  TO WS-CTBL-READ-SW
  9751                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9752                 IF FIRST-TIME-THROUGH
  9753                    MOVE 'AA'              TO CTBL-BEN-CODE
  9754                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9755                 END-IF
  9756                 IF CTBL-TABLE-FOUND
  9757                    IF PB-ISSUE
  9758                       COMPUTE WS-COMM-CK-AMT =
  9759                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9760                    ELSE
  9761                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9762                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9763                    END-IF
  9764                    PERFORM 8800-GET-COMP-RATE
  9765                              THRU 8800-EXIT
  9766                 END-IF
  9767              END-IF
  9768              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9769                + (WS-WK-RATE * 1000)
  9770           END-IF
  9771        END-PERFORM
  9772     END-IF
  9773
  9774     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9775         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9776                                                                  ELC50PD
  9777     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9778         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9779     END-IF
  9780                                                                  ELC50PD
  9781     GO TO 0200-READ-CERT.                                        ELC50PD
  9782                                                                  ELC50PD
  9783 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9784                                                                  ELC50PD
  9785     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9786                                                                  ELC50PD
  9787     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9788        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9789        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9790     ELSE                                                         ELC50PD
  9791        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9792        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9793                                                                  ELC50PD
  9794     GO TO 9990-RETURN.                                           ELC50PD
  9795                                                                  ELC50PD
  9796 0200-READ-CERT.                                                  ELC50PD
  9797                                                                  ELC50PD
  9798     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9799     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9800     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9801     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9802     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9803     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9804     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9805                                                                  ELC50PD
  9806     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9807                                                                  ELC50PD
  9808     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9809        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9810                                                                  ELC50PD
  9811     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9812        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9814        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9815                                                                  ELC50PD
  9816     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9817         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9819         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9820                                                                  ELC50PD
  9821     IF PB-ISSUE                                                  ELC50PD
  9822        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9823           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9824              NEXT SENTENCE                                       ELC50PD
  9825            ELSE                                                  ELC50PD
  9826              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9827              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9828              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9829                                                                  ELC50PD
  9830     IF NOT PB-CANCELLATION                                       ELC50PD
  9831        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9832                                                                  ELC50PD
  9833     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9834     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9835     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9836     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9837     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9838     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9839                                                                  ELC50PD
  9840     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9841     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9842     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9843     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9844     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9845     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9846     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9847     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9848     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9849                                                                  ELC50PD
  9850     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9851     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9852     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9853     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9854     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9855     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9856     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9857                                                                  ELC50PD
  9858     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9859     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9860                                                                  ELC50PD
  9861     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9862                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9863     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9864                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9865                                                                  ELC50PD
  9866     IF CM-O-B-COVERAGE                                           ELC50PD
  9867         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9868                                                                  ELC50PD
  9869     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9870         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9871                                                                  ELC50PD
  9872     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9873         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9874                                                                  ELC50PD
  9875     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9876         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9877         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9878         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9879         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9880         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9881         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9882         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9883*The next line causes a problem with my change  I dont think it is needed
  9884*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9885                                                                  ELC50PD
  9886     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9887     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9888     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9889     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9890     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9891     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9892                                                                  ELC50PD
  9893     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9894     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9895     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9896     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9897                                                                  ELC50PD
  9898     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9899         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9900     ELSE                                                         ELC50PD
  9901         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9902                                                                  ELC50PD
  9903     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9904         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9905     ELSE                                                         ELC50PD
  9906         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9907                                                                  ELC50PD
  9908     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9909                                                                  ELC50PD
  9910     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
  9911           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
  9912                                                                  ELC50PD
  9913     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
  9914           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
  9915                                                                  ELC50PD
  9916     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
  9917           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
  9918                                                                  ELC50PD
  9919     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
  9920           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
  9921                                                                  ELC50PD
  9922     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
  9923           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
  9924                                                                  ELC50PD
  9925     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
  9926     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
  9927     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
  9928     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
  9929     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
  9930     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
  9931     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
  9932     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
  9933     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
  9934     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
  9935     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9936     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
  9937                                                                  ELC50PD
  9938     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
  9939         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
  9940                                                                  ELC50PD
  9941     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
  9942         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
  9943                                                                  ELC50PD
  9944     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
  9945                                                                  ELC50PD
  9946     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  9947        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  9948        IF CM-ADDL-CLP NOT NUMERIC
  9949           MOVE +0               TO CM-ADDL-CLP
  9950        END-IF
  9951        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  9952        IF AM-DCC-PRODUCT-CODE = 'DDF'
  9953           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  9954        END-IF
  9955     END-IF
  9956
  9957     IF PB-COMPANY-ID = 'DCC'
  9958        MOVE +0                  TO WS-ADMIN-FEES
  9959                                    WS-CSO-ADMIN-FEE
  9960                                    WS-COMM-AND-MFEE
  9961                                    WS-1ST-YR-ALLOW
  9962        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9963           (SUB5 > +10)
  9964           MOVE +0 TO WS-WK-RATE
  9965           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9966              IF (AM-A-COM (SUB5) NUMERIC)
  9967                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9968                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9969              ELSE
  9970                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9971                 IF PB-ISSUE
  9972                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9973                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9974                 ELSE
  9975                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9976                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9977                 END-IF
  9978                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9979                 MOVE ZEROS             TO WS-SUB1
  9980                                           WS-COMMISSION
  9981                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9982                 MOVE '0530'               TO CTBL-SW
  9983                 MOVE ' '                  TO WS-CTBL-READ-SW
  9984                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9985                 IF FIRST-TIME-THROUGH
  9986                    MOVE 'AA'              TO CTBL-BEN-CODE
  9987                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9988                 END-IF
  9989                 IF CTBL-TABLE-FOUND
  9990                    IF PB-ISSUE
  9991                       COMPUTE WS-COMM-CK-AMT =
  9992                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9993                    ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9994                       COMPUTE WS-COMM-CK-AMT =
  9995                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9996                    END-IF
  9997                    PERFORM 8800-GET-COMP-RATE
  9998                              THRU 8800-EXIT
  9999                 END-IF
 10000              END-IF
 10001              IF AM-COM-TYP (SUB5) = 'I'
 10002                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10003                   + (WS-WK-RATE * 1000)
 10004              END-IF
 10005              IF AM-COM-TYP (SUB5) = 'N'
 10006                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10007                   + (WS-WK-RATE * 1000)
 10008              END-IF
 10009              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10010                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10011                   + (WS-WK-RATE * 1000)
 10012              END-IF
 10013              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10014                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10015                   + (WS-WK-RATE * 1000)
 10016              END-IF
 10017           END-IF
 10018        END-PERFORM
 10019     END-IF
 10020
 10021     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10022                                                                  ELC50PD
 10023 0298-UNLOCK-RETURN.                                              ELC50PD
 10024      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10025      GO TO 9990-RETURN.                                          ELC50PD
 10026                                                                  ELC50PD
 10027 0299-CERT-NOT-FOUND.                                             ELC50PD
 10028                                                                  ELC50PD
 10029     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10030                                                                  ELC50PD
 10031     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10032         IF WS-ERROR = ER-2799                                    ELC50PD
 10033             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10034                                                                  ELC50PD
 10035     IF NOT PB-CANCELLATION                                       ELC50PD
 10036         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10037                                                                  ELC50PD
 10038     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10039     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10040     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10041     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10042                                    PB-CI-LF-TERM                 ELC50PD
 10043                                    PB-C-LF-REM-TERM              ELC50PD
 10044                                    PB-CI-AH-TERM                 ELC50PD
 10045                                    PB-C-AH-REM-TERM              ELC50PD
 10046                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10047                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10048                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10049                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10050                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10051                                    PB-CI-AH-BENEFIT-CD           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10052                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10053                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10054                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10055                                    PB-CI-LOAN-APR                ELC50PD
 10056                                    PB-CI-LOAN-TERM               ELC50PD
 10057                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10058                                    PB-CI-AH-COMMISSION           ELC50PD
 10059                                    PB-CI-CURR-SEQ                ELC50PD
 10060                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10061                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10062                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10063                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10064                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10065                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10066                                    PB-CI-LIVES                   ELC50PD
 10067                                    PB-CI-LF-CRIT-PER             ELC50PD
 10068                                    PB-CI-AH-CRIT-PER
 10069                                    PB-CI-ADDL-CLP
 10070                                    PB-CI-DDF-IU-RATE-UP.
 10071                                                                  ELC50PD
 10072     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10073                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10074                                    PB-CI-DEATH-DT                ELC50PD
 10075                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10076                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10077                                    PB-CI-ENTRY-DT                ELC50PD
 10078                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10079                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10080                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10081                                                                  ELC50PD
 10082     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10083        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10084        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10085                                                                  ELC50PD
 10086     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 10087                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10089                                                                  ELC50PD
 10090 0300-CONTINUE-EDIT.                                              ELC50PD
 10091                                                                  ELC50PD
 10092     IF PB-ISSUE                                                  ELC50PD
 10093        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10094            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10095                                                                  ELC50PD
 10096     IF PB-ISSUE                                                  ELC50PD
 10097        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10098            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10099                                                                  ELC50PD
 10100     IF PB-ISSUE                                                  ELC50PD
 10101       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10102          (AM-NO-AH-ONLY)                                         ELC50PD
 10103           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10104               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10105                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10106                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10107                                                                  ELC50PD
 10108     IF PB-ISSUE                                                  ELC50PD
 10109        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10110        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10111        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10112     ELSE                                                         ELC50PD
 10113        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10114        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10115        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10116                                                                  ELC50PD
 10117     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10118                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10119                                    FORM-MASTER-SW                ELC50PD
 10120                                    WS-APP-CERT-SW.               ELC50PD
 10121                                                                  ELC50PD
 10122     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10123                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10124                                    WS-PL-REF-OVS-AMT             ELC50PD
 10125                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10126                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10127                                    WS-PL-REF-OVS-PCT             ELC50PD
 10128                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10129                                                                  ELC50PD
 10130     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10131       IF PB-ISSUE                                                ELC50PD
 10132         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10133             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10134             IF FORM-MASTER-FOUND                                 ELC50PD
 10135                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10136                                                                  ELC50PD
 10137     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10138        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10139                                                                  ELC50PD
 10140********************** MON CODE **********************            ELC50PD
 10141     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10142     IF PB-ISSUE                                                  ELC50PD
 10143     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10144        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10145             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10146               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10147******************************************************            ELC50PD
 10148                                                                  ELC50PD
 10149     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10150       IF PB-ISSUE                                                ELC50PD
 10151           IF FORM-MASTER-FOUND                                   ELC50PD
 10152             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10153                AM-DISMBR-COVERAGE                                ELC50PD
 10154                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10155                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10156                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10157                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10158                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10159                                                                  ELC50PD
 10160     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10161                                                                  ELC50PD
 10162     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10163         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10164         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10165         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10166         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10167         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10168           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10169             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10170         ELSE                                                     ELC50PD
 10171             NEXT SENTENCE                                        ELC50PD
 10172     ELSE                                                         ELC50PD
 10173         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10174                                                                  ELC50PD
 10175     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10176     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10177     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10178     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10179                                                                  ELC50PD
 10180     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10181     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10182                                                                  ELC50PD
 10183     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10184        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10185         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10186                                                                  ELC50PD
 10187     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10188                                                                  ELC50PD
 10189 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10190                                                                  ELC50PD
 10191     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10192                                                                  ELC50PD
 10193     IF NO-BENEFIT-FOUND                                          ELC50PD
 10194        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10195                                                                  ELC50PD
 10196     IF WS-BEN-CD = '99'                                          ELC50PD
 10197        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10198                                                                  ELC50PD
 10199     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10200         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10201             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10202                                                                  ELC50PD
 10203     MOVE +1                     TO SUB5.                         ELC50PD
 10204     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10205                                                                  ELC50PD
 10206* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10207* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10208     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10209         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10210                                                                  ELC50PD
 10211 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10212                                                                  ELC50PD
 10213     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10214        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10215           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10216                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10217           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10218                                                                  ELC50PD
 10219     IF SUB5 LESS THAN +20                                        ELC50PD
 10220        ADD +1                   TO SUB5                          ELC50PD
 10221        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10222                                                                  ELC50PD
 10223     MOVE +1                     TO SUB5.                         ELC50PD
 10224                                                                  ELC50PD
 10225     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10226        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10227                                                                  ELC50PD
 10228 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10229                                                                  ELC50PD
 10230     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10231        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10232           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10233                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10234           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10235                                                                  ELC50PD
 10236     IF SUB5 LESS THAN +30                                        ELC50PD
 10237        ADD +1                   TO SUB5                          ELC50PD
 10238        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10239                                                                  ELC50PD
 10240     MOVE +1                     TO SUB5.                         ELC50PD
 10241                                                                  ELC50PD
 10242 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10243                                                                  ELC50PD
 10244***************************************************************   ELC50PD
 10245*                                                             *   ELC50PD
 10246*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10247*                                                             *   ELC50PD
 10248*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10249*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10250*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10251*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10252*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10253*           BENEFIT CONTROLS.                                 *   ELC50PD
 10254*      99 = ALL BENEFITS                                      *   ELC50PD
 10255*                                                             *   ELC50PD
 10256***************************************************************   ELC50PD
 10257                                                                  ELC50PD
 10258     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10259                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10260                                                                  ELC50PD
 10261     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10262       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10263        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10264        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10265                                                                  ELC50PD
 10266     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10267       AND                                                        ELC50PD
 10268        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10269        IF CF-REDUCING (SUB3)                                     ELC50PD
 10270           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10271              OR                                                  ELC50PD
 10272           ((AM-IG = '1') AND                                     ELC50PD
 10273           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10274              OR                                                  ELC50PD
 10275           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10276           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10277           (AM-IG NOT = '2'))                                     ELC50PD
 10278              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10279                                                                  ELC50PD
 10280     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10281       AND                                                        ELC50PD
 10282        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10283        IF CF-REDUCING (SUB3)                                     ELC50PD
 10284           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10285              OR                                                  ELC50PD
 10286           ((AM-IG = '2') AND                                     ELC50PD
 10287           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10288              OR                                                  ELC50PD
 10289           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10290           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10291           (AM-IG NOT = '1'))                                     ELC50PD
 10292              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10293                                                                  ELC50PD
 10294     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10295       AND                                                        ELC50PD
 10296        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10297        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10298           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10299              OR                                                  ELC50PD
 10300           ((AM-IG = '1') AND                                     ELC50PD
 10301           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10302              OR                                                  ELC50PD
 10303           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10304           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10305            (AM-IG NOT = '2'))                                    ELC50PD
 10306              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10307                                                                  ELC50PD
 10308     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10309       AND                                                        ELC50PD
 10310        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10311        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10312           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10313              OR                                                  ELC50PD
 10314           ((AM-IG = '2') AND                                     ELC50PD
 10315           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10316              OR                                                  ELC50PD
 10317           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10318           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10319           (AM-IG NOT = '1'))                                     ELC50PD
 10320              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10321                                                                  ELC50PD
 10322     IF SUB5 LESS THAN +20                                        ELC50PD
 10323        ADD +1                   TO SUB5                          ELC50PD
 10324        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10325                                                                  ELC50PD
 10326     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10327                                                                  ELC50PD
 10328     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10329        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10330                                                                  ELC50PD
 10331     MOVE +1                     TO SUB5.                         ELC50PD
 10332                                                                  ELC50PD
 10333 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10334                                                                  ELC50PD
 10335     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10336                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10337                                                                  ELC50PD
 10338     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10339       AND                                                        ELC50PD
 10340        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10341        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10342                                                                  ELC50PD
 10343     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10344       AND                                                        ELC50PD
 10345        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10346        IF CF-REDUCING (SUB3)                                     ELC50PD
 10347           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10348              OR                                                  ELC50PD
 10349           ((AM-IG = '1') AND                                     ELC50PD
 10350           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10351              OR                                                  ELC50PD
 10352           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10353           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10354           (AM-IG NOT = '2'))                                     ELC50PD
 10355              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10356                                                                  ELC50PD
 10357     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10358       AND                                                        ELC50PD
 10359        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10360        IF CF-REDUCING (SUB3)                                     ELC50PD
 10361           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10362              OR                                                  ELC50PD
 10363           ((AM-IG = '2') AND                                     ELC50PD
 10364           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10365              OR                                                  ELC50PD
 10366           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10367           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10368           (AM-IG NOT = '1'))                                     ELC50PD
 10369              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10370                                                                  ELC50PD
 10371     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10372       AND                                                        ELC50PD
 10373        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10374        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10375           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10376              OR                                                  ELC50PD
 10377           ((AM-IG = '1') AND                                     ELC50PD
 10378           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10379              OR                                                  ELC50PD
 10380           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10381           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10382            (AM-IG NOT = '2'))                                    ELC50PD
 10383              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10384                                                                  ELC50PD
 10385     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10386       AND                                                        ELC50PD
 10387        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10388        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10389           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10390              OR                                                  ELC50PD
 10391           ((AM-IG = '2') AND                                     ELC50PD
 10392           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10393              OR                                                  ELC50PD
 10394           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10395           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10396           (AM-IG NOT = '1'))                                     ELC50PD
 10397              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10398                                                                  ELC50PD
 10399     IF SUB5 LESS THAN +30                                        ELC50PD
 10400        ADD +1                   TO SUB5                          ELC50PD
 10401        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10402                                                                  ELC50PD
 10403     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10404                                                                  ELC50PD
 10405 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10406                                                                  ELC50PD
 10407     MOVE +99                    TO SUB5.                         ELC50PD
 10408                                                                  ELC50PD
 10409     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10410        IF PB-ISSUE                                               ELC50PD
 10411           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10412           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10413                                                                  ELC50PD
 10414     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10415                                                                  ELC50PD
 10416 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10417                                                                  ELC50PD
 10418     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10419        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10420                                                                  ELC50PD
 10421     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10422     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10423     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10424     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10425     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10426                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10427     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10428                                                                  ELC50PD
 10429 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10430                                                                  ELC50PD
 10431     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10432     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10433                                                                  ELC50PD
 10434 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10435                                                                  ELC50PD
 10436     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10437     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10438     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10439     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10440     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10441     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10442     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10443     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10444                                 TO PLAN-REVISION-NO.             ELC50PD
 10445                                                                  ELC50PD
 10446     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10447     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10448                                                                  ELC50PD
 10449     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10450       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10451         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10452            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10453             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10454             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10455             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10456                                                                  ELC50PD
 10457     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10458        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10459                                                                  ELC50PD
 10460 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10461                                                                  ELC50PD
 10462     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10463        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10464        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10465        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10466        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10467        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10468        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10469        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10470        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10471          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10472                                                                  ELC50PD
 10473     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10474                                                                  ELC50PD
 10475     IF  PB-CANCELLATION                                          ELC50PD
 10476         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10477                                                                  ELC50PD
 10478     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10479        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10480           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10481           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10482              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10483              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10484           ELSE                                                   ELC50PD
 10485              NEXT SENTENCE                                       ELC50PD
 10486        ELSE                                                      ELC50PD
 10487           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10488              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10489                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10490                                                                  ELC50PD
 10491 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10492                                                                  ELC50PD
 10493     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10494                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10495     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10496        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10497                                                                  ELC50PD
 10498     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10499        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10500        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10501                                                                  ELC50PD
 10502     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10503        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10504                                                                  ELC50PD
 10505     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10506        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10507                                                                  ELC50PD
 10508     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10509        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10510                                                                  ELC50PD
 10511     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10512        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10513                                                                  ELC50PD
 10514     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10515        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10516                                                                  ELC50PD
 10517     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10518                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10519        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10520                                                                  ELC50PD
 10521     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10522                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10523        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10524                                                                  ELC50PD
 10525     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10526                          PL-SALES-TAX > +0                       ELC50PD
 10527         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10528                                                                  ELC50PD
 10529     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10530        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10531                                    WS-IG-OVRD-AM.                ELC50PD
 10532                                                                  ELC50PD
 10533 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10534                                                                  ELC50PD
 10535     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10536                                                                  ELC50PD
 10537     IF PB-ISSUE                                                  ELC50PD
 10538        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10539     ELSE                                                         ELC50PD
 10540        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10541                                                                  ELC50PD
 10542     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10543     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10544     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10545     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10546     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10547                                         WS-LF-REFUND-CALC.       ELC50PD
 10548                                                                  ELC50PD
 10549     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10550        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10551                                                                  ELC50PD
 10552     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10553        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10554
 10555     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10556                                                                  ELC50PD
 10557     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10558     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10559     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10560     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10561     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10562     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10563                                                                  ELC50PD
 10564     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10565        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10566         NEXT SENTENCE                                            ELC50PD
 10567     ELSE                                                         ELC50PD
 10568         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10569            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10570               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10571                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10572                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10573                                                                  ELC50PD
 10574     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10575     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10576                                                                  ELC50PD
 10577     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10578                                                                  ELC50PD
 10579 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10580                                                                  ELC50PD
 10581     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10582     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10584                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10586                                                                  ELC50PD
 10587 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10588                                                                  ELC50PD
 10589     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10590                                    PLAN-MASTER-AH-SW.            ELC50PD
 10591                                                                  ELC50PD
 10592     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10593                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10594                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10595                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10596                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10597                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10598                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10599     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10600                                                                  ELC50PD
 10601                                                                  ELC50PD
 10602     if pb-issue
 10603        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10604           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10605        end-if
 10606        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10607           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10608           GO TO 0399-BENEFIT-NOT-FOUND
 10609        end-if
 10610     end-if
 10611                                                                  ELC50PD
 10612     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10613        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10614                                                                  ELC50PD
 10615     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10616                                                                  ELC50PD
 10617     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10618         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10619         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10620         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10621         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10622           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10623             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10624         ELSE                                                     ELC50PD
 10625             NEXT SENTENCE                                        ELC50PD
 10626     ELSE                                                         ELC50PD
 10627         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10628                                                                  ELC50PD
 10629     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10630     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10631     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10632     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10633                                                                  ELC50PD
 10634     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10635     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10636                                                                  ELC50PD
 10637     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10638        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10639          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10640                                                                  ELC50PD
 10641     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10642                                                                  ELC50PD
 10643 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10644                                                                  ELC50PD
 10645     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10646                                                                  ELC50PD
 10647     IF NO-BENEFIT-FOUND                                          ELC50PD
 10648         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10649                                                                  ELC50PD
 10650     IF WS-BEN-CD = '99'                                          ELC50PD
 10651        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10652                                                                  ELC50PD
 10653     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10654         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10655             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10656                                                                  ELC50PD
 10657     MOVE +1                     TO SUB5.                         ELC50PD
 10658     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10659                                                                  ELC50PD
 10660* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10661* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10662     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10663         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10664                                                                  ELC50PD
 10665 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10666                                                                  ELC50PD
 10667     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10668        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10669           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10670                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10671           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10672                                                                  ELC50PD
 10673     IF SUB5 LESS THAN +20                                        ELC50PD
 10674        ADD +1                   TO SUB5                          ELC50PD
 10675        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10676                                                                  ELC50PD
 10677     MOVE +1                     TO SUB5.                         ELC50PD
 10678                                                                  ELC50PD
 10679     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10680        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10681                                                                  ELC50PD
 10682 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10683                                                                  ELC50PD
 10684     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10685        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10686           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10687                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10688           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10689                                                                  ELC50PD
 10690     IF SUB5 LESS THAN +30                                        ELC50PD
 10691        ADD +1                   TO SUB5                          ELC50PD
 10692        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10693                                                                  ELC50PD
 10694     MOVE +1                     TO SUB5.                         ELC50PD
 10695                                                                  ELC50PD
 10696 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10697                                                                  ELC50PD
 10698***************************************************************   ELC50PD
 10699*                                                             *   ELC50PD
 10700*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10701*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10702*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10703*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10704*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10705*           BENEFIT CONTROLS.                                 *   ELC50PD
 10706*      99 = ALL BENEFITS.                                     *   ELC50PD
 10707*                                                             *   ELC50PD
 10708***************************************************************   ELC50PD
 10709                                                                  ELC50PD
 10710     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10711                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10712                                                                  ELC50PD
 10713     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10714       AND                                                        ELC50PD
 10715        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10716        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10717                                                                  ELC50PD
 10718     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10719       AND                                                        ELC50PD
 10720        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10721           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10722              OR                                                  ELC50PD
 10723           ((AM-IG = '1') AND                                     ELC50PD
 10724           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10725              OR                                                  ELC50PD
 10726           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10727           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10728           (AM-IG NOT = '2'))                                     ELC50PD
 10729              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10730                                                                  ELC50PD
 10731     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10732       AND                                                        ELC50PD
 10733        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10734           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10735              OR                                                  ELC50PD
 10736           ((AM-IG = '2') AND                                     ELC50PD
 10737           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10738              OR                                                  ELC50PD
 10739           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10740           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10741           (AM-IG NOT = '1'))                                     ELC50PD
 10742              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10743                                                                  ELC50PD
 10744     IF SUB5 LESS THAN +20                                        ELC50PD
 10745        ADD +1                   TO SUB5                          ELC50PD
 10746        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10747                                                                  ELC50PD
 10748     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10749        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10750                                                                  ELC50PD
 10751     MOVE +1                    TO SUB5.                          ELC50PD
 10752                                                                  ELC50PD
 10753 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10754                                                                  ELC50PD
 10755     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10756                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10757                                                                  ELC50PD
 10758     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10759       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10760        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10761        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10762                                                                  ELC50PD
 10763     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10764       AND                                                        ELC50PD
 10765        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10766           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10767              OR                                                  ELC50PD
 10768           ((AM-IG = '1') AND                                     ELC50PD
 10769           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10770              OR                                                  ELC50PD
 10771           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10772           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10773           (AM-IG NOT = '2'))                                     ELC50PD
 10774              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10775                                                                  ELC50PD
 10776     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10777       AND                                                        ELC50PD
 10778        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10779           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10780              OR                                                  ELC50PD
 10781           ((AM-IG = '2') AND                                     ELC50PD
 10782           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10783              OR                                                  ELC50PD
 10784           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10785           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10786           (AM-IG NOT = '1'))                                     ELC50PD
 10787              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10788                                                                  ELC50PD
 10789     IF SUB5 LESS THAN +30                                        ELC50PD
 10790        ADD +1                   TO SUB5                          ELC50PD
 10791        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10792                                                                  ELC50PD
 10793 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10794                                                                  ELC50PD
 10795     MOVE +99                    TO SUB5.                         ELC50PD
 10796                                                                  ELC50PD
 10797     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10798                                                                  ELC50PD
 10799     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10800        IF PB-ISSUE                                               ELC50PD
 10801           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10802           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10803                                                                  ELC50PD
 10804     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10805                                                                  ELC50PD
 10806 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10807                                                                  ELC50PD
 10808     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10809         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10810                                                                  ELC50PD
 10811     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10812     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10813     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10814     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10815     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10816                                    PLAN-MASTER-AH-SW.            ELC50PD
 10817*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10818     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10819                                                                  ELC50PD
 10820 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10821                                                                  ELC50PD
 10822     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10823     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10824                                                                  ELC50PD
 10825 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10826                                                                  ELC50PD
 10827     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10828     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10829     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10830     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10831     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10832     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10833     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10834     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10835                                 TO PLAN-REVISION-NO.             ELC50PD
 10836                                                                  ELC50PD
 10837     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10838     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10839                                                                  ELC50PD
 10840     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10841       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10842         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10843            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10844             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10845             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10846             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10847                                                                  ELC50PD
 10848     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10849        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10850                                                                  ELC50PD
 10851 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10852                                                                  ELC50PD
 10853     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10854        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10855        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10856        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10857        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10858        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10859        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10860        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10861        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10862          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10863                                                                  ELC50PD
 10864     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10865                                                                  ELC50PD
 10866     IF  PB-CANCELLATION                                          ELC50PD
 10867         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10868                                                                  ELC50PD
 10869     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10870       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10871          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10872          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10873             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10874             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10875          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10876             NEXT SENTENCE                                        ELC50PD
 10877       ELSE                                                       ELC50PD
 10878          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10879             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10880                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10881                                                                  ELC50PD
 10882 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10883                                                                  ELC50PD
 10884     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10885                                                                  ELC50PD
 10886     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10887        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10888                                                                  ELC50PD
 10889     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10890        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10891        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10892                                                                  ELC50PD
 10893     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10894        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10895                                                                  ELC50PD
 10896     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10897        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10898                                                                  ELC50PD
 10899     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10900        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10901                                                                  ELC50PD
 10902     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10903        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10904                                                                  ELC50PD
 10905     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10906        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10907                                                                  ELC50PD
 10908     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 10909                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10910        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 10911                                                                  ELC50PD
 10912     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 10913                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10914        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 10915                                                                  ELC50PD
 10916     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10917        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 10918        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 10919            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 10920                                                                  ELC50PD
 10921 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 10922                                                                  ELC50PD
 10923     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 10924                                                                  ELC50PD
 10925     IF PB-ISSUE                                                  ELC50PD
 10926        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 10927       ELSE                                                       ELC50PD
 10928        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 10929                                                                  ELC50PD
 10930     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 10931     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 10932     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 10933     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10934                                         WS-AH-REFUND-CALC.       ELC50PD
 10935                                                                  ELC50PD
 10936     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10937        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 10938                                                                  ELC50PD
 10939     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10940        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 10941
 10942     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 10943                                                                  ELC50PD
 10944     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 10945     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 10946     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 10947     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 10948     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 10949     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 10950                                                                  ELC50PD
 10951     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10952        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10953         NEXT SENTENCE                                            ELC50PD
 10954     ELSE                                                         ELC50PD
 10955         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10956            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 10957                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 10958                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 10959                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 10960                                                                  ELC50PD
 10961     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 10962     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 10963                                                                  ELC50PD
 10964     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 10965                                                                  ELC50PD
 10966 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 10967                                                                  ELC50PD
 10968     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 10969     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 10970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10971                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10973                                                                  ELC50PD
 10974 0400-FIND-CARRIER.                                               ELC50PD
 10975                                                                  ELC50PD
 10976     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 10977                                                                  ELC50PD
 10978     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10979     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 10980     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 10981     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 10982                                                                  ELC50PD
 10983*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 10984     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 10985                                    EC-BR-DMD-RATING-SW.          ELC50PD
 10986                                                                  ELC50PD
 10987     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 10988     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 10989                                                                  ELC50PD
 10990     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 10991        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 10992                                                                  ELC50PD
 10993 0400-BUILD-CARR-TOL.                                             ELC50PD
 10994                                                                  ELC50PD
 10995     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 10996        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 10997        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 10998                                    WS-TOL-AH-PREM.               ELC50PD
 10999                                                                  ELC50PD
 11000     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11001        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11002        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11003                                    WS-TOL-AH-REFUND.             ELC50PD
 11004                                                                  ELC50PD
 11005     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11006        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11007        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11008                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11009                                                                  ELC50PD
 11010     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11011        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11012        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11013                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11014                                                                  ELC50PD
 11015     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11016        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11017        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11018                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11019                                                                  ELC50PD
 11020     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11021        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11022        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11023                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11024                                                                  ELC50PD
 11025     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11026         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11027                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11028                                                                  ELC50PD
 11029     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11030     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11031        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11032     END-IF
 11033     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11034        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11035     END-IF
 11036     IF WS-TOL-CLP-PCT = ZEROS
 11037        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11038     END-IF
 11039
 11040     IF WS-SPP-LEASE-COMM = ZEROS
 11041        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11042     END-IF
 11043
 11044     GO TO 0400-FIND-ERPDEF.
 11045                                                                  ELC50PD
 11046 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11047                                                                  ELC50PD
 11048     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11049     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11050                                                                  ELC50PD
 11051 0400-FIND-ERPDEF.
 11052
 11053     IF PB-COMPANY-ID = 'DCC'
 11054        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11055        CONTINUE
 11056     ELSE
 11057        GO TO 0400-FIND-ERCOMP
 11058     END-IF
 11059
 11060     MOVE ' '                    TO PDEF-MASTER-SW
 11061     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11062     MOVE PB-STATE               TO ERPDEF-STATE
 11063     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11064     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11065     IF PB-ISSUE
 11066        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11067     ELSE
 11068        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11069     END-IF
 11070     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11071     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11072     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11073     IF PDEF-MASTER-FOUND
 11074        MOVE 'N'                 TO PDEF-MASTER-SW
 11075        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11076        IF PDEF-MASTER-FOUND
 11077           IF (ERPDEF-KEY-SAVE (1:16) =
 11078                        PD-CONTROL-PRIMARY (1:16))
 11079              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11080              CONTINUE
 11081           ELSE
 11082              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11083              IF (ERPDEF-KEY-SAVE (1:16) =
 11084                        PD-CONTROL-PRIMARY (1:16))
 11085                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11086                 CONTINUE
 11087              ELSE
 11088                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11089              END-IF
 11090           END-IF
 11091        END-IF
 11092        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11093     END-IF
 11094     IF PDEF-MASTER-FOUND
 11095        IF PD-TRUNCATED = 'Y'
 11096           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11097        END-IF
 11098     END-IF
 11099
 11100     .
 11101 0400-FIND-ERCOMP.
 11102
 11103     IF PB-COMPANY-ID = 'DCC'
 11104        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11105           (WS-SUB1 > +10)
 11106           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11107                 OR 'A' OR 'N'
 11108              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11109              MOVE PB-CARRIER    TO COMP-CARRIER
 11110              MOVE PB-GROUPING   TO COMP-GROUPING
 11111              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11112              MOVE AM-AGT (WS-SUB1)
 11113                                 TO COMP-FIN-RESP
 11114              MOVE 'G'           TO COMP-TYPE
 11115              PERFORM 8582-READ-COMPENSATION-MASTER
 11116                                 THRU 8582-EXIT
 11117              IF COMP-MASTER-FOUND
 11118                 IF CO-GA-INACTIVE
 11119                    MOVE ER-2763 TO WS-ERROR
 11120                    PERFORM 9900-ERROR-FORMAT
 11121                                 THRU 9900-EXIT
 11122                    MOVE +11     TO WS-SUB1
 11123                 END-IF
 11124                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11125                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11126                    MOVE ER-2788 TO WS-ERROR
 11127                    PERFORM 9900-ERROR-FORMAT
 11128                                 THRU 9900-EXIT
 11129                    MOVE +11     TO WS-SUB1
 11130                 END-IF
 11131              END-IF
 11132           END-IF
 11133        END-PERFORM
 11134     END-IF
 11135
 11136     IF PB-COMPANY-ID = 'DCC'
 11137        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11138           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11139                                    WS-CLP-STATE
 11140        ELSE
 11141           MOVE SPACES           TO PB-I-CLP-STATE
 11142                                    WS-CLP-STATE
 11143        END-IF
 11144     END-IF
 11145
 11146     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11147        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11148        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11149        CONTINUE
 11150     ELSE
 11151        GO TO 0400-FIND-STATE-RECORD
 11152     END-IF
 11153
 11154     MOVE SPACES                 TO WS-CLP-STATE
 11155     MOVE +0                     TO WS-BANK-FEE
 11156                                    WS-BANK-LFEE
 11157                                    WS-BANK-NOCHRGB
 11158
 11159     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11160
 11161     IF (PB-ISSUE)
 11162        AND (PB-I-BANK-NUMBER NOT =
 11163            SPACES AND ZEROS AND LOW-VALUES)
 11164        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11165     ELSE
 11166        IF (PB-CANCELLATION)
 11167           AND (PB-CI-BANK-NUMBER NOT =
 11168                SPACES AND ZEROS AND LOW-VALUES)
 11169           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11170        END-IF
 11171     END-IF
 11172
 11173     IF COMP-FIN-RESP NOT = LOW-VALUES
 11174        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11175        MOVE PB-CARRIER          TO COMP-CARRIER
 11176        MOVE PB-GROUPING         TO COMP-GROUPING
 11177        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11178        MOVE 'B'                 TO COMP-TYPE
 11179        PERFORM 8582-READ-COMPENSATION-MASTER
 11180                                 THRU 8582-EXIT
 11181        IF COMP-MASTER-FOUND
 11182           IF CO-MAX-BANK-FEE NOT NUMERIC
 11183              MOVE +0            TO CO-MAX-BANK-FEE
 11184           END-IF
 11185           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11186              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11187           END-IF
 11188           IF CO-GA-INACTIVE
 11189              MOVE ER-2763       TO WS-ERROR
 11190              PERFORM 9900-ERROR-FORMAT
 11191                                 THRU 9900-EXIT
 11192           END-IF
 11193           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11194              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11195              MOVE ER-2788 TO WS-ERROR
 11196              PERFORM 9900-ERROR-FORMAT
 11197                                 THRU 9900-EXIT
 11198              MOVE +11     TO WS-SUB1
 11199           END-IF
 11200           IF WS-AH-BEN-CATEGORY = 'G'
 11201              MOVE CO-MAX-BANK-FEE
 11202                                 TO WS-BANK-FEE
 11203                                    PB-I-BANK-FEE
 11204           ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11205              MOVE CO-MAX-BANK-FEE-LEASE
 11206                                 TO WS-BANK-LFEE
 11207                                    PB-I-BANK-FEE
 11208           END-IF
 11209           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11210              AND (WS-AH-REFUND-CALC = 'G'))
 11211                        OR
 11212              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11213              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11214              CONTINUE
 11215           ELSE
 11216              MOVE ER-2789 TO WS-ERROR
 11217              PERFORM 9900-ERROR-FORMAT
 11218                                 THRU 9900-EXIT
 11219           END-IF
 11220           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11221                                    PB-I-CLP-STATE
 11222           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11223           MOVE CO-CARRIER       TO BXRF-CARRIER
 11224           MOVE CO-GROUPING      TO BXRF-GROUPING
 11225           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11226           MOVE BXRF-MAX-REC-LENGTH
 11227                                 TO BXRF-REC-LENGTH
 11228           PERFORM 8584-READ-BANK-CROSS-REF
 11229                                 THRU 8584-EXIT
 11230           IF BXRF-MASTER-FOUND
 11231              MOVE ' '           TO BANK-ACCT-SW
 11232              MOVE BK-BANK-POINTER-CNT
 11233                                 TO BK-BANK-POINTER-CNT
 11234              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11235                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11236                 OR (BANK-ACCT-FOUND)
 11237                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11238                    AND (BK-AM-EXP-DT (WS-SUB1)
 11239                                 > PB-CERT-EFF-DT)
 11240                    AND (BK-AM-EFF-DT (WS-SUB1)
 11241                                 NOT > PB-CERT-EFF-DT)
 11242                    SET BANK-ACCT-FOUND TO TRUE
 11243                 END-IF
 11244              END-PERFORM
 11245              IF NOT BANK-ACCT-FOUND
 11246                 MOVE ZEROS      TO WS-BANK-FEE
 11247                                    WS-BANK-LFEE
 11248                 MOVE ER-2869    TO WS-ERROR
 11249                 PERFORM 9900-ERROR-FORMAT
 11250                                 THRU 9900-EXIT
 11251              ELSE
 11252                 PERFORM 5000-PROCESS-REPS
 11253                                 THRU 5000-EXIT
 11254                 IF AGENT-MASTER-FOUND
 11255                    MOVE +0      TO WS-BANK-FEE
 11256                                    WS-BANK-LFEE
 11257*                   MOVE AG-SPP-FEES (1)
 11258*                                TO PB-I-BANK-FEE
 11259*                                   WS-BANK-FEE
 11260                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11261                       (WS-SUB1 > +10)
 11262                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11263                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11264                       END-IF
 11265                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11266                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11267                       END-IF
 11268                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11269                          AG-SPP-FEES (WS-SUB1)
 11270                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11271                          AG-SPP-LFEES (WS-SUB1)
 11272                    END-PERFORM
 11273                    IF WS-AH-BEN-CATEGORY = 'G'
 11274                       MOVE WS-BANK-FEE
 11275                                 TO PB-I-BANK-FEE
 11276                    ELSE
 11277                       MOVE WS-BANK-LFEE
 11278                                 TO PB-I-BANK-FEE
 11279                    END-IF
 11280                 END-IF
 11281              END-IF
 11282           END-IF
 11283        ELSE
 11284           MOVE ER-2879          TO WS-ERROR
 11285           PERFORM 9900-ERROR-FORMAT
 11286                                 THRU 9900-EXIT
 11287        END-IF
 11288     ELSE
 11289        MOVE ER-2879             TO WS-ERROR
 11290        PERFORM 9900-ERROR-FORMAT
 11291                                 THRU 9900-EXIT
 11292     END-IF
 11293
 11294     IF WS-AH-BEN-CATEGORY = 'G'
 11295        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11296        + WS-BANK-FEE
 11297     ELSE
 11298        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11299        + WS-BANK-LFEE
 11300     END-IF
 11301
 11302     .
 11303 0400-FIND-STATE-RECORD.                                          ELC50PD
 11304                                                                  ELC50PD
 11305     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11306         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11307         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11308         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11309         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11310         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11311             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11312         ELSE                                                     ELC50PD
 11313             NEXT SENTENCE                                        ELC50PD
 11314     ELSE                                                         ELC50PD
 11315         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11316                                                                  ELC50PD
 11317     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11318     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11319     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11320     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11321                                                                  ELC50PD
 11322     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11323     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11324                                                                  ELC50PD
 11325     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11326        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11327        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11328        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11329                                    WS-TOL-AH-CLAIM               ELC50PD
 11330                                    WS-MINIMUM-REFUND             ELC50PD
 11331                                    WS-TOL-LF-PREM                ELC50PD
 11332                                    WS-TOL-AH-PREM                ELC50PD
 11333                                    WS-TOL-LF-REFUND              ELC50PD
 11334                                    WS-TOL-AH-REFUND              ELC50PD
 11335                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11336                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11337                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11338                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11339                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11340                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11341                                    EC-ST-TOL-PREM                ELC50PD
 11342                                    EC-ST-TOL-REFUND              ELC50PD
 11343                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11344                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11345                                    WS-ST-LF-PREM-TAX
 11346                                    WS-ST-AH-PREM-TAX-I
 11347                                    WS-ST-AH-PREM-TAX-G
 11348                                    WS-BANK-FEE
 11349                                    WS-BANK-LFEE
 11350                                    WS-TOL-CLP-PCT
 11351                                    WS-SPP-LEASE-COMM
 11352        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11353                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11354                                    WS-LF-REM-TERM-CALC           ELC50PD
 11355                                    WS-LF-REFUND-CALC             ELC50PD
 11356                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11357                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11358                                    WS-AH-REM-TERM-CALC           ELC50PD
 11359                                    WS-AH-REFUND-CALC
 11360                                    WS-LF-BEN-CATEGORY
 11361                                    WS-AH-BEN-CATEGORY
 11362                                    WS-CLP-STATE
 11363                                    WS-ST-REFUND-CLAIM-FLAG
 11364                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11365                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11366          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11367                                                                  ELC50PD
 11368     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11369                                                                  ELC50PD
 11370 0405-CONTINUE-EDIT.                                              ELC50PD
 11371
 11372     if pb-company-id = 'AHL'
 11373        continue
 11374     else
 11375        IF PB-CERT-PRIME NOT NUMERIC
 11376           MOVE ER-2722          TO WS-ERROR
 11377           PERFORM 9900-ERROR-FORMAT
 11378                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11379        end-if
 11380     END-IF
 11381
 11382*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11383*       MOVE +0                  TO SUB3
 11384*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11385*       IF SUB3 > +0
 11386*          MOVE ER-2722          TO WS-ERROR
 11387*          PERFORM 9900-ERROR-FORMAT
 11388*                                THRU 9900-EXIT
 11389*       END-IF
 11390*    END-IF
 11391
 11392
 11393*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11394*       IF PB-CERT-PRIME NOT NUMERIC
 11395*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11396*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11397*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11398*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11399*
 11400*          MOVE ER-2722          TO WS-ERROR
 11401*          PERFORM 9900-ERROR-FORMAT
 11402*                                THRU 9900-EXIT
 11403*       END-IF
 11404*    END-IF
 11405
 11406     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11407                                                                  ELC50PD
 11408     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11409        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11410                                    WS-TOL-AH-CLAIM.              ELC50PD
 11411                                                                  ELC50PD
 11412     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11413        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11414                                                                  ELC50PD
 11415     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11416        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11417                                                                  ELC50PD
 11418     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11419        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11420                                    WS-TOL-AH-PREM                ELC50PD
 11421        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11422                                                                  ELC50PD
 11423     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11424        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11425                                    WS-TOL-AH-REFUND              ELC50PD
 11426        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11427                                                                  ELC50PD
 11428     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11429        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11430        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11431                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11432                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11433                                                                  ELC50PD
 11434     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11435        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11436        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11437                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11438                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11439                                                                  ELC50PD
 11440     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11441        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11442        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11443                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11444                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11445                                                                  ELC50PD
 11446     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11447        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11448        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11449                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11450                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11451                                                                  ELC50PD
 11452     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11453     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11454                                                                  ELC50PD
 11455     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11456          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11457                                                                  ELC50PD
 11458     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11459     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11460
 11461     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11462                                                                  ELC50PD
 11463     IF CF-ST-LF-PREM-TAX NUMERIC
 11464        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11465     END-IF
 11466     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11467        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11468     END-IF
 11469     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11470        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11471     END-IF
 11472
 11473     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11474         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11475     END-IF.
 11476
 11477     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11478        GO TO 0410-CHECK-AH.                                      ELC50PD
 11479                                                                  ELC50PD
 11480     IF CF-ST-RT-CALC NOT = SPACES
 11481        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11482                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11483     END-IF
 11484
 11485     IF WS-LF-COVERAGE-TYPE = 'R'
 11486        IF WS-LF-EARNINGS-CALC = '5'
 11487           IF CF-ST-RF-LN-CALC > '0'
 11488              MOVE CF-ST-RF-LN-CALC
 11489                                 TO WS-LF-REFUND-CALC
 11490                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11491           END-IF
 11492        ELSE
 11493           IF CF-ST-RF-LR-CALC > '0'
 11494              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11495                                 TO WS-LF-REFUND-CALC
 11496                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11497           END-IF
 11498        END-IF
 11499     ELSE
 11500        IF CF-ST-RF-LL-CALC > '0'
 11501           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11502                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11503        END-IF
 11504     END-IF
 11505
 11506     IF CF-ST-RT-CALC NOT = SPACES
 11507        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11508                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11509     END-IF
 11510
 11511     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11512     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11513                                                                  ELC50PD
 11514     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11515                                                                  ELC50PD
 11516     IF NO-BENEFIT-FOUND                                          ELC50PD
 11517        GO TO 0410-CHECK-AH.                                      ELC50PD
 11518                                                                  ELC50PD
 11519     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11520        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11521                                 TO EC-ST-LF-REM-TERM-CALC
 11522                                    WS-LF-REM-TERM-CALC           ELC50PD
 11523     END-IF
 11524                                                                  ELC50PD
 11525     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11526        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11527                                 TO WS-LF-REFUND-CALC             ELC50PD
 11528                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11529     END-IF
 11530*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11531                                                                  ELC50PD
 11532     .                                                            ELC50PD
 11533 0410-CHECK-AH.                                                   ELC50PD
 11534                                                                  ELC50PD
 11535     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11536        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11537                                                                  ELC50PD
 11538     IF CF-ST-RT-CALC NOT = SPACES
 11539        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11540                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11541     END-IF
 11542
 11543     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11544        IF CF-ST-RF-CP-CALC > '0'
 11545           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11546                                    EC-ST-AH-REFUND-CALC
 11547        END-IF
 11548     ELSE
 11549        IF CF-ST-RF-AH-CALC > '0'
 11550           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11551                                    EC-ST-AH-REFUND-CALC
 11552        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11553     END-IF
 11554     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11555     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11556                                                                  ELC50PD
 11557     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11558                                                                  ELC50PD
 11559     IF NO-BENEFIT-FOUND                                          ELC50PD
 11560        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11561                                                                  ELC50PD
 11562     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11563        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11564                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11565                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11566     END-IF
 11567                                                                  ELC50PD
 11568     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11569        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11570                                 TO WS-AH-REFUND-CALC             ELC50PD
 11571                                    EC-ST-AH-REFUND-CALC
 11572     END-IF
 11573                                                                  ELC50PD
 11574*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11575                                                                  ELC50PD
 11576     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11577                                                                  ELC50PD
 11578 0499-STATE-NOT-FOUND.                                            ELC50PD
 11579                                                                  ELC50PD
 11580     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11582                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11584                                                                  ELC50PD
 11585 0500-SET-ACCOUNT.                                                ELC50PD
 11586
 11587*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11588
 11589     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11590        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11591        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11592        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11593        MOVE '3'                 TO CNTL-REC-TYPE
 11594        MOVE +0                  TO CNTL-SEQ-NO
 11595
 11596        MOVE '3'                 TO RC-SW-2
 11597        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11598
 11599        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11600           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11601           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11602           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11603                                    WS-ST-AH-PREM-TAX-I
 11604                                    WS-ST-AH-PREM-TAX-G
 11605        ELSE
 11606           IF CF-ST-LF-PREM-TAX NUMERIC
 11607              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11608           END-IF
 11609           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11610              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11611           END-IF
 11612           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11613              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11614           END-IF
 11615        END-IF
 11616        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11617     END-IF
 11618
 11619*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11620*  FOR DCC ONLY
 11621
 11622     IF PB-COMPANY-ID = 'DCC'
 11623
 11624     MOVE ' '                    TO STAT-MASTER-SW
 11625     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11626     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11627     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11628     MOVE PB-STATE               TO ELSTAT-STATE
 11629     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11630        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11631     END-IF
 11632
 11633     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11634     SET BIN-TO-GREG             TO TRUE
 11635     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11636     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11637     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11638
 11639     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11640     IF STAT-MASTER-FOUND
 11641        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11642        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11643        IF STAT-MASTER-FOUND
 11644           IF (ELSTAT-KEY-SAVE (1:12) =
 11645                        SF-CONTROL-PRIMARY (1:12))
 11646              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11647                 MOVE 'F'        TO STAT-MASTER-SW
 11648              ELSE
 11649                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11650                 IF (STAT-MASTER-FOUND)
 11651                    AND (ELSTAT-KEY-SAVE (1:12) =
 11652                        SF-CONTROL-PRIMARY (1:12))
 11653                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11654                    MOVE 'F'     TO STAT-MASTER-SW
 11655                 END-IF
 11656              END-IF
 11657           END-IF
 11658        END-IF
 11659     END-IF
 11660
 11661     IF STAT-MASTER-SW = 'F'
 11662        IF SF-ST-LF-PREM-TAX NUMERIC
 11663           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11664        END-IF
 11665        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11666           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11667        END-IF
 11668        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11669           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11670        END-IF
 11671     END-IF
 11672
 11673     END-IF
 11674
 11675     IF (PB-COMPANY-ID = 'DCC')
 11676        AND (PB-ISSUE)
 11677        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11678        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11679        AND (AM-GPCD = 06)
 11680        MOVE 'Y'                 TO WS-GOOD-HIN
 11681        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11682           MOVE PB-I-VIN         TO WS-WORK-VIN
 11683           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11684              (V1 > 16)
 11685              IF WS-WORK-VIN (V1:1) NUMERIC
 11686                 MOVE WS-WORK-VIN-N (V1)
 11687                                 TO WS-ROW-B-VAL (V1)
 11688              ELSE
 11689                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11690                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11691                    OR (V2 > 26)
 11692                 END-PERFORM
 11693                 IF V2 < 27
 11694                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11695                 ELSE
 11696                    MOVE 'N'     TO WS-GOOD-HIN
 11697                 END-IF
 11698              END-IF
 11699              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11700                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11701              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11702                 WS-ROW-D-VAL (V1)
 11703           END-PERFORM
 11704           MOVE ZEROS            TO WS-VIN-REMAINDER
 11705           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11706             REMAINDER WS-VIN-REMAINDER
 11707           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11708              CONTINUE
 11709           ELSE
 11710              MOVE 'N'           TO WS-GOOD-HIN
 11711           END-IF
 11712        ELSE
 11713           MOVE 'N'              TO WS-GOOD-HIN
 11714        END-IF
 11715        IF WS-GOOD-HIN NOT = 'Y'
 11716           MOVE ER-3826           TO WS-ERROR
 11717           PERFORM 9900-ERROR-FORMAT
 11718                                 THRU 9900-EXIT
 11719        END-IF
 11720     END-IF
 11721
 11722     IF (PB-COMPANY-ID = 'DCC')
 11723        AND (PB-ISSUE)
 11724        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11725        AND (AM-GPCD NOT = 06)
 11726        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11727          MOVE PB-I-VIN          TO WS-WORK-VIN
 11728          MOVE +8                TO V2
 11729          MOVE ZEROS             TO WS-VIN-TOTAL
 11730          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11731           (V1 > 17)
 11732             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11733                MOVE ER-3825     TO WS-ERROR
 11734                PERFORM 9900-ERROR-FORMAT
 11735                                 THRU 9900-EXIT
 11736             ELSE
 11737                IF V1 = 8
 11738                   MOVE 10       TO V2
 11739                END-IF
 11740                IF V1 = 9
 11741                   MOVE 0        TO V2
 11742                END-IF
 11743                IF V1 = 10
 11744                   MOVE 9        TO V2
 11745                END-IF
 11746                IF WS-WORK-VIN (V1:1) NUMERIC
 11747                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11748                    + (WS-WORK-VIN-N (V1) * V2)
 11749                ELSE
 11750                   MOVE WS-WORK-VIN (V1:1)
 11751                                 TO WS-HEX-BYTE
 11752                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11753                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11754                    + (WS-NUM (V3) * V2)
 11755                END-IF
 11756                COMPUTE V2 = V2 - 1
 11757             END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11758          END-PERFORM
 11759          MOVE ZEROS TO WS-VIN-REMAINDER
 11760          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11761             REMAINDER WS-VIN-REMAINDER
 11762          IF ((WS-WORK-VIN (9:1) = 'X')
 11763             AND (WS-VIN-REMAINDER = 10))
 11764                     OR
 11765             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11766             CONTINUE
 11767          ELSE
 11768             MOVE ER-3826        TO WS-ERROR
 11769             PERFORM 9900-ERROR-FORMAT
 11770                                 THRU 9900-EXIT
 11771          END-IF
 11772        ELSE
 11773          MOVE ER-3826           TO WS-ERROR
 11774          PERFORM 9900-ERROR-FORMAT
 11775                                 THRU 9900-EXIT
 11776        END-IF
 11777     END-IF
 11778
 11779
 11780
 11781******************************************************************ELC50PD
 11782******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11783******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11784******* METHODS.                                                  ELC50PD
 11785******************************************************************ELC50PD
 11786     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11787        IF PB-CANCELLATION                                        ELC50PD
 11788           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11789              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11790                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11791                IF FORM-MASTER-FOUND                              ELC50PD
 11792                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11793******************************************************************ELC50PD
 11794                                                                  ELC50PD
 11795     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11796     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11797                                                                  ELC50PD
 11798     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11799     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11800     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11801     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11802                                                                  ELC50PD
 11803                                                                  ELC50PD
 11804     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11805     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11806     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11807                                                                  ELC50PD
 11808     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11809         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11810                                                                  ELC50PD
 11811     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11812         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11813                                                                  ELC50PD
 11814     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11815         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11816                                                                  ELC50PD
 11817     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11818         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11819     ELSE                                                         ELC50PD
 11820         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11821                                                                  ELC50PD
 11822     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11823                                                                  ELC50PD
 11824     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11825         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11826                                                                  ELC50PD
 11827     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11828         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11829                                       WS-IG-OVRD                 ELC50PD
 11830     ELSE                                                         ELC50PD
 11831         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11832             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11833                                       WS-IG-OVRD                 ELC50PD
 11834         ELSE                                                     ELC50PD
 11835             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11836                                       WS-IG-OVRD.                ELC50PD
 11837                                                                  ELC50PD
 11838     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11839         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11840                                       WS-IG-OVRD                 ELC50PD
 11841     ELSE                                                         ELC50PD
 11842         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11843             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11844                                       WS-IG-OVRD                 ELC50PD
 11845         ELSE                                                     ELC50PD
 11846             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11847                                       WS-IG-OVRD.                ELC50PD
 11848                                                                  ELC50PD
 11849     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11850     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11851     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11852     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11853     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11854                                                                  ELC50PD
 11855     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11856     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11857     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11858     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11859                                                                  ELC50PD
 11860     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11861     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11862     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11863     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11864     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11865     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11866     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11867                                                                  ELC50PD
 11868     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11869        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11870     ELSE                                                         ELC50PD
 11871        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11872                                                                  ELC50PD
 11873     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11874        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11875     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11876        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11877                                                                  ELC50PD
 11878        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11879            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11880                                        WS-LF-REFUND-CALC.        ELC50PD
 11881                                                                  ELC50PD
 11882        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11883            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11884                                        WS-LF-REFUND-CALC.        ELC50PD
 11885                                                                  ELC50PD
 11886     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11887         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11888            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11889                                    WS-LF-REFUND-CALC.            ELC50PD
 11890     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11891         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11892            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11893                                    WS-LF-REFUND-CALC.            ELC50PD
 11894     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11895         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11896            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11897                                    WS-LF-REFUND-CALC.            ELC50PD
 11898     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11899         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11900            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11901                                    WS-LF-REFUND-CALC.            ELC50PD
 11902     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11903         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11904            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11905                                    WS-LF-REFUND-CALC.            ELC50PD
 11906     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11907         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11908            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11909                                    WS-LF-REFUND-CALC.            ELC50PD
 11910     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11911         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 11912            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11913                                    WS-LF-REFUND-CALC.            ELC50PD
 11914     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11915         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 11916            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11917                                    WS-LF-REFUND-CALC.            ELC50PD
 11918                                                                  ELC50PD
 11919     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 11920        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11921                                    WS-AH-REFUND-CALC.            ELC50PD
 11922     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 11923        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11924                                    WS-AH-REFUND-CALC.            ELC50PD
 11925     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 11926        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11927                                    WS-AH-REFUND-CALC.            ELC50PD
 11928     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 11929        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11930                                    WS-AH-REFUND-CALC.            ELC50PD
 11931     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11932        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11933                                    WS-AH-REFUND-CALC.            ELC50PD
 11934     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 11935        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11936                                    WS-AH-REFUND-CALC.            ELC50PD
 11937     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 11938        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11939                                    WS-AH-REFUND-CALC.            ELC50PD
 11940                                                                  ELC50PD
 11941     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 11942        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 11943                                    WS-TOL-AH-PREM.               ELC50PD
 11944                                                                  ELC50PD
 11945     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 11946                  AM-OVR-SHT-AMT > 0                              ELC50PD
 11947        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11948                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 11949                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11950                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 11951                                                                  ELC50PD
 11952     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 11953                    AM-OVR-SHT-PCT > 0                            ELC50PD
 11954        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11955                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 11956                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11957                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 11958                                                                  ELC50PD
 11959     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 11960                  AM-TOL-REF-PCT > 0                              ELC50PD
 11961        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 11962                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11963                                                                  ELC50PD
 11964     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 11965                  AM-TOL-REF NUMERIC                              ELC50PD
 11966        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 11967                                    EC-AM-LF-TOL-REFUND           ELC50PD
 11968                                    WS-TOL-AH-REFUND              ELC50PD
 11969                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 11970                                                                  ELC50PD
 11971     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 11972        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 11973                                    WS-TOL-AH-CLAIM.              ELC50PD
 11974                                                                  ELC50PD
 11975     IF AM-CLP-TOL-PCT NOT NUMERIC
 11976        MOVE +0                  TO AM-CLP-TOL-PCT
 11977     END-IF
 11978
 11979     IF AM-SPP-LEASE-COMM NOT NUMERIC
 11980        MOVE +0                  TO AM-SPP-LEASE-COMM
 11981     END-IF
 11982
 11983     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 11984        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 11985                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 11986                                                                  ELC50PD
 11987     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 11988        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 11989                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11990                                                                  ELC50PD
 11991     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 11992        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 11993                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 11994                                                                  ELC50PD
 11995     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 11996        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 11997                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 11998                                                                  ELC50PD
 11999     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12000        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12001                                                                  ELC50PD
 12002     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12003        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12004                                                                  ELC50PD
 12005     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12006        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12007     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12008        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12009     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12010        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12011     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12012        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12013     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12014        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12015     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12016        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12017                                                                  ELC50PD
 12018     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12019        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12020                                                                  ELC50PD
 12021     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12022        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12023                                                                  ELC50PD
 12024     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12025     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12026                                                                  ELC50PD
 12027     IF PB-CANCELLATION                                           ELC50PD
 12028        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12029                                                                  ELC50PD
 12030     MOVE +1 TO SUB1.                                             ELC50PD
 12031     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12032     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12033                                                                  ELC50PD
 12034     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12035       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12036         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12037        ELSE                                                      ELC50PD
 12038         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12039                                                                  ELC50PD
 12040  0525-FIND-ACCT-COMM.                                            ELC50PD
 12041     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12042        NEXT SENTENCE                                             ELC50PD
 12043      ELSE                                                        ELC50PD
 12044         ADD +1 TO SUB1                                           ELC50PD
 12045         IF SUB1 LESS +11                                         ELC50PD
 12046            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12047          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12048             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12049                                                                  ELC50PD
 12050     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12051     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12052                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12053***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12054     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12055         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12056                                                                  ELC50PD
 12057     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12058     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12059                                                                  ELC50PD
 12060                                                                  ELC50PD
 12061 0530-GET-AH-COMP.                                                ELC50PD
 12062     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12063        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12064           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12065                                                                  ELC50PD
 12066     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12067        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12068         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12069         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12070         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12071         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12072     ELSE                                                         ELC50PD
 12073          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12074          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12075          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12076          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12077                                    WS-COMMISSION                 ELC50PD
 12078          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12079          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12080          IF WS-COMMISSION > ZEROS                                ELC50PD
 12081             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12082             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12083          END-IF                                                  ELC50PD
 12084          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12085          IF CTBL-TABLE-FOUND                                     ELC50PD
 12086             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12087                                        PB-I-AH-TERM              ELC50PD
 12088             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12089             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12090             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12091          ELSE                                                    ELC50PD
 12092             IF FIRST-TIME-THROUGH                                ELC50PD
 12093                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12094             ELSE                                                 ELC50PD
 12095                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12096                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12097                                                                  ELC50PD
 12098 0540-NEXT-READ-STEP.                                             ELC50PD
 12099     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12100     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12101                                                                  ELC50PD
 12102 0540-GET-LF-COMP.                                                ELC50PD
 12103     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12104        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12105           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12106                                                                  ELC50PD
 12107     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12108        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12109           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12110           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12111           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12112           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12113           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12114        ELSE                                                      ELC50PD
 12115           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12116           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12117           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12118           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12119                                        WS-COMMISSION             ELC50PD
 12120           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12121           IF WS-COMMISSION > ZEROS                               ELC50PD
 12122              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12123              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12124           END-IF                                                 ELC50PD
 12125           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12126           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12127           IF CTBL-TABLE-FOUND                                    ELC50PD
 12128              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12129              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12130              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12131              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12132           ELSE                                                   ELC50PD
 12133              IF FIRST-TIME-THROUGH                               ELC50PD
 12134                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12135              ELSE                                                ELC50PD
 12136                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12137                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12138                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12139                                                                  ELC50PD
 12140     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12141        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12142           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12143           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12144           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12145           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12146           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12147        ELSE                                                      ELC50PD
 12148           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12149           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12150           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12151           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12152                                        WS-COMMISSION             ELC50PD
 12153           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12154           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12155              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12156              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12157           END-IF                                                 ELC50PD
 12158           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12159           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12160           IF CTBL-TABLE-FOUND                                    ELC50PD
 12161              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12162              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12163              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12164              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12165           ELSE                                                   ELC50PD
 12166              IF FIRST-TIME-THROUGH                               ELC50PD
 12167                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12168              ELSE                                                ELC50PD
 12169                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12170                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12171                                                                  ELC50PD
 12172*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12173                                                                  ELC50PD
 12174 0560-EDIT-CONTINUE.                                              ELC50PD
 12175
 12176     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12177                                    WS-AH-PMF-COMM
 12178*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12179*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12180
 12181     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12182        (SUB1 > +10)
 12183        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12184           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12185           MOVE '0530'           TO CTBL-SW
 12186           MOVE ' '              TO WS-CTBL-READ-SW
 12187           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12188           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12189           MOVE '0540'           TO CTBL-SW
 12190           MOVE ' '              TO WS-CTBL-READ-SW
 12191           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12192        END-IF
 12193     END-PERFORM
 12194
 12195     GO TO 0564-EDIT-CONTINUE
 12196
 12197     .
 12198 0561-CHECK-AH.
 12199
 12200     IF (NO-AH-COVERAGE)
 12201        OR (NO-AH-BENEFIT-MATCH)
 12202        CONTINUE
 12203     ELSE
 12204        IF (AM-A-COM (SUB1) NUMERIC)
 12205           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12206           IF (AM-COM-TYP (SUB1) = 'A')
 12207              AND (WS-AH-PMF-COMM = ZEROS)
 12208              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12209           END-IF
 12210           CONTINUE
 12211        ELSE
 12212           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12213           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12214           MOVE PB-AH-OVERRIDE-L1
 12215                                 TO CTBL-BEN-TYPE
 12216           MOVE ZEROS            TO WS-SUB1
 12217                                    WS-COMMISSION
 12218           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12219           PERFORM 8300-READ-CTBL-TABLE
 12220                                 THRU 8300-EXIT
 12221           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12222              IF (AM-COM-TYP (SUB1) = 'A')
 12223                 AND (WS-AH-PMF-COMM = ZEROS)
 12224                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12225                                        PB-I-AH-TERM
 12226                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12227                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12228              END-IF
 12229              CONTINUE
 12230           ELSE
 12231              IF FIRST-TIME-THROUGH
 12232                 GO TO 0561-CHECK-AH
 12233              ELSE
 12234                 MOVE ER-2609    TO WS-ERROR
 12235                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12236              END-IF
 12237           END-IF
 12238        END-IF
 12239     END-IF
 12240
 12241     .
 12242 0561-EXIT.
 12243     EXIT.
 12244
 12245 0563-CHECK-LF.
 12246
 12247     IF (NO-LIFE-COVERAGE)
 12248        OR (NO-LF-BENEFIT-MATCH)
 12249        CONTINUE
 12250     ELSE
 12251        IF WS-LF-JOINT-INDICATOR = 'J'
 12252           IF AM-J-COM (SUB1) NUMERIC
 12253              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12254              IF (AM-COM-TYP (SUB1) = 'A')
 12255                 AND (WS-LF-PMF-COMM = ZEROS)
 12256                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12257              END-IF
 12258              CONTINUE
 12259           ELSE
 12260              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12261              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12262              MOVE PB-LIFE-OVERRIDE-L1
 12263                                 TO CTBL-BEN-TYPE
 12264              MOVE ZEROS         TO WS-SUB1
 12265                                    WS-COMMISSION
 12266              MOVE AM-J-COMA (SUB1)
 12267                                 TO CTBL-TABLE
 12268              PERFORM 8300-READ-CTBL-TABLE
 12269                                 THRU 8300-EXIT
 12270              IF CTBL-TABLE-FOUND
 12271                 IF (AM-COM-TYP (SUB1) = 'A')
 12272                    AND (WS-LF-PMF-COMM = ZEROS)
 12273                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12274                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12275                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12276                 END-IF
 12277                 CONTINUE
 12278              ELSE
 12279                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12280                    GO TO 0563-CHECK-LF
 12281                 ELSE
 12282                    MOVE ER-2609 TO WS-ERROR
 12283                    PERFORM 9900-ERROR-FORMAT
 12284                                 THRU 9900-EXIT
 12285*                   GO TO 0560-EDIT-CONTINUE
 12286                 END-IF
 12287              END-IF
 12288           END-IF
 12289        ELSE
 12290           IF AM-L-COM (SUB1) NUMERIC
 12291              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12292              IF (AM-COM-TYP (SUB1) = 'A')
 12293                 AND (WS-LF-PMF-COMM = ZEROS)
 12294                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12295              END-IF
 12296              CONTINUE
 12297           ELSE
 12298              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12299              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12300              MOVE PB-LIFE-OVERRIDE-L1
 12301                                 TO CTBL-BEN-TYPE
 12302              MOVE ZEROS         TO WS-SUB1
 12303                                    WS-COMMISSION
 12304              MOVE AM-L-COMA (SUB1)
 12305                                 TO CTBL-TABLE
 12306              PERFORM 8300-READ-CTBL-TABLE
 12307                                 THRU 8300-EXIT
 12308              IF CTBL-TABLE-FOUND
 12309                 CONTINUE
 12310              ELSE
 12311                 IF FIRST-TIME-THROUGH
 12312                    GO TO 0563-CHECK-LF
 12313                 ELSE
 12314                    MOVE ER-2609 TO WS-ERROR
 12315                    PERFORM 9900-ERROR-FORMAT
 12316                                 THRU 9900-EXIT
 12317                 END-IF
 12318              END-IF
 12319           END-IF
 12320        END-IF
 12321     END-IF
 12322
 12323     .
 12324 0563-EXIT.
 12325     EXIT.
 12326
 12327 0564-EDIT-CONTINUE.
 12328                                                                  ELC50PD
 12329     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12330         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12331            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12332            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12333                                                                  ELC50PD
 12334*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12335*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12336*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12337*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12338*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12339*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12340*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12341*         ELSE                                                    ELC50PD
 12342*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12343*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12344
 12345     IF PB-I-BIRTHDAY > LOW-VALUES
 12346        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12347        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12348        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12349        PERFORM 8500-DATE-CONVERT
 12350                                 THRU 8500-EXIT
 12351        IF NO-CONVERSION-ERROR
 12352           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12353           IF PB-I-AGE > ZEROS
 12354              IF WS-WORK-AGE NOT = PB-I-AGE
 12355                 MOVE ER-9501    TO WS-ERROR
 12356                 PERFORM 9900-ERROR-FORMAT
 12357                                 THRU 9900-EXIT
 12358              END-IF
 12359           ELSE
 12360              MOVE WS-WORK-AGE   TO PB-I-AGE
 12361           END-IF
 12362        END-IF
 12363     END-IF
 12364
 12365     IF PB-I-AGE = ZEROS                                          ELC50PD
 12366        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12367           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12368                                                                  ELC50PD
 12369     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12370                                   WS-AH-EDIT-AGE.                ELC50PD
 12371                                                                  ELC50PD
 12372     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12373        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12374        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12375        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12376        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12377        IF NO-CONVERSION-ERROR
 12378           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12379           IF PB-I-JOINT-AGE > 0
 12380              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12381                 MOVE ER-9503    TO WS-ERROR
 12382                 PERFORM 9900-ERROR-FORMAT
 12383                                 THRU 9900-EXIT
 12384              END-IF
 12385           ELSE
 12386              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12387           END-IF
 12388        ELSE
 12389           MOVE ZEROS            TO PB-I-JOINT-AGE
 12390        END-IF
 12391     END-IF
 12392
 12393     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12394        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12395                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12396     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12397        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12398           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12399           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12400               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12401           END-IF
 12402        END-IF
 12403     END-IF
 12404                                                                  ELC50PD
 12405     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12406     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12407        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12408        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12409            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12410                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12411                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12412            ELSE                                                  ELC50PD
 12413                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12414                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12415                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12416                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12417                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12418                                                                  ELC50PD
 12419     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12420        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12421            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12422                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12423                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12424            ELSE                                                  ELC50PD
 12425                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12426                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12427                                           WS-EDIT-AGE
 12428                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12429                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12430                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12431                                                                  ELC50PD
 12432******************************************************************ELC50PD
 12433*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12434******************************************************************ELC50PD
 12435                                                                  ELC50PD
 12436     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12437        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12438        NEXT SENTENCE                                             ELC50PD
 12439     ELSE                                                         ELC50PD
 12440        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12441          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12442           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12443            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12444           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12445            MOVE ER-2627             TO WS-ERROR                  ELC50PD
 12446            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12447                                                                  ELC50PD
 12448     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12449        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12450         NEXT SENTENCE                                            ELC50PD
 12451     ELSE                                                         ELC50PD
 12452         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12453            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12454             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12455                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12456                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12457                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12458                                                                  ELC50PD
 12459     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12460        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12461           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12462           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12463               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12464                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12465                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12466                                                                  ELC50PD
 12467     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12468        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12469           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12470            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12471                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12472                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12473                                                                  ELC50PD
 12474     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12475        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12476           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12477              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12478              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12479              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12480                                                                  ELC50PD
 12481     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12482        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12483           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12484              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12485              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12486              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12487                                                                  ELC50PD
 12488     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12489         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12490            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12491              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12492              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12493
 12494     IF (WS-LF-JOINT-INDICATOR = 'J')
 12495        AND (WS-AH-JOINT-INDICATOR = 'J')
 12496        AND (PB-I-LF-TERM > 120)
 12497        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12498        MOVE ER-2783             TO WS-ERROR
 12499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12500     END-IF
 12501
 12502     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12503                                                                  ELC50PD
 12504     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12505        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12507        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12508                                                                  ELC50PD
 12509     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12510        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12512        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12513                                                                  ELC50PD
 12514     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12515        NEXT SENTENCE                                             ELC50PD
 12516     ELSE                                                         ELC50PD
 12517        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12518                                                                  ELC50PD
 12519     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12520        IF WS-ERROR = ER-2666                                     ELC50PD
 12521           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12522           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12523
 12524     IF PB-COMPANY-ID = 'CID'
 12525        IF PB-STATE = 'UT' OR 'MO'
 12526           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12527                 OR '76' OR '77')
 12528                      OR
 12529               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12530                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12531                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12532                   OR '2K' OR '2L'))
 12533              AND PB-I-INDV-GRP-CD = 'I'
 12534              MOVE ER-2721             TO WS-ERROR
 12535              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12536           END-IF
 12537        END-IF
 12538     END-IF
 12539                                                                  ELC50PD
 12540     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12541     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12542        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12543     ELSE
 12544        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12545     END-IF
 12546
 12547*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12548*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12549     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12550                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12551                                                                  ELC50PD
 12552     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12553        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12554        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12555        PB-POLICY-IS-VOIDED                                       ELC50PD
 12556*       OR PB-MONTHLY-CERT
 12557         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12558                                                                  ELC50PD
 12559     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12560        IF WS-EDIT-AGE           > +65
 12561           MOVE ER-2709          TO WS-ERROR
 12562           PERFORM 9900-ERROR-FORMAT
 12563                                 THRU 9900-EXIT
 12564        ELSE
 12565           IF WS-EDIT-AGE        > +55
 12566              MOVE ER-2718       TO WS-ERROR
 12567              PERFORM 9900-ERROR-FORMAT
 12568                                 THRU 9900-EXIT
 12569           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12570        END-IF
 12571
 12572     IF PB-COMPANY-ID = 'DCC'
 12573        IF WS-EDIT-AGE           > +65
 12574           MOVE ER-2709          TO WS-ERROR
 12575           PERFORM 9900-ERROR-FORMAT
 12576                                 THRU 9900-EXIT
 12577        END-IF
 12578     END-IF
 12579     .
 12580
 12581 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12582                                                                  ELC50PD
 12583     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12584        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12585                                    EC-AM-LF-MAX-TOT-BEN
 12586        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12587                                                                  ELC50PD
 12588     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12589                                                                  ELC50PD
 12590     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12591         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12592             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12593                                                                  ELC50PD
 12594     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12595        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12596        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12597        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12598                                                                  ELC50PD
 12599     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12600     MOVE +1                     TO SUB2.                         ELC50PD
 12601                                                                  ELC50PD
 12602     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12603        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12604           MOVE +5   TO SUB2                                      ELC50PD
 12605           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12606              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12607              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12608              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12609              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12610                                                                  ELC50PD
 12611     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12612                                                                  ELC50PD
 12613     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12614                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12615                                                                  ELC50PD
 12616 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12617                                                                  ELC50PD
 12618
 12619     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12620        PL-ATT-AGE > +0
 12621        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12622     END-IF
 12623
 12624
 12625
 12626*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12627*       PL-ATT-AGE > +0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12628*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12629*       IF PB-I-BIRTHDAY > LOW-VALUES
 12630*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12631*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12632*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12633*          SET BIN-PLUS-ELAPSED  TO TRUE
 12634*          PERFORM 8500-DATE-CONVERT
 12635*                                THRU 8500-EXIT
 12636*          IF NO-CONVERSION-ERROR
 12637*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12638*             MOVE ER-2669       TO WS-ERROR
 12639*             PERFORM 9900-ERROR-FORMAT
 12640*                                THRU 9900-EXIT
 12641*          END-IF
 12642*       ELSE
 12643*          IF WS-ATT-AGE >= PL-ATT-AGE
 12644*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12645*             PERFORM 9900-ERROR-FORMAT
 12646*                                THRU 9900-EXIT
 12647*          END-IF
 12648*       END-IF
 12649*    END-IF
 12650
 12651     .
 12652 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12653                                                                  ELC50PD
 12654     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12655        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12656           IF SUB2 GREATER THAN +4                                ELC50PD
 12657              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12658              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12659              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12660                                                                  ELC50PD
 12661     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12662        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12663            SUB2 GREATER THAN +8                                  ELC50PD
 12664             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12665             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12667             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12668                                                                  ELC50PD
 12669     IF SUB2 > +8
 12670        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12671           AND (PB-I-SIG-SW = 'Y')
 12672           CONTINUE
 12673        ELSE
 12674           MOVE ER-2637          TO WS-ERROR
 12675           PERFORM 9900-ERROR-FORMAT
 12676                                 THRU 9900-EXIT
 12677        END-IF
 12678        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12679     END-IF
 12680
 12681     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12682     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12683     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12684                                                                  ELC50PD
 12685     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12686        ADD +1  TO SUB2                                           ELC50PD
 12687        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12688                                                                  ELC50PD
 12689     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12690         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12691                                                                  ELC50PD
 12692     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12693        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12694        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12695           AND (PB-I-SIG-SW = 'Y')
 12696           CONTINUE
 12697        ELSE
 12698           MOVE ER-2637          TO WS-ERROR
 12699           PERFORM 9900-ERROR-FORMAT
 12700                                 THRU 9900-EXIT
 12701        END-IF
 12702     END-IF
 12703
 12704     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12705                                                                  ELC50PD
 12706                                                                  ELC50PD
 12707 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12708                                                                  ELC50PD
 12709     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12710        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12711         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12712                                                                  ELC50PD
 12713     IF APP-CERT-USED                                             ELC50PD
 12714         IF SUB2  LESS THAN  +5                                   ELC50PD
 12715             MOVE +5          TO SUB2                             ELC50PD
 12716             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12717                                                                  ELC50PD
 12718     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12720                                                                  ELC50PD
 12721     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12722                                                                  ELC50PD
 12723 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12724                                                                  ELC50PD
 12725     IF NOT APP-CERT-USED                                         ELC50PD
 12726         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12727                                                                  ELC50PD
 12728     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12729        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12730        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12731        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12732         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12733                                                                  ELC50PD
 12734     IF SUB2 GREATER THAN +4                                      ELC50PD
 12735         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 12736            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12737            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12738            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12739             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12740             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12741             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12742         ELSE                                                     ELC50PD
 12743             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12744                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12745                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12746                                                                  ELC50PD
 12747     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12748       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12749          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12750           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12751           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12752           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12753                                                                  ELC50PD
 12754                                                                  ELC50PD
 12755 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12756                                                                  ELC50PD
 12757     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12758        IF PB-I-AH-BENEFIT-AMT > +1250
 12759           MOVE ER-2702          TO WS-ERROR
 12760           PERFORM 9900-ERROR-FORMAT
 12761                                 THRU 9900-EXIT
 12762        END-IF
 12763     END-IF
 12764
 12765     IF (PB-COMPANY-ID = 'DCC')
 12766        AND (PB-MONTHLY-CERT)
 12767        IF PB-I-AH-BENEFIT-AMT > +3000
 12768           MOVE ER-2881          TO WS-ERROR
 12769           PERFORM 9900-ERROR-FORMAT
 12770                                 THRU 9900-EXIT
 12771        END-IF
 12772     END-IF
 12773
 12774     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12775        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12776        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12777                                                                  ELC50PD
 12778     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12779                                                                  ELC50PD
 12780     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12781         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12782             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12783                                                                  ELC50PD
 12784     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12785        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12786        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12787        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12788                                                                  ELC50PD
 12789     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12790     MOVE +1                     TO SUB2.                         ELC50PD
 12791                                                                  ELC50PD
 12792     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12793        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12794           MOVE +5 TO SUB2                                        ELC50PD
 12795           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12796              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12797              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12798              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12799              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12800              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12801                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12802     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12803                                                                  ELC50PD
 12804 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12805                                                                  ELC50PD
 12806     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12807        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12808        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12809     END-IF
 12810*       IF WS-ATT-AGE >= PL-ATT-AGE
 12811*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12812*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12813     .
 12814 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12815                                                                  ELC50PD
 12816     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12817        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12818           IF SUB2 GREATER THAN +4                                ELC50PD
 12819              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12820              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12821              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12822                                                                  ELC50PD
 12823     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12824        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12825            SUB2 GREATER THAN +8                                  ELC50PD
 12826             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12827             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12828             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12829             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12830                                                                  ELC50PD
 12831     IF SUB2 > +8
 12832        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12833           AND (PB-I-SIG-SW = 'Y')
 12834           CONTINUE
 12835        ELSE
 12836           MOVE ER-2638          TO WS-ERROR
 12837           PERFORM 9900-ERROR-FORMAT
 12838                                 THRU 9900-EXIT
 12839        END-IF
 12840        GO TO 3000-CONTINUE-EDIT
 12841     END-IF
 12842                                                                  ELC50PD
 12843     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12844        IF WS-ERROR = ER-2638                                     ELC50PD
 12845           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12846                                                                  ELC50PD
 12847     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12848     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12849     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12850     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12851                                                                  ELC50PD
 12852     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12853        ADD +1                   TO SUB2                          ELC50PD
 12854        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12855                                                                  ELC50PD
 12856     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12857         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12858                                                                  ELC50PD
 12859     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12860        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12861        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12862                                 > PL-LM-AMT (SUB2))
 12863        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12864           AND (PB-I-SIG-SW = 'Y')
 12865           CONTINUE
 12866        ELSE
 12867           MOVE ER-2638          TO WS-ERROR
 12868           PERFORM 9900-ERROR-FORMAT
 12869                                 THRU 9900-EXIT
 12870        END-IF
 12871     END-IF
 12872                                                                  ELC50PD
 12873     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12874         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12875             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12876                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12877                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12878                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12879                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12880                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12881                                                                  ELC50PD
 12882     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12883        IF WS-ERROR = ER-2638                                     ELC50PD
 12884            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12885            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12886            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12887                                                                  ELC50PD
 12888     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12889                                                                  ELC50PD
 12890 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12891                                                                  ELC50PD
 12892     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12893        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12894        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12895                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12896         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12897                                                                  ELC50PD
 12898     IF APP-CERT-USED                                             ELC50PD
 12899         IF SUB2  LESS THAN  +5                                   ELC50PD
 12900             MOVE +5             TO SUB2                          ELC50PD
 12901             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 12902                                                                  ELC50PD
 12903     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 12904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12905                                                                  ELC50PD
 12906     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 12907                                                                  ELC50PD
 12908 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12909                                                                  ELC50PD
 12910     IF NOT APP-CERT-USED                                         ELC50PD
 12911         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12912                                                                  ELC50PD
 12913     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12914        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12915        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12916        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12917         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12918                                                                  ELC50PD
 12919     IF SUB2 GREATER THAN +4                                      ELC50PD
 12920         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 12921            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12922            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12923            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12924             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12925             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12926             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 12927         ELSE                                                     ELC50PD
 12928             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12929                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12930                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12931                                                                  ELC50PD
 12932     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12933       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12934          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12935           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12936           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12937           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12938                                                                  ELC50PD
 12939******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12941                                                                  ELC50PD
 12942 3000-CONTINUE-EDIT.                                              ELC50PD
 12943                                                                  ELC50PD
 12944     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 12945     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 12946     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 12947     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 12948     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 12949                                                                  ELC50PD
 12950     IF BROWSE-STARTED                                            ELC50PD
 12951        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 12952        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 12953                                                                  ELC50PD
 12954     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 12955        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 12956        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 12957        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 12958*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 12959        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 12960        IF DATE-CONVERSION-ERROR                                  ELC50PD
 12961           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 12962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 12963        ELSE                                                      ELC50PD
 12964           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 12965              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 12966              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12967           ELSE                                                   ELC50PD
 12968              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 12969              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12970                                                                  ELC50PD
 12971     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 12972     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 12973     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 12974*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 12975     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 12976     IF DATE-CONVERSION-ERROR                                     ELC50PD
 12977        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 12978     ELSE                                                         ELC50PD
 12979        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 12980           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 12981           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 12982        ELSE                                                      ELC50PD
 12983           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 12984              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 12985              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12986           ELSE                                                   ELC50PD
 12987             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 12988                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 12989                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12990                                                                  ELC50PD
 12991 3005-EDIT-CONTINUE.                                              ELC50PD
 12992                                                                  ELC50PD
 12993     IF PB-CANCELLATION                                           ELC50PD
 12994         GO TO 3700-EDIT-CANCEL.                                     CL**2
 12995                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12997******************************************************************ELC50PD
 12998*                  E D I T   I S S U E                           *ELC50PD
 12999******************************************************************ELC50PD
 13000                                                                  ELC50PD
 13001 3020-EDIT-ISSUE.                                                 ELC50PD
 13002                                                                  ELC50PD
 13003      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13004      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13005      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13006      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13007      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13008                                                                  ELC50PD
 13009     IF PB-ISSUE-FORCE
 13010        OR PB-ISSUE-DATE-FORCED
 13011        OR PB-FORCE-OFF
 13012        OR PB-OVERCHARGE-FORCE
 13013        CONTINUE
 13014     ELSE
 13015        MOVE ER-2670             TO WS-ERROR
 13016        PERFORM 9900-ERROR-FORMAT
 13017                                 THRU 9900-EXIT
 13018     END-IF
 13019
 13020     .
 13021 3022-SET-POLICY-STATUS.                                          ELC50PD
 13022                                                                  ELC50PD
 13023     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13024                                                                  ELC50PD
 13025     IF (PB-REISSUED-CERT)
 13026             OR
 13027        ((PB-COMPANY-ID NOT = 'DCC')
 13028         AND (PB-MONTHLY-CERT))
 13029         MOVE '5'                TO PB-I-ENTRY-STATUS
 13030         MOVE 'E'                TO PB-BATCH-ENTRY
 13031     END-IF
 13032
 13033     IF PB-COMPANY-ID = 'DCC'
 13034        IF PB-MONTHLY-CERT
 13035           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13036        END-IF
 13037     END-IF
 13038     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13039         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13040     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13041         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13042     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13043         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13044     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13045         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13046     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13047         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13048                                                                  ELC50PD
 13049     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13050                                                                  ELC50PD
 13051     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13052         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13054         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13055                                                                  ELC50PD
 13056     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13057        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13058           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13059                                                                  ELC50PD
 13060     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13061        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13062           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13063                                                                  ELC50PD
 13064     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13065         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13066         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13067         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13068         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13069         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13070         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13071         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13072     END-IF
 13073                                                                  ELC50PD
 13074     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13075        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13076         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13077                                                                  ELC50PD
 13078     IF (ACCOUNT-MAST-FOUND)
 13079        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13080        IF PB-REISSUED-CERT
 13081           CONTINUE
 13082        ELSE
 13083           MOVE ER-2608          TO WS-ERROR
 13084           PERFORM 9900-ERROR-FORMAT
 13085                                 THRU 9900-EXIT
 13086         END-IF
 13087     END-IF
 13088                                                                  ELC50PD
 13089     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13090        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13091        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13092                                                                  ELC50PD
 13093**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13094 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13095     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13096        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13097                                                                  ELC50PD
 13098*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13099*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13100*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13101                                                                  ELC50PD
 13102     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13103     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13104     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13105     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13106**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13107                                                                  ELC50PD
 13108     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13109     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13110     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13111     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13112**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13113                                                                  ELC50PD
 13114     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13115        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13116        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13117                                                                  ELC50PD
 13118     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13119                                                                  ELC50PD
 13120     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13121                                      WK-FULL-CERT-NO.            ELC50PD
 13122     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13123                                                                  ELC50PD
 13124     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13125                                                                  ELC50PD
 13126     IF PB-VALID-LIFE                                             ELC50PD
 13127        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13128     ELSE                                                         ELC50PD
 13129        IF PB-VALID-AH                                            ELC50PD
 13130          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13131                                                                  ELC50PD
 13132                                                                  ELC50PD
 13133     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13134     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13135     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13136                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13137                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13138                                      DCUA-RETURN-CODE.           ELC50PD
 13139                                                                  ELC50PD
 13140****************************************************************  ELC50PD
 13141*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13142***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13143***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13144***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13145***   TO THIS RECORD.                                        ***  ELC50PD
 13146****************************************************************  ELC50PD
 13147     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13148     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13149     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13150        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13151                                                                  ELC50PD
 13152     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13153        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13154        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13155        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13156        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13157                                                                  ELC50PD
 13158     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13159        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13160        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13162        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13163                                                                  ELC50PD
 13164     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13165        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13166        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13167        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13168        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13169                                                                  ELC50PD
 13170     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13171        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13172        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13174        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13175                                                                  ELC50PD
 13176     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13177        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13178        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13180        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13181                                                                  ELC50PD
 13182     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13183        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13184        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13186        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13187                                                                  ELC50PD
 13188     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13189        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13190        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13192        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13193                                                                  ELC50PD
 13194     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13195        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13196        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13198        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13199                                                                  ELC50PD
 13200     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13201        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13202        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13204        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13205                                                                  ELC50PD
 13206     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13207        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13208        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13210        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13211                                                                  ELC50PD
 13212     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13213        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13214        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13216        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13217                                                                  ELC50PD
 13218     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13219        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13220        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13222        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13223                                                                  ELC50PD
 13224     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13225        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13226        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13227        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13228        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13229                                                                  ELC50PD
 13230     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13231        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13232        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13234        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13235                                                                  ELC50PD
 13236     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13237        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13238        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13240        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13241                                                                  ELC50PD
 13242     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13243     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13244     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13245     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13246                                                                  ELC50PD
 13247 3024-EDIT-DL7-CONT.                                              ELC50PD
 13248                                                                  ELC50PD
 13249     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13250     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13251     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13252        NEXT SENTENCE                                             ELC50PD
 13253     ELSE                                                         ELC50PD
 13254        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13256                                                                  ELC50PD
 13257******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13258******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13259     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13260        NEXT SENTENCE                                             ELC50PD
 13261     ELSE                                                         ELC50PD
 13262        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13264                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13266****************************************************************  ELC50PD
 13267*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13268****************************************************************  ELC50PD
 13269     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13270     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13271                                                                  ELC50PD
 13272     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13273     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13274        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13275                                                                  ELC50PD
 13276     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13277        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13279        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13280                                                                  ELC50PD
 13281     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13282        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13283        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13284        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13285                                                                  ELC50PD
 13286     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13287        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13289        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13290                                                                  ELC50PD
 13291     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13292        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13294        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13295                                                                  ELC50PD
 13296     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13298                                                                  ELC50PD
 13299 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13301****************************************************************  ELC50PD
 13302*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13303****************************************************************  ELC50PD
 13304                                                                  ELC50PD
 13305     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13306     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13307     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13308     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13309        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13310                                                                  ELC50PD
 13311     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13312        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13314        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13315                                                                  ELC50PD
 13316     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13317        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13319        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13320                                                                  ELC50PD
 13321     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13322        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13324        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13325                                                                  ELC50PD
 13326     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13327        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13329        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13330                                                                  ELC50PD
 13331     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13332        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13334        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13335                                                                  ELC50PD
 13336     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13337     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13338     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13339                                                                  ELC50PD
 13340 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13342                                                                  ELC50PD
 13343****************************************************************  ELC50PD
 13344*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13345****************************************************************  ELC50PD
 13346                                                                  ELC50PD
 13347     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13348     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13349     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13350     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13351     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13352        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13353                                                                  ELC50PD
 13354     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13355        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13357        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13358                                                                  ELC50PD
 13359     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13360        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13362        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13363                                                                  ELC50PD
 13364     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13365        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13367        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13368                                                                  ELC50PD
 13369     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13370     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13371     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13372                                                                  ELC50PD
 13373 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13375                                                                  ELC50PD
 13376****************************************************************  ELC50PD
 13377*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13378****************************************************************  ELC50PD
 13379                                                                  ELC50PD
 13380     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13381     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13382     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13383        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13385                                                                  ELC50PD
 13386     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13387     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13388     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13389     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13390     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13391     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13392        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13393                                                                  ELC50PD
 13394     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13395        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13397        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13398                                                                  ELC50PD
 13399     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13400        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13402        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13403                                                                  ELC50PD
 13404     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13405        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13407        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13408                                                                  ELC50PD
 13409     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13410        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13412        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13413                                                                  ELC50PD
 13414     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13415        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13417        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13418                                                                  ELC50PD
 13419     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13420        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13422        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13423                                                                  ELC50PD
 13424     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13425     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13426     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13427                                                                  ELC50PD
 13428 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13430                                                                  ELC50PD
 13431     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13432        NEXT SENTENCE                                             ELC50PD
 13433     ELSE                                                         ELC50PD
 13434        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13436                                                                  ELC50PD
 13437     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13438     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13439     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13440                                                                  ELC50PD
 13441     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13442        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13444        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13445                                                                  ELC50PD
 13446     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13447        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13449        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13450                                                                  ELC50PD
 13451     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13452        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13454        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13455                                                                  ELC50PD
 13456     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13457        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13459        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13460                                                                  ELC50PD
 13461     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13462        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13464        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13465                                                                  ELC50PD
 13466     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13467        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13469                                                                  ELC50PD
 13470 3024-EDIT-DL01-CONT.                                             ELC50PD
 13471******************************************************************ELC50PD
 13472***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13473******************************************************************ELC50PD
 13474                                                                  ELC50PD
 13475      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13476      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13477      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13478      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13479        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13480        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13481                                                                  ELC50PD
 13482      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13483                                                                  ELC50PD
 13484      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13485         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13487         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13488                                                                  ELC50PD
 13489      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13490         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13492         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13493                                                                  ELC50PD
 13494      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13495         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13497         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13498                                                                  ELC50PD
 13499       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13500       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13501       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13502                                                                  ELC50PD
 13503******************************************************************ELC50PD
 13504***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13505******************************************************************ELC50PD
 13506                                                                  ELC50PD
 13507 3024-CHECK-VALID-RATE.                                           ELC50PD
 13508                                                                  ELC50PD
 13509     IF VALID-RATE-CODE                                           ELC50PD
 13510        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13511        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13512        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13513        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13514     ELSE                                                         ELC50PD
 13515         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13516                                                                  ELC50PD
 13517      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13518         IF PB-VALID-LIFE                                         ELC50PD
 13519             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13520             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13521         ELSE                                                     ELC50PD
 13522             IF PB-VALID-AH                                       ELC50PD
 13523                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13524                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13525                                                                  ELC50PD
 13526      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13527         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13529         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13530                                                                  ELC50PD
 13531      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13532         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13534         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13535                                                                  ELC50PD
 13536      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13537         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13539         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13540                                                                  ELC50PD
 13541      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13542         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13543            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13544            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13545            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13546          ELSE                                                    ELC50PD
 13547         IF PB-VALID-LIFE                                         ELC50PD
 13548            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13549          ELSE                                                    ELC50PD
 13550            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13551         END-IF                                                   ELC50PD
 13552         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13553         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13554         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13555         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13556             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13557             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13558           ELSE                                                   ELC50PD
 13559             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13560             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13561             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13562                                                                  ELC50PD
 13563       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13564       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13565       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13566                                                                  ELC50PD
 13567**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13568                                                                  ELC50PD
 13569 3025-EDIT-REINSURANCE.                                           ELC50PD
 13570     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13571         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13572                                                                  ELC50PD
 13573     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13574     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13575     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13576                                      REIN-CODE-2                 ELC50PD
 13577                                      REIN-CODE-3.                ELC50PD
 13578     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13579                                                                  ELC50PD
 13580     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13581                                                                  ELC50PD
 13582     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13583     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13584                                                                  ELC50PD
 13585     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13586     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13587         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13588                                                                  ELC50PD
 13589     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13590     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13591                                   WS-NSP-ST-CD-LF.               ELC50PD
 13592     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13593                                   WS-NSP-ST-CD-AH.               ELC50PD
 13594                                                                  ELC50PD
 13595     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13596                                                                  ELC50PD
 13597 3026-NO-SPEC-TABLE.                                              ELC50PD
 13598                                                                  ELC50PD
 13599     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13601     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13602                                                                  ELC50PD
 13603 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13604                                                                  ELC50PD
 13605     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13606       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13607                                                                  ELC50PD
 13608     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13609          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13610          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13611           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13612                                                                  ELC50PD
 13613     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13614     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13615     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13616     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13617                                                                  ELC50PD
 13618     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13619     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13620                                                                  ELC50PD
 13621     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13622     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13623         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13624                                                                  ELC50PD
 13625     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13626     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13627                                   WS-NSP-ST-CD-LF.               ELC50PD
 13628     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13629                                   WS-NSP-ST-CD-AH.               ELC50PD
 13630                                                                  ELC50PD
 13631     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13632                                                                  ELC50PD
 13633 3028-NO-REIN-TABLE.                                              ELC50PD
 13634                                                                  ELC50PD
 13635     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13637     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13638                                                                  ELC50PD
 13639 3040-EDIT-CONTINUE.                                              ELC50PD
 13640                                                                  ELC50PD
 13641     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13642         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13643                                                                  ELC50PD
 13644     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13645         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13646                                                                  ELC50PD
 13647     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13648        AND (NOT PB-MONTHLY-CERT)
 13649        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13650            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13651            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13652                                                                  ELC50PD
 13653     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13654        AND (NOT PB-MONTHLY-CERT)
 13655        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13656            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13657            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13658                                                                  ELC50PD
 13659 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13660
 13661     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13662     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13663         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13664                                                                  ELC50PD
 13665******************************************************************ELC50PD
 13666*                                                                *ELC50PD
 13667*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13668*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13669*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13670*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13671*                                                                *ELC50PD
 13672******************************************************************ELC50PD
 13673                                                                  ELC50PD
 13674     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13675        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13676                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13677                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13678        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13679        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13680        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13681        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13682        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13683*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13684        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13685        IF NO-CONVERSION-ERROR                                    ELC50PD
 13686           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13687                                                                  ELC50PD
 13688******************************************************************ELC50PD
 13689*                                                                *ELC50PD
 13690*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13691*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13692*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13693*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13694*                                                                *ELC50PD
 13695******************************************************************ELC50PD
 13696                                                                  ELC50PD
 13697     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13698          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13699                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13700                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13701          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13702          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13703          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13704          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13705          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13706*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13707          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13708          IF NO-CONVERSION-ERROR                                  ELC50PD
 13709             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13710                                                                  ELC50PD
 13711******************************************************************ELC50PD
 13712*                                                                *ELC50PD
 13713*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13714*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13715*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13716*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13717*                                                                *ELC50PD
 13718******************************************************************ELC50PD
 13719                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13720     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13721        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13722           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13723              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13724              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13725           ELSE                                                   ELC50PD
 13726              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13727              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13728        ELSE                                                      ELC50PD
 13729           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13730              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13731              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13732           ELSE                                                   ELC50PD
 13733              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13734              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13735                                                                  ELC50PD
 13736     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13737        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13738        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13739        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13740        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13741                                    DC-ODD-DAYS-OVER              ELC50PD
 13742          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13743          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13744*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13745          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13746          IF NO-CONVERSION-ERROR                                  ELC50PD
 13747             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13748                                                                  ELC50PD
 13749******************************************************************ELC50PD
 13750*                                                                *ELC50PD
 13751*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13752*                                                                *ELC50PD
 13753******************************************************************ELC50PD
 13754                                                                  ELC50PD
 13755     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13756        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13757                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13758        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13759                                                                  ELC50PD
 13760     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13761         NEXT SENTENCE                                            ELC50PD
 13762     ELSE                                                         ELC50PD
 13763         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13765         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13766                                                                  ELC50PD
 13767     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13768     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13769     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13770*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13771     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13772                                    DC-ELAPSED-DAYS               ELC50PD
 13773                                    DC-ODD-DAYS-OVER.             ELC50PD
 13774                                                                  ELC50PD
 13775     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13776                                                                  ELC50PD
 13777     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13778        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13779                                                                  ELC50PD
 13780     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13781
 13782     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13783        AND (WS-LF-COVERAGE-TYPE = 'L')
 13784        IF (DC-ELAPSED-MONTHS > 1)
 13785                      OR
 13786           ((DC-ELAPSED-MONTHS = 1)
 13787           AND (DC-ODD-DAYS-OVER > 0))
 13788           MOVE ER-2882          TO WS-ERROR
 13789           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13790        END-IF
 13791     END-IF
 13792
 13793     IF PB-EXT-DAYS-PROCESSING
 13794        CONTINUE
 13795     ELSE
 13796        IF DC-ELAPSED-MONTHS = +0
 13797           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13798        ELSE
 13799           IF (WS-LF-EARNINGS-CALC = '4')
 13800              AND (DC-ELAPSED-MONTHS > ZERO)
 13801              AND (DC-ELAPSED-DAYS > ZERO)
 13802              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13803           ELSE
 13804              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13805                                 THRU 6499-EXIT
 13806              MOVE WS-ODD-DAYS-OVER
 13807                                 TO PB-I-EXTENTION-DAYS
 13808           END-IF
 13809        END-IF
 13810     END-IF
 13811
 13812******************************************************************ELC50PD
 13813*                                                                *ELC50PD
 13814*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13815*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13816*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13817*            AND ANY ODD DAYS.                                   *ELC50PD
 13818*                                                                *ELC50PD
 13819******************************************************************ELC50PD
 13820                                                                  ELC50PD
 13821     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13822                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13823     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13824        IF DC-ELAPSED-DAYS > ZEROS
 13825           MOVE ER-2681          TO WS-ERROR
 13826           PERFORM 9900-ERROR-FORMAT
 13827                                 THRU 9900-EXIT
 13828        END-IF
 13829     END-IF
 13830                                                                  ELC50PD
 13831     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13832        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13833           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13834           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13835                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13836     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13837        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13838         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13839          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13840          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13841          IF WS-LF-EARNINGS-CALC = '4'
 13842             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13843             PB-I-PAY-FREQUENCY
 13844          END-IF
 13845          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13846                                    DC-ODD-DAYS-OVER              ELC50PD
 13847          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13848          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13849*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13850          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13851          IF NO-CONVERSION-ERROR                                  ELC50PD
 13852             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13853             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13854                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13855                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13856                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13857                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13858                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13859*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13860                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13861                  IF NO-CONVERSION-ERROR                          ELC50PD
 13862                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13863                                                                  ELC50PD
 13864* okay, i had to move the new att age edit down here because the
 13865* expiration date could get recalculated and i need the exp date
 13866
 13867
 13868     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13869        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13870        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13871        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13872           AND ZEROS
 13873           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13874           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13875           SET ELAPSED-BETWEEN-BIN TO TRUE
 13876           PERFORM 8500-DATE-CONVERT
 13877                                 THRU 8500-EXIT
 13878           IF NO-CONVERSION-ERROR
 13879              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13880                 MOVE ER-2669       TO WS-ERROR
 13881*                PERFORM 9900-ERROR-FORMAT
 13882*                                THRU 9900-EXIT
 13883              END-IF
 13884           END-IF
 13885        ELSE
 13886           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13887           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13888              MOVE ER-2669       TO WS-ERROR
 13889*             PERFORM 9900-ERROR-FORMAT
 13890*                                THRU 9900-EXIT
 13891           ELSE
 13892              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13893                 MOVE ER-1570    TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13894                 PERFORM 9900-ERROR-FORMAT
 13895                                 THRU 9900-EXIT
 13896              END-IF
 13897           END-IF
 13898        END-IF
 13899
 13900        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13901           AND ZEROS
 13902           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 13903           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13904           SET ELAPSED-BETWEEN-BIN TO TRUE
 13905           PERFORM 8500-DATE-CONVERT
 13906                                 THRU 8500-EXIT
 13907           IF NO-CONVERSION-ERROR
 13908              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13909                 MOVE ER-2669       TO WS-ERROR
 13910*                PERFORM 9900-ERROR-FORMAT
 13911*                                THRU 9900-EXIT
 13912              END-IF
 13913           END-IF
 13914        ELSE
 13915           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13916             (PB-I-LF-TERM / 12)
 13917           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13918              MOVE ER-2669       TO WS-ERROR
 13919*             PERFORM 9900-ERROR-FORMAT
 13920*                                THRU 9900-EXIT
 13921           ELSE
 13922              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13923                 MOVE ER-1571    TO WS-ERROR
 13924                 PERFORM 9900-ERROR-FORMAT
 13925                                 THRU 9900-EXIT
 13926              END-IF
 13927           END-IF
 13928        END-IF
 13929        IF WS-ERROR = ER-2669
 13930           PERFORM 9900-ERROR-FORMAT
 13931                                 THRU 9900-EXIT
 13932        END-IF
 13933
 13934     END-IF
 13935
 13936     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13937        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 13938         NOT NO-AH-COVERAGE                                       ELC50PD
 13939          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 13940             AND (PB-COMPANY-ID = 'DCC')
 13941             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 13942             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 13943          ELSE
 13944             IF WS-LF-EARNINGS-CALC = '4'
 13945                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 13946                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 13947                PB-I-PAY-FREQUENCY
 13948             ELSE
 13949                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 13950                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 13951             END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13952          END-IF
 13953          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13954                                         DC-ODD-DAYS-OVER         ELC50PD
 13955          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 13956          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13957*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13958          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13959          IF NO-CONVERSION-ERROR                                  ELC50PD
 13960             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 13961
 13962     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 13963        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 13964        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13965        IF PB-I-BIRTHDAY > LOW-VALUES
 13966           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13967           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13968           SET ELAPSED-BETWEEN-BIN TO TRUE
 13969           PERFORM 8500-DATE-CONVERT
 13970                                 THRU 8500-EXIT
 13971           IF NO-CONVERSION-ERROR
 13972              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 13973                 MOVE ER-3054       TO WS-ERROR
 13974*                PERFORM 9900-ERROR-FORMAT
 13975*                                THRU 9900-EXIT
 13976              END-IF
 13977           END-IF
 13978        ELSE
 13979           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13980           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 13981              MOVE ER-3054       TO WS-ERROR
 13982*             PERFORM 9900-ERROR-FORMAT
 13983*                                THRU 9900-EXIT
 13984           END-IF
 13985        END-IF
 13986
 13987        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13988           AND ZEROS
 13989           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 13990           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13991           SET ELAPSED-BETWEEN-BIN TO TRUE
 13992           PERFORM 8500-DATE-CONVERT
 13993                                 THRU 8500-EXIT
 13994           IF NO-CONVERSION-ERROR
 13995              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 13996                 MOVE ER-3054       TO WS-ERROR
 13997*                PERFORM 9900-ERROR-FORMAT
 13998*                                THRU 9900-EXIT
 13999              END-IF
 14000           END-IF
 14001        ELSE
 14002           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14003             (PB-I-AH-TERM / 12)
 14004           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14005              MOVE ER-3054       TO WS-ERROR
 14006*             PERFORM 9900-ERROR-FORMAT
 14007*                                THRU 9900-EXIT
 14008           END-IF
 14009        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14010        IF WS-ERROR = ER-3054
 14011           PERFORM 9900-ERROR-FORMAT
 14012                                 THRU 9900-EXIT
 14013        END-IF
 14014
 14015     END-IF
 14016
 14017     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14018                                                                  ELC50PD
 14019     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14020        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14021                                                                     CL**6
 14022     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14023       AND                                                        ELC50PD
 14024        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14025        NEXT SENTENCE                                             ELC50PD
 14026     ELSE                                                            CL**6
 14027        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14028                                                                     CL**6
 14029     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14030        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14031        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14032     ELSE                                                         ELC50PD
 14033        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14034        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14035                                                                  ELC50PD
 14036     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14037*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14038     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14039     IF (NO-CONVERSION-ERROR)
 14040        AND (DC-ELAPSED-MONTHS > +1)
 14041        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14042        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14044                                                                  ELC50PD
 14045 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14046                                                                  ELC50PD
 14047     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14048        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14049         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14050     ELSE                                                         ELC50PD
 14051         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14052                                                                  ELC50PD
 14053     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14054         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14055     ELSE                                                         ELC50PD
 14056        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14057           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14058           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14059           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14060                                                                  ELC50PD
 14061     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14062        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
 14063        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14064         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14065                                                                  ELC50PD
 14066     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14067                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14068 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14069                                                                  ELC50PD
 14070     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14071                                                                  ELC50PD
 14072     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14073         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14074     ELSE                                                         ELC50PD
 14075         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14076            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14077            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14078                                                                  ELC50PD
 14079     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14080                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14081     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14082         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14083                                                                  ELC50PD
 14084     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14085         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14086         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14087                                                                  ELC50PD
 14088                                                                  ELC50PD
 14089 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14090                                                                  ELC50PD
 14091******************************************************************ELC50PD
 14092*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14093******************************************************************ELC50PD
 14094                                                                  ELC50PD
 14095     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14096        NEXT SENTENCE                                             ELC50PD
 14097     ELSE                                                         ELC50PD
 14098        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14099           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14100              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14101              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14102              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14103                  NEXT SENTENCE                                   ELC50PD
 14104           ELSE                                                   ELC50PD
 14105              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14106              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14107                                                                  ELC50PD
 14108     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14109         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14110            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14111            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14112            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14113             NEXT SENTENCE                                        ELC50PD
 14114          ELSE                                                    ELC50PD
 14115              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14116              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14117                                                                  ELC50PD
 14118     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14119        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14120                                                                     CL**6
 14121     IF POLICY-HAS-AH                                             ELC50PD
 14122       AND                                                        ELC50PD
 14123        POLICY-HAS-LIFE                                           ELC50PD
 14124       AND                                                        ELC50PD
 14125        PB-I-LF-TERM NUMERIC                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14126       AND                                                        ELC50PD
 14127        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14128        NEXT SENTENCE                                             ELC50PD
 14129     ELSE                                                         ELC50PD
 14130        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14131                                                                  ELC50PD
 14132     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14133     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14134        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14135                                                                  ELC50PD
 14136     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14137        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14139                                                                  ELC50PD
 14140 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14141                                                                  ELC50PD
 14142     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14143         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14144            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14145
 14146*    IF PB-COMPANY-ID NOT = 'DCC'
 14147*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14148*          AND 'V' AND 'W' AND 'X'
 14149*          GO TO 3125-EDIT-PMT-FREQ
 14150*       END-IF
 14151*    ELSE
 14152*       IF WS-AH-DCC-TRUNC = 'T'
 14153*          CONTINUE
 14154*       ELSE
 14155*          GO TO 3125-EDIT-PMT-FREQ
 14156*       END-IF
 14157*    END-IF
 14158
 14159
 14160
 14161     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14162                    OR
 14163        ((PB-COMPANY-ID = 'DCC')
 14164        AND (WS-AH-DCC-TRUNC = 'T'))
 14165        CONTINUE
 14166     ELSE
 14167        GO TO 3125-EDIT-PMT-FREQ
 14168     END-IF
 14169
 14170     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14171         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14172                                                                  ELC50PD
 14173     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14174        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14175        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14176        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14177         NEXT SENTENCE                                            ELC50PD
 14178     ELSE                                                         ELC50PD
 14179         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14181                                                                  ELC50PD
 14182     IF WS-STATE-ABBREVIATION = 'NC'
 14183        IF PB-I-LOAN-TERM > +59
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14184           CONTINUE
 14185        ELSE
 14186           MOVE ER-2792          TO WS-ERROR
 14187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14188        END-IF
 14189     END-IF
 14190                                                                  ELC50PD
 14191     .
 14192 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14193
 14194     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14195         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14196            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14197
 14198     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14199                    OR
 14200        ((PB-COMPANY-ID = 'DCC')
 14201        AND (WS-AH-DCC-TRUNC = 'T'))
 14202                    OR
 14203         (PB-COMPANY-ID = 'AHL')
 14204        CONTINUE
 14205     ELSE
 14206        IF (PB-I-LOAN-TERM > ZEROS)
 14207           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14208           MOVE ER-1575          TO WS-ERROR
 14209           PERFORM 9900-ERROR-FORMAT
 14210                                 THRU 9900-EXIT
 14211        END-IF
 14212     END-IF
 14213
 14214     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14215         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14216            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14217            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14218            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14219         ELSE                                                     ELC50PD
 14220            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14221                                                                  ELC50PD
 14222     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14223         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14224         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14225         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14226                                                                  ELC50PD
 14227     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14228         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14230         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14231                                                                  ELC50PD
 14232     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14233         GIVING WS-TEX-FACT-2                                     ELC50PD
 14234             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14235                                                                  ELC50PD
 14236*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14237*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14238*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14239                                                                  ELC50PD
 14240                                                                  ELC50PD
 14241 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14242                                                                  ELC50PD
 14243     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14244        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14245           MOVE ER-2690          TO WS-ERROR
 14246           PERFORM 9900-ERROR-FORMAT
 14247                                 THRU 9900-EXIT
 14248        ELSE
 14249           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14250           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14251           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14252           MOVE PB-SV-STATE      TO LOFC-STATE
 14253           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14254           MOVE PB-I-LOAN-OFFICER
 14255                                 TO LOFC-CODE
 14256           PERFORM 8586-READ-LOAN-OFFICER
 14257                                 THRU 8586-EXIT
 14258           IF (NOT LOFC-MASTER-FOUND)
 14259              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14260              MOVE ER-3006       TO WS-ERROR
 14261              PERFORM 9900-ERROR-FORMAT
 14262                                 THRU 9900-EXIT
 14263           END-IF
 14264        END-IF
 14265     END-IF
 14266
 14267     .
 14268 3129-EDIT-APR.                                                   ELC50PD
 14269                                                                  ELC50PD
 14270     IF (WS-LF-BENEFIT-CD = ZERO)
 14271        OR (NO-LF-BENEFIT-MATCH)
 14272        IF PB-COMPANY-ID NOT = 'DCC'
 14273           GO TO 3130-EDIT-AGE
 14274*       ELSE
 14275*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14276*             GO TO 3130-EDIT-AGE
 14277*          END-IF
 14278        END-IF
 14279     END-IF
 14280                                                                  ELC50PD
 14281     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14282         AND (PB-I-RATE-CLASS NOT = 'L ')
 14283         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14284         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14285         GO TO 3129-APR-CONT.                                     ELC50PD
 14286                                                                  ELC50PD
 14287     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14288         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14289         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
 14290         GO TO 3129-APR-CONT.                                     ELC50PD
 14291                                                                  ELC50PD
 14292     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14293         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14294         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14295         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14296         GO TO 3129-APR-CONT.                                     ELC50PD
 14297                                                                  ELC50PD
 14298     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14299        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14300           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14301              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14302              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14303              GO TO 3130-EDIT-AGE.                                ELC50PD
 14304                                                                  ELC50PD
 14305     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14306        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14307        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14308        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14309        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14310        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14311         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14312                                                                  ELC50PD
 14313 3129-APR-CONT.                                                   ELC50PD
 14314     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14315         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14316         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14317                                                                  ELC50PD
 14318     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14319         WS-AH-BENEFIT-CD (1:1) = 'S')
 14320        AND (PB-COMPANY-ID = 'DCC')
 14321        AND (PB-I-LOAN-APR = ZERO)
 14322        MOVE ER-2657             TO WS-ERROR
 14323        PERFORM 9900-ERROR-FORMAT
 14324                                 THRU 9900-EXIT
 14325        GO TO 3130-EDIT-AGE
 14326     END-IF
 14327
 14328     IF PB-I-LOAN-APR = ZERO
 14329        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14330     END-IF
 14331                                                                  ELC50PD
 14332     IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14333        MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14335        GO TO 3130-EDIT-AGE.                                      ELC50PD
 14336                                                                  ELC50PD
 14337*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14338     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000            ELC50PD
 14339        MOVE ER-2657             TO WS-ERROR                      ELC50PD
 14340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14341                                                                  ELC50PD
 14342 3130-EDIT-AGE.                                                   ELC50PD
 14343                                                                  ELC50PD
 14344******************************************************************ELC50PD
 14345*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14346******************************************************************ELC50PD
 14347                                                                  ELC50PD
 14348     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14349        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14350           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14351               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14352               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14353                                                                  ELC50PD
 14354     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14355        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14356           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14357               MOVE ER-2628         TO WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14358               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14359                                                                  ELC50PD
 14360 3133-SEX-CODE.                                                   ELC50PD
 14361     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14362         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14363             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14364          ELSE                                                    ELC50PD
 14365             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14366             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14367                                                                  ELC50PD
 14368     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14369         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14370                                                                  ELC50PD
 14371     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14372         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14373                                                                  ELC50PD
 14374 3134-SIG-SW-EDIT.                                                ELC50PD
 14375     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14376         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14377                                                                  ELC50PD
 14378     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14379         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14380             NEXT SENTENCE                                        ELC50PD
 14381         ELSE                                                     ELC50PD
 14382             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14383             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14384     ELSE                                                         ELC50PD
 14385     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14386         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14387             NEXT SENTENCE                                        ELC50PD
 14388         ELSE                                                     ELC50PD
 14389             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14390             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14391     ELSE                                                         ELC50PD
 14392     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14393         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
 14394             NEXT SENTENCE                                        ELC50PD
 14395         ELSE                                                     ELC50PD
 14396             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14397             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14398     ELSE                                                         ELC50PD
 14399         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14400             NEXT SENTENCE                                        ELC50PD
 14401         ELSE                                                     ELC50PD
 14402             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14403             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14404                                                                  ELC50PD
 14405     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
 14406         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14407             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14408            PB-I-SIG-SW = 'N'                                     ELC50PD
 14409            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14410            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14411                                                                  ELC50PD
 14412 3135-NAME-EDIT.                                                  ELC50PD
 14413                                                                  ELC50PD
 14414     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14415        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14416        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14417           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14418                                 TO PB-I-JOINT-FIRST-NAME
 14419        END-PERFORM
 14420     END-IF
 14421
 14422     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14423        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14424        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14425           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14426                                 TO PB-I-JOINT-LAST-NAME
 14427        END-PERFORM
 14428     END-IF
 14429
 14430     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14431        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14432        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14433           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14434                                 TO PB-I-INSURED-FIRST-NAME
 14435        END-PERFORM
 14436     END-IF
 14437
 14438     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14439        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14440        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14441           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14442                                 TO PB-I-INSURED-LAST-NAME
 14443        END-PERFORM
 14444     END-IF
 14445
 14446     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14447       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14448       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14449           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14450           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14451                                                                  ELC50PD
 14452 3136-EDIT-SEX.                                                   ELC50PD
 14453                                                                  ELC50PD
 14454******************************************************************ELC50PD
 14455*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14456******************************************************************ELC50PD
 14457                                                                  ELC50PD
 14458     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14459        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14460        NEXT SENTENCE                                             ELC50PD
 14461     ELSE                                                         ELC50PD
 14462        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14463           NEXT SENTENCE                                          ELC50PD
 14464        ELSE                                                      ELC50PD
 14465           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14467                                                                  ELC50PD
 14468 3137-EDIT-EFF-DATE.                                              ELC50PD
 14469                                                                  ELC50PD
 14470     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14471        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14472        PB-POLICY-IS-VOIDED                                       ELC50PD
 14473         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14474                                                                  ELC50PD
 14475     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14476                                    WS-2672-SW.                   ELC50PD
 14477                                                                  ELC50PD
 14478     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14479         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14480             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14481             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14482             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14483                                                                  ELC50PD
 14484     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14485         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14486                                                                  ELC50PD
 14487     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14488     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14489*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14490     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14491     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14492                                    DC-ELAPSED-DAYS.              ELC50PD
 14493     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14494                                                                  ELC50PD
 14495     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14496         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14497                                                                  ELC50PD
 14498     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14499         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14500         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14501         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14502     END-IF
 14503                                                                  ELC50PD
 14504     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14505        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14506        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14507        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14508        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14509                                                                  ELC50PD
 14510     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14511      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14512         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14513         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14514         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14515         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14516                                    WS-2672-SW.                   ELC50PD
 14517                                                                  ELC50PD
 14518     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14519         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14520             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14521             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14522         ELSE                                                     ELC50PD
 14523             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14524             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14525                                                                  ELC50PD
 14526                                                                  ELC50PD
 14527 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14528                                                                  ELC50PD
 14529     if pb-company-id not = 'AHL'
 14530        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14531           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14532           MOVE ER-2787          TO WS-ERROR
 14533           PERFORM 9900-ERROR-FORMAT
 14534                                 THRU 9900-EXIT
 14535        END-IF
 14536     end-if
 14537
 14538     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14539        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14540                                 > 250000.00
 14541           MOVE ER-2719          TO WS-ERROR
 14542           PERFORM 9900-ERROR-FORMAT
 14543                                 THRU 9900-EXIT
 14544        END-IF
 14545     END-IF
 14546
 14547     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14548        PB-POLICY-IS-VOIDED                                       ELC50PD
 14549         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14550                                                                  ELC50PD
 14551     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14552        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14553         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14555                                                                  ELC50PD
 14556     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14557        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14558        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14559         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14560                                                                  ELC50PD
 14561     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14562        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14563        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14564         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14565                                                                  ELC50PD
 14566     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14567        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14568        MOVE ER-2631             TO WS-ERROR
 14569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14570     END-IF
 14571                                                                  ELC50PD
 14572                                                                  ELC50PD
 14573******************************************************************ELC50PD
 14574*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14575******************************************************************ELC50PD
 14576                                                                  ELC50PD
 14577     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14578        NEXT SENTENCE                                             ELC50PD
 14579     ELSE                                                         ELC50PD
 14580        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14581           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14583                                                                  ELC50PD
 14584                                                                  ELC50PD
 14585******************************************************************ELC50PD
 14586*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14587******************************************************************ELC50PD
 14588                                                                  ELC50PD
 14589     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14590        CONTINUE                                                  ELC50PD
 14591     ELSE                                                         ELC50PD
 14592        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14593           IF (NOT PB-COMP-LF-PREM)
 14594              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14595              MOVE ER-2633       TO WS-ERROR
 14596              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14597           END-IF
 14598        END-IF
 14599     END-IF
 14600
 14601     .                                                            ELC50PD
 14602 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14603                                                                  ELC50PD
 14604     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14605        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14606        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14607         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14608                                                                  ELC50PD
 14609     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14610        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14611        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14612        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14613         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14614                                                                  ELC50PD
 14615     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14616        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14617        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14618         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14619                                                                  ELC50PD
 14620     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14621         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14623                                                                  ELC50PD
 14624******************************************************************ELC50PD
 14625*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14626******************************************************************ELC50PD
 14627                                                                  ELC50PD
 14628     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14629        NEXT SENTENCE                                             ELC50PD
 14630     ELSE                                                         ELC50PD
 14631        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14632           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14633           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14634                                                                  ELC50PD
 14635******************************************************************ELC50PD
 14636*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14637******************************************************************ELC50PD
 14638                                                                  ELC50PD
 14639     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14640        NEXT SENTENCE                                             ELC50PD
 14641     ELSE                                                         ELC50PD
 14642        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14643            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14644                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14645                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14646                                                                  ELC50PD
 14647                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14648 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14649* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14650     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14651                                     WS-RES-MUNI-TAX              ELC50PD
 14652                                     PB-I-STATE-TAX               ELC50PD
 14653                                     PB-I-MUNI-TAX.               ELC50PD
 14654                                                                  ELC50PD
 14655     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14656                                                                  ELC50PD
 14657     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14658        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14659                                                                  ELC50PD
 14660     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14661        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14662                                                                  ELC50PD
 14663     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14664        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14665                                                                  ELC50PD
 14666     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14667                             OR 'RIC')                            ELC50PD
 14668        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14669                                                                  ELC50PD
 14670     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14671        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14672            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14673        ELSE                                                      ELC50PD
 14674           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14675               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14676                                                                  ELC50PD
 14677     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14678        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14679                                                                  ELC50PD
 14680     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14681        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14682                                                                  ELC50PD
 14683     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
 14684        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14685           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14686             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14687           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14688           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14689              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14690              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14691              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14692           ELSE                                                   ELC50PD
 14693              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14694                                                                  ELC50PD
 14695 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
 14696                                                                  ELC50PD
 14697* DMD RATING TEST                                                 ELC50PD
 14698     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14699         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14700         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14701         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14702         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14703         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14704         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14705                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14706     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14707         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14708             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14709                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14710                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14711                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14712                                                                  ELC50PD
 14713     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14714         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14715             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14716                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14717                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14718                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14719                                                                  ELC50PD
 14720     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14721        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14722            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14723              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14724                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14725                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14726                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14727                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14728                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14729                                                                  ELC50PD
 14730     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14731        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14732            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14733               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14734               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14735               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14736                                                                  ELC50PD
 14737     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14738        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14739            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14740                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14741                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14742                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14743                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14744                                                                  ELC50PD
 14745     IF WS-ERROR = ER-2693                                        ELC50PD
 14746        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14747           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14748           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14749           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14750                                                                  ELC50PD
 14751     IF WS-ERROR = ER-2693                                        ELC50PD
 14752        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14753           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
 14754           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14755           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14756                                                                  ELC50PD
 14757     IF WS-ERROR = ER-2693                                        ELC50PD
 14758        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14759           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14760           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14761           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14762                                                                  ELC50PD
 14763     IF WS-ERROR = ER-2693                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14764        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14765           IF WS-LEVEL                                            ELC50PD
 14766              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14767              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14768                                                                  ELC50PD
 14769     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14770         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14771         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14772       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14773             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14774             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14775         NEXT SENTENCE                                            ELC50PD
 14776     ELSE                                                         ELC50PD
 14777         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14778                                                                  ELC50PD
 14779     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14780        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14781           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14783           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14784                                                                  ELC50PD
 14785     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14786        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14787           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14789           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14790                                                                  ELC50PD
 14791     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14792                                                                  ELC50PD
 14793     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14794         NEXT SENTENCE                                            ELC50PD
 14795     ELSE                                                         ELC50PD
 14796         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14797             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14798                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14799                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14800                                                                  ELC50PD
 14801     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14802       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14803         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14804         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14805         IF WS-ERROR = ER-2675                                    ELC50PD
 14806            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14807            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14808            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14809         ELSE                                                     ELC50PD
 14810            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14811            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14812                                                                  ELC50PD
 14813                                                                  ELC50PD
 14814     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14815         NEXT SENTENCE                                            ELC50PD
 14816     ELSE                                                         ELC50PD
 14817       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14818            NEXT SENTENCE
 14819       ELSE
 14820         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14821             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14822                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14823                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14824                                                                  ELC50PD
 14825     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14826       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14827         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14828         IF WS-ERROR = ER-2676                                    ELC50PD
 14829            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14830            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14831            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14832         ELSE                                                     ELC50PD
 14833            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14834            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14835                                                                  ELC50PD
 14836     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14837         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14838            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14839     ELSE                                                         ELC50PD
 14840         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14841             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14842                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14843                                                                  ELC50PD
 14844     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14845         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14846            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14847     ELSE                                                         ELC50PD
 14848         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14849             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14850                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14851                                                                  ELC50PD
 14852     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14853                                                                  ELC50PD
 14854     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14855                                                                  ELC50PD
 14856                                                                  ELC50PD
 14857 3215-EDIT-RATES.                                                 ELC50PD
 14858     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14859         NEXT SENTENCE                                            ELC50PD
 14860     ELSE                                                         ELC50PD
 14861         GO TO 3999-END-EDIT.                                     ELC50PD
 14862                                                                  ELC50PD
 14863 3220-CHECK-LF-RATES.                                             ELC50PD
 14864                                                                  ELC50PD
 14865     IF PB-COMPANY-ID = 'DCC'
 14866        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14867        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14868        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14869           AND (NOT WS-LF-CASH))
 14870                           OR
 14871           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14872           AND (NOT WS-AH-CASH)))
 14873                       AND
 14874           (PB-I-ENTRY-STATUS NOT = '5')
 14875           MOVE 'M'              TO PB-BATCH-ENTRY
 14876                                    PB-I-ENTRY-STATUS
 14877        END-IF
 14878     END-IF
 14879
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14880
 14881
 14882     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 14883                                    PB-I-AH-PREM-CALC             ELC50PD
 14884                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 14885                                    PB-I-LF-ALT-RATE              ELC50PD
 14886                                    PB-I-LF-REI-RATE              ELC50PD
 14887                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 14888                                    PB-I-AH-REI-RATE
 14889                                    PB-I-TOT-FEES-CALC.
 14890                                                                  ELC50PD
 14891     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 14892        NEXT SENTENCE                                             ELC50PD
 14893     ELSE                                                         ELC50PD
 14894        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 14895                                    PB-I-AH-RATE.                 ELC50PD
 14896                                                                  ELC50PD
 14897     IF PB-I-TOT-FEES NOT NUMERIC
 14898        MOVE ZEROS               TO PB-I-TOT-FEES
 14899     END-IF
 14900
 14901     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 14902         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 14903                                                                  ELC50PD
 14904     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 14905         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 14906                                                                  ELC50PD
 14907     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 14908        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 14909     END-IF
 14910                                                                  ELC50PD
 14911     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 14912        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 14913     END-IF
 14914                                                                  ELC50PD
 14915     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
 14916        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 14917            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 14918     ELSE                                                         ELC50PD
 14919            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 14920                                                                  ELC50PD
 14921     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 14922         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 14923                                                                  ELC50PD
 14924     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 14925         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 14926                                                                  ELC50PD
 14927     MOVE SPACES                 TO CP-BEN-CATEGORY
 14928     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 14929        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 14930        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 14931             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 14932        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 14933             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 14934        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 14935             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 14936        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 14937           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14938           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 14939        ELSE                                                      ELC50PD
 14940           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 14941              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 14942               AM-MAX-TOT-BEN                                     ELC50PD
 14943               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 14944           ELSE                                                   ELC50PD
 14945              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 14946                 AM-MAX-TOT-BEN) AND                              ELC50PD
 14947                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 14948                 AM-MAX-TOT-BEN)                                  ELC50PD
 14949                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 14950              ELSE                                                ELC50PD
 14951                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 14952                                                                  ELC50PD
 14953     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 14954         NEXT SENTENCE                                            ELC50PD
 14955     ELSE                                                         ELC50PD
 14956         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 14957                                                                  ELC50PD
 14958*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 14959                                                                  ELC50PD
 14960     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 14961        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 14962              OR                                                  ELC50PD
 14963           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 14964           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 14965           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14966           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 14967                                                                  ELC50PD
 14968     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 14969           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 14970                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 14971                                                                  ELC50PD
 14972     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 14973         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 14974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14975         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 14976         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 14977         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 14978                                                                  ELC50PD
 14979     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 14980        IF PB-I-LIVES = ZERO                                      ELC50PD
 14981           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 14982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14983                                                                  ELC50PD
 14984     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 14985                                                                  ELC50PD
 14986     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 14987     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 14988     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 14989     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 14990     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 14991     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 14992     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 14993     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 14994     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 14995     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14996                                                                  ELC50PD
 14997******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 14998     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 14999         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15000            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15001             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15002                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15003*******                                                           ELC50PD
 15004                                                                  ELC50PD
 15005     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15006     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15007     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15008     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15009     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15010     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15011                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15012     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15013         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15014                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15015     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15016     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15017     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15018     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15019     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15020     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15021     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15022     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15023     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15024                                    CP-REMAINING-TERM             ELC50PD
 15025                                    CP-LOAN-TERM.                 ELC50PD
 15026                                                                  ELC50PD
 15027     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15028         NEXT SENTENCE                                            ELC50PD
 15029     ELSE                                                         ELC50PD
 15030         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15031             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15032                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15033                                                                  ELC50PD
 15034     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15035        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15036           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15037                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15038                                                                  ELC50PD
 15039     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15040         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15041            CP-EARN-AS-NET-PAY                                    ELC50PD
 15042             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15043                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15044                                                                  ELC50PD
 15045     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15046        or ((pb-company-id = 'AHL')
 15047           and (pb-i-loan-term > pb-i-lf-term))
 15048        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15049                                                                  ELC50PD
 15050     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15051        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15052                                                                  ELC50PD
 15053     IF CP-TERM-IS-DAYS                                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15054         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15055     ELSE                                                         ELC50PD
 15056         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15057
 15058     IF PB-COMPANY-ID = 'DCC'
 15059        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15060        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15061        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15062        IF WS-LF-BEN-CATEGORY = 'D'
 15063           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15064           MOVE PB-I-LIFE-COMMISSION
 15065                                 TO CP-DCC-ACT-COMM
 15066           MOVE WS-LF-BEN-CATEGORY
 15067                                 TO CP-BEN-CATEGORY
 15068        END-IF
 15069        IF (CP-BENEFIT-CD (1:1) = 'P')
 15070           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15071           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15072        END-IF
 15073     END-IF
 15074
 15075     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15076         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15077         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15078         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15079                                                                  ELC50PD
 15080     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15081        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15082                                                                  ELC50PD
 15083     IF (CP-SPECIAL-CALC-CD = 'H')
 15084        OR (PB-COMPANY-ID = 'DCC')
 15085         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15086                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15087         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15088                                                                  ELC50PD
 15089     IF (PB-COMPANY-ID = 'CID')
 15090        AND (WS-LF-EARNINGS-CALC = 'B')
 15091        AND (CP-STATE-STD-ABBRV = 'MN')
 15092        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15093                                 TO CP-ALTERNATE-BENEFIT
 15094        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15095     END-IF
 15096
 15097     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15098     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15099     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15100                                                                  ELC50PD
 15101     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15102        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15103        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15104        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15105                                                                  ELC50PD
 15106     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15107        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15108           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15109              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15110              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15111                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15112
 15113******************************************************************ELC50PD
 15114*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15115*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15116******************************************************************ELC50PD
 15117                                                                  ELC50PD
 15118* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15119                                                                  00031343
 15120     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15121          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15122                                                                  00031346
 15123*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15124*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15125*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15126*        MOVE ER-2709        TO WS-ERROR                          00031349
 15127*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15128*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15129                                                                  00031352
 15130*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15131*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15132*        MOVE ER-2718        TO WS-ERROR                          00031349
 15133*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15134*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15135                                                                  00031352
 15136* CALC A & H AGE AT EXPIRATION.                                   00031353
 15137                                                                  00031354
 15138     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15139          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15140                                                                  00031357
 15141*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15142*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15143*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15144*        MOVE ER-2709        TO WS-ERROR                          00031349
 15145*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15146*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15147                                                                  00031352
 15148*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15149*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15150*        MOVE ER-2718        TO WS-ERROR                          00031360
 15151*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15152*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15153
 15154     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15155        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15156                                                                  ELC50PD
 15157     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
 15158        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15159                                                                  ELC50PD
 15160     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15161        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15162                                                                  ELC50PD
 15163     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15164         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15165         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15166         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15167                                                                  ELC50PD
 15168                                                                  00031363
 15169******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15170*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15171******************************************************************ELC50PD
 15172                                                                  ELC50PD
 15173 PREMIUM-EDITING-IS-BYPASSED.
 15174
 15175     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15176        AND (CP-R-MAX-ATT-AGE > +0)
 15177        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15178        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15179           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15180           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15181           MOVE '1'              TO DC-OPTION-CODE
 15182           PERFORM 8500-DATE-CONVERT
 15183                                 THRU 8500-EXIT
 15184           IF NO-CONVERSION-ERROR
 15185              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15186                 MOVE ER-2661       TO WS-ERROR
 15187*                PERFORM 9900-ERROR-FORMAT
 15188*                                THRU 9900-EXIT
 15189              END-IF
 15190           END-IF
 15191        ELSE
 15192           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15193           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15194              MOVE ER-2661       TO WS-ERROR
 15195*             PERFORM 9900-ERROR-FORMAT
 15196*                                THRU 9900-EXIT
 15197           ELSE
 15198              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15199                 MOVE ER-1570    TO WS-ERROR
 15200                 PERFORM 9900-ERROR-FORMAT
 15201                                 THRU 9900-EXIT
 15202              END-IF
 15203           END-IF
 15204        END-IF
 15205
 15206        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15207           MOVE PB-I-JOINT-BIRTHDAY
 15208                                 TO DC-BIN-DATE-1
 15209           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15210           MOVE '1'              TO DC-OPTION-CODE
 15211           PERFORM 8500-DATE-CONVERT
 15212                                 THRU 8500-EXIT
 15213           IF NO-CONVERSION-ERROR
 15214              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15215                 MOVE ER-2661       TO WS-ERROR
 15216*                PERFORM 9900-ERROR-FORMAT
 15217*                                THRU 9900-EXIT
 15218              END-IF
 15219           ELSE
 15220              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15221           END-IF
 15222        ELSE
 15223           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15224             (PB-I-LF-TERM / 12)
 15225           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15226              MOVE ER-2661       TO WS-ERROR
 15227*             PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15228*                                THRU 9900-EXIT
 15229           ELSE
 15230              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15231                 MOVE ER-1571    TO WS-ERROR
 15232                 PERFORM 9900-ERROR-FORMAT
 15233                                 THRU 9900-EXIT
 15234              END-IF
 15235           END-IF
 15236        END-IF
 15237        IF WS-ERROR = ER-2661
 15238           PERFORM 9900-ERROR-FORMAT
 15239                                 THRU 9900-EXIT
 15240        END-IF
 15241     END-IF
 15242
 15243*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15244*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15245*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15246                                                                  ELC50PD
 15247     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15248        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15250                                                                  ELC50PD
 15251     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15252        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15254                                                                  ELC50PD
 15255     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15256        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15258                                                                  ELC50PD
 15259 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15260                                                                  ELC50PD
 15261     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15262         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15263                                                                  ELC50PD
 15264     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15265        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15266     END-IF
 15267
 15268     .
 15269 3221-CONTINUE.                                                   ELC50PD
 15270     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15271                                    WS-DCC-AH-RATE
 15272
 15273     IF PB-COMPANY-ID = 'DCC'
 15274        IF WS-LF-BEN-CATEGORY = 'D'
 15275           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15276              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15277        END-IF
 15278     END-IF
 15279
 15280     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15281
 15282*   X'A4FF' = 12/31/2009
 15283     IF (PB-COMPANY-ID = 'CID')
 15284        AND (WS-LF-EARNINGS-CALC = 'B')
 15285        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15286        AND (PB-CERT-EFF-DT > X'A4FF')
 15287        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15288     END-IF
 15289
 15290     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15291                                                                  ELC50PD
 15292     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15293     IF (PB-COMPANY-ID = 'DCC')
 15294        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15295        AND (PB-I-POLICY-IS-MONTHLY)
 15296        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15297        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15298     END-IF
 15299     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15300     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15301     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15302     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15303
 15304     IF (PB-COMPANY-ID = 'DCC')
 15305        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15306        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15307        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15308        MOVE ER-2786             TO WS-ERROR
 15309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15310     END-IF
 15311                                                                  ELC50PD
 15312     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15313                                                                  ELC50PD
 15314******************************************************************ELC50PD
 15315*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15316******************************************************************ELC50PD
 15317     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15318        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
 15319                                                                  ELC50PD
 15320     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15321        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15322     ELSE                                                         ELC50PD
 15323       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15324          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15325          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15326                                                                  ELC50PD
 15327 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15328                                                                  ELC50PD
 15329     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15330        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15331        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15332         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15333                                                                  ELC50PD
 15334     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15335         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15336             AND PB-COMPANY-ID NOT = 'DCC')
 15337                   OR
 15338
 15339              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15340              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15341              AND PB-COMPANY-ID NOT = 'DCC')
 15342             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15343             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15344             GO TO 3225-RATING-CONT                               ELC50PD
 15345         ELSE                                                     ELC50PD
 15346             GO TO 3225-RATING-CONT.                              ELC50PD
 15347
 15348     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15349        AND (AM-GPCD = 01 OR 06 OR 15)
 15350        MOVE ER-2798             TO WS-ERROR
 15351        PERFORM 9900-ERROR-FORMAT
 15352                                 THRU 9900-EXIT
 15353*       GO TO 3225-RATING-CONT
 15354     END-IF
 15355
 15356     IF (PB-COMPANY-ID = 'CID')
 15357        AND (WS-LF-EARNINGS-CALC = 'B')
 15358        AND (CP-STATE-STD-ABBRV = 'MN')
 15359        AND (PB-CERT-EFF-DT > X'A4FF')
 15360        GO TO 3225-RATING-CONT
 15361     END-IF
 15362
 15363     IF PB-COMPANY-ID = 'DCC'
 15364        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15365           AND (PB-I-POLICY-IS-MONTHLY)
 15366           GO TO 3225-RATING-CONT
 15367        END-IF
 15368     END-IF
 15369
 15370     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15371        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15372        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15373        NEXT SENTENCE                                             ELC50PD
 15374     ELSE                                                         ELC50PD
 15375        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15376                                                                  ELC50PD
 15377 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15378                                                                  ELC50PD
 15379     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15380                                                                  ELC50PD
 15381     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15382        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15383        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15384         NEXT SENTENCE                                            ELC50PD
 15385     ELSE                                                         ELC50PD
 15386         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15387                                                                  ELC50PD
 15388     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15389     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15390     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15391                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15392     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15393         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15394                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15395
 15396     IF PB-COMPANY-ID = 'DCC'
 15397        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15398     END-IF
 15399
 15400     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15401     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15402     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15403                                    CP-REMAINING-TERM             ELC50PD
 15404                                    CP-LOAN-TERM.                 ELC50PD
 15405     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15406        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15407                                    CP-REMAINING-TERM             ELC50PD
 15408                                    CP-LOAN-TERM.                 ELC50PD
 15409                                                                  ELC50PD
 15410     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15411     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15412                                                                  ELC50PD
 15413     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15414         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15416         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15417                                                                  ELC50PD
 15418     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15419     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15420                                                                  ELC50PD
 15421     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15422         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15423                                                                  ELC50PD
 15424     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15425                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15426                                                                  ELC50PD
 15427     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15428        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15429        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')                    ELC50PD
 15430        GO TO 3225-CONTINUE.                                      ELC50PD
 15431                                                                  ELC50PD
 15432     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15433        GO TO 3225-CONTINUE.                                      ELC50PD
 15434                                                                  ELC50PD
 15435     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15436                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15437        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15438        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15440                                                                  ELC50PD
 15441 3225-CONTINUE.                                                   ELC50PD
 15442     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15443         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15445                                                                  ELC50PD
 15446     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15447        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
 15448        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15450                                                                  ELC50PD
 15451 3225-RATING-CONT.                                                ELC50PD
 15452                                                                  ELC50PD
 15453     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15454         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15455         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15456         IF (PB-COMPANY-ID = 'DCC')
 15457            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15458            CONTINUE
 15459         ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15460            MOVE ER-2687         TO WS-ERROR
 15461            PERFORM 9900-ERROR-FORMAT
 15462                                 THRU 9900-EXIT
 15463         END-IF
 15464         GO TO 3290-EDIT-LF-REIN-RATE
 15465     END-IF
 15466                                                                  ELC50PD
 15467* DMD RATING TEST                                                 ELC50PD
 15468     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15469         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15470         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15471         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15472         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15473         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15474                                                                  ELC50PD
 15475 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15476                                                                  ELC50PD
 15477     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15478     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15479*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15480     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15481     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15482                                                                  ELC50PD
 15483 C-POS-3230-MORT-CD.                                              ELC50PD
 15484     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15485        PB-SV-CARRIER = '2'                                       ELC50PD
 15486         NEXT SENTENCE                                            ELC50PD
 15487     ELSE                                                         ELC50PD
 15488         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15489                                                                  ELC50PD
 15490     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15491        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15492         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
 15493      ELSE                                                        ELC50PD
 15494         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15495                                                                  ELC50PD
 15496                                                                  ELC50PD
 15497 C-POS-3240-MORT-CD.                                              ELC50PD
 15498     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15499        PB-SV-CARRIER = '1'                                       ELC50PD
 15500         NEXT SENTENCE                                            ELC50PD
 15501     ELSE                                                         ELC50PD
 15502         GO TO 3230-CONTINUE.                                     ELC50PD
 15503                                                                  ELC50PD
 15504     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15505        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
 15506         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15507     ELSE                                                         ELC50PD
 15508         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15509                                                                  ELC50PD
 15510 3230-CONTINUE.                                                   ELC50PD
 15511
 15512     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15513        GO TO 3240-CONTINUE                                       00033065
 15514     END-IF
 15515
 15516     IF PB-CERT-EFF-DT > WS-971231
 15517        GO TO 3240-CONTINUE                                       00033065
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15518     END-IF
 15519
 15520     IF LF-BENEFIT-FOUND AND                                      00033066
 15521        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15522         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15523     ELSE                                                         00033069
 15524         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15525             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15526         ELSE                                                     00033072
 15527             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15528         END-IF
 15529     END-IF
 15530                                                                  00033074
 15531     .
 15532 3240-CONTINUE.                                                   ELC50PD
 15533
 15534     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15535         GO TO 3256-CONTINUE.                                     ELC50PD
 15536                                                                  ELC50PD
 15537     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15538         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15539     ELSE                                                         ELC50PD
 15540         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15541                                                                  ELC50PD
 15542 3256-CONTINUE.                                                   ELC50PD
 15543     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15544         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15545                                                                  ELC50PD
 15546     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15547         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15548     ELSE                                                         ELC50PD
 15549         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15550                                                                  ELC50PD
 15551 3260-EDIT-CONTINUE.                                              ELC50PD
 15552     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15553                                                                  ELC50PD
 15554 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15555     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15556         GO TO 3290-RATING-CONT.                                  ELC50PD
 15557                                                                  ELC50PD
 15558     IF PB-COMPANY-ID = 'DCC'
 15559        GO TO 3290-RATING-CONT.
 15560
 15561     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15562     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15563     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
 15564     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15565     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15566                                                                  ELC50PD
 15567******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15568     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15569         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15570            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15571             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15572*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15573             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15574             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15575***  Y2K PROJ 7744                                                   CL*11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15576             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15577                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15578***  Y2K PROJ 7744                                                   CL*11
 15579*******                                                           ELC50PD
 15580                                                                  ELC50PD
 15581     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15582     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15583     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15584     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15585                                   CP-RATE-DEV-PCT.               ELC50PD
 15586     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15587     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15588                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15589                                                                  ELC50PD
 15590************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15591     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15592         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15593            CP-EARN-AS-NET-PAY                                    ELC50PD
 15594             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15595                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15596************                                                      ELC50PD
 15597                                                                  ELC50PD
 15598     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15599         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15600                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15601     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15602     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15603     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15604     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15605     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15606     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15607     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15608     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
 15609                                   CP-REMAINING-TERM              ELC50PD
 15610                                   CP-LOAN-TERM.                  ELC50PD
 15611     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15612        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15613                                                                  ELC50PD
 15614     IF CP-TERM-IS-DAYS                                           ELC50PD
 15615         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15616     ELSE                                                         ELC50PD
 15617         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15618                                                                  ELC50PD
 15619
 15620     IF PB-COMPANY-ID = 'DCC'
 15621        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15622     END-IF
 15623
 15624     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15625          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15626                                                                  ELC50PD
 15627     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15628                                                                  ELC50PD
 15629     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15630     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15631                                                                  ELC50PD
 15632     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15633        IF PB-I-OB                                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15634           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15635           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15636           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15637        ELSE                                                      ELC50PD
 15638           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15639           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15640           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15641                                                                  ELC50PD
 15642     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15643                                                                  ELC50PD
 15644     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15645     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15646                                                                  ELC50PD
 15647     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15648         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15650                                                                  ELC50PD
 15651 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15652                                                                  ELC50PD
 15653     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15654        GO TO 3290-RATING-CONT.                                   ELC50PD
 15655                                                                  ELC50PD
 15656     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15657     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15658     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15659     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15660     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15661     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15662                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15663     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15664         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15665                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15666
 15667     IF PB-COMPANY-ID = 'DCC'
 15668        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15669     END-IF
 15670
 15671     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15672     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15673     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15674                                    CP-REMAINING-TERM             ELC50PD
 15675                                    CP-LOAN-TERM.                 ELC50PD
 15676     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15677        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15678                                    CP-REMAINING-TERM             ELC50PD
 15679                                    CP-LOAN-TERM.                 ELC50PD
 15680                                                                  ELC50PD
 15681     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15682     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15683                                                                  ELC50PD
 15684     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15685                                                                  ELC50PD
 15686     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15687         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15689                                                                  ELC50PD
 15690 3290-RATING-CONT.                                                ELC50PD
 15691                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15692     IF PB-I-OB                                                   ELC50PD
 15693*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15694        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15695                                                                  ELC50PD
 15696 3299-EDIT-CONTINUE.                                              ELC50PD
 15697                                                                  ELC50PD
 15698     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15699         NEXT SENTENCE                                            ELC50PD
 15700     ELSE                                                         ELC50PD
 15701         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15702         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15703                                                                  ELC50PD
 15704 3300-CHECK-AH-RATES.                                             ELC50PD
 15705     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15706         NEXT SENTENCE                                            ELC50PD
 15707     ELSE                                                         ELC50PD
 15708         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15709                                                                  ELC50PD
 15710     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15711        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15712                (NO-DMD-RATING))                                  ELC50PD
 15713         IF (PB-COMPANY-ID = 'DCC')
 15714            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15715            CONTINUE
 15716         ELSE
 15717            MOVE ER-2687         TO WS-ERROR
 15718            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15719         END-IF
 15720         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15721         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15722     END-IF
 15723                                                                  ELC50PD
 15724     IF PB-I-OB                                                   ELC50PD
 15725        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15726                                                                  ELC50PD
 15727     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15728         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15730         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15731         GO TO 3999-END-EDIT.                                     ELC50PD
 15732                                                                  ELC50PD
 15733*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15734                                                                  ELC50PD
 15735     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15736        IF PB-I-AH-CRIT-PER = ZERO
 15737           IF PB-COMPANY-ID = 'DCC'
 15738              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15739              CONTINUE
 15740           ELSE
 15741              MOVE ER-2618       TO WS-ERROR
 15742              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15743              GO TO 3999-END-EDIT
 15744           END-IF
 15745        END-IF
 15746     END-IF
 15747
 15748     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15749     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15750     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15751     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15752     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15753     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15754     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15755     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15756     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15757*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15758     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15759     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15760     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15761     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15762                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15763     IF PB-COMPANY-ID = 'CID'
 15764               OR
 15765        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15766         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15767                                         PB-I-AH-TERM.            ELC50PD
 15768     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15769        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15770           AND (PB-I-POLICY-IS-MONTHLY)
 15771           MOVE PB-I-LF-BENEFIT-AMT
 15772                                 TO CP-NET-BENEFIT-AMT
 15773           move pb-i-ah-premium-amt to cp-original-premium
 15774        END-IF
 15775     END-IF
 15776
 15777     MOVE SPACES                 TO CP-BEN-CATEGORY
 15778
 15779     IF PB-COMPANY-ID = 'DCC'
 15780        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15781        EVALUATE TRUE
 15782           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15783              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15784              MOVE PB-I-LF-BENEFIT-AMT
 15785                                 TO CP-RATING-BENEFIT-AMT
 15786              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15787           WHEN WS-AH-BEN-CATEGORY = 'G'
 15788              MOVE PB-I-UNPAID-CASH-PRICE
 15789                                 TO CP-RATING-BENEFIT-AMT
 15790           WHEN WS-AH-BEN-CATEGORY = 'D'
 15791              MOVE WS-AH-PMF-COMM
 15792                                 TO CP-DCC-PMF-COMM
 15793              MOVE PB-I-AH-COMMISSION
 15794                                 TO CP-DCC-ACT-COMM
 15795        END-EVALUATE
 15796     END-IF
 15797
 15798     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15799     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15800     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15801     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15802     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15803     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15804     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15805                                    CP-REMAINING-TERM             ELC50PD
 15806                                    WS-WORK-TERM.                 ELC50PD
 15807     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15808                                                                  ELC50PD
 15809     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15810     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15811*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15812     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15813     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15814                                                                  ELC50PD
 15815     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15816     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15817         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15819         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15820                                                                  ELC50PD
 15821     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15822         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15823                                                                  ELC50PD
 15824     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15825                                                                  ELC50PD
 15826     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15827         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15828     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15829         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15830     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15831         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15832     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15833         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15834     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15835         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15836                                                                  ELC50PD
 15837     MOVE 1                      TO SUB2.                         ELC50PD
 15838     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15839     MOVE WS-MONTH               TO SUB1.                         ELC50PD
 15840     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15841     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15842                                                                  ELC50PD
 15843 3310-GET-SKIP-MO.                                                ELC50PD
 15844     IF SUB1 = 13                                                 ELC50PD
 15845         MOVE 1                  TO SUB1.                         ELC50PD
 15846                                                                  ELC50PD
 15847     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15848         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15849                                                                  ELC50PD
 15850     ADD 1 TO SUB2                                                ELC50PD
 15851              SUB1.                                               ELC50PD
 15852                                                                  ELC50PD
 15853 3320-RATE-CONTINUE.                                              ELC50PD
 15854                                                                  ELC50PD
 15855     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15856         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15857                                                                  ELC50PD
 15858     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15859                                    CP-LOAN-TERM.                 ELC50PD
 15860                                                                  ELC50PD
 15861     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15862         NEXT SENTENCE                                            ELC50PD
 15863     ELSE                                                         ELC50PD
 15864         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15865                                    PB-I-AH-REI-RATE.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15866                                                                  ELC50PD
 15867                                                                  ELC50PD
 15868     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15869        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15870                                                                  ELC50PD
 15871     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15872         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15873         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15874         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15875         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 15876                                                                  ELC50PD
 15877     IF PB-COMPANY-ID = 'DCC'
 15878        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15879           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15880              PB-I-RATE-DEV-PCT-LF
 15881        END-IF
 15882        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15883                                 TO CP-ALTERNATE-BENEFIT
 15884        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15885        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15886        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15887     END-IF
 15888
 15889     IF (PB-COMPANY-ID = 'CID')
 15890        AND (WS-LF-EARNINGS-CALC = 'B')
 15891        AND (CP-STATE-STD-ABBRV = 'MN')
 15892        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 15893     ELSE
 15894        MOVE ' '                 TO CP-AH-BALLOON-SW
 15895     END-IF
 15896
 15897     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 15898     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15899     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15900                                                                  ELC50PD
 15901     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15902        IF PB-I-OB                                                ELC50PD
 15903           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 15904           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15905           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 15906        ELSE                                                      ELC50PD
 15907          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15908              NEXT SENTENCE
 15909          ELSE
 15910           MOVE ER-2642          TO WS-ERROR                      ELC50PD
 15911           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15912           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 15913                                                                  ELC50PD
 15914     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 15915        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 15916           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 15917           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15918                                                                  ELC50PD
 15919     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15920        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15921           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 15922              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 15923              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15924                                                                  ELC50PD
 15925     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 15926        NEXT SENTENCE                                             ELC50PD
 15927     ELSE                                                         ELC50PD
 15928       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 15929          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 15930          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15931                                                                  ELC50PD
 15932     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 15933         IF WS-ERROR = ER-2640                                    ELC50PD
 15934             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 15935
 15936     IF ACCOUNT-AH-CHECKED
 15937        CONTINUE
 15938     ELSE
 15939        IF (CP-R-MAX-ATT-AGE NUMERIC)
 15940           AND (CP-R-MAX-ATT-AGE > +0)
 15941           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 15942           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 15943              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 15944              MOVE PB-I-AH-EXPIRE-DT
 15945                                 TO DC-BIN-DATE-2
 15946              MOVE '1'           TO DC-OPTION-CODE
 15947              PERFORM 8500-DATE-CONVERT
 15948                                 THRU 8500-EXIT
 15949              IF NO-CONVERSION-ERROR
 15950                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15951                    MOVE ER-2661       TO WS-ERROR
 15952*                   PERFORM 9900-ERROR-FORMAT
 15953*                                THRU 9900-EXIT
 15954                 END-IF
 15955              END-IF
 15956           ELSE
 15957              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 15958              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15959                 MOVE ER-2661    TO WS-ERROR
 15960*                PERFORM 9900-ERROR-FORMAT
 15961*                                THRU 9900-EXIT
 15962              ELSE
 15963                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15964                    MOVE ER-1570 TO WS-ERROR
 15965                    PERFORM 9900-ERROR-FORMAT
 15966                                 THRU 9900-EXIT
 15967                 END-IF
 15968              END-IF
 15969           END-IF
 15970
 15971           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15972              MOVE PB-I-JOINT-BIRTHDAY
 15973                                    TO DC-BIN-DATE-1
 15974              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 15975              MOVE '1'              TO DC-OPTION-CODE
 15976              PERFORM 8500-DATE-CONVERT
 15977                                    THRU 8500-EXIT
 15978              IF NO-CONVERSION-ERROR
 15979                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15980                    MOVE ER-2661       TO WS-ERROR
 15981*                   PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15982*                                   THRU 9900-EXIT
 15983                 END-IF
 15984              END-IF
 15985           ELSE
 15986              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15987                (PB-I-AH-TERM / 12)
 15988              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15989                 MOVE ER-2661       TO WS-ERROR
 15990*                PERFORM 9900-ERROR-FORMAT
 15991*                                   THRU 9900-EXIT
 15992              ELSE
 15993                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15994                    MOVE ER-1571 TO WS-ERROR
 15995                    PERFORM 9900-ERROR-FORMAT
 15996                                 THRU 9900-EXIT
 15997                 END-IF
 15998              END-IF
 15999           END-IF
 16000           IF WS-ERROR = ER-2661
 16001              PERFORM 9900-ERROR-FORMAT
 16002                                    THRU 9900-EXIT
 16003           END-IF
 16004        END-IF
 16005     END-IF
 16006
 16007*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16008*       NEXT SENTENCE                                             ELC50PD
 16009*    ELSE                                                         ELC50PD
 16010*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16011*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16012*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16013                                                                  ELC50PD
 16014     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16015        NEXT SENTENCE                                             ELC50PD
 16016     ELSE                                                         ELC50PD
 16017        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16018           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16020                                                                  ELC50PD
 16021     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16022        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16023         PB-POLICY-IS-VOIDED                                      ELC50PD
 16024        NEXT SENTENCE                                             ELC50PD
 16025     ELSE                                                         ELC50PD
 16026        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
 16027           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16028           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16029                                                                  ELC50PD
 16030     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16031         IF WS-ERROR = ER-2667                                    ELC50PD
 16032             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16033                                                                  ELC50PD
 16034     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16035        NEXT SENTENCE                                             ELC50PD
 16036     ELSE                                                         ELC50PD
 16037        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16038           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16039           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16040                                                                  ELC50PD
 16041     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16042         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16043                                                                  ELC50PD
 16044 3321-CONTINUE.                                                   ELC50PD
 16045     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16046     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16047
 16048     IF (PB-COMPANY-ID = 'DCC')
 16049        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16050        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16051                                    PB-I-LF-ALT-PREM-CALC
 16052        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16053        IF WS-AH-BEN-CATEGORY = 'G'
 16054           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16055           + PB-I-ADDL-CLP)
 16056           * (1 + WS-TOL-CLP-PCT)
 16057*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16058        ELSE
 16059           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16060           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16061*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16062        END-IF
 16063        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16064                                 TO PB-I-AH-PREM-CALC
 16065        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16066           MOVE ER-8152          TO WS-ERROR
 16067           PERFORM 9900-ERROR-FORMAT
 16068                                 THRU 9900-EXIT
 16069        ELSE
 16070           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16071                 PB-I-ADDL-CLP)
 16072              MOVE ER-8148       TO WS-ERROR
 16073              PERFORM 9900-ERROR-FORMAT
 16074                                 THRU 9900-EXIT
 16075           END-IF
 16076        END-IF
 16077     END-IF
 16078     IF (PB-COMPANY-ID = 'DCC')
 16079        AND (PB-I-POLICY-IS-MONTHLY)
 16080        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16081        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16082        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16083           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16084        END-IF
 16085     END-IF
 16086
 16087     IF (PB-COMPANY-ID = 'DCC')
 16088        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16089        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16090        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16091        MOVE ER-2786             TO WS-ERROR
 16092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16093     END-IF
 16094
 16095     MOVE +0                     TO PB-I-AH-CLP
 16096     IF PB-COMPANY-ID = 'DCC'
 16097        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16098           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16099              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16100        ELSE
 16101           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16102              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16103           END-IF
 16104        END-IF
 16105     END-IF
 16106
 16107     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16108                                                                  ELC50PD
 16109     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16110         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16111                                                                  ELC50PD
 16112     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16113         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16114                                                                  ELC50PD
 16115     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16116         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16117            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16118             NEXT SENTENCE                                        ELC50PD
 16119         ELSE                                                     ELC50PD
 16120             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16121                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16122                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16123             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16124                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16125                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16126                                                                  ELC50PD
 16127     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16128       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16129           NEXT SENTENCE
 16130       ELSE
 16131         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16132         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16133                                                                  ELC50PD
 16134     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16135     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16136     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16137     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16138     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16139     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16140                                                                  ELC50PD
 16141     IF (PB-COMPANY-ID = 'DCC')
 16142        AND (WS-AH-BEN-CATEGORY = 'G')
 16143        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16144        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16145        IF CP-DEVIATION-CODE NOT = '000'
 16146           MOVE '000'            TO CP-DEVIATION-CODE
 16147           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16148           IF NO-CP-ERROR
 16149              COMPUTE PB-I-DDF-IU-RATE-UP =
 16150              PB-I-AH-CLP - CP-CALC-PREMIUM
 16151           ELSE
 16152              MOVE ER-3057        TO WS-ERROR
 16153              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16154           END-IF
 16155        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16156     END-IF
 16157
 16158     .
 16159 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16160     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16161         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16162                                                                  ELC50PD
 16163     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16164     IF PB-COMPANY-ID = 'DCC'
 16165         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16166
 16167     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16168     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16169     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16170     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16171     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16172     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16173                                    CP-RATE-DEV-PCT.              ELC50PD
 16174*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16175     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16176     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16177     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16178     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16179                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16180     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16181         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16182                                         PB-I-AH-TERM.            ELC50PD
 16183     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16184     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16185     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16186     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16187     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16188     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16189                                    CP-REMAINING-TERM             ELC50PD
 16190                                    WS-WORK-TERM.                 ELC50PD
 16191     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16192
 16193     IF PB-COMPANY-ID = 'DCC'
 16194        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16195     END-IF
 16196
 16197     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16198         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16199            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16200                                                                  ELC50PD
 16201     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16202          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16203                                                                  ELC50PD
 16204     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16205                                                                  ELC50PD
 16206     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16207                                                                  ELC50PD
 16208     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16209                                                                  ELC50PD
 16210     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16211     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16212                                                                  ELC50PD
 16213     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16214         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16216         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16217                                                                  ELC50PD
 16218     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16219                                                                  ELC50PD
 16220     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16221     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16222                                                                  ELC50PD
 16223     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16224         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16225         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16226                                                                  ELC50PD
 16227                                                                  ELC50PD
 16228 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16229                                                                  ELC50PD
 16230     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16231         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16232             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16233             GO TO 3999-END-EDIT.                                 ELC50PD
 16234                                                                  ELC50PD
 16235     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16236                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16237                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16238                         OR 'AHL'
 16239         NEXT SENTENCE                                            ELC50PD
 16240     ELSE                                                         ELC50PD
 16241         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16242             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16243                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16244                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16245                                     PB-I-LF-PREM-CALC * .90      ELC50PD
 16246                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16247                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16248                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16249                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16250                                                                  ELC50PD
 16251     IF PB-COMP-LF-PREM                                           ELC50PD
 16252        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16253        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16254                                                                  ELC50PD
 16255     IF PB-COMP-AH-PREM                                           ELC50PD
 16256        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16257                                                                  ELC50PD
 16258 3340-CHECK-DCC-TOT-FEES.
 16259
 16260     IF (PB-COMPANY-ID = 'DCC')
 16261        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16262        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16263        AND (PB-I-POLICY-IS-MONTHLY)
 16264        CONTINUE
 16265     ELSE
 16266        GO TO 3340-EDIT-LF-AH-TOL
 16267     END-IF
 16268
 16269     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16270     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16271
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16272     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16273        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16274           PB-I-RATE-DEV-PCT-LF
 16275     END-IF
 16276     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16277        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16278           PB-I-RATE-DEV-PCT-AH
 16279     END-IF
 16280     MOVE 'N'                    TO CP-BEN-CATEGORY
 16281
 16282     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16283                                                                  ELC50PD
 16284     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16285     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16286     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16287     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16288     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16289     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16290     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16291     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16292     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16293     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16294                                                                  ELC50PD
 16295     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16296     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16297     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16298     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16299     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16300     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16301                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16302     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16303         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 16304                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16305     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16306     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16307     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16308     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16309     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16310     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16311     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16312     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16313     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16314                                    CP-REMAINING-TERM             ELC50PD
 16315                                    CP-LOAN-TERM.                 ELC50PD
 16316                                                                  ELC50PD
 16317     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 16318         NEXT SENTENCE                                            ELC50PD
 16319     ELSE                                                         ELC50PD
 16320         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 16321             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 16322                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 16323                                                                  ELC50PD
 16324     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16325        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16326                                                                  ELC50PD
 16327     IF CP-TERM-IS-DAYS                                           ELC50PD
 16328         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16329     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16330         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16331                                                                  ELC50PD
 16332
 16333     IF PB-COMPANY-ID = 'DCC'
 16334        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16335     END-IF
 16336
 16337     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16338         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16339                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16340         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16341
 16342     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16343     MOVE 'R'                    TO CP-RATE-FILE
 16344     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16345
 16346     IF NOT CP-ERROR-RATE-NOT-FOUND
 16347        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16348        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16349           AND (CP-BENEFIT-CD (1:1) = 'S')
 16350           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16351                                    PB-I-LF-PREMIUM-AMT
 16352        END-IF
 16353     ELSE
 16354        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16355     END-IF
 16356
 16357     .
 16358 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16359                                                                  ELC50PD
 16360***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16361***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16362***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16363***                                                               ELC50PD
 16364     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16365         PB-I-AH-PREMIUM-AMT                                      ELC50PD
 16366          GIVING WS-CALC-WORK.                                    ELC50PD
 16367                                                                  ELC50PD
 16368     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16369        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16370         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16371         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16372                                                                  ELC50PD
 16373     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16374             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16375                 GIVING WS-UNSIGN-WRK1.                              CL**2
 16376                                                                     CL**2
 16377     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16378             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16379                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16380                                                                     CL**2
 16381     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16382                                + WS-UNSIGN-WRK4.                    CL**2
 16383                                                                     CL**2
 16384     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16385             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16386                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16387                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16388******************************************************************ELC50PD
 16389*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16390******************************************************************ELC50PD
 16391                                                                  ELC50PD
 16392     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16393         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16394                                                                  ELC50PD
 16395     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16396         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16397                                                                  ELC50PD
 16398     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16399             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16400                                                                  ELC50PD
 16401 3342-CONTINUE.                                                   ELC50PD
 16402                                                                  ELC50PD
 16403     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16404         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16405         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16406            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16407              NEXT SENTENCE                                       ELC50PD
 16408         ELSE                                                     ELC50PD
 16409             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16410                                                                  ELC50PD
 16411     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16412         NEXT SENTENCE                                            ELC50PD
 16413     ELSE                                                         ELC50PD
 16414     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16415        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16416           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16417               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16418               PB-POLICY-IS-VOIDED)                               ELC50PD
 16419              NEXT SENTENCE                                       ELC50PD
 16420           ELSE                                                   ELC50PD
 16421              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16422                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16423                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16424                 GO TO 3344-CHECK-AH                              ELC50PD
 16425              ELSE                                                ELC50PD
 16426                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16427                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16428                 GO TO 3344-CHECK-AH.                             ELC50PD
 16429                                                                  ELC50PD
 16430***                                                               ELC50PD
 16431***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16432***                                                               ELC50PD
 16433                                                                  ELC50PD
 16434     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16435         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16436            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16437             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16438         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16439            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16440             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16441     ELSE                                                         ELC50PD
 16442         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT      ELC50PD
 16443         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 16444                                                                  ELC50PD
 16445***                                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16446***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16447***                                                               ELC50PD
 16448                                                                  ELC50PD
 16449     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16450         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16451          WS-TOL-LF-PREM.                                         ELC50PD
 16452                                                                  ELC50PD
 16453     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16454         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16455          WS-TOL-LF-PREM.                                         ELC50PD
 16456                                                                  ELC50PD
 16457     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16458        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16459                                                                  ELC50PD
 16460     IF (PB-REISSUED-CERT        OR                               ELC50PD
 16461         PB-POLICY-IS-DECLINED   OR                               ELC50PD
 16462         PB-POLICY-IS-VOIDED)                                     ELC50PD
 16463        NEXT SENTENCE                                             ELC50PD
 16464     ELSE                                                         ELC50PD
 16465     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)         ELC50PD
 16466           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)                 ELC50PD
 16467       OR                                                         ELC50PD
 16468        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)          ELC50PD
 16469           LESS THAN WS-TOL-LF-LOW-PREM-AMT))                     ELC50PD
 16470       AND                                                        ELC50PD
 16471        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)         ELC50PD
 16472           GREATER WS-TOL-LF-HIGH-PREM-PCT)                       ELC50PD
 16473         OR                                                       ELC50PD
 16474          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)        ELC50PD
 16475           LESS WS-TOL-LF-LOW-PREM-PCT))                          ELC50PD
 16476              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE              ELC50PD
 16477                  MOVE ER-2652   TO  WS-ERROR                     ELC50PD
 16478                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 16479              ELSE                                                ELC50PD
 16480                  MOVE ER-2650   TO  WS-ERROR                     ELC50PD
 16481                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16482                                                                  ELC50PD
 16483*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16484*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16485*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16486*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16487                                                                  ELC50PD
 16488     IF WS-ERROR  =  ER-2650  OR  ER-2652
 16489        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16490                      OR
 16491           ((PB-COMPANY-ID = 'DCC')
 16492           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 16493           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16494           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16495        END-IF
 16496     END-IF
 16497                                                                  ELC50PD
 16498     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16499        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16500           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16501              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16502                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16503                  PB-POLICY-IS-VOIDED)                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16504                 NEXT SENTENCE                                    ELC50PD
 16505              ELSE                                                ELC50PD
 16506                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16507                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16508                                                                  ELC50PD
 16509 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16510                                                                  ELC50PD
 16511      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16512          GO TO 3344-CHECK-AH.                                    ELC50PD
 16513                                                                  ELC50PD
 16514      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16515          GO TO 3344-CHECK-AH.                                    ELC50PD
 16516                                                                  ELC50PD
 16517      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16518                                     WS-UNSIGN-WRK6.              ELC50PD
 16519                                                                  ELC50PD
 16520      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16521          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16522                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16523                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16524                                                                  ELC50PD
 16525      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16526          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16527                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16528                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16529                                                                  ELC50PD
 16530      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16531          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16532              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16533                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16534                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16535              ELSE                                                ELC50PD
 16536                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16537                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16538                                                                  ELC50PD
 16539      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16540          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16541              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16542                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16544              ELSE                                                ELC50PD
 16545                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16546                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16547                                                                  ELC50PD
 16548 3344-CHECK-AH.                                                   ELC50PD
 16549                                                                  ELC50PD
 16550****************************************************************  ELC50PD
 16551***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16552***                                                               ELC50PD
 16553                                                                  ELC50PD
 16554     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16555         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16556             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16557         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16558             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16559     ELSE                                                         ELC50PD
 16560         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT      ELC50PD
 16561         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16562                                                                  ELC50PD
 16563***                                                               ELC50PD
 16564***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16565***                                                               ELC50PD
 16566                                                                  ELC50PD
 16567     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16568         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16569                                                                  ELC50PD
 16570     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16571         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16572                                                                  ELC50PD
 16573     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16574        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16575                                                                  ELC50PD
 16576     IF (PB-REISSUED-CERT)
 16577        OR (PB-POLICY-IS-DECLINED)
 16578        OR (PB-POLICY-IS-VOIDED)
 16579        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16580        CONTINUE
 16581     ELSE
 16582        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16583            OR
 16584           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16585           AND
 16586           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16587           OR
 16588           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16589           IF WS-PREM-REJECT-SW = SPACE
 16590              MOVE ER-3052       TO WS-ERROR
 16591              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16592           ELSE
 16593              MOVE ER-3050       TO WS-ERROR
 16594              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16595           END-IF
 16596        END-IF
 16597     END-IF
 16598                                                                  ELC50PD
 16599     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16600         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16601             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16602             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16603                                                                  ELC50PD
 16604     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16605        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16606           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16607              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16608                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16609                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16610                 NEXT SENTENCE                                    ELC50PD
 16611              ELSE                                                ELC50PD
 16612                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16613                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16614                                                                  ELC50PD
 16615     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16616        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16617           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16618                                                                  ELC50PD
 16619     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16620        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16621           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
 16622           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16623                                                                  ELC50PD
 16624 3345-EDIT-CONTINUE.                                              ELC50PD
 16625                                                                  ELC50PD
 16626*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16627*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16628*          IF PB-ISSUE                                            ELC50PD
 16629*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16630*          ELSE                                                   ELC50PD
 16631*              IF PB-CANCELLATION                                 ELC50PD
 16632*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16633                                                                  ELC50PD
 16634*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16635*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16636*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16637*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16638*        ELSE                                                     ELC50PD
 16639*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16640*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16641                                                                  ELC50PD
 16642     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16643        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16644           PB-REISSUED-CERT  OR                                   ELC50PD
 16645           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16646           PB-POLICY-IS-VOIDED                                    ELC50PD
 16647            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16648            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16649        ELSE                                                      ELC50PD
 16650            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16651            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16652                                                                  ELC50PD
 16653     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16654        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16655           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16656           PB-POLICY-IS-VOIDED                                    ELC50PD
 16657            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16658            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16659        ELSE                                                      ELC50PD
 16660            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16661                                      PB-I-ENTRY-STATUS.          ELC50PD
 16662                                                                  ELC50PD
 16663     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16664        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16665           PB-REISSUED-CERT  OR                                   ELC50PD
 16666           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16667           PB-POLICY-IS-VOIDED                                    ELC50PD
 16668            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16669            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16670        ELSE                                                      ELC50PD
 16671            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16672                                      PB-I-ENTRY-STATUS.          ELC50PD
 16673                                                                  ELC50PD
 16674     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16675        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16676        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16677
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16678     IF PB-COMPANY-ID = 'DCC'
 16679        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 16680        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16681        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16682           AND (NOT WS-LF-CASH))
 16683                           OR
 16684           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16685           AND (NOT WS-AH-CASH)))
 16686                       AND
 16687           (PB-I-ENTRY-STATUS NOT = '5')
 16688           MOVE 'M'              TO PB-BATCH-ENTRY
 16689                                    PB-I-ENTRY-STATUS
 16690        END-IF
 16691     END-IF
 16692
 16693     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16694         GO TO 3999-END-EDIT.                                     ELC50PD
 16695                                                                  ELC50PD
 16696     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16697        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16698        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16699        PB-I-OB                                                   ELC50PD
 16700         GO TO 3999-END-EDIT.                                     ELC50PD
 16701                                                                  ELC50PD
 16702     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16703         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16704         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16705         GO TO 3999-END-EDIT.                                     ELC50PD
 16706                                                                  ELC50PD
 16707     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16708     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16709                                                                  ELC50PD
 16710     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16711         GO TO 3999-END-EDIT.                                     ELC50PD
 16712                                                                  ELC50PD
 16713     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16714                                      FORM-MASTER-AH-SW.          ELC50PD
 16715                                                                  ELC50PD
 16716     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16717         MOVE  +1                 TO SUB6                         ELC50PD
 16718         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16719                                                                  ELC50PD
 16720     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16721         MOVE  +1                 TO SUB6                         ELC50PD
 16722         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16723                                                                  ELC50PD
 16724     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16725        AH-FORM-MASTER-FOUND                                      ELC50PD
 16726         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16727     ELSE                                                         ELC50PD
 16728         GO TO 3999-END-EDIT.                                     ELC50PD
 16729                                                                  ELC50PD
 16730******************************************************************ELC50PD
 16731*                  3350-GET-ERFORM                               *ELC50PD
 16732*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16733*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16734******************************************************************ELC50PD
 16735                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16736 3350-GET-ERFORM.                                                 ELC50PD
 16737                                                                  ELC50PD
 16738     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16739         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16740                                                                  ELC50PD
 16741     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16742     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16743     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16744     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16745                                                                  ELC50PD
 16746     IF PB-CANCELLATION                                           ELC50PD
 16747         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16748            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16749            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16750              GO TO 3350-EXIT                                     ELC50PD
 16751         ELSE                                                     ELC50PD
 16752             NEXT SENTENCE                                        ELC50PD
 16753     ELSE                                                         ELC50PD
 16754         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16755            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16756            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16757              GO TO 3350-EXIT.                                    ELC50PD
 16758                                                                  ELC50PD
 16759 3350-ERFORM-GETMAIN.                                             ELC50PD
 16760                                                                  ELC50PD
 16761     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16762     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16763                                                                  ELC50PD
 16764 3350-ERFORM-READ.                                                ELC50PD
 16765                                                                  ELC50PD
 16766     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16767     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16768     IF PB-CANCELLATION                                           ELC50PD
 16769         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16770     ELSE                                                         ELC50PD
 16771         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16772     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16773                                                                  ELC50PD
 16774     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16775                                                                  ELC50PD
 16776     IF FORM-MASTER-FOUND                                         ELC50PD
 16777       IF PB-CANCELLATION                                         ELC50PD
 16778          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16779             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16780             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16781              GO  TO 3350-EXIT                                    ELC50PD
 16782          ELSE                                                    ELC50PD
 16783              NEXT SENTENCE                                       ELC50PD
 16784       ELSE                                                       ELC50PD
 16785          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16786             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16787             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16788              GO  TO 3350-EXIT.                                   ELC50PD
 16789                                                                  ELC50PD
 16790     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16791     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16792     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16793                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16794 3350-EXIT.                                                       ELC50PD
 16795      EXIT.                                                       ELC50PD
 16796                                                                  ELC50PD
 16797******************************************************************ELC50PD
 16798*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16799*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16800*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16801******************************************************************ELC50PD
 16802                                                                  ELC50PD
 16803 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16804                                                                  ELC50PD
 16805     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
 16806        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16807         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16808         GO TO   3355-EXIT.                                       ELC50PD
 16809                                                                  ELC50PD
 16810     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16811         ADD  +1      TO  SUB6                                    ELC50PD
 16812         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16813                                                                  ELC50PD
 16814     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16815     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16816                                                                  ELC50PD
 16817 3355-EXIT.                                                       ELC50PD
 16818      EXIT.                                                       ELC50PD
 16819                                                                  ELC50PD
 16820******************************************************************ELC50PD
 16821*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16822*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16823*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16824******************************************************************ELC50PD
 16825                                                                  ELC50PD
 16826 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16827                                                                  ELC50PD
 16828     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16829        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16830         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16831         GO TO  3356-EXIT.                                        ELC50PD
 16832                                                                  ELC50PD
 16833      IF  SUB6    LESS THAN     +40                               ELC50PD
 16834          ADD  +1      TO  SUB6                                   ELC50PD
 16835          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16836                                                                  ELC50PD
 16837     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16838     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16839                                                                  ELC50PD
 16840 3356-EXIT.                                                       ELC50PD
 16841      EXIT.                                                       ELC50PD
 16842                                                                  ELC50PD
 16843******************************************************************ELC50PD
 16844*                  3357-BENEFIT-SEARCH                           *ELC50PD
 16845*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 16846*   CANCELLATIONS ONLY.                                          *ELC50PD
 16847******************************************************************ELC50PD
 16848 3357-BENEFIT-SEARCH.                                             ELC50PD
 16849     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16850         MOVE +1                          TO SUB6                 ELC50PD
 16851         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16852                                                                  ELC50PD
 16853     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16854         MOVE +1                          TO SUB6                 ELC50PD
 16855         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 16856                                                                  ELC50PD
 16857 3357-EXIT.                                                       ELC50PD
 16858     EXIT.                                                        ELC50PD
 16859                                                                  ELC50PD
 16860******************************************************************ELC50PD
 16861*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 16862*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16863*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 16864*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16865******************************************************************ELC50PD
 16866 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 16867     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 16868       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 16869         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16870           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16871              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16872                     IS GREATER THAN SPACES                       ELC50PD
 16873                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16874                                          WS-LF-REFUND-CALC       ELC50PD
 16875                 GO TO 3358-EXIT.                                 ELC50PD
 16876                                                                  ELC50PD
 16877     IF SUB6 LESS THAN +40                                        ELC50PD
 16878         ADD +1                 TO SUB6                           ELC50PD
 16879         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 16880                                                                  ELC50PD
 16881 3358-EXIT.                                                       ELC50PD
 16882     EXIT.                                                        ELC50PD
 16883******************************************************************ELC50PD
 16884*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 16885*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16886*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 16887*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16888******************************************************************ELC50PD
 16889 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 16890     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 16891       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 16892         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16893           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16894              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16895                      IS GREATER THAN SPACES                      ELC50PD
 16896                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16897                                          WS-AH-REFUND-CALC       ELC50PD
 16898                 GO TO 3359-EXIT.                                 ELC50PD
 16899                                                                  ELC50PD
 16900     IF SUB6 LESS THAN +40                                        ELC50PD
 16901         ADD +1                 TO SUB6                           ELC50PD
 16902         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 16903                                                                  ELC50PD
 16904 3359-EXIT.                                                       ELC50PD
 16905     EXIT.                                                        ELC50PD
 16906                                                                  ELC50PD
 16907******************************************************************ELC50PD
 16908*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 16909*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16910*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 16911******************************************************************ELC50PD
 16912                                                                  ELC50PD
 16913 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 16914                                                                  ELC50PD
 16915     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 16916         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 16917                                                                  ELC50PD
 16918     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 16919         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 16920                                                                  ELC50PD
 16921 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
 16922                                                                  ELC50PD
 16923     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 16924       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 16925        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 16926        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 16927         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 16928            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 16929            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16930         ELSE                                                     ELC50PD
 16931            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 16932            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 16933                                                                  ELC50PD
 16934 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 16935                                                                  ELC50PD
 16936     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 16937                                                                  ELC50PD
 16938     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 16939         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 16940         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 16941            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 16942                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 16943                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 16944            ELSE                                                  ELC50PD
 16945                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 16946                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 16947                                                                  ELC50PD
 16948 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 16949                                                                  ELC50PD
 16950     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 16951         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 16952         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 16953            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 16954                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 16955                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 16956            ELSE                                                  ELC50PD
 16957                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 16958                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 16959                                                                  ELC50PD
 16960 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 16961                                                                  ELC50PD
 16962     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 16963         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 16964         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 16965           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 16966               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 16967               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16968           ELSE                                                   ELC50PD
 16969               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
 16970               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 16971                                                                  ELC50PD
 16972     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 16973                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 16974                                                                  ELC50PD
 16975     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 16976         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 16977         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 16978             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 16979                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
 16980                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 16981             ELSE                                                 ELC50PD
 16982                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 16983                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 16984                                                                  ELC50PD
 16985******************************************************************ELC50PD
 16986*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 16987*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 16988*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 16989******************************************************************ELC50PD
 16990                                                                  ELC50PD
 16991 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 16992                                                                  ELC50PD
 16993     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 16994         GO TO 3999-END-EDIT.                                     ELC50PD
 16995                                                                  ELC50PD
 16996 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 16997                                                                  ELC50PD
 16998     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 16999       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17000        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17001        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17002         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17003            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17004            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17005         ELSE                                                     ELC50PD
 17006            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17007            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17008                                                                  ELC50PD
 17009 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17010                                                                  ELC50PD
 17011     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17012                                                                  ELC50PD
 17013     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17014         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17015         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17016            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17017                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17018                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17019            ELSE                                                  ELC50PD
 17020                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17021                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17022                                                                  ELC50PD
 17023 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17024                                                                  ELC50PD
 17025     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17026         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17027         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
 17028            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17029                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17030                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17031            ELSE                                                  ELC50PD
 17032                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17033                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17034                                                                  ELC50PD
 17035 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17036                                                                  ELC50PD
 17037     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
 17038         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17039         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17040             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17041                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17042                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17043             ELSE                                                 ELC50PD
 17044                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17045                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17046                                                                  ELC50PD
 17047     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17048         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17049         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17050             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17051                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17052                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17053             ELSE                                                 ELC50PD
 17054                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17055                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17056                                                                  ELC50PD
 17057     GO TO 3999-END-EDIT.                                         ELC50PD
 17058                                                                  ELC50PD
 17059******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17061******************************************************************ELC50PD
 17062*                  E D I T   C A N C E L                         *ELC50PD
 17063******************************************************************ELC50PD
 17064                                                                  ELC50PD
 17065 3700-EDIT-CANCEL.                                                ELC50PD
 17066     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17067         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17068                                         WS-RES-MUNI-TAX          ELC50PD
 17069                                         PB-CI-STATE-TAX          ELC50PD
 17070                                         PB-CI-MUNI-TAX           ELC50PD
 17071         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17072                                                                  ELC50PD
 17073*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17074*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17075*          IF PB-CANCELLATION                                     ELC50PD
 17076*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17077*          ELSE                                                   ELC50PD
 17078*             IF PB-ISSUE                                         ELC50PD
 17079*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17080                                                                  ELC50PD
 17081     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17082        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17083     END-IF
 17084
 17085*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17086*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17087                                                                  ELC50PD
 17088     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17089        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17091        GO TO 3999-END-EDIT.                                      ELC50PD
 17092                                                                  ELC50PD
 17093     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17094        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17096        GO TO 3999-END-EDIT.                                      ELC50PD
 17097                                                                  ELC50PD
 17098     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17099        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17101                                                                  ELC50PD
 17102***************************************************************   ELC50PD
 17103*                                                             *   ELC50PD
 17104*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17105*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17106*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17107*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17108*                                                             *   ELC50PD
 17109***************************************************************   ELC50PD
 17110                                                                  ELC50PD
 17111     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17112                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17113                                                                  ELC50PD
 17114     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17115        NEXT SENTENCE                                             ELC50PD
 17116     ELSE                                                         ELC50PD
 17117        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17118           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17119           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17120               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17121               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17122               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17123                                                                  ELC50PD
 17124     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17125        NEXT SENTENCE                                             ELC50PD
 17126     ELSE                                                         ELC50PD
 17127        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17128           AND                                                    ELC50PD
 17129           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17130               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17131               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17132               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17133                                                                  ELC50PD
 17134     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17135        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17136                                                                  ELC50PD
 17137     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17138     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17139     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17140     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17141     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17142     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17143                                                                  ELC50PD
 17144     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17145                                      PB-C-AH-REF-CALC.           ELC50PD
 17146     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17147                                                                  ELC50PD
 17148******************************************************************ELC50PD
 17149*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17150*             TO VALIDATE COVERAGE.                              *ELC50PD
 17151******************************************************************ELC50PD
 17152                                                                  ELC50PD
 17153     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17154        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17155          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17156      ELSE                                                        ELC50PD
 17157          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17158                                                                  ELC50PD
 17159     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17160        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17161          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17162      ELSE                                                        ELC50PD
 17163          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17164                                                                  ELC50PD
 17165     EVALUATE TRUE                                                ELC50PD
 17166         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17167              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17168              PB-FORCE-OFF                                        ELC50PD
 17169                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17170                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17171                  END-IF                                          ELC50PD
 17172         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17173               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17174              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17175                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17176         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17177              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17178                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17179              ELSE                                                ELC50PD
 17180                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17181              END-IF                                              ELC50PD
 17182              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17183     END-EVALUATE.                                                ELC50PD
 17184                                                                  ELC50PD
 17185                                                                  ELC50PD
 17186*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17187*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17188*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17189*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17190*        ELSE                                                     ELC50PD
 17191*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17192                                                                  ELC50PD
 17193     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17194     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17195        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17196     ELSE
 17197        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17198     END-IF
 17199     .
 17200 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17201                                                                  ELC50PD
 17202     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17203        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17204         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17205         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17206                                 TO DC-BIN-DATE-2                 ELC50PD
 17207         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17208*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17209         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17210         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17211            NEXT SENTENCE                                         ELC50PD
 17212          ELSE                                                    ELC50PD
 17213             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17214                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17215                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17216                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17217                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17218                 ELSE                                             ELC50PD
 17219                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17220                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17221                                                                  ELC50PD
 17222     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17223        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17224         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17225         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17226                                 TO DC-BIN-DATE-2                 ELC50PD
 17227         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17228*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17229         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17230         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17231            NEXT SENTENCE                                         ELC50PD
 17232          ELSE                                                    ELC50PD
 17233             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17234                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17235                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17236                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17237                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17238                 ELSE                                             ELC50PD
 17239                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17240                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17241                                                                  ELC50PD
 17242     IF WS-ERROR = ER-2752                                        ELC50PD
 17243        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17244         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17245         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17246         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17247         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17248         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17249         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17250         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17251         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17252         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17253         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17254         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17255         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17256         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17257         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17258            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17259            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17260            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17261                                                                  ELC50PD
 17262     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17263        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17264        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17265             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17266             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17267                                                                  ELC50PD
 17268     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17269        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17270        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17271              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17272              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17273                                                                  ELC50PD
 17274     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17275        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17276        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17277           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17278            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17279              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17280               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17281               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17282                                                                  ELC50PD
 17283     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17284         GO TO 3999-END-EDIT.                                     ELC50PD
 17285                                                                  ELC50PD
 17286     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17287        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17288           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17289            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17290            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17291                                 TO DC-BIN-DATE-2                 ELC50PD
 17292            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17293*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17294            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17295            IF DATE-CONVERSION-ERROR                              ELC50PD
 17296               NEXT SENTENCE                                      ELC50PD
 17297             ELSE                                                 ELC50PD
 17298                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17299                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17300                                                                  ELC50PD
 17301     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17302        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17303           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17304            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17305            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17306                                 TO DC-BIN-DATE-2                 ELC50PD
 17307            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17308                                    DC-ELAPSED-MONTHS             ELC50PD
 17309            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17310*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17311            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17312            IF DATE-CONVERSION-ERROR                              ELC50PD
 17313               NEXT SENTENCE                                      ELC50PD
 17314             ELSE                                                 ELC50PD
 17315                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17316                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17317                                                                  ELC50PD
 17318     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17319                                    DC-ELAPSED-MONTHS.            ELC50PD
 17320                                                                  ELC50PD
 17321     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17322        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17323          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17324          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17325          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17326          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17327          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17328          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17329        ELSE                                                      ELC50PD
 17330          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17331                                     PB-C-LIVES                   ELC50PD
 17332          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17333             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17334                                                                  ELC50PD
 17335     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17336         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17337     ELSE                                                         ELC50PD
 17338         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17339                                                                  ELC50PD
 17340     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17341        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17342            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17343            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17344                                                                  ELC50PD
 17345     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17346        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17347         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17348            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17349               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17350               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17351                                                                  ELC50PD
 17352     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17353        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17354         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17355            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17356               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17357               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17358                                                                  ELC50PD
 17359     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17360        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17361         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17362            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17363            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17364                                                                  ELC50PD
 17365     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17366        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17367         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17368            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17369            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17370                                                                  ELC50PD
 17371     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17372        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17373         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17374         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17375         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17376*        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17377         SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17378         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17379         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17380            NEXT SENTENCE                                         ELC50PD
 17381          ELSE                                                    ELC50PD
 17382            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17383              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17384                             OR  'FIA'                            ELC50PD
 17385                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17386               ELSE                                               ELC50PD
 17387                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17388                MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17389                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17390                                                                  ELC50PD
 17391 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17392                                                                  ELC50PD
 17393     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17394        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17395         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17396         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17397         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17398*        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17399         SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17400         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17401         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17402            NEXT SENTENCE                                         ELC50PD
 17403          ELSE                                                    ELC50PD
 17404            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17405              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17406                              OR 'FIA'                            ELC50PD
 17407                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
 17408              ELSE                                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17409               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17410               MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17411               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17412                                                                  ELC50PD
 17413 3705-EDIT-CONTINUED.                                             ELC50PD
 17414                                                                  ELC50PD
 17415*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17416*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17417*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17418*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17419*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17420*                                                                 ELC50PD
 17421*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17422*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17423*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17424*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17425*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17426*        ELSE                                                     ELC50PD
 17427*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17428*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17429*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17430                                                                  ELC50PD
 17431     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17432       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17433         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17434           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17435              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17436              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17437                                                                  ELC50PD
 17438     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17439        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17440            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17441            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17442            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17443                                                                  ELC50PD
 17444     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17445            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17446            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17447                                                                  ELC50PD
 17448     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17449         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17450            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17451            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17452                                                                  ELC50PD
 17453 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17454                                                                  ELC50PD
 17455     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17456         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17457             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17458                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17459                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17460                                                                  ELC50PD
 17461     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17462         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17463             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17464                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17465                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17466                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17467 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17468                                                                  ELC50PD
 17469*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17470*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17471*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17472*           (NOT PB-CI-OB)                                        ELC50PD
 17473*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17474*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17475*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17476*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17477*                                                                 ELC50PD
 17478*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17479*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17480*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17481*           (NOT PB-CI-OB)                                        ELC50PD
 17482*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17483*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17484*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17485*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17486                                                                  ELC50PD
 17487     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17488         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17489            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17490             NEXT SENTENCE                                        ELC50PD
 17491         ELSE                                                     ELC50PD
 17492           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17493              NEXT SENTENCE                                       ELC50PD
 17494           ELSE                                                   ELC50PD
 17495              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17496              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17497                                                                  ELC50PD
 17498     IF CANCEL-FUTURE-DT                                          ELC50PD
 17499         GO TO 3999-END-EDIT.                                     ELC50PD
 17500                                                                  ELC50PD
 17501 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17502                                                                  ELC50PD
 17503     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17504        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17505        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17506                                                                  ELC50PD
 17507     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17508     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17509     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17510     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17511     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17512     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17513     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17514     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17515     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17516     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17517     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17518     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17519
 17520     IF (PB-COMPANY-ID = 'CID')
 17521        AND (CP-STATE-STD-ABBRV = 'WI')
 17522        MOVE '7'                 TO CP-REM-TERM-METHOD
 17523        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17524     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17525        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17526        MOVE WS-REM-TRM-CALC-OPTION
 17527                                 TO CP-REM-TRM-CALC-OPTION
 17528     END-IF
 17529
 17530**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17531     IF (PB-COMPANY-ID = 'CID')
 17532        AND (CP-STATE-STD-ABBRV = 'MO')
 17533        AND (PB-CERT-EFF-DT >= X'9B41')
 17534        AND (PB-CERT-EFF-DT <= X'A2FB')
 17535        MOVE '7'                 TO CP-REM-TERM-METHOD
 17536        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17537     END-IF
 17538
 17539     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17540                                    CP-LOAN-TERM.                 ELC50PD
 17541     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17542        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17543                                                                  ELC50PD
 17544     IF CP-TERM-IS-DAYS                                           ELC50PD
 17545         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17546     ELSE                                                         ELC50PD
 17547         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17548                                                                  ELC50PD
 17549     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17550                                                                  ELC50PD
 17551     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17552                                                                  ELC50PD
 17553     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17554        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17555        NEXT SENTENCE                                             ELC50PD
 17556      ELSE                                                        ELC50PD
 17557          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17558                                                                  ELC50PD
 17559 3720-GET-LF-REFUND.                                              ELC50PD
 17560                                                                  ELC50PD
 17561     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17562        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17563        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17564                                                                  ELC50PD
 17565     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17566         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17567         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17568         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17569                                                                  ELC50PD
 17570     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17571        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17572         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17573         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17574         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17575         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17576         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17577                                                                  ELC50PD
 17578     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17579                                                                     CL**2
 17580     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17581     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17582     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17583     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17584     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17585     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17586
 17587     IF (PB-COMPANY-ID = 'DCC')
 17588        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17589
 17590        IF PDEF-MASTER-FOUND
 17591           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17592              (V1 > +8)
 17593              OR (PD-PROD-CODE (V1) = 'L')
 17594           END-PERFORM
 17595           IF V1 < +9
 17596              MOVE PD-MAX-AMT (V1)
 17597                           TO CP-R-MAX-TOT-BEN
 17598                              EC-AM-LF-MAX-TOT-BEN
 17599           END-IF
 17600        ELSE
 17601
 17602        MOVE ' '                 TO PDEF-MASTER-SW
 17603        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17604        MOVE PB-STATE            TO ERPDEF-STATE
 17605        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17606        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17607        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17608        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17609        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17610        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17611        IF PDEF-MASTER-FOUND
 17612           MOVE 'N'              TO PDEF-MASTER-SW
 17613           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17614           IF PDEF-MASTER-FOUND
 17615              IF (ERPDEF-KEY-SAVE (1:16) =
 17616                           PD-CONTROL-PRIMARY (1:16))
 17617                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17618                 CONTINUE
 17619              ELSE
 17620                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17621                 IF (ERPDEF-KEY-SAVE (1:16) =
 17622                           PD-CONTROL-PRIMARY (1:16))
 17623                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17624                    CONTINUE
 17625                 ELSE
 17626                    MOVE 'N'     TO PDEF-MASTER-SW
 17627                 END-IF
 17628              END-IF
 17629              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17630
 17631              IF PDEF-MASTER-FOUND
 17632                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17633                    (V1 > +8)
 17634                    OR (PD-PROD-CODE (V1) = 'L')
 17635                 END-PERFORM
 17636                 IF V1 < +9
 17637                    MOVE PD-MAX-AMT (V1)
 17638                                 TO CP-R-MAX-TOT-BEN
 17639                                    EC-AM-LF-MAX-TOT-BEN
 17640                 END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17641              END-IF
 17642           END-IF
 17643           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17644        END-IF
 17645        END-IF
 17646     END-IF
 17647
 17648     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17649                                                                  ELC50PD
 17650     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17651                                                                  ELC50PD
 17652     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17653                                    PB-C-LF-REM-TERM.                CL**2
 17654                                                                     CL**2
 17655     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17656     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17657                                                                  ELC50PD
 17658     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17659        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17660           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17661           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17662                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17663                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17664           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17665              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17666              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17667           ELSE                                                   ELC50PD
 17668              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17669                                                                  ELC50PD
 17670     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17671                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17672                            OR '9' OR 'G'
 17673        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17674                                 TO CP-EARNING-METHOD.            ELC50PD
 17675                                                                  ELC50PD
 17676     if pb-company-id = 'AHL'
 17677        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17678        if cp-class-code = spaces
 17679           move zeros            to cp-class-code
 17680        end-if
 17681     ELSE
 17682        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17683     END-IF
 17684
 17685*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17686     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17687     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17688                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17689     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17690         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17691                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17692     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17693     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
 17694     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17695     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17696     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17697     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17698     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17699     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17700         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17701                                                                  ELC50PD
 17702****   N O T E   ****
 17703*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17704*      THE OH HARD CODING IN ELCRFNDP
 17705
 17706     IF PB-COMPANY-ID = 'CID'
 17707        IF CP-STATE-STD-ABBRV = 'OH'
 17708           MOVE WS-LF-EARNINGS-CALC
 17709                                 TO CP-EARNING-METHOD
 17710        END-IF
 17711     END-IF
 17712
 17713****   N O T E   ****
 17714
 17715     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17716         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17717            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17718                MOVE WS-DEFAULT-APR                               ELC50PD
 17719                                 TO  CP-LOAN-APR                  ELC50PD
 17720                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17721                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17722            ELSE                                                  ELC50PD
 17723                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17724                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17725
 17726     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17727
 17728     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17729                                                                  ELC50PD
 17730     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17731         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17732                                                                  ELC50PD
 17733     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17734        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17735        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17737                                                                  ELC50PD
 17738     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17739        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17741                                                                  ELC50PD
 17742     IF PB-COMPANY-ID = 'DCC'
 17743        AND PB-CI-ENTRY-STATUS = 'M'
 17744        MOVE +0                  TO PB-C-LF-REF-CALC
 17745     ELSE
 17746        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17747     END-IF
 17748                                                                  ELC50PD
 17749     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17750         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17751                                                                  ELC50PD
 17752*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17753*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17754*                                   CP-REMAINING-TERM             ELC50PD
 17755*                                   CP-ORIGINAL-TERM.             ELC50PD
 17756                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17757     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17758     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17759                                    CP-RATING-METHOD.             ELC50PD
 17760
 17761     IF PB-COMPANY-ID = 'CID'
 17762        IF (CP-STATE-STD-ABBRV = 'MN')
 17763           AND (PB-CERT-EFF-DT > X'A4FF')
 17764           AND (WS-LF-EARNINGS-CALC = 'B')
 17765           MOVE '5'              TO CP-EARNING-METHOD
 17766           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17767        END-IF
 17768     END-IF
 17769
 17770     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17771                                        CP-REMAINING-BENEFIT      ELC50PD
 17772                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17773     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17774         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17775                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17776     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17777     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17778                                                                  ELC50PD
 17779     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17780                                                                  ELC50PD
 17781     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17782        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17783        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17784        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17785                                                                  ELC50PD
 17786     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17787        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17788        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17789                                                                  ELC50PD
 17790     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 17791                                                                  ELC50PD
 17792******************************************************************ELC50PD
 17793                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17795 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 17796     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 17797        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 17798         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17799                                                                  ELC50PD
 17800     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 17801         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 17802            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 17803             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 17804                                                                  ELC50PD
 17805     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 17806     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17807     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17808     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17809     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17810     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17811     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 17812     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17813     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17814     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17815     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17816     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17817
 17818     IF (PB-COMPANY-ID = 'CID')
 17819        AND (CP-STATE-STD-ABBRV = 'WI')
 17820        MOVE '7'                 TO CP-REM-TERM-METHOD
 17821        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17822     ELSE
 17823        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17824        MOVE WS-REM-TRM-CALC-OPTION
 17825                                 TO CP-REM-TRM-CALC-OPTION
 17826     END-IF
 17827
 17828     IF (PB-COMPANY-ID = 'CID')
 17829        AND (CP-STATE-STD-ABBRV = 'MO')
 17830        AND (PB-CERT-EFF-DT >= X'9B41')
 17831        AND (PB-CERT-EFF-DT <= X'A2FB')
 17832        MOVE '7'                 TO CP-REM-TERM-METHOD
 17833        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17834     END-IF
 17835
 17836     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17837                                    CP-LOAN-TERM.                 ELC50PD
 17838     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 17839         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17840                                                                  ELC50PD
 17841     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 17842                                                                  ELC50PD
 17843     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17844                                                                  ELC50PD
 17845     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17846        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17847        NEXT SENTENCE                                             ELC50PD
 17848      ELSE                                                        ELC50PD
 17849         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17850                                                                  ELC50PD
 17851 3740-GET-AH-REFUND.                                              ELC50PD
 17852                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17853     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17854        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17855        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17856                                                                  ELC50PD
 17857     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 17858         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17859         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17860                                                                  ELC50PD
 17861     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 17862*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 17863     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 17864     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 17865     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 17866                                    PB-C-AH-REM-TERM.             ELC50PD
 17867     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17868     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17869                                                                  ELC50PD
 17870     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17871        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17872           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 17873           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 17874                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 17875           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 17876              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 17877              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 17878           ELSE                                                   ELC50PD
 17879              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 17880                                                                  ELC50PD
 17881     IF PB-COMPANY-ID = 'DCC'
 17882        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17883            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 17884           MOVE 'S'              TO CP-EARNING-METHOD
 17885        END-IF
 17886     END-IF
 17887
 17888     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17889                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17890                            OR '9' OR 'G' OR 'S'
 17891        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 17892                                 TO CP-EARNING-METHOD.            ELC50PD
 17893                                                                  ELC50PD
 17894     if pb-company-id = 'AHL'
 17895        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 17896        if cp-class-code = spaces
 17897           move zeros            to cp-class-code
 17898        end-if
 17899     ELSE
 17900        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17901     END-IF
 17902*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17903     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17904     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17905                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17906     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17907         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 17908                                         PB-CI-AH-TERM.           ELC50PD
 17909     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17910     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17911     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17912     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 17913     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 17914     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17915                                                                  ELC50PD
 17916     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 17917        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 17918                                AND 'CID' AND 'DCC' AND 'AHL')
 17919           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 17920              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 17921              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 17922              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 17923           END-IF
 17924        END-IF
 17925        IF PB-COMPANY-ID = 'CID'
 17926           IF NO-LIFE-COVERAGE
 17927              IF CP-CRITICAL-PERIOD
 17928                 MOVE '2'       TO CP-EARNING-METHOD
 17929              ELSE
 17930                 MOVE '6'       TO CP-EARNING-METHOD
 17931              END-IF
 17932           ELSE
 17933              IF WS-LF-COVERAGE-TYPE = 'L'
 17934                 MOVE '2'       TO CP-EARNING-METHOD
 17935              ELSE
 17936                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 17937                    (WS-LF-EARNINGS-CALC = '5')
 17938                    IF CP-CRITICAL-PERIOD
 17939                       MOVE '2'  TO CP-EARNING-METHOD
 17940                    ELSE
 17941                       MOVE '6'  TO CP-EARNING-METHOD
 17942                    END-IF
 17943                 ELSE
 17944                    MOVE '1'     TO CP-EARNING-METHOD
 17945                 END-IF
 17946              END-IF
 17947           END-IF
 17948        END-IF
 17949     END-IF
 17950                                                                  ELC50PD
 17951*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 17952*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 17953*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 17954*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 17955*          ELSE                                                   ELC50PD
 17956*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 17957                                                                  ELC50PD
 17958     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17959         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17960                                                                  ELC50PD
 17961     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17962         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17963            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17964                MOVE WS-DEFAULT-APR                               ELC50PD
 17965                                 TO  CP-LOAN-APR                  ELC50PD
 17966                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17967                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17968            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17969                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17970                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17971
 17972     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17973
 17974
 17975     IF PB-COMPANY-ID = 'DCC'
 17976        AND CP-CANCEL-REASON = 'R'
 17977        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17978        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17979     END-IF
 17980
 17981     IF PB-COMPANY-ID = 'DCC'
 17982        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17983        AND (CP-EARNING-METHOD = 'D')
 17984        AND (CP-CANCEL-REASON NOT = 'R')
 17985        CONTINUE
 17986     ELSE
 17987        GO TO 3750-CONTINUE
 17988     END-IF
 17989
 17990     MOVE ' '                    TO DD-IU-SW
 17991     IF NOT PDEF-MASTER-FOUND
 17992        MOVE ' '                 TO PDEF-MASTER-SW
 17993        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17994        MOVE PB-STATE            TO ERPDEF-STATE
 17995        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17996        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17997        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17998        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17999        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18000        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18001        IF PDEF-MASTER-FOUND
 18002           MOVE 'N'              TO PDEF-MASTER-SW
 18003           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18004           IF PDEF-MASTER-FOUND
 18005              IF (ERPDEF-KEY-SAVE (1:16) =
 18006                           PD-CONTROL-PRIMARY (1:16))
 18007                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18008                 CONTINUE
 18009              ELSE
 18010                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18011                 IF (ERPDEF-KEY-SAVE (1:16) =
 18012                           PD-CONTROL-PRIMARY (1:16))
 18013                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18014                    CONTINUE
 18015                 ELSE
 18016                    MOVE ER-2740 TO WS-ERROR
 18017                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18018                    GO TO 3770-CHECK-REFUNDS
 18019                 END-IF
 18020              END-IF
 18021           END-IF
 18022           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18023        END-IF
 18024     END-IF
 18025
 18026     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18027        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18028           (V1 > +8)
 18029           OR (PD-PROD-CODE (V1) = 'I')
 18030        END-PERFORM
 18031        IF V1 < +9
 18032           SET DD-IU-PRESENT        TO TRUE
 18033        END-IF
 18034        IF WS-AH-DCC-TRUNC = 'T'
 18035           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18036        ELSE
 18037           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18038        END-IF
 18039        EVALUATE TRUE
 18040           WHEN WS-TERM > +168
 18041              MOVE 15               TO V1
 18042           WHEN WS-TERM > +156
 18043              MOVE 14               TO V1
 18044           WHEN WS-TERM > +144
 18045              MOVE 13               TO V1
 18046           WHEN WS-TERM > +132
 18047              MOVE 12               TO V1
 18048           WHEN WS-TERM > +120
 18049              MOVE 11               TO V1
 18050           WHEN WS-TERM > +108
 18051              MOVE 10               TO V1
 18052           WHEN WS-TERM > +96
 18053              MOVE 9                TO V1
 18054           WHEN WS-TERM > +84
 18055              MOVE 8                TO V1
 18056           WHEN WS-TERM > +72
 18057              MOVE 7                TO V1
 18058           WHEN WS-TERM > +60
 18059              MOVE 6                TO V1
 18060           WHEN WS-TERM > +48
 18061              MOVE 5                TO V1
 18062           WHEN WS-TERM > +36
 18063              MOVE 4                TO V1
 18064           WHEN WS-TERM > +24
 18065              MOVE 3                TO V1
 18066           WHEN WS-TERM > +12
 18067              MOVE 2                TO V1
 18068           WHEN OTHER
 18069              MOVE 1                TO V1
 18070        END-EVALUATE
 18071
 18072        EVALUATE TRUE
 18073*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18074*             < +13)
 18075*             AND (DD-IU-PRESENT)
 18076*             MOVE 2                TO V2
 18077*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18078*             MOVE 1                TO V2
 18079           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18080              MOVE 2                TO V2
 18081           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18082              MOVE 3                TO V2
 18083           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18084              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18085           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18086              MOVE 5                TO V2
 18087           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18088              MOVE 6                TO V2
 18089           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18090              MOVE 7                TO V2
 18091           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18092              MOVE 8                TO V2
 18093           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18094              MOVE 9                TO V2
 18095           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18096              MOVE 10               TO V2
 18097           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18098              MOVE 11               TO V2
 18099           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18100              MOVE 12               TO V2
 18101           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18102              MOVE 13               TO V2
 18103           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18104              MOVE 14               TO V2
 18105           WHEN OTHER
 18106              MOVE 15               TO V2
 18107        END-EVALUATE
 18108
 18109        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18110                                 TO CP-DDF-LO-FACT
 18111        MOVE PD-UEP-FACTOR (V1 V2)
 18112                                 TO CP-DDF-HI-FACT
 18113
 18114        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18115        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18116
 18117        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18118           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18119        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18120        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18121
 18122        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18123           + PD-1ST-YR-ADMIN-ALLOW
 18124
 18125        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18126*       IF PI-CLP-YN = 'Y'
 18127*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18128*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18129*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18130*       END-IF
 18131
 18132        IF DD-IU-PRESENT
 18133           MOVE 'I'              TO CP-EARNING-METHOD
 18134        END-IF
 18135        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18136                                     CP-CLP-RATE-UP
 18137        IF CP-IU-RATE-UP NOT = ZEROS
 18138           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18139              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18140           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18141              / (1 - WS-WORK-FACT)
 18142        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18143     END-IF
 18144
 18145     .
 18146 3750-CONTINUE.
 18147
 18148     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18149                                                                  ELC50PD
 18150     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18151         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18152                                                                  ELC50PD
 18153     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18154        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18155        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18157                                                                  ELC50PD
 18158     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18159        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18160        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18161
 18162     IF PB-COMPANY-ID = 'DCC'
 18163        AND PB-CI-ENTRY-STATUS = 'M'
 18164        MOVE +0                  TO PB-C-AH-REF-CALC
 18165     ELSE
 18166        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18167     END-IF
 18168
 18169     IF PB-COMPANY-ID = 'DCC'
 18170        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18171        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18172        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18173        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18174        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18175        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18176        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18177        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18178        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18179     END-IF
 18180
 18181     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18183                                                                  ELC50PD
 18184 3770-CHECK-REFUNDS.                                              ELC50PD
 18185                                                                  ELC50PD
 18186     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18187        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18188           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18189           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18190           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18191           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18192              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18193                                                                  ELC50PD
 18194     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18195        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18196           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18197           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18198           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18199           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18200              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18201                                                                  ELC50PD
 18202     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18203        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18204        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18205           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18206              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18207                                                                  ELC50PD
 18208     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18209        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18210        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18211           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18212              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18213                                                                  ELC50PD
 18214     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18215             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18216     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18217             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18218                                                                  ELC50PD
 18219     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18220         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18221                                                                  ELC50PD
 18222     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18223         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18224                                                                  ELC50PD
 18225     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18226                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18228                                                                  ELC50PD
 18229 3772-CONTINUE.                                                   ELC50PD
 18230                                                                  ELC50PD
 18231**********************************                                ELC50PD
 18232*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18233*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18234*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18235***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18236**********************************                                ELC50PD
 18237     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18238     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18239         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18240             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18241             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18242           ELSE                                                   ELC50PD
 18243             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18244             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18245**********************************                                ELC50PD
 18246                                                                  ELC50PD
 18247 3773-CONTINUE.                                                   ELC50PD
 18248                                                                  ELC50PD
 18249     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18250        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18251           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18252           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18253                                                                  ELC50PD
 18254     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18255        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18256           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18257           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18258                                                                  ELC50PD
 18259     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18260         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18261             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18262     ELSE                                                         ELC50PD
 18263         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18264                                                                  ELC50PD
 18265     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18266         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18267             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18268     ELSE                                                         ELC50PD
 18269         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18270                                                                  ELC50PD
 18271     IF (PB-COMPANY-ID = 'DCC')
 18272        AND (PB-CI-ENTRY-STATUS = 'M')
 18273        AND (PB-C-LF-CANCEL-AMT > +0)
 18274        MOVE ER-3843             TO WS-ERROR
 18275        PERFORM 9900-ERROR-FORMAT
 18276                                 THRU 9900-EXIT
 18277     END-IF
 18278     EVALUATE TRUE                                                ELC50PD
 18279        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18280           CONTINUE                                               ELC50PD
 18281        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18282                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18283           CONTINUE                                               ELC50PD
 18284        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18285                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18286           CONTINUE                                               ELC50PD
 18287        WHEN OTHER                                                ELC50PD
 18288           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18289              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18290           END-IF                                                 ELC50PD
 18291           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18292                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18293                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18294              CONTINUE                                            ELC50PD
 18295           ELSE                                                   ELC50PD
 18296              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18297                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18298              END-IF                                              ELC50PD
 18299              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18300                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18301                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18302                 CONTINUE                                         ELC50PD
 18303              ELSE                                                ELC50PD
 18304                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18305                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18306                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18307                 ELSE                                             ELC50PD
 18308                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18309                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18310                 END-IF                                           ELC50PD
 18311              END-IF                                              ELC50PD
 18312           END-IF                                                 ELC50PD
 18313     END-EVALUATE.                                                ELC50PD
 18314                                                                  ELC50PD
 18315     EVALUATE TRUE                                                ELC50PD
 18316        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18317           CONTINUE                                               ELC50PD
 18318        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18319                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18320           CONTINUE                                               ELC50PD
 18321        WHEN OTHER                                                ELC50PD
 18322           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18323               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18324              CONTINUE                                            ELC50PD
 18325           ELSE                                                   ELC50PD
 18326              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18327               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18328                CONTINUE                                          ELC50PD
 18329              ELSE                                                ELC50PD
 18330                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18331                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18332                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18333                 ELSE                                             ELC50PD
 18334                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18335                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18336                 END-IF                                           ELC50PD
 18337              END-IF                                              ELC50PD
 18338           END-IF                                                 ELC50PD
 18339     END-EVALUATE.                                                ELC50PD
 18340                                                                  ELC50PD
 18341     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18342         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18343             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18344     ELSE                                                         ELC50PD
 18345         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18346                                                                  ELC50PD
 18347     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18348         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18349             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18350     ELSE                                                         ELC50PD
 18351         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18352                                                                  ELC50PD
 18353     IF (PB-COMPANY-ID = 'DCC')
 18354        AND (PB-CI-ENTRY-STATUS = 'M')
 18355        AND (PB-C-AH-CANCEL-AMT > +0)
 18356        MOVE ER-3843             TO WS-ERROR
 18357        PERFORM 9900-ERROR-FORMAT
 18358                                 THRU 9900-EXIT
 18359     END-IF
 18360     EVALUATE TRUE                                                ELC50PD
 18361        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18362           CONTINUE                                               ELC50PD
 18363*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18364*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18365        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18366                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18367           CONTINUE                                               ELC50PD
 18368        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18369                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18370           CONTINUE                                               ELC50PD
 18371        WHEN OTHER                                                ELC50PD
 18372           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18373              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18374           END-IF                                                 ELC50PD
 18375           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18376               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18377                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18378              CONTINUE                                            ELC50PD
 18379           ELSE                                                   ELC50PD
 18380              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18381                 MOVE +9999999.99 TO                              ELC50PD
 18382                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18383              END-IF                                              ELC50PD
 18384              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18385                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18386                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18387                 CONTINUE                                         ELC50PD
 18388              ELSE                                                ELC50PD
 18389                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18390                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18391                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18392                 ELSE                                             ELC50PD
 18393                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18394                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18395                 END-IF                                           ELC50PD
 18396              END-IF                                              ELC50PD
 18397           END-IF                                                 ELC50PD
 18398     END-EVALUATE.                                                ELC50PD
 18399                                                                  ELC50PD
 18400     EVALUATE TRUE                                                ELC50PD
 18401        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18402           CONTINUE                                               ELC50PD
 18403*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18404*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18405        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18406                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18407           CONTINUE                                               ELC50PD
 18408        WHEN OTHER                                                ELC50PD
 18409           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18410               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18411              CONTINUE                                            ELC50PD
 18412           ELSE                                                   ELC50PD
 18413              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18414                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18415                 CONTINUE                                         ELC50PD
 18416              ELSE                                                ELC50PD
 18417                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18418                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18419                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18420                 ELSE                                             ELC50PD
 18421                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18422                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18423                 END-IF                                           ELC50PD
 18424              END-IF                                              ELC50PD
 18425           END-IF                                                 ELC50PD
 18426     END-EVALUATE.                                                ELC50PD
 18427                                                                  ELC50PD
 18428     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18429        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18430        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18431           AND  PB-C-LF-REF-CALC < +1.00
 18432           AND  PB-C-AH-REF-CALC < +1.00
 18433           CONTINUE
 18434        ELSE
 18435           IF (PB-COMPANY-ID = 'DCC')
 18436              AND (PB-CI-ENTRY-STATUS = 'M')
 18437              CONTINUE
 18438           ELSE
 18439              MOVE ER-2741       TO WS-ERROR
 18440              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18441           END-IF
 18442        END-IF
 18443     END-IF
 18444                                                                  ELC50PD
 18445     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18446        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18447        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18448        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18449        OR                                                        ELC50PD
 18450        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18451        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18452        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18453             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18454                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18455                NEXT SENTENCE                                     ELC50PD
 18456             ELSE                                                 ELC50PD
 18457                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18458                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18459                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18460     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18461        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18462        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18463        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18464        OR                                                        ELC50PD
 18465        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18466        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18467        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18468             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18469                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18470                NEXT SENTENCE                                     ELC50PD
 18471             ELSE                                                 ELC50PD
 18472                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18473                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18474                                                                  ELC50PD
 18475 3775-OVER-REF-CHK.                                               ELC50PD
 18476                                                                  ELC50PD
 18477     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18478        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18479                                                                  ELC50PD
 18480     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18481                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18482                                                                  ELC50PD
 18483     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18484        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18485                                 PB-C-LF-REF-CALC                 ELC50PD
 18486      ELSE                                                        ELC50PD
 18487        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18488                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18489                                                                  ELC50PD
 18490     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18491        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18493                                                                  ELC50PD
 18494     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18495                                                                  ELC50PD
 18496     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18497        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18498                                 PB-C-AH-REF-CALC                 ELC50PD
 18499      ELSE                                                        ELC50PD
 18500        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18501                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18502                                                                  ELC50PD
 18503     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18504        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18506                                                                  ELC50PD
 18507     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18508        NEXT SENTENCE                                             ELC50PD
 18509       ELSE                                                       ELC50PD
 18510         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18511            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18512            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18513                                                                  ELC50PD
 18514 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18515                                                                  ELC50PD
 18516     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18517        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18519                                                                  ELC50PD
 18520     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18521         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18523                                                                  ELC50PD
 18524     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18525         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18526                                                                  ELC50PD
 18527     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18528         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18529                                                                  ELC50PD
 18530     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18531       AND                                                        ELC50PD
 18532        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18533       AND                                                        ELC50PD
 18534        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18535       AND                                                        ELC50PD
 18536        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18537            NEXT SENTENCE                                         ELC50PD
 18538       ELSE                                                       ELC50PD
 18539        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18540          AND                                                     ELC50PD
 18541***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18542***       AND                                                     ELC50PD
 18543           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18544            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18545               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18546               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18547               GO TO 3999-END-EDIT                                ELC50PD
 18548            ELSE                                                  ELC50PD
 18549               GO TO 3999-END-EDIT                                ELC50PD
 18550        ELSE                                                      ELC50PD
 18551            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18552               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18553               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18554               GO TO 3785-CHECK-NH.
 18555*              GO TO 3999-END-EDIT.                               ELC50PD
 18556                                                                  ELC50PD
 18557 3780-UPDATE-CONT-1.                                              ELC50PD
 18558     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18559                                                                  ELC50PD
 18560     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18561         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18562                                                                  ELC50PD
 18563     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18564         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18565
 18566     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18567                                                                  ELC50PD
 18568     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18569       AND                                                        ELC50PD
 18570        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18571       AND                                                        ELC50PD
 18572        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18573       AND                                                        ELC50PD
 18574        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18575            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18576       ELSE                                                       ELC50PD
 18577        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18578          AND                                                     ELC50PD
 18579***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18580***       AND                                                     ELC50PD
 18581           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18582           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18583            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18584               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18585               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18586               GO TO 3999-END-EDIT                                ELC50PD
 18587            ELSE                                                  ELC50PD
 18588               GO TO 3999-END-EDIT                                ELC50PD
 18589            END-IF
 18590           ELSE
 18591             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18592                MOVE ER-2890 TO WS-ERROR
 18593                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18594                GO TO 3999-END-EDIT
 18595             ELSE
 18596                GO TO 3785-CHECK-NH
 18597             END-IF
 18598           END-IF
 18599          ELSE                                                    ELC50PD
 18600            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18601              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18602                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18603                   MOVE ER-2890 TO WS-ERROR
 18604                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18605                   GO TO 3999-END-EDIT
 18606                ELSE
 18607                   MOVE ER-2765 TO WS-ERROR
 18608                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18609                   GO TO 3785-CHECK-NH
 18610                END-IF
 18611              ELSE
 18612               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18613               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18614               GO TO 3785-CHECK-NH.
 18615*              GO TO 3999-END-EDIT.                               ELC50PD
 18616                                                                  ELC50PD
 18617 3780-UPDATE-CONT-2.                                              ELC50PD
 18618                                                                  ELC50PD
 18619     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18620        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18621           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18622           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18623                                                                  ELC50PD
 18624     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18625        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18626           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18627           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18628                                                                  ELC50PD
 18629     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18630        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18631        AND                                                       ELC50PD
 18632        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18633         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18634           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18635           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18636                                                                  ELC50PD
 18637     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18638       AND                                                        ELC50PD
 18639        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18640             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18641             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18642                                                                  ELC50PD
 18643     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18644       AND                                                        ELC50PD
 18645        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18646             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18647             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18648                                                                  ELC50PD
 18649     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18650         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18651             OR 'CID' OR 'DCC' OR 'AHL'
 18652             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18653         ELSE                                                     ELC50PD
 18654             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18655                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18656                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18657             ELSE                                                 ELC50PD
 18658                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18659                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18660                                                                  ELC50PD
 18661     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18662        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18664
 18665 3785-CHECK-NH.
 18666
 18667     IF PB-STATE NOT = 'NH'
 18668        GO TO 3999-END-EDIT
 18669     END-IF
 18670
 18671     MOVE ER-2796                TO WS-ERROR
 18672     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18673
 18674     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18675        OR (CM-NH-INTERFACE-SW = 'Y')
 18676        MOVE ER-2793             TO WS-ERROR
 18677        PERFORM 9900-ERROR-FORMAT
 18678                                 THRU 9900-EXIT
 18679     END-IF
 18680
 18681     MOVE +0                     TO WS-PAYMENT-AMT
 18682     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18683        GO TO 3999-END-EDIT
 18684     END-IF
 18685
 18686     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18687        GO TO 3999-END-EDIT
 18688     END-IF
 18689
 18690     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18691     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18692
 18693     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18694        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18695     END-IF
 18696     MOVE '1'                    TO DC-OPTION-CODE
 18697     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18698     IF NO-CONVERSION-ERROR
 18699        IF DC-ELAPSED-DAYS < +16
 18700           GO TO 3999-END-EDIT
 18701        END-IF
 18702     END-IF
 18703
 18704     MOVE +0                     TO DC-ELAPSED-DAYS
 18705     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18706     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18707     MOVE '1'                    TO DC-OPTION-CODE
 18708     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18709     IF NO-CONVERSION-ERROR
 18710        IF DC-ELAPSED-DAYS > +30
 18711           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18712        ELSE
 18713           GO TO 3999-END-EDIT
 18714        END-IF
 18715     ELSE
 18716        GO TO 3999-END-EDIT
 18717     END-IF
 18718
 18719     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18720        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18721           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18722
 18723     IF WS-PAYMENT-AMT < 600.00
 18724        GO TO 3999-END-EDIT
 18725     END-IF
 18726
 18727     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18728                                                                  ELC50PD
 18729     IF (ERMAIL-FOUND = ' ')
 18730         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18731         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18732        GO TO 3999-END-EDIT
 18733     END-IF
 18734
 18735     MOVE ER-2795                TO WS-ERROR
 18736     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18737                                                                  ELC50PD
 18738     GO TO 3999-END-EDIT.                                         ELC50PD
 18739******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18741 3990-FILES-NOT-OPEN.                                             ELC50PD
 18742                                                                  ELC50PD
 18743     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18745     GO TO 9990-RETURN.                                           ELC50PD
 18746                                                                  ELC50PD
 18747 3999-END-EDIT.                                                   ELC50PD
 18748
 18749                                                                  ELC50PD
 18750     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18751                                                                  ELC50PD
 18752     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18753         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18754         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18755             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18756             GO TO 9990-RETURN                                    ELC50PD
 18757          ELSE                                                    ELC50PD
 18758             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18759             GO TO 9990-RETURN.                                   ELC50PD
 18760                                                                  ELC50PD
 18761     IF PB-CANCELLATION                                           ELC50PD
 18762          GO TO 9990-RETURN.                                      ELC50PD
 18763                                                                  ELC50PD
 18764     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18765        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18766                                                                  ELC50PD
 18767     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18768                                                                  ELC50PD
 18769     IF CERT-WAS-FOUND                                            ELC50PD
 18770         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18771             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18772          ELSE                                                    ELC50PD
 18773            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18774      ELSE                                                        ELC50PD
 18775         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18776
 18777     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18778        IF PB-COMPANY-ID = 'DCC' AND
 18779           (PB-CARRIER = '2' OR '4' OR '6')
 18780              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18781        END-IF
 18782     END-IF.
 18783                                                                  ELC50PD
 18784     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18785     IF ((PB-COMPANY-ID = 'DCC')
 18786        AND (WS-NO-SECURE-PAY))
 18787                  OR
 18788        (WS-LF-SPECIAL-CALC-CD = 'O'
 18789        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18790        SET SKIP-ADDR-EDIT       TO TRUE
 18791     END-IF
 18792
 18793     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18794        AND (NOT SKIP-ADDR-EDIT)
 18795        MOVE ER-2963             TO WS-ERROR
 18796        PERFORM 9900-ERROR-FORMAT
 18797                                 THRU 9900-EXIT
 18798        GO TO 9990-RETURN
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18799     END-IF
 18800
 18801     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 18802
 18803     IF ERPNDM-FOUND NOT = 'X'
 18804        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18805           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 18806           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 18807           AND (NOT SKIP-ADDR-EDIT)
 18808           MOVE ER-2694          TO WS-ERROR
 18809           PERFORM 9900-ERROR-FORMAT
 18810                                 THRU 9900-EXIT
 18811        END-IF
 18812        MOVE ' '                 TO STATE-RECORD-ERROR
 18813        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18814        MOVE PM-STATE            TO CNTL-ACCESS
 18815        MOVE '3'                 TO CNTL-REC-TYPE
 18816        MOVE +0                  TO CNTL-SEQ-NO
 18817        MOVE '0'                 TO RC-SW-2
 18818        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18819        IF (NO-STATE-RECORD)
 18820           OR (CF-RECORD-TYPE NOT = '3')
 18821           OR (PM-STATE NOT = CF-STATE-CODE)
 18822           IF (PM-STATE = SPACES)
 18823              AND (SKIP-ADDR-EDIT)
 18824              CONTINUE
 18825           ELSE
 18826              MOVE ER-2963       TO WS-ERROR
 18827              PERFORM 9900-ERROR-FORMAT
 18828                                 THRU 9900-EXIT
 18829           END-IF
 18830        END-IF
 18831        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18832           MOVE ER-2883          TO WS-ERROR
 18833           PERFORM 9900-ERROR-FORMAT
 18834                                 THRU 9900-EXIT
 18835        END-IF
 18836        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18837           MOVE ' '                 TO STATE-RECORD-ERROR
 18838           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18839           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18840           MOVE '3'                 TO CNTL-REC-TYPE
 18841           MOVE +0                  TO CNTL-SEQ-NO
 18842           MOVE '0'                 TO RC-SW-2
 18843           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18844           IF NO-STATE-RECORD
 18845              OR (CF-RECORD-TYPE NOT = '3')
 18846              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18847              MOVE ER-2964          TO WS-ERROR
 18848              PERFORM 9900-ERROR-FORMAT
 18849                                    THRU 9900-EXIT
 18850           END-IF
 18851        END-IF
 18852     ELSE
 18853        IF NOT SKIP-ADDR-EDIT
 18854           MOVE ER-2393          TO WS-ERROR
 18855           PERFORM 9900-ERROR-FORMAT
 18856                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18857        END-IF
 18858     END-IF
 18859                                                                  ELC50PD
 18860     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18861                                                                  ELC50PD
 18862     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 18863        ERPNDM-FOUND = ' ')                                       ELC50PD
 18864        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 18865           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18866           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18867          OR                                                      ELC50PD
 18868           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 18869          OR                                                      ELC50PD
 18870           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 18871           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 18872           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 18873                                                                  ELC50PD
 18874
 18875     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 18876        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 18877                                                                  ELC50PD
 18878     IF PM-INSURED-LAST-NAME      = SPACES
 18879        AND PM-INSURED-FIRST-NAME = SPACES
 18880        AND PM-ADDRESS-LINE-1     = SPACES
 18881        AND PM-ADDRESS-LINE-2     = SPACES
 18882        AND PM-CITY-STATE         = SPACES
 18883        AND PM-CRED-BENE-NAME     = SPACES
 18884        AND PM-CRED-BENE-ADDR     = SPACES
 18885        AND PM-CRED-BENE-CTYST    = SPACES
 18886        GO TO 3999-UNLOCK-ERMAIL
 18887     END-IF
 18888                                                                  ELC50PD
 18889     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 18890                                                                  ELC50PD
 18891     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 18892     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 18893     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 18894     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 18895     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 18896     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 18897     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18898     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18899                                                                  ELC50PD
 18900     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 18901     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 18902                                                                  ELC50PD
 18903     IF ERMAIL-FOUND = ' '                                        ELC50PD
 18904        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 18905     ELSE                                                         ELC50PD
 18906        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 18907        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 18908        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 18909                                                                  ELC50PD
 18910
 18911     GO TO 9990-RETURN.                                           ELC50PD
 18912                                                                  ELC50PD
 18913 3999-UNLOCK-ERMAIL.                                              ELC50PD
 18914     IF ERMAIL-FOUND = ' '                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18915        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 18916                                                                  ELC50PD
 18917     GO TO 9990-RETURN.                                           ELC50PD
 18918******************************************************************ELC50PD
 18919                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18921 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 18922     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18923        GO TO 4299-EXIT.                                          ELC50PD
 18924                                                                  ELC50PD
 18925*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 18926
 18927     IF PB-C-NH-INT-ON-REFS > ZEROS
 18928        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 18929     END-IF
 18930     IF PB-C-REF-INTERFACE-SW = 'Y'
 18931        MOVE PB-C-REF-INTERFACE-SW
 18932                                 TO CM-NH-INTERFACE-SW
 18933     END-IF
 18934
 18935     IF PB-C-POST-CARD-IND = 'Y'
 18936        MOVE +8                  TO SUB
 18937        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18938        IF ERMAIL-FOUND = ' '
 18939           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18940              (SUB > +7)
 18941              OR (MA-MAIL-STATUS (SUB) = '1')
 18942           END-PERFORM
 18943        END-IF
 18944        IF (SUB > +7)
 18945           OR (ERMAIL-FOUND = 'X')
 18946           MOVE ER-3789          TO WS-ERROR
 18947           PERFORM 9900-ERROR-FORMAT
 18948                                 THRU 9900-EXIT
 18949        END-IF
 18950     ELSE
 18951        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18952     END-IF
 18953
 18954     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18955                                                                  ELC50PD
 18956     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 18957        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 18958                                                                  ELC50PD
 18959     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 18960         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 18961     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18962         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 18963                                                                  ELC50PD
 18964 4100-APPLY-LF-CANCEL.                                            ELC50PD
 18965                                                                  ELC50PD
 18966     MOVE +0                     TO WS-SUB.                       ELC50PD
 18967                                                                  ELC50PD
 18968 4100-CHECK-LF-ERRORS.                                            ELC50PD
 18969                                                                  ELC50PD
 18970     ADD +1                       TO WS-SUB.                      ELC50PD
 18971                                                                  ELC50PD
 18972     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 18973        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 18974           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 18975        ELSE                                                      ELC50PD
 18976           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 18977                                                                  ELC50PD
 18978     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18979                                   ER-2729 OR                     ELC50PD
 18980                                   ER-2730 OR                     ELC50PD
 18981                                   ER-2731 OR                     ELC50PD
 18982                                   ER-2732 OR                     ELC50PD
 18983                                   ER-2737 OR                     ELC50PD
 18984                                   ER-2740 OR                     ELC50PD
 18985                                   ER-2743 OR                     ELC50PD
 18986                                   ER-2749 OR                     ELC50PD
 18987                                   ER-2750 OR                     ELC50PD
 18988                                   ER-2755 OR                     ELC50PD
 18989                                   ER-2757 OR                     ELC50PD
 18990                                   ER-2760 OR                     ELC50PD
 18991                                   ER-2772 OR                     ELC50PD
 18992                                   ER-2774 OR                     ELC50PD
 18993                                   ER-2776 OR                     ELC50PD
 18994                                   ER-2794                        ELC50PD
 18995        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 18996                                                                  ELC50PD
 18997     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 18998                                                                  ELC50PD
 18999 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19000                                                                  ELC50PD
 19001     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19002     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19003     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19004        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19005     END-IF
 19006     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19007                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19008     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19009         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19010                                                                  ELC50PD
 19011     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19012         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19013                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19014                                                                  ELC50PD
 19015     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19016                                                                  ELC50PD
 19017 4100-LF-CANCEL-CONT.                                             ELC50PD
 19018     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19019         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19020                                                                  ELC50PD
 19021     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19022         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19023                                                                  ELC50PD
 19024     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19025        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19026           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19027        ELSE                                                      ELC50PD
 19028           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19029                                                                  ELC50PD
 19030     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19031     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19032                                                                  ELC50PD
 19033     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19034         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19035                                                                  ELC50PD
 19036     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19037        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19038         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19039         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19040                                                                  ELC50PD
 19041     IF PB-RECORD-RETURNED                                        ELC50PD
 19042        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19043      ELSE                                                        ELC50PD
 19044        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19045                                                                  ELC50PD
 19046 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19047                                                                  ELC50PD
 19048     MOVE +0                      TO WS-SUB.                      ELC50PD
 19049                                                                  ELC50PD
 19050 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19051                                                                  ELC50PD
 19052     ADD +1                       TO WS-SUB.                      ELC50PD
 19053                                                                  ELC50PD
 19054     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19055        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19056           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19057        ELSE                                                      ELC50PD
 19058           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19059                                                                  ELC50PD
 19060     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19061                                   ER-2729 OR                     ELC50PD
 19062                                   ER-2732 OR                     ELC50PD
 19063                                   ER-2737 OR                     ELC50PD
 19064                                   ER-2740 OR                     ELC50PD
 19065                                   ER-2744 OR                     ELC50PD
 19066                                   ER-2749 OR                     ELC50PD
 19067                                   ER-2750 OR                     ELC50PD
 19068                                   ER-2755 OR                     ELC50PD
 19069                                   ER-2757 OR                     ELC50PD
 19070                                   ER-2760 OR                     ELC50PD
 19071                                   ER-2771 OR                     ELC50PD
 19072                                   ER-2772 OR                     ELC50PD
 19073                                   ER-2773 OR                     ELC50PD
 19074                                   ER-2775 OR                     ELC50PD
 19075                                   ER-2777 OR                     ELC50PD
 19076                                   ER-2794                        ELC50PD
 19077        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19078                                                                  ELC50PD
 19079     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19080                                                                  ELC50PD
 19081 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19082                                                                  ELC50PD
 19083     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19084     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19085     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19086     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19087                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19088     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19089         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19090                                                                  ELC50PD
 19091     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19092         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19093                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19094                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19095     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19096         IF PB-RECORD-RETURNED                                    ELC50PD
 19097              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19098          ELSE                                                    ELC50PD
 19099              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19100                                                                  ELC50PD
 19101     GO TO 4299-EXIT.                                             ELC50PD
 19102                                                                  ELC50PD
 19103 4100-AH-CANCEL-CONT.                                             ELC50PD
 19104     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19105         GO TO 4299-EXIT.                                         ELC50PD
 19106                                                                  ELC50PD
 19107     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19108         GO TO 4299-EXIT.                                         ELC50PD
 19109                                                                  ELC50PD
 19110     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19111        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19112           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19113        ELSE                                                      ELC50PD
 19114           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19115                                                                  ELC50PD
 19116     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19117     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19118                                                                  ELC50PD
 19119     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19120         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19121                                                                  ELC50PD
 19122     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19123         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19124         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19125                                                                  ELC50PD
 19126     IF PB-RECORD-RETURNED                                        ELC50PD
 19127        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19128      ELSE                                                        ELC50PD
 19129        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19130                                                                  ELC50PD
 19131     GO TO 4299-EXIT.                                             ELC50PD
 19132                                                                  ELC50PD
 19133 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19134     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19135                                                                  ELC50PD
 19136     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19137        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19138                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19139     ELSE                                                         ELC50PD
 19140        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19141                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19142                                                                  ELC50PD
 19143     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19144        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19145                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19146     ELSE                                                         ELC50PD
 19147        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19148                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19149                                                                  ELC50PD
 19150     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19151        NEXT SENTENCE                                             ELC50PD
 19152     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19153        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19154                                                                  ELC50PD
 19155     GO TO 4299-EXIT.                                             ELC50PD
 19156                                                                  ELC50PD
 19157 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19158     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19159                                                                  ELC50PD
 19160     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19161        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19162        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19163        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19164                                                                  ELC50PD
 19165     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19166                                                                  ELC50PD
 19167     IF PB-RECORD-RETURNED                                        ELC50PD
 19168        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19169       ELSE                                                       ELC50PD
 19170        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19171                                                                  ELC50PD
 19172 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19173       EXIT.                                                      ELC50PD
 19174                                                                  ELC50PD
 19175 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19176     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19177                                                                  ELC50PD
 19178     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19179        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19180        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19181        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19182                                                                  ELC50PD
 19183     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19184                                                                  ELC50PD
 19185     IF PB-RECORD-RETURNED                                        ELC50PD
 19186        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19187       ELSE                                                       ELC50PD
 19188        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19189                                                                  ELC50PD
 19190 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19191       EXIT.                                                      ELC50PD
 19192                                                                  ELC50PD
 19193 4299-EXIT.                                                       ELC50PD
 19194       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19196                                                                  ELC50PD
 19197 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19198     IF CERT-WAS-FOUND                                            ELC50PD
 19199         NEXT SENTENCE                                            ELC50PD
 19200       ELSE                                                       ELC50PD
 19201         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19202                                                                  ELC50PD
 19203     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19204         GO TO 4999-EXIT.                                         ELC50PD
 19205                                                                  ELC50PD
 19206     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19207         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19208                                                                  ELC50PD
 19209     IF CERT-ADDED-BATCH                                          ELC50PD
 19210        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19211            GO TO 4999-EXIT.                                      ELC50PD
 19212                                                                  ELC50PD
 19213 4520-BUILD-NEW-KEY.                                              ELC50PD
 19214* BUILD CONTROL PRIMARY                                           ELC50PD
 19215                                                                  ELC50PD
 19216     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19217                                       CM-COMPANY-CD-A1           ELC50PD
 19218                                       CM-COMPANY-CD-A2           ELC50PD
 19219                                       CM-COMPANY-CD-A4           ELC50PD
 19220                                       CM-COMPANY-CD-A5.          ELC50PD
 19221                                                                  ELC50PD
 19222     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19223     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19224     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19225     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19226     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19227     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19228     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19229                                                                  ELC50PD
 19230     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19231                                                                  ELC50PD
 19232     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19233     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19234     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19235     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19236                                                                  ELC50PD
 19237     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19238        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19239                                                                  ELC50PD
 19240     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19241         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19242         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19243         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19244         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19245     ELSE                                                         ELC50PD
 19246         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19247                                                                  ELC50PD
 19248     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19249         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19250         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19251         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19252         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19253         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19254                                                                  ELC50PD
 19255     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19256        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19257         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19258                                                                  ELC50PD
 19259     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19260        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19261            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19262                                           PB-I-MEMBER-NO         ELC50PD
 19263            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19264                                                                  ELC50PD
 19265     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19266        NEXT SENTENCE                                             ELC50PD
 19267     ELSE                                                         ELC50PD
 19268        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19269                                                                  ELC50PD
 19270******************************************************************ELC50PD
 19271*                                                                *ELC50PD
 19272*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19273*    FOR 'MON'.                                                  *ELC50PD
 19274*                                                                *ELC50PD
 19275******************************************************************ELC50PD
 19276                                                                  ELC50PD
 19277     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19278     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19279     MOVE +1                     TO WS-SUB1                       ELC50PD
 19280                                    WS-SUB2.                      ELC50PD
 19281                                                                  ELC50PD
 19282 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19283                                                                  ELC50PD
 19284     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19285        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19286        ADD +1                       TO WS-SUB2.                  ELC50PD
 19287                                                                  ELC50PD
 19288     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19289        ADD +1                       TO WS-SUB1                   ELC50PD
 19290        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19291                                                                  ELC50PD
 19292     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19293     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19294     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19295*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19296     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19297     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19298     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19299                                                                  ELC50PD
 19300     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19301                                                                  ELC50PD
 19302******************************************************************ELC50PD
 19303*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19304******************************************************************ELC50PD
 19305                                                                  ELC50PD
 19306 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19307                                                                  ELC50PD
 19308     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19309         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19310         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19311         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19312         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19313     ELSE                                                         ELC50PD
 19314         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19315                                                                  ELC50PD
 19316     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19317        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19318         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19319                                                                  ELC50PD
 19320 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19321                                                                  ELC50PD
 19322*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19323*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19324*    ELSE                                                         ELC50PD
 19325*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19326                                                                  ELC50PD
 19327     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19328        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19329        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19330                                                                  ELC50PD
 19331     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19332        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19333        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19334                                                                  ELC50PD
 19335     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19336     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19337                                                                  ELC50PD
 19338     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19339        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19340        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19341     ELSE                                                         ELC50PD
 19342        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19343        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19344                                                                  ELC50PD
 19345     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19346     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19347     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19348     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19349     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19350     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19351     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19352                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19353                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19354                                      CM-AH-ITD-AH-PMT            ELC50PD
 19355                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19356                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19357                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19358                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19359*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19360*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19361     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.                ELC50PD
 19362     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19363     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19364     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19365     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
 19366     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19367     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19368     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19369     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19370     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19371     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19372     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19373                                                                  ELC50PD
 19374     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19375         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19376                                                                  ELC50PD
 19377     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19378         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19379                                                                  ELC50PD
 19380     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19381     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19382                                                                  ELC50PD
 19383     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19384         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19385         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19386                                                                  ELC50PD
 19387     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19388     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19389     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19390     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19391     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19392     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19393                                                                  ELC50PD
 19394     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19395        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19396     ELSE                                                         ELC50PD
 19397        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19398                                                                  ELC50PD
 19399     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19400        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19401        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19402     ELSE                                                         ELC50PD
 19403        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19404                                                                  ELC50PD
 19405     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19406     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19407     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19408     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19409     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19410     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19411     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19412     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19413     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19414                                                                  ELC50PD
 19415     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19416        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19417     ELSE                                                         ELC50PD
 19418        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19419                                                                  ELC50PD
 19420     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19421        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19422     ELSE                                                         ELC50PD
 19423        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
 19424                                                                  ELC50PD
 19425     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19426     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19427                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19428     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19429                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19430                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19431                                                                  ELC50PD
 19432*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19433*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19434*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19435*                       'NCL'                                     ELC50PD
 19436     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19437                                                                  ELC50PD
 19438     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19439         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19440            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19441                                                                  ELC50PD
 19442     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19443         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19444            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19445                                                                  ELC50PD
 19446     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19447         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19448     ELSE                                                         ELC50PD
 19449         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19450         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19451                                                                  ELC50PD
 19452     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19453     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19454     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19455     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19456     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19457     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19458     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19459     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19460                                                                  ELC50PD
 19461     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19462         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19463     ELSE                                                         ELC50PD
 19464         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19465                                                                  ELC50PD
 19466     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19467     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19468                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19469                                                                  ELC50PD
 19470     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19471     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19472                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19473                                                                  ELC50PD
 19474     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19475                                                                  ELC50PD
 19476     IF PB-REISSUED-CERT                                          ELC50PD
 19477        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19478                                                                  ELC50PD
 19479     IF PB-MONTHLY-CERT                                           ELC50PD
 19480        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19481                                                                  ELC50PD
 19482     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19483     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19484     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19485        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19486                                                                  ELC50PD
 19487     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19488        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19489                                                                  ELC50PD
 19490     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19491        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19492                                                                  ELC50PD
 19493     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19494        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19495                                                                  ELC50PD
 19496     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19497         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19498     ELSE                                                         ELC50PD
 19499         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19500                                                                  ELC50PD
 19501     IF PB-RECORD-RETURNED                                        ELC50PD
 19502        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19503      ELSE                                                        ELC50PD
 19504        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19505                                                                  ELC50PD
 19506     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19507        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19508                                                                  ELC50PD
 19509     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19510                                       CM-ENTRY-DT.               ELC50PD
 19511                                                                  ELC50PD
 19512 4999-EXIT.                                                       ELC50PD
 19513     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19515                                                                  ELC50PD
 19516 5000-PROCESS-REPS.
 19517
 19518     MOVE ' '                    TO AGTC-MASTER-SW
 19519     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19520     MOVE CO-TYPE                TO AGTC-TYPE
 19521     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19522     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19523
 19524     IF (AGTC-MASTER-SW NOT = 'N')
 19525        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19526        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19527        PERFORM 8583-READ-ERAGTC-NEXT
 19528                                 THRU 8583-EXIT
 19529     END-IF
 19530
 19531     IF AGTC-MASTER-SW = 'N'
 19532        CONTINUE
 19533     ELSE
 19534        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19535           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19536              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19537              MOVE 'Y'           TO AGTC-MASTER-SW
 19538           END-IF
 19539        END-IF
 19540     END-IF
 19541
 19542     .
 19543 5000-EXIT.
 19544     EXIT.
 19545
 19546
 19547 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19548     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19549        MOVE +1                  TO SUB                           ELC50PD
 19550        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19551        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19552        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19553        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19554        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19555                                                                  ELC50PD
 19556     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19557                                                                  ELC50PD
 19558     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19559     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19560*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19561     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19562     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19563     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19564     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19565                                                                  ELC50PD
 19566     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19567        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19568        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19569                                                                  ELC50PD
 19570     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19571     MOVE +1                     TO SUB.                          ELC50PD
 19572                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19573 6370-SEARCH-LOOP.                                                ELC50PD
 19574     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19575         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19576                                                                  ELC50PD
 19577     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19578         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD        ELC50PD
 19579         GO TO 6370-HER-NET-PAY-CHECK.                            ELC50PD
 19580                                                                  ELC50PD
 19581     ADD 1   TO SUB.                                              ELC50PD
 19582*    IF SUB GREATER 120                                           ELC50PD
 19583     IF SUB GREATER 200                                           ELC50PD
 19584         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19585                                                                  ELC50PD
 19586     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19587                                                                  ELC50PD
 19588 6370-NO-LF-FOUND.                                                ELC50PD
 19589                                                                  ELC50PD
 19590     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19591                                                                  ELC50PD
 19592 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19593                                                                  ELC50PD
 19594     IF PB-COMPANY-ID = 'CID'
 19595        IF PB-SV-STATE = 'CA' OR 'MN'
 19596           IF PB-I-LF-BENEFIT-CD = '02'
 19597              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19598           ELSE
 19599              IF PB-I-LF-BENEFIT-CD = '04'
 19600                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19601              END-IF
 19602           END-IF
 19603        END-IF
 19604     END-IF
 19605
 19606     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19607         GO TO 6370-EXIT.                                         ELC50PD
 19608                                                                  ELC50PD
 19609     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19610         GO TO 6370-EXIT.                                         ELC50PD
 19611                                                                  ELC50PD
 19612     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19613         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19614                                                                  ELC50PD
 19615     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19616         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19617                                                                  ELC50PD
 19618     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19619         GO TO 6370-EXIT.                                         ELC50PD
 19620                                                                  ELC50PD
 19621     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
 19622         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19623                                                                  ELC50PD
 19624     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19625         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19626                                                                  ELC50PD
 19627 6370-EXIT.                                                       ELC50PD
 19628     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19630                                                                  ELC50PD
 19631 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19632     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19633        MOVE +1                  TO SUB                           ELC50PD
 19634        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19635        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19636        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19637        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19638        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19639                                                                  ELC50PD
 19640     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19641                                                                  ELC50PD
 19642     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19643     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19644     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19645*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19646     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19647     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19648     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19649                                                                  ELC50PD
 19650     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19651        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19652        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19653                                                                  ELC50PD
 19654     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19655     MOVE +1 TO SUB.                                              ELC50PD
 19656                                                                  ELC50PD
 19657 6380-SEARCH-LOOP.                                                ELC50PD
 19658     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19659         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19660                                                                  ELC50PD
 19661     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19662         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19663         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19664                                                                  ELC50PD
 19665     ADD 1   TO SUB.                                              ELC50PD
 19666     IF SUB GREATER THAN 96                                       ELC50PD
 19667*    IF SUB GREATER THAN 300                                      ELC50PD
 19668         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19669                                                                  ELC50PD
 19670     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19671                                                                  ELC50PD
 19672 6380-NO-AH-FOUND.                                                ELC50PD
 19673                                                                  ELC50PD
 19674     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19675                                                                  ELC50PD
 19676     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19677         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19678     ELSE                                                         ELC50PD
 19679         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19680                                                                  ELC50PD
 19681 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19682                                                                  ELC50PD
 19683     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19684        NEXT SENTENCE                                             ELC50PD
 19685      ELSE                                                        ELC50PD
 19686        GO TO 6380-EXIT.                                          ELC50PD
 19687                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19688     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19689         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19690                                                                  ELC50PD
 19691                                                                  00041198
 19692     GO TO 6380-EXIT                                              00041198
 19693     .
 19694 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19695                                                                  00041203
 19696                                                                  ELC50PD
 19697     .                                                            ELC50PD
 19698 6380-EXIT.                                                       ELC50PD
 19699     EXIT.                                                        ELC50PD
 19700                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19702                                                                  ELC50PD
 19703 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19704                                                                  ELC50PD
 19705******************************************************************ELC50PD
 19706*                                                                *ELC50PD
 19707*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19708*                                                                *ELC50PD
 19709*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19710*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19711*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19712*    THE EXTENSION DAYS.                                         *ELC50PD
 19713*                                                                *ELC50PD
 19714******************************************************************ELC50PD
 19715                                                                  ELC50PD
 19716     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19717     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19718                                                                  ELC50PD
 19719******************************************************************ELC50PD
 19720*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19721*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19722******************************************************************ELC50PD
 19723                                                                  ELC50PD
 19724     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19725        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19726               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19727     ELSE                                                         ELC50PD
 19728        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19729                                                                  ELC50PD
 19730     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 19731           GO TO 6499-EXIT                                        ELC50PD
 19732     ELSE                                                         ELC50PD
 19733        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 19734           IF WS-WDF-MONTH = 02                                   ELC50PD
 19735              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 19736              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 19737              GO TO 6499-EXIT                                     ELC50PD
 19738           ELSE                                                   ELC50PD
 19739              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 19740                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 19741                 GO TO 6499-EXIT                                  ELC50PD
 19742               ELSE                                               ELC50PD
 19743                 GO TO 6499-EXIT                                  ELC50PD
 19744        ELSE                                                      ELC50PD
 19745           GO TO 6499-EXIT.                                       ELC50PD
 19746                                                                  ELC50PD
 19747 6412-CHECK-TO-DAY.                                               ELC50PD
 19748                                                                  ELC50PD
 19749        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 19750           IF WS-WDT-DAY = 28                                     ELC50PD
 19751              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 19752           ELSE                                                   ELC50PD
 19753              IF WS-WDT-DAY = 29                                  ELC50PD
 19754                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 19755              ELSE                                                ELC50PD
 19756                 NEXT SENTENCE                                    ELC50PD
 19757        ELSE                                                      ELC50PD
 19758           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 19759              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19760                                                                  ELC50PD
 19761     GO TO 6499-EXIT.                                             ELC50PD
 19762                                                                  ELC50PD
 19763                                                                  ELC50PD
 19764 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 19765                                                                  ELC50PD
 19766     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 19767        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 19768                                                                  ELC50PD
 19769 6415-EXIT.                                                       ELC50PD
 19770     EXIT.                                                        ELC50PD
 19771                                                                  ELC50PD
 19772 6499-EXIT.                                                       ELC50PD
 19773      EXIT.                                                       ELC50PD
 19774                                                                  ELC50PD
 19775 6500-END.                                                        ELC50PD
 19776     EXIT.
 19777
 19778                                                                  ELC50PD
 19779******************************************************************ELC50PD
 19780************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 19781********************** ELC50PD END *******************************ELC50PD
 19782                                                                  ELC50PD
 19783*
 19784*
 19785**START***********************************************************
 19786*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 19787*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 19788******************************************************************
 19789*
 19790 6600-GET-STATE-MUNICIPAL-TAX.
 19791
 19792     IF PB-COMPANY-ID NOT = 'DMD'
 19793         GO TO 6640-EXIT.
 19794
 19795     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19796     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19797     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19798
 19799*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19800     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19801     MOVE SPACES TO DC-ALPHA-CENTURY.
 19802     SET BIN-TO-GREG          TO TRUE.
 19803     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19804
 19805     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 19806     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 19807
 19808     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19809     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 19810                                 WS-SAVE-ERRESS-KEY.
 19811
 19812*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 19813*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 19814
 19815     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 19816
 19817     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 360
* EL517.cbl
 19818         MOVE ER-8002        TO WS-ERROR
 19819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19820         GO TO 6640-EXIT.
 19821
 19822*GET RECORD WHERE POSITIONED
 19823
 19824 6600-READ-ERRESS-NEXT.
 19825     READ ERRESS NEXT RECORD.
 19826
 19827     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 19828         MOVE ER-8002        TO WS-ERROR
 19829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19830         GO TO 6640-EXIT.
 19831
 19832*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 19833
 19834     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 19835        NEXT SENTENCE
 19836     ELSE
 19837        MOVE ER-8002        TO WS-ERROR
 19838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19839        GO TO 6640-EXIT.
 19840
 19841     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 19842        NEXT SENTENCE
 19843     ELSE
 19844        GO TO 6600-READ-ERRESS-NEXT.
 19845
 19846*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19847*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 19848
 19849     MOVE +2                     TO WS-SUB1.
 19850
 19851     IF PB-CANCELLATION
 19852        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19853           MOVE +1               TO WS-SUB1.
 19854
 19855     IF PB-ISSUE
 19856        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19857           MOVE +1               TO WS-SUB1.
 19858
 19859*
 19860*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19861*
 19862     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 19863     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 19864     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 19865     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 19866
 19867
 19868*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19869*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19870*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 19871
 19872     ADD 1                    TO WS-YEAR-YY.
 19873
 19874     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19875         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 361
* EL517.cbl
 19876                              TO WS-RES-STATE-TAX
 19877         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 19878                              TO WS-RES-MUNI-TAX
 19879     ELSE
 19880         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19881                              TO WS-RES-STATE-TAX
 19882         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19883                              TO WS-RES-MUNI-TAX.
 19884
 19885*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19886
 19887     IF PB-CANCELLATION
 19888         GO TO 6640-CANCEL-TAX.
 19889
 19890     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19891          COMPUTE PB-I-STATE-TAX ROUNDED =
 19892                                    PB-I-LF-PREMIUM-AMT
 19893                                  * WS-RES-STATE-TAX
 19894          COMPUTE PB-I-MUNI-TAX ROUNDED =
 19895                                    PB-I-LF-PREMIUM-AMT
 19896                                  * WS-RES-MUNI-TAX
 19897     ELSE
 19898     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19899          COMPUTE PB-I-STATE-TAX ROUNDED =
 19900                                    PB-I-AH-PREMIUM-AMT
 19901                                  * WS-RES-STATE-TAX
 19902          COMPUTE PB-I-MUNI-TAX ROUNDED =
 19903                                    PB-I-AH-PREMIUM-AMT
 19904                                  * WS-RES-MUNI-TAX.
 19905
 19906     GO TO 6640-EXIT.
 19907
 19908 6640-CANCEL-TAX.
 19909     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19910
 19911     IF PB-C-LF-CANCEL-AMT > ZEROS
 19912          COMPUTE PB-CI-STATE-TAX ROUNDED =
 19913                                    PB-C-LF-CANCEL-AMT
 19914                                  * WS-RES-STATE-TAX
 19915          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19916                                    PB-C-LF-CANCEL-AMT
 19917                                  * WS-RES-MUNI-TAX
 19918     ELSE
 19919     IF PB-C-AH-CANCEL-AMT > ZEROS
 19920          COMPUTE PB-CI-STATE-TAX ROUNDED =
 19921                                    PB-C-AH-CANCEL-AMT
 19922                                  * WS-RES-STATE-TAX
 19923          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19924                                    PB-C-AH-CANCEL-AMT
 19925                                  * WS-RES-MUNI-TAX.
 19926
 19927 6640-EXIT.
 19928     EXIT.
 19929
 19930 6650-GET-RES-STATE-COMM.
 19931
 19932     IF PB-COMPANY-ID NOT = 'DMD'
 19933         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 362
* EL517.cbl
 19934
 19935     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19936     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19937     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19938     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19939     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19940     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19941     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19942
 19943*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19944
 19945     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19946     MOVE SPACES              TO DC-ALPHA-CENTURY.
 19947     SET BIN-TO-GREG          TO TRUE.
 19948     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19949
 19950     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 19951     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 19952
 19953     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19954
 19955*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 19956*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 19957*VALUE OF PB-CERT-EFF-DT
 19958
 19959     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 19960     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 19961
 19962     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 19963         GO TO 6700-COMM-EXIT.
 19964
 19965*GET RECORD WHERE POSITIONED
 19966
 19967 6650-READ-ERRESC-NEXT.
 19968     READ ERRESC NEXT RECORD.
 19969
 19970     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 19971         GO TO 6700-COMM-EXIT.
 19972
 19973     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19974        NEXT SENTENCE
 19975     ELSE
 19976         GO TO 6700-COMM-EXIT.
 19977
 19978     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 19979         NEXT SENTENCE
 19980       ELSE
 19981         GO TO 6650-READ-ERRESC-NEXT.
 19982
 19983*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 19984*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 19985
 19986     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 19987         GO TO 6700-COMM-EXIT.
 19988
 19989* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19990
 19991     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 363
* EL517.cbl
 19992
 19993     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19994
 19995     IF WS-SUB1 > ZERO
 19996         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 19997             PERFORM 6680-SET-COMMISSION
 19998         ELSE
 19999             PERFORM 6680-SET-TABLE-CODE.
 20000
 20001     GO TO 6700-COMM-EXIT.
 20002
 20003 6680-SET-TABLE-CODE.
 20004     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20005        MOVE ZEROS             TO WS-SUB1
 20006     ELSE
 20007* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20008* TO COMPUTE AH COMMISSION.
 20009        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20010        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20011        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20012        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20013        PERFORM 6680-READ-CTBL-TABLE
 20014        IF ERCTBL-FILE-STATUS NOT = '00'
 20015           MOVE ZEROS          TO WS-SUB1.
 20016
 20017 6680-READ-CTBL-TABLE.
 20018*
 20019* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20020* TO COMPUTE LIFE COMMISSION
 20021
 20022     IF CTBL-SW = '0540'
 20023        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20024        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20025        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20026
 20027     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20028
 20029     IF CTBL-TABLE-FOUND
 20030        IF CTBL-SW = '0530'
 20031             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20032                                        PB-I-AH-TERM
 20033             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20034             MOVE WS-WK-RATE        TO WS-COMMISSION
 20035                                       PB-I-AH-COMMISSION
 20036        ELSE
 20037             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20038             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20039             MOVE WS-WK-RATE        TO WS-COMMISSION
 20040                                       PB-I-LIFE-COMMISSION
 20041     ELSE
 20042        IF FIRST-TIME-THROUGH
 20043            GO TO 6680-READ-CTBL-TABLE
 20044        ELSE
 20045            MOVE ZEROS         TO WS-SUB1.
 20046
 20047 6680-SET-COMMISSION.
 20048     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20049           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 364
* EL517.cbl
 20050       ELSE
 20051           MOVE RESC-COMMISSION-PER (WS-SUB)
 20052                             TO WS-COMMISSION
 20053           IF CTBL-SW = '0540'
 20054               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20055           ELSE
 20056               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20057
 20058 6680-SEARCH-CATEGORY.
 20059     ADD +1                   TO WS-SUB.
 20060     IF WS-SUB > +12
 20061         GO TO 6680-EXIT.
 20062
 20063     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20064          MOVE WS-SUB         TO WS-SUB1
 20065          GO TO 6680-EXIT.
 20066
 20067     GO TO 6680-SEARCH-CATEGORY.
 20068
 20069 6680-EXIT.
 20070     EXIT.
 20071
 20072 6700-COMM-EXIT.
 20073     EXIT.
 20074**END*************************************************************
 20075*      CUSTOM CODING FOR CLIENT "DMD"
 20076******************************************************************
 20077*
 20078 7000-GET-RATE.
 20079     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20080
 20081 7000-EXIT.
 20082     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 365
* EL517.cbl
 20084
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 366
* EL517.cbl
 20086 7100-FIND-BENEFIT-IN-STATE.
 20087     MOVE 'N'                    TO BEN-SEARCH-SW.
 20088
 20089     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20090         VARYING SUB3 FROM 1 BY 1 UNTIL
 20091            ((SUB3 GREATER 50) OR
 20092              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20093               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20094
 20095     IF SUB3 NOT = 51
 20096         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20097             MOVE 'Y'            TO BEN-SEARCH-SW.
 20098
 20099     GO TO 7199-EXIT.
 20100
 20101 7100-BENEFIT-DUMMY.
 20102
 20103 7100-DUMMY-EXIT.
 20104     EXIT.
 20105
 20106 7199-EXIT.
 20107     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 367
* EL517.cbl
 20109 7200-FIND-BENEFIT.
 20110     MOVE 'N'                    TO BEN-SEARCH-SW.
 20111
 20112     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20113         VARYING SUB3 FROM 1 BY 1 UNTIL
 20114            ((SUB3 GREATER 8) OR
 20115            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20116
 20117     IF SUB3 NOT = 9
 20118         MOVE 'Y'                TO BEN-SEARCH-SW.
 20119
 20120     GO TO 7200-EXIT.
 20121
 20122 7200-BENEFIT-DUMMY.
 20123
 20124     EXIT.
 20125 7200-DUMMY-EXIT.
 20126     EXIT.
 20127
 20128 7200-EXIT.
 20129     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 368
* EL517.cbl
 20131 7250-LOOK-FOR-RESCINDED-CLAIM.
 20132
 20133     IF ELMSTR-OPEN = ' '
 20134         OPEN INPUT ELMSTR
 20135         MOVE 'X'                TO ELMSTR-OPEN
 20136         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20137             NEXT SENTENCE
 20138         ELSE
 20139             MOVE ELMSTR-FILE-STATUS
 20140                                 TO WS-ABEND-FILE-STATUS
 20141             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20142             MOVE EMSG           TO WS-ABEND-MESSAGE
 20143             GO TO ABEND-PGM.
 20144
 20145     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20146                                    W-CL-COMP-CD.
 20147     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20148                                    W-CL-CERT-NO.
 20149     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20150
 20151     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20152
 20153     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20154         GO TO 7250-EXIT.
 20155
 20156     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20157         GO TO 7250-CLAIMS-ERROR.
 20158
 20159 7250-NEXT-CLAIM.
 20160
 20161     READ ELMSTR NEXT.
 20162
 20163     IF ELMSTR-FILE-STATUS = '10'
 20164         GO TO 7250-EXIT.
 20165
 20166     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20167         GO TO 7250-CLAIMS-ERROR.
 20168
 20169     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20170        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20171         GO TO 7250-EXIT.
 20172
 20173     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20174        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20175        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20176        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20177        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20178         GO TO 7250-NEXT-CLAIM.
 20179
 20180     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20181        OR (CL-CLAIM-TYPE = 'I')
 20182        OR (CL-CLAIM-TYPE = 'G')
 20183          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20184              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20185              GO TO 7250-EXIT
 20186          END-IF
 20187     END-IF.
 20188
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 369
* EL517.cbl
 20189     GO TO 7250-NEXT-CLAIM.
 20190
 20191 7250-CLAIMS-ERROR.
 20192
 20193     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20194     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20195     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20196     GO TO ABEND-PGM.
 20197
 20198 7250-EXIT.
 20199     EXIT.
 20200 7300-CHECK-FOR-OPEN-CLMS.
 20201
 20202     IF ELMSTR-OPEN = ' '
 20203         OPEN INPUT ELMSTR
 20204         MOVE 'X'                TO ELMSTR-OPEN
 20205         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20206             NEXT SENTENCE
 20207         ELSE
 20208             MOVE ELMSTR-FILE-STATUS
 20209                                 TO WS-ABEND-FILE-STATUS
 20210             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20211             MOVE EMSG           TO WS-ABEND-MESSAGE
 20212             GO TO ABEND-PGM.
 20213
 20214     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20215                                    W-CL-COMP-CD.
 20216     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20217                                    W-CL-CERT-NO.
 20218     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20219
 20220     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20221
 20222     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20223         GO TO 7300-EXIT.
 20224
 20225     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20226         GO TO 7300-CLAIMS-ERROR.
 20227
 20228     MOVE 'Y'                    TO W-BROWSE-SW.
 20229
 20230 7300-NEXT-CLAIM.
 20231
 20232     READ ELMSTR NEXT.
 20233
 20234     IF ELMSTR-FILE-STATUS = '10'
 20235         GO TO 7300-EXIT.
 20236
 20237     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20238         GO TO 7300-CLAIMS-ERROR.
 20239
 20240     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20241        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20242         GO TO 7300-EXIT.
 20243
 20244     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20245        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20246        PB-SV-STATE    NOT = CL-CERT-STATE    OR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 370
* EL517.cbl
 20247        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20248        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20249         GO TO 7300-NEXT-CLAIM.
 20250
 20251     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20252        OR 'I' OR 'G'
 20253        IF CLAIM-IS-OPEN
 20254           EVALUATE TRUE
 20255             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20256                 MOVE ER-2884      TO WS-ERROR
 20257             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20258                 MOVE ER-2887      TO WS-ERROR
 20259             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20260                 MOVE ER-2886      TO WS-ERROR
 20261             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20262                 MOVE ER-2888      TO WS-ERROR
 20263             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20264                 MOVE ER-2885      TO WS-ERROR
 20265             WHEN OTHER
 20266                 MOVE ER-2768      TO WS-ERROR
 20267           END-EVALUATE
 20268           IF PB-C-AH-CANCEL-VOIDED OR
 20269              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20270                NOT AH-COVERAGE-CANCELLED)
 20271               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20272               MOVE ER-2768      TO WS-ERROR
 20273           END-IF
 20274           PERFORM 9900-ERROR-FORMAT
 20275                                 THRU 9900-EXIT
 20276           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20277              PB-FORCE-CODE NOT EQUAL '8'
 20278               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20279           END-IF
 20280           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20281           GO TO 7300-EXIT
 20282        ELSE
 20283           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20284*****THIS IS A RESCISSION OR REFORMATION
 20285              IF (AH-COVERAGE-CANCELLED AND
 20286                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20287                    MOVE ER-2890 TO WS-ERROR
 20288                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20289                    GO TO 7300-EXIT
 20290              END-IF
 20291           ELSE
 20292              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20293               AND PB-C-AH-CANCEL-DT > SPACES
 20294                 MOVE ER-2756       TO WS-ERROR
 20295                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20296                 GO TO 7300-EXIT
 20297              END-IF
 20298           END-IF
 20299        END-IF
 20300     ELSE
 20301        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20302           IF CLAIM-IS-OPEN
 20303              MOVE ER-2889    TO WS-ERROR
 20304              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 371
* EL517.cbl
 20305              GO TO 7300-EXIT
 20306           ELSE
 20307              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20308*****THIS IS A RESCISSION OR REFORMATION
 20309                 IF (LF-COVERAGE-CANCELLED AND
 20310                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20311                       MOVE ER-2890 TO WS-ERROR
 20312                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20313                       GO TO 7300-EXIT
 20314                 END-IF
 20315              ELSE
 20316                 IF (AH-COVERAGE-CANCELLED AND
 20317                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20318                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20319                    (LF-COVERAGE-CANCELLED AND
 20320                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20321                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20322                       MOVE ER-2965 TO WS-ERROR
 20323                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20324                       GO TO 7300-EXIT
 20325                 END-IF
 20326                 IF LF-COVERAGE-CANCELLED
 20327                  IF CL-TOTAL-PAID-AMT > 0
 20328                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20329                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20330                        MOVE ER-2891 TO WS-ERROR
 20331                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20332                        GO TO 7300-EXIT
 20333                      END-IF
 20334                    ELSE
 20335                      MOVE ER-2892 TO WS-ERROR
 20336                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20337                      GO TO 7300-EXIT
 20338                    END-IF
 20339                  END-IF
 20340                 END-IF
 20341              END-IF
 20342           END-IF
 20343        END-IF
 20344     END-IF
 20345
 20346     GO TO 7300-NEXT-CLAIM.
 20347
 20348 7300-CLAIMS-ERROR.
 20349
 20350     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20351     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20352     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20353     GO TO ABEND-PGM.
 20354
 20355 7300-EXIT.
 20356     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 372
* EL517.cbl
 20358
 20359 7400-GET-REMAIN-TERM.
 20360     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20361
 20362 7400-EXIT.
 20363     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 373
* EL517.cbl
 20365
 20366 7500-GET-REMAIN-AMOUNT.
 20367     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20368
 20369 7500-EXIT.
 20370     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 374
* EL517.cbl
 20372
 20373 7600-GET-REFUND.
 20374     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20375
 20376 7600-EXIT.
 20377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 375
* EL517.cbl
 20379
 20380 7700-CALL-DL1.
 20381     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20382     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20383
 20384 7700-EXIT.
 20385     EXIT.
 20386
 20387 7710-CALL-DL2.
 20388     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20389     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20390
 20391 7710-EXIT.
 20392     EXIT.
 20393
 20394 7720-CALL-DL3.
 20395     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20396     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20397
 20398 7720-EXIT.
 20399     EXIT.
 20400
 20401 7730-CALL-DL7.
 20402     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20403     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20404
 20405 7730-EXIT.
 20406     EXIT.
 20407
 20408 7740-CALL-DL11.
 20409     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20410     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20411
 20412 7740-EXIT.
 20413     EXIT.
 20414
 20415 7750-CALL-DL17.
 20416     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20417     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20418
 20419 7750-EXIT.
 20420     EXIT.
 20421
 20422 7755-CALL-DL19.
 20423     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20424     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20425
 20426 7755-EXIT.
 20427     EXIT.
 20428
 20429 7760-CALL-DL21.
 20430     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20431
 20432 7760-EXIT.
 20433     EXIT.
 20434
 20435 7770-CALL-DL22.
 20436     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 376
* EL517.cbl
 20437     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20438
 20439 7770-EXIT.
 20440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 377
* EL517.cbl
 20442
 20443 7800-REWRITE-CERT.
 20444     REWRITE CERTIFICATE-MASTER.
 20445     ADD 1 TO WCER.
 20446
 20447 7800-EXIT.
 20448      EXIT.
 20449     EXIT.
 20450
 20451 8000-WRITE-CERT.
 20452
 20453     WRITE CERTIFICATE-MASTER.
 20454     ADD 1 TO WCER.
 20455     IF ELCERT-FILE-STATUS NOT = '00'
 20456         GO TO 8000-FREE-MAIN.
 20457
 20458 8000-FREE-MAIN.
 20459
 20460 8000-EXIT.
 20461     EXIT.
 20462      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 378
* EL517.cbl
 20464
 20465 8100-READ-ERPNDM.
 20466     IF ERPNDM-OPEN = ' '
 20467        OPEN INPUT ERPNDM
 20468        MOVE 'X' TO ERPNDM-OPEN
 20469        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20470           NEXT SENTENCE
 20471        ELSE
 20472           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20473           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20474           MOVE EMSG TO WS-ABEND-MESSAGE
 20475           GO TO ABEND-PGM.
 20476
 20477     MOVE SPACES                 TO ERPNDM-FOUND.
 20478     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20479     READ ERPNDM.
 20480
 20481     IF ERPNDM-FILE-STATUS  = '00'
 20482        CONTINUE
 20483     ELSE
 20484        MOVE 'X'                 TO ERPNDM-FOUND
 20485        MOVE ER-2694             TO WS-ERROR
 20486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20487        MOVE ER-2883             TO WS-ERROR
 20488        PERFORM 9900-ERROR-FORMAT
 20489                                 THRU 9900-EXIT
 20490     END-IF
 20491
 20492     .
 20493 8100-EXIT.
 20494     EXIT.
 20495
 20496 8110-READ-ERMAIL.
 20497     IF ERMAIL-OPEN = ' '
 20498        OPEN  I-O ERMAIL
 20499        MOVE 'X' TO ERMAIL-OPEN
 20500        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20501           NEXT SENTENCE
 20502        ELSE
 20503            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20504            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20505            MOVE EMSG TO WS-ABEND-MESSAGE
 20506            GO TO ABEND-PGM.
 20507
 20508     MOVE SPACES                 TO ERMAIL-FOUND.
 20509     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20510     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20511     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20512     MOVE PB-SV-STATE            TO MA-STATE.
 20513
 20514     READ ERMAIL.
 20515
 20516     IF ERMAIL-FILE-STATUS  = '00'
 20517         NEXT SENTENCE
 20518       ELSE
 20519        MOVE 'X'                 TO ERMAIL-FOUND.
 20520
 20521 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 379
* EL517.cbl
 20522     EXIT.
 20523
 20524 8120-REWRITE-ERMAIL.
 20525     REWRITE MAILING-DATA.
 20526
 20527 8120-EXIT.
 20528     EXIT.
 20529
 20530 8130-WRITE-ERMAIL.
 20531     WRITE MAILING-DATA.
 20532
 20533 8130-EXIT.
 20534     EXIT.
 20535
 20536 8140-UNLOCK-ERMAIL.
 20537     MOVE SPACES                 TO ERMAIL-FOUND.
 20538
 20539 8140-EXIT.
 20540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 380
* EL517.cbl
 20542
 20543 8180-UPDATE-VIN-NUMBER.
 20544
 20545     IF ELCRTT-OPEN = ' '
 20546         OPEN I-O ELCRTT
 20547         MOVE 'X' TO ELCRTT-OPEN
 20548         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20549             NEXT SENTENCE
 20550         ELSE
 20551             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20552             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20553             MOVE EMSG               TO WS-ABEND-MESSAGE
 20554             GO TO ABEND-PGM
 20555         END-IF
 20556     END-IF.
 20557
 20558     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20559     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20560     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20561
 20562     READ ELCRTT.
 20563
 20564     IF ELCRTT-FILE-STATUS  = '00'
 20565        CONTINUE
 20566     ELSE
 20567        GO TO 8180-NOTFND
 20568     END-IF.
 20569
 20570     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20571         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20572         REWRITE CERTIFICATE-TRAILERS
 20573     END-IF.
 20574
 20575     GO TO 8180-EXIT.
 20576
 20577 8180-NOTFND.
 20578
 20579     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20580     MOVE 'CS'         TO CS-RECORD-ID.
 20581     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20582     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20583     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20584     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20585     WRITE CERTIFICATE-TRAILERS.
 20586
 20587 8180-EXIT.
 20588     EXIT.
 20589
 20590 8190-UPDATE-REFUND-CLAIM-FLAG.
 20591
 20592     IF ELCRTT-OPEN = ' '
 20593         OPEN I-O ELCRTT
 20594         MOVE 'X' TO ELCRTT-OPEN
 20595         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20596             NEXT SENTENCE
 20597         ELSE
 20598             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20599             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 381
* EL517.cbl
 20600             MOVE EMSG               TO WS-ABEND-MESSAGE
 20601             GO TO ABEND-PGM
 20602         END-IF
 20603     END-IF.
 20604
 20605     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20606     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20607     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20608
 20609     READ ELCRTT.
 20610
 20611     IF ELCRTT-FILE-STATUS  = '00'
 20612        CONTINUE
 20613     ELSE
 20614        GO TO 8190-NOTFND
 20615     END-IF.
 20616
 20617     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20618     REWRITE CERTIFICATE-TRAILERS.
 20619
 20620     GO TO 8190-EXIT.
 20621
 20622 8190-NOTFND.
 20623
 20624     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20625     MOVE 'CS'         TO CS-RECORD-ID.
 20626     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20627     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20628     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20629     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20630     WRITE CERTIFICATE-TRAILERS.
 20631
 20632 8190-EXIT.
 20633     EXIT.
 20634
 20635 8200-READ-REIN-TABLE.
 20636     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 20637     READ ERREIN.
 20638     ADD 1 TO RREI.
 20639
 20640     IF RE-CODE NOT = 'A'
 20641        PERFORM REIN-DATE-LOAD.
 20642
 20643     IF ERREIN-FILE-STATUS NOT = '00'
 20644          GO TO 8200-NOTFND.
 20645
 20646     GO TO 8200-EXIT.
 20647
 20648 8200-NOTFND.
 20649     MOVE 'N'                TO WS-REIN-READ-SW.
 20650
 20651 8200-EXIT.
 20652     EXIT.
 20653      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 382
* EL517.cbl
 20655
 20656 8300-READ-CTBL-TABLE.
 20657     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 20658     READ ERCTBL.
 20659     ADD 1 TO RCTB.
 20660
 20661     IF ERCTBL-FILE-STATUS NOT = '00'
 20662         GO TO 8300-NOTFND.
 20663
 20664     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20665
 20666     GO TO 8300-EXIT.
 20667
 20668 8300-NOTFND.
 20669     IF CTBL-SW = '0530'
 20670         MOVE 'AA'                     TO WS-AH-COMP-CD
 20671         MOVE '0550'                   TO CTBL-SW
 20672         MOVE '1'                      TO WS-CTBL-READ-SW
 20673         GO TO 8300-EXIT.
 20674
 20675     IF CTBL-SW = '0540'
 20676         MOVE 'AA'                     TO WS-LF-COMP-CD
 20677         MOVE '0550'                   TO CTBL-SW
 20678         MOVE '1'                      TO WS-CTBL-READ-SW
 20679         GO TO 8300-EXIT.
 20680
 20681     IF CTBL-SW = '0550'
 20682         MOVE '2'                      TO WS-CTBL-READ-SW
 20683         GO TO 8300-EXIT.
 20684
 20685 8300-EXIT.
 20686      EXIT.
 20687     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 383
* EL517.cbl
 20689
 20690 8400-GETMAIN-ERFORM.
 20691*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20692     EXIT.
 20693 8400-EXIT.
 20694     EXIT.
 20695
 20696 8450-READ-FORM-MASTER.
 20697
 20698     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 20699
 20700     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 20701
 20702     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20703        GO TO 8450-FORM-NOT-FOUND.
 20704
 20705     READ ERFORM NEXT.
 20706
 20707     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20708        GO TO 8450-FORM-NOT-FOUND.
 20709
 20710     MOVE 'Y'                    TO FORM-MASTER-SW.
 20711     GO TO 8450-EXIT.
 20712
 20713 8450-FORM-NOT-FOUND.
 20714
 20715     MOVE 'N'                    TO FORM-MASTER-SW.
 20716
 20717 8450-EXIT.
 20718     EXIT.
 20719
 20720 8500-DATE-CONVERT.
 20721     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20722
 20723 8500-EXIT.
 20724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 384
* EL517.cbl
 20726
 20727 8555-RELOAD-CONTROL-FILE.
 20728     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 20729
 20730 8555-EXIT.
 20731     EXIT.
 20732
 20733 8557-GETMAIN-ERPLAN.
 20734*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20735     EXIT.
 20736 8557-EXIT.
 20737     EXIT.
 20738
 20739 8560-GETMAIN.
 20740      MOVE 999 TO ERACCT-POINTER.
 20741
 20742 8560-EXIT.
 20743     EXIT.
 20744
 20745 8570-START-ACCOUNT-MASTER.
 20746     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20747
 20748 8570-EXIT.
 20749     EXIT.
 20750
 20751 8580-READ-ACCOUNT-MASTER.
 20752     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20753
 20754     IF WS-BROWSE-STARTED-SW = 'Y'
 20755         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 20756
 20757     IF ERACCT-FILE-STATUS = '23'
 20758         MOVE HIGH-VALUE TO ERACCT-KEY
 20759         GO TO 8580-EXIT.
 20760
 20761     IF ERACCT-FILE-STAT-1 = '9'
 20762         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20763         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 20764         MOVE RMSG TO WS-ABEND-MESSAGE
 20765         GO TO ABEND-PGM.
 20766
 20767     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 20768
 20769     READ ERACCT NEXT.
 20770     ADD 1 TO RACC.
 20771
*20772     COPY ELCACCTI.
 20773******************************************************************04/14/98
 20774*                                                                *ELCACCTI
 20775*                            ELCACCTI                            *   LV003
 20776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 20777*                            VMOD=2.001                          *ELCACCTI
 20778*                                                                *ELCACCTI
 20779*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 20780*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 20781*                                                                *ELCACCTI
 20782*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 20783*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 385
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 20784******************************************************************ELCACCTI
 20785     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 20786     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 20787     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 20788     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 20789     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 20790     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 20791     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 20792     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 20793     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 20794
 20795     IF ERACCT-FILE-STAT-1 = '9'
 20796         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20797         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 20798         MOVE RMSG TO WS-ABEND-MESSAGE
 20799         GO TO ABEND-PGM.
 20800
 20801     IF ERACCT-FILE-STATUS NOT = '00'
 20802         MOVE HIGH-VALUE TO ERACCT-KEY
 20803         GO TO 8580-EXIT.
 20804
 20805     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 20806
 20807 8580-EXIT.
 20808     EXIT.
 20809
 20810 8582-READ-COMPENSATION-MASTER.
 20811     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 20812
 20813     READ ERCOMP
 20814
 20815     IF ERCOMP-FILE-STATUS NOT = '00'
 20816        GO TO 8582-COMP-NOT-FOUND
 20817     END-IF
 20818
 20819     MOVE 'Y'                    TO COMP-MASTER-SW.
 20820     GO TO 8582-EXIT
 20821     .
 20822 8582-COMP-NOT-FOUND.
 20823
 20824     MOVE 'N'                    TO COMP-MASTER-SW.
 20825
 20826 8582-EXIT.
 20827     EXIT.
 20828
 20829 8583-READ-ERAGTC.
 20830
 20831     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 20832
 20833     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 20834
 20835     IF ERAGTC-FILE-STATUS NOT = '00'
 20836        GO TO 8583-AGTC-NOT-FOUND
 20837     END-IF
 20838
 20839     .
 20840 8583-READ-ERAGTC-NEXT.
 20841
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 386
* EL517.cbl
 20842     READ ERAGTC NEXT RECORD
 20843
 20844     IF ERAGTC-FILE-STATUS NOT = '00'
 20845        GO TO 8583-AGTC-NOT-FOUND
 20846     END-IF
 20847
 20848*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 20849     GO TO 8583-EXIT
 20850     .
 20851 8583-AGTC-NOT-FOUND.
 20852
 20853     MOVE 'N'                    TO AGTC-MASTER-SW.
 20854
 20855 8583-EXIT.
 20856     EXIT.
 20857
 20858 8584-READ-BANK-CROSS-REF.
 20859     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 20860
 20861     READ ERBXRF
 20862
 20863     IF ERBXRF-FILE-STATUS NOT = '00'
 20864        GO TO 8584-BXRF-NOT-FOUND
 20865     END-IF
 20866
 20867     MOVE 'Y'                    TO BXRF-MASTER-SW.
 20868     GO TO 8584-EXIT
 20869     .
 20870 8584-BXRF-NOT-FOUND.
 20871
 20872     MOVE 'N'                    TO BXRF-MASTER-SW.
 20873
 20874 8584-EXIT.
 20875     EXIT.
 20876
 20877 8585-READ-PLAN-MASTER.
 20878
 20879     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 20880
 20881     READ ERPLAN.
 20882
 20883     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 20884        GO TO 8585-PLAN-NOT-FOUND.
 20885
 20886     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20887     GO TO 8585-EXIT.
 20888
 20889 8585-PLAN-NOT-FOUND.
 20890
 20891     MOVE 'N'                    TO PLAN-MASTER-SW.
 20892
 20893 8585-EXIT.
 20894     EXIT.
 20895
 20896 8586-READ-LOAN-OFFICER.
 20897
 20898     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 20899
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 387
* EL517.cbl
 20900     READ ERLOFC
 20901
 20902     IF ERLOFC-FILE-STATUS NOT = '00'
 20903        MOVE 'N'                 TO LOFC-MASTER-SW
 20904     ELSE
 20905        MOVE 'Y'                 TO LOFC-MASTER-SW
 20906     END-IF
 20907
 20908     .
 20909 8586-EXIT.
 20910     EXIT.
 20911
 20912
 20913 8587-START-ERPDEF.
 20914
 20915     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 20916
 20917     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 20918     IF ERPDEF-FILE-STATUS NOT = '00'
 20919        MOVE 'N'                 TO PDEF-MASTER-SW
 20920     ELSE
 20921        MOVE 'Y'                 TO PDEF-MASTER-SW
 20922     END-IF
 20923
 20924
 20925     .
 20926 8587-EXIT.
 20927     EXIT.
 20928
 20929 8588-READ-ERPDEF.
 20930
 20931     READ ERPDEF NEXT RECORD
 20932
 20933     IF ERPDEF-FILE-STATUS NOT = '00'
 20934        MOVE 'N'                 TO PDEF-MASTER-SW
 20935     ELSE
 20936        MOVE 'Y'                 TO PDEF-MASTER-SW
 20937     END-IF
 20938
 20939     .
 20940 8588-EXIT.
 20941     EXIT.
 20942
 20943 8589-ENDBR-ERPDEF.
 20944
 20945     .
 20946 8589-EXIT.
 20947     EXIT.
 20948
 20949 8590-READ-CERT-MASTER.
 20950     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 20951     READ ELCERT.
 20952     ADD 1 TO RCER.
 20953
 20954     IF ELCERT-FILE-STATUS NOT = '00'
 20955         NEXT SENTENCE
 20956     ELSE
 20957         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 388
* EL517.cbl
 20958
 20959     MOVE '1'                     TO CERT-STATUS-SW.
 20960
 20961     IF PB-COMPANY-ID = 'UCL'
 20962         IF WS-ERROR = ER-2799
 20963             GO TO 8590-EXIT.
 20964
 20965     IF PB-CANCELLATION
 20966        MOVE ER-2726              TO  WS-ERROR
 20967        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 20968        IF ACCOUNT-MAST-FOUND
 20969           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 20970           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 20971           GO TO 8590-EXIT
 20972        ELSE
 20973           GO TO 8590-EXIT.
 20974
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 389
* EL517.cbl
 20976
 20977 8590-EXIT.
 20978     EXIT.
 20979
 20980 8750-START-ELSTAT.
 20981
 20982     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 20983
 20984     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 20985     IF ELSTAT-FILE-STATUS NOT = '00'
 20986        MOVE 'N'                 TO STAT-MASTER-SW
 20987     ELSE
 20988        MOVE 'Y'                 TO STAT-MASTER-SW
 20989     END-IF
 20990
 20991     .
 20992 8750-EXIT.
 20993     EXIT.
 20994
 20995 8752-READ-ELSTAT.
 20996
 20997     READ ELSTAT NEXT RECORD
 20998
 20999     IF ELSTAT-FILE-STATUS NOT = '00'
 21000        MOVE 'N'                 TO STAT-MASTER-SW
 21001     ELSE
 21002        MOVE 'Y'                 TO STAT-MASTER-SW
 21003     END-IF
 21004
 21005     .
 21006 8752-EXIT.
 21007     EXIT.
 21008
 21009 8800-GET-COMP-RATE.
 21010     MOVE +1 TO IB.
 21011     IF WS-COMM-CK-AMT > CT-TBF (1)
 21012         ADD +9 TO IB
 21013         IF WS-COMM-CK-AMT > CT-TBF (2)
 21014             ADD +9 TO IB
 21015             IF WS-COMM-CK-AMT > CT-TBF (3)
 21016                MOVE ZEROS       TO WS-WK-RATE
 21017                GO TO 8800-EXIT.
 21018
 21019     IF PB-I-AGE > CT-AGE (1)
 21020         ADD +3 TO IB
 21021         IF PB-I-AGE > CT-AGE (2)
 21022             ADD +3 TO IB
 21023             IF PB-I-AGE > CT-AGE (3)
 21024                MOVE ZEROS       TO WS-WK-RATE
 21025                GO TO 8800-EXIT.
 21026
 21027     IF WS-WORK-TERM > CT-TRM (1)
 21028         ADD +1 TO IB
 21029         IF WS-WORK-TERM > CT-TRM (2)
 21030             ADD +1 TO IB
 21031             IF WS-WORK-TERM > CT-TRM (3)
 21032                MOVE ZEROS       TO WS-WK-RATE
 21033                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 390
* EL517.cbl
 21034
 21035     IF CT-RT (IB) NOT NUMERIC
 21036         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21037         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21038         GO TO 8800-GET-COMP-RATE.
 21039
 21040     MOVE CT-RT (IB) TO WS-WK-RATE.
 21041
 21042 8800-EXIT.
 21043     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 391
* EL517.cbl
 21045
 21046 8900-ADDRESS-FILE.
 21047     EXIT.
 21048 8900-ADDRESS-EXIT.
 21049     EXIT.
 21050
 21051 9000-READ-CONTROL.
 21052     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21053     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21054
 21055     IF ELCNTL-FILE-STATUS NOT = '00'
 21056         GO TO 9000-NOTFND.
 21057
 21058     READ ELCNTL NEXT.
 21059     ADD 1 TO RCNT.
 21060
 21061     IF ELCNTL-FILE-STATUS NOT = '00'
 21062         GO TO 9000-NOTFND.
 21063
 21064     IF CNTL-REC-TYPE = '1'
 21065         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21066         MOVE 1            TO ELCNTL-POINTER.
 21067
 21068     IF CNTL-REC-TYPE = '6'
 21069         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21070         MOVE 6            TO ELCNTL-POINTER.
 21071
 21072     GO TO 9000-EXIT.
 21073
 21074 9000-NOTFND.
 21075     IF RC-SW-1 = '1'
 21076         MOVE ER-2616             TO WS-ERROR
 21077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21078         GO TO 9000-EXIT.
 21079
 21080     IF RC-SW-1 = '2'
 21081         MOVE ER-2602             TO WS-ERROR
 21082         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21083         GO TO 9000-EXIT.
 21084
 21085     GO TO 9000-EXIT.
 21086
 21087 9000-EXIT.
 21088     EXIT.
 21089      EXIT.
 21090
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 392
* EL517.cbl
 21092 9100-READ-CONTROL.
 21093     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21094     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21095
 21096     IF ELCNTL-FILE-STATUS NOT = '00'
 21097         GO TO 9100-NOTFND.
 21098
 21099     READ ELCNTL NEXT.
 21100     ADD 1 TO RCNT.
 21101
 21102     IF ELCNTL-FILE-STATUS NOT = '00'
 21103         GO TO 9100-NOTFND.
 21104
 21105     IF CNTL-REC-TYPE = '3'
 21106         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21107         MOVE 3            TO ELCNTL-POINTER
 21108         GO TO 9100-EXIT.
 21109
 21110     IF CNTL-REC-TYPE = '4'
 21111         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21112         MOVE 4            TO ELCNTL-POINTER
 21113         GO TO 9100-EXIT.
 21114
 21115     IF CNTL-REC-TYPE = '5'
 21116         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21117         MOVE 5            TO ELCNTL-POINTER
 21118         GO TO 9100-EXIT.
 21119
 21120     IF CNTL-REC-TYPE = 'L'
 21121         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21122         MOVE 10           TO ELCNTL-POINTER
 21123         GO TO 9100-EXIT.
 21124
 21125     IF CNTL-REC-TYPE = 'A'
 21126         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21127         MOVE 11           TO ELCNTL-POINTER
 21128         GO TO 9100-EXIT.
 21129
 21130 9100-NOTFND.
 21131     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21132
 21133     IF RC-SW-2 = '1'
 21134        MOVE '1'                 TO LF-BENEFIT-ERROR
 21135        MOVE ER-2604             TO WS-ERROR
 21136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21137        GO TO 9100-EXIT.
 21138
 21139     IF RC-SW-2 = '2'
 21140        MOVE '1'                 TO AH-BENEFIT-ERROR
 21141        MOVE ER-2605             TO WS-ERROR
 21142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21143        GO TO 9100-EXIT.
 21144
 21145     IF RC-SW-2 = '3'
 21146        MOVE ER-2603             TO WS-ERROR
 21147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21148        GO TO 9100-EXIT.
 21149
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 393
* EL517.cbl
 21150     IF RC-SW-2 = '4'
 21151         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21152         GO TO 9100-EXIT.
 21153
 21154     IF RC-SW-2 = '5'
 21155         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21156         IF WS-AH-INPUT-CD-1 = SPACE
 21157             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21158         ELSE
 21159             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21160
 21161 9100-EXIT.
 21162     EXIT.
 21163      EXIT.
 21164
 21165 9200-CONTROL-GETMAIN.
 21166*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21167     EXIT.
 21168 9200-EXIT.
 21169     EXIT.
 21170
 21171 9250-UNLOCK-RETURN.
 21172*  DUMMIED IN THE BATCH EL517 ....
 21173     EXIT.
 21174 9250-UNLOCK-EXIT.
 21175     EXIT.
 21176      EXIT.
 21177
 21178 9300-ACCUM-BATCH-TOTALS.
 21179         IF PB-ISSUE
 21180             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21181             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21182             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21183             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21184             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21185             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21186             ADD 1                       TO WS-ISSUE-CNT
 21187         ELSE
 21188             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21189             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21190             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21191             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21192             ADD 1                       TO WS-CANCEL-CNT.
 21193
 21194 9400-EXIT.
 21195     EXIT.
 21196
 21197 9990-RETURN.
 21198*    END BROUSE OF ACCOUNT FILE
 21199     EXIT.
 21200
 21201 9990-EXIT.
 21202     EXIT.
 21203
 21204
 21205****Check for CRTO record, add one if not found.
 21206 9991-CHECK-FOR-ELCRTO.
 21207     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 394
* EL517.cbl
 21208         OPEN I-O ELCRTO
 21209         MOVE 'X' TO ELCRTO-OPEN
 21210         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21211             NEXT SENTENCE
 21212         ELSE
 21213             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21214             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21215             MOVE EMSG               TO WS-ABEND-MESSAGE
 21216             GO TO ABEND-PGM
 21217         END-IF
 21218     END-IF.
 21219     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21220     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21221     MOVE +0                     TO ELCRTO-SEQ-NO
 21222     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21223
 21224     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21225
 21226     IF ELCRTO-FILE-STATUS NOT = '00'
 21227         GO TO 9991-CRTO-NOT-FOUND
 21228     END-IF.
 21229
 21230     READ ELCRTO NEXT.
 21231     IF ELCRTO-FILE-STATUS = '00'
 21232        AND (OC-CONTROL-PRIMARY (1:33) =
 21233                 PB-CONTROL-BY-ACCOUNT (1:33))
 21234        AND (OC-RECORD-TYPE = 'I')
 21235           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21236               GO TO 9991-EXIT
 21237           ELSE
 21238               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21239               GO TO 9991-CRTO-ADD-REC
 21240           END-IF
 21241     END-IF.
 21242
 21243 9991-CRTO-NOT-FOUND.
 21244
 21245     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21246     MOVE 'OC'                TO OC-RECORD-ID
 21247     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21248                              TO OC-CONTROL-PRIMARY (1:33)
 21249     MOVE +4096               TO OC-KEY-SEQ-NO.
 21250
 21251 9991-CRTO-ADD-REC.
 21252
 21253     MOVE 'E517'              TO OC-LAST-MAINT-BY
 21254     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21255     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21256     MOVE 'I'                 TO OC-RECORD-TYPE
 21257     IF PB-ISSUE
 21258         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21259         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21260         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21261         MOVE PB-I-AGE               TO OC-INS-AGE
 21262         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21263         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21264         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21265         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 395
* EL517.cbl
 21266         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21267         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21268         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21269         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21270         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21271         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21272         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21273         IF PB-I-JOINT-COMMISSION > +0
 21274             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21275         ELSE
 21276             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21277         END-IF
 21278         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21279         MOVE +0                     TO OC-LF-CANCEL-AMT
 21280                                        OC-LF-ITD-CANCEL-AMT
 21281         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21282         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21283         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21284         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21285         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21286         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21287         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21288         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21289         MOVE +0                     TO OC-AH-CANCEL-AMT
 21290                                        OC-AH-ITD-CANCEL-AMT
 21291         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21292     ELSE
 21293         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21294         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21295         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21296         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21297         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21298         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21299         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21300         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21301         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21302          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21303             MOVE SPACES             TO OC-LF-BENCD
 21304             MOVE ZEROS              TO OC-LF-TERM
 21305                                        OC-LF-BEN-AMT
 21306                                        OC-LF-PRM-AMT
 21307                                        OC-LF-ALT-BEN-AMT
 21308                                        OC-LF-ALT-PRM-AMT
 21309                                        OC-LF-COMM-PCT
 21310                                        OC-LF-CANCEL-AMT
 21311             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21312             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21313         ELSE
 21314             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21315             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21316             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21317             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21318             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21319             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21320             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21321             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21322             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21323             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 396
* EL517.cbl
 21324         END-IF
 21325         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21326         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21327          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21328             MOVE SPACES             TO OC-AH-BENCD
 21329             MOVE ZEROS              TO OC-AH-TERM
 21330                                        OC-AH-BEN-AMT
 21331                                        OC-AH-PRM-AMT
 21332                                        OC-AH-COMM-PCT
 21333                                        OC-AH-CANCEL-AMT
 21334                                        OC-AH-CP
 21335             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21336             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21337         ELSE
 21338             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21339             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21340             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21341             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21342             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21343             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21344             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21345             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21346             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21347         END-IF
 21348         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21349         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21350     END-IF
 21351     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21352
 21353     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21354     IF ERMAIL-FOUND = ' '
 21355         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21356     END-IF.
 21357
 21358     WRITE ORIGINAL-CERTIFICATE.
 21359
 21360 9991-EXIT.
 21361     EXIT.
 21362
 21363
 21364 9999-SET-PNDB-ERROR-FLAGS.
 21365
 21366     IF PB-BATCH-TRAILER
 21367        GO TO 9999-REWRITE-RECORD.
 21368
 21369     IF PB-COMMON-ERRORS = LOW-VALUES
 21370        GO TO 9999-SET-ERROR-FLAGS.
 21371
 21372 9999-FORMAT-ERRORS.
 21373
 21374     MOVE +0                     TO SUB1.
 21375
 21376 9999-ERROR-LOOP.
 21377
 21378     ADD +1                      TO SUB1.
 21379
 21380     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21381        GO TO 9999-SET-ERROR-FLAGS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 397
* EL517.cbl
 21382
 21383     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21384
 21385     READ ELCERR.
 21386
 21387     IF ELCERR-FILE-STATUS NOT = '00'
 21388        ADD +1                       TO EMI-FATAL-CTR
 21389        GO TO  9999-ERROR-LOOP.
 21390
*21391                                 COPY ELCERRPD.
 21392******************************************************************04/15/98
 21393*                                                                *ELCERRPD
 21394*                                                                *ELCERRPD
 21395*                            ELCERRPD                            *   LV002
 21396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21397*                            VMOD=2.005                          *   CL**2
 21398*                                                                *ELCERRPD
 21399*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21400*                                                                *ELCERRPD
 21401******************************************************************ELCERRPD
 21402                                                                  ELCERRPD
 21403     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21404         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21405                                                                  ELCERRPD
 21406     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21407                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21408        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21409            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21410                                                                  ELCERRPD
 21411     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21412        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21413            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21414                                                                  ELCERRPD
 21415     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21416        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21417            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21418                                                                  ELCERRPD
 21419     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21420        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21421            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21422                                                                  ELCERRPD
 21423     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21424        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21425            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21426                                                                  ELCERRPD
 21427     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21428        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21429            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21430                                                                  ELCERRPD
 21431     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21432        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21433            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21434                                                                  ELCERRPD
 21435     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21436        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21437            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21438                                                                  ELCERRPD
 21439     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 398
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21440        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21441            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21442                                                                  ELCERRPD
 21443     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21444        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21445            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21446                                                                  ELCERRPD
 21447     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21448             OR                                                   ELCERRPD
 21449         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21450                                                                  ELCERRPD
 21451         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21452             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21453                                                                  ELCERRPD
 21454     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21455         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
 21456             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21457
 21458     IF E-CLIENT-ID = CLIENT-DCC
 21459        IF EM-MESSAGE-NUMBER = 2719
 21460           MOVE 'W'              TO EM-ERROR-SEVERITY
 21461        END-IF
 21462     END-IF
 21463
 21464     .
 21465
 21466     IF EM-ERROR-SEVERITY = 'W'
 21467        ADD +1                   TO EMI-WARNING-CTR
 21468        GO TO  9999-ERROR-LOOP.
 21469
 21470     IF EM-ERROR-SEVERITY = 'F'
 21471        ADD +1                   TO EMI-FORCABLE-CTR
 21472        GO TO  9999-ERROR-LOOP.
 21473
 21474     IF EM-ERROR-SEVERITY = 'X'
 21475        ADD +1                   TO EMI-FATAL-CTR.
 21476
 21477     GO TO 9999-ERROR-LOOP.
 21478
 21479 9999-SET-ERROR-FLAGS.
 21480
 21481     IF EMI-FATAL-CTR NOT = ZEROS
 21482        MOVE 'X'                 TO PB-FATAL-FLAG
 21483        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21484
 21485     IF EMI-FORCABLE-CTR NOT = ZEROS
 21486        IF PB-ISSUE
 21487           IF PB-ISSUE-FORCE
 21488              MOVE 'F'           TO PB-FORCE-ER-CD
 21489             ELSE
 21490              MOVE 'X'           TO PB-FORCE-ER-CD
 21491          ELSE
 21492           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21493              MOVE 'F'           TO PB-FORCE-ER-CD
 21494             ELSE
 21495              MOVE 'X'           TO PB-FORCE-ER-CD.
 21496
 21497 9999-CONT-SET-ERROR-FLAGS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 399
* EL517.cbl
 21498
 21499     IF EMI-WARNING-CTR NOT = ZEROS
 21500        MOVE 'W'                 TO PB-WARN-ER-CD.
 21501
 21502     IF PB-UNFORCED-ERRORS OR
 21503        PB-FATAL-ERRORS    OR
 21504        PB-RECORD-ON-HOLD  OR
 21505        PB-RECORD-RETURNED
 21506*        OR
 21507*       PB-CANCELLATION
 21508          NEXT SENTENCE
 21509        ELSE
 21510          GO TO 9999-REWRITE-RECORD.
 21511
 21512     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21513     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
 21514     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21515     MOVE PB-SV-STATE            TO CERT-STATE.
 21516
 21517     READ ELCERT.
 21518
 21519     IF PB-ISSUE
 21520     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21521        GO TO 9999-REWRITE-CERT-MASTER.
 21522
 21523     IF PB-ISSUE
 21524        IF PB-RECORD-RETURNED
 21525            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21526        ELSE
 21527             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21528
 21529     IF PB-CANCELLATION
 21530        IF PB-RECORD-RETURNED
 21531            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 21532        ELSE
 21533            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 21534               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 21535            ELSE
 21536               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 21537
 21538 9999-REWRITE-CERT-MASTER.
 21539
 21540     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 21541        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 21542        GO TO 9999-REWRITE-RECORD.
 21543
 21544     REWRITE CERTIFICATE-MASTER.
 21545     ADD 1 TO WCER.
 21546
 21547 9999-REWRITE-RECORD.
 21548     IF NOT PB-BATCH-TRAILER
 21549         IF PB-ISSUE
 21550             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21551             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21552             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21553             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21554             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 21555             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 400
* EL517.cbl
 21556             ADD 1                   TO WS-ISSUE-CNT
 21557         ELSE
 21558             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 21559             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 21560             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 21561             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 21562             ADD 1                   TO WS-CANCEL-CNT
 21563     ELSE
 21564         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 21565         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 21566         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 21567         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 21568         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 21569         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 21570         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 21571         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
 21572         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 21573         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 21574         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 21575                                        WS-LF-ISS-ENTERED
 21576                                        WS-AH-ISS-COMPUTED
 21577                                        WS-AH-ISS-ENTERED
 21578                                        WS-LF-CAN-COMPUTED
 21579                                        WS-LF-CAN-ENTERED
 21580                                        WS-AH-CAN-COMPUTED
 21581                                        WS-AH-CAN-ENTERED
 21582                                        WS-ISSUE-CNT
 21583                                        WS-CANCEL-CNT
 21584         MOVE SPACE                  TO PB-FATAL-FLAG.
 21585
 21586     IF PB-BATCH-TRAILER
 21587         IF PB-B-LF-ISS-PRM-REMITTED =
 21588            PB-B-LF-ISS-PRM-ENTERED   AND
 21589            PB-B-LF-CAN-PRM-REMITTED =
 21590            PB-B-LF-CAN-PRM-ENTERED   AND
 21591            PB-B-AH-ISS-PRM-REMITTED =
 21592            PB-B-AH-ISS-PRM-ENTERED   AND
 21593            PB-B-AH-CAN-PRM-REMITTED =
 21594            PB-B-AH-CAN-PRM-ENTERED   AND
 21595            PB-B-ISSUE-CNT-REMITTED  =
 21596            PB-B-ISSUE-CNT-ENTERED    AND
 21597            PB-B-CANCEL-CNT-REMITTED =
 21598            PB-B-CANCEL-CNT-ENTERED
 21599             MOVE SPACE          TO PB-OUT-BAL-CD
 21600           ELSE
 21601             MOVE 'O'            TO PB-OUT-BAL-CD.
 21602
 21603     REWRITE PENDING-BUSINESS.
 21604
 21605     ADD 1 TO WPND.
 21606
 21607     GO TO 0100-READ-PENDING.
 21608
 21609 9999-EXIT.
 21610     EXIT.
 21611
 21612******************************************************************
 21613*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 401
* EL517.cbl
 21614*            E R R O R   F O R M A T   R O U T I N E             *
 21615*                                                                *
 21616******************************************************************
 21617
 21618 9900-ERROR-FORMAT.
 21619
 21620     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 21621                   PB-COMMON-ERROR (2)  OR
 21622                   PB-COMMON-ERROR (3)  OR
 21623                   PB-COMMON-ERROR (4)  OR
 21624                   PB-COMMON-ERROR (5)  OR
 21625                   PB-COMMON-ERROR (6)  OR
 21626                   PB-COMMON-ERROR (7)  OR
 21627                   PB-COMMON-ERROR (8)  OR
 21628                   PB-COMMON-ERROR (9)  OR
 21629                   PB-COMMON-ERROR (10)
 21630        GO TO 9900-EXIT.
 21631
 21632     IF PB-NO-OF-ERRORS = +10
 21633        GO TO 9900-EXIT.
 21634
 21635     ADD +1                      TO PB-NO-OF-ERRORS.
 21636     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21637                                       (PB-NO-OF-ERRORS).
 21638
 21639
 21640 9900-EXIT.
 21641     EXIT.
 21642
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 402
* EL517.cbl
 21644 9999-DONE.
 21645*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 21646
 21647     IF DTE-CLIENT NOT EQUAL 'DMD'
 21648          GO TO 9999-DONE-CONT.
 21649
 21650     CLOSE ERRESS
 21651           ERRESC.
 21652
 21653     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 21654     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 21655     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 21656     IF DMPF-RETURN-CODE EQUAL 'Z3'
 21657         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21658         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 21659         MOVE CMSG               TO WS-ABEND-MESSAGE
 21660         GO TO ABEND-PGM.
 21661
 21662     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 21663     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 21664     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 21665     IF DIPF-RETURN-CODE EQUAL 'Z3'
 21666         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21667         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 21668         MOVE CMSG               TO WS-ABEND-MESSAGE
 21669         GO TO ABEND-PGM.
 21670
 21671     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 21672     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 21673     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 21674     IF DIPF-RETURN-CODE EQUAL 'Z3'
 21675         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21676         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 21677         MOVE CMSG               TO WS-ABEND-MESSAGE
 21678         GO TO ABEND-PGM.
 21679
 21680     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 21681     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 21682     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 21683     IF DCUA-RETURN-CODE EQUAL 'Z3'
 21684         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21685         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 21686         MOVE CMSG               TO WS-ABEND-MESSAGE
 21687         GO TO ABEND-PGM.
 21688
 21689     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 21690     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 21691     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 21692     IF DPRB-RETURN-CODE EQUAL 'Z3'
 21693         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21694         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 21695         MOVE CMSG               TO WS-ABEND-MESSAGE
 21696         GO TO ABEND-PGM.
 21697
 21698     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 21699     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 21700     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 21701     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 403
* EL517.cbl
 21702         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21703         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 21704         MOVE CMSG               TO WS-ABEND-MESSAGE
 21705         GO TO ABEND-PGM.
 21706
 21707     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 21708     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 21709     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 21710     IF DVSC-RETURN-CODE EQUAL 'Z3'
 21711         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21712         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 21713         MOVE CMSG               TO WS-ABEND-MESSAGE
 21714         GO TO ABEND-PGM.
 21715
 21716*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 21717
 21718 9999-DONE-CONT.
 21719
 21720     IF ERPNDM-OPEN = 'X'
 21721        CLOSE ERPNDM.
 21722
 21723     IF ERMAIL-OPEN = 'X'
 21724        CLOSE ERMAIL.
 21725
 21726     IF ELMSTR-OPEN = 'X'
 21727        CLOSE ELMSTR.
 21728
 21729     IF ELCRTT-OPEN = 'X'
 21730        CLOSE ELCRTT
 21731     END-IF.
 21732
 21733     IF ELCRTO-OPEN = 'X'
 21734        CLOSE ELCRTO
 21735     END-IF.
 21736
 21737     CLOSE      ELCNTL
 21738                ELCERR
 21739                ERPNDB
 21740                ERREIN
 21741                ELCERT
 21742                ERCTBL
 21743                ERPLAN
 21744                ERACCT
 21745                ERBXRF
 21746                ERAGTC
 21747                ERCOMP.
 21748
 21749     IF DTE-CLIENT = 'DCC'
 21750        CLOSE ERPDEF ELSTAT
 21751        IF ERPDEF-FILE-STATUS NOT = '00'
 21752            MOVE ERPDEF-FILE-STATUS
 21753                                 TO WS-ABEND-FILE-STATUS
 21754            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 21755            MOVE CMSG            TO WS-ABEND-MESSAGE
 21756            GO TO ABEND-PGM
 21757        END-IF
 21758        IF ELSTAT-FILE-STATUS NOT = '00'
 21759            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 404
* EL517.cbl
 21760                                 TO WS-ABEND-FILE-STATUS
 21761            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 21762            MOVE CMSG            TO WS-ABEND-MESSAGE
 21763            GO TO ABEND-PGM
 21764        END-IF
 21765     END-IF
 21766
 21767     IF ELCNTL-FILE-STATUS NOT = '00'
 21768         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21769         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 21770         MOVE CMSG TO WS-ABEND-MESSAGE
 21771         GO TO ABEND-PGM.
 21772
 21773     IF ERPNDB-FILE-STATUS NOT = '00'
 21774         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21775         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 21776         MOVE CMSG TO WS-ABEND-MESSAGE
 21777         GO TO ABEND-PGM.
 21778
 21779     IF ERREIN-FILE-STATUS NOT = '00'
 21780         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21781         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 21782         MOVE CMSG TO WS-ABEND-MESSAGE
 21783         GO TO ABEND-PGM.
 21784
 21785     IF ELCERT-FILE-STATUS NOT = '00'
 21786         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21787         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 21788         MOVE CMSG TO WS-ABEND-MESSAGE
 21789         GO TO ABEND-PGM.
 21790
 21791     IF ERMAIL-OPEN   = 'X'
 21792       IF ERMAIL-FILE-STATUS NOT = '00'
 21793           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21794           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 21795           MOVE CMSG TO WS-ABEND-MESSAGE
 21796           GO TO ABEND-PGM.
 21797
 21798     IF ERPNDM-OPEN   = 'X'
 21799       IF ERPNDM-FILE-STATUS NOT = '00'
 21800            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21801            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 21802            MOVE CMSG TO WS-ABEND-MESSAGE
 21803            GO TO ABEND-PGM.
 21804
 21805     IF ELCRTT-OPEN = 'X'
 21806         IF ELCRTT-FILE-STATUS NOT = '00'
 21807             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21808             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 21809             MOVE CMSG TO WS-ABEND-MESSAGE
 21810             GO TO ABEND-PGM
 21811         END-IF
 21812     END-IF.
 21813
 21814     IF ELCRTO-OPEN = 'X'
 21815         IF ELCRTO-FILE-STATUS NOT = '00'
 21816             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21817             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 405
* EL517.cbl
 21818             MOVE CMSG TO WS-ABEND-MESSAGE
 21819             GO TO ABEND-PGM
 21820         END-IF
 21821     END-IF.
 21822
 21823     IF ERCTBL-FILE-STATUS NOT = '00'
 21824         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21825         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 21826         MOVE CMSG TO WS-ABEND-MESSAGE
 21827         GO TO ABEND-PGM.
 21828
 21829     IF ERPLAN-FILE-STATUS NOT = '00'
 21830        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 21831        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 21832        MOVE CMSG TO WS-ABEND-MESSAGE
 21833        GO TO ABEND-PGM.
 21834
 21835     IF ERACCT-FILE-STATUS NOT = '00'
 21836         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21837         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 21838         MOVE CMSG TO WS-ABEND-MESSAGE
 21839         GO TO ABEND-PGM.
 21840
 21841     IF ERCOMP-FILE-STATUS NOT = '00'
 21842         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21843         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 21844         MOVE CMSG TO WS-ABEND-MESSAGE
 21845         GO TO ABEND-PGM.
 21846
 21847     IF ERBXRF-FILE-STATUS NOT = '00'
 21848         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21849         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 21850         MOVE CMSG TO WS-ABEND-MESSAGE
 21851         GO TO ABEND-PGM.
 21852
 21853     IF ERAGTC-FILE-STATUS NOT = '00'
 21854         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21855         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 21856         MOVE CMSG TO WS-ABEND-MESSAGE
 21857         GO TO ABEND-PGM.
 21858
 21859     IF ELCERR-FILE-STATUS NOT = '00'
 21860         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21861         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 21862         MOVE CMSG TO WS-ABEND-MESSAGE
 21863         GO TO ABEND-PGM.
 21864
 21865     MOVE 'C'                     TO CP-IO-FUNCTION.
 21866     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 21867
 21868     IF IO-ERROR
 21869        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 21870        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 21871        MOVE CMSG                 TO WS-ABEND-MESSAGE
 21872        GO TO ABEND-PGM.
 21873
 21874     OPEN OUTPUT PRINT-FILE.
 21875
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 406
* EL517.cbl
 21876     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 21877     MOVE WS-CURRENT-DATE        TO H2-DATE.
 21878     MOVE ALPH-DATE              TO H3-DATE.
 21879     MOVE TRAN-CT                TO SUM-TOT.
 21880
 21881 7000-PRT-HDG.
 21882     MOVE HDG1 TO PRT   MOVE '1' TO X.
 21883     PERFORM 7000-PRINT-LINE.
 21884     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 21885     PERFORM 7000-PRINT-LINE.
 21886     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 21887     PERFORM 7000-PRINT-LINE.
 21888     MOVE SUM1 TO PRT   MOVE '0' TO X.
 21889     PERFORM 7000-PRINT-LINE.
 21890     GO TO 9999-END-JOB.
 21891
 21892 7000-HDG-XIT.
 21893     EXIT.
 21894
 21895 7000-PRINT-LINE.
*21896                     COPY ELCPRT2X.
 21897******************************************************************04/15/98
 21898*                                                                *ELCPRT2X
 21899*                                                                *ELCPRT2X
 21900*                            ELCPRT2X.                           *   LV002
 21901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21902*                            VMOD=2.002                          *   CL**2
 21903*                                                                *ELCPRT2X
 21904*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 21905*                                                                *ELCPRT2X
 21906*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 21907*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 21908*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 21909*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 21910*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 21911*                                                                *ELCPRT2X
 21912*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 21913*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 21914******************************************************************ELCPRT2X
 21915                                                                  ELCPRT2X
 21916     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 21917         FICH-OPEN   = SPACE                                      ELCPRT2X
 21918         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 21919         OPEN OUTPUT FICH.                                        ELCPRT2X
 21920                                                                  ELCPRT2X
 21921     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 21922         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 21923             OPEN I-O ELREPT                                      ELCPRT2X
 21924             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 21925                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 21926                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 21927                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 21928                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 21929                 GO TO ABEND-PGM                                  ELCPRT2X
 21930             ELSE                                                 ELCPRT2X
 21931                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 21932                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 21933                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 407
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 21934                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 21935                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 21936                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 21937                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 21938                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 21939                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 21940                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 21941                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 21942                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 21943                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 21944                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 21945                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 21946                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 21947                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 21948                                                                  ELCPRT2X
 21949     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 21950        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 21951         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 21952         GO TO ABEND-PGM.                                         ELCPRT2X
 21953                                                                  ELCPRT2X
 21954     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 21955         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 21956         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 21957             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 21958                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 21959                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 21960                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 21961                     INVALID KEY                                  ELCPRT2X
 21962                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 21963                         CLOSE ELREPT                             ELCPRT2X
 21964                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 21965                                                                  ELCPRT2X
 21966     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 21967         MOVE X                      TO  P-CTL                    ELCPRT2X
 21968         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 21969                                                                  ELCPRT2X
 21970     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 21971       MOVE X                        TO  P-CTL                    ELCPRT2X
 21972       IF P-CTL = ' '                                             ELCPRT2X
 21973         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 21974       ELSE                                                       ELCPRT2X
 21975         IF P-CTL = '0'                                           ELCPRT2X
 21976           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 21977         ELSE                                                     ELCPRT2X
 21978           IF P-CTL = '-'                                         ELCPRT2X
 21979             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 21980           ELSE                                                   ELCPRT2X
 21981             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 21982                                                                  ELCPRT2X
 21983     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 21984                                                                  ELCPRT2X
 21985 DTE-REPORT-DELETE.                                               ELCPRT2X
 21986     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 21987         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 21988         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 21989                                                                  ELCPRT2X
 21990     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 21991           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 408
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 21992                                                                  ELCPRT2X
 21993     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 21994        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 21995         DELETE ELREPT RECORD                                     ELCPRT2X
 21996         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 21997                                                                  ELCPRT2X
 21998 DTE-DELETE-EXIT.                                                 ELCPRT2X
 21999     EXIT.                                                        ELCPRT2X
 22000                                                                  ELCPRT2X
 22001 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22002     EXIT.                                                        ELCPRT2X
 22003******************************************************************ELCPRT2X
 22004
 22005 REIN-DATE-LOAD.
*22006     COPY ELCRENM1.
 22007******************************************************************04/15/98
 22008*                                                                *ELCRENM1
 22009*                                                                *ELCRENM1
 22010*                            ELCRENM1                            *   LV002
 22011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22012*                            VMOD=2.001                          *ELCRENM1
 22013*                                                                *ELCRENM1
 22014*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22015*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22016*                                                                *ELCRENM1
 22017******************************************************************ELCRENM1
 22018     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22019     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22020     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22021                                                                  ELCRENM1
 22022
 22023 7000-PRINT-LINE-XIT.
 22024      EXIT.
 22025
 22026 9999-END-JOB.
 22027     CLOSE PRINT-FILE.
*22028             COPY ELCPRTCX.
 22029******************************************************************04/15/98
 22030*                                                                *ELCPRTCX
 22031*                                                                *ELCPRTCX
 22032*                            ELCPRTCX.                           *   LV003
 22033*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22034*                            VMOD=2.003                          *   CL**3
 22035*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22036*                                                                *ELCPRTCX
 22037* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22038******************************************************************ELCPRTCX
 22039                                                                  ELCPRTCX
 22040      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22041          CLOSE FICH.                                             ELCPRTCX
 22042                                                                  ELCPRTCX
 22043      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22044          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22045          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22046          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22047          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22048          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22049          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 409
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22050          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22051          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22052              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22053              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22054              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22055                  UPON CONSOLE                                    ELCPRTCX
 22056              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22057                  UPON CONSOLE                                    ELCPRTCX
 22058            ELSE                                                  ELCPRTCX
 22059              DISPLAY '***************************************'   ELCPRTCX
 22060              DISPLAY '***************************************'   ELCPRTCX
 22061              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22062              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22063              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22064              DISPLAY '**                                   **'   ELCPRTCX
 22065              DISPLAY '***************************************'   ELCPRTCX
 22066              DISPLAY '***************************************'   ELCPRTCX
 22067              CLOSE ELREPT.                                       ELCPRTCX
 22068                                                                  ELCPRTCX
 22069      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22070          DISPLAY '***************************************'       ELCPRTCX
 22071          DISPLAY '***************************************'       ELCPRTCX
 22072          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22073          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22074          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22075          DISPLAY '**                                   **'       ELCPRTCX
 22076          DISPLAY '***************************************'       ELCPRTCX
 22077          DISPLAY '***************************************'       ELCPRTCX
 22078          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22079                                                                  ELCPRTCX
 22080      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22081          DISPLAY '***************************************'       ELCPRTCX
 22082          DISPLAY '***************************************'       ELCPRTCX
 22083          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22084          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22085          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22086          DISPLAY '**                                   **'       ELCPRTCX
 22087          DISPLAY '***************************************'       ELCPRTCX
 22088          DISPLAY '***************************************'       ELCPRTCX
 22089          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22090                                                                  ELCPRTCX
 22091                                                                  ELCPRTCX
 22092******************************************************************ELCPRTCX
 22093
 22094     GOBACK.
 22095
 22096 ABEND-PGM.
*                   COPY ELCABEND.
 22097***************************************************************** 04/14/98
 22098*                                                               * ELCABEND
 22099*                            ELCABEND.                          *    LV003
 22100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22101*                            VMOD 2.002                              CL**2
 22102*                                                               * ELCABEND
 22103*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22104*            AND THEN ABENDS.                                   * ELCABEND
 22105*                                                               * ELCABEND
 22106*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 410
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22107*                                                               * ELCABEND
 22108***************************************************************** ELCABEND
 22109*APS-010.                                                         ELCABEND
 22110     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22111     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22112                                                                  ELCABEND
 22113     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22114         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22115         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22116                                 UPON CONSOLE.                    ELCABEND
 22117                                                                  ELCABEND
 22118     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22119         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22120         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22121                                 UPON CONSOLE.                    ELCABEND
 22122                                                                  ELCABEND
 22123     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22124     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22125                                 UPON CONSOLE.                    ELCABEND
 22126                                                                  ELCABEND
 22127     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22128     CALL 'ABORTME'.
 22129                                                                  ELCABEND
 22130 APS-EXIT.                                                        ELCABEND
 22131     EXIT.                                                        ELCABEND
 22132
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116632     Code:       89644
