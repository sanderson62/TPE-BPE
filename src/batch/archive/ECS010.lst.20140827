* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    84* 051314  CR2014042900001  PEMA  ADD ACCT 1107201 TO FPB
    85* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    86* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
    87* 071614  CR2014070000000  PEMA  REMOVE ROUNDING FOR AHL
    88******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   4
* ECS010.cbl
    90 ENVIRONMENT DIVISION.
    91 CONFIGURATION SECTION.
    92 SPECIAL-NAMES.
    93     C02 IS LCP-CH2
    94     C03 IS LCP-CH3
    95     C04 IS LCP-CH4
    96     C05 IS LCP-CH5
    97     C06 IS LCP-CH6
    98     C07 IS LCP-CH7
    99     C08 IS LCP-CH8
   100     C09 IS LCP-CH9
   101     C10 IS LCP-CH10
   102     C11 IS LCP-CH11
   103     C12 IS LCP-CH12
   104     S01 IS LCP-P01
   105     S02 IS LCP-P02.
   106
   107 INPUT-OUTPUT SECTION.
   108 FILE-CONTROL.
   109
   110     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   111
   112     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   113
   114     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   115                             ACCESS IS SEQUENTIAL
   116                             ORGANIZATION IS INDEXED
   117                             FILE STATUS IS ERACCTT-FILE-STATUS
   118                             RECORD KEY IS AM-CONTROL-PRIMARY.
   119
   120     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   121                             ACCESS IS DYNAMIC
   122                             ORGANIZATION IS INDEXED
   123                             FILE STATUS IS ERRTBL-FILE-STATUS
   124                             RECORD KEY IS RE-CONTROL-PRIMARY.
   125
   126     SELECT ERCTBL           ASSIGN TO ERCTBLT
   127                             ACCESS IS DYNAMIC
   128                             ORGANIZATION IS INDEXED
   129                             FILE STATUS IS ERCTBL-FILE-STATUS
   130                             RECORD KEY IS CT-CONTROL-PRIMARY.
   131
   132     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   133                             ORGANIZATION INDEXED
   134                             ACCESS DYNAMIC
   135                             RECORD KEY ME-CONTROL-PRIMARY
   136                             FILE STATUS ERMEBL-FILE-STATUS.
   137
   138     SELECT ERRESC-IN        ASSIGN TO ERRESC
   139                             ORGANIZATION IS INDEXED
   140                             ACCESS IS DYNAMIC
   141                             RECORD KEY IS ERRESC-RECORD-KEY
   142                             FILE STATUS IS ERRESC-FILE-STATUS.
   143
   144     SELECT ELCRTT           ASSIGN TO ELCRTT
   145                             ACCESS IS DYNAMIC
   146                             ORGANIZATION IS INDEXED
   147                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   5
* ECS010.cbl
   148                             RECORD KEY IS CS-CONTROL-PRIMARY.
   149
   150     SELECT ERAGTC           ASSIGN TO ERAGTC
   151                             ACCESS IS DYNAMIC
   152                             ORGANIZATION IS INDEXED
   153                             FILE STATUS IS ERAGTC-FILE-STATUS
   154                             RECORD KEY IS AG-CONTROL-PRIMARY.
   155
   156     SELECT ERPDEF           ASSIGN TO ERPDEF
   157                             ACCESS IS DYNAMIC
   158                             ORGANIZATION IS INDEXED
   159                             FILE STATUS IS ERPDEF-FILE-STATUS
   160                             RECORD KEY IS PD-CONTROL-PRIMARY.
   161
   162     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   163
   164     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   165
   166     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   167
   168     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   169
   170
   171     SELECT ME-ECS010-BALANCE
   172                             ASSIGN TO SYS012
   173                             ORGANIZATION IS LINE SEQUENTIAL.
   174
   175     SELECT ME50-ECS010-BALANCE
   176                             ASSIGN TO SYS013
   177                             ORGANIZATION IS LINE SEQUENTIAL.
   178
   179     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   180
   181     SELECT DISK-DATE        ASSIGN TO SYS019.
   182
   183     SELECT PRINT-COPY       ASSIGN TO SYS008.
   184
   185     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   186
   187     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   6
* ECS010.cbl
   189 DATA DIVISION.
   190 FILE SECTION.
   191
   192 FD  PENDING-EXTRACT
   193     BLOCK CONTAINS 0 RECORDS
   194     RECORDING MODE F.
   195
*  196                             COPY ERCEXTD.
   197******************************************************************04/29/98
   198*                                                                *ERCEXTD
   199*                                                                *ERCEXTD
   200*                            ERCEXTD                             *   LV002
   201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   202*                            VMOD=2.002                          *   CL**2
   203*                                                                *ERCEXTD
   204*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   205*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   206*                                                                *ERCEXTD
   207*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   208*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   209*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   210*                                                                *ERCEXTD
   211*         RECORD                                                 *ERCEXTD
   212*          TYPE          PROGRAM USING                           *ERCEXTD
   213*        --------        --------------------------------        *ERCEXTD
   214*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   215*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   216*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   217*                                                                *ERCEXTD
   218* -------------------------------------------------------------- *ERCEXTD
   219*                                                                *ERCEXTD
   220*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   221*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   222*                                                                *ERCEXTD
   223*   FILENAME = EREXTD                                            *ERCEXTD
   224*                                                                *ERCEXTD
   225******************************************************************ERCEXTD
   226                                                                  ERCEXTD
   227 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   228     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   229         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   230                                                                  ERCEXTD
   231     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   232         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   233         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   234         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   235                                                                  ERCEXTD
   236     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   237                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   7
* ECS010.cbl
   239 FD  CERT-MASTER-IN
*  240                             COPY ECSCRIFD.
   241******************************************************************07/10/97
   242*                                                                *ECSCRIFD
   243*                            ECSCRIFD                            *   LV001
   244*                            VMOD 2.005                          *ECSCRIFD
   245*                                                                *ECSCRIFD
   246*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   247*                                                                *ECSCRIFD
   248******************************************************************ECSCRIFD
   249     BLOCK CONTAINS 0 RECORDS
   250     RECORDING MODE F.                                            ECSCRIFD
   251                                                                  ECSCRIFD
   252 01  CERT-IN-RECORD.                                              ECSCRIFD
   253                                                                  ECSCRIFD
   254     12  FILLER                            PIC XXX.               ECSCRIFD
   255     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   256     12  FILLER                            PIC X(66).             ECSCRIFD
   257     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   258     12  FILLER                            PIC X(20).             ECSCRIFD
   259     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   260     12  FILLER                            PIC X(14).             ECSCRIFD
   261     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   262     12  FILLER                            PIC X(39).             ECSCRIFD
   263     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   264     12  FILLER                            PIC X(45).             ECSCRIFD
   265     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   266     12  FILLER                            PIC X(35).             ECSCRIFD
   267     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   268     12  FILLER                            PIC X(41).             ECSCRIFD
   269     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   270     12  FILLER                            PIC X(48).             ECSCRIFD
   271     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   272     12  FILLER                            PIC X(9).              ECSCRIFD
   273     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   274     12  FILLER                            PIC X(120).            ECSCRIFD
   275     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   276     12  FILLER                            PIC X(73).             ECSCRIFD
   277     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   278     12  FILLER                            PIC X(464).            ECSCRIFD
   279                                                                  ECSCRIFD
   280******************************************************************ECSCRIFD
   281
   282 01  CI-RECORD.
   283     12  FILLER          PIC  X(03).
   284     12  CI-ACCOUNT-CONTROL.
   285         16  CI-CARRIER      PIC  X(01).
   286         16  CI-GROUPING     PIC  X(06).
   287         16  CI-STATE        PIC  X(02).
   288         16  CI-ACCOUNT      PIC  X(10).
   289     12  FILLER          PIC  X(06).
   290     12  CI-CERT-NO.
   291         16  CI-CERT     PIC X(10).
   292         16  CI-CERT-SFX PIC X.
   293     12  FILLER          PIC  X(1017).
   294
   295******************************************************
   296*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   8
* ECS010.cbl
   297*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   298*   COMMERCIAL FEDERAL BANK
   299******************************************************
   300 01  CF-RECORD.
   301     12  FILLER          PIC X(759).
   302     12  CF-THIRD-AGENT  PIC X(10).
   303     12  FILLER          PIC X(7).
   304     12  CF-FOURTH-AGENT PIC X(10).
   305     12  FILLER          PIC X(270).
   306
   307******************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page   9
* ECS010.cbl
   309 FD  ERACCTT-IN.
   310
*  311                             COPY ERCACCT.
   312******************************************************************04/19/98
   313*                                                                *ERCACCT
   314*                                                                *ERCACCT
   315*                            ERCACCT                             *   LV031
   316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   317*                            VMOD=2.031                          *ERCACCT
   318*                                                                *ERCACCT
   319*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   320*                                                                *ERCACCT
   321*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   322*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   323*                                                                *ERCACCT
   324*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   325*                                                                *ERCACCT
   326*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   327*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   328*                                                                *ERCACCT
   329*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   330*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   331*                                                                *ERCACCT
   332*   LOG = NO                                                     *ERCACCT
   333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   334*                                                                *ERCACCT
   335*                                                                *ERCACCT
   336******************************************************************ERCACCT
   337*                   C H A N G E   L O G
   338*
   339* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   340*-----------------------------------------------------------------
   341*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   342* EFFECTIVE    NUMBER
   343*-----------------------------------------------------------------
   344* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   345* 092705    2005050300006  PEMA  ADD SPP LEASES
   346* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   347* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   348* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   349* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   350* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   351******************************************************************
   352                                                                  ERCACCT
   353 01  ACCOUNT-MASTER.                                              ERCACCT
   354     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   355         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   356                                                                  ERCACCT
   357     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   358         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   359         16  AM-MSTR-CNTRL.                                       ERCACCT
   360             20  AM-CONTROL-A.                                    ERCACCT
   361                 24  AM-CARRIER            PIC X.                 ERCACCT
   362                 24  AM-GROUPING.                                 ERCACCT
   363                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   364                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   365                 24  AM-STATE              PIC XX.                ERCACCT
   366                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   367                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   368                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   369             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   370                                           PIC X(19).             ERCACCT
   371             20  AM-CNTRL-B.                                      ERCACCT
   372                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   373                 24  FILLER                PIC X(4).              ERCACCT
   374             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   375                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   376                                                                  ERCACCT
   377     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   378         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   379         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   380         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   381         16  AM-VG-STATE                   PIC XX.                ERCACCT
   382         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   383         16  AM-VG-DATE.                                          ERCACCT
   384             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   385             20  FILLER                    PIC X(4).              ERCACCT
   386         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   387                                           PIC 9(11)      COMP-3. ERCACCT
   388     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   389         16  FILLER                        PIC X(10).
   390         16  AM-VG-KEY3.
   391             20  AM-VG3-ACCOUNT            PIC X(10).
   392             20  AM-VG3-EXP-DT             PIC XX.
   393         16  FILLER                        PIC X(4).
   394     12  AM-MAINT-INFORMATION.                                    ERCACCT
   395         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   396         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   397         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   398         16  FILLER                        PIC XX.                ERCACCT
   399                                                                  ERCACCT
   400     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   401     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   402                                                                  ERCACCT
   403     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   404         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   405         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   406                                                                  ERCACCT
   407     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   408     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   409                                                                  ERCACCT
   410     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   411     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   412                                                                  ERCACCT
   413     12  AM-NAME                           PIC X(30).             ERCACCT
   414     12  AM-PERSON                         PIC X(30).             ERCACCT
   415     12  AM-ADDRS                          PIC X(30).             ERCACCT
   416     12  AM-CITY.
   417         16  AM-ADDR-CITY                  PIC X(28).
   418         16  AM-ADDR-STATE                 PIC XX.
   419     12  AM-ZIP.                                                  ERCACCT
   420         16  AM-ZIP-PRIME.                                        ERCACCT
   421             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   422                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   423             20  FILLER                    PIC X(4).              ERCACCT
   424         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   425     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   426         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   427         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   428         16  FILLER                        PIC XXX.               ERCACCT
   429     12  AM-TEL-NO.                                               ERCACCT
   430         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   431         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   432         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   433     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   434         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   435         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   436                                                                  ERCACCT
   437     12  AM-COMM-STRUCTURE.                                       ERCACCT
   438         16  AM-DEFN-1.                                           ERCACCT
   439             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   440                 24  AM-AGT.                                      ERCACCT
   441                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   442                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   443                 24  AM-COM-TYP            PIC X.                 ERCACCT
   444                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   445                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   446                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   447                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   448                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   449                 24  AM-GL-CODES           PIC X.                 ERCACCT
   450                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   451                 24  FILLER                PIC X(01).             ERCACCT
   452         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   453             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   454                 24  FILLER                PIC X(11).             ERCACCT
   455                 24  AM-L-COMA             PIC XXX.               ERCACCT
   456                 24  AM-J-COMA             PIC XXX.               ERCACCT
   457                 24  AM-A-COMA             PIC XXX.               ERCACCT
   458                 24  FILLER                PIC X(6).              ERCACCT
   459                                                                  ERCACCT
   460     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   461         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   462                                                                  ERCACCT
   463     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   464                                                                  ERCACCT
   465     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   466         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   467         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   468     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   469         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   470         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   471     12  AM-GPCD                           PIC 99.                ERCACCT
   472     12  AM-IG                             PIC X.                 ERCACCT
   473         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   474         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   475     12  AM-STATUS                         PIC X.                 ERCACCT
   476         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   477         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   478         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   479         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   480         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   481         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   482     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   483     12  AM-ID-NO                          PIC X(11).             ERCACCT
   484                                                                  ERCACCT
   485     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   486     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   487     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   488     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   489     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   490     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   491     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   492     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   493     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   494                                                                  ERCACCT
   495     12  AM-USER-FIELDS.                                          ERCACCT
   496         16  AM-FLD-1                      PIC XX.                ERCACCT
   497         16  AM-FLD-2                      PIC XX.                ERCACCT
   498         16  AM-FLD-3                      PIC XX.                ERCACCT
   499         16  AM-FLD-4                      PIC XX.                ERCACCT
   500         16  AM-FLD-5                      PIC XX.                ERCACCT
   501                                                                  ERCACCT
   502     12  AM-1ST-PROD-DATE.                                        ERCACCT
   503         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   504         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   505         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   506     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   507     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   508         16  AM-PUR-YR                     PIC XX.                ERCACCT
   509         16  AM-PUR-MO                     PIC XX.                ERCACCT
   510         16  AM-PUR-DA                     PIC XX.                ERCACCT
   511     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   512     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   513     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   514     12  AM-INACTIVE-DATE.                                        ERCACCT
   515         16  AM-INA-MO                     PIC 99.                ERCACCT
   516         16  AM-INA-DA                     PIC 99.                ERCACCT
   517         16  AM-INA-YR                     PIC 99.                ERCACCT
   518     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   519                                                                  ERCACCT
   520     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   521     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   522                                                                  ERCACCT
   523     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   524         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   525         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   526         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   527         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   528                                                                  ERCACCT
   529     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   530         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   531         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   532                                                                  ERCACCT
   533     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   534                                                                  ERCACCT
   535     12  AM-OVER-SHORT.                                           ERCACCT
   536         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   537         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   538                                                                  ERCACCT
   539     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   540     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   541                                                                  ERCACCT
   542     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   543     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   544                                                                  ERCACCT
   545     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   546     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   547     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   548     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   549     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   550     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   551     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   552     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   553     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   554     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   555     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   556     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   557     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   558     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   559     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   560     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   561                                                                  ERCACCT
   562     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   563                                                                  ERCACCT
   564     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   565     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   566                                                                  ERCACCT
   567     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   568     12  AM-EARN-METHODS.                                         ERCACCT
   569         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   570             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   571             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   572             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   573             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   574         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   575             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   576             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   577             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   578             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   579         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   580             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   581             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   582             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   583             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   584             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   585             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   586                                                                  ERCACCT
   587     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   588     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   589     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   590                                                                  ERCACCT
   591     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   592     12  AM-RET-P-E                        PIC X.                 ERCACCT
   593     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   594     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   595     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   596     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   597         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   598         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   599     12  AM-RETRO-EARNINGS.                                       ERCACCT
   600         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   601         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   602         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   603     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   604         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   605         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   606     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   607         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   608         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   609         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   610     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   611     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   612                                                                  ERCACCT
   613     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   614         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   615         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   616         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   617         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   618         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   619                                                                  ERCACCT
   620     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   621                                                                  ERCACCT
   622     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   623                                                                  ERCACCT
   624     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   625         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   626                                                                  ERCACCT
   627     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   628         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   629         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   630                                                                  ERCACCT
   631     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   632         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   633                                                                  ERCACCT
   634     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   635         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   636         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   637                                                                  ERCACCT
   638     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   639                                                                  ERCACCT
   640     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   641     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   642     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   643     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   644     12  AM-DCC-UEF-STATE                  PIC XX.
   645     12  FILLER                            PIC XXX.
   646     12  AM-REPORT-CODE-3                  PIC X(10).
   647*    12  FILLER                            PIC X(22).             ERCACCT
   648                                                                  ERCACCT
   649     12  AM-RESERVE-DATE.                                         ERCACCT
   650         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   651         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   652         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   653                                                                  ERCACCT
   654     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   655     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   656         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   657         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   658         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   659         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   660                                                                  ERCACCT
   661     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   662         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   663         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   664         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   665         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   666                                                                  ERCACCT
   667     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   668         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   669             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   670             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   671             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   672             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   673             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   674             20  FILLER                    PIC XX.                ERCACCT
   675         16  FILLER                        PIC X(80).             ERCACCT
   676                                                                  ERCACCT
   677     12  AM-TRANSFER-DATA.                                        ERCACCT
   678         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   679             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   680             20  AM-TRNFROM-GROUPING.                             ERCACCT
   681                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   682                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   683             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   684             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   685                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   686                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   687             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   688         16  AM-TRANSFERRED-TO.                                   ERCACCT
   689             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   690             20  AM-TRNTO-GROUPING.                               ERCACCT
   691                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   692                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   693             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   694             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   695                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   696                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   697             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   698         16  FILLER                        PIC X(10).             ERCACCT
   699                                                                  ERCACCT
   700     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   701                                                                  ERCACCT
   702     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   703         16  AM-DEFN-1-SAVED.                                     ERCACCT
   704             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   705                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   706                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   707                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   708                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   709                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   710                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   711                 24  FILLER                PIC X.                 ERCACCT
   712                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   713                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   714                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   715         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   716             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   717                 24  FILLER                PIC X(11).             ERCACCT
   718                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   719                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   720                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   721                 24  FILLER                PIC X(6).              ERCACCT
   722                                                                  ERCACCT
   723     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   724         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   725            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   726            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   727            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   728                                                                  ERCACCT
   729     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   730     12  FILLER                            PIC X(120).            ERCACCT
   731                                                                  ERCACCT
   732     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   733         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   734         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   735             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   736             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   737                                                          COMP-3. ERCACCT
   738             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   739                                                          COMP-3. ERCACCT
   740         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   741             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   742             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   743                                                          COMP-3. ERCACCT
   744             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   745                                                          COMP-3. ERCACCT
   746                                                                  ERCACCT
   747     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   748         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   749         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   750         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   751         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   752             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   753                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   754                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   755             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   756                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   757                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   758             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   759                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   760                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   761         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   762             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   763                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   764                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   765                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   766             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   767                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   768                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   769             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   770                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   771                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   772                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   773     12  AM-COMMENTS.                                             ERCACCT
   774         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   775                                                                  ERCACCT
   776     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   777         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   778         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   779         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   780         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   781         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   782             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   783             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   784             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   785             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   786         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   787             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   788             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   789             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   790         16  FILLER                        PIC X(102).            ERCACCT
   791                                                                  ERCACCT
   792     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   793         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   794             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   795             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   796             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   797             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   798             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   799         16  FILLER                          PIC X(10).           ERCACCT
   800******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  18
* ECS010.cbl
   802 FD  ERRTBL-IN.
   803
*  804                             COPY ERCREIN.
   805******************************************************************07/27/93
   806*                                                                *ERCREIN
   807*                            ERCREIN                             *   LV009
   808*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   809*                            VMOD=2.010                          *   CL**9
   810*                                                                *ERCREIN
   811*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   812*                                                                *ERCREIN
   813*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   814*                                                                *ERCREIN
   815*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   816*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   817*                                                                *ERCREIN
   818*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   819*       ALTERNATE PATH = NONE                                    *ERCREIN
   820*                                                                *ERCREIN
   821*   LOG = NO                                                     *ERCREIN
   822*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   823*                                                                *ERCREIN
   824******************************************************************ERCREIN
   825*                   C H A N G E   L O G
   826*
   827* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   828*-----------------------------------------------------------------
   829*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   830* EFFECTIVE    NUMBER
   831*-----------------------------------------------------------------
   832* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   833* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   834******************************************************************
   835 01  REINSURANCE-RECORD.                                          ERCREIN
   836     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   837         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   838                                                                  ERCREIN
   839     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   840         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   841         16  RE-KEY.                                              ERCREIN
   842             20  RE-CODE                   PIC X.                 ERCREIN
   843                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   844                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   845             20  RE-TABLE                  PIC XXX.               ERCREIN
   846             20  FILLER                    PIC XXX.               ERCREIN
   847         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   848             20  FILLER                    PIC X.                 ERCREIN
   849             20  RE-COMPANY.                                      ERCREIN
   850                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   851                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   852                                                                  ERCREIN
   853     12  RE-MAINT-INFORMATION.                                    ERCREIN
   854         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   855         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   856         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   857         16  FILLER                        PIC X(10).             ERCREIN
   858                                                                  ERCREIN
   859     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   860         16  RE-100-COMP                   PIC 99.                ERCREIN
   861                                                                  ERCREIN
   862         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   863             20  RE-REI-COMP-NO.                                  ERCREIN
   864                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   865                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   866             20  RE-LF-QC                  PIC X.                 ERCREIN
   867             20  RE-AH-QC                  PIC X.                 ERCREIN
   868             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   869             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   870             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   871             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   872             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   873             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   874             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   875             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   876             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   877             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   878             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   879             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   880             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   881             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   882             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   883             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   884             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   888             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   889             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   890             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   891             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   892             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   893             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   894             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   895             20  RE-REMAINING              PIC X.                 ERCREIN
   896             20  RE-LF-RUNOFF-SW           PIC X.                      000
   897             20  RE-AH-RUNOFF-SW           PIC X.                      000
   898             20  FILLER                    PIC X(19).                  000
   899                                                                  ERCREIN
   900         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   901         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   902         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   903         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   904             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   905                                                                  ERCREIN
   906         16  FILLER                        PIC X(27).             ERCREIN
   907                                                                  ERCREIN
   908     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   909         16  RE-NAME                       PIC X(30).             ERCREIN
   910         16  RE-LF-PE                      PIC X.                 ERCREIN
   911         16  RE-AH-PE                      PIC X.                 ERCREIN
   912         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   913         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   914         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   915         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   916         16  RE-PRT-ST                     PIC X.                 ERCREIN
   917         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   918         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   919         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   920         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   921         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   922         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   923         16  RE-LF-COMM                    PIC X.                 ERCREIN
   924         16  RE-AH-COMM                    PIC X.                 ERCREIN
   925         16  RE-LF-TAX                     PIC X.                 ERCREIN
   926         16  RE-AH-TAX                     PIC X.                 ERCREIN
   927         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   928         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   929         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   930                                                                  ERCREIN
   931         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   932             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   933                                                                  ERCREIN
   934         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   935             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   936                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   937                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   938                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   939                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   940             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   941                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   942                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   943                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   944                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   945                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   946                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   947                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   948                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   949             20  FILLER                    PIC XXX.               ERCREIN
   950             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   951                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   952                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   953                                                                  ERCREIN
   954         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   955             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   956                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   957                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   958                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   959                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   960             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   961                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   962                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   963                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   964                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   965                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   966                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   967                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   968                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   969             20  FILLER                    PIC XXX.               ERCREIN
   970             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   971                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   972                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   973                                                                  ERCREIN
   974         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   975                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   976         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   977                                                                  ERCREIN
   978         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   979         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   980         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   981         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   982         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   983         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   984         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   985         16  RE-MORT-SW                    PIC X.                 ERCREIN
   986         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   987             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   988             88  RE-CEDED                          VALUE 'C'.        CL**2
   989             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   990             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   991                                                                  ERCREIN
   992         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   993             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   994         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   995             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   996         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   997             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   998         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   999             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  1000         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  1001             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  1002                                                                     CL**3
  1003         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1004                                                                     CL**5
  1005         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1006                                                                     CL**8
  1007         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1008                                                                     CL**8
  1009         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1010                                                                     CL**9
  1011         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1012             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1013             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1014
  1015         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1016             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1017                                                                     CL**9
  1018         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1019         16  FILLER                        PIC X(2281).              CL**9
  1020                                                                  ERCREIN
  1021         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1022                                                                  ERCREIN
  1023******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  22
* ECS010.cbl
  1025 FD  ERCTBL.
  1026
* 1027                             COPY ERCCTBL.
  1028******************************************************************04/29/98
  1029*                                                                *ERCCTBL
  1030*                                                                *ERCCTBL
  1031*                            ERCCTBL                             *   LV002
  1032*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1033*                            VMOD=2.003                              CL**2
  1034*                                                                *ERCCTBL
  1035*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1036*                                                                *ERCCTBL
  1037*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1038*                                                                *ERCCTBL
  1039*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1040*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1041*                                                                *ERCCTBL
  1042*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1043*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1044*                                                                *ERCCTBL
  1045*   LOG = NO                                                     *ERCCTBL
  1046*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1047*                                                                *ERCCTBL
  1048*                                                                *ERCCTBL
  1049******************************************************************ERCCTBL
  1050                                                                  ERCCTBL
  1051 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1052     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1053         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1054                                                                  ERCCTBL
  1055     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1056         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1057         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1058         16  CT-CNTRL-2.                                          ERCCTBL
  1059             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1060             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1061                                                                  ERCCTBL
  1062     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1063         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1064         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1065         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1066         16  FILLER                        PIC X(31).             ERCCTBL
  1067                                                                  ERCCTBL
  1068     12  CT-LIMITS.                                               ERCCTBL
  1069         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1070                                                                  ERCCTBL
  1071         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1072                                                                  ERCCTBL
  1073         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1074                                                                  ERCCTBL
  1075     12  CT-RATES.                                                ERCCTBL
  1076         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1077             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1078             20  CT-RT-R   REDEFINES                              ERCCTBL
  1079                 CT-RT                     PIC XXX.               ERCCTBL
  1080                                                                  ERCCTBL
  1081     12  FILLER                            PIC  X(42).            ERCCTBL
  1082                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  23
* ECS010.cbl
  1083******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  24
* ECS010.cbl
  1085 FD  ERMEBL-INOUT.
  1086
* 1087                             COPY ERCMEBL.
  1088******************************************************************04/29/98
  1089*                                                                 ERCMEBL
  1090*                                                                 ERCMEBL
  1091*                            ERCMEBL                             *   LV004
  1092*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1093*                            VMOD 2.004                          *   CL**2
  1094*                                                                *ERCMEBL
  1095*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1096*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1097*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1098*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1099*                                                                *ERCMEBL
  1100*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1101*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1102*                                                                *ERCMEBL
  1103*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1104*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1105*                                                                *ERCMEBL
  1106******************************************************************ERCMEBL
  1107                                                                  ERCMEBL
  1108 01  MONTH-END-BALANCES.                                          ERCMEBL
  1109     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1110     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1111         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1112         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1113     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1118     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1119     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1120     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1121     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1122     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1123     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1124     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1125     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1126     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1127     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1128     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1129     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1130     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1131     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1132     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1133     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1134     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1135     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1136     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1137     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1138     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1140     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1141     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1142     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1143     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1144     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1145     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1146     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1147     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1148     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1149     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1150     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1151     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1152     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1153     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1154     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1155     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1156     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1157     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1158     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1159     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1160     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1161     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1162     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1163     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1164     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1165     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1166     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1167     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1168     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1169     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1170     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1171     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1172     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1173     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1174     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1175     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1176     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1177     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1178     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1179     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1180     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1181     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1182     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1183     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1184     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1185     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1187     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1188     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1189     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1190     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1191     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1192     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1193     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1194     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1195     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1196     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1197     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1198     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1199     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1200     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1201     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1202     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1203     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1204     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1205     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1206     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1207     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1208     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1209     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1210     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1211     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1212     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1213     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1214     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1215     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1216     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1217     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1218     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1219     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1220     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1221     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1222     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1223     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1224     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1225     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1226     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1227     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1236     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1237     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1238     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1239     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1240     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1241     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1242     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1243     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1244     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1245     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1246     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1247     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1248     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1249     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1250     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1251     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1252     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1253     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1254     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1255     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1256     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1257     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1258     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1259     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1260     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1261     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1262     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1263     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1264     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1265     12  FILLER                  PIC  X(88).                         CL**2
  1266******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  28
* ECS010.cbl
  1268 FD  CERT-MASTER-OUT
* 1269                             COPY ECSCROFD.
  1270******************************************************************07/10/97
  1271*                                                                *ECSCROFD
  1272*                            ECSCROFD                            *   LV001
  1273*                            VMOD=2.002                          *ECSCROFD
  1274*                                                                *ECSCROFD
  1275*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1276*                                                                *ECSCROFD
  1277******************************************************************ECSCROFD
  1278     RECORDING MODE F                                             ECSCROFD
  1279     LABEL RECORDS STANDARD                                       ECSCROFD
  1280     BLOCK CONTAINS 0 RECORDS
  1281     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1282 01  CERT-OUT-RECORD.                                             ECSCROFD
  1283     12  FILLER                            PIC  XXX.              ECSCROFD
  1284     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1285     12  FILLER                            PIC  X(1017).          ECSCROFD
  1286                                                                  ECSCROFD
  1287******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  29
* ECS010.cbl
  1289 FD  DETAIL-EXTR
  1290     BLOCK CONTAINS 0 RECORDS
  1291     RECORDING MODE F.
  1292
* 1293                             COPY ECSEXT01.
  1294******************************************************************04/29/98
  1295*                                                                *ECSEXT01
  1296*                            ECSEXT01                            *   LV015
  1297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1298*                            VMOD=2.015                          *ECSEXT01
  1299*                                                                *ECSEXT01
  1300*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1301*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1302*                                                                *ECSEXT01
  1303*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1304*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1305*                                                                *ECSEXT01
  1306*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1307*                                                                *ECSEXT01
  1308******************************************************************ECSEXT01
  1309******************************************************************
  1310*                   C H A N G E   L O G
  1311*
  1312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1313*-----------------------------------------------------------------
  1314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1315* EFFECTIVE    NUMBER
  1316*-----------------------------------------------------------------
  1317* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1318* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1319* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1320* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1321* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1322* 032612  CR2011110200001  PEMA  AHL CHANGES
  1323******************************************************************
  1324                                                                  ECSEXT01
  1325 01  DETAIL-EXTRACT.                                              ECSEXT01
  1326     02 DETAIL-FILE.                                              ECSEXT01
  1327     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1328         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1329                                                                  ECSEXT01
  1330     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1331                                                                  ECSEXT01
  1332     12  DE-REIN                           PIC X.                 ECSEXT01
  1333                                                                  ECSEXT01
  1334     12  DE-CONTROL.                                              ECSEXT01
  1335         16  DE-CNTRL1.                                           ECSEXT01
  1336             20  DE-CARRIER                PIC X.                 ECSEXT01
  1337             20  DE-GROUPING.                                     ECSEXT01
  1338                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1339                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1340             20  DE-STATE                  PIC XX.                ECSEXT01
  1341             20  DE-ACCOUNT.                                      ECSEXT01
  1342                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1343                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1344         16  DE-CNTRL2.                                           ECSEXT01
  1345             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1346             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1347                 24 DE-CERT-NO.                                   ECSEXT01
  1348                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1349                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1350                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1351                                                                  ECSEXT01
  1352     12  DE-TRANS                          PIC X.                 ECSEXT01
  1353         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1354         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1355         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1356         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1357         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1358         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1359         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1360         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1361         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1362         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1363                                                                  ECSEXT01
  1364     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1365     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1366                                                                  ECSEXT01
  1367     12  DE-NAME.                                                 ECSEXT01
  1368         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1369         16  DE-FNAME.                                            ECSEXT01
  1370             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1371             20  FILLER                    PIC X(9).              ECSEXT01
  1372         16  DE-INIT                       PIC X.                 ECSEXT01
  1373     12  DE-AGE                            PIC 99.                ECSEXT01
  1374     12  DE-SEX                            PIC X.                 ECSEXT01
  1375     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1376                                                                  ECSEXT01
  1377     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1378     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1379     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1380     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1381     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1382     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1383     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1384     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1385     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1386                                                                  ECSEXT01
  1387     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1388     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1389     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1390     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1391                                                                  ECSEXT01
  1392     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1393     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1394     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1395     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1396     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1397                                                                  ECSEXT01
  1398     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1399     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1400     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1401     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1402                                                                  ECSEXT01
  1403     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1404     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1405                                           PIC S9(5)V99   COMP-3.
  1406     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1407     12  FILLER REDEFINES DE-NUM-BILLED.
  1408         16  DE-CLP-STATE                  PIC XX.
  1409         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1410     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1411     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1412                                                                  ECSEXT01
  1413     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1414     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1415     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1416     12  DE-IG                             PIC X.                 ECSEXT01
  1417     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1418*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1419     12  DE-MEMBER-NO.                                            ECSEXT01
  1420         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1421         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1422         16  FILLER                        PIC X(03).             ECSEXT01
  1423     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1424                                                                  ECSEXT01
  1425     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1426         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1427                                                                  ECSEXT01
  1428     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1429     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1430                                                                  ECSEXT01
  1431     12  DE-REI-AREA.                                             ECSEXT01
  1432         16  DE-REI-COMP.                                         ECSEXT01
  1433             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1434             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1435         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1436         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1437         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1438         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1439         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1440         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1441         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1442                                                                  ECSEXT01
  1443     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1444     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1445         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1446         16  F                             PIC X.
  1447*    12  FILLER                            PIC X(5).              ECSEXT01
  1448                                                                  ECSEXT01
  1449     12  DE-BILLED-AREA.                                          ECSEXT01
  1450         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1451             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1452                                                                  ECSEXT01
  1453         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1454             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1455             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1456             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1457             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1458             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1459             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1460                                                                  ECSEXT01
  1461         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1462             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1463                                                                  ECSEXT01
  1464         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1465         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1466         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1467         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1468                                                                  ECSEXT01
  1469         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1470*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1471*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1472                                                                  ECSEXT01
  1473     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1474         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1475         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1476         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1477                                                                  ECSEXT01
  1478     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1479         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1480         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1481     12  DE-CANCEL-REASON                  PIC X.
  1482                                                                  ECSEXT01
  1483     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1484     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1485                                                                  ECSEXT01
  1486     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1487         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1488             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1489         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1490             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1491                                                                  ECSEXT01
  1492     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1493         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1494                                                                  ECSEXT01
  1495     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1496     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1497         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1498         16  FILLER                        PIC X.
  1499                                                                  ECSEXT01
  1500****************************************************************  ECSEXT01
  1501**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1502****************************************************************  ECSEXT01
  1503     12  DE-COMM-LEVELS.                                          ECSEXT01
  1504         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1505             20  DE-AGT.                                          ECSEXT01
  1506                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1507                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1508             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1509             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1510             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1511                                                                  ECSEXT01
  1512     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1513****************************************************************  ECSEXT01
  1514*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1515****************************************************************  ECSEXT01
  1516     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1517     12  FILLER                            PIC X(334).            ECSEXT01
  1518     12  DE-TYPE                           PIC X.                 ECSEXT01
  1519         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1520         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1521         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1522         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1523         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1524         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1525                                                                  ECSEXT01
  1526     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1527     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1528                                                                  ECSEXT01
  1529     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1530     12  DE-REPORTED.                                             ECSEXT01
  1531         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1532         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1533         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1534     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1535     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1536                                                                  ECSEXT01
  1537     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1538     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1539     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1540     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1541     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1542     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1543         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1544         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1545         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1546         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1547         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1548         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1549         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1550                                                                  ECSEXT01
  1551     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1552                                                                  ECSEXT01
  1553     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1554     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1555     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1556     12  FILLER                            PIC XX.                ECSEXT01
  1557     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1558                                                                  ECSEXT01
  1559     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1560     12  DE-BENEFICIARY                    PIC X(10).
  1561     12  filler redefines de-beneficiary.
  1562         16  de-birth-date                 pic 9(11)  comp-3.
  1563         16  f                             pic x(4).
  1564     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1565     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1566     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1567     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1568     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1569     12  DE-CLM-CLASS                      PIC XX.
  1570     12  DE-CLM-DEV                        PIC XXX.
  1571     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1572     12  de-xycor-cert-seq                 pic x(3).
  1573     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1574     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1575     12  DE-XYCOR-STATUS                   PIC X.
  1576     12  FILLER                            PIC X(4).              ECSEXT01
  1577                                                                  ECSEXT01
  1578     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1579                                                                  ECSEXT01
  1580****************************************************************  ECSEXT01
  1581*******               RESERVE EXTRACT                      *****  ECSEXT01
  1582****************************************************************  ECSEXT01
  1583     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1584     12  FILLER                            PIC X(334).            ECSEXT01
  1585                                                                  ECSEXT01
  1586     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1587         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1588         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1589                                                                  ECSEXT01
  1590     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1591     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1592     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1593                                                                  ECSEXT01
  1594     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1595                                                                  ECSEXT01
  1596     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1597     12  DE-RSV-REPORTED.                                         ECSEXT01
  1598         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1599         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1600         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1601     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1602                                                                  ECSEXT01
  1603     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1604     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1605     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1606                                                                  ECSEXT01
  1607     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1608     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1609     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1610                                                                  ECSEXT01
  1611     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1612                                                                  ECSEXT01
  1613     12  DE-RATE-CLASS                     PIC XX.
  1614     12  DE-DEV-CODE                       PIC XXX.
  1615     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1616     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1617     12  FILLER                            PIC X(58).             ECSEXT01
  1618                                                                  ECSEXT01
  1619     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1620******************************************************************ECSEXT01
  1621
  1622 FD  NEW-DETAIL-EXTR
  1623     BLOCK CONTAINS 0 RECORDS
  1624     RECORDING MODE F.
  1625
* 1626                                 COPY ECSEXX01.
  1627******************************************************************
  1628*                                                                *
  1629*                            ECSEXX01                            *
  1630*                            VMOD=2.015                          *
  1631*                                                                *
  1632*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1633*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1634*                                                                *
  1635*   FILE TYPE = SEQUENTIAL                                       *
  1636*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1637*                                                                *
  1638*   KEY DATA =                                   START=5, LEN=36 *
  1639*                                                                *
  1640******************************************************************
  1641******************************************************************
  1642*                   C H A N G E   L O G
  1643*
  1644* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1645*-----------------------------------------------------------------
  1646*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1647* EFFECTIVE    NUMBER
  1648*-----------------------------------------------------------------
  1649*                                    TEMPORARY
  1650******************************************************************
  1651
  1652 01  NEW-DETAIL-EXTRACT.
  1653     02 NEW-DETAIL-FILE.
  1654     12  DX-RECORD-ID                      PIC XX.
  1655         88  VALID-DX-ID                      VALUE 'DX'.
  1656
  1657     12  DX-COMPANY-CD                     PIC X.
  1658
  1659     12  DX-REIN                           PIC X.
  1660
  1661     12  DX-CONTROL.
  1662         16  DX-CNTRL1.
  1663             20  DX-CARRIER                PIC X.
  1664             20  DX-GROUPING.
  1665                 24  DX-GROUP-PREFIX       PIC XXX.
  1666                 24  DX-GROUP-PRIME        PIC XXX.
  1667             20  DX-STATE                  PIC XX.
  1668             20  DX-ACCOUNT.
  1669                 24  DX-ACCT-PREFIX        PIC X(4).
  1670                 24  DX-ACCT-PRIME         PIC X(6).
  1671         16  DX-CNTRL2.
  1672             20  DX-EFF                    PIC 9(11)  COMP-3.
  1673             20  DX-CERT.
  1674                 24 DX-CERT-NO.
  1675                     28  DX-CRT-PREFIX     PIC XXX.
  1676                     28  DX-CRT-PRIME      PIC X(7).
  1677                 24  DX-CRT-SUF            PIC X.
  1678
  1679     12  DX-TRANS                          PIC X.
  1680         88  DX-ISSUE                         VALUE 'I'.
  1681         88  DX-RC-ISSUE                      VALUE '8'.
  1682         88  DX-CANCEL                        VALUE 'C'.
  1683         88  DX-RC-CANCEL                     VALUE '7'.
  1684         88  DX-CLAIM                         VALUE 'X'.
  1685         88  DX-RESTORE                       VALUE 'R'.
  1686         88  DX-RESERVE                       VALUE 'Y'.
  1687         88  DX-RR-RC-ISS                     VALUE 'J'.
  1688         88  DX-RR-RC-CNC                     VALUE 'K'.
  1689         88  DX-RR-RC-CLM                     VALUE 'L'.
  1690
  1691     12  DX-REPORT-CODX-1                  PIC X(10).
  1692     12  DX-REPORT-CODX-2                  PIC X(10).
  1693
  1694     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1695         16  DX-LNAME                      PIC X(15).
  1696         16  DX-FNAME.
  1697             20  DX-1ST-INIT-FNAME         PIC X.
  1698             20  FILLER                    PIC X(9).
  1699         16  DX-INIT                       PIC X.
  1700     12  DX-AGE                            PIC 99.
  1701     12  DX-SEX                            PIC X.
  1702     12  DX-SOC-SEC-NO                     PIC X(11).
  1703
  1704     12  DX-LF-TYPE                        PIC XX.
  1705     12  DX-LF-TERM                        PIC 999        COMP-3.
  1706     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1707     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1708     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1709     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1710     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1711     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1712     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1713
  1714     12  DX-LF-STAT-CDE                    PIC X.
  1715     12  DX-LF-PREV-STAT                   PIC X.
  1716     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1717     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1718
  1719     12  DX-AH-TYPE                        PIC XX.
  1720     12  DX-AH-TERM                        PIC 999        COMP-3.
  1721     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1722     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1723     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1724
  1725     12  DX-AH-STAT-CDE                    PIC X.
  1726     12  DX-AH-PREV-STAT                   PIC X.
  1727     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1728     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1729
  1730     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1731     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1732                                           PIC S9(5)V99   COMP-3.
  1733     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1734     12  FILLER REDEFINES DX-NUM-BILLED.
  1735         16  DX-CLP-STATE                  PIC XX.
  1736         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1737     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1738     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1739
  1740     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1741     12  DX-PMT-FREQ                       PIC 99.
  1742     12  DX-ACC-GPCD                       PIC XX.
  1743     12  DX-IG                             PIC X.
  1744     12  DX-REMIT-TO                       PIC XX.
  1745*    12  DX-MEMBER-NO                      PIC X(12).
  1746     12  DX-MEMBER-NO.
  1747         16  DX-MASTER-POLICY              PIC X(06).
  1748         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1749         16  FILLER                        PIC X(03).
  1750     12  DX-LN-OFFICER                     PIC XXX.
  1751
  1752     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1753         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1754
  1755     12  DX-ENTRY-STATUS                   PIC X.
  1756     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1757
  1758     12  DX-REI-AREA.
  1759         16  DX-REI-COMP.
  1760             20  DX-REINCO                 PIC XXX.
  1761             20  DX-REINCO-SUB             PIC XXX.
  1762         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1763         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1764         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1765         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1766         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1767         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1768         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1769
  1770     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1771     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1772         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1773         16  F                             PIC X.
  1774*    12  FILLER                            PIC X(5).
  1775
  1776     12  DX-BILLED-AREA.
  1777         16  DX-GL-INTERFACE-CODES.
  1778             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1779
  1780         16  DX-BILL-SW                    PIC X.
  1781             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1782             88  DX-RECORD-RETURNED           VALUE 'R'.
  1783             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1784             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1785             88  DX-OVERRIDX-AH               VALUE 'A'.
  1786             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1787
  1788         16  DX-REFUND-SW                  PIC X.
  1789             88  DX-REFUND-CREATED            VALUE 'Y'.
  1790
  1791         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1792         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1793         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1794         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1795
  1796         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1797*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1798*            88  DX-BILLED-GA                 VALUE 'B'.
  1799
  1800     12  DX-BILL-STATUS                    PIC X.
  1801         88  DX-NO-PRE-BILL                   VALUE ' '.
  1802         88  DX-BILLED                        VALUE 'B'.
  1803         88  DX-REVERSE                       VALUE 'R'.
  1804
  1805     12  DX-REVERSE-REASONS.
  1806         16  DX-REVERSE-REASON-1           PIC X.
  1807         16  DX-REVERSE-REASON-2           PIC X.
  1808     12  DX-CANCEL-REASON                  PIC X.
  1809
  1810     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1811     12  DX-RECALC-TYPE                    PIC X.
  1812
  1813     12  DX-CHARGEBACK-CODES.
  1814         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1815             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1816         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1817             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1818
  1819     12  DX-UNDERWRITING-CODE              PIC X.
  1820         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1821
  1822     12  DX-NCL-POOL-CODE                  PIC XXX.
  1823     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1824         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1825         16  FILLER                        PIC X.
  1826
  1827****************************************************************
  1828**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1829****************************************************************
  1830     12  DX-COMM-LEVELS.
  1831         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1832             20  DX-AGT.
  1833                 24  DX-AGT-PREFIX         PIC X(4).
  1834                 24  DX-AGT-PRIME          PIC X(6).
  1835             20  DX-AGT-TYPE               PIC X.
  1836             20  DX-L-PC                   PIC S999V99    COMP-3.
  1837             20  DX-A-PC                   PIC S999V99    COMP-3.
  1838
  1839     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1840****************************************************************
  1841*******                 CLAIM EXTRACT                      *****
  1842****************************************************************
  1843     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1844     12  FILLER                            PIC X(334).
  1845     12  DX-TYPE                           PIC X.
  1846         88  DX-DTH                           VALUE '1'.
  1847         88  DX-AH                            VALUE '2'.
  1848         88  DX-OB-DTH                        VALUE '3'.
  1849         88  DX-OB-AH                         VALUE '4'.
  1850         88  DX-DEATH                         VALUES '1' '3'.
  1851         88  DX-DISABILITY                    VALUES '2' '4'.
  1852
  1853     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1854     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1855
  1856     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1857     12  DX-REPORTED.
  1858         16  DX-RPT-YR                     PIC 99.
  1859         16  DX-RPT-MO                     PIC 99.
  1860         16  DX-RPT-DA                     PIC 99.
  1861     12  DX-PAY                            PIC 9(11)      COMP-3.
  1862     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1863
  1864     12  DX-CNUM                           PIC X(7).
  1865     12  DX-CHECK                          PIC X(7).
  1866     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1867     12  DX-DAYS-DISAB                     PIC 999.
  1868     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1869     12  DX-PAY-CODE                       PIC X.
  1870         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1871         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1872         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1873         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1874         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1875         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1876         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1877
  1878     12  DX-CLM-ERR                        PIC XX.
  1879
  1880     12  DX-ACC-NAME                       PIC X(30).
  1881     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1882     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1883     12  FILLER                            PIC XX.
  1884     12  DX-LOAN-OFFICER                   PIC XXX.
  1885
  1886     12  DX-LOAN-TYPE                      PIC X(02).
  1887     12  DX-BENEFICIARY                    PIC X(10).
  1888     12  filler redefines DX-beneficiary.
  1889         16  DX-birth-date                 pic 9(11)  comp-3.
  1890         16  f                             pic x(4).
  1891     12  DX-LOAN-CLASS                     PIC X(02).
  1892     12  DX-LOSS-CODE                      PIC X(06).
  1893     12  DX-ASSOCIATES                     PIC X(01).
  1894     12  DX-LEGAL-STATE                    PIC X(02).
  1895     12  DX-CLM-CAUSE                      PIC X(6).
  1896     12  DX-CLM-CLASS                      PIC XX.
  1897     12  DX-CLM-DEV                        PIC XXX.
  1898     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1899     12  DX-xycor-cert-seq                 pic x(3).
  1900     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1901     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1902     12  DX-XYCOR-STATUS                   PIC X.
  1903     12  FILLER                            PIC X(4).
  1904
  1905     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1906
  1907****************************************************************
  1908*******               RESERVE EXTRACT                      *****
  1909****************************************************************
  1910     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1911     12  FILLER                            PIC X(334).
  1912
  1913     12  DX-RESERVE-TYPE                   PIC X.
  1914         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1915         88  DX-AH-RSV                        VALUE '2' '4'.
  1916
  1917     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1918     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1919     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1920
  1921     12  DX-CLMNO                          PIC X(7).
  1922
  1923     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1924     12  DX-RSV-REPORTED.
  1925         16  DX-RSV-RPT-YR                 PIC 99.
  1926         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1927         16  DX-RSV-RPT-DA                 PIC 99.
  1928     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1929
  1930     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1931     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1932     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1933
  1934     12  DX-RSV-ACC-NAME                   PIC X(30).
  1935     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1936     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1937
  1938     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1939
  1940     12  DX-RATE-CLASS                     PIC XX.
  1941     12  DX-DEV-CODE                       PIC XXX.
  1942     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1943     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1944     12  FILLER                            PIC X(58).
  1945
  1946     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1947******************************************************************
  1948
  1949 FD  SUMMARY-EXTR
  1950     BLOCK CONTAINS 0 RECORDS
  1951     RECORDING MODE F.
  1952
* 1953                             COPY ECSEPC01.
  1954******************************************************************
  1955*                                                                *
  1956*                            ECSEPC01                            *
  1957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1958*                            VMOD=2.008                          *
  1959*                                                                *
  1960*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1961*                                                                *
  1962*   FILE TYPE = SEQUENTIAL                                       *
  1963*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1964*                                                                *
  1965*   KEY DATA =                                  START=5, LEN=31  *
  1966*                                                                *
  1967*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1968*                                                                *
  1969******************************************************************
  1970
  1971 01  EP-RECORD.
  1972     02 EP-FILE.
  1973     12  EP-RECORD-ID                      PIC XX.
  1974         88  VALID-EP-ID                      VALUE 'EP'.
  1975
  1976     12  EP-COMPANY-CD                     PIC X.
  1977
  1978     12  EP-REIN                           PIC X.
  1979         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1980
  1981     12  EP-CONTROL.
  1982         16  EP-CNTRL-1.
  1983             20  EP-COMPANY.
  1984                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  41
* ECS010.cbl (/apps/test/cid1s/copy/ECSEPC01)
  1985                 24  EP-GROUPING.
  1986                     28  EP-GROUP-PREFIX   PIC XXX.
  1987                     28  EP-GROUP-PRIME    PIC XXX.
  1988             20  EP-STATE                  PIC XX.
  1989             20  EP-ACCOUNT.
  1990                 24  EP-ACCT-PREFIX        PIC X(4).
  1991                 24  EP-ACCT-PRIME         PIC X(6).
  1992         16  EP-CNTRL-2.
  1993             20  EP-DATES.
  1994                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1995                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1996
  1997     12  EP-REI-CO.
  1998         16  EP-REINCO                     PIC XXX.
  1999         16  EP-REINCO-SUB                 PIC XXX.
  2000
  2001     12  EP-RCD-TYPE                       PIC X.
  2002         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  2003         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  2004         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2005         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2006         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2007         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2008     12  EP-BEN-CODE                       PIC XX.
  2009     12  FILLER                            PIC X.
  2010
  2011     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2012     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2013     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2014
  2015     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2016     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2017     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2018
  2019     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2020     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2021     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2022     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2023
  2024     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2025     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2026     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2027
  2028     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2029     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2030     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2031
  2032     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2033     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2034     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2035     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2036     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2037
  2038     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2039     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2040     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2041
  2042     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  42
* ECS010.cbl (/apps/test/cid1s/copy/ECSEPC01)
  2043     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2044     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2045
  2046     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2047         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2048         16  EP-NEW-DATA-IND               PIC X(01).
  2049             88  EP-NEW-DATA                   VALUE 'Y'.
  2050         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2051         16  FILLER                        PIC X(19).
  2052
  2053     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2054     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2055     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2056
  2057     12  FILLER                            PIC XXX.
  2058
  2059     12  EP-UNDERWRITING-CODE              PIC X.
  2060         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2061
  2062     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  2063
  2064     12  FILLER                            PIC X(29).
  2065*    12  FILLER                            PIC X(34).
  2066
  2067     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2068     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2069     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2070     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2071     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2072     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2073
  2074     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2075
  2076     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2077     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2078
  2079     12  EP-PURGE                          PIC X.
  2080         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2081
  2082     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2083
  2084     02 EC-RECORD     REDEFINES     EP-FILE.
  2085     12  EC-RECORD-ID                      PIC XX.
  2086         88  VALID-EC-ID                      VALUE 'EC'.
  2087
  2088     12  EC-COMPANY-CD                     PIC X.
  2089
  2090     12  EC-REIN                           PIC X.
  2091         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2092
  2093     12  EC-CONTROL.
  2094         16  EC-CARRIER                    PIC X.
  2095         16  EC-GROUPING.
  2096             20  EC-GROUP-PREFIX           PIC XXX.
  2097             20  EC-GROUP-PRIME            PIC XXX.
  2098         16  EC-STATE                      PIC XX.
  2099         16  EC-ACCOUNT.
  2100             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  43
* ECS010.cbl (/apps/test/cid1s/copy/ECSEPC01)
  2101             20  EC-ACCT-PRIME             PIC X(6).
  2102         16  EC-DATES.
  2103             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2104             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2105
  2106     12  EC-REI-CO.
  2107         16  EC-REINCO                     PIC XXX.
  2108         16  EC-REINCO-SUB                 PIC XXX.
  2109
  2110     12  EC-RCD-TYPE                       PIC X.
  2111         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2112         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2113         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2114         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2115         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2116     12  EC-BEN-CODE                       PIC XX.
  2117     12  EC-SEQ-NBR                        PIC X.
  2118         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2119         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2120
  2121     12  EC-AGENTS-DATA.
  2122         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2123             20  EC-AGT-NO.
  2124                 24  EC-AGT-PREFIX         PIC X(4).
  2125                 24  EC-AGT-PRIME          PIC X(6).
  2126             20  EC-AGT-TYPE               PIC X.
  2127             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2128             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2129             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2130             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2131             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2132
  2133     12  EC-UNDERWRITING-CODE              PIC X.
  2134         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2135
  2136     12  EC-AGENTS-DATA-II.
  2137         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2138             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2139             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2140
  2141     12  FILLER                            PIC X(7).
  2142
  2143     12  EC-PURGE                          PIC X.
  2144         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2145
  2146     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2147
  2148******************************************************************
  2149
  2150 FD  ERRESC-IN.
* 2151                             COPY ERCRESC.
  2152******************************************************************04/29/98
  2153*                                                                *ERCRESC
  2154*                            ERCRESC                             *   LV002
  2155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2156*                            VMOD=2.003                          *   CL**2
  2157*                                                                *ERCRESC
  2158*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2159*                                                                *ERCRESC
  2160*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2161*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2162*                                                                *ERCRESC
  2163*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2164*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2165*                                                                *ERCRESC
  2166*   LOG = NO                                                     *ERCRESC
  2167*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2168*                                                                *ERCRESC
  2169******************************************************************ERCRESC
  2170                                                                  ERCRESC
  2171 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2172                                                                  ERCRESC
  2173     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2174         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2175         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2176         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2177         15  RESC-STATE                PIC   XX.                  ERCRESC
  2178         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2179         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2180         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2181         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2182*                                           YYYYMMDD              ERCRESC
  2183     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2184                                                                  ERCRESC
  2185     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2186         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2187             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2188             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2189             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2190                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2191                                                                  ERCRESC
  2192     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2193     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2194     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2195*                                          YYYYMMDD               ERCRESC
  2196 FD  ELCRTT.
  2197
* 2198                             COPY ELCCRTT.
  2199******************************************************************
  2200*                                                                *ELCCRTT
  2201*                            ELCCRTT.                            *
  2202*                                                                *ELCCRTT
  2203*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2204*                                                                *ELCCRTT
  2205*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2206*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2207*                                                                *ELCCRTT
  2208*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2209*                                                                *ELCCRTT
  2210*   LOG = YES                                                    *ELCCRTT
  2211*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2212******************************************************************
  2213*                   C H A N G E   L O G
  2214*
  2215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2216*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  45
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2218* EFFECTIVE    NUMBER
  2219*-----------------------------------------------------------------
  2220* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2221* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2222* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2223* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2224* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2225* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2226* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2227******************************************************************
  2228                                                                  ELCCRTT
  2229 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2230     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2231         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2232                                                                  ELCCRTT
  2233     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2234         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2235         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2236         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2237         16  CS-STATE                      PIC XX.                ELCCRTT
  2238         16  CS-ACCOUNT                    PIC X(10).
  2239         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2240         16  CS-CERT-NO.                                          ELCCRTT
  2241             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2242             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2243         16  CS-TRAILER-TYPE               PIC X.
  2244             88  COMM-TRLR           VALUE 'A'.
  2245             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2246             88  CERT-DATA-TRLR      VALUE 'C'.
  2247                                                                  ELCCRTT
  2248     12  CS-DATA-AREA                      PIC X(516).
  2249
  2250     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2251         16  CS-BANK-COMMISSION-AREA.
  2252             20  CS-BANK-COMMS       OCCURS 10.
  2253                 24  CS-AGT                PIC X(10).
  2254                 24  CS-COM-TYP            PIC X.
  2255                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2256                 24  CS-RECALC-LV-INDIC    PIC X.
  2257                 24  FILLER                PIC X(10).
  2258
  2259         16  FILLER                        PIC X(256).
  2260
  2261     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2262****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2263
  2264         16  CS-MB-CLAIM-DATA OCCURS 24.
  2265             20  CS-CLAIM-NO               PIC X(7).
  2266             20  CS-CLAIM-TYPE             PIC X.
  2267                 88  CS-AH-CLM               VALUE 'A'.
  2268                 88  CS-IU-CLM               VALUE 'I'.
  2269                 88  CS-GP-CLM               VALUE 'G'.
  2270                 88  CS-LF-CLM               VALUE 'L'.
  2271                 88  CS-PR-CLM               VALUE 'P'.
  2272                 88  CS-FL-CLM               VALUE 'F'.
  2273             20  CS-INSURED-TYPE           PIC X.
  2274                 88  CS-PRIM-INSURED          VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  46
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2275                 88  CS-CO-BORROWER           VALUE 'C'.
  2276             20  CS-BENEFIT-PERIOD         PIC 99.
  2277             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2278             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2279             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2280         16  FILLER                        PIC X(12).
  2281
  2282     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2283         16  CS-VIN-NUMBER                 PIC X(17).
  2284         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2285         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2286         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2287         16  FILLER                        PIC X(496).
  2288
  2289 FD  ERAGTC.
  2290
* 2291                             COPY ERCAGTC.
  2292******************************************************************
  2293*                                                                *
  2294*                                                                *
  2295*                            ERCAGTC                             *
  2296*                            VMOD=2.001                          *
  2297*                                                                *
  2298*   ONLINE CREDIT SYSTEM                                         *
  2299*                                                                *
  2300*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2301*                                                                *
  2302*   FILE TYPE = VSAM,KSDS                                        *
  2303*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2304*                                                                *
  2305*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2306*       ALTERNATE PATH = NONE                                    *
  2307*                                                                *
  2308*   LOG = NO                                                     *
  2309*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2310*                                                                *
  2311******************************************************************
  2312*                   C H A N G E   L O G
  2313*
  2314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2315*-----------------------------------------------------------------
  2316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2317* EFFECTIVE    NUMBER
  2318*-----------------------------------------------------------------
  2319* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2320* 111004                         NEW FILE AND COPYBOOK
  2321* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2322******************************************************************
  2323
  2324 01  AGENT-COMMISSIONS.
  2325     12  AG-RECORD-ID                          PIC XX.
  2326         88  VALID-CO-ID                          VALUE 'AG'.
  2327
  2328     12  AG-CONTROL-PRIMARY.
  2329         16  AG-COMPANY-CD                     PIC X.
  2330         16  AG-CONTROL.
  2331             20  AG-CTL-1.
  2332                 24  AG-CARR-GROUP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2333                     28  AG-CARRIER            PIC X.
  2334                     28  AG-GROUPING           PIC X(6).
  2335                 24  AG-BANK                   PIC X(10).
  2336             20  AG-CTL-2.
  2337                 24  AG-EXP-DT                 PIC XX.
  2338         16  AG-TYPE                           PIC X.
  2339             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2340             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2341
  2342     12  AG-MAINT-INFORMATION.
  2343         16  AG-LAST-MAINT-DT                  PIC XX.
  2344         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2345         16  AG-LAST-MAINT-USER                PIC X(4).
  2346         16  FILLER                            PIC X(10).
  2347
  2348     12  AG-EFF-DT                             PIC XX.
  2349     12  AG-COMM-STRUCTURE.
  2350         16  AG-AGT-COMMS OCCURS 10.
  2351             20  AG-AGT                PIC X(10).
  2352             20  AG-COM-TYP            PIC X.
  2353             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2354             20  AG-RECALC-LV-INDIC    PIC X.
  2355             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2356             20  AG-LRCALC-LV-INDIC    PIC X.
  2357             20  FILLER                PIC X(05).
  2358
  2359     12  FILLER                  PIC X(145).
  2360******************************************************************
  2361
  2362 FD  ERPDEF.
  2363
* 2364                             COPY ERCPDEF.
  2365******************************************************************
  2366*                                                                *
  2367*                                                                *
  2368*                            ERCPDEF.                            *
  2369*                                                                *
  2370*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2371*                                                                *
  2372*    FILE TYPE = VSAM,KSDS                                       *
  2373*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2374*                                                                *
  2375*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2376*                                                                *
  2377*    LOG = YES                                                   *
  2378*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2379******************************************************************
  2380*                   C H A N G E   L O G
  2381*
  2382* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2383*-----------------------------------------------------------------
  2384*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2385* EFFECTIVE    NUMBER
  2386*-----------------------------------------------------------------
  2387* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2388* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2389******************************************************************
  2390 01  PRODUCT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  48
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2391    12  PD-RECORD-ID                 PIC X(02).
  2392        88  VALID-PD-ID                  VALUE 'PD'.
  2393
  2394    12  PD-CONTROL-PRIMARY.
  2395        16  PD-COMPANY-CD            PIC X.
  2396        16  PD-STATE                 PIC XX.
  2397        16  PD-PRODUCT-CD            PIC XXX.
  2398        16  PD-FILLER                PIC X(7).
  2399        16  PD-BEN-TYPE              PIC X.
  2400        16  PD-BEN-CODE              PIC XX.
  2401        16  PD-PROD-EXP-DT           PIC XX.
  2402
  2403    12  FILLER                       PIC X(50).
  2404
  2405    12  PD-PRODUCT-DATA OCCURS 8.
  2406        16  PD-PROD-CODE             PIC X.
  2407            88  PD-PROD-LIFE           VALUE 'L'.
  2408            88  PD-PROD-PROP           VALUE 'P'.
  2409            88  PD-PROD-AH             VALUE 'A'.
  2410            88  PD-PROD-IU             VALUE 'I'.
  2411            88  PD-PROD-GAP            VALUE 'G'.
  2412            88  PD-PROD-FAML           VALUE 'F'.
  2413        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2414        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2415        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2416        16  PD-MAX-TERM              PIC S999        COMP-3.
  2417        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2418        16  FILLER                   PIC X.
  2419        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2420        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2421        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2422        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2423        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2424        16  PD-REC-CRIT-PERIOD       PIC 99.
  2425        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2426            20  PD-RECURRING-YN      PIC X.
  2427            20  FILLER               PIC X.
  2428        16  PD-RTW-MOS               PIC 99.
  2429        16  PD-MAX-EXTENSION         PIC 99.
  2430        16  FILLER                   PIC XX.
  2431
  2432    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2433
  2434    12  PD-TERM-LIMITS OCCURS 15.
  2435        16  PD-LOW-TERM              PIC S999        COMP-3.
  2436        16  PD-HI-TERM               PIC S999        COMP-3.
  2437
  2438*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2439    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2440        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2441        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2442
  2443    12  PD-EARN-FACTORS.
  2444        16  FILLER OCCURS 15.
  2445            20  FILLER OCCURS 15.
  2446                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2447
  2448    12  PD-PRODUCT-DESC              PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  49
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2449    12  PD-TRUNCATED                 PIC X.
  2450    12  FILLER                       PIC X(59).
  2451
  2452    12  PD-MAINT-INFORMATION.
  2453        16  PD-LAST-MAINT-DT         PIC X(02).
  2454        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2455        16  PD-LAST-MAINT-BY         PIC X(04).
  2456
  2457 FD  ME-ECS010-BALANCE
  2458     RECORDING MODE IS F
  2459     BLOCK CONTAINS 0 RECORDS.
  2460 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2461
  2462 FD  ME50-ECS010-BALANCE
  2463     RECORDING MODE IS F
  2464     BLOCK CONTAINS 0 RECORDS.
  2465 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2466
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  50
* ECS010.cbl
  2468 FD  DISK-DATE
* 2469                             COPY ELCDTEFD.
  2470******************************************************************04/15/98
  2471*                                                                *ELCDTEFD
  2472*                                                                *ELCDTEFD
  2473*                            ELCDTEFD.                           *   LV002
  2474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2475*                            VMOD=2.007                          *   CL**2
  2476*                                                                *ELCDTEFD
  2477******************************************************************ELCDTEFD
  2478     BLOCK CONTAINS 0 RECORDS
  2479     RECORDING MODE F.                                            ELCDTEFD
  2480                                                                  ELCDTEFD
  2481 01  DATE-DISK.                                                   ELCDTEFD
  2482     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2483     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2484     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2485     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2486     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2487     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2488     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2489                                                                  ELCDTEFD
  2490 01  DATE-DISK-R.                                                 ELCDTEFD
  2491     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2492     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2493                                     PIC  X(32).                  ELCDTEFD
  2494                                                                  ELCDTEFD
  2495 01  DATE-DISK-T.                                                 ELCDTEFD
  2496     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2497     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2498                                     PIC  X(48).                  ELCDTEFD
  2499                                                                  ELCDTEFD
  2500 01  DATE-DISK-M.                                                 ELCDTEFD
  2501     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2502     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2503                                     PIC  X(48).                  ELCDTEFD
  2504                                                                  ELCDTEFD
  2505 01  DATE-DISK-P.                                                 ELCDTEFD
  2506     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2507     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2508     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2509     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2510         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2511                                     PIC  X.                      ELCDTEFD
  2512         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2513     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2514         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2515             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2516             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2517             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2518             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2519         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2520                                                                  ELCDTEFD
  2521 01  DATE-DISK-E.                                                 ELCDTEFD
  2522     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2523     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2524                                     PIC  X(4).                   ELCDTEFD
  2525                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  51
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2526 01  DATE-DISK-C.                                                 ELCDTEFD
  2527     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2528     12  DD-CARR1-SECPAY-SW          PIC  X.
  2529     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2530     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2531     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2532     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2533     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2534     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2535     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2536     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2537     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2538     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2539     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2540     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2541     12  DD-CARR2-SECPAY-SW          PIC  X.
  2542     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2543                                                                  ELCDTEFD
  2544 01  DATE-DISK-OPT.                                               ELCDTEFD
  2545     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2546     12  DD-TLR-DATA.                                             ELCDTEFD
  2547         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2548                                     PIC  X(03).                  ELCDTEFD
  2549     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2550         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2551                                     PIC  X(06).                  ELCDTEFD
  2552     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2553         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2554                                     PIC  X(07).                  ELCDTEFD
  2555         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2556     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2557                                     PIC  X(96).                  ELCDTEFD
  2558******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  52
* ECS010.cbl
  2560 FD  PRINT-COPY
* 2561                             COPY ELCPRTFD.
  2562******************************************************************04/15/98
  2563*                                                                *ELCPRTFD
  2564*                                                                *ELCPRTFD
  2565*                            ELCPRTFD.                           *   LV003
  2566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2567*                            VMOD=2.006                          *ELCPRTFD
  2568******************************************************************ELCPRTFD
  2569     RECORDING MODE F                                             ELCPRTFD
  2570     LABEL RECORDS OMITTED                                        ELCPRTFD
  2571     BLOCK CONTAINS 0 RECORDS
  2572     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2573 01  PRT.                                                         ELCPRTFD
  2574     12  P-CTL               PIC  X.                                 CL**2
  2575     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2576******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  53
* ECS010.cbl
  2578 FD  MISMATCH-REPORT
  2579     RECORDING MODE F.
  2580
  2581 01  MISMATCH-RPT.
  2582     12  MR-CTL              PIC X.
  2583     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  54
* ECS010.cbl
  2585 FD  FICH
* 2586                             COPY ELCFCHFD.
  2587******************************************************************04/15/98
  2588*                                                                *ELCFCHFD
  2589*                            ELCFCHFD.                           *   LV003
  2590*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2591*                            VMOD=2.004                          *   CL**3
  2592*                                                                *ELCFCHFD
  2593******************************************************************ELCFCHFD
  2594     BLOCK CONTAINS 0 RECORDS
  2595     RECORDING MODE F.                                            ELCFCHFD
  2596                                                                  ELCFCHFD
  2597 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2598******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  55
* ECS010.cbl
  2600 FD  DISPLAY-PRT
  2601     RECORDING MODE IS F
  2602     LABEL RECORDS ARE STANDARD
  2603     BLOCK CONTAINS 0 RECORDS
  2604     RECORD CONTAINS 133 CHARACTERS.
  2605
  2606 01  DISPLAY-REC.
  2607     05  DISPLAY-CC           PIC X.
  2608     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  56
* ECS010.cbl
  2610 WORKING-STORAGE SECTION.
  2611 77  LCP-ASA                       PIC X.
  2612 77  FILLER  PIC X(32)  VALUE '********************************'.
  2613 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2614 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2615
  2616 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2617 77  ws-dcc-cnc-flag         pic x  value ' '.
  2618 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2619 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2620 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2621 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2622 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2623 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2624 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2625 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2626 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2627 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2628 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2629 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2630 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2631 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2632 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2633 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2634 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2635 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2636 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2637 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2638 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2639 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2640 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2641 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2642 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2643 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2644 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2645 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2646 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2647 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2648 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2649 77  X                       PIC X.
  2650 77  DD-FLG                  PIC X               VALUE SPACE.
  2651 77  AGT-SW                  PIC X               VALUE SPACE.
  2652 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2653 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2654 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2655 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2656 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2657 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2658 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2659 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2660 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2661 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2662 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2663 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2664 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2665 77  SV-TRD-CERT             PIC X(11).
  2666 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2667 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  57
* ECS010.cbl
  2668 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2669*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2670*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2671 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2674 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2675 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2676 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2677 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2678 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2679 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2680 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2681 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2682 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2683 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2684 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2685 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2686 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2687 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2688 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2689 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2690 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2691 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2692 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2693 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2694 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2695 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2696 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2697 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2698 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2699 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2700 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2701 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2702 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2703 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2704 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2705 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2706 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2707 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2708 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2709 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2710 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2711 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2712 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2713 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2714 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2715 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2716 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2717 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2718 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2719 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2720 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2721 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2722 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2723 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2724 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2725 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  58
* ECS010.cbl
  2726 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2727 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2728 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2729 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2730 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2731 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2732 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2733 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2734 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2735 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2736 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2737 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2738 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2739 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2740 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2741 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2742 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2743 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2744 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2745 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2746 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2747 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2748 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2749 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2750 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2751 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2752 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2753 77  P1                      PIC S999 COMP-3 VALUE +0.
  2754 77  P2                      PIC S999 COMP-3 VALUE +0.
  2755 77  DD-IU-SW                    PIC X   VALUE ' '.
  2756     88  DD-IU-PRESENT                 VALUE 'Y'.
  2757 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2758 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2759 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2760 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2761 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2762 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2763 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2764 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2765 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2766 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2767 77  ws-dd-ben-type          pic x  value spaces.
  2768 77  ws-dd-ben-code          pic xx value spaces.
  2769
  2770 01  MONTH-END-DATA.
  2771     12  ME-START-DATE.
  2772         16  ME-START-MO         PIC 99.
  2773         16  FILLER              PIC X.
  2774         16  ME-START-DA         PIC 99.
  2775         16  FILLER              PIC X.
  2776         16  ME-START-YR         PIC 99.
  2777     12  ME-CNDS-DATE            PIC 9(6).
  2778     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2779         16  ME-CNDS-MO          PIC 99.
  2780         16  ME-CNDS-DA          PIC 99.
  2781         16  ME-CNDS-YR          PIC 99.
  2782     12  ME-START-TIME           PIC 9(6).
  2783     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  59
* ECS010.cbl
  2784         88  ME-DO-UPDATE        VALUE 'Y'.
  2785         88  ME-NO-UPDATE        VALUE 'N'.
  2786     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2787
  2788 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2789 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2790     'Life Claims Paid'.
  2791
  2792 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2793     'A&H Claims Paid'.
  2794
  2795 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2796     'Output Certificate Master Records Prior Month'.
  2797
  2798 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2799     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2800
  2801 01  WS-ME-BALANCE-REC.
  2802     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2803     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2804     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2805     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2806     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2807     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2808     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2809
  2810 01  WS-ME50-BALANCE-REC.
  2811     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2812     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2813     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2814     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2815     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2816     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2817     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2818     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2819     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2820
  2821 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2822 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2823 01  WS-BANK-COMMISSIONS.
  2824     12  WS-BANK-COMMS           OCCURS 10.
  2825         16  WS-BNK-AGT          PIC X(10).
  2826         16  WS-BNK-TYPE         PIC X.
  2827         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2828         16  WS-BNK-RECALC       PIC X.
  2829         16  FILLER              PIC X(10).
  2830
  2831 01  PENDING-MATCH-CONTROL.
  2832     12  PENDING-ACCOUNT-CONTROL.
  2833         16  PEND-MATCH-CARRIER    PIC X.
  2834         16  PEND-MATCH-GROUPING   PIC X(6).
  2835         16  PEND-MATCH-STATE      PIC XX.
  2836         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2837     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2838     12  PEND-MATCH-CERT-NO.
  2839         16  PEND-MATCH-CERT       PIC X(10).
  2840         16  PEND-MATCH-CERT-SFX   PIC X.
  2841 01  PENDING-RECORD-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  60
* ECS010.cbl
  2842     88  ISSUE-TRANSACTION            VALUE '1'.
  2843     88  CANCEL-TRANSACTION           VALUE '2'.
  2844     88  CLAIM-TRANSACTION            VALUE '3'.
  2845     88  RESERVE-TRANSACTION          VALUE '4'.
  2846     88  UPDATE-TRANSACTION           VALUE '5'.
  2847
  2848 01  CLM-INCUR-REIN-DATE.
  2849     12  CIRD-CCYY.
  2850         16  CIRD-CC         PIC 99.
  2851         16  CIRD-YR         PIC 99.
  2852     12  CIRD-MO             PIC 99.
  2853
  2854 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2855
  2856 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2857
  2858 01  REIN-BILLING-TABLE.
  2859     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2860         16  RB-COMPANY      PIC X(6).
  2861         16  RB-COUNT        PIC S9(5)   COMP-3.
  2862
  2863 01  B-SUB                   PIC S9(4)   COMP.
  2864
  2865 01  BINARY-COUNTERS     COMP      SYNC.
  2866     12  IA                  PIC S999            VALUE +0.
  2867     12  IB                  PIC S999            VALUE +0.
  2868     12  SUB                 PIC S999            VALUE +0.
  2869     12  SUBM                PIC S999            VALUE +0.
  2870     12  SUB3                PIC S999            VALUE +0.
  2871     12  SUB4                PIC S999            VALUE +0.
  2872     12  SUB5                PIC S999            VALUE +0.
  2873     12  SUB6                PIC S999            VALUE +0.
  2874     12  SUB7                PIC S999            VALUE +0.
  2875     12  SUB8                PIC S999            VALUE +0.
  2876     12  SUB9                PIC S999            VALUE +0.
  2877     12  SUB10               PIC S999            VALUE +0.
  2878     12  SUB11               PIC S999            VALUE +0.
  2879     12  SUB12               PIC S999            VALUE +0.
  2880     12  SUB13               PIC S999            VALUE +0.
  2881     12  SUB14               PIC S999            VALUE +0.
  2882     12  SUB15               PIC S999            VALUE +0.
  2883     12  SUB16               PIC S999            VALUE +0.
  2884     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2885 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2886
  2887 01  WS.
  2888     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2889     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2890     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2891     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2892
  2893     12  WS-ABEND-CODE         PIC 9(4).
  2894     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2895         16  ABEND-CODE-1    PIC XX.
  2896         16  ABEND-CODE-2.
  2897             20  AC2-ONE     PIC X.
  2898             20  AC2-TWO     PIC X.
  2899
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  61
* ECS010.cbl
  2900     12  CTBL-SEARCH.
  2901         16  CTBL-COMP-CD    PIC X.
  2902         16  CTBL-TABLE-CD   PIC XXX.
  2903         16  CTBL-BEN-TYPE   PIC X.
  2904         16  CTBL-BEN-CODE   PIC XX.
  2905     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2906     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2907     12  WS-COMM-TERM        PIC S999            COMP-3.
  2908     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2909         88  CTBL-ERROR         VALUE '*'.
  2910
  2911     12  REIN-SPEC.
  2912         16  REIN-SPEC-A     PIC X.
  2913         16  REIN-SPEC-B     PIC X.
  2914         16  REIN-SPEC-C     PIC X.
  2915
  2916     12  WS-CHECK-NUMBER.
  2917         16  WS-CHECK-NO     PIC X(4).
  2918         16  FILLER          PIC XXX.
  2919
  2920     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2921         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2922         88  AH-EARN-NET                         VALUE 'N'.
  2923
  2924     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2925     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2926
  2927 01  max-pdef                    pic s9(5) comp-3 value +5000.
  2928 01  DCC-DDF-WORK-AREA.
  2929     05  F OCCURS 5000.
  2930         10  DD-STATE                 PIC XX.
  2931         10  DD-PRODUCT-CD            PIC XXX.
  2932         10  DD-FILLER                PIC X(7).
  2933         10  DD-BEN-TYPE              PIC X.
  2934         10  DD-BEN-CODE              PIC XX.
  2935         10  DD-PROD-EXP-DT           PIC XX.
  2936         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2937         10  DD-PROD-DATA OCCURS 8.
  2938             15  DD-PROD-CODE         PIC X.
  2939             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2940         10  DD-EARN-FACTORS.
  2941             15  F OCCURS 15.
  2942                 20  F OCCURS 15.
  2943                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2944         10  DD-TRUNCATED        PIC X.
  2945
  2946 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2947 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2948 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2949 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2950 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2951 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2952 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2953 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2954
  2955 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2956 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2957 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  62
* ECS010.cbl
  2958 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2959
  2960 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2961     12  WS-LF-CHARGEBACK-LEVELS.
  2962         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2963     12  WS-AH-CHARGEBACK-LEVELS.
  2964         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2965 01  WS-DCC-DDF-CB.
  2966     12  WS-DCC-DDF-CB-LEVELS.
  2967         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2968*****************************************************************
  2969*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2970*****************************************************************
  2971*RESIDENT STATE TAXES MASTER(ERRESC)
  2972*
  2973 01  WORK-AREAS.
  2974     12  WS-ERRESC-KEY.
  2975         16 WS-ERRESC-SEARCH-KEY.
  2976             20  WS-ERRESC-COMPANY-CD PIC  X.
  2977             20  WS-ERRESC-CARRIER    PIC  X.
  2978             20  WS-ERRESC-GROUP      PIC X(6).
  2979             20  WS-ERRESC-STATE      PIC XX.
  2980             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2981         16 WS-ERRESC-RESIDUAL-KEY.
  2982             20  WS-ERRESC-AGENT      PIC X(10).
  2983             20  WS-ERRESC-RES-STATE  PIC XX.
  2984             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2985*                                          YYYYMMDD
  2986     12  WS-YYYYMMDD-DT               PIC 9(8).
  2987     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2988     12  WS-SUB                       PIC    99  COMP-3.
  2989     12  WS-SUB1                      PIC    99  COMP-3.
  2990*****************************************************************
  2991*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2992*****************************************************************
  2993
  2994 01  COMM-WORK-AREAS.
  2995     12  FILLER              PIC  X(17)
  2996         VALUE 'COMMON WORK AREAS'.
  2997     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2998     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2999     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3000     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3001     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3002     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3003     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3004     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3005     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3006     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3007     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3008     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3009     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3010     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3011     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  3012     12  W-CERT-COUNT        PIC S9(08)  COMP.
  3013     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  3014     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  3015     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  63
* ECS010.cbl
  3016
  3017     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  3018                                         COMP-3 VALUE ZEROS.
  3019     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  3020                                         COMP-3 VALUE ZEROS.
  3021     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  3022                                         COMP-3 VALUE ZEROS.
  3023     12  W-EDIT-FIELD        PIC ----------9.
  3024     12  W-EDIT-FIELD2       PIC ----------9.99.
  3025     12  W-EDIT-7            PIC Z(06)9.
  3026     12  W-FACTOR            PIC S9(09)V9(08)
  3027                                         COMP-3 VALUE ZEROS.
  3028     12  W-IBNR-1            PIC S9(07)V9(02)
  3029                                         COMP-3 VALUE ZEROS.
  3030     12  W-IBNR-2            PIC S9(07)V9(02)
  3031                                         COMP-3 VALUE ZEROS.
  3032     12  W-ISS-BEN           PIC S9(11)V9(02)
  3033                                         COMP-3 VALUE ZEROS.
  3034     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3035                                         COMP-3 VALUE ZEROS.
  3036     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3037     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3038     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3039     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3040     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3041     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3042     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3043     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3044     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3045     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3046     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3047     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3048     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3049     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3050     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3051     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3052                                         COMP-3 VALUE ZEROS.
  3053     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3054     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3055     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3056     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3057     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3058     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3059     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3060     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3061     12  W-POLICY-INACTIVE-CTR
  3062                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3063     12  W-POLICY-REISSUE-CTR
  3064                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3065     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3066     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3067     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3068                                         COMP-3 VALUE ZEROS.
  3069     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3070     12  W-WK-IBNR           PIC S9(07)V9(02)
  3071                                         COMP-3 VALUE ZEROS.
  3072
  3073     12  W-CLAIM-TYPE        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  64
* ECS010.cbl
  3074         88  W-A-H                              VALUE 'A'.
  3075         88  W-LIFE                             VALUE 'L'.
  3076     12  W-CUTOFF-DATE       PIC  9(08).
  3077     12  W-DIS-DT            PIC  XX.
  3078     12  W-DIS-PTO-DT        PIC  XX.
  3079     12  WK-LEVEL.
  3080         16  WK-AGT          PIC X(10).
  3081         16  WK-A-TYPE       PIC X.
  3082         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3083         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3084         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3085         16  FILLER          PIC X(6).
  3086     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3087         16  FILLER          PIC X(11).
  3088         16  WK-L-RTX        PIC X(3).
  3089         16  WK-J-RTX        PIC X(3).
  3090         16  WK-A-RTX        PIC X(3).
  3091         16  FILLER          PIC X(6).
  3092     12  WK-NEW-RATES.
  3093         16  WK-N-R      OCCURS 10.
  3094             20  WK-N-AGT    PIC X(10).
  3095             20  WK-N-TYPE   PIC X.
  3096             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3097             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3098     12  W-LIFE-YEARS-ZERO.
  3099         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3100         16  FILLER          PIC  X(01)         VALUE SPACES.
  3101         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3102         16  FILLER          PIC  X(01)         VALUE SPACES.
  3103         16  FILLER          PIC  X(01)         VALUE SPACES.
  3104         16  FILLER          PIC  X(01)         VALUE SPACES.
  3105         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3106         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3107         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3108         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3109         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3110         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3111         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3112         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3113         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3114         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3115         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3116         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3117         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3118         16  FILLER          PIC S9(09)V9(02) COMP-3
  3119                                                VALUE ZEROS.
  3120         16  FILLER          PIC S9(09)V9(02) COMP-3
  3121                                                VALUE ZEROS.
  3122         16  FILLER          PIC S9(09)V9(02) COMP-3
  3123                                                VALUE ZEROS.
  3124         16  FILLER          PIC S9(09)V9(02) COMP-3
  3125                                                VALUE ZEROS.
  3126         16  FILLER          PIC S9(11)V9(02) COMP-3
  3127                                                VALUE ZEROS.
  3128
  3129     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3130         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3131     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  65
* ECS010.cbl
  3132         88  W-REIN-PROCESS                     VALUE 'Y'.
  3133         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  3134     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3135         88  W-SELECTION-ON                     VALUE 'Y'.
  3136         88  W-SELECTION-OFF                    VALUE SPACES.
  3137     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3138         88  W-RTRM-0                           VALUE 'Y'.
  3139         88  W-RTRM-NOT-0                       VALUE SPACES.
  3140     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3141     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3142         88  W-TABLE-USED                       VALUE 'Y'.
  3143         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3144     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3145         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3146
  3147     12  W-VAL-ERRORS.
  3148         16  FILLER          PIC  X(40)
  3149             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3150         16  FILLER          PIC  X(40)
  3151             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3152         16  FILLER          PIC  X(40)
  3153             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3154         16  FILLER          PIC  X(40)
  3155             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3156         16  FILLER          PIC  X(40)
  3157             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3158         16  FILLER          PIC  X(40)
  3159             VALUE 'RUN DATE EPEC - A&H - '.
  3160         16  FILLER          PIC  X(40)
  3161             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3162         16  FILLER          PIC  X(40)
  3163             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3164         16  FILLER          PIC  X(40)
  3165             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3166     12  FILLER REDEFINES W-VAL-ERRORS.
  3167         16  W-VAL-ERROR OCCURS 9 TIMES
  3168                             PIC  X(40).
  3169
  3170     12  W-WORK-DATE         PIC  X(02).
  3171     12  SAVE-WK-NEW-RATES.
  3172         16  FILLER          PIC X(170).
  3173
  3174***   The following data area is for NCL only
  3175*    12  W-WORK-OB-DATA OCCURS 300.
  3176*    12  W-WORK-OB-DATA OCCURS 220.
  3177     12  W-WORK-OB-DATA OCCURS 900.
  3178         16  WS-OB-REIN-CO       PIC X(06).
  3179         16  WS-OB-LF-AH         PIC X.
  3180         16  WS-OB-BENEFIT-CODE  PIC XX.
  3181         16  WS-OB-EARNED OCCURS 3.
  3182             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3183
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  66
* ECS010.cbl
  3185 01  EPEC-WORK-AREAS.
  3186     12  WE-REIN-CO          PIC X(6).
  3187     12  WE-LF-AH            PIC X.
  3188     12  WE-BEN-TYPE         PIC XX.
  3189     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3190     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3191     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3192     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3193     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3194     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3195     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3196     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3197     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3198     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3199     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3200     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3201     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3202     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3203     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3204     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3205     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3206     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3207     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3208     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3209     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3210     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3211     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3212     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3213     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3214     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3215     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3216     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3217     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3218     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3219     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3220     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3221     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3222     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3223     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3224     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3225     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3226     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3227     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3228     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3229     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3230     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3231     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3232     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3233     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3234     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3235     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3236     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3237     12  WX-SETTLEMENT-EXIT-DATE
  3238                             PIC  9(11)      COMP-3.
  3239     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3240     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3241     12  WX-STATUS-AT-SETTLEMENT
  3242                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  67
* ECS010.cbl
  3243     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3244
  3245 01  EPEC-WORK.
  3246     12  EW-REIN-CO          PIC X(6).
  3247     12  EW-SUB-KEY.
  3248         16  EW-LF-AH        PIC X.
  3249         16  EW-BEN-TYPE     PIC XX.
  3250     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3251     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3252     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3253     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3254     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3255     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3256     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3257     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3258     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3259     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3260     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3261     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3262     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3263     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3264     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3265     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3266     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3267     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3268     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3269     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3270     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3271     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3272     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3273     12  EW-AGENTS       OCCURS 10.
  3274         16  EW-AGT-NO       PIC X(10).
  3275         16  EW-AGT-TYPE     PIC X.
  3276         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3277         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3278         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3279         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3280         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3281         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3282         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3283     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3284     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3285     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3286     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3287     12  EW-AGE              PIC S9(9)       COMP-3.
  3288     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3289     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3290     12  EW-LEVEL-USED       PIC X.
  3291
  3292 01  EPEC-TOTALS.
  3293     12  EPEC-LEVELS     OCCURS 900.
  3294*    12  EPEC-LEVELS     OCCURS 220.
  3295*    12  EPEC-LEVELS     OCCURS 300.
  3296         16  EPEC-REIN-CO          PIC X(6).
  3297         16  EPEC-SUB-KEY.
  3298             24  EPEC-LF-AH        PIC X.
  3299             24  EPEC-BEN-TYPE     PIC XX.
  3300*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  68
* ECS010.cbl
  3301         16  FILLER                PIC X(699).
  3302     12  EPEC-LEVELS-END           PIC X(6).
  3303
  3304 01  EPEC-UNDERWRITTEN-TOTALS.
  3305     12  EPEC-LEVELS-II  OCCURS 900.
  3306*    12  EPEC-LEVELS-II  OCCURS 220.
  3307*    12  EPEC-LEVELS-II  OCCURS 300.
  3308         16  EPEC-REIN-CO-II       PIC X(6).
  3309         16  EPEC-SUB-KEY-II.
  3310             24  EPEC-LF-AH-II     PIC X.
  3311             24  EPEC-BEN-TYPE-II  PIC XX.
  3312*        16  FILLER                PIC X(694).
  3313         16  FILLER                PIC X(699).
  3314     12  EPEC-LEVELS-END-II        PIC X(6).
  3315
  3316
  3317 01  FILLER                      PIC  X(11)
  3318                                 VALUE 'OPT RSV TBL'.
  3319*
  3320* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3321*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3322*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3323*      EPEC-OPT-GRP  (108)
  3324*
  3325*      300 X 108 = 32400.
  3326*
  3327 01  EPEC-OPT-DATA-TABLE.
  3328*    12  FILLER                  PIC X(32400).
  3329*    12  FILLER                  PIC X(23760).
  3330     12  FILLER                  PIC X(97200).
  3331
  3332 01  FILLER                      PIC  X(16)
  3333                                 VALUE 'OPT RSV TBL UNDW'.
  3334 01  EPEC-UNDW-OPT-DATA-TABLE.
  3335*    12  FILLER                  PIC X(32400).
  3336*    12  FILLER                  PIC X(23760).
  3337     12  FILLER                  PIC X(97200).
  3338
  3339 01  FILLER                      PIC  X(16)
  3340                                 VALUE 'OPT RSV TBL WORK'.
  3341 01  EPEC-OPT-WORK-TABLE.
  3342*    12  EPEC-OPT-GRP        OCCURS 300.
  3343*    12  EPEC-OPT-GRP        OCCURS 220.
  3344     12  EPEC-OPT-GRP        OCCURS 900.
  3345         16  EPEC-REIN-CO-OPT
  3346                             PIC  X(06).
  3347         16  EPEC-SUB-KEY-OPT.
  3348             24  EPEC-LF-AH-OPT
  3349                             PIC  X(01).
  3350             24  EPEC-BEN-TYPE-OPT
  3351                             PIC  X(02).
  3352         16  EPEC-OPT-DATA.
  3353             20  EPEC-REIN-ONLY-IND
  3354                             PIC  X(01).
  3355                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3356             20  EPEC-LINE-NOT-USED-IND
  3357                             PIC  X(01).
  3358                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  69
* ECS010.cbl
  3359             20  EPEC-LIFE-CTR-USED-IND
  3360                             PIC  X(01).
  3361                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3362                 88  EPEC-LIFE-CTR-NOT-USED
  3363                                           VALUE ' '.
  3364             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3365                             PIC S9(09)       COMP-3.
  3366             20  EPEC-EARNED-PREMIUM-AH
  3367                             PIC S9(09)V9(02) COMP-3.
  3368             20  EPEC-CLAIMS-MADE-PAID
  3369                             PIC S9(09)V9(02) COMP-3.
  3370             20  EPEC-CLM-EXP
  3371                             PIC S9(09)V9(02) COMP-3.
  3372             20  EPEC-LIFE-IBNR
  3373                             PIC S9(09)V9(02) COMP-3.
  3374             20  EPEC-REIN-ISS-BEN
  3375                             PIC S9(11)V9(02) COMP-3.
  3376
  3377 01  FILLER                  PIC X(09)
  3378                                 VALUE 'EOM TABLE'.
  3379
  3380 01  EOM-DATE-TABLE.
  3381     12  EOM-DATE            OCCURS 13
  3382                             PIC 9(08).
  3383
  3384 01  EPEC-SUBS.
  3385     12  EPEC-SUB-LEVELS OCCURS 31.
  3386         16  EPEC-SUB-REIN   PIC X(6).
  3387         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3388         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3389     12  EPEC-SUBS-END       PIC X(6).
  3390
  3391 01  SAVE-REIN-WORK.
  3392     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3393     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3394     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3395     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3396     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3397
  3398 01  SAVE-REIN-TABLE.
  3399     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3400         16  SR-TIME         PIC 9(6).
  3401         16  SR-ENTRY.
  3402             20  FILLER      PIC XX.
  3403             20  SR-CONTROL  PIC X(8).
  3404             20  FILLER      PIC X(3990).
  3405
  3406
* 3407                             COPY ECSRITAB.
  3408******************************************************************04/29/98
  3409*                                                                *ECSRITAB
  3410*                            ECSRITAB                            *   LV015
  3411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3412*                            VMOD=2.015                          *ECSRITAB
  3413*                                                                *ECSRITAB
  3414*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3415*                                                                *ECSRITAB
  3416******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3417 01  REIN-WORK-AREAS.                                             ECSRITAB
  3418     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3419     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3420     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3421     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3422     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3423     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3424     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3425     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3426     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3427     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3428     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3429         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3430             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3431             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3432             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3433     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3434     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3435     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3436     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3437     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3438     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3439     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3440     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3441     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3442     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3443     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3444     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3445     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3446     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3447     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3448     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3449     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3450     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3451     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3452     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3453     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3454     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3455     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3456                                                                  ECSRITAB
  3457 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3458     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3459         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3460         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3461             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3462             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3463         16  REIN-WORK-FLDS.                                      ECSRITAB
  3464             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3465             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3466             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3467             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3468             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3469             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3470             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3471             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3472             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3473             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3474             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3475             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3476             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3477             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3478             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3479             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3480             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3481             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3482             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3483             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3484             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3485             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3486             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3487             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3488             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3489             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3490             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3491             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3492     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3493                                                                  ECSRITAB
  3494     12  RWF-FIELDS.                                              ECSRITAB
  3495         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3496         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3497         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3498         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3499         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3500         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3501         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3502         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3503         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3504         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3505         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3506         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3507         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3508         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3509         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3510         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3511         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3512         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3513         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3514         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3515         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3516         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3517         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3518         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3519         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3520         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3521         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3522         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3523                                                                  ECSRITAB
  3524     12  WT-COMP-INFO.                                            ECSRITAB
  3525         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3526         16  WT-LF-QC                PIC X.                       ECSRITAB
  3527         16  WT-AH-QC                PIC X.                       ECSRITAB
  3528         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3529         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3530         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3531         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3532         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3533         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3534         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3535         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3536         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3537         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3538         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3539         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3540         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3541         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3542         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3543         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3544         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3545         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3546         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3547         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3548         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3549         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3550         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3551         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3552         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3553         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3554         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3555         16  WT-REMAINING            PIC X.                       ECSRITAB
  3556         16  FILLER                  PIC X(21).                   ECSRITAB
  3557                                                                  ECSRITAB
  3558 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3559     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3560     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3561     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3562     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3563     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3564     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3565     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3566     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3567     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3568     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3569     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3570     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3571     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3572     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3573     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3574     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3575     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3576     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3577     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3578     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3579     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3580     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3581     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3582     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3583                                                                  ECSRITAB
  3584     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3585         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3586     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3587         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3588     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3589         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3590     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3591         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3592     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3593         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3594     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3595         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3596                                                                  ECSRITAB
  3597     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3598         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3599         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3600         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3601         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3602         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3603         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3604         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3605         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3606         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3607         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3608         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3609         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3610         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3611         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3612         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3613         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3614         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3615         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3616         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3617         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3618         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3619         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3620         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3621     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3622     12  REIN-SEARCH.                                             ECSRITAB
  3623         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3624         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3625         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3626         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3627     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3628     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3629     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3630     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3631     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3632     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3633     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3634     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3635     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3636     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3637     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3638     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3639     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3640     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3641     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3642     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3643     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3644     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3645     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3646     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3647     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3648     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3649     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3650     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3651     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3652                                                                  ECSRITAB
  3653 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3654* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3655     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3656         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3657         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3658         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3659         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3660         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3661         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3662         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3663         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3664         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3665                                                                  ECSRITAB
  3666 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3667     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3668         16  RC2-REIN-CO.                                         ECSRITAB
  3669             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3670             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3671         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3672         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3673         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3674         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3675         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3676         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3677                                                                  ECSRITAB
  3678 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3679     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3680         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3681         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3682     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3683                                                                  ECSRITAB
  3684 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3685     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3686         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3687         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3688         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3689 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3690     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3691         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3692                                                                  ECSRITAB
  3693 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3694******************************************************************ECSRITAB
  3695
* 3696                             COPY ELCPSEVR.
  3697******************************************************************04/16/98
  3698*                                                                *ELCPSEVR
  3699*                                                                *ELCPSEVR
  3700*                            ELCPSEVR                            *   LV003
  3701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3702*                            VMOD=2.001                          *ELCPSEVR
  3703*                                                                *ELCPSEVR
  3704*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3705*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3706*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3707******************************************************************ELCPSEVR
  3708                                                                  ELCPSEVR
  3709 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3710     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3711         10  FILLER               PIC 999.                        ELCPSEVR
  3712         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3713         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3714             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3715             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3716         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3717         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3718     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3719            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3720     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3721         10  FILLER              PIC 999.                         ELCPSEVR
  3722         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3723         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3724             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3725             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3726         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3727         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3728     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3729            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3730 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3731     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3732                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3733         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3734             15  FILLER              PIC 999.                     ELCPSEVR
  3735             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3736             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3737                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3738                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3739             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3740             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3741         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3742                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3743         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3744             15  FILLER              PIC 999.                     ELCPSEVR
  3745             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3746             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3747                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3748                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3749             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3750             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3751         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3752                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3753         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3754             15  FILLER              PIC 999.                     ELCPSEVR
  3755             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3756             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3757                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3758                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3759             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3760             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3761         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3762                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3763     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3764         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3765         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3766         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3767             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3768             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3769         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3770         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3771     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3772            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3773
* 3774                             COPY ELCEPCVR.
  3775******************************************************************05/15/98
  3776*                                                                *ELCEPCVR
  3777*                                                                *ELCEPCVR
  3778*                            ELCEPCVR                            *   LV003
  3779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3780*                            VMOD=2.001                          *ELCEPCVR
  3781*                                                                *ELCEPCVR
  3782*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3783*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3784*                                                                *ELCEPCVR
  3785******************************************************************ELCEPCVR
  3786 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3787     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3788         10  FILLER            PIC 999.                           ELCEPCVR
  3789         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3790         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3791             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3792             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3793         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3794         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3795     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3796            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3797     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3798         10  FILLER            PIC 999.                              CL**5
  3799         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3800         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3801             15  EC-EXP-CC     PIC 99.                               CL**5
  3802             15  EC-EXP-YR     PIC 99.                               CL**5
  3803         10  EC-EXP-MO         PIC 99.                               CL**5
  3804         10  EC-EXP-DA         PIC 99.                               CL**5
  3805     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3806            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3807     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3808         10  FILLER            PIC 999.                           ELCEPCVR
  3809         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3810         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3811             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3812             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3813         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3814         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3815     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3816            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3817     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3818         10  FILLER            PIC 999.                              CL**5
  3819         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3820         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3821             15  EC-EFF-CC     PIC 99.                               CL**5
  3822             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3823         10  EC-EFF-MO         PIC 99.                               CL**5
  3824         10  EC-EFF-DA         PIC 99.                               CL**5
  3825     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3826            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3827     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3828         10  FILLER            PIC 999.                           ELCEPCVR
  3829         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3830         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3831             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3832             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3833         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3834         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3835     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3836            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3837     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3838         10  FILLER            PIC 999.                           ELCEPCVR
  3839         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3840         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3841             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3842             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3843         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3844         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3845     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3846            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3847     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3848         10  FILLER            PIC 999.                           ELCEPCVR
  3849         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3850         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3851             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3852             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3853         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3854         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3855     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3856            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3857     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3858         10  FILLER            PIC 999.                           ELCEPCVR
  3859         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3860         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3861             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3862             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3863         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3864         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3865     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3866            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3867     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3868         10  FILLER            PIC 999.                           ELCEPCVR
  3869         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3870         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3871             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3872             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3873         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3874         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3875     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3876            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3877
* 3878                             COPY ELCREINV.
  3879******************************************************************04/18/98
  3880*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3881*                                                                *ELCREINV
  3882*                            ELCREINV                            *   LV003
  3883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3884*                            VMOD=2.001                          *ELCREINV
  3885*                                                                *ELCREINV
  3886*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3887*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3888*                                                                *ELCREINV
  3889******************************************************************ELCREINV
  3890                                                                  ELCREINV
  3891 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3892     05  WS-RE-LO-DATE.                                              CL**3
  3893         10 FILLER                     PIC 999.                      CL**3
  3894         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3895         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3896            15 RE-LO-CC                PIC 99.                       CL**3
  3897            15 RE-LO-YR                PIC 99.                       CL**3
  3898         10 RE-LO-MO                   PIC 99.                       CL**3
  3899         10 RE-LO-DA                   PIC 99.                       CL**3
  3900     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3901            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3902     05  WS-RE-HI-DATE.                                              CL**3
  3903         10 FILLER                     PIC 999.                      CL**3
  3904         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3905         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3906            15 RE-HI-CC                PIC 99.                       CL**3
  3907            15 RE-HI-YR                PIC 99.                       CL**3
  3908         10 RE-HI-MO                   PIC 99.                       CL**3
  3909         10 RE-HI-DA                   PIC 99.                       CL**3
  3910     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3911            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3912     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3913         10 FILLER                     PIC 999.                   ELCREINV
  3914         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3915         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3916            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3917            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3918         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3919         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3920     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3921            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3922     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3923         10  FILLER                    PIC 999.                   ELCREINV
  3924         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3925         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3926             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3927             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3928         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3929         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3930     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3931            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3932     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3933         10  FILLER                    PIC 999.                   ELCREINV
  3934         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3935         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3936             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3937             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3938         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  79
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3939         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3940     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3941            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3942
  3943 01  RC-REIN-HOLD-AREAS.
  3944     12  RC-REIN-LEVELS  OCCURS 30.
  3945         16  RC-REIN-COMP    PIC X(6).
  3946         16  RC-OLD-ISS      PIC X.
  3947         16  RC-NEW-ISS      PIC X.
  3948         16  RC-OLD-CNC      PIC X.
  3949         16  RC-NEW-CNC      PIC X.
  3950         16  RC-OLD-LF-CLM   PIC X.
  3951         16  RC-OLD-AH-CLM   PIC X.
  3952         16  RC-NEW-LF-CLM   PIC X.
  3953         16  RC-NEW-AH-CLM   PIC X.
  3954         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3955         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3956         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3957         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3958         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3959         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3960         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3961         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3962         16  RC-REIN-REM-SW  PIC X.
  3963     12  RC-REIN-LEVELS-END  PIC X(6).
  3964
  3965 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3966     12  TPC-COUNTERS    OCCURS 6.
  3967         16  TPL-ISS-PRM     PIC S9(9)V99.
  3968         16  TPA-ISS-PRM     PIC S9(9)V99.
  3969         16  TPL-CNC-PRM     PIC S9(9)V99.
  3970         16  TPA-CNC-PRM     PIC S9(9)V99.
  3971         16  TPL-ACCT-COM    PIC S9(9)V99.
  3972         16  TPA-ACCT-COM    PIC S9(9)V99.
  3973         16  TPL-CLAIMS      PIC S9(9)V99.
  3974         16  TPA-CLAIMS      PIC S9(9)V99.
  3975
  3976 01  HLD-DTS SYNC.
  3977     12  EOM-RUN-DATE        PIC 9(08).
  3978     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3979         16  EOM-CCYY.
  3980             20  EOM-CC      PIC 99.
  3981             20  EOM-YR      PIC 99.
  3982         16  EOM-MO          PIC 99.
  3983         16  EOM-DA          PIC 99.
  3984
  3985****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3986****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3987     12  OB-RUN-DATES OCCURS 2.
  3988         16  OB-CCYY         PIC 9(4).
  3989         16  OB-MO           PIC 99.
  3990         16  OB-DA           PIC 99.
  3991
  3992     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3993         88  OB-DATE-1-USED     VALUE '*'.
  3994     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3995         88  OB-DATE-2-USED     VALUE '*'.
  3996     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  80
* ECS010.cbl
  3997         88  OB-DATE-3-USED     VALUE '*'.
  3998     12  EARNING-START-DATE  PIC 9(08).
  3999     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  4000         16  E-ERN-START-CC  PIC 99.
  4001         16  E-ERN-START-YR  PIC 99.
  4002         16  E-ERN-START-MO  PIC 99.
  4003         16  E-ERN-START-DA  PIC 99.
  4004     12  EARNING-STOP-DATE   PIC 9(08).
  4005     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  4006         16  E-ERN-STOP-CC   PIC 99.
  4007         16  E-ERN-STOP-YR   PIC 99.
  4008         16  E-ERN-STOP-MO   PIC 99.
  4009         16  E-ERN-STOP-DA   PIC 99.
  4010     12  STOP-LF-DATE        PIC 9(08).
  4011     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  4012         16  STOP-LF-CC      PIC 99.
  4013         16  STOP-LF-YR      PIC 99.
  4014         16  STOP-LF-MO      PIC 99.
  4015         16  STOP-LF-DA      PIC 99.
  4016     12  STOP-AH-DATE        PIC 9(08).
  4017     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  4018         16  STOP-AH-CC      PIC 99.
  4019         16  STOP-AH-YR      PIC 99.
  4020         16  STOP-AH-MO      PIC 99.
  4021         16  STOP-AH-DA      PIC 99.
  4022     12  BIN-VALUATION-DT    PIC XX.
  4023     12  BIN-EOM-RUN-DATE    PIC XX.
  4024     12  LAST-YRS-DATE       PIC 9(08).
  4025     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4026         16  LYD-CCYY        PIC 9(04).
  4027         16  LYD-CCYR REDEFINES LYD-CCYY.
  4028             20  LYD-CC      PIC 99.
  4029             20  LYD-YR      PIC 99.
  4030         16  LYD-MO          PIC 99.
  4031         16  LYD-DA          PIC 99.
  4032     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4033     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4034         16  VAL-CC          PIC 99.
  4035         16  VAL-YR          PIC 99.
  4036         16  VAL-MO          PIC 99.
  4037         16  VAL-DA          PIC 99.
  4038     12  INCURRED-DATE       PIC 9(08).
  4039     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4040         16  DTO-CC          PIC 99.
  4041         16  DTO-YR          PIC 99.
  4042         16  DTO-MO          PIC 99.
  4043         16  DTO-DA          PIC 99.
  4044     12  REPORTED-DATE.
  4045         16  RPT-YR          PIC 99.
  4046         16  RPT-MO          PIC 99.
  4047         16  RPT-DA          PIC 99.
  4048     12  PAYMENT-DATE        PIC 9(08).
  4049     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4050         16  PAY-CC          PIC 99.
  4051         16  PAY-YR          PIC 99.
  4052         16  PAY-MO          PIC 99.
  4053         16  PAY-DA          PIC 99.
  4054     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  81
* ECS010.cbl
  4055     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4056         16  PAYTO-CC        PIC 99.
  4057         16  PAYTO-YR        PIC 99.
  4058         16  PAYTO-MO        PIC 99.
  4059         16  PAYTO-DA        PIC 99.
  4060
  4061 01  AH-RES-STATE-TABLE.
  4062     12  FILLER              PIC X(42)       VALUE
  4063             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4064     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4065
  4066 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4067     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4068
  4069 01  BILLING-COUNTERS    COMP-3.
  4070     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4071     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4072     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4073     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4074     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4075     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4076     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4077     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4078     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4079     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4080     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4081     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4082     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4083     12  BC-COMM             PIC S9(5)           VALUE +0.
  4084     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4085     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4086     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4087     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4088     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4089     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4090     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4091     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4092     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4093     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4094
  4095 01  FLAGS SYNC.
  4096     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4097         88  CHECK-BILLED                        VALUE 'Y'.
  4098     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4099         88  EOF-ON-TRANS                        VALUE '*'.
  4100     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4101         88  EOF-ON-CERT                         VALUE '*'.
  4102     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4103         88  PROCESSING-COMPLETED                VALUE '*'.
  4104     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4105         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4106     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4107         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4108     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4109         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4110     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4111         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4112     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  82
* ECS010.cbl
  4113         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4114     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4115         88  A-H-FULLY-EARNED                    VALUE '*'.
  4116     12  CNCL-FLG            PIC X               VALUE SPACE.
  4117     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4118         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4119         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4120     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4121         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4122     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4123         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4124     12  EP-FLG              PIC X               VALUE SPACE.
  4125     12  END-FLG             PIC X               VALUE SPACE.
  4126     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4127     12  PRIOR-CERT-IN-CNTRL.
  4128         16  PCIC-FIRST      PIC x(19)  value low-values.
  4129         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4130         16  pcic-cert-no    pic x(11)  value low-values.
  4131     12  ACCT-FLG            PIC X               VALUE SPACE.
  4132     12  STATE-FLG           PIC X               VALUE SPACE.
  4133     12  COMP-FLG            PIC X               VALUE SPACE.
  4134     12  CARR-FLG            PIC X               VALUE SPACE.
  4135     12  FINAL-FLG           PIC X               VALUE SPACE.
  4136     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4137     12  REIN-FLG            PIC X               VALUE SPACE.
  4138     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4139     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4140
  4141 01  TEXAS-REG-WORK-AREAS   SYNC.
  4142     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4143     12  TEX-FACT-2          PIC S999        COMP-3.
  4144     12  TEX-FACT-3          PIC S999        COMP-3.
  4145     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4146     12  TEX-FACT-5          PIC S999        COMP-3.
  4147     12  TEX-FACT-6          PIC S999        COMP-3.
  4148     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4149     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4150     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4151
  4152 01  NET-PAY-INTERFACE.
  4153     12  NP-APR              PIC S999V9(4)   COMP-3.
  4154     12  NP-ORIG             PIC S999        COMP-3.
  4155     12  NP-REM              PIC S999        COMP-3.
  4156     12  NP-OPT              PIC X.
  4157     12  NP-CAP              PIC S999        COMP-3.
  4158     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4159     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4160     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4161     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4162     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4163     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4164     12  NP-ACCOUNT          PIC X(10).
  4165
  4166 01  HOLDERS SYNC.
  4167     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4168     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4169     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4170     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  83
* ECS010.cbl
  4171     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4172     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4173     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4174     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4175     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4176     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4177     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4178     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4179     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4180     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4181     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4182     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4183     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4184     12  REM-TRM1            PIC S999V99  COMP-3.
  4185     12  REM-TRM2            PIC S999V99  COMP-3.
  4186     12  REM-TRM3            PIC S999V99  COMP-3.
  4187     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4188     12  TEM-TRM1            PIC S999V99  COMP-3.
  4189     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4190     12  ORIG-TERM           PIC S999V99  COMP-3.
  4191     12  HLD-CONTROL.
  4192         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4193         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4194         16  HLD-STATE       PIC XX              VALUE SPACES.
  4195         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4196     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4197
  4198 01  DISPLAY-IBNR-LINE.
  4199     05  FILLER                  PIC X       VALUE SPACES.
  4200     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4201     05  FILLER                  PIC XX      VALUE SPACES.
  4202     05  DIL-TYPE                PIC X       VALUE SPACES.
  4203     05  FILLER                  PIC X       VALUE SPACES.
  4204     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4205     05  FILLER                  PIC XXX     VALUE SPACES.
  4206     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4207
  4208 01  DISPLAY-HD-1.
  4209     05  FILLER      PIC X       VALUE SPACES.
  4210     05  FILLER      PIC X(50)   VALUE SPACES.
  4211     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4212     05  FILLER      PIC X(51)   VALUE SPACES.
  4213     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4214
  4215 01  DISPLAY-HD-2.
  4216     05  FILLER                 PIC X       VALUE SPACE.
  4217     05  FILLER                 PIC X(57)   VALUE SPACES.
  4218     05  DIS-DATE               PIC X(8).
  4219     05  FILLER                 PIC X(66)   VALUE SPACES.
  4220
  4221 01  DISPLAY-LINE.
  4222     05  DL-FULL.
  4223         10  FILLER           PIC X       VALUE SPACE.
  4224         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4225         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4226
  4227 01  PRT-HDNGS SYNC.
  4228     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  84
* ECS010.cbl
  4229         16  FILLER      PIC X       VALUE '1'.
  4230         16  FILLER      PIC X(53)   VALUE SPACES.
  4231         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4232         16  FILLER      PIC X(48)   VALUE SPACES.
  4233         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4234     12  TR-HD-2.
  4235         16  FILLER      PIC X       VALUE SPACE.
  4236         16  FILLER      PIC X(47)   VALUE SPACES.
  4237         16  TRHDNM      PIC X(30).
  4238         16  FILLER      PIC X(42)   VALUE SPACES.
  4239         16  TR-RN-DT    PIC X(8).
  4240     12  TR-HD-3.
  4241         16  FILLER      PIC X       VALUE SPACE.
  4242         16  FILLER      PIC X(53)   VALUE SPACES.
  4243         16  TR-MODAYR   PIC X(18).
  4244         16  FILLER      PIC X       VALUE SPACE.
  4245         16  TR-YRASK    PIC X       VALUE SPACE.
  4246         16  FILLER      PIC X(46)   VALUE SPACES.
  4247         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4248         16  TR-PG       PIC ZZ,ZZ9.
  4249     12  TR-HD-4.
  4250         16  FILLER      PIC X       VALUE SPACE.
  4251         16  TR-AGCY     PIC X(30).
  4252     12  TR-HD-5.
  4253         16  FILLER      PIC X       VALUE SPACE.
  4254         16  TR-CARR     PIC X.
  4255         16  FILLER      PIC X       VALUE '-'.
  4256         16  TR-GROUP    PIC X(6).
  4257         16  FILLER      PIC X       VALUE '-'.
  4258         16  TR-ST-NO    PIC X(2).
  4259         16  FILLER      PIC X       VALUE '-'.
  4260         16  TR-AG-NO    PIC X(10).
  4261         16  FILLER      PIC X(23)   VALUE SPACES.
  4262         16  TR5-RP-TYP.
  4263             20  FILLER  PIC X(20)   VALUE
  4264                     '* * * * TRANSACTION '.
  4265             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4266     12  TR-HD-6.
  4267         16  FILLER      PIC X       VALUE SPACE.
  4268         16  TR-CE-MO    PIC XX.
  4269         16  FILLER      PIC X       VALUE '-'.
  4270         16  TR-CE-DA    PIC XX.
  4271         16  FILLER      PIC X       VALUE '-'.
  4272         16  TR-CE-YR    PIC XX.
  4273         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4274         16  TR-CX.
  4275             20  TR-CX-MO PIC XX.
  4276             20  HSHR1    PIC X.
  4277             20  TR-CX-DA PIC XX.
  4278             20  HSHR2    PIC X.
  4279             20  TR-CX-YR PIC XX.
  4280     12  TR-HD-7.
  4281         16  FILLER  PIC X      VALUE '0'.
  4282         16  FILLER  PIC X(24)  VALUE SPACES.
  4283         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4284         16  TR-7-LF PIC X(6).
  4285         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4286         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  85
* ECS010.cbl
  4287         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4288         16  TR-7-AH PIC X(6).
  4289         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4290         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4291     12  TR-HD-8.
  4292         16  FILLER  PIC X      VALUE SPACE.
  4293         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4294         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4295         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4296         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4297         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4298     12  TR-HD-9.
  4299         16  FILLER  PIC X      VALUE SPACE.
  4300         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4301         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4302         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4303         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4304         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4305         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4306     12  TR-TTL-HD.
  4307         16  FILLER      PIC X       VALUE '0'.
  4308         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4309         16  FILLER      PIC XX      VALUE SPACES.
  4310         16  TTL-HD-DS   PIC X(60)   VALUE
  4311             'ECS010 CONTROL TOTALS'.
  4312
  4313 01  TR-DTL.
  4314     12  FILLER                  PIC X           VALUE SPACE.
  4315     12  TR-DTL1.
  4316         16  TRD-CERT            PIC X(11).
  4317         16  TRD-ISDT.
  4318             20  FILLER          PIC X           VALUE SPACE.
  4319             20  TRD-ISMO        PIC XX.
  4320             20  TRD-IS-S1       PIC X           VALUE '/'.
  4321             20  TRD-ISDA        PIC XX.
  4322             20  TRD-IS-S2       PIC X           VALUE '/'.
  4323             20  TRD-ISYR        PIC XX.
  4324             20  FILLER          PIC X           VALUE SPACE.
  4325         16  TRD-AGE             PIC XX.
  4326     12  TR-DTL2.
  4327         16  FILLER              PIC X           VALUE SPACE.
  4328         16  TRD-LFTYP           PIC XXX.
  4329         16  FILLER              PIC X           VALUE SPACE.
  4330         16  TRD-LFTRM           PIC ZZ9.
  4331         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4332         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4333         16  TRD-LFACTDT.
  4334             20  FILLER          PIC X           VALUE SPACE.
  4335             20  TRD-LFACTMO     PIC XX.
  4336             20  TRD-LF-S1       PIC X           VALUE '/'.
  4337             20  TRD-LFACTDA     PIC XX.
  4338             20  TRD-LF-S2       PIC X           VALUE '/'.
  4339             20  TRD-LFACTYR     PIC XX.
  4340             20  FILLER          PIC X           VALUE SPACE.
  4341         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4342         16  FILLER              PIC X           VALUE SPACE.
  4343         16  TRD-LF-STATUS       PIC X.
  4344         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  86
* ECS010.cbl
  4345         16  TRD-AHTYP           PIC XXX.
  4346         16  FILLER              PIC X           VALUE SPACE.
  4347         16  TRD-AHTRM           PIC ZZ9.
  4348         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4349         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4350         16  TRD-AHACTDT.
  4351             20  FILLER          PIC X           VALUE SPACE.
  4352             20  TRD-AHACTMO     PIC XX.
  4353             20  TRD-AH-S1       PIC X           VALUE '/'.
  4354             20  TRD-AHACTDA     PIC XX.
  4355             20  TRD-AH-S2       PIC X           VALUE '/'.
  4356             20  TRD-AHACTYR     PIC XX.
  4357             20  FILLER          PIC X           VALUE SPACE.
  4358         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4359         16  FILLER              PIC X           VALUE SPACE.
  4360         16  TRD-AH-STATUS       PIC X.
  4361     12  TR-DTL3 REDEFINES TR-DTL2.
  4362         16  FILLER              PIC X(20).
  4363         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4364         16  FILLER              PIC X.
  4365         16  TRD-IBNRX           PIC X(4).
  4366         16  FILLER              PIC X(2).
  4367         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4368         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4369                                 PIC X(11).
  4370         16  FILLER              PIC X.
  4371         16  TRD-PAYCURX         PIC X(8).
  4372         16  FILLER              PIC X(2).
  4373         16  TRD-FUTRSV-DATA.
  4374             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4375             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4376                                 PIC X(11).
  4377             20  FILLER          PIC X.
  4378             20  TRD-FUTRSVX     PIC X(6).
  4379         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4380             20  TRD-BENEFIT-X   PIC X(10).
  4381             20  TRD-BENEFIT-CODE
  4382                                 PIC X(02).
  4383             20  FILLER          PIC X(06).
  4384         16  FILLER              PIC X(4).
  4385         16  TRD-RSV-DESC        PIC X(6).
  4386         16  TRD-RSV-ACTION      PIC X(21).
  4387
  4388 01  DET-PR-UREC.
  4389     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4390     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4391     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4392     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4393     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4394     12  DET-SEX             PIC X.
  4395     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4396     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4397     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4398     12  DET-PR-MEM          PIC X(12).
  4399     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4400     12  DET-PR-SS           PIC X(11).
  4401     12  FILLER              PIC XXX      VALUE SPACES.
  4402     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  87
* ECS010.cbl
  4403
  4404 01  DET-PR-UREC-2.
  4405     12  FILLER              PIC X        VALUE SPACE.
  4406     12  DET-LF-DESC         PIC XX.
  4407     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4408     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4409     12  FILLER              PIC X(4)     VALUE ' TO '.
  4410     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4411     12  FILLER              PIC X        VALUE SPACE.
  4412     12  DET-AH-DESC         PIC XX.
  4413     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4414     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4415     12  FILLER              PIC X(4)     VALUE ' TO '.
  4416     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4417     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4418     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4419     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4420     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4421     12  FILLER              PIC X(5)     VALUE SPACES.
  4422     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4423
  4424 01  DET-PR-UREC-3.
  4425     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4426     12  DET-IND-GRP         PIC X.
  4427     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4428     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4429     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4430     12  DET-POL-FORM        PIC X(12).
  4431     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4432     12  DET-LOAN-OFFICER    PIC XXX.
  4433     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4434     12  DET-USER-CODE       PIC X.
  4435     12  FILLER              PIC X(8)     VALUE SPACES.
  4436     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4437
  4438 01  DET-PR-UREC-4.
  4439     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4440     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4441     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4442     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4443     12  FILLER              PIC X(37)    VALUE SPACES.
  4444     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4445
  4446 01  DET-PR-UREC-5.
  4447     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4448     12  DET-LF-BEN-CD       PIC XX.
  4449     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4450     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4451     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4452     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4453     12  FILLER              PIC X(30)    VALUE SPACES.
  4454     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4455
  4456 01  DET-PR-UREC-6.
  4457     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4458     12  DET-AH-BEN-CD       PIC XX.
  4459     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4460     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  88
* ECS010.cbl
  4461     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4462     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4463     12  FILLER              PIC X(30)    VALUE SPACES.
  4464     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4465
  4466 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4467     88  WS-CHANGE-REC              VALUE 'Y'.
  4468
  4469 01  TOTAL-PAGE-HD1.
  4470     12  FILLER              PIC X               VALUE SPACE.
  4471     12  TPH1-TYPE           PIC X(8).
  4472     12  TPH1-DESC.
  4473         16  TPH1-ST-CODE    PIC XX.
  4474         16  FILLER          PIC XXX.
  4475         16  TPH1-ST-DESC    PIC X(20).
  4476
  4477 01  TOTAL-PAGE-HD2.
  4478     12  FILLER              PIC X           VALUE SPACE.
  4479     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4480     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4481     12  FILLER              PIC X(9)        VALUE SPACES.
  4482     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4483     12  FILLER              PIC X(11)       VALUE SPACES.
  4484     12  FILLER              PIC X(3)        VALUE 'NET'.
  4485     12  FILLER              PIC X(11)       VALUE SPACES.
  4486     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4487     12  FILLER              PIC X(10)       VALUE SPACES.
  4488     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4489
  4490 01  TOTAL-PAGE-HD3.
  4491     12  FILLER              PIC X           VALUE SPACE.
  4492     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4493     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4494     12  FILLER              PIC X(10)       VALUE SPACES.
  4495     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4496     12  FILLER              PIC X(10)       VALUE SPACES.
  4497     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4498     12  FILLER              PIC X(7)        VALUE SPACES.
  4499     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4500     12  FILLER              PIC X(08)       VALUE SPACES.
  4501     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4502     12  FILLER              PIC X(11)       VALUE SPACES.
  4503     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4504
  4505 01  TOTAL-PAGE-DETAIL.
  4506     12  FILLER              PIC X(5).
  4507     12  TPD-DESC            PIC X(6).
  4508     12  FILLER              PIC X(3).
  4509     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4510     12  FILLER              PIC X(2).
  4511     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4512     12  FILLER              PIC X(2).
  4513     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4514     12  FILLER              PIC X(2).
  4515     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4516     12  FILLER              PIC X(2).
  4517     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4518     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  89
* ECS010.cbl
  4519     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4520     12  FILLER              PIC X(4).
  4521     12  TPD-LO-CERT         PIC X(6).
  4522     12  FILLER              PIC X(2).
  4523     12  TPD-HI-CERT         PIC X(6).
  4524*    12  FILLER              PIC X.
  4525*    12  TPD-LO-CERT         PIC X(8).
  4526*    12  FILLER              PIC X.
  4527*    12  TPD-HI-CERT         PIC X(8).
  4528
  4529 01  DUPE-CERT-TABLE.
  4530     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4531         16  DUPE-ENTRY      PIC X(36).
  4532         16  DUPE-STATUS     PIC X(01).
  4533         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4534         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4535
  4536 01  MISMATCH-HEADING-1.
  4537     12  FILLER              PIC X           VALUE '1'.
  4538     12  FILLER              PIC X(45)       VALUE SPACES.
  4539     12  FILLER              PIC X(42)       VALUE
  4540             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4541     12  FILLER              PIC X(35)       VALUE SPACES.
  4542     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4543
  4544 01  MISMATCH-HEADING-2.
  4545     12  FILLER              PIC X           VALUE '0'.
  4546     12  FILLER              PIC X(44)       VALUE
  4547             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4548     12  FILLER              PIC X(44)       VALUE
  4549             'YPE      CERT IN CONTROL                    '.
  4550     12  FILLER              PIC X(44)       VALUE
  4551             '        CERT OUT CONTROL           STATUS   '.
  4552
  4553 01  MISMATCH-DETAIL.
  4554     12  FILLER              PIC X           VALUE '0'.
  4555     12  FILLER              PIC X           VALUE SPACES.
  4556     12  DTL-MATCH-CONTROL   PIC X(36).
  4557     12  FILLER              PIC X(3)        VALUE SPACES.
  4558     12  DTL-REC-TYPE        PIC X.
  4559     12  FILLER              PIC X(2)        VALUE SPACES.
  4560     12  DTL-REC-TYPE-DESC   PIC X(3).
  4561     12  FILLER              PIC X(3)        VALUE SPACES.
  4562     12  DTL-CERT-IN-CONTROL
  4563                             PIC X(36).
  4564     12  FILLER              PIC X           VALUE SPACES.
  4565     12  DTL-CERT-OUT-CONTROL
  4566                             PIC X(36).
  4567     12  FILLER              PIC X           VALUE SPACES.
  4568     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4569     12  FILLER              PIC X(2)        VALUE SPACES.
  4570
  4571 01  MISMATCH-DETAIL-2.
  4572     12  FILLER              PIC X           VALUE ' '.
  4573     12  FILLER              PIC X           VALUE SPACES.
  4574     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4575             ' LIFE PREMIUM = '.
  4576     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  90
* ECS010.cbl
  4577     12  FILLER              PIC X           VALUE SPACES.
  4578     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4579             'LIFE ALT PREM = '.
  4580     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4581     12  FILLER              PIC XX          VALUE SPACES.
  4582     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4583             'A/H PREMIUM = '.
  4584     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4585     12  FILLER              PIC X(39)       VALUE SPACES.
  4586
  4587 01  MISMATCH-DETAIL-3.
  4588     12  FILLER              PIC X           VALUE ' '.
  4589     12  FILLER              PIC X           VALUE SPACES.
  4590     12  FILLER              PIC X(16)       VALUE
  4591             ' LIFE  REFUND = '.
  4592     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4593     12  FILLER              PIC X           VALUE SPACES.
  4594     12  FILLER              PIC X(16)       VALUE
  4595             'A & H  REFUND = '.
  4596     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4597     12  FILLER              PIC X(72)       VALUE SPACES.
  4598
  4599 01  MISMATCH-DETAIL-4.
  4600     12  FILLER              PIC X           VALUE ' '.
  4601     12  FILLER              PIC X           VALUE SPACES.
  4602     12  FILLER              PIC X(16)       VALUE
  4603             ' LIFE  CLAIM  = '.
  4604     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4605     12  FILLER              PIC X           VALUE SPACES.
  4606     12  FILLER              PIC X(16)       VALUE
  4607             'A & H  CLAIM  = '.
  4608     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4609     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  91
* ECS010.cbl
  4611*
  4612*
  4613* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  92
* ECS010.cbl
  4615 01  PB-STARTS-HERE              PIC X(48)
  4616       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4617
* 4618                             COPY ERCPNDB.
  4619******************************************************************
  4620*                                                                *
  4621*                                                                *
  4622*                            ERCPNDB.                            *
  4623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4624*                            VMOD=2.025                          *
  4625*                                                                *
  4626*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4627*                                                                *
  4628******************************************************************
  4629*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4630*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4631******************************************************************
  4632*                                                                *
  4633*                                                                *
  4634*   FILE TYPE = VSAM,KSDS                                        *
  4635*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4636*                                                                *
  4637*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4638*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4639*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4640*                                                 RKP=13,LEN=36  *
  4641*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4642*                                      AND CHG-SEQ.)             *
  4643*                                                RKP=49,LEN=11   *
  4644*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4645*                                      AND CHG-SEQ.)             *
  4646*                                                RKP=60,LEN=15   *
  4647*                                                                *
  4648*   LOG = NO                                                     *
  4649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4650******************************************************************
  4651******************************************************************
  4652*                   C H A N G E   L O G
  4653*
  4654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4655*-----------------------------------------------------------------
  4656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4657* EFFECTIVE    NUMBER
  4658*-----------------------------------------------------------------
  4659* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4660* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4661* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4662* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4663* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4664* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4665* 032306                   PEMA  ADD BOW LOAN NUMBER
  4666* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4667* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4668* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4669* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4670* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4671* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4672* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4673* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4674******************************************************************
  4675
  4676 01  PENDING-BUSINESS.
  4677     12  PB-RECORD-ID                     PIC XX.
  4678         88  VALID-PB-ID                        VALUE 'PB'.
  4679
  4680     12  PB-CONTROL-PRIMARY.
  4681         16  PB-COMPANY-CD                PIC X.
  4682         16  PB-ENTRY-BATCH               PIC X(6).
  4683         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4684         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4685
  4686     12  PB-CONTROL-BY-ACCOUNT.
  4687         16  PB-COMPANY-CD-A1             PIC X.
  4688         16  PB-CARRIER                   PIC X.
  4689         16  PB-GROUPING.
  4690             20  PB-GROUPING-PREFIX       PIC XXX.
  4691             20  PB-GROUPING-PRIME        PIC XXX.
  4692         16  PB-STATE                     PIC XX.
  4693         16  PB-ACCOUNT.
  4694             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4695             20  PB-ACCOUNT-PRIME         PIC X(6).
  4696         16  PB-CERT-EFF-DT               PIC XX.
  4697         16  PB-CERT-NO.
  4698             20  PB-CERT-PRIME            PIC X(10).
  4699             20  PB-CERT-SFX              PIC X.
  4700         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4701
  4702         16  PB-RECORD-TYPE               PIC X.
  4703             88  PB-MAILING-DATA                VALUE '0'.
  4704             88  PB-ISSUE                       VALUE '1'.
  4705             88  PB-CANCELLATION                VALUE '2'.
  4706             88  PB-BATCH-TRAILER               VALUE '9'.
  4707
  4708     12  PB-CONTROL-BY-ORIG-BATCH.
  4709         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4710         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4711         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4712         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4713
  4714     12  PB-CONTROL-BY-CSR.
  4715         16  PB-CSR-COMPANY-CD            PIC X.
  4716         16  PB-CSR-ID                    PIC X(4).
  4717         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4718         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4719         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4720******************************************************************
  4721*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4722******************************************************************
  4723
  4724     12  PB-LAST-MAINT-DT                 PIC XX.
  4725     12  PB-LAST-MAINT-BY                 PIC X(4).
  4726     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4727
  4728     12  PB-RECORD-BODY                   PIC X(375).
  4729
  4730     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4731         16  PB-CERT-ORIGIN               PIC X.
  4732             88  CLASIC-CREATED-CERT         VALUE '1'.
  4733         16  PB-I-NAME.
  4734             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4735             20  PB-I-INSURED-FIRST-NAME.
  4736                 24  PB-I-INSURED-1ST-INIT PIC X.
  4737                 24  FILLER                PIC X(9).
  4738             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4739         16  PB-I-AGE                     PIC S99   COMP-3.
  4740         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4741         16  PB-I-BIRTHDAY                PIC XX.
  4742         16  PB-I-INSURED-SEX             PIC X.
  4743             88  PB-SEX-MALE     VALUE 'M'.
  4744             88  PB-SEX-FEMALE   VALUE 'F'.
  4745
  4746         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4747         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4748         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4749         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4750         16  PB-I-SKIP-CODE               PIC X.
  4751             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4752             88  PB-SKIP-JULY              VALUE '1'.
  4753             88  PB-SKIP-AUGUST            VALUE '2'.
  4754             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4755             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4756             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4757             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4758             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4759             88  PB-SKIP-JUNE              VALUE '8'.
  4760             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4761             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4762             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4763         16  PB-I-TERM-TYPE               PIC X.
  4764             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4765             88  PB-PAID-WEEKLY            VALUE 'W'.
  4766             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4767             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4768             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4769         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4770         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4771         16  PB-I-DATA-ENTRY-SW           PIC X.
  4772             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4773             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4774             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4775             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4776         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4777         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4778*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4779         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4780         16  FILLER                       PIC X.
  4781
  4782         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4783             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4784             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4785                                                   '90' THRU '99'.
  4786         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4787                                          PIC XX.
  4788         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4789         16  PB-I-AMOUNT-FINANCED REDEFINES
  4790                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4791         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4792         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4793                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4794         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4795         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4796         16  PB-I-CLP-AMOUNT REDEFINES
  4797                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4798         16  PB-I-LF-CALC-FLAG            PIC X.
  4799             88 PB-COMP-LF-PREM               VALUE '?'.
  4800         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4801         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4802         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4803         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4804         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4805         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4806         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4807         16  PB-I-LF-ABBR                 PIC XXX.
  4808         16  PB-I-LF-INPUT-CD             PIC XX.
  4809
  4810         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4811             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4812             88  PB-INVALID-AH               VALUE '  ' '00'
  4813                                                   '90' THRU '99'.
  4814         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4815         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4816         16  PB-I-AH-CALC-FLAG            PIC X.
  4817             88 PB-COMP-AH-PREM                  VALUE '?'.
  4818         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4819         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4820         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4821         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4822         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4823         16  PB-I-AH-ABBR                 PIC XXX.
  4824         16  PB-I-AH-INPUT-CD             PIC XXX.
  4825
  4826         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4827         16  PB-I-REIN-TABLE              PIC XXX.
  4828         16  PB-I-BUSINESS-TYPE           PIC 99.
  4829         16  PB-I-INDV-GRP-CD             PIC X.
  4830         16  PB-I-MORT-CODE.
  4831             20  PB-I-TABLE               PIC X.
  4832             20  PB-I-INTEREST            PIC XX.
  4833             20  PB-I-MORT-TYP            PIC X.
  4834         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4835         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4836         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4837         16  PB-I-INDV-GRP-OVRD           PIC X.
  4838         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4839         16  PB-I-SIG-SW                  PIC X.
  4840             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4841         16  PB-I-RATE-CLASS              PIC XX.
  4842         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4843         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4844         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4845         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4846         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4847         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4848         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4849         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4850         16  PB-I-OB-FLAG                 PIC X.
  4851             88  PB-I-OB                      VALUE 'B'.
  4852             88  PB-I-SUMMARY                 VALUE 'Z'.
  4853         16  PB-I-ENTRY-STATUS            PIC X.
  4854             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4855                                              'M' '5' '9' '2'.
  4856             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4857             88  PB-I-POLICY-PENDING          VALUE '2'.
  4858             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4859             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4860             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4861             88  PB-I-REIN-ONLY               VALUE '9'.
  4862             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4863             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4864             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4865             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4866         16  PB-I-INT-CODE                PIC X.
  4867             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4868             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4869         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4870         16  PB-I-SOC-SEC-NO              PIC X(11).
  4871         16  PB-I-MEMBER-NO               PIC X(12).
  4872         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4873*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4874         16  PB-I-OLD-LOF                 PIC XXX.
  4875         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4876         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4877         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4878         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4879         16  PB-I-LIFE-INDICATOR          PIC X.
  4880             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4881         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4882         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4883                                          PIC S9(5)V99    COMP-3.
  4884         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4885             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4886             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4887         16  PB-I-1ST-PMT-DT              PIC XX.
  4888         16  PB-I-JOINT-INSURED.
  4889             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4890             20 PB-I-JOINT-FIRST-NAME.
  4891                24  PB-I-JOINT-FIRST-INIT PIC X.
  4892                24  FILLER                PIC X(9).
  4893             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4894*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4895         16  PB-I-BENEFICIARY-NAME.
  4896             20  PB-I-BANK-NUMBER         PIC X(10).
  4897             20  FILLER                   PIC X(15).
  4898         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4899         16  PB-I-REFERENCE               PIC X(12).
  4900         16  FILLER REDEFINES PB-I-REFERENCE.
  4901             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4902             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4903             20  PB-I-CLP-STATE           PIC XX.
  4904         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4905             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4906             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4907             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4908         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4909         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4910         16  PB-I-RESIDENT-STATE          PIC XX.
  4911         16  PB-I-RATE-CODE               PIC X(4).
  4912         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4913         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4914         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4915         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4916         16  PB-I-BANK-NOCHRGB            PIC 99.
  4917         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4918         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4919
  4920     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4921         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4922             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4923         16  PB-C-CANCEL-ORIGIN           PIC X.
  4924             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4925         16  PB-C-LF-CANCEL-DT            PIC XX.
  4926         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4927         16  PB-C-LF-CALC-REQ             PIC X.
  4928             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4929         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4930         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4931         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4932             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4933         16  PB-C-AH-CANCEL-DT            PIC XX.
  4934         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4935         16  PB-C-AH-CALC-REQ             PIC X.
  4936             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4937         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4938         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4939         16  PB-C-LAST-NAME               PIC X(15).
  4940         16  PB-C-REFUND-SW               PIC X.
  4941             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4942             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4943         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4944         16  PB-C-PAYEE-CODE              PIC X(6).
  4945         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4946         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4947         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4948         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4949         16  PB-C-REFERENCE               PIC X(12).
  4950         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4951         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4952         16  PB-C-POST-CARD-IND           PIC X.
  4953         16  PB-C-CANCEL-REASON           PIC X.
  4954         16  PB-C-REF-INTERFACE-SW        PIC X.
  4955         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4956         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4957         16  FILLER                       PIC X(01).
  4958*        16  FILLER                       PIC X(18).
  4959         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4960*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4961         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4962         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4963             20  PB-CI-INSURED-NAME.
  4964                 24  PB-CI-LAST-NAME      PIC X(15).
  4965                 24  PB-CI-INITIALS       PIC XX.
  4966             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4967             20  PB-CI-INSURED-SEX        PIC X.
  4968             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4969             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4970             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4971             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4972             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4973             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4974             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4975             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4976             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4977             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4978             20  PB-CI-RATE-CLASS         PIC XX.
  4979             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4980             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4981             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4982             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4983             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4984             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4985             20  PB-CI-LF-ABBR            PIC X(3).
  4986             20  PB-CI-AH-ABBR            PIC X(3).
  4987             20  PB-CI-OB-FLAG            PIC X.
  4988                 88  PB-CI-OB                VALUE 'B'.
  4989             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4990                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4991                                           'M' '4' '5' '9' '2'.
  4992                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4993                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4994                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4995                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4996                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4997                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4998                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4999                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5000                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5001                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5002                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5003                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5004             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5005                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5006                                           'M' '4' '5' '9' '2'.
  5007                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5008                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5009                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5010                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5011                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5012                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5013                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5014                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5015                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5016                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5017                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5018                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5019             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5020             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5021             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5022             20  PB-CI-MEMBER-NO          PIC X(12).
  5023             20  PB-CI-INT-CODE           PIC X.
  5024                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5025                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5026             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5027             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5028             20  PB-CI-COMP-EXCP-SW       PIC X.
  5029                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5030                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5031             20  PB-CI-ENTRY-STATUS       PIC X.
  5032             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5033             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5034             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5035             20  PB-CI-DEATH-DT           PIC XX.
  5036             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5037             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5038             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5039             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5040             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5041             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5042             20  PB-CI-ENTRY-DT              PIC XX.
  5043             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5044             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5045             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5046             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5047             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5048             20  PB-CI-OLD-LOF               PIC XXX.
  5049*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5050             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5051             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5052             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5053             20  PB-CI-INDV-GRP-CD           PIC X.
  5054             20  PB-CI-BENEFICIARY-NAME.
  5055                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5056                 24  FILLER                  PIC X(15).
  5057             20  PB-CI-NOTE-SW               PIC X.
  5058             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5059             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5060             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5061             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5062             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5063             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5064             20  PB-CI-FIRST-NAME            PIC X(10).
  5065             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5066
  5067         16  FILLER                       PIC X(13).
  5068*032306  16  FILLER                       PIC X(27).
  5069*        16  FILLER                       PIC X(46).
  5070
  5071     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5072         16  FILLER                       PIC X(10).
  5073         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5074         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5075         16  PB-M-INSURED-MID-INIT        PIC X.
  5076         16  PB-M-INSURED-AGE             PIC 99.
  5077         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5078         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5079         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5080         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5081         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5082         16  PB-M-INSURED-CITY-STATE.
  5083             20  PB-M-INSURED-CITY        PIC X(28).
  5084             20  PB-M-INSURED-STATE       PIC XX.
  5085         16  PB-M-INSURED-ZIP-CODE.
  5086             20  PB-M-INSURED-ZIP-PRIME.
  5087                 24  PB-M-INSURED-ZIP-1   PIC X.
  5088                     88  PB-M-CANADIAN-POST-CODE
  5089                                             VALUE 'A' THRU 'Z'.
  5090                 24  FILLER               PIC X(4).
  5091             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5092         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5093                                        PB-M-INSURED-ZIP-CODE.
  5094             20  PM-M-INS-CAN-POST1       PIC XXX.
  5095             20  PM-M-INS-CAN-POST2       PIC XXX.
  5096             20  FILLER                   PIC XXX.
  5097         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5098         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5099         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5100         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5101         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5102         16  PB-M-CRED-BENE-CITYST.
  5103             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5104             20  PB-M-CRED-BENE-STATE     PIC XX.
  5105
  5106         16  FILLER                       PIC X(92).
  5107
  5108     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5109         16  FILLER                       PIC X(10).
  5110         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5111         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5112         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5113         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5114         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5115         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5116         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5117         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5118         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5119         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5120         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5121         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5122         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5123         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5124         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5125         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5126         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5127         16  PB-ACCOUNT-NAME              PIC X(30).
  5128         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5129         16  PB-REFERENCE                 PIC X(12).
  5130         16  PB-B-RECEIVED-DT             PIC XX.
  5131         16  FILLER                       PIC X(234).
  5132
  5133     12  PB-RECORD-STATUS.
  5134         16  PB-CREDIT-SELECT-DT          PIC XX.
  5135         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5136         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5137         16  PB-BILLING-STATUS            PIC X.
  5138             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5139             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5140             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5141         16  PB-RECORD-BILL               PIC X.
  5142             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5143             88  PB-RECORD-RETURNED           VALUE 'R'.
  5144             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5145             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5146             88  PB-OVERRIDE-AH               VALUE 'A'.
  5147             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5148         16  PB-BATCH-ENTRY               PIC X.
  5149             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5150             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5151             88  PB-REISSUED-CERT             VALUE 'E'.
  5152             88  PB-MONTHLY-CERT              VALUE 'M'.
  5153             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5154             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5155             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5156         16  PB-FORCE-CODE                PIC X.
  5157             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5158             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5159             88  PB-CANCEL-FORCE              VALUE '8'.
  5160             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5161             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5162             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5163             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5164             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5165             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5166             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5167         16  PB-FATAL-FLAG                PIC X.
  5168             88  PB-FATAL-ERRORS              VALUE 'X'.
  5169         16  PB-FORCE-ER-CD               PIC X.
  5170             88  PB-FORCE-ERRORS              VALUE 'F'.
  5171             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5172         16  PB-WARN-ER-CD                PIC X.
  5173             88  PB-WARNING-ERRORS            VALUE 'W'.
  5174         16  FILLER                       PIC X.
  5175         16  PB-OUT-BAL-CD                PIC X.
  5176             88  PB-OUT-OF-BAL                VALUE 'O'.
  5177         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5178         16  PB-AH-OVERRIDE-L1            PIC X.
  5179         16  PB-INPUT-DT                  PIC XX.
  5180         16  PB-INPUT-BY                  PIC X(4).
  5181         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5182         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5183         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5184         16  PB-LF-EARNING-METHOD         PIC X.
  5185         16  PB-AH-EARNING-METHOD         PIC X.
  5186         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5187         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5188         16  PB-REIN-CD                   PIC XXX.
  5189         16  PB-LF-REFUND-TYPE            PIC X.
  5190         16  PB-AH-REFUND-TYPE            PIC X.
  5191         16  PB-ACCT-EFF-DT               PIC XX.
  5192         16  PB-ACCT-EXP-DT               PIC XX.
  5193         16  PB-COMPANY-ID                PIC X(3).
  5194         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 102
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5195         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5196         16  PB-SV-CARRIER                PIC X.
  5197         16  PB-SV-GROUPING               PIC X(6).
  5198         16  PB-SV-STATE                  PIC XX.
  5199         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5200         16  PB-GA-BILLING-INFO.
  5201             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5202                                          PIC XX.
  5203         16  PB-SV-REMIT-TO  REDEFINES
  5204             PB-GA-BILLING-INFO           PIC X(10).
  5205         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5206         16  PB-I-LOAN-OFFICER            PIC X(5).
  5207         16  PB-I-VIN                     PIC X(17).
  5208
  5209         16  FILLER                       PIC X(04).
  5210         16  IMNET-BYPASS-SW              PIC X.
  5211
  5212******************************************************************
  5213*                COMMON EDIT ERRORS                              *
  5214******************************************************************
  5215
  5216     12  PB-COMMON-ERRORS.
  5217         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5218                                           PIC S9(4)     COMP.
  5219
  5220******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 103
* ECS010.cbl
  5222 01  PC-STARTS-HERE              PIC X(48)
  5223       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5224
* 5225                             COPY ERCPNDC.
  5226******************************************************************04/29/98
  5227*                                                                *ERCPNDC
  5228*                                                                *ERCPNDC
  5229*                            ERCPNDC                             *   LV003
  5230*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5231*                            VMOD=2.004                          *   CL**2
  5232*                                                                *ERCPNDC
  5233*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5234*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5235*                                                                *ERCPNDC
  5236*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5237*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5238*                                                                *ERCPNDC
  5239*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5240*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5241*                                                                *ERCPNDC
  5242*   LOG = YES                                                    *ERCPNDC
  5243*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5244******************************************************************ERCPNDC
  5245                                                                  ERCPNDC
  5246 01  PENDING-CLAIMS.                                              ERCPNDC
  5247     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5248         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5249                                                                  ERCPNDC
  5250     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5251         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5252         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5253         16  PC-GROUPING.                                         ERCPNDC
  5254             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5255             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5256         16  PC-STATE                     PIC XX.                 ERCPNDC
  5257         16  PC-ACCOUNT.                                          ERCPNDC
  5258             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5259             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5260         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5261         16  PC-CERT-NO.                                          ERCPNDC
  5262             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5263             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5264         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5265         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5266                                                                  ERCPNDC
  5267         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5268             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5269             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5270         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5271                                                                  ERCPNDC
  5272     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5273     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5274     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5275                                                                  ERCPNDC
  5276     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5277         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5278             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5279             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5280             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5281             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5282         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5283         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5284         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5285         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5286         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5287         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5288         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5289         16  FILLER                       PIC XX.                 ERCPNDC
  5290         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5291             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5292             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5293             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5294             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5295             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5296             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5297             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5298                                                                  ERCPNDC
  5299         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5300         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5301         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5302         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5303                                                                  ERCPNDC
  5304         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5305         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5306         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5307                                                                  ERCPNDC
  5308         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5309             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5310                                                                  ERCPNDC
  5311         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5312         16  FILLER                       PIC X(48).              ERCPNDC
  5313                                                                  ERCPNDC
  5314         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5315             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5316                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5317                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5318             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5319             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5320             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5321             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5322             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5323             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5324             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5325             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5326             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5327             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5328             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5329             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5330             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5331                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5332             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5333                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5334                                               '4' '5' '9' '2'.   ERCPNDC
  5335                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5336                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5337                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5338                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5339                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5340                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5341                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5342                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5343                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5344             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5345                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5346                                               '4' '5' '9' '2'.   ERCPNDC
  5347                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5348                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5349                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5350                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5351                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5352                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5353                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5354                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5355                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5356             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5357             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5358             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5359             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5360             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5361                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5362                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5363             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5364             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5365             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5366             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5367             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5368             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5369             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5370             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5371         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5372         16  PC-CC-CLP-STATE              PIC XX.
  5373         16  FILLER                       PIC X(14).              ERCPNDC
  5374         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5375         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5376         16  FILLER                       PIC X(34).              ERCPNDC
  5377                                                                  ERCPNDC
  5378     12  PC-RECORD-STATUS.                                        ERCPNDC
  5379         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5380         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5381         16  FILLER                       PIC XX.                 ERCPNDC
  5382         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5383             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5384         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5385             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5386             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5387                                                     '8'.         ERCPNDC
  5388         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5389             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5390             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5391         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5392             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5393         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5394         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5395         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 106
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5396         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5397             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5398         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5399         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5400                                                                  ERCPNDC
  5401     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5402         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5403             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5404         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5405             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5406                                                                  ERCPNDC
  5407     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5408         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5409                                                                  ERCPNDC
  5410     12  FILLER                           PIC X(25).              ERCPNDC
  5411                                                                  ERCPNDC
  5412******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 107
* ECS010.cbl
  5414 01  CC-STARTS-HERE              PIC X(48)
  5415       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5416
* 5417                             COPY ERCCRTC.
  5418******************************************************************04/29/98
  5419*                                                                *ERCCRTC
  5420*                                                                *ERCCRTC
  5421*                            ERCCRTC                             *   LV003
  5422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5423*                            VMOD=2.005                          *   CL**3
  5424*                                                                *ERCCRTC
  5425*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5426*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5427*                       ISSUES AND CANCELS)                      *ERCCRTC
  5428*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5429*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5430*                                                                *ERCCRTC
  5431*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5432*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5433*                                                                *ERCCRTC
  5434*   LOG = YES                                                    *ERCCRTC
  5435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5436******************************************************************ERCCRTC
  5437*                   C H A N G E   L O G
  5438*
  5439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5440*-----------------------------------------------------------------
  5441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5442* EFFECTIVE    NUMBER
  5443*-----------------------------------------------------------------
  5444* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5445******************************************************************
  5446 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5447     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5448         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5449                                                                  ERCCRTC
  5450     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5451         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5452         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5453         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5454         16  CC-STATE                     PIC XX.                 ERCCRTC
  5455         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5456         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5457         16  CC-CERT-NO.                                          ERCCRTC
  5458             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5459             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5460                                                                  ERCCRTC
  5461         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5462                                                                  ERCCRTC
  5463     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5464     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5465     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5466                                                                  ERCCRTC
  5467     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5468                                                                  ERCCRTC
  5469     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5470         16  FILLER                       PIC X(10).              ERCCRTC
  5471         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5472             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5473             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5474                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5475                 24  FILLER               PIC X(9).               ERCCRTC
  5476             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5477         16  CC-AGE                       PIC S99.                ERCCRTC
  5478         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5479         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5480         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5481             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5482             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5483         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5484             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5485             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5486                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5487                 24  FILLER               PIC X(9).               ERCCRTC
  5488             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5489         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5490         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5491         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5492         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5493         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5494         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5495         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5496         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5497         16  CC-OLD-LOF                   PIC XXX.
  5498*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5499         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5500         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5501         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5502         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5503         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5504         16  FILLER                       PIC X(3).               ERCCRTC
  5505         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5506         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5507         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5508         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5509         16  CC-LOAN-OFFICER              PIC X(5).
  5510         16  FILLER                       PIC XXX.                ERCCRTC
  5511     12  CC-RECORD-STATUS.                                        ERCCRTC
  5512         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5513         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5514     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5515         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5516         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5517         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5518         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5519     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5520     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5521         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5522             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5523         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5524             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5525     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5526         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5527         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5528         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5529         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 109
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5530                                                                  ERCCRTC
  5531     12  FILLER                           PIC X(05).              ERCCRTC
  5532******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 110
* ECS010.cbl
  5534 01  CR-STARTS-HERE              PIC X(48)
  5535       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5536
* 5537                             COPY ECSCRT01.
  5538******************************************************************
  5539*                                                                *
  5540*                            ECSCRT01                            *
  5541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5542*                            VMOD=2.016                          *
  5543*                                                                *
  5544*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5545*                                                                *
  5546*   FILE TYPE = SEQUENTIAL
  5547*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5548*                                                                *
  5549*   KEY DATA =                         START=4, LEN=36           *
  5550*                                                                *
  5551*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5552*                                                                *
  5553******************************************************************
  5554******************************************************************
  5555*                   C H A N G E   L O G
  5556*
  5557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5558*-----------------------------------------------------------------
  5559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5560* EFFECTIVE    NUMBER
  5561*-----------------------------------------------------------------
  5562* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5563* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5564* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5565* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5566* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5567* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5568* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5569* 032612  CR2011110200001  PEMA  AHL CHANGES
  5570******************************************************************
  5571
  5572 01  CERTIFICATE-RECORD.
  5573     12  CR-RECORD-ID                      PIC XX.
  5574         88  VALID-CR-ID                      VALUE 'CR'.
  5575
  5576     12  CR-COMPANY-CD                     PIC X.
  5577
  5578     12  CR-FULL-CONTROL.
  5579         16  CR-CONTROL-1.
  5580             20  CR-ACCT-CONTROL.
  5581                 24  CR-CARRIER            PIC X.
  5582                 24  CR-GROUPING.
  5583                     28  CR-GROUP-PREFIX   PIC XXX.
  5584                     28  CR-GROUP-PRIME    PIC XXX.
  5585                 24  CR-STATE              PIC XX.
  5586                 24  CR-ACCOUNT.
  5587                     28  CR-ACCT-PREFIX    PIC X(4).
  5588                     28  CR-ACCT-PRIME     PIC X(6).
  5589             20  CR-DT                     PIC 9(11)  COMP-3.
  5590         16  CR-CERT-NO.
  5591             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5592                 24  CR-CERT-PREFIX        PIC X(3).
  5593                 24  CR-CERT-PRIME         PIC X(7).
  5594             20  CR-CERT-SFX               PIC X.
  5595
  5596     12  CR-INSUREDS-PROFILE.
  5597         16  CR-NAME.
  5598             20  CR-LNAME                  PIC X(15).
  5599             20  CR-FNAME.
  5600                 24  CR-1ST-INITIAL        PIC X.
  5601                 24  FILLER                PIC X(9).
  5602             20  CR-INIT                   PIC X.
  5603         16  CR-AGE                        PIC 99.
  5604         16  CR-SEX                        PIC X.
  5605             88  CR-SEX-MALE                  VALUE 'M'.
  5606             88  CR-SEX-FEMALE                VALUE 'F'.
  5607         16  CR-SOC-SEC                    PIC X(11).
  5608         16  CR-JOINT-NAME.
  5609             20  CR-JT-LNAME               PIC X(15).
  5610             20  CR-JT-FNAME.
  5611                 24  CR-JT-1ST-INIT        PIC X.
  5612                 24  FILLER                PIC X(9).
  5613             20  CR-JT-INIT                PIC X.
  5614         16  CR-JOINT-AGE                  PIC 99.
  5615
  5616         16  cr-ahl-ah-claim-no            pic x(9).
  5617         16  cr-ahl-ah-cert-seq            pic x(3).
  5618         16  cr-hst-proc-lf                pic x.
  5619         16  f                             pic x(7).
  5620
  5621     12  CR-LF-COVERAGE-DATA.
  5622         16  CR-LFTYP                      PIC XX.
  5623         16  CR-LF-TERM                    PIC S999       COMP-3.
  5624         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5625         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5626         16  CR-LF-DEV-CODE                PIC XXX.
  5627         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5628
  5629         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5630         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5631         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5632         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5633
  5634         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5635         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5636         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5637         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5638
  5639         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5640         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5641
  5642         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5643         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5644
  5645         16  CR-LF-REFUND-TYPE             PIC X.
  5646         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5647
  5648         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5649             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5650
  5651         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5652
  5653         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5654         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5655         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5656
  5657         16  cr-ahl-lf-claim-no            pic x(9).
  5658         16  cr-ahl-lf-cert-seq            pic x(3).
  5659         16  FILLER                        PIC XX.
  5660
  5661     12  CR-AH-COVERAGE-DATA.
  5662         16  CR-AHTYP                      PIC XX.
  5663         16  CR-AH-TERM                    PIC S999       COMP-3.
  5664         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5665         16  CR-AH-DEV-CODE                PIC XXX.
  5666         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5667
  5668         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5669         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5670         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5671         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5672
  5673         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5674         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5675
  5676         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5677         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5678
  5679         16  CR-AH-REFUND-TYPE             PIC X.
  5680         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5681
  5682         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5683             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5684
  5685         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5686
  5687         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5688         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5689         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5690
  5691         16  FILLER                        PIC XX.
  5692*        16  FILLER                        PIC X(8).
  5693
  5694     12  CR-LOAN-DATA.
  5695         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5696         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5697                                           PIC S9(5)V99   COMP-3.
  5698         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5699         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5700         16  CR-PMT-FREQ                   PIC 99.
  5701         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5702         16  CR-RATING-CLASS               PIC XX.
  5703         16  CR-POLICY-FORM-NO             PIC X(12).
  5704         16  CR-GRPTYP                     PIC XX.
  5705         16  CR-IND-GRP                    PIC X.
  5706             88  CR-INDIVIDUAL                VALUE '1'.
  5707             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5708         16  CR-SKIP                       PIC 99.
  5709             88  NO-MONTHS-SKIPPED            VALUE 00.
  5710             88  SKIP-JULY                    VALUE 01.
  5711             88  SKIP-AUGUST                  VALUE 02.
  5712             88  SKIP-SEPTEMBER               VALUE 03.
  5713             88  SKIP-JULY-AUG                VALUE 04.
  5714             88  SKIP-AUG-SEPT                VALUE 05.
  5715             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5716             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5717             88  SKIP-JUNE                    VALUE 08.
  5718             88  SKIP-JUNE-JULY               VALUE 09.
  5719             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5720             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5721         16  CR-RESIDENT-STATE             PIC XX.
  5722         16  CR-RATE-CODE.
  5723             20  CR-LF-CLASS-CD            PIC XX.
  5724             20  CR-AH-CLASS-CD            PIC XX.
  5725         16  CR-MORT.
  5726             20  CR-TAB                    PIC X.
  5727             20  CR-INT                    PIC 99.
  5728             20  CR-GRP                    PIC X.
  5729         16  CR-MEMBER-NO                  PIC X(12).
  5730         16  CR-OLD-LOF                    PIC XXX.
  5731*        16  CR-LOAN-OFFICER               PIC XXX.
  5732         16  CR-REIN-TABLE                 PIC XXX.
  5733         16  CR-REIN-SPEC                  PIC X.
  5734         16  CR-LOAN-1ST-PMT-DT.
  5735             20  CR-1ST-PMT-YR             PIC 99.
  5736             20  CR-1ST-PMT-MO             PIC 99.
  5737             20  CR-1ST-PMT-DA             PIC 99.
  5738         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5739         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5740         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5741         16  CR-LAST-ADD-ON-DT             PIC XX.
  5742
  5743         16  CR-UNDERWRITING-CODE          PIC X.
  5744             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5745
  5746         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5747         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5748         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5749         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5750
  5751     12  CR-STATUS-INFORMATION.
  5752         16  CR-ENTRY-STATUS               PIC X.
  5753             88  CR-NORMAL-ENTRY              VALUE '1'.
  5754             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5755             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5756             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5757             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5758             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5759             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5760             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5761             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5762             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5763                                                    '5' '9' 'P'.
  5764         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5765
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5766         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5767         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5768         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5769
  5770         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5771         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5772
  5773         16  CR-LF-CURRENT-STATUS          PIC X.
  5774             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5775             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5776             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5777             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5778             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5779             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5780             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5781             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5782             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5783             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5784             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5785             88  CR-LF-IS-VOID                VALUE 'V'.
  5786             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5787                                                    '4' '5' '9'.
  5788
  5789         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5790
  5791         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5792         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5793
  5794         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5795         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5796
  5797         16  CR-AH-CURRENT-STATUS          PIC X.
  5798             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5799             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5800             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5801             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5802             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5803             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5804             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5805             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5806             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5807             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5808             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5809             88  CR-AH-IS-VOID                VALUE 'V'.
  5810             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5811                                                    '4' '5' '9'.
  5812         16  CR-LOAN-OFFICER               PIC X(5).
  5813         16  CR-CANCEL-REASON              PIC X.
  5814         16  cr-xycor-lf-cov-code          pic x(4).
  5815         16  cr-xycor-ah-cov-code          pic x(4).
  5816         16  FILLER                        PIC X(6).
  5817
  5818     12  CR-DEATH-CLAIM-DATA.
  5819         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5820
  5821         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5822         16  CR-DTH-RPT-DT.
  5823             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5824             20  CR-DTH-RPT-MO             PIC 99.
  5825             20  CR-DTH-RPT-DA             PIC 99.
  5826         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5827
  5828         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5829         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5830         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5831         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5832         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5833
  5834         16  CR-DTH-AGE                    PIC 99.
  5835         16  CR-DTH-PAY-CD                 PIC X.
  5836         16  CR-DEATH-CAUSE                PIC X(6).
  5837
  5838         16  FILLER                        PIC X(16).
  5839
  5840     12  CR-DISAB-CLAIM-DATA.
  5841         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5842
  5843         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5844         16  CR-DIS-RPT-DT.
  5845             20  CR-DIS-RPT-YR             PIC 99.
  5846             20  CR-DIS-RPT-MO             PIC 99.
  5847             20  CR-DIS-RPT-DA             PIC 99.
  5848         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5849         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5850
  5851         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5852         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5853         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5854         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5855         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5856
  5857         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5858         16  CR-DIS-PAY-CD                 PIC X.
  5859         16  FILLER                        PIC XX.
  5860
  5861         16  CR-DISAB-INCURRED-DETAIL.
  5862             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5863**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5864                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5865                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5866                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5867
  5868         16  CR-DISAB-CAUSE                PIC X(6).
  5869         16  FILLER                        PIC X(14).
  5870
  5871     12  CR-REMIT-TO                       PIC 99.
  5872
  5873     12  CR-COMPENSATION-LEVELS.
  5874         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5875             20  CR-COM-AGT.
  5876                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5877                 24  CR-COM-AGT-PRIME      PIC X(6).
  5878             20  CR-AGT-TYPE               PIC X.
  5879             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5880             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5881
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5882     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5883     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5884     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5885     12  CR-CLP-STATE                      PIC XX.
  5886     12  CR-POST-CARD-IND                  PIC X.
  5887     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5888     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5889     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5890     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5891     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5892     12  FILLER                            PIC X(07).
  5893
  5894     12  CR-CSR-CODE                       PIC XXX.
  5895
  5896     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5897     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5898
  5899     12  CR-MICROFILM-NUMBERS.
  5900*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5901         16  FILLER                        PIC X(5).
  5902     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5903
  5904     12  CR-USER-CODE                      PIC X.
  5905     12  CR-USER-FUTURE                    PIC X(9).
  5906
  5907     12  CR-BENEFICIARY.
  5908         16  CR-BANK-NO                    PIC X(10).
  5909         16  FILLER                        PIC X(15).
  5910
  5911     12  CR-ENTRY-BATCH                    PIC X(6).
  5912     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5913     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5914
  5915     12  CR-NOTE-SW                        PIC X.
  5916
  5917     12  CR-ORIGIN-INDICATOR               PIC X.
  5918         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5919         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5920
  5921     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5922     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5923     12  FILLER                            PIC X(33).
  5924
  5925******************************************************************
* 5926                             COPY ELCCRTVR.
  5927***************************************************************** 04/24/98
  5928*                                                                *ELCCRTVR
  5929*                                                                *ELCCRTVR
  5930*                            ELCCRTVR                            *   LV003
  5931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5932*                            VMOD=2.001                          *ELCCRTVR
  5933*                                                                *ELCCRTVR
  5934*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5935*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5936*                                                                *ELCCRTVR
  5937******************************************************************ELCCRTVR
  5938                                                                  ELCCRTVR
  5939 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5940     05  WS-CR-DT.                                                ELCCRTVR
  5941         10  FILLER                PIC 999.                       ELCCRTVR
  5942         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5943         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5944             15  CR-CC             PIC 99.                        ELCCRTVR
  5945             15  CR-YR             PIC 99.                        ELCCRTVR
  5946         10  CR-MO                 PIC 99.                        ELCCRTVR
  5947         10  CR-DA                 PIC 99.                        ELCCRTVR
  5948     05  WS-CR-DT-N REDEFINES                                        CL**2
  5949            WS-CR-DT               PIC 9(11).                        CL**2
  5950     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5951         10  FILLER                    PIC 999.                   ELCCRTVR
  5952         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5953         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5954             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5955             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5956         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5957         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5958     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5959            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5960     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5961         10  FILLER                    PIC 999.                   ELCCRTVR
  5962         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5963         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5964             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5965             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5966         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5967         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5968     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5969            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5970     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5971         10  FILLER                    PIC 999.                   ELCCRTVR
  5972         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5973         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5974             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5975             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5976         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5977         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5978     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5979            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5980     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5981         10  FILLER                    PIC 999.                   ELCCRTVR
  5982         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5983         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5984             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5985             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5986         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5987         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5988     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5989            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5990     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5991         10  FILLER                    PIC 999.                   ELCCRTVR
  5992         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5993         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5994             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5995             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5996         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5997         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5998     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5999            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6000     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  6001         10  FILLER                    PIC 999.                   ELCCRTVR
  6002         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6003         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  6004             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  6005             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  6006         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  6007         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  6008     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  6009            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  6010     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  6011         10  FILLER                    PIC 999.                   ELCCRTVR
  6012         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  6013         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  6014             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  6015             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  6016         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  6017         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  6018     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  6019            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  6020     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  6021         10  FILLER                    PIC 999.                   ELCCRTVR
  6022         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  6023         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  6024             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  6025             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6026         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6027         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6028     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6029            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6030     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6031         10  FILLER                    PIC 999.                   ELCCRTVR
  6032         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6033         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6034             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6035             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6036         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6037         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6038     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6039          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6040     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6041         10  FILLER                    PIC 999.                   ELCCRTVR
  6042         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6043         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6044             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6045             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6046         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6047         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6048     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6049            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6050     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6051         10  FILLER                    PIC 999.                   ELCCRTVR
  6052         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6053         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6054             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6055             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 119
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6056         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6057         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6058     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6059            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6060     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6061         10  FILLER                    PIC 999.                   ELCCRTVR
  6062         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6063         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6064             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6065             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6066         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6067         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6068     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6069            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6070     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6071         10  FILLER                    PIC 999.                   ELCCRTVR
  6072         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6073         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6074             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6075             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6076         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6077         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6078     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6079            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6080     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6081         10  FILLER                    PIC 999.                   ELCCRTVR
  6082         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6083         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6084             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6085             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6086         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6087         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6088     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6089            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6090     05  COPY-NDX                      PIC 9.                        CL**6
  6091     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6092         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6093             15  FILLER                PIC 999.                   ELCCRTVR
  6094             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6095             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6096                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6097                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6098             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6099             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6100         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6101                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6102
  6103 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 120
* ECS010.cbl
* 6105                             COPY ELCDATE.
  6106******************************************************************06/11/98
  6107*                                                                *ELCDATE
  6108*                                                                *ELCDATE
  6109*                            ELCDATE.                            *   LV023
  6110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6111*                            VMOD=2.003                           ELCDATE
  6112*                                                                *ELCDATE
  6113*                                                                *ELCDATE
  6114*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6115*                 LENGTH = 200                                   *   CL*19
  6116******************************************************************ELCDATE
  6117                                                                  ELCDATE
  6118 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6119     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6120     12  DC-OPTION-CODE                PIC X.                        CL*15
  6121         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6122         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6123         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6124         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6125         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6126         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6127         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6128         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6129         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6130         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6131         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6132         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6133         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6134         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6135         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6136         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6137         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6138         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6139         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6140         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6141         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6142         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6143         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6144         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6145         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6146         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6147         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6148         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6149         88  THREE-CHARACTER-BIN                                  ELCDATE
  6150                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6151         88  GREGORIAN-TO-BIN                                        CL**2
  6152                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6153         88  BIN-TO-GREGORIAN                                        CL**2
  6154                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6155         88  JULIAN-TO-BINARY                                        CL**2
  6156                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6157     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6158         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6159         88  DATE-CONVERSION-ERROR                                ELCDATE
  6160                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6161         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6162         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6163         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6164         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6165         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6166         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6167         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6168         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6169         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6170         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6171     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6172         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6173     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6174         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6175         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6176         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6177     12  FILLER                        PIC X.                        CL*15
  6178     12  DC-CONVERSION-DATES.                                        CL*15
  6179         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6180         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6181         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6182         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6183                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6184             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6185             20  SLASH1-1              PIC X.                        CL*15
  6186             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6187             20  SLASH1-2              PIC X.                        CL*15
  6188             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6189         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6190         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6191                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6192             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6193             20  SLASH2-1              PIC X.                        CL*15
  6194             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6195             20  SLASH2-2              PIC X.                        CL*15
  6196             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6197         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6198         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6199                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6200             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6201             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6202             20  DC-YMD-DAY            PIC 99.                       CL*15
  6203         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6204         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6205                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6206             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6207             20  DC-MDY-DAY            PIC 99.                       CL*15
  6208             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6209         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6210             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6211             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6212             20  FILLER                PIC XX.                       CL*15
  6213             20  DC-ALPHA-CENTURY.                                   CL*15
  6214                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6215             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6216         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6217         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6218         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6219         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6220         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6221                                       PIC 9(05).                    CL*20
  6222         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6223             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6224             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6225         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6226         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6227         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6228     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6229         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6230         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6231             20  FILLER                PIC 9(3).                     CL*15
  6232             20  HOLD-CEN-1-CCYY.                                    CL*15
  6233                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6234                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6235             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6236             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6237         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6238             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6239             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6240             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6241                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6242                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6243             20  FILLER                PIC 9(3).                     CL*15
  6244         16  HOLD-CENTURY-1-X.                                       CL*15
  6245             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6246             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6247                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6248                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6249             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6250             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6251         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6252             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6253             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6254             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6255                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6256                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6257             20  FILLER                PIC XXX.                      CL*23
  6258         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6259         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6260         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6261         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6262             20  DC-JULIAN-1-CCYY.                                   CL*15
  6263                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6264                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6265             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6266         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6267         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6268             20  DC-JULIAN-2-CCYY.                                   CL*15
  6269                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6270                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6271             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6272         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6273             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6274             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6275             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6276             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6277             20  DC-EDITA-CCYY.                                      CL*15
  6278                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 123
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6279                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6280         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6281             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6282             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6283             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6284             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6285             20  DC-EDITB-CCYY.                                      CL*15
  6286                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6287                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6288         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6289         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6290                              DC-GREG-DATE-CYMD.                  ELCDATE
  6291             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6292             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6293             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6294             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6295         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6296         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6297                              DC-GREG-DATE-MDCY.                  ELCDATE
  6298             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6299             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6300             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6301             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6302    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6303        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6304    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6305    12  FILLER                         PIC X(28).                    CL*26
* 6306                             COPY ELCFUNDT.
  6307***************************************************************** 12/03/98
  6308*                                                               * ELCFUNDT
  6309*                            ELCFUNDT.                          *    LV004
  6310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6311*                            VMOD=2.001                         * ELCFUNDT
  6312*                                                               * ELCFUNDT
  6313*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6314*                                                               * ELCFUNDT
  6315***************************************************************** ELCFUNDT
  6316                                                                  ELCFUNDT
  6317                                                                  ELCFUNDT
  6318 01  FUNCTION-DATE.                                                  CL**2
  6319     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6320     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6321         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6322         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6323             15  WS-FN-CC          PIC 99.                           CL**3
  6324             15  WS-FN-YR          PIC 99.                           CL**3
  6325         10  WS-FN-MO              PIC 99.                           CL**3
  6326         10  WS-FN-DA              PIC 99.                           CL**3
  6327     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6328     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6329     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6330     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6331     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6332         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6333         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6334         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6335     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6336     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 124
* ECS010.cbl
  6337
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 125
* ECS010.cbl
  6339 01  CPA-STARTS-HERE             PIC X(48)
  6340       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6341                             COPY ELCCALC.
  6342******************************************************************04/15/98
  6343*                                                                *ELCCALC
  6344*                           ELCCALC.                            *    LV003
  6345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6346*                            VMOD=2.025                          *   CL**3
  6347*                                                                *   CL**2
  6348*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6349*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6350*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6351*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6352*                                                                *   CL**2
  6353*  PASSED TO ELRTRM                                              *   CL**2
  6354*  -----------------                                             *   CL**2
  6355*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6356*  ORIGINAL TERM                                                 *   CL**2
  6357*  BEGINNING DATE                                                *   CL**2
  6358*  ENDING DATE                                                   *   CL**2
  6359*  COMPANY I.D.                                                  *   CL**2
  6360*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6361*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6362*  FREE LOOK DAYS                                                *   CL**2
  6363*                                                                *   CL**2
  6364*  RETURNED FROM ELRTRM                                          *   CL**2
  6365*  ---------------------                                         *   CL**2
  6366*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6367*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6368*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6369*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6370*----------------------------------------------------------------*   CL**2
  6371*  PASSED TO ELRAMT                                              *   CL**2
  6372*  ----------------                                              *   CL**2
  6373*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6374*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6375*  ORIGINAL AMOUNT                                               *   CL**2
  6376*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6377*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6378*  METHOD                                                            CL**2
  6379*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6380*  COMPANY I.D.                                                  *   CL**2
  6381*  BENEFIT TYPE                                                  *   CL**2
  6382*                                                                *   CL**2
  6383*  RETURNED FROM ELRAMT                                          *   CL**2
  6384*  --------------------                                          *   CL**2
  6385*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6386*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6387*  REMAINING AMOUNT FACTOR                                           CL**2
  6388*----------------------------------------------------------------*   CL**2
  6389*  PASSED TO ELRESV                                              *   CL**2
  6390*  -----------------                                             *   CL**2
  6391*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6392*  VALUATION DATE                                                *   CL**2
  6393*  PAID THRU DATE                                                *   CL**2
  6394*  BENEFIT                                                       *   CL**2
  6395*  INCURRED DATE                                                 *   CL**2
  6396*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6397*  ISSUE AGE                                                     *   CL**2
  6398*  TERM                                                          *   CL**2
  6399*  CDT PERCENT                                                   *   CL**2
  6400*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6401* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6402* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6403* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6404*                                                                *   CL**2
  6405*  RETURNED FROM ELRESV                                          *   CL**2
  6406*  --------------------                                          *   CL**2
  6407*  CDT TABLE USED                                                *   CL**2
  6408*  CDT FACTOR USED                                               *   CL**2
  6409*  PAY TO CURRENT RESERVE                                        *   CL**2
  6410*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6411*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6412*----------------------------------------------------------------*   CL**2
  6413*  PASSED TO ELRATE                                              *   CL**2
  6414*  ----------------                                              *   CL**2
  6415*  CERT ISSUE DATE                                               *   CL**2
  6416*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6417*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6418*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6419*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6420*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6421*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6422*  DEVIATION CODE                                                *   CL**2
  6423*  ISSUE AGE                                                     *   CL**2
  6424*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6425*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6426*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6427*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6428*  A.P.R.                                                        *   CL**2
  6429*  METHOD                                                            CL**2
  6430*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6431*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6432*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6433*  BENEFIT CODE                                                  *   CL**2
  6434*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6435*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6436*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6437*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6438*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6439*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6440*                                                                *   CL**2
  6441*  RETURNED FROM ELRATE                                          *   CL**2
  6442*  --------------------                                          *   CL**2
  6443*  CALCULATED PREMIUM                                            *   CL**2
  6444*  PREMIUM RATE                                                  *   CL**2
  6445*  MORTALITY CODE                                                *   CL**2
  6446*  MAX ATTAINED AGE                                              *   CL**2
  6447*  MAX AGE                                                       *   CL**2
  6448*  MAX TERM                                                      *   CL**2
  6449*  MAX MONTHLY BENEFIT                                           *   CL**2
  6450*  MAX TOTAL BENIFIT                                             *   CL**2
  6451*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6452*----------------------------------------------------------------*   CL**2
  6453*  PASSED TO ELRFND                                              *   CL**2
  6454*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6455*  CERT ISSUE DATE                                               *   CL**2
  6456*  REFUND DATE                                                   *   CL**2
  6457*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6458*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6459*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6460*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6461*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6462*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6463*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6464*  DEVIATION CODE                                                *   CL**2
  6465*  ISSUE AGE                                                     *   CL**2
  6466*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6467*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6468*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6469*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6470*  A.P.R.                                                        *   CL**2
  6471*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6472*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6473*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6474*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6475*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6476*  BENEFIT CODE                                                  *   CL**2
  6477*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6478*                                                                *   CL**2
  6479*  RETURNED FROM ELRFND                                          *   CL**2
  6480*  --------------------                                          *   CL**2
  6481*  CALCULATED REFUND                                             *   CL**2
  6482*----------------------------------------------------------------*   CL**2
  6483*  PASSED TO ELEARN                                              *   CL**2
  6484*  ----------------                                              *   CL**2
  6485*  CERT ISSUE DATE                                               *   CL**2
  6486*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6487*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6488*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6489*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6490*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6491*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6492*  DEVIATION CODE                                                *   CL**2
  6493*  ISSUE AGE                                                     *   CL**2
  6494*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6495*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6496*  A.P.R.                                                        *   CL**2
  6497*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6498*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6499*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6500*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6501*  BENEFIT CODE                                                  *   CL**2
  6502*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6503*                                                                *   CL**2
  6504*  RETURNED FROM ELEARN                                          *   CL**2
  6505*  --------------------                                          *   CL**2
  6506*  INDICATED  EARNINGS                                           *   CL**2
  6507*----------------------------------------------------------------*   CL**2
  6508*                 LENGTH = 450                                   *   CL**2
  6509*                                                                *   CL**2
  6510******************************************************************   CL**2
  6511******************************************************************
  6512*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6513*
  6514* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6515*-----------------------------------------------------------------
  6516*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6517* EFFECTIVE    NUMBER
  6518*-----------------------------------------------------------------
  6519* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6520* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6521* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6522* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6523* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6524* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6525* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6526* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6527* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6528******************************************************************
  6529                                                                     CL**2
  6530 01  CALCULATION-PASS-AREA.                                          CL**2
  6531     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6532                                     COMP.                           CL**2
  6533                                                                     CL**2
  6534     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6535       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6536       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6537                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6538       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6539       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6540       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6541       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6542       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6543       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6544       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6545       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6546       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6547       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6548       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6549       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6550       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6551       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6552       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6553       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6554       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6555                                                                     CL**2
  6556     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6557       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6558***********************  INPUT AREAS ****************************    CL**2
  6559                                                                     CL**2
  6560     12  CP-CALCULATION-AREA.                                        CL**2
  6561         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6562         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6563         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6564         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6565         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6566           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6567                                                   'I' 'U'.          CL**2
  6568           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6569           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6570         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6571         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6572         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6573         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6574         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6575                                     COMP-3.                         CL**2
  6576         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6577                                     COMP-3.                         CL**2
  6578         16  CP-CDT-METHOD         PIC X.                            CL**2
  6579           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6580           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6581           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6582         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6583           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6584           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6585         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6586                                     COMP-3.                         CL**2
  6587         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6588                                     COMP-3.                         CL**2
  6589         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6590                                     COMP-3.                         CL**2
  6591         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6592                                     COMP-3.                         CL**2
  6593         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6594                                     COMP-3.                         CL**2
  6595         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6596                                     COMP-3.                         CL**2
  6597         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6598                                     COMP-3.                         CL**2
  6599         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6600           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6601           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6602           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6603           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6604           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6605           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6606           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6607         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6608           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6609           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6610           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6611           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6612           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6613           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6614           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6615           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6616           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6617           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6618           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6619           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6620           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6621           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6622         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6623           88  CP-CLAIM                            VALUE '1'.        CL**2
  6624           88  CP-CANCEL                           VALUE '2'.        CL**2
  6625           88  CP-ISSUE                            VALUE '3'.        CL**2
  6626         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6627           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6628           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6629           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6630           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6631           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6632           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6633           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6634           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6635           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6636           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6637           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6638           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6639           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6640           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6641           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6642           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6643           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6644           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6645                                                     'W' 'X'.        CL**2
  6646           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6647           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6648           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6649           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6650           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6651           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6652           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6653           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6654           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6655           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6656           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6657           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6658           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6659                                                                     CL**2
  6660         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6661                                     COMP-3.                         CL**2
  6662         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6663         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6664         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6665         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6666         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6667           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6668               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6669         16  CP-R78-OPTION         PIC X.                            CL**2
  6670           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6671           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6672                                                                     CL**2
  6673         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6674         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6675         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6676         16  CP-RATE-FILE          PIC X.                            CL**2
  6677         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6678                                     COMP-3.                         CL**2
  6679                                                                     CL**2
  6680         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6681         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6682                                                                     CL**2
  6683         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6684                                     COMP-3.
  6685         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6686                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6687         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6688                                     COMP-3.                         CL**2
  6689         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6690                                     COMP-3.                         CL**2
  6691         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6692                                     COMP-3.
  6693         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6694                                  PIC S9(7)V99 COMP-3.
  6695                                                                     CL**2
  6696         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6697         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6698         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6699           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6700           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6701           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6702           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6703         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6704         16  CP-CARRIER            PIC X.                            CL**2
  6705         16  CP-REIN-FLAG          PIC X.                            CL**2
  6706         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6707           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6708                      '2' '3' '4' '5'.                               CL**2
  6709           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6710           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6711           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6712           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6713           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6714           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6715           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6716           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6717         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6718         16  CP-RATING-METHOD      PIC X.                            CL**2
  6719           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6720           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6721           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6722           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6723           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6724           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6725           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6726           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6727           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6728         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6729                                     COMP-3.                         CL**2
  6730         16  CP-BEN-CATEGORY       PIC X.
  6731         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6732         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6733                                   PIC S99V9(5) COMP-3.
  6734         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6735         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6736                                   PIC S99V9(5) COMP-3.
  6737         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6738         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6739         16  CP-EXPIRE-DT          PIC XX.
  6740         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6741         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6742         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6743         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6744         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6745             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6746             88  CP-CALC-CLP              VALUE 'C'.
  6747         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6748         16  CP-CANCEL-REASON      PIC X.
  6749         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6750         16  CP-PMT-MODE           PIC X.
  6751         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6752         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6753         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6754         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6755         16  FILLER                PIC X.
  6756                                                                     CL**2
  6757***************    OUTPUT FROM ELRESV   ************************     CL**2
  6758                                                                     CL**2
  6759         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6760                                                                     CL**2
  6761         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6762                                     COMP-3.                         CL**2
  6763         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6764                                     COMP-3.                         CL**2
  6765         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6766                                     COMP-3.                         CL**2
  6767         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6768                                     COMP-3.                         CL**2
  6769         16  FILLER                PIC X(09).                        CL**2
  6770***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6771                                                                     CL**2
  6772         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6773                                     COMP-3.                         CL**2
  6774         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6775                                     COMP-3.                         CL**2
  6776         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6777                                     COMP-3.                         CL**2
  6778         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6779                                     COMP-3.                         CL**2
  6780         16  FILLER                PIC X(12).                        CL**2
  6781                                                                     CL**2
  6782***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6783                                                                     CL**2
  6784         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6785                                     COMP-3.                         CL**2
  6786         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6787                                     COMP-3.                         CL**2
  6788         16  FILLER                PIC X(12).                        CL**2
  6789                                                                     CL**2
  6790***************    OUTPUT FROM ELRATE   *************************    CL**2
  6791                                                                     CL**2
  6792         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6793                                     COMP-3.                         CL**2
  6794         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6795                                     COMP-3.                         CL**2
  6796         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6797         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6798             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6799         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6800                                     COMP-3.                         CL**2
  6801         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6802         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6803         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6804                                   PIC S9(7)V99 COMP-3.
  6805         16  FILLER                PIC X(07).                        CL**2
  6806                                                                     CL**2
  6807***************    OUTPUT FROM ELRFND   *************************    CL**2
  6808                                                                     CL**2
  6809         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6810                                     COMP-3.                         CL**2
  6811         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6812           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6813           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6814           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6815           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6816           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6817           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6818           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6819           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6820           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6821           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6822           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6823           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6824           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6825           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6826         16  FILLER                PIC X(12).                        CL**2
  6827                                                                     CL**2
  6828***************    OUTPUT FROM ELEARN   *************************    CL**2
  6829                                                                     CL**2
  6830         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6831                                     COMP-3.                         CL**2
  6832         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6833                                     COMP-3.                         CL**2
  6834         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6835                                     COMP-3.                         CL**2
  6836         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6837                                     COMP-3.                         CL**2
  6838         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6839                                     COMP-3.                         CL**2
  6840         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6841                                     COMP-3.                         CL**2
  6842         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6843           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6844           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6845           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6846           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6847           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6848           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6849           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6850           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6851           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6852         16  FILLER                PIC X(12).                        CL**2
  6853                                                                     CL**2
  6854***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6855                                                                     CL**2
  6856         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6857                                     COMP-3.                         CL**2
  6858         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6859                                     COMP-3.                         CL**2
  6860         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 134
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6861                                                                     CL**2
  6862***************   MISC WORK AREAS    *****************************   CL**2
  6863         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6864                                     COMP-3.                         CL**2
  6865         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6866                                     COMP-3.                         CL**2
  6867         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6868                                     COMP-3.                         CL**2
  6869         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6870                                     COMP-3.                         CL**2
  6871         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6872                                     COMP-3.                         CL**2
  6873         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6874                                     COMP-3.                         CL**2
  6875         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6876             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6877             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6878             88  IO-ERROR                         VALUE 'E'.         CL**2
  6879                                                                     CL**2
  6880         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6881                                                                     CL**2
  6882         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6883                                                                     CL**2
  6884         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6885                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6886                                     COMP-3.                         CL**2
  6887                                                                     CL**2
  6888         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6889                                                                     CL**2
  6890         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6891                                     COMP-3.                         CL**2
  6892                                                                     CL**2
  6893         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6894                                     COMP-3.                         CL**2
  6895                                                                     CL**2
  6896         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6897                                     COMP-3.                         CL**2
  6898                                                                     CL**2
  6899         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6900                                     COMP-3.                         CL**2
  6901                                                                     CL**2
  6902         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6903                                     COMP-3.                         CL**2
  6904                                                                     CL**2
  6905         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6906                                     COMP-3.                         CL**2
  6907                                                                     CL**2
  6908         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6909                                     COMP-3.                         CL**2
  6910                                                                     CL**2
  6911         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6912             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6913                                                                     CL**2
  6914         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6915                                     COMP-3.                         CL**2
  6916         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6917                                     COMP-3.
  6918         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 135
* ECS010.cbl
  6919         16  FILLER                PIC X(15).                        CL**2
  6920******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 136
* ECS010.cbl
* 6922                             COPY ELCDTECX.
  6923******************************************************************06/05/98
  6924*                                                                *ELCDTECX
  6925*                            ELCDTECX.                           *   LV005
  6926*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6927*                            VMOD=2.015                          *ELCDTECX
  6928*                                                                *ELCDTECX
  6929*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6930*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6931*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6932*                                                                *ELCDTECX
  6933******************************************************************ELCDTECX
  6934******************************************************************
  6935*                   C H A N G E   L O G
  6936*
  6937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6938*-----------------------------------------------------------------
  6939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6940* EFFECTIVE    NUMBER
  6941*-----------------------------------------------------------------
  6942* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6943*                                  BENEFIT CODES FROM 300 TO 900
  6944* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6945* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6946* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6947******************************************************************
  6948 01  DATE-CARD.                                                   ELCDTECX
  6949     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6950     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6951     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6952     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6953     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6954     12  EP-SW                       PIC  X.                      ELCDTECX
  6955         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6956     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6957         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6958     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6959     12  RUN-CENTURY.                                             ELCDTECX
  6960         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6961     12  FILLER                      PIC  X.                         CL**4
  6962     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6963     12  FILLER                      PIC  XXX.                    ELCDTECX
  6964     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6965                                                                  ELCDTECX
  6966 01  FILLER                          PIC  X(7)                       CL**6
  6967                                          VALUE 'OPTIONS'.        ELCDTECX
  6968 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6969     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6970     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6971     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6972         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6973         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6974     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6975     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6976     12  FILLER                      PIC  X.                      ELCDTECX
  6977     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6978     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6979     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 137
* ECS010.cbl (/apps/test/cid1s/copy/ELCDTECX)
  6980     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6981     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6982     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6983     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6984     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6985     12  FILLER                      PIC  X.                      ELCDTECX
  6986     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6987     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6988     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6989     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6990     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6991     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6992     12  FILLER                      PIC  X.                      ELCDTECX
  6993     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6994     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6995     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6996     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6997     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6998     12  DTE-R78                     PIC  X.                      ELCDTECX
  6999     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  7000     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  7001     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  7002     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  7003     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  7004     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  7005     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  7006                                     PIC  X.                      ELCDTECX
  7007         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  7008                                                 ' '.             ELCDTECX
  7009         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  7010         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  7011     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  7012         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  7013         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  7014     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  7015     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  7016                                     PIC  9.                         CL**4
  7017     12  DTE-SYSTEM.                                              ELCDTECX
  7018         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  7019         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  7020         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  7021         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  7022         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  7023         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  7024         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  7025         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  7026         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7027         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7028         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7029         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7030         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7031         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7032         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7033         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7034         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7035         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7036         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7037         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 138
* ECS010.cbl (/apps/test/cid1s/copy/ELCDTECX)
  7038         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  7039         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7040         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7041         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7042         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7043         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7044     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7045         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7046                                     PIC  X.                      ELCDTECX
  7047     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7048                                                                  ELCDTECX
  7049 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7050     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7051     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7052     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7053*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7054     12  FILLER                      PIC  X.                      ELCDTECX
  7055     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7056     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7057     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7058     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7059     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7060     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7061     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7062                                                                  ELCDTECX
  7063     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7064     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7065     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7066     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7067                                                                  ELCDTECX
  7068     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7069     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7070     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7071     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7072                                                                  ELCDTECX
  7073     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7074     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7075                                                                  ELCDTECX
  7076     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7077     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7078                                                                  ELCDTECX
  7079     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7080                                                                  ELCDTECX
  7081 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7082     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7083     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7084     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7085     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7086     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7087     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7088     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7089                                                                  ELCDTECX
  7090 01  FILLER                          PIC  X(12)                   ELCDTECX
  7091                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7092 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7093     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7094         16  CNT-ID                  PIC  X.                      ELCDTECX
  7095         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 139
* ECS010.cbl (/apps/test/cid1s/copy/ELCDTECX)
  7096                                                                  ELCDTECX
  7097 01  FILLER                          PIC  X(11)                   ELCDTECX
  7098                                          VALUE 'STATE NAMES'.    ELCDTECX
  7099 01  STATE-NAMES.                                                 ELCDTECX
  7100     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7101         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7102         16  STATE-PIC1.                                          ELCDTECX
  7103             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7104             20  FILLER              PIC  XXX.                    ELCDTECX
  7105             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7106             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7107             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7108             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7109                                                                  ELCDTECX
  7110 01  FILLER                          PIC  X(13)                   ELCDTECX
  7111                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7112 01  CARRIER-NAMES.                                               ELCDTECX
  7113     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7114         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7115         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7116         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7117         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7118         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7119         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7120*        16  FILLER                  PIC  X.                      ELCDTECX
  7121         16  CARRIER-SEC-PAY         PIC  X.
  7122             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7123                                                                  ELCDTECX
  7124 01  FILLER                          PIC  X(9)                       CL**6
  7125                                          VALUE 'INS TYPES'.      ELCDTECX
  7126 01  CLAS-INS-TYPES.                                              ELCDTECX
  7127*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7128     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7129         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7130         16  CLAS-I-AB3.                                          ELCDTECX
  7131             20  FILLER              PIC  X.                      ELCDTECX
  7132             20  CLAS-I-AB2.                                      ELCDTECX
  7133                 24  FILLER          PIC  X.                      ELCDTECX
  7134                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7135         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7136             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7137             20  FILLER              PIC  X.                         CL**4
  7138         16  CLAS-I-AB10.                                         ELCDTECX
  7139             20  FILLER              PIC  X(9).                   ELCDTECX
  7140             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7141         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7142         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7143         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7144         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7145             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7146         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7147         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7148         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7149         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7150         16  CLAS-I-REFUND-METHOD    PIC  X.
  7151         16  CLAS-I-MAX-BENEFITS     PIC 99.
  7152         16  FILLER                  PIC  XXX.
  7153                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 140
* ECS010.cbl (/apps/test/cid1s/copy/ELCDTECX)
  7154 01  FILLER                          PIC  X(16)                   ELCDTECX
  7155                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  7156 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7157     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7158                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7159         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7160         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7161         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7162         16  CLAS-MORT-DESC.                                      ELCDTECX
  7163             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7164             20  FILLER              PIC  XX.                        CL**5
  7165             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7166             20  FILLER              PIC  X.                         CL**5
  7167             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7168             20  FILLER              PIC  X.                         CL**5
  7169             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7170             20  FILLER              PIC  X.                         CL**5
  7171             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7172             20  FILLER              PIC  X(5).                      CL**6
  7173                                                                  ELCDTECX
  7174 01  FILLER                          PIC  X(15)                   ELCDTECX
  7175                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7176 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7177     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7178         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7179         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7180         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7181         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7182         16  FILLER                  PIC  X(4).                      CL**6
  7183                                                                  ELCDTECX
  7184 01  FILLER                          PIC  X(7)                       CL**6
  7185                                     VALUE 'INDEXES'.             ELCDTECX
  7186 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7187     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7188     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7189     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7190     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7191     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7192     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7193     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7194     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7195     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7196     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7197     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7198     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7199     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7200     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7201     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7202     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7203     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7204                                                                  ELCDTECX
  7205 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7206     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7207     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7208     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7209     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7210     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7211     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 141
* ECS010.cbl (/apps/test/cid1s/copy/ELCDTECX)
  7212     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7213     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  7214     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7215     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7216     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7217                                                                  ELCDTECX
  7218 01  FILLER                          PIC  X(13)                   ELCDTECX
  7219                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7220 01  CLAS-MISC.                                                   ELCDTECX
  7221     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7222         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7223         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7224         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7225     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7226     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7227     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7228     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7229     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7230     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7231     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7232     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7233     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7234     12  STATE-L                     PIC  XX.                     ELCDTECX
  7235     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7236     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7237     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7238         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7239         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7240     12  DTE-ABEND-WORK.                                          ELCDTECX
  7241         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7242         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7243                                                                  ELCDTECX
  7244 01  FILLER                          PIC  X(12)                   ELCDTECX
  7245                                     VALUE 'WORKING DATE'.        ELCDTECX
  7246 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7247     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7248         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7249         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7250         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7251     12  WS-CURRENT-DATE.                                         ELCDTECX
  7252         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7253         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7254         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7255         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7256         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7257     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7258         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7259         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7260                                                                  ELCDTECX
  7261 01  FILLER                          PIC  X(12)                   ELCDTECX
  7262                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7263 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7264     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7265         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7266         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7267         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7268                                                                  ELCDTECX
  7269 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 142
* ECS010.cbl (/apps/test/cid1s/copy/ELCDTECX)
  7270                                     VALUE 'STATE TLRS'.          ELCDTECX
  7271 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  7272     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7273         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7274         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7275                                                                  ELCDTECX
  7276 01  FILLER                          PIC  X(13)                   ELCDTECX
  7277                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7278 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7279     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7280         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7281                                                                  ELCDTECX
  7282 01  FILLER                          PIC  X(13)                   ELCDTECX
  7283                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7284 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7285     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7286     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7287     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7288                                     PIC  X.                         CL**5
  7289     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7290     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7291     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7292     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7293     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7294     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7295     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7296     12  FILLER                      PIC  X(75).                  ELCDTECX
  7297******************************************************************ELCDTECX
  7298*01  MISC-CARR-PCT-DATA.                                          00001521
  7299*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7300*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7301*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7302*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7303*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7304*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7305******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 143
* ECS010.cbl
* 7307                             COPY ELCDTEVR.
  7308***************************************************************** 04/15/98
  7309*                                                                *ELCDTEVR
  7310*                                                                *ELCDTEVR
  7311*                            ELCDTEVR.                           *   LV003
  7312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7313*                            VMOD=2.001                          *   CL**2
  7314*                                                                *ELCDTEVR
  7315*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7316*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7317*                                                                *ELCDTEVR
  7318******************************************************************ELCDTEVR
  7319 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7320     05  WS-RUN-DATE.                                             ELCDTEVR
  7321         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7322         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7323         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7324             15  RUN-CC              PIC  99.                     ELCDTEVR
  7325             15  RUN-YR              PIC  99.                     ELCDTEVR
  7326         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7327         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7328     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7329            WS-RUN-DATE              PIC 9(11).                      CL**2
  7330     05  WS-EP-DT.                                                ELCDTEVR
  7331         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7332         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7333         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7334             15  EP-CC               PIC  99.                     ELCDTEVR
  7335             15  EP-YR               PIC  99.                     ELCDTEVR
  7336         10  EP-MO                   PIC  99.                     ELCDTEVR
  7337         10  EP-DA                   PIC  99.                     ELCDTEVR
  7338     05  WS-EP-DT-N REDEFINES                                        CL**2
  7339            WS-EP-DT                 PIC 9(11).                      CL**2
  7340     05  WS-DTE-CONV-DT.                                             CL**4
  7341         10  FILLER                  PIC  9(03).                     CL**4
  7342         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7343         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7344             15  DTE-CONV-CC         PIC  99.                        CL**4
  7345             15  DTE-CONV-YR         PIC  99.                        CL**4
  7346         10  DTE-CONV-MO             PIC  99.                        CL**4
  7347         10  DTE-CONV-DA             PIC  99.                        CL**4
  7348     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7349            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7350 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7351     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7352         10  FILLER                            PIC 999.           ELCDTEVR
  7353         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7354         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7355             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7356             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7357         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7358         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7359     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7360            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7361     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7362         10  FILLER                            PIC 999.           ELCDTEVR
  7363         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7364         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 144
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7365         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7366         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7367     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7368            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7369 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7370     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7371         10  FILLER                            PIC 999.           ELCDTEVR
  7372         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7373         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7374             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7375             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7376         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7377         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7378     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7379            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7380     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7381         10  FILLER                            PIC 999.           ELCDTEVR
  7382         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7383         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7384             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7385             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7386         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7387         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7388     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7389            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7390     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7391         10  FILLER                            PIC 999.           ELCDTEVR
  7392         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7393         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7394             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7395             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7396         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7397         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7398     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7399            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7400 01  WS-RATE-RECORD.                                              ELCDTEVR
  7401         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7402             10  FILLER                        PIC 999.           ELCDTEVR
  7403             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7404             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7405                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7406                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7407             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7408             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7409         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7410                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 145
* ECS010.cbl
* 7412                             COPY ELCACCTV.
  7413******************************************************************04/14/98
  7414*                                                                *ELCACCTV
  7415*                            ELCACCTV                            *   LV002
  7416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7417*                            VMOD=2.001                          *ELCACCTV
  7418*                                                                *ELCACCTV
  7419*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7420*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7421*                                                                *ELCACCTV
  7422*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7423*                                                                *ELCACCTV
  7424******************************************************************ELCACCTV
  7425                                                                  ELCACCTV
  7426 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7427                                                                  ELCACCTV
  7428     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7429         10  FILLER            PIC 999.                           ELCACCTV
  7430         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7431         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7432             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7433             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7434         10  AM-EXP-MO         PIC 99.                               CL**5
  7435         10  AM-EXP-DA         PIC 99.                               CL**5
  7436     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7437            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7438     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7439         10  FILLER                    PIC 999.                   ELCACCTV
  7440         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7441         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7442             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7443             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7444         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7445         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7446     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7447            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7448     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7449         10  FILLER                    PIC 999.                   ELCACCTV
  7450         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7451         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7452             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7453             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7454         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7455         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7456     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7457            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7458     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7459         10 FILLER                     PIC 999.                   ELCACCTV
  7460         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7461         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7462            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7463            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7464         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7465         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7466     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7467            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7468     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7469         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 146
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7470         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7471         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7472            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7473            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7474         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7475         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7476     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7477            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7478     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7479         10  FILLER                    PIC 999.                   ELCACCTV
  7480         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7481         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7482             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7483             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7484         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7485         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7486     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7487            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7488     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7489         10  FILLER                    PIC 999.                   ELCACCTV
  7490         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7491         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7492             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7493             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7494         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7495         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7496     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7497            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7498     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7499         10  FILLER                    PIC 999.                   ELCACCTV
  7500         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7501         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7502             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7503             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7504         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7505         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7506     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7507            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7508     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7509         10  FILLER                    PIC 999.                   ELCACCTV
  7510         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7511         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7512             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7513             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7514         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7515         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7516     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7517            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 147
* ECS010.cbl
* 7519                             COPY ELCEXTVR.
  7520******************************************************************04/15/98
  7521*                                                                *ELCEXTVR
  7522*                                                                *ELCEXTVR
  7523*                             ELCEXTVR                           *   LV002
  7524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7525*                            VMOD=2.001                          *ELCEXTVR
  7526*                                                                *ELCEXTVR
  7527*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7528*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7529*                                                                *ELCEXTVR
  7530******************************************************************ELCEXTVR
  7531 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7532     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7533         10  FILLER              PIC 999.                         ELCEXTVR
  7534         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7535         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7536             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7537             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7538         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7539         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7540     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7541            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7542 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7543     05  WS-DE-EFF.                                               ELCEXTVR
  7544         10  FILLER              PIC 999.                         ELCEXTVR
  7545         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7546         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7547             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7548             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7549         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7550         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7551     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7552            WS-DE-EFF            PIC 9(11).                          CL**2
  7553     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7554         10  FILLER              PIC 999.                         ELCEXTVR
  7555         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7556         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7557             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7558             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7559         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7560         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7561     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7562            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7563     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7564         10  FILLER                 PIC 999.                      ELCEXTVR
  7565         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7566         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7567             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7568             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7569         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7570         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7571     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7572            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7573     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7574         10  FILLER                 PIC 999.                      ELCEXTVR
  7575         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7576         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7577             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7578             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7579         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7580         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7581     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7582            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7583     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7584         10  FILLER                 PIC 999.                      ELCEXTVR
  7585         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7586         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7587             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7588             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7589         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7590         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7591     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7592            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7593     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7594         10  FILLER                 PIC 999.                      ELCEXTVR
  7595         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7596         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7597             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7598             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7599         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7600         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7601     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7602            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7603     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7604         10  FILLER                 PIC 999.                      ELCEXTVR
  7605         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7606         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7607             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7608             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7609         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7610         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7611     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7612            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7613     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7614         10  FILLER                 PIC 999.                         CL**5
  7615         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7616         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7617             15  DE-CP-CC           PIC 99.                          CL**5
  7618             15  DE-CP-YR           PIC 99.                          CL**5
  7619         10  DE-CP-MO               PIC 99.                          CL**5
  7620         10  DE-CP-DA               PIC 99.                          CL**5
  7621     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7622            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7623     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7624         10  FILLER                 PIC 999.                         CL**5
  7625         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7626         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7627             15  DE-RP-CC           PIC 99.                          CL**5
  7628             15  DE-RP-YR           PIC 99.                          CL**5
  7629         10  DE-RP-MO                      PIC 99.                   CL**5
  7630         10  DE-RP-DA                      PIC 99.                   CL**5
  7631     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7632            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7633     05  WS-DE-INCUR.                                             ELCEXTVR
  7634         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7635         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7636         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7637             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7638             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7639         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7640         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7641     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7642            WS-DE-INCUR             PIC 9(11).                       CL**2
  7643     05  WS-DE-PAY.                                               ELCEXTVR
  7644         10  FILLER                 PIC 999.                      ELCEXTVR
  7645         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7646         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7647             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7648             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7649         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7650         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7651     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7652            WS-DE-PAY               PIC 9(11).                       CL**2
  7653     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7654         10  FILLER                 PIC 999.                      ELCEXTVR
  7655         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7656         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7657             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7658             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7659         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7660         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7661     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7662            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7663     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7664         10 FILLER                  PIC 999.                      ELCEXTVR
  7665         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7666         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7667            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7668            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7669         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7670         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7671     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7672            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7673     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7674         10 FILLER                  PIC 999.                      ELCEXTVR
  7675         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7676         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7677            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7678            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7679         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7680         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7681     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7682            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7683     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7684         10  FILLER                 PIC 999.                      ELCEXTVR
  7685         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7686         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7687             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7688             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7689         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7690         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7691     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7692            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 150
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7693     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7694         10  FILLER                 PIC 999.                      ELCEXTVR
  7695         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7696         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7697             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7698             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7699         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7700         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7701     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7702            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7703     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7704         10  FILLER                        PIC 999.               ELCEXTVR
  7705         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7706         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7707                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7708             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7709             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7710         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7711         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7712     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7713            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7714     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7715         10  FILLER                        PIC 999.               ELCEXTVR
  7716         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7717         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7718                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7719             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7720             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7721         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7722         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7723     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7724            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7725                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 151
* ECS010.cbl
  7727 PROCEDURE DIVISION.
  7728
  7729 0000-START.
  7730
  7731******************************************************************
  7732***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7733******************************************************************
  7734
  7735*0003-LOAD-DATE-CARD.
* 7736                             COPY ELCDTERX.
  7737******************************************************************04/15/98
  7738*                                                                *ELCDTERX
  7739*                                                                *ELCDTERX
  7740*                            ELCDTERX.                           *   LV002
  7741*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7742*                            VMOD=2.007                          *ELCDTERX
  7743*                                                                *ELCDTERX
  7744*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7745*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7746*      = ELCDTEFD)                                               *ELCDTERX
  7747*                                                                *ELCDTERX
  7748******************************************************************ELCDTERX
  7749                                                                  ELCDTERX
  7750     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7751                                                                  ELCDTERX
  7752     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7753     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7754     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7755                                                                  ELCDTERX
  7756     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7757                                                                  ELCDTERX
  7758******************************************************************ELCDTERX
  7759*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7760*          WARNING MESSAGES.                                      ELCDTERX
  7761******************************************************************ELCDTERX
  7762     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7763         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7764                                                                  ELCDTERX
  7765     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7766                                                                  ELCDTERX
  7767     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7768                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7769                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7770                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7771                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7772                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7773                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7774                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7775                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7776                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7777                                                                  ELCDTERX
  7778     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7779                                                                  ELCDTERX
  7780     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7781                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7782                                                                  ELCDTERX
  7783     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7784     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7785     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7786     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7787                                                                  ELCDTERX
  7788     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7789         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7790     ELSE                                                         ELCDTERX
  7791         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7792                                                                  ELCDTERX
  7793     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7794         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7795     ELSE                                                         ELCDTERX
  7796         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7797                                                                  ELCDTERX
  7798 0005-READ--CARD.                                                 ELCDTERX
  7799     READ DISK-DATE                                               ELCDTERX
  7800         AT END CLOSE DISK-DATE                                   ELCDTERX
  7801             GO TO 0060-READ--TEST.                               ELCDTERX
  7802                                                                  ELCDTERX
  7803     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7804                                                                  ELCDTERX
  7805     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7806         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7807         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7808         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7809         GO TO 0005-READ--CARD.                                   ELCDTERX
  7810                                                                  ELCDTERX
  7811     IF DD-ID = 'CLAD'                                            ELCDTERX
  7812         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7813         GO TO 0005-READ--CARD.                                   ELCDTERX
  7814                                                                  ELCDTERX
  7815     IF DD-ID = 'CLAX'                                            ELCDTERX
  7816         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7817         GO TO 0005-READ--CARD.                                   ELCDTERX
  7818                                                                  ELCDTERX
  7819     IF DD-ID = 'CLAF'                                            ELCDTERX
  7820         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7821         GO TO 0005-READ--CARD.                                   ELCDTERX
  7822                                                                  ELCDTERX
  7823     IF DD-ID = 'CLAC'                                            ELCDTERX
  7824         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7825                                                                  ELCDTERX
  7826     IF DD-ID = 'CARR'                                            ELCDTERX
  7827         GO TO 0015-READ--CARR.                                   ELCDTERX
  7828                                                                  ELCDTERX
  7829     IF DD-ID = 'STAT'                                            ELCDTERX
  7830         GO TO 0020-READ--STAT.                                   ELCDTERX
  7831                                                                  ELCDTERX
  7832     IF DD-ID = 'BUSC'                                            ELCDTERX
  7833         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7834                                                                  ELCDTERX
  7835     IF DD-ID = 'MORT'                                            ELCDTERX
  7836         GO TO 0030-READ--MORT.                                   ELCDTERX
  7837                                                                  ELCDTERX
  7838     IF DD-ID = 'CLAI'                                            ELCDTERX
  7839         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7840                                                                  ELCDTERX
  7841     IF DD-ID = 'COLC'                                            ELCDTERX
  7842         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7843                                                                  ELCDTERX
  7844     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7845        DD-IDA = 'CL'                                             ELCDTERX
  7846         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7847                                                                  ELCDTERX
  7848     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7849        DD-IDA = 'PO'                                             ELCDTERX
  7850         GO TO 0050-READ--POXX.                                   ELCDTERX
  7851                                                                  ELCDTERX
  7852     IF DD-ID = 'OPCA'                                            ELCDTERX
  7853         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7854                                                                  ELCDTERX
  7855     IF DD-ID = 'OPST'                                            ELCDTERX
  7856         GO TO 0072-READ--OPST.                                   ELCDTERX
  7857                                                                  ELCDTERX
  7858     IF DD-ID = 'OPBS'                                            ELCDTERX
  7859         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7860                                                                  ELCDTERX
  7861     IF DD-ID = 'OPMS'                                            ELCDTERX
  7862         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7863                                                                  ELCDTERX
  7864     GO TO 0005-READ--CARD.                                       ELCDTERX
  7865                                                                  ELCDTERX
  7866 0010-READ--CLAC.                                                 ELCDTERX
  7867     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7868     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7869     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7870     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7871     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7872     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7873     GO TO 0005-READ--CARD.                                       ELCDTERX
  7874                                                                  ELCDTERX
  7875 0015-READ--CARR.                                                 ELCDTERX
  7876     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7877     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7878        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7879        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7880        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7881        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7882        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7883        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7884        MOVE DD-CARR1-SECPAY-SW
  7885                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7886     END-IF
  7887                                                                  ELCDTERX
  7888     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7889     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7890        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7891        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7892        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7893        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7894        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7895        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7896        MOVE DD-CARR2-SECPAY-SW
  7897                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7898     END-IF
  7899                                                                  ELCDTERX
  7900                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7901     GO TO 0005-READ--CARD.                                       ELCDTERX
  7902                                                                  ELCDTERX
  7903 0020-READ--STAT.                                                 ELCDTERX
  7904     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7905     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7906        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7907         GO TO 0005-READ--CARD.                                   ELCDTERX
  7908                                                                  ELCDTERX
  7909     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7910     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7911     GO TO 0020-READ--STAT.                                       ELCDTERX
  7912                                                                  ELCDTERX
  7913 0025-READ--BUSC.                                                 ELCDTERX
  7914     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7915     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7916        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7917         GO TO 0005-READ--CARD.                                   ELCDTERX
  7918                                                                  ELCDTERX
  7919     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7920     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7921     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7922                                                                  ELCDTERX
  7923 0030-READ--MORT.                                                 ELCDTERX
  7924     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7925     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7926        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7927         GO TO 0005-READ--CARD.                                   ELCDTERX
  7928                                                                  ELCDTERX
  7929     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7930     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7931     GO TO 0030-READ--MORT.                                       ELCDTERX
  7932                                                                  ELCDTERX
  7933 0035-READ--CLXX.                                                 ELCDTERX
  7934     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7935          GO TO 0005-READ--CARD.                                  ELCDTERX
  7936                                                                  ELCDTERX
  7937     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7938         DISPLAY '***********************************************'ELCDTERX
  7939         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7940         DISPLAY '***********************************************'ELCDTERX
  7941         GO TO 0055-READ--STOP.                                   ELCDTERX
  7942                                                                  ELCDTERX
  7943     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7944        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7945         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7946                                                                  ELCDTERX
  7947     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7948        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7949         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7950                                                                  ELCDTERX
  7951*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7952     GO TO 0005-READ--CARD.                                       ELCDTERX
  7953                                                                  ELCDTERX
  7954 0040-READ--CLAI.                                                 ELCDTERX
  7955     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7956     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7957        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7958         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7959                                                                  ELCDTERX
  7960     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7961     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7962     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7963                                                                  ELCDTERX
  7964 0045-READ--DUMP.                                                 ELCDTERX
  7965     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7966     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7967                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7968     PERFORM ABEND-PGM.                                           ELCDTERX
  7969                                                                  ELCDTERX
  7970 0050-READ--POXX.                                                 ELCDTERX
  7971     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7972         GO TO 0005-READ--CARD.                                   ELCDTERX
  7973                                                                  ELCDTERX
  7974     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7975         DISPLAY '***********************************************'ELCDTERX
  7976         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7977         DISPLAY '***********************************************'ELCDTERX
  7978         GO TO 0055-READ--STOP.                                   ELCDTERX
  7979                                                                  ELCDTERX
  7980     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7981     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7982     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7983     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7984                                                                  ELCDTERX
  7985     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7986         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7987     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7988         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7989                                                                  ELCDTERX
  7990     GO TO 0005-READ--CARD.                                       ELCDTERX
  7991                                                                  ELCDTERX
  7992 0055-READ--STOP.                                                 ELCDTERX
  7993     GOBACK.                                                      ELCDTERX
  7994                                                                  ELCDTERX
  7995 0060-READ--TEST.                                                 ELCDTERX
  7996     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7997        CLAX-ID         = SPACE  OR                               ELCDTERX
  7998        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7999         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8000                                                                  ELCDTERX
  8001     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  8002     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8003                                                                  ELCDTERX
  8004 0065-READ--COLC.                                                 ELCDTERX
  8005     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8006     GO TO 0005-READ--CARD.                                       ELCDTERX
  8007                                                                  ELCDTERX
  8008 0070-READ--OPCA.                                                 ELCDTERX
  8009                                                                  ELCDTERX
  8010     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8011                                                                  ELCDTERX
  8012     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8013             OR                                                   ELCDTERX
  8014         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8015         GO TO 0005-READ--CARD.                                   ELCDTERX
  8016                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 156
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8017     ADD 1                       TO INDEXCA.                      ELCDTERX
  8018     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8019                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8020     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8021                                                                  ELCDTERX
  8022 0072-READ--OPST.                                                 ELCDTERX
  8023                                                                  ELCDTERX
  8024     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8025                                                                  ELCDTERX
  8026     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8027             OR                                                   ELCDTERX
  8028         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8029         GO TO 0005-READ--CARD.                                   ELCDTERX
  8030                                                                  ELCDTERX
  8031     ADD 1                       TO INDEXST.                      ELCDTERX
  8032     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8033                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8034     GO TO 0072-READ--OPST.                                       ELCDTERX
  8035                                                                  ELCDTERX
  8036 0074-READ--OPBS.                                                 ELCDTERX
  8037                                                                  ELCDTERX
  8038     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8039                                                                  ELCDTERX
  8040     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8041             OR                                                   ELCDTERX
  8042         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8043         GO TO 0005-READ--CARD.                                   ELCDTERX
  8044                                                                  ELCDTERX
  8045     ADD 1                       TO INDEXBS.                      ELCDTERX
  8046     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8047     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8048                                                                  ELCDTERX
  8049 0079-READ--EXIT.                                                 ELCDTERX
  8050*    EXIT.                                                        ELCDTERX
  8051******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 157
* ECS010.cbl
  8053******************************************************************
  8054***           O P E N   F I L E S   R O U T I N E              ***
  8055******************************************************************
  8056
  8057     DISPLAY ' '.
  8058     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8059         'ECS010 ******'
  8060     DISPLAY ' '.
  8061
  8062     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8063     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8064     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8065     .
  8066 0080-OPEN-FILES.
  8067*    IF DTE-PGM-OPT = '1'
  8068*       open output detail-extr
  8069*    end-if
  8070     OPEN INPUT  PENDING-EXTRACT
  8071                 CERT-MASTER-IN
  8072                 ERACCTT-IN
  8073                 ERAGTC
  8074
  8075          I-O    ERMEBL-INOUT
  8076                 ELCRTT
  8077
  8078          OUTPUT SUMMARY-EXTR
  8079                 ME-ECS010-BALANCE
  8080                 ME50-ECS010-BALANCE
  8081                 DISPLAY-PRT
  8082                 MISMATCH-REPORT
  8083                 PRINT-COPY.
  8084     IF DTE-CLIENT = 'DCC'
  8085        OPEN INPUT ERPDEF
  8086     END-IF
  8087
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 158
* ECS010.cbl
  8089*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8090     IF DTE-CLIENT NOT = 'DMD'
  8091         NEXT SENTENCE
  8092     ELSE
  8093         OPEN INPUT ERRESC-IN
  8094            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8095                NEXT SENTENCE
  8096            ELSE
  8097                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8098                MOVE 'ERROR OPENING ERRESC FILE'
  8099                                        TO WS-ABEND-MESSAGE
  8100                GO TO ABEND-PGM.
  8101*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8102
  8103     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8104         NEXT SENTENCE
  8105       ELSE
  8106         MOVE '11'                    TO ABEND-CODE-1
  8107         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8108         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8109         GO TO ABEND-PGM.
  8110
  8111     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8112        CONTINUE
  8113     ELSE
  8114        DISPLAY ' OPEN ERROR ELCRTT '
  8115        MOVE '31'                TO ABEND-CODE-1
  8116        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8117        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8118        GO TO ABEND-PGM
  8119     END-IF
  8120
  8121     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8122        CONTINUE
  8123     ELSE
  8124        DISPLAY ' OPEN ERROR ERAGTC '
  8125        MOVE '41'                TO ABEND-CODE-1
  8126        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8127        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8128        GO TO ABEND-PGM
  8129     END-IF
  8130
  8131     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8132        CONTINUE
  8133     ELSE
  8134        DISPLAY ' OPEN ERROR ERPDEF '
  8135        MOVE '61'                TO ABEND-CODE-1
  8136        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8137        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8138        GO TO ABEND-PGM
  8139     END-IF
  8140
  8141     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8142         NEXT SENTENCE
  8143       ELSE
  8144         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8145
  8146           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 159
* ECS010.cbl
  8147              and (dte-pgm-opt = '1')
  8148              open output new-detail-extr
  8149           end-if
  8150
  8151     IF DTE-PGM-OPT = '1'
  8152         OPEN OUTPUT  CERT-MASTER-OUT
  8153                      DETAIL-EXTR
  8154     ELSE
  8155         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8156         MOVE '*'                     TO TRANS-EOF-FLAG.
  8157
  8158     MOVE 'R'                         TO CP-RATE-FILE.
  8159     MOVE 'O'                         TO CP-IO-FUNCTION.
  8160     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8161     IF IO-ERROR
  8162         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8163                                      TO WS-ABEND-MESSAGE
  8164         MOVE 0302                    TO WS-RETURN-CODE
  8165         GO TO ABEND-PGM.
  8166
  8167******************************************************************
  8168***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8169******************************************************************
  8170
  8171 0090-INITIALIZATION-ROUTINE.
  8172
  8173     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8174     MOVE WS-TIME                     TO ME-START-TIME.
  8175     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8176                                         TR-RN-DT.
  8177     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8178     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8179     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8180     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8181     MOVE COMPANY-NAME                TO TRHDNM.
  8182     MOVE ALPH-DATE                   TO TR-MODAYR.
  8183     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8184     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8185
  8186     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8187     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8188     COMPUTE LYD-MO = LYD-MO - 1.
  8189     IF LYD-MO = ZERO
  8190         MOVE 12                      TO LYD-MO
  8191         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8192
  8193     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8194
  8195
  8196     IF DTE-CLIENT = 'CID'
  8197         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8198         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8199     ELSE
  8200       IF DTE-CLIENT = 'AHL'
  8201         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8202         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8203       ELSE
  8204         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 160
* ECS010.cbl
  8205         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8206       END-IF
  8207     END-IF.
  8208
  8209     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8210         GO TO 0090-CONTINUE.
  8211
  8212     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8213     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8214     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8215     MOVE '6'                    TO DC-OPTION-CODE.
  8216     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8217
  8218     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8219         MOVE '**** WORK DATE CALC ERROR ****'
  8220                                 TO WS-ABEND-MESSAGE
  8221         MOVE '90'               TO ABEND-CODE-1
  8222         MOVE '0'                TO AC2-ONE
  8223         MOVE DC-ERROR-CODE      TO AC2-TWO
  8224         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8225         GO TO ABEND-PGM.
  8226
  8227     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8228
  8229     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8230     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8231
  8232     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8233             VARYING
  8234         SUBM FROM +2 BY +1
  8235             UNTIL
  8236         SUBM GREATER THAN +12.
  8237
  8238     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8239
  8240     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8241             VARYING
  8242         SUBM FROM +1 BY +1
  8243             UNTIL
  8244         SUBM GREATER THAN +13.
  8245
  8246     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8247*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8248     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8249                                    DC-ELAPSED-MONTHS.
  8250     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8251     MOVE 1                      TO DC-END-OF-MONTH.
  8252     MOVE '6'                    TO DC-OPTION-CODE.
  8253     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8254
  8255     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8256         MOVE '**** CUT OFF DATE ERROR ****'
  8257                                 TO WS-ABEND-MESSAGE
  8258         MOVE '90'               TO ABEND-CODE-1
  8259         MOVE '0'                TO AC2-ONE
  8260         MOVE DC-ERROR-CODE      TO AC2-TWO
  8261         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8262         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 161
* ECS010.cbl
  8263
  8264     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8265     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8266
  8267 0090-CONTINUE.
  8268
  8269     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8270     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8271     MOVE +0                     TO DC-ELAPSED-DAYS.
  8272     MOVE '6'                    TO DC-OPTION-CODE.
  8273     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8274
  8275     IF NO-CONVERSION-ERROR
  8276        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8277
  8278     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8279     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8280     MOVE +0                     TO DC-ELAPSED-DAYS.
  8281     MOVE '6'                    TO DC-OPTION-CODE.
  8282     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8283
  8284     IF NO-CONVERSION-ERROR
  8285        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8286
  8287     MOVE +0                     TO DC-ELAPSED-MONTHS
  8288                                    DC-ELAPSED-DAYS.
  8289
  8290     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8291     MOVE 'CR'                   TO CR-RECORD-ID.
  8292     MOVE ZEROS                  TO
  8293               CR-AGE                  CR-JOINT-AGE
  8294               CR-LFTYP                CR-AHTYP
  8295               CR-LF-TERM              CR-AH-TERM
  8296               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8297               CR-LF-TERM-IN-DAYS
  8298               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8299               CR-LFAMT                CR-AHAMT
  8300               CR-LFPRM                CR-AHPRM
  8301               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8302               CR-LFPRM-CALC           CR-AHPRM-CALC
  8303               CR-LFPRM-RATE           CR-AHPRM-RATE
  8304               CR-LFAMT-ALT
  8305               CR-LFPRM-ALT
  8306               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8307               CR-LFPRM-RATE-ALT
  8308               CR-LFRFND               CR-AHRFND
  8309               CR-LFRFND-CALC          CR-AHRFND-CALC
  8310               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8311               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8312               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8313               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8314               CR-LIVES                CR-APR
  8315               CR-BILLED
  8316               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8317               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8318               CR-PMT-FREQ             CR-LOAN-TERM
  8319               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8320               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 162
* ECS010.cbl
  8321               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8322               CR-LF-CANC-DT           CR-AH-CANC-DT
  8323               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8324               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8325               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8326               CR-DTH-DT               CR-DIS-DT
  8327               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8328               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8329                                       CR-DIS-PTO-DT
  8330               CR-DTHAMT               CR-DISAMT
  8331               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8332               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8333               CR-DTHEXP               CR-DISEXP
  8334               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8335               CR-DTH-AGE              CR-DAYS-DISAB
  8336               CR-DIS-INCUR-DT (1)
  8337***            CR-CLAIM-DEDUCT-WITHHELD
  8338               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8339               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8340               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8341               CR-MOB-NET-TOT-FEES
  8342               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8343               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8344
  8345     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8346                                       CR-DISAB-DETAIL-DATA (3)
  8347                                       CR-DISAB-DETAIL-DATA (4)
  8348                                       CR-DISAB-DETAIL-DATA (5).
  8349
  8350     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8351
  8352     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8353     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8354        IA > +10
  8355        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8356     END-PERFORM
  8357     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8358
  8359     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8360
  8361     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8362                          EPEC-TOTALS      EPEC-SUBS
  8363                          EPEC-UNDERWRITTEN-TOTALS.
  8364
  8365     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8366                          EPEC-LEVELS-END-II.
  8367     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8368                          DUPE-CERT-TABLE.
  8369
  8370     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8371     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8372     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8373                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8374     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8375                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8376
  8377     IF RUN-DATE NOT = EP-DT
  8378         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 163
* ECS010.cbl
  8379     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8380     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8381     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8382     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8383
  8384     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8385         MOVE +1000                   TO DUP-MAX.
  8386
  8387     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8388     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8389     IF ME-DO-UPDATE
  8390         READ ERMEBL-INOUT INVALID KEY
  8391                       CLOSE ERMEBL-INOUT
  8392                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8393
  8394     IF DTE-CLIENT = 'DCC'
  8395        MOVE 0 TO B-SUB
  8396        MOVE DTE-CLASIC-COMPANY-CD
  8397                                 TO PD-CONTROL-PRIMARY
  8398        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8399        IF ERPDEF-FILE-STATUS = '00'
  8400           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8401              READ ERPDEF NEXT RECORD
  8402              IF ERPDEF-FILE-STATUS = '00'
  8403                 ADD 1 TO B-SUB
  8404                 IF B-SUB > max-pdef
  8405                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8406                    GO TO ABEND-PGM
  8407                 END-IF
  8408                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8409                 MOVE PD-PRODUCT-CD
  8410                                 TO DD-PRODUCT-CD (B-SUB)
  8411                 MOVE PD-BEN-TYPE
  8412                                 TO DD-BEN-TYPE (B-SUB)
  8413                 MOVE PD-BEN-CODE
  8414                                 TO DD-BEN-CODE (B-SUB)
  8415                 MOVE PD-PROD-EXP-DT
  8416                                 TO DD-PROD-EXP-DT (B-SUB)
  8417                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8418                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8419                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8420                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8421                    P2 > +8
  8422                    MOVE PD-PROD-CODE (P2)
  8423                                 TO DD-PROD-CODE (B-SUB P2)
  8424                    MOVE PD-MAX-AMT (P2)
  8425                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8426                 END-PERFORM
  8427                 MOVE PD-EARN-FACTORS
  8428                                 TO DD-EARN-FACTORS (B-SUB)
  8429              END-IF
  8430           END-PERFORM
  8431           display ' pdef table entries ' b-sub
  8432        END-IF
  8433        CLOSE ERPDEF
  8434     END-IF
  8435
  8436     GO TO 0150-READ-ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 164
* ECS010.cbl
  8437
  8438 0090-EXIT.
  8439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 165
* ECS010.cbl
  8441 0095-GET-EOM-DATES.
  8442
  8443     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8444     MOVE '6'                    TO DC-OPTION-CODE.
  8445     MOVE 1                      TO DC-ELAPSED-MONTHS
  8446                                    DC-END-OF-MONTH.
  8447     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8448     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8449
  8450     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8451         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8452                                 TO WS-ABEND-MESSAGE
  8453         MOVE '90'               TO ABEND-CODE-1
  8454         MOVE '0'                TO AC2-ONE
  8455         MOVE DC-ERROR-CODE      TO AC2-TWO
  8456         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8457         GO TO ABEND-PGM.
  8458
  8459     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8460                                     DC-BIN-DATE-1.
  8461     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8462     MOVE ' '                    TO  DC-OPTION-CODE.
  8463     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8464
  8465     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8466         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8467                                 TO WS-ABEND-MESSAGE
  8468         MOVE '90'               TO ABEND-CODE-1
  8469         MOVE '0'                TO AC2-ONE
  8470         MOVE DC-ERROR-CODE      TO AC2-TWO
  8471         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8472         GO TO ABEND-PGM.
  8473
  8474     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8475
  8476 0095-EXIT.
  8477     EXIT.
  8478
  8479 0096-DISPLAY-EOM-DATES.
  8480
  8481     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8482
  8483 0096-EXIT.
  8484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 166
* ECS010.cbl
  8486******************************************************************
  8487***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8488******************************************************************
  8489
  8490 0100-ACCT-MASTER-READ-ROUTINE.
  8491
  8492     IF EP-FLG = '1'
  8493        ADD +1                   TO BC-ACT-ACCTS
  8494        IF DTE-OPT-RESERVE-METHOD-AUTH
  8495           PERFORM 4700-CALC-OPT-IBNR
  8496                                 THRU 4700-EXIT
  8497        END-IF
  8498        PERFORM 4500-BUILD-EPEC-EXTRACT
  8499                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8500     END-IF
  8501
  8502     IF TRANSACTION-WAS-PROCESSED
  8503         MOVE '1'                     TO ACCT-FLG
  8504                                         STATE-FLG
  8505                                         COMP-FLG
  8506                                         CARR-FLG
  8507                                         FINAL-FLG.
  8508
  8509 0150-READ-ACCOUNT-MASTER.
  8510
  8511     READ ERACCTT-IN AT END
  8512         GO TO 9930-EOJ-3.
  8513
  8514     ADD +1                            TO ERACCTT-READS.
  8515
* 8516     COPY ELCACCTI.
  8517******************************************************************04/14/98
  8518*                                                                *ELCACCTI
  8519*                            ELCACCTI                            *   LV003
  8520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8521*                            VMOD=2.001                          *ELCACCTI
  8522*                                                                *ELCACCTI
  8523*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8524*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8525*                                                                *ELCACCTI
  8526*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8527*                                                                *ELCACCTI
  8528******************************************************************ELCACCTI
  8529     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8530     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8531     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8532     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8533     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8534     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8535     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8536     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8537     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8538
  8539     IF FIRST-ACCOUNT EQUAL +1
  8540        MOVE +0                  TO FIRST-ACCOUNT
  8541        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8542
  8543     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 167
* ECS010.cbl
  8544         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8545     ELSE
  8546     IF AM-GROUPING NOT = HLD-GROUPING
  8547         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8548     ELSE
  8549     IF AM-STATE NOT = HLD-STATE
  8550         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8551     ELSE
  8552     IF AM-ACCOUNT NOT = HLD-ACCT
  8553         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8554     ELSE
  8555     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8556
  8557     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8558        (AM-GROUPING NOT = HLD-GROUPING)
  8559         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8560
  8561 0190-PROCESS-NEW-ACCOUNT.
  8562
  8563     IF AM-CARRIER NOT = HLD-CARRIER
  8564         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8565
  8566     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8567     MOVE AM-CARRIER            TO TR-CARR.
  8568     MOVE AM-GROUPING           TO TR-GROUP.
  8569     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8570     MOVE AM-NAME               TO TR-AGCY.
  8571     MOVE AM-EFF-MO             TO TR-CE-MO.
  8572     MOVE AM-EFF-DA             TO TR-CE-DA.
  8573     MOVE AM-EFF-YR             TO TR-CE-YR.
  8574     MOVE AM-STATE              TO TR-ST-NO.
  8575     IF AM-EXPIRE-DT =  99999999999
  8576         MOVE 'CURRENT '        TO TR-CX
  8577     ELSE
  8578         MOVE AM-EXP-MO         TO TR-CX-MO
  8579         MOVE AM-EXP-DA         TO TR-CX-DA
  8580         MOVE AM-EXP-YR         TO TR-CX-YR
  8581         MOVE '-'               TO HSHR1  HSHR2.
  8582
  8583     ADD +1 TO BC-ACCTS.
  8584
  8585     IF AM-RECORD-ID = '**'
  8586         ADD +1 TO BC-NEW-ACCTS.
  8587     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8588         ADD +1 TO BC-ER-ACCTS.
  8589
  8590     MOVE ZEROS                 TO SV-LO-CERT
  8591                                   SV-HI-CERT.
  8592     MOVE SPACE                 TO TRANSACTION-FLAG
  8593                                   LST-TRD-CERT
  8594                                   LST-TRD-ISDT
  8595                                   OB-DATE-1-SWITCH
  8596                                   OB-DATE-2-SWITCH
  8597                                   OB-DATE-3-SWITCH.
  8598     MOVE +81                   TO LN-CNT.
  8599
  8600     IF DTE-CLIENT = 'DCC'
  8601        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 168
* ECS010.cbl
  8602        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8603           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8604              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8605           END-IF
  8606           IF AM-COMM-CHARGEBACK (SUB) = 99
  8607              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8608           END-IF
  8609        END-PERFORM
  8610     END-IF
  8611     .
  8612 0199-READ-ACCOUNT-X.
  8613     EXIT.
  8614
  8615 0199A-CARRIER-TABLE-LOOKUP.
  8616
  8617     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8618            VARYING CLAS-INDEXCN FROM 1 BY 1
  8619         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8620               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8621
  8622     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8623         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8624         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8625                                 TO WS-ABEND-MESSAGE
  8626         MOVE 4004               TO WS-ABEND-CODE
  8627         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8628         GO TO ABEND-PGM.
  8629
  8630 0199A-LOOKUP-XIT.
  8631     EXIT.
  8632 0199B-SEARCH-CARRIER-TABLE.
  8633     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 169
* ECS010.cbl
  8635******************************************************************
  8636***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8637******************************************************************
  8638
  8639 0200-CERT-MASTER-READ-ROUTINE.
  8640
  8641     IF EOF-ON-CERT
  8642         GO TO 0299-READ-CERT-X.
  8643
  8644     IF FIRST-CERT EQUAL +1
  8645        MOVE +0                  TO FIRST-CERT
  8646        GO TO 0250-READ-CERT-MASTER.
  8647
  8648     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8649
  8650     PERFORM CERT-DATE-LOAD.
  8651
  8652     IF CR-IND-GRP = 'I'  OR  '1'
  8653         MOVE '1'                    TO CR-IND-GRP
  8654     ELSE
  8655         MOVE '2'                    TO CR-IND-GRP.
  8656
  8657     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8658         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8659     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8660         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8661
  8662************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8663     IF DTE-CLIENT NOT = 'NSL'
  8664         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8665                                      CR-AH-REI-RISK-PRM.
  8666******************************************************************
  8667
  8668**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8669****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8670     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8671         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8672
  8673     MOVE CR-STATE                   TO STATE-L.
  8674     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8675
  8676     IF CR-LFTYP NOT = ZERO
  8677         MOVE CR-LFTYP               TO CLAS-LOOK
  8678         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8679
  8680     IF CR-AHTYP NOT = ZERO
  8681         MOVE CR-AHTYP               TO CLAS-LOOK
  8682         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8683
  8684     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8685     MOVE 'L'                    TO DC-OPTION-CODE
  8686     MOVE +0                     TO DC-ELAPSED-MONTHS
  8687                                    DC-ELAPSED-DAYS
  8688     PERFORM 8000-DATE-CONVERT-ROUTINE
  8689                                 THRU 8099-DATE-CONVERT-X
  8690     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8691
  8692     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 170
* ECS010.cbl
  8693        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8694        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8695        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8696        PERFORM 0395-GET-CERT-TRLRS
  8697                                 THRU 0395-EXIT
  8698     END-IF
  8699
  8700     IF RUN-MO NOT = 01
  8701         GO TO 0250-READ-CERT-MASTER.
  8702
  8703     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8704                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8705
  8706     IF ((CR-LFTYP NOT = ZERO)  AND
  8707         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8708        ((CR-AHTYP NOT = ZERO)  AND
  8709         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8710           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8711
  8712     .
  8713 0250-READ-CERT-MASTER.
  8714
  8715     READ CERT-MASTER-IN
  8716               AT END GO TO 9920-EOJ-2.
  8717
  8718     ADD +1 TO CMIN-CNT.
  8719
  8720*     DISPLAY ' READ CERT ' CIR-CONTROL
  8721     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8722         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8723         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8724         DISPLAY 'SECOND - '  CIR-CONTROL
  8725         MOVE 0612                    TO WS-ABEND-CODE
  8726         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8727         GO TO ABEND-PGM.
  8728
  8729     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8730         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8731            pcic-dt ' ' pcic-cert-no
  8732         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8733            GO TO 0250-READ-CERT-MASTER
  8734         ELSE
  8735            MOVE 'DUPLICATE CERT ON FILE'
  8736                                      TO WS-ABEND-MESSAGE
  8737            MOVE 0302                 TO WS-ABEND-CODE
  8738            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8739            GO TO ABEND-PGM.
  8740
  8741******************************************************
  8742*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8743*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8744*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8745******************************************************
  8746     IF DTE-CLIENT = 'CID'
  8747        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8748           IF (CF-THIRD-AGENT  = '0000713100') OR
  8749              (CF-FOURTH-AGENT = '0000713100')
  8750              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 171
* ECS010.cbl
  8751           ELSE
  8752              GO TO 0250-READ-CERT-MASTER
  8753           END-IF
  8754        ELSE
  8755           IF COMPANY-NAME = '        PEOPLES TRUST'
  8756              IF CI-ACCOUNT = '0000845800'
  8757                 CONTINUE
  8758              ELSE
  8759                 GO TO 0250-READ-CERT-MASTER
  8760              END-IF
  8761           ELSE
  8762              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8763                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8764                    (CF-FOURTH-AGENT = '0000681700')
  8765                    CONTINUE
  8766                 ELSE
  8767                    GO TO 0250-READ-CERT-MASTER
  8768                 END-IF
  8769              ELSE
  8770                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8771                    IF CI-ACCOUNT = '0001107200' or '0001107201'
  8772                       CONTINUE
  8773                    ELSE
  8774                       GO TO 0250-READ-CERT-MASTER
  8775                    END-IF
  8776                 END-IF
  8777              END-IF
  8778           END-IF
  8779        END-IF
  8780     END-IF
  8781
  8782******************************************************
  8783     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8784
  8785 0299-READ-CERT-X.
  8786     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 172
* ECS010.cbl
  8788******************************************************************
  8789***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8790******************************************************************
  8791
  8792 0300-READ-PENDING-TRANSACTIONS.
  8793
  8794     READ PENDING-EXTRACT
  8795                   AT END GO TO 9910-EOJ-1.
  8796
  8797     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8798
  8799     IF NOT ED-PENDING-BUSINESS  AND
  8800        NOT ED-PENDING-CLAIMS  AND
  8801        NOT ED-CERT-CHANGES
  8802           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8803                                               ED-RECORD-TYPE
  8804           MOVE 0301                        TO WS-ABEND-CODE
  8805           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8806           GO TO ABEND-PGM.
  8807
  8808     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8809
  8810     IF DTE-CLIENT = 'NCL'
  8811         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8812             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8813                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8814             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8815
  8816     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8817         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8818         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8819         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8820         MOVE 0603                    TO WS-ABEND-CODE
  8821         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8822         GO TO ABEND-PGM.
  8823
  8824     ADD +1 TO TR-CNT.
  8825
  8826     IF ISSUE-TRANSACTION   OR
  8827        CANCEL-TRANSACTION  OR
  8828        CLAIM-TRANSACTION   OR
  8829        RESERVE-TRANSACTION OR
  8830        UPDATE-TRANSACTION
  8831         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8832         GO TO 0330-MATCH-PENDING-TO-CERT.
  8833
  8834     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8835
  8836     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8837     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8838             PENDING-RECORD-TYPE ')'.
  8839
  8840     MOVE 0301                   TO WS-ABEND-CODE.
  8841     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8842     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 173
* ECS010.cbl
  8844 0310-SET-UP-MATCHING-KEY.
  8845
  8846     IF ED-PENDING-BUSINESS
  8847         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8848         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8849         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8850         MOVE PB-STATE           TO PEND-MATCH-STATE
  8851         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8852         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8853         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8854         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8855
  8856     IF ED-PENDING-CLAIMS
  8857         ADD +1                  TO W-PENDING-CLMS
  8858         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8859         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8860         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8861         MOVE PC-STATE           TO PEND-MATCH-STATE
  8862         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8863         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8864         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8865         IF PC-CLAIMS
  8866             MOVE '3'            TO PENDING-RECORD-TYPE
  8867         ELSE
  8868             IF PC-RESERVES
  8869                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8870
  8871     IF ED-CERT-CHANGES
  8872         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8873         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8874         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8875         MOVE CC-STATE           TO PEND-MATCH-STATE
  8876         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8877         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8878         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8879         MOVE '5'                TO PENDING-RECORD-TYPE.
  8880
  8881     MOVE ' '                    TO DC-OPTION-CODE.
  8882     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8883     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8884
  8885 0310-EXIT.
  8886     EXIT.
  8887
  8888******************************************************************
  8889***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8890******************************************************************
  8891
  8892 0330-MATCH-PENDING-TO-CERT.
  8893
  8894     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8895         GO TO 0390-CERT-MISMATCH-ERROR.
  8896
  8897     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8898*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8899       IF CLAIM-TRANSACTION
  8900*         DISPLAY ' CLAIM '
  8901         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 174
* ECS010.cbl
  8902            NOT PC-NON-CHARGEBLE-EXPENSE
  8903             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8904                                      OR
  8905                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8906                  GO TO 0390-CERT-MISMATCH-ERROR.
  8907
  8908     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8909       IF RESERVE-TRANSACTION
  8910*         DISPLAY ' RESV '
  8911         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8912                                  OR
  8913            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8914              GO TO 0390-CERT-MISMATCH-ERROR.
  8915
  8916     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8917         IF ISSUE-TRANSACTION
  8918*           DISPLAY ' ISSUE '
  8919             GO TO 0380-DUPLICATE-CERT-ERROR
  8920         ELSE
  8921             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8922
  8923     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8924         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8925         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8926                                               0299-READ-CERT-X
  8927         GO TO 0330-MATCH-PENDING-TO-CERT.
  8928
  8929     IF ISSUE-TRANSACTION
  8930         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8931     ELSE
  8932         GO TO 0390-CERT-MISMATCH-ERROR.
  8933
  8934 0350-MATCH-PENDING-TO-ACCOUNT.
  8935
  8936     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8937       ADD +1  TO ERROR-COUNT
  8938         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8939           TO  DL-FULL
  8940             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8941         MOVE    ' PENDING CONTROL = '
  8942           TO  DIS-LINE-REASON
  8943         MOVE  PENDING-MATCH-CONTROL
  8944           TO  DIS-LINE-REC
  8945             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8946         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8947           TO  DIS-LINE-REASON
  8948         MOVE  PENDING-MATCH-CONTROL
  8949           TO  DIS-LINE-REC
  8950             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8951         MOVE  SPACES
  8952           TO  DISPLAY-LINE
  8953             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8955         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8956         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8957         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8958         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8959         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8960         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 175
* ECS010.cbl
  8961         AM-MSTR-CNTRL AM-EFFECT-DT
  8962         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8963            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8964            GO TO 0300-READ-PENDING-TRANSACTIONS
  8965         ELSE
  8966            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8967                                      TO WS-ABEND-MESSAGE
  8968            MOVE 0302 TO WS-ABEND-CODE
  8969            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8970            GO TO ABEND-PGM.
  8971
  8972     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8973         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8974                                              0199-READ-ACCOUNT-X
  8975         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8976
  8977     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8978        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8979         GO TO 0500-APPLY-PENDING-BUSINESS.
  8980
  8981     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8982                                       0199-READ-ACCOUNT-X.
  8983     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8984
  8985
  8986 0370-ACCOUNT-MISMATCH-ERROR.
  8987
  8988     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8989     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8990     MOVE 'MISMATCH ACCOUNT ERROR'
  8991                               TO WS-ABEND-MESSAGE.
  8992     MOVE 0302 TO WS-ABEND-CODE.
  8993         DISPLAY '******************************'
  8994         DISPLAY '***** ERROR LOCATION 009 *****'
  8995         DISPLAY '******************************'
  8996     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8997     GO TO ABEND-PGM.
  8998
  8999
  9000 0380-DUPLICATE-CERT-ERROR.
  9001
  9002     IF PB-I-OB  OR  PB-I-SUMMARY
  9003         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9004
  9005     ADD +1 TO DUP-CNT.
  9006
  9007     IF DUP-CNT NOT GREATER THAN DUP-MAX
  9008         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  9009         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  9010                                         PB-I-LF-ALT-PREMIUM-AMT
  9011         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  9012         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  9013         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9014
  9015     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  9016     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9017
  9018*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 176
* ECS010.cbl
  9019*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9020*    GO TO ABEND-PGM.
  9021
  9022
  9023 0390-CERT-MISMATCH-ERROR.
  9024
  9025     IF ISSUE-TRANSACTION  OR
  9026        CANCEL-TRANSACTION  OR
  9027        CLAIM-TRANSACTION
  9028         ADD +1                  TO  MISMATCH-COUNT.
  9029
  9030     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9031       ADD  +1  TO  ERROR-COUNT
  9032         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9033           TO  DL-FULL
  9034             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9035         MOVE    ' TRANS CONTROL = '
  9036           TO  DIS-LINE-REASON
  9037         MOVE  PENDING-MATCH-CONTROL
  9038           TO  DIS-LINE-REC
  9039             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9040         MOVE    ' TRANS TYPE    = '
  9041           TO  DIS-LINE-REASON
  9042         MOVE  PENDING-RECORD-TYPE
  9043           TO  DIS-LINE-REC
  9044             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9045         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9046           TO  DL-FULL
  9047             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9048         MOVE    ' CERT IN CTL   = '
  9049           TO  DIS-LINE-REASON
  9050         MOVE  CIR-CONTROL
  9051           TO  DIS-LINE-REC
  9052             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9053         MOVE    ' BYPASSED TRANS  = '
  9054           TO  DIS-LINE-REASON
  9055         MOVE  PENDING-MATCH-CONTROL
  9056           TO  DIS-LINE-REC
  9057             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9058         MOVE  SPACES
  9059           TO  DISPLAY-LINE
  9060             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9061         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9062
  9063     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9064     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9065
  9066     IF ISSUE-TRANSACTION
  9067         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9068     ELSE
  9069         IF CANCEL-TRANSACTION
  9070             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9071         ELSE
  9072             IF CLAIM-TRANSACTION
  9073                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9074             ELSE
  9075                 IF RESERVE-TRANSACTION
  9076                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 177
* ECS010.cbl
  9077                 ELSE
  9078                     IF UPDATE-TRANSACTION
  9079                         MOVE 'CHG'
  9080                                 TO  DTL-REC-TYPE-DESC.
  9081
  9082     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9083     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9084     MOVE 'DROPPED'              TO  DTL-STATUS.
  9085
  9086     IF ISSUE-TRANSACTION
  9087         MOVE PB-I-LF-PREMIUM-AMT
  9088                                 TO  MD2-LF-PREM
  9089         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9090                                 TO  MD2-LF-ALT-PREM
  9091         MOVE PB-I-AH-PREMIUM-AMT
  9092                                 TO  MD2-AH-PREM
  9093         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9094         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9095         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9096     ELSE
  9097         IF CANCEL-TRANSACTION
  9098             MOVE PB-C-LF-CANCEL-AMT
  9099                                 TO  MD3-LF-REFUND
  9100             MOVE PB-C-AH-CANCEL-AMT
  9101                                 TO  MD3-AH-REFUND
  9102             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9103             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9104         ELSE
  9105             IF CLAIM-TRANSACTION
  9106                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9107                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9108                     MOVE ZEROS             TO MD4-AH-CLAIM
  9109                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9110                 ELSE
  9111                     MOVE ZEROS             TO MD4-LF-CLAIM
  9112                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9113                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9114
  9115     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9116         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9117         MOVE MISMATCH-PAGE-NUMBER
  9118                                 TO  TR-PG
  9119         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9120         MOVE MR-CTL             TO  X
  9121         MOVE X TO LCP-ASA
  9122         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9123             THRU LCP-WRITE-END-MISMATCH-RPT
  9124         MOVE TR-HD-2            TO  MISMATCH-RPT
  9125         MOVE MR-CTL             TO  X
  9126         MOVE X TO LCP-ASA
  9127         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9128             THRU LCP-WRITE-END-MISMATCH-RPT
  9129         MOVE TR-HD-3            TO  MISMATCH-RPT
  9130         MOVE MR-CTL             TO  X
  9131         MOVE X TO LCP-ASA
  9132         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9133             THRU LCP-WRITE-END-MISMATCH-RPT
  9134         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 178
* ECS010.cbl
  9135         MOVE MR-CTL             TO  X
  9136         MOVE X TO LCP-ASA
  9137         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9138             THRU LCP-WRITE-END-MISMATCH-RPT
  9139         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9140
  9141     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9142     MOVE MR-CTL                 TO  X.
  9143     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9144
  9145     MOVE X TO LCP-ASA
  9146     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9147         THRU LCP-WRITE-END-MISMATCH-RPT.
  9148
  9149     IF ISSUE-TRANSACTION
  9150         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9151         MOVE MR-CTL             TO  X
  9152         ADD +1                  TO  MISMATCH-LINE-COUNT
  9153         MOVE X TO LCP-ASA
  9154         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9155             THRU LCP-WRITE-END-MISMATCH-RPT.
  9156
  9157     IF CANCEL-TRANSACTION
  9158         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9159         MOVE MR-CTL             TO  X
  9160         ADD +1                  TO  MISMATCH-LINE-COUNT
  9161         MOVE X TO LCP-ASA
  9162         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9163             THRU LCP-WRITE-END-MISMATCH-RPT.
  9164
  9165     IF CLAIM-TRANSACTION
  9166         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9167         MOVE MR-CTL             TO  X
  9168         ADD +1                  TO  MISMATCH-LINE-COUNT
  9169         MOVE X TO LCP-ASA
  9170         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9171             THRU LCP-WRITE-END-MISMATCH-RPT.
  9172
  9173     MOVE SPACES                 TO  MISMATCH-RPT.
  9174
  9175     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9176
  9177 0395-GET-CERT-TRLRS.
  9178
  9179     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9180     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9181     MOVE CR-CARRIER             TO CS-CARRIER
  9182     MOVE CR-GROUPING            TO CS-GROUPING
  9183     MOVE CR-STATE               TO CS-STATE
  9184     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9185     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9186     MOVE CR-CERT-NO             TO CS-CERT-NO
  9187     MOVE 'A'                    TO CS-TRAILER-TYPE
  9188
  9189     READ ELCRTT
  9190
  9191     IF ELCRTT-FILE-STATUS = '00'
  9192        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 179
* ECS010.cbl
  9193                                 TO WS-BANK-COMMISSIONS
  9194     ELSE
  9195        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9196           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9197           PERFORM ABEND-PGM
  9198        END-IF
  9199     END-IF
  9200
  9201     .
  9202 0395-EXIT.
  9203     EXIT.
  9204
  9205******************************************************************
  9206***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9207******************************************************************
  9208
  9209 0400-WRITE-CERT-RECORD.
  9210*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9211
  9212     IF CERTIFICATE-RECORD = LOW-VALUES
  9213         GO TO 0499-WRITE-CERT-X.
  9214
  9215     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9216         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9217         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9218            ' ' cr-dt ' ' cr-cert-no
  9219         ADD  +1  TO  ERROR-COUNT
  9220         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9221           TO  DL-FULL
  9222             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9223         MOVE    ' CERT. CONTROL = '
  9224           TO  DIS-LINE-REASON
  9225         MOVE  CR-FULL-CONTROL
  9226           TO  DIS-LINE-REC
  9227             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9228         MOVE  SPACES
  9229           TO  DISPLAY-LINE
  9230             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9231            if dte-pgm-opt = '1'
  9232               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9233               ADD +1 TO CMOT-CNT
  9234            end-if
  9235            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9236                                 thru 0299-READ-CERT-X
  9237               GO TO 0400-WRITE-CERT-RECORD.
  9238
  9239*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9240
  9241     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9242         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9243                                              0199-READ-ACCOUNT-X
  9244         GO TO 0400-WRITE-CERT-RECORD.
  9245
  9246     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9247        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9248         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9249                                              0199-READ-ACCOUNT-X
  9250         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 180
* ECS010.cbl
  9251
  9252*     DISPLAY ' BEFORE REIN '
  9253     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9254*     DISPLAY ' AFTER REIN '
  9255
  9256     IF CR-LFTYP = ZEROS  AND
  9257        CR-DTHEXP NOT = ZEROS
  9258         ADD +1                     TO W-LFTYP-99
  9259         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9260         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9261
  9262     IF CR-AHTYP = ZEROS  AND
  9263        CR-DISEXP NOT = ZEROS
  9264         ADD +1                     TO W-AHTYP-99
  9265         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9266         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9267
  9268*     DISPLAY ' BEFORE EP BUMP'
  9269     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9270*     DISPLAY ' AFTER EP BUMP'
  9271
  9272      if (dte-client = 'DCC')
  9273         and (ws-dcc-cnc-flag = 'Y')
  9274         write new-detail-extract
  9275      end-if
  9276
  9277     IF CR-LFTYP = '99'
  9278         MOVE '00'                  TO CR-LFTYP.
  9279     IF CR-AHTYP = '99'
  9280         MOVE '00'                  TO CR-AHTYP.
  9281
  9282*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9283*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9284
  9285     IF CR-NH-INT-ON-REF NOT NUMERIC
  9286         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9287     END-IF
  9288
  9289     IF  CR-POLICY-IS-ACTIVE
  9290         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9291         IF  CR-POLICY-IS-REISSUE
  9292             OR CR-POLICY-IS-MONTHLY
  9293             ADD +1              TO W-POLICY-REISSUE-CTR
  9294         ELSE
  9295             IF  CR-POLICY-IS-REIN-ONLY
  9296                 ADD +1          TO W-POLICY-REIN-CTR
  9297             ELSE
  9298                 NEXT SENTENCE
  9299     ELSE
  9300         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9301
  9302     IF DTE-PGM-OPT = '1'
  9303       IF REIN-IS-RISK-PREMIUM  AND
  9304          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9305         IF NOT CR-POLICY-IS-REISSUE  AND
  9306            NOT CR-POLICY-IS-DECLINED  AND
  9307            NOT CR-POLICY-IS-VOID
  9308            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 181
* ECS010.cbl
  9309             MOVE '*'            TO RISK-PREM-FLAG
  9310             PERFORM 3100-REINSURE-ISSUE THRU
  9311                     3199-REINSURE-ISSUE-X.
  9312
* 9313     COPY ELCCRTM2.
  9314******************************************************************04/16/98
  9315*                                                                *ELCCRTM2
  9316*                                                                *ELCCRTM2
  9317*                            ELCCRTM2                            *   LV004
  9318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9319*                            VMOD=2.001                          *ELCCRTM2
  9320*                                                                *ELCCRTM2
  9321*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9322*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9323*                                                                *ELCCRTM2
  9324******************************************************************ELCCRTM2
  9325     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9326     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9327     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9328     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9329     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9330     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9331                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9332     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9333     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9334     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9335     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9336                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9337     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9338     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9339     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9340     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9341     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9342                                                                     CL**4
  9343     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9344                UNTIL COPY-NDX > 5                                   CL**4
  9345           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9346                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9347     END-PERFORM.                                                 ELCCRTM2
  9348                                                                  ELCCRTM2
  9349
  9350     IF DTE-PGM-OPT = '1'
  9351         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9352         ADD +1 TO CMOT-CNT.
  9353
  9354     move zeros                  to ueclp-clp-fact
  9355     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9356                                    RISK-REIN-FLAG
  9357                                    RISK-PREM-FLAG
  9358                                    RC-COMM-FLG.
  9359
  9360 0499-WRITE-CERT-X.
  9361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 182
* ECS010.cbl
  9363******************************************************************
  9364***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9365******************************************************************
  9366
  9367 0500-APPLY-PENDING-BUSINESS.
  9368
  9369     IF CANCEL-TRANSACTION
  9370*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9371         GO TO 0600-PROCESS-CANCELLATIONS.
  9372
  9373     IF CLAIM-TRANSACTION
  9374*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9375         GO TO 0700-PROCESS-CLAIMS.
  9376
  9377     IF RESERVE-TRANSACTION
  9378*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9379         GO TO 0800-PROCESS-RESERVES.
  9380
  9381     IF UPDATE-TRANSACTION
  9382*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9383         GO TO 0900-PROCESS-CERT-CHANGES.
  9384
  9385******************************************************************
  9386***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9387******************************************************************
  9388
  9389 0505-PROCESS-ISSUES.
  9390
  9391     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9392     PERFORM CERT-DATE-LOAD.
  9393
  9394     ADD +1                      TO  W-POL-ISSUES.
  9395
  9396     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9397     MOVE PB-CARRIER             TO  CR-CARRIER.
  9398     MOVE PB-GROUPING            TO  CR-GROUPING.
  9399     MOVE PB-STATE               TO  CR-STATE.
  9400     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9401     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9402                                     WS-CR-BIN-DATE
  9403     MOVE ' '                    TO  DC-OPTION-CODE.
  9404     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9405     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9406                                     WS-CR-DT-N.
  9407     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9408
  9409*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9410     MOVE PB-I-NAME              TO  CR-NAME.
  9411     MOVE PB-I-AGE               TO  CR-AGE.
  9412     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9413     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9414
  9415     IF PB-I-JOINT-COVERAGE
  9416         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9417         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9418     ELSE
  9419        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9420           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 183
* ECS010.cbl
  9421             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9422
  9423     IF PB-I-SUMMARY  OR
  9424        DTE-CLIENT = 'DMD'
  9425         MOVE PB-I-LIVES         TO  CR-LIVES.
  9426
  9427     IF PB-I-NUM-BILLED NOT NUMERIC
  9428        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9429
  9430     IF PB-I-STATE-TAX NOT NUMERIC
  9431        MOVE ZEROS               TO PB-I-STATE-TAX.
  9432
  9433     IF PB-I-MUNI-TAX NOT NUMERIC
  9434        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9435     IF PB-I-TOT-FEES NOT NUMERIC
  9436        MOVE ZEROS               TO PB-I-TOT-FEES
  9437     END-IF
  9438     IF PB-I-ADDL-CLP NOT NUMERIC
  9439        MOVE ZEROS               TO PB-I-ADDL-CLP
  9440     END-IF
  9441
  9442     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9443     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9444     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9445     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9446     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9447     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9448     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9449     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9450     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9451     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9452     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9453     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9454     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9455
  9456     IF PB-I-RATE-CLASS-OVRD = SPACES
  9457         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9458     ELSE
  9459         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9460
  9461     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9462     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9463
  9464     IF PB-I-INDV-GRP-OVRD = SPACES
  9465         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9466     ELSE
  9467         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9468
  9469     IF CR-IND-GRP = 'I'  OR  '1'
  9470         MOVE '1'                TO  CR-IND-GRP
  9471     ELSE
  9472         MOVE '2'                TO  CR-IND-GRP.
  9473
  9474     IF PB-I-SKIP-CODE = '1'
  9475         MOVE 01                 TO  CR-SKIP.
  9476     IF PB-I-SKIP-CODE = '2'
  9477         MOVE 02                 TO  CR-SKIP.
  9478     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 184
* ECS010.cbl
  9479         MOVE 03                 TO  CR-SKIP.
  9480     IF PB-I-SKIP-CODE = '4'
  9481         MOVE 04                 TO  CR-SKIP.
  9482     IF PB-I-SKIP-CODE = '5'
  9483         MOVE 05                 TO  CR-SKIP.
  9484     IF PB-I-SKIP-CODE = '6'
  9485         MOVE 06                 TO  CR-SKIP.
  9486     IF PB-I-SKIP-CODE = '7'
  9487         MOVE 07                 TO  CR-SKIP.
  9488     IF PB-I-SKIP-CODE = '8'
  9489         MOVE 08                 TO  CR-SKIP.
  9490     IF PB-I-SKIP-CODE = '9'
  9491         MOVE 09                 TO  CR-SKIP.
  9492     IF PB-I-SKIP-CODE = 'A'
  9493         MOVE 10                 TO  CR-SKIP.
  9494     IF PB-I-SKIP-CODE = 'X'
  9495         MOVE 11                 TO  CR-SKIP.
  9496
  9497     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9498     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9499     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9500
  9501     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9502         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9503                                        REIN-SPEC-A
  9504                                        REIN-SPEC-B
  9505                                        REIN-SPEC-C
  9506         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9507     ELSE
  9508         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9509
  9510     IF DTE-CLIENT = 'DCC'
  9511        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9512        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9513           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9514        END-IF
  9515     END-IF
  9516
  9517     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9518     MOVE ' '                    TO  DC-OPTION-CODE.
  9519     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9520     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9521
  9522     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9523
  9524     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9525         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9526     ELSE
  9527         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9528
  9529     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9530         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9531
  9532     IF PB-BATCH-ENTRY = SPACE  OR
  9533        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9534         MOVE '1'                TO  CR-ENTRY-STATUS
  9535     ELSE
  9536         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 185
* ECS010.cbl
  9537
  9538     IF PB-POLICY-IS-DECLINED
  9539         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9540
  9541     IF PB-POLICY-IS-VOIDED
  9542         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9543
  9544***  IF DTE-CLIENT NOT = 'CRI'
  9545***      IF PB-I-PREM-ACCTNG-ONLY
  9546***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9547
  9548     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9549                                     WS-CR-ENTRY-DATE-N.
  9550
  9551*    IF PB-I-MICROFILM-NO NUMERIC
  9552*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9553
  9554     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9555        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9556        OR 'AHL'
  9557         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9558     END-IF
  9559
  9560*************************************************
  9561***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9562***  WAS CONVERTED TO 1056 BYTES.             ***
  9563*************************************************
  9564     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9565     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9566
  9567     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9568
  9569     MOVE CR-STATE               TO STATE-L.
  9570
  9571     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9572
  9573     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9574
  9575***************************************************
  9576***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9577***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9578***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9579***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9580***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9581***************************************************
  9582     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9583         IF CR-LF-POLICY-IS-RESTORE
  9584             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9585             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9586         ELSE
  9587         IF CR-LF-POLICY-IS-REISSUE
  9588             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9589             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9590         ELSE
  9591         IF CR-LF-IS-REIN-ONLY
  9592             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9593             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9594         ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 186
* ECS010.cbl
  9595         IF CR-LF-IS-DECLINED
  9596             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9597             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9598         ELSE
  9599         IF CR-LF-IS-VOID
  9600             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9601             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9602         ELSE
  9603         IF CR-LF-POLICY-IS-MONTHLY
  9604            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9605            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9606
  9607
  9608 0510-PROCESS-LIFE-ISSUE.
  9609
  9610     IF PB-INVALID-LIFE
  9611         GO TO 0520-PROCESS-A-H-ISSUE.
  9612
  9613     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9614     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9615     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9616
  9617     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9618     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9619     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9620     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9621     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9622     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9623
  9624     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9625     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9626     IF PB-I-LF-POLICY-FEE  NUMERIC
  9627         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9628     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9629     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9630
  9631     IF PB-I-LF-PREM-TAX NUMERIC
  9632        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9633     END-IF
  9634
  9635
  9636     IF PB-I-LF-REI-RATE NOT = ZEROS
  9637        IF DTE-CLIENT = 'DCC'
  9638           CONTINUE
  9639*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9640        ELSE
  9641           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9642           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9643                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9644        END-IF
  9645     END-IF
  9646
  9647     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9648         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9649         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9650         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9651         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9652         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 187
* ECS010.cbl
  9653             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9654                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9655
  9656     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9657     MOVE ' '                    TO  DC-OPTION-CODE.
  9658     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9659     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9660                                     WS-CR-LF-EXPIRE-DATE-N.
  9661
  9662     IF CR-ENTRY-STATUS = 'P'
  9663         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9664     ELSE
  9665         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9666
  9667     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9668     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9669     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9670     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9671     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9672
  9673     IF CR-LF-POLICY-IS-RESTORE
  9674         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9675     IF CR-LF-POLICY-IS-REISSUE
  9676         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9677     IF CR-LF-IS-REIN-ONLY
  9678         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9679
  9680     IF CR-LF-IS-DECLINED
  9681         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9682
  9683     IF CR-LF-IS-VOID
  9684         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9685     IF CR-LF-POLICY-IS-MONTHLY
  9686         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9687
  9688     ADD +1                      TO  W-LF-ISSUES.
  9689
  9690 0520-PROCESS-A-H-ISSUE.
  9691
  9692     IF PB-INVALID-AH
  9693         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9694
  9695     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9696     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9697     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9698
  9699     IF (NOT PB-I-JOINT-COVERAGE)
  9700        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9701        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9702        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9703     END-IF
  9704
  9705     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9706     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9707     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9708     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9709     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9710
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 188
* ECS010.cbl
  9711     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9712     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9713     IF PB-I-AH-POLICY-FEE  NUMERIC
  9714         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9715     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9716     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9717
  9718     IF PB-I-AH-PREM-TAX NUMERIC
  9719        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9720     END-IF
  9721
  9722     IF PB-I-AH-REI-RATE NOT = ZEROS
  9723        IF DTE-CLIENT = 'DCC'
  9724           CONTINUE
  9725        ELSE
  9726           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9727           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9728             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9729        END-IF
  9730     END-IF
  9731
  9732     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9733        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9734           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9735           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9736        END-IF
  9737        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9738     END-IF
  9739     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9740     MOVE ' '                    TO  DC-OPTION-CODE.
  9741     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9742     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9743                                     WS-CR-AH-EXPIRE-DATE-N.
  9744
  9745     IF CR-ENTRY-STATUS = 'P'
  9746         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9747     ELSE
  9748         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9749
  9750     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9751     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9752     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9753     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9754     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9755
  9756     IF CR-AH-POLICY-IS-RESTORE
  9757         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9758     IF CR-AH-POLICY-IS-REISSUE
  9759         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9760     IF CR-AH-IS-REIN-ONLY
  9761         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9762
  9763     IF CR-AH-IS-DECLINED
  9764         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9765
  9766     IF CR-AH-IS-VOID
  9767         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9768     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 189
* ECS010.cbl
  9769         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9770
  9771     ADD +1                      TO  W-AH-ISSUES.
  9772
  9773 0530-PROCESS-ISSUE-CONTINUED.
  9774
  9775     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9776     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9777     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9778     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9779
  9780     IF (DTE-CLIENT = 'DCC')
  9781        AND (CR-AHTYP NOT = '00' AND '  ')
  9782        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9783        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9784           PERFORM 0920-GET-BANK-FEES
  9785                                 THRU 0920-EXIT
  9786           PERFORM 0930-BUILD-CERT-TRLR
  9787                                 THRU 0930-EXIT
  9788           PERFORM 0395-GET-CERT-TRLRS
  9789                                 THRU 0395-EXIT
  9790     END-IF
  9791
  9792     IF DTE-CLIENT = 'DCC'
  9793        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9794           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9795        END-IF
  9796        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9797           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9798              (CR-LFPRM + CR-LFPRM-ALT) -
  9799              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9800        END-IF
  9801     END-IF
  9802
  9803     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9804        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9805        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9806     ELSE
  9807        IF DTE-CLIENT = 'DCC'
  9808           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9809              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9810              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9811           END-IF
  9812           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9813              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9814              (CR-AHPRM * CR-LCOM-AH (1))
  9815           END-IF
  9816        END-IF
  9817     END-IF
  9818
  9819     IF DTE-CLIENT = 'DCC'
  9820         IF PB-I-VIN > SPACES
  9821             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9822         END-IF
  9823     END-IF.
  9824
  9825     IF CR-ENTRY-STATUS = 'P'
  9826         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 190
* ECS010.cbl
  9827
  9828     IF CR-POLICY-IS-REISSUE  OR
  9829        CR-POLICY-IS-REIN-ONLY OR
  9830        CR-POLICY-IS-DECLINED OR
  9831        CR-POLICY-IS-VOID
  9832        OR CR-POLICY-IS-MONTHLY
  9833         GO TO 0590-END-ISSUE-PROCESSING.
  9834
  9835     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9836     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9837        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9838     END-IF
  9839     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9840
  9841     IF NOT PB-INVALID-LIFE
  9842         COMPUTE H-LFCM ROUNDED =
  9843                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9844         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9845         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9846
  9847     IF NOT PB-INVALID-AH
  9848        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9849           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9850              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9851              + CR-ADDL-CLP)
  9852           ELSE
  9853              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9854              - CR-ADDL-CLP
  9855           END-IF
  9856        ELSE
  9857           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9858        END-IF
  9859        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9860        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9861     END-IF
  9862
  9863     ADD +1 TO BC-G-ISS.
  9864     ADD +1 TO BC-COMM.
  9865     ADD CR-LFPRM TO BC-NET-WRIT.
  9866     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9867        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9868     END-IF
  9869     ADD CR-AHPRM TO BC-NET-WRIT.
  9870
  9871     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9872        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9873        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9874     ELSE
  9875        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9876        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9877           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9878        END-IF
  9879     END-IF
  9880
  9881     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9882         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9883     ELSE
  9884         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 191
* ECS010.cbl
  9885
  9886 0590-END-ISSUE-PROCESSING.
  9887
  9888     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9889
  9890     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9891
  9892     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9893        NOT CR-POLICY-IS-DECLINED  AND
  9894        NOT CR-POLICY-IS-VOID
  9895         MOVE 'Y' TO BILLED-SWITCH
  9896         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9897         IF DTE-CLIENT = 'DCC'
  9898            move detail-extract  to new-detail-extract
  9899            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9900               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9901                  cr-addl-clp
  9902            end-if
  9903            write new-detail-extract
  9904         end-if
  9905
  9906     IF NOT CR-POLICY-IS-REISSUE  AND
  9907        NOT CR-POLICY-IS-DECLINED  AND
  9908        NOT CR-POLICY-IS-VOID
  9909        AND NOT CR-POLICY-IS-MONTHLY
  9910         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9911
  9912     MOVE '*'                   TO TRANSACTION-FLAG.
  9913     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 192
* ECS010.cbl
  9915******************************************************************
  9916***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9917******************************************************************
  9918
  9919 0600-PROCESS-CANCELLATIONS.
  9920
  9921*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9922     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9923
  9924     IF AM-RECALC-COMM = ('Y' OR '1')
  9925        PERFORM 1600-RECALC-COMM-EXTR
  9926                                 THRU 1899-RECALC-COMM-EXTR-X
  9927        MOVE ' '                 TO RECALC-TYPE
  9928     END-IF
  9929
  9930     MOVE CR-LFRFND               TO LIFE-REFUND.
  9931     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9932     MOVE CR-AHRFND               TO A-H-REFUND.
  9933     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9934     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9935
  9936     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9937     IF CR-LFRFND NOT = ZEROS
  9938        IF CR-LFRFND-CALC = ZEROS
  9939           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9940                                    LIFE-REFUND-CALC
  9941        ELSE
  9942           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9943        END-IF
  9944     END-IF
  9945
  9946     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9947
  9948     IF CR-AHRFND-CALC = ZEROS
  9949        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9950                                    A-H-REFUND-CALC
  9951     ELSE
  9952        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9953     END-IF
  9954
  9955     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9956        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9957     ELSE
  9958        MOVE SPACES              TO CR-POST-CARD-IND
  9959     END-IF
  9960
  9961*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9962*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9963*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9964*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9965
  9966     IF PB-C-NH-INT-ON-REFS NUMERIC
  9967        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9968        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9969     END-IF
  9970     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9971
  9972     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 193
* ECS010.cbl
  9973        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9974
  9975     IF PB-CI-MUNI-TAX NOT NUMERIC
  9976        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9977
  9978     IF CR-CANCEL-STATE-TAX NUMERIC
  9979         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9980       ELSE
  9981         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9982
  9983     IF CR-CANCEL-MUNI-TAX NUMERIC
  9984         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9985       ELSE
  9986         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9987
  9988     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9989                                    MONTHS-DIFF-AH.
  9990
  9991     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9992
  9993 0630-PROCESS-LIFE-CANCEL.
  9994
  9995     IF CR-LFTYP = ZERO  OR
  9996        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9997         MOVE ZEROS               TO H-LFCM
  9998         GO TO 0650-PROCESS-A-H-CANCEL.
  9999
 10000     IF CR-LFRFND = +0
 10001        AND CR-DTHAMT > ZEROS
 10002        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
 10003        MOVE ZEROS               TO H-LFCM
 10004        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
 10005        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
 10006        GO TO 0650-PROCESS-A-H-CANCEL
 10007     END-IF
 10008
 10009     IF DTE-CLIENT = 'DCC'
 10010        IF PB-C-LF-RFND-CLP NUMERIC
 10011           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
 10012        END-IF
 10013     END-IF
 10014
 10015     IF PB-C-LF-PREM-TAX NUMERIC
 10016        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
 10017     END-IF
 10018     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
 10019     MOVE ' '                     TO  DC-OPTION-CODE.
 10020     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10021     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
 10022                                      WS-CR-LF-CANC-DT-N.
 10023
 10024
 10025     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10026     MOVE ' '                    TO DC-OPTION-CODE
 10027     PERFORM 8000-DATE-CONVERT-ROUTINE
 10028                                 THRU 8099-DATE-CONVERT-X
 10029     IF CR-LF-CNC-ENT-DT NOT NUMERIC
 10030        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 194
* ECS010.cbl
 10031     END-IF
 10032     IF NO-CONVERSION-ERROR
 10033        IF CR-LF-CNC-ENT-DT = ZEROS
 10034           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10035        END-IF
 10036     END-IF
 10037
 10038     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10039     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10040     MOVE '1'                     TO  DC-OPTION-CODE.
 10041     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10042     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10043                                      DC-ODD-DAYS-OVER
 10044                                      DC-ELAPSED-DAYS.
 10045     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10046     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10047
 10048     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10049         ADD  +1                  TO  MONTHS-DIFF-LF.
 10050
 10051     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10052
 10053     MOVE  ZEROS                  TO  SUB.
 10054
 10055 0635-LIFE-CHARGEBACK-LOOP.
 10056
 10057     ADD    +1                    TO  SUB.
 10058
 10059     IF  SUB  GREATER THAN  +10
 10060         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10061
 10062*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10063*** WE FULLY EARN THE FEE
 10064     IF CR-CANCEL-REASON = 'R'
 10065        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10066           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10067           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10068           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10069        END-IF
 10070     END-IF
 10071
 10072     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10073         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10074         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10075
 10076     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10077         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10078
 10079     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10080         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10081
 10082     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10083
 10084
 10085 0640-CONTINUE-LIFE-CANCEL.
 10086
 10087     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10088        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 195
* ECS010.cbl
 10089
 10090     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10091
 10092     IF DTE-CLIENT = 'GIC'
 10093         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10094             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10095                                     LIFE-REFUND-CALC.
 10096
 10097*    IF DTE-CLIENT = 'TMS'
 10098     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10099
 10100     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10101         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10102     ELSE
 10103         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10104             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10105             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10106             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10107             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10108                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10109         ELSE
 10110             IF CR-LF-CURRENT-STATUS = '6'
 10111                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10112                 MOVE PB-C-LF-COMM-CHARGEBACK
 10113                                       TO CR-LF-COMM-CHARGEBACK
 10114                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10115                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10116
 10117*************************************************
 10118***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10119***  WAS CONVERTED TO 1056 BYTES.             ***
 10120*************************************************
 10121     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10122
 10123     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10124     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10125     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10126
 10127     COMPUTE H-LFCM ROUNDED =
 10128                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10129     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10130
 10131     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10132     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10133     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10134     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10135
 10136     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10137     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10138
 10139 0650-PROCESS-A-H-CANCEL.
 10140
 10141     IF CR-AHTYP = ZERO  OR
 10142        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10143         MOVE ZEROS               TO H-AHCM
 10144         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10145
 10146*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 196
* ECS010.cbl
 10147*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10148*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10149*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10150
 10151     IF DTE-CLIENT = 'DCC'
 10152        IF PB-C-AH-RFND-CLP NUMERIC
 10153           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10154        END-IF
 10155     END-IF
 10156
 10157     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10158     MOVE ' '                     TO  DC-OPTION-CODE.
 10159     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10160     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10161                                      WS-CR-AH-CANC-DT-N.
 10162
 10163     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10164     MOVE ' '                    TO DC-OPTION-CODE
 10165     PERFORM 8000-DATE-CONVERT-ROUTINE
 10166                                 THRU 8099-DATE-CONVERT-X
 10167     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10168        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10169     END-IF
 10170     IF NO-CONVERSION-ERROR
 10171        IF CR-AH-CNC-ENT-DT = ZEROS
 10172           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10173        END-IF
 10174     END-IF
 10175
 10176     IF PB-C-AH-PREM-TAX NUMERIC
 10177        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10178     END-IF
 10179     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10180     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10181     MOVE '1'                     TO  DC-OPTION-CODE.
 10182     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10183     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10184                                      DC-ODD-DAYS-OVER
 10185                                      DC-ELAPSED-DAYS.
 10186     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10187     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10188
 10189     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10190          ADD  +1                 TO  MONTHS-DIFF-AH.
 10191
 10192     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10193                                      WS-DCC-DDF-CB-LEVELS
 10194     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10195        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10196     END-IF
 10197*    IF DTE-CLIENT = 'DCC'
 10198*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10199*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10200*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10201*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10202*             OR (SUB > +10)
 10203*          END-PERFORM
 10204*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 197
* ECS010.cbl
 10205*             MOVE CR-BANK-NOCHRGB-MONTHS
 10206*                                TO AM-COMM-CHARGEBACK (SUB)
 10207*          END-IF
 10208*       END-IF
 10209*    END-IF
 10210
 10211
 10212     MOVE 'Y'                     TO WS-FIRST-K
 10213     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10214     MOVE  ZEROS                  TO  SUB.
 10215
 10216 0653-A-H-CHARGEBACK-LOOP.
 10217
 10218     ADD    +1                    TO  SUB.
 10219
 10220     IF  SUB  GREATER THAN  +10
 10221         GO TO  0655-CONTINUE-A-H-CANCEL.
 10222
 10223     IF CR-CANCEL-REASON = 'R'
 10224        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10225           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10226              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10227              GO TO  0653-A-H-CHARGEBACK-LOOP
 10228           END-IF
 10229           IF AM-COM-TYP (SUB) = 'J'
 10230              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10231              GO TO  0653-A-H-CHARGEBACK-LOOP
 10232           END-IF
 10233        END-IF
 10234     END-IF
 10235
 10236     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10237         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10238         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10239
 10240     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10241         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10242
 10243     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10244         OR ((DTE-CLIENT = 'DCC')
 10245             AND (CR-AHRFND = ZEROS))
 10246         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10247
 10248     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10249
 10250
 10251 0655-CONTINUE-A-H-CANCEL.
 10252
 10253     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10254        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10255
 10256     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10257
 10258     IF DTE-CLIENT = 'GIC'
 10259         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10260             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10261                                     A-H-REFUND-CALC.
 10262
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 198
* ECS010.cbl
 10263*    IF DTE-CLIENT = 'TMS'
 10264     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10265*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10266
 10267
 10268     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10269         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10270     ELSE
 10271         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10272             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10273             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10274             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10275             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10276                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10277         ELSE
 10278             IF CR-AH-CURRENT-STATUS = '7'
 10279                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10280                 MOVE PB-C-AH-COMM-CHARGEBACK
 10281                                       TO CR-AH-COMM-CHARGEBACK
 10282                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10283                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10284
 10285*************************************************
 10286***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10287***  WAS CONVERTED TO 1056 BYTES.             ***
 10288*************************************************
 10289     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10290
 10291     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10292     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10293     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10294
 10295     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10296        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10297        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10298           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10299           MOVE CNC-FACT TO UECLP-CLP-FACT
 10300        END-IF
 10301        IF CR-CANCEL-REASON = 'R'
 10302           MOVE +1               TO CNC-FACT
 10303        END-IF
 10304        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10305           (CR-AHPRM - (CR-LFPRM-ALT
 10306           + CR-ADDL-CLP)) * -1
 10307     ELSE
 10308        COMPUTE H-AHCM ROUNDED =
 10309          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10310     END-IF
 10311
 10312     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10313
 10314     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10315     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10316     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10317     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10318
 10319     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10320     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 199
* ECS010.cbl
 10321
 10322 0660-PROCESS-CANCEL-CONTINUE.
 10323
 10324     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10325
 10326     IF CR-POLICY-IS-REIN-ONLY
 10327        GO TO 0660-CONT.
 10328
 10329     MOVE 'Y'                    TO BILLED-SWITCH.
 10330     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10331
 10332     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10333     if dte-client = 'DCC'
 10334        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10335     end-if
 10336
 10337     IF CR-POLICY-IS-MONTHLY
 10338        GO TO 0660-CONT
 10339     END-IF
 10340
 10341     ADD +1                      TO BC-G-CNC.
 10342     ADD +1                      TO BC-COMM.
 10343     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10344     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10345     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10346     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10347     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10348     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10349
 10350     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10351         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10352     ELSE
 10353         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10354
 10355     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10356         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10357     ELSE
 10358         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10359
 10360
 10361 0660-CONT.
 10362
 10363     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10364     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10365
 10366     IF CR-LFRFND NEGATIVE
 10367       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10368           MOVE '*'                 TO REIN-VOID-LF-SW.
 10369     IF CR-AHRFND NEGATIVE
 10370       IF CR-AHRFND + A-H-REFUND = ZEROS
 10371           MOVE '*'                 TO REIN-VOID-AH-SW.
 10372
 10373     IF CR-LFRFND NOT = ZEROS
 10374       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10375           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10376     IF CR-AHRFND NOT = ZEROS
 10377       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10378           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 200
* ECS010.cbl
 10379
 10380     IF CR-DT = CR-LF-CANC-DT
 10381       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10382     IF CR-DT = CR-AH-CANC-DT
 10383       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10384
 10385     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10386
 10387     MOVE SPACES                    TO REIN-VOID-LF-SW
 10388                                       REIN-VOID-AH-SW
 10389                                       REIN-ADDL-LF-SW
 10390                                       REIN-ADDL-AH-SW.
 10391
 10392     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10393     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10394
 10395     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10396     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10397
 10398     IF (CR-LFTYP NOT = ZERO  AND
 10399        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10400        (CR-AHTYP NOT = ZERO  AND
 10401        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10402         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10403         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10404
 10405 0670-LIFE-CANCEL-VOID.
 10406
 10407     IF CR-LFTYP NOT = ZERO  AND
 10408        CR-LFRFND = ZERO  AND
 10409        PB-C-LF-CANCEL-AMT NEGATIVE
 10410         NEXT SENTENCE
 10411     ELSE
 10412         GO TO 0680-A-H-CANCEL-VOID.
 10413
 10414     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10415                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10416                                          CR-LF-CANC-DT
 10417                                          WS-CR-LF-CANC-DT-N
 10418                                          CR-LFRFND-CALC.
 10419
 10420     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10421
 10422     IF CR-LF-CANCEL-APPLIED
 10423         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10424         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10425     ELSE
 10426         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10427         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10428
 10429     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10430
 10431     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10432     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10433
 10434     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10435
 10436 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 201
* ECS010.cbl
 10437
 10438     IF CR-AHTYP NOT = ZERO  AND
 10439        CR-AHRFND = ZERO  AND
 10440        PB-C-AH-CANCEL-AMT NEGATIVE
 10441         NEXT SENTENCE
 10442     ELSE
 10443         GO TO 0690-END-CANCEL-PROCESSING.
 10444
 10445     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10446                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10447                                        CR-AH-CANC-DT
 10448                                        WS-CR-AH-CANC-DT-N
 10449                                        CR-AHRFND-CALC.
 10450
 10451     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10452
 10453     IF CR-AH-CANCEL-APPLIED
 10454         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10455         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10456     ELSE
 10457         MOVE CR-AH-STATUS-AT-CANCEL
 10458                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10459         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10460
 10461     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10462
 10463     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10464     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10465
 10466     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10467
 10468 0690-END-CANCEL-PROCESSING.
 10469
 10470     IF CR-LF-CANC-DT = ZEROS  AND
 10471        CR-AH-CANC-DT = ZEROS
 10472         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10473     END-IF
 10474
 10475     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10476         NEXT SENTENCE
 10477     ELSE
 10478         MOVE 'X'               TO REIN-RT-SW
 10479         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10480         MOVE ' '               TO REIN-RT-SW.
 10481
 10482     MOVE '*'                   TO TRANSACTION-FLAG.
 10483     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10484
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 202
* ECS010.cbl
 10486******************************************************************
 10487***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10488******************************************************************
 10489
 10490 0700-PROCESS-CLAIMS.
 10491
 10492     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10493        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10494         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10495             PENDING-MATCH-CONTROL
 10496         MOVE 0301 TO WS-ABEND-CODE
 10497         DISPLAY '******************************'
 10498         DISPLAY '***** ERROR LOCATION 011 *****'
 10499         DISPLAY '******************************'
 10500         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10501         GO TO ABEND-PGM.
 10502
 10503     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10504
 10505     ADD +1                       TO  W-LF-CLAIMS.
 10506
 10507     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10508     MOVE ' '                     TO  DC-OPTION-CODE.
 10509     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10510     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10511
 10512     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10513     MOVE ' '                     TO  DC-OPTION-CODE.
 10514     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10515     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10516
 10517     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10518     MOVE ' '                     TO  DC-OPTION-CODE.
 10519     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10520     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10521
 10522     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10523     MOVE ' '                     TO  DC-OPTION-CODE.
 10524     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10525     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10526
 10527     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10528
 10529**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10530****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10531****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10532****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10533****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10534****     ELSE
 10535****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10536
 10537     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10538         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10539
 10540******************************************************************
 10541***           P R O C E S S   D E A T H   C L A I M            ***
 10542******************************************************************
 10543
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 203
* ECS010.cbl
 10544     IF REIN-IS-RISK-PREMIUM
 10545       IF CR-DTH-DT = ZEROS
 10546           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10547           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10548           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10549
 10550     MOVE INCURRED-DATE            TO CR-DTH-DT
 10551                                      WS-CR-DTH-DT-N.
 10552
 10553     IF PC-CHARGEBLE-EXPENSE  OR
 10554        PC-NON-CHARGEBLE-EXPENSE
 10555         IF CR-LFTYP = '00'
 10556             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10557             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10558                     8399-LIFE-LOOKUP-X.
 10559
 10560     IF PC-CHARGEBLE-EXPENSE  OR
 10561        PC-NON-CHARGEBLE-EXPENSE
 10562         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10563         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10564         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10565         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10566         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10567         GO TO 0780-END-CLAIMS-PROCESSING.
 10568
 10569     ADD +1                       TO  CR-NUM-DTH-CLM.
 10570     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10571     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10572                                      WS-CR-DTH-PAY-DT-N.
 10573
 10574     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10575     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10576     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10577     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10578     IF CR-DTH-PAY-CD NOT = 'F'
 10579         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10580     INSPECT CR-DTH-PAY-CD
 10581         CONVERTING '12349' TO 'PFSXV'.
 10582     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10583
 10584     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10585         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10586       AND
 10587       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10588       OR
 10589        DTE-CLIENT = 'ACC' OR 'FDL')
 10590        NEXT SENTENCE
 10591     ELSE
 10592     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10593         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10594             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10595             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10596             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10597                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10598
 10599     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10600     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10601     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 204
* ECS010.cbl
 10602     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10603         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10604     ELSE
 10605         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10606     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10607
 10608     IF NOT CR-POLICY-IS-REIN-ONLY
 10609         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10610
 10611 0720-CANCEL-AH-COVERAGE.
 10612
 10613     IF CR-AHTYP = ZEROS  OR
 10614        NOT CR-AH-POLICY-IS-ACTIVE
 10615         GO TO 0740-DEATH-CLAIM-VOID.
 10616
 10617     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10618     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10619     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10620                                           WS-CR-AH-CANC-DT-N.
 10621     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10622                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10623
 10624     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10625     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10626     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10627     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10628     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10629     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10630     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10631     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10632
 10633 0740-DEATH-CLAIM-VOID.
 10634
 10635     IF CR-DTHAMT = ZERO  AND
 10636        PC-CLAIM-PAYMENT NEGATIVE
 10637         NEXT SENTENCE
 10638     ELSE
 10639         GO TO 0780-END-CLAIMS-PROCESSING.
 10640
 10641     MOVE '*'                           TO DEATH-VOID-FLAG.
 10642
 10643     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10644                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10645                                           CR-NUM-DTH-CLM
 10646                                           CR-DTH-RPT-DT
 10647                                           CR-DTH-PAY-DT
 10648                                           WS-CR-DTH-PAY-DT-N
 10649*                                          CR-DTHAMT-YTD
 10650*                                          CR-DTHAMT-LAST
 10651                                           CR-DTH-AGE.
 10652     MOVE ' '                           TO CR-DTH-PAY-CD.
 10653
 10654     IF CR-LF-DEATH-CLAIM-APPLIED
 10655         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10656         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10657     ELSE
 10658         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10659         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 205
* ECS010.cbl
 10660
 10661     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10662     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10663
 10664     IF CR-AH-DEATH-CLAIM-APPLIED
 10665         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10666         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10667         MOVE ZEROS                     TO CR-AH-CANC-DT
 10668                                           WS-CR-AH-CANC-DT-N
 10669                                           CR-AH-CANCEL-EXIT-DATE
 10670                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10671         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10672         MOVE CR-AH-TERM                TO TRD-AHTRM
 10673         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10674         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10675
 10676     GO TO 0780-END-CLAIMS-PROCESSING.
 10677
 10678******************************************************************
 10679***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10680******************************************************************
 10681
 10682 0750-PROCESS-DISABILITY-CLAIM.
 10683
 10684     ADD +1                       TO W-AH-CLAIMS.
 10685
 10686     MOVE INCURRED-DATE           TO CR-DIS-DT
 10687                                     WS-CR-DIS-DT-N.
 10688
 10689     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10690
 10691     IF REIN-AH-CLM-MONTHS = +1
 10692         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10693     ELSE
 10694       IF REIN-AH-CLM-MONTHS = +2
 10695           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10696       ELSE
 10697         IF REIN-AH-CLM-MONTHS = +3
 10698             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10699         ELSE
 10700           IF REIN-AH-CLM-MONTHS = +4
 10701               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10702           ELSE
 10703               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10704
 10705     IF PC-CHARGEBLE-EXPENSE  OR
 10706        PC-NON-CHARGEBLE-EXPENSE
 10707         IF CR-AHTYP = '00'
 10708             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10709             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10710                     8499-A-H-LOOKUP-X.
 10711
 10712     IF PC-CHARGEBLE-EXPENSE  OR
 10713        PC-NON-CHARGEBLE-EXPENSE
 10714         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10715         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10716         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10717         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 206
* ECS010.cbl
 10718         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10719         GO TO 0780-END-CLAIMS-PROCESSING.
 10720
 10721     ADD +1                       TO CR-NUM-DIS-CLM.
 10722
 10723     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10724     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10725                                      WS-CR-DIS-PAY-DT-N.
 10726     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10727                                      WS-CR-DIS-PTO-DT-N.
 10728
 10729     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10730     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10731     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10732
 10733     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10734     IF CR-DIS-PAY-CD NOT = 'S'
 10735         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10736     INSPECT CR-DIS-PAY-CD
 10737         CONVERTING '12349' TO 'PFSXV'.
 10738     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10739
 10740     IF PC-LUMP-SUM-PAYMENT
 10741         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10742           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10743           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10744           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10745                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10746
 10747     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10748     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10749     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10750     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10751     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10752
 10753     IF NOT CR-POLICY-IS-REIN-ONLY
 10754         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10755
 10756     IF NOT PC-LUMP-SUM-PAYMENT
 10757         GO TO 0780-END-CLAIMS-PROCESSING.
 10758
 10759 0770-CANCEL-LF-COVERAGE.
 10760
 10761     IF CR-LFTYP = ZEROS  OR
 10762        NOT CR-LF-POLICY-IS-ACTIVE
 10763         GO TO 0780-END-CLAIMS-PROCESSING.
 10764
 10765     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10766     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10767     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10768                                           WS-CR-LF-CANC-DT-N.
 10769     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10770                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10771
 10772     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10773     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10774     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10775     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 207
* ECS010.cbl
 10776     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10777     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10778     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10779     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10780
 10781 0780-END-CLAIMS-PROCESSING.
 10782
 10783     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10784         MOVE DTO-MO               TO TRD-LFACTMO
 10785         MOVE DTO-DA               TO TRD-LFACTDA
 10786         MOVE DTO-YR               TO TRD-LFACTYR
 10787         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10788     ELSE
 10789         MOVE PAY-MO               TO TRD-AHACTMO
 10790         MOVE PAY-DA               TO TRD-AHACTDA
 10791         MOVE PAY-YR               TO TRD-AHACTYR
 10792         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10793
 10794     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10795
 10796     IF NOT CR-POLICY-IS-REIN-ONLY
 10797         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10798         ADD +1                    TO BC-G-CLM.
 10799
 10800     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10801
 10802     IF DEATH-CLAIM-VOIDED
 10803         MOVE ZEROS                TO CR-DTH-DT
 10804                                      WS-CR-DTH-DT-N.
 10805     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10806
 10807     MOVE '*'                      TO TRANSACTION-FLAG.
 10808     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10809
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 208
* ECS010.cbl
 10811 0790-TABLE-DISAB-PERIODS.
 10812
 10813     MOVE +1                       TO SUB14.
 10814     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10815
 10816     MOVE +1                       TO SUB14.
 10817
 10818**************************************************************
 10819**                                                          **
 10820**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10821**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10822**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10823**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10824**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10825**                                                          **
 10826**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10827**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10828**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10829**                                                          **
 10830**************************************************************
 10831
 10832 0791-TABLE-AH-AMOUNT.
 10833
 10834     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10835         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10836
 10837     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10838         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10839                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10840         IF REIN-IS-RISK-PREMIUM
 10841             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10842             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10843             IF SUB14 = +1
 10844               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10845             ELSE
 10846             IF SUB14 = +2
 10847               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10848             ELSE
 10849             IF SUB14 = +3
 10850               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10851             ELSE
 10852             IF SUB14 = +4
 10853               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10854             ELSE
 10855               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10856
 10857
 10858     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10859         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10860         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10861                                        +  CR-INCUR-DISEXP (SUB14)
 10862         IF PC-CHARGEBLE-EXPENSE  OR
 10863            PC-NON-CHARGEBLE-EXPENSE
 10864             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10865             GO TO 0791-TABLE-AH-EXIT
 10866         ELSE
 10867             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10868             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 209
* ECS010.cbl
 10869
 10870     ADD +1                       TO SUB14.
 10871
 10872     GO TO 0791-TABLE-AH-AMOUNT.
 10873
 10874 0791-TABLE-AH-EXIT.
 10875     EXIT.
 10876
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 210
* ECS010.cbl
 10878**************************************************************
 10879**                                                          **
 10880** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10881** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10882**                                                          **
 10883** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10884** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10885** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10886** OCCURRENCE.                                              **
 10887**************************************************************
 10888 0792-MOVE-TABLE.
 10889
 10890     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10891                                  WS-CR-DIS-INCUR-DT-N (1).
 10892     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10893     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10894
 10895     MOVE +2                   TO SUB14.
 10896     MOVE +3                   TO SUB15.
 10897     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10898
 10899     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10900
 10901     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10902                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10903
 10904 0792-MOVE-TABLE-EXIT.
 10905     EXIT.
 10906
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 211
* ECS010.cbl
 10908**************************************************************
 10909**                                                          **
 10910**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10911** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10912** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10913** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10914** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10915**************************************************************
 10916
 10917 0794-REVIEW-TABLE.
 10918
 10919     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10920         GO TO 0794-REVIEW-TABLE-EXIT.
 10921
 10922     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10923         GO TO 0794-REVIEW-TABLE-EXIT.
 10924
 10925     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10926        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10927         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10928         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10929                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10930         MOVE SUB14            TO SUB15
 10931         ADD +1                TO SUB15
 10932         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10933         MOVE +1               TO SUB14
 10934         GO TO 0794-REVIEW-TABLE.
 10935
 10936     ADD +1                    TO SUB14.
 10937
 10938     GO TO 0794-REVIEW-TABLE.
 10939
 10940 0794-REVIEW-TABLE-EXIT.
 10941     EXIT.
 10942
 10943 0794A-BUMP-TBL.
 10944
 10945     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10946         GO TO 0794A-BUMP-TBL-EXIT.
 10947
 10948     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10949                             CR-DISAB-DETAIL-DATA (SUB14).
 10950     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10951                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10952
 10953     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10954                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10955                                  CR-INCUR-DISAMT (SUB15)
 10956                                  CR-INCUR-DISEXP (SUB15).
 10957
 10958     ADD +1                    TO SUB14
 10959                                  SUB15.
 10960     GO TO 0794A-BUMP-TBL.
 10961
 10962 0794A-BUMP-TBL-EXIT.
 10963     EXIT.
 10964
 10965 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 212
* ECS010.cbl
 10966
 10967     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10968     MOVE 'L'                        TO DC-OPTION-CODE.
 10969     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10970     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10971     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10972     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10973     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10974     MOVE CR-APR                     TO CP-LOAN-APR.
 10975     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10976     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10977     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10978     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10979
 10980     MOVE '3'                        TO CP-PROCESS-TYPE.
 10981     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10982     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10983
 10984     IF CR-LFTYP = ZERO
 10985         GO TO 0795-EXIT
 10986     END-IF
 10987
 10988     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10989         GO TO 0795-EXIT
 10990     END-IF
 10991     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10992     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10993     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10994     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10995                                        CP-RATING-BENEFIT-AMT.
 10996     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10997     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10998     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10999     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 11000     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 11001     MOVE CR-STATE                   TO CP-STATE.
 11002     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 11003
 11004     IF CP-STATE-STD-ABBRV = 'OR'
 11005         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 11006
 11007     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 11008
 11009     IF CP-ERROR-RATE-NOT-FOUND  OR
 11010        CP-ERROR-RATE-IS-ZERO
 11011         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 11012                                     TO WS-ABEND-MESSAGE
 11013         MOVE 0302                   TO WS-ABEND-CODE
 11014         DISPLAY '******************************'
 11015         DISPLAY '***** ERROR LOCATION 018 *****'
 11016         DISPLAY '******************************'
 11017         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11018         GO TO ABEND-PGM.
 11019
 11020     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 11021
 11022*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 11023*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 213
* ECS010.cbl
 11024
 11025     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 11026                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 11027
 11028     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11029
 11030 0795-exit.
 11031     exit.
 11032
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 214
* ECS010.cbl
 11034******************************************************************
 11035***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11036******************************************************************
 11037
 11038 0800-PROCESS-RESERVES.
 11039
 11040     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11041       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11042           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11043
 11044     if (dte-client = 'AHL')
 11045        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11046        and (cr-ahtyp (1:1) = 'M')
 11047        and ((pc-future-reserve-amt > zeros)
 11048            or (pc-ptc-reserve-amt > zeros))
 11049        compute pc-ibnr-reserve-amt =
 11050           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11051        display ' using 205 of ptc and future ' cr-cert-no
 11052     end-if
 11053
 11054     if (dte-client = 'AHL')
 11055        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11056        and (cr-lftyp (1:1) = 'M')
 11057        and (pc-ptc-reserve-amt > zeros)
 11058        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11059        display ' using 217 of ptc ' cr-cert-no
 11060     end-if
 11061
 11062     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11063
 11064     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11065     MOVE ' '                     TO  DC-OPTION-CODE.
 11066     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11067     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11068
 11069     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11070     MOVE ' '                     TO  DC-OPTION-CODE.
 11071     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11072     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11073
 11074     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11075     MOVE ' '                     TO  DC-OPTION-CODE.
 11076     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11077     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11078
 11079     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11080
 11081     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11082         ADD +1                     TO W-LF-RESERVES
 11083         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11084         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11085         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11086         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11087         MOVE INCURRED-DATE         TO CR-DTH-DT
 11088                                       WS-CR-DTH-DT-N
 11089         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11090
 11091     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 215
* ECS010.cbl
 11092         ADD +1                     TO W-AH-RESERVES
 11093         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11094         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11095         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11096         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11097         MOVE INCURRED-DATE         TO CR-DIS-DT
 11098                                       WS-CR-DIS-DT-N
 11099         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11100
 11101     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11102     MOVE 'IBNR'                    TO TRD-IBNRX.
 11103     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11104     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11105     COMPUTE TRD-FUTRSV EQUAL
 11106            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11107     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11108     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11109
 11110 0820-END-RESERVE-PROCESSING.
 11111
 11112     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11113
 11114     IF NOT CR-POLICY-IS-REIN-ONLY
 11115         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11116                                            2499-BLD-RESERVE-X
 11117         ADD +1 TO BC-G-CRS.
 11118
 11119     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11120
 11121     MOVE '*'                    TO TRANSACTION-FLAG.
 11122     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11123
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 216
* ECS010.cbl
 11125******************************************************************
 11126***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11127******************************************************************
 11128
 11129 0900-PROCESS-CERT-CHANGES.
 11130
 11131     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11132
 11133     IF CC-AGE NOT NUMERIC  OR
 11134        CC-AGE = CR-AGE
 11135         MOVE ZEROS TO CC-AGE.
 11136
 11137     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11138        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11139         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11140
 11141     IF CC-INSURED-SEX NOT = 'M'  AND
 11142        CC-INSURED-SEX NOT = 'F'
 11143         MOVE SPACES TO CC-INSURED-SEX.
 11144
 11145     IF CC-LOAN-APR NOT NUMERIC  OR
 11146        CC-LOAN-APR = CR-APR
 11147         MOVE ZEROS TO CC-LOAN-APR.
 11148
 11149     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11150        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11151         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11152
 11153     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11154        CC-IND-GRP-TYPE NOT = '2'
 11155         MOVE SPACES TO CC-IND-GRP-TYPE.
 11156
 11157     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11158****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11159         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11160
 11161     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11162        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11163         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11164
 11165     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11166        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11167        CR-LFTYP = ZEROS
 11168         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11169
 11170     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11171        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11172        CR-AHTYP = ZEROS
 11173         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11174
 11175     IF CR-BILLED NOT NUMERIC
 11176         MOVE ZEROS TO CR-BILLED.
 11177
 11178     IF CR-LIVES NOT NUMERIC
 11179         MOVE ZEROS TO CR-LIVES.
 11180
 11181     IF CC-LIVES NOT NUMERIC  OR
 11182        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 217
* ECS010.cbl
 11183         MOVE ZEROS TO CC-LIVES.
 11184
 11185     IF CC-BILLED NOT NUMERIC  OR
 11186        CC-BILLED = CR-BILLED
 11187         MOVE ZEROS TO CC-BILLED.
 11188
 11189     IF CC-INSURED-LAST-NAME NOT = SPACES
 11190         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11191     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11192         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11193     IF CC-INSURED-INITIAL2 NOT = SPACES
 11194         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11195     IF CC-JT-LAST-NAME NOT = SPACES
 11196         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11197     IF CC-JT-FIRST-NAME NOT = SPACES
 11198         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11199     IF CC-JT-INITIAL NOT = SPACES
 11200         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11201
 11202     IF CC-AGE NOT = ZEROS
 11203         MOVE CC-AGE                 TO CR-AGE
 11204                                        DET-AGE
 11205     ELSE
 11206         MOVE ZEROS                  TO DET-AGE.
 11207
 11208     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11209         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11210                                        DET-JT-AGE
 11211     ELSE
 11212         MOVE ZEROS                  TO DET-JT-AGE.
 11213
 11214     IF CC-INSURED-SEX NOT = SPACES
 11215         MOVE CC-INSURED-SEX         TO CR-SEX
 11216                                        DET-SEX
 11217     ELSE
 11218         MOVE SPACE                  TO DET-SEX.
 11219
 11220     IF CC-MEMBER-NO NOT = SPACES
 11221         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11222                                        DET-PR-MEM
 11223     ELSE
 11224         MOVE SPACES                 TO DET-PR-MEM.
 11225
 11226     IF CC-SOC-SEC-NO NOT = SPACES
 11227         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11228                                        DET-PR-SS
 11229     ELSE
 11230         MOVE SPACES                 TO DET-PR-SS.
 11231
 11232     IF CC-LOAN-APR NOT = ZEROS
 11233         MOVE CC-LOAN-APR            TO CR-APR
 11234                                        DET-PR-APR
 11235     ELSE
 11236         MOVE ZEROS                  TO DET-PR-APR.
 11237
 11238     IF CC-AGE NOT = ZERO  OR
 11239        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11240        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 218
* ECS010.cbl
 11241        CC-MEMBER-NO NOT = SPACES  OR
 11242        CC-SOC-SEC-NO NOT = SPACES  OR
 11243        CC-LOAN-APR NOT = ZERO
 11244         MOVE DET-PR-UREC            TO TR-DTL2
 11245         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11246         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11247
 11248     IF CC-LF-ORIG-TERM NOT = ZEROS
 11249         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11250         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11251                                        DET-N-LF-TERM
 11252     ELSE
 11253         MOVE ZEROS                  TO DET-O-LF-TERM
 11254                                        DET-N-LF-TERM.
 11255
 11256     IF CC-AH-ORIG-TERM NOT = ZEROS
 11257         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11258         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11259                                        DET-N-AH-TERM
 11260     ELSE
 11261         MOVE ZEROS                  TO DET-O-AH-TERM
 11262                                        DET-N-AH-TERM.
 11263
 11264     IF CC-LIVES NOT = ZEROS
 11265         MOVE CR-LIVES               TO DET-O-LIVES
 11266         MOVE CC-LIVES               TO CR-LIVES
 11267                                        DET-N-LIVES
 11268     ELSE
 11269         MOVE ZEROS                  TO DET-O-LIVES
 11270                                        DET-N-LIVES.
 11271
 11272     IF CC-BILLED NOT  = ZEROES
 11273         MOVE CC-BILLED              TO CR-BILLED.
 11274
 11275     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11276        CC-AH-ORIG-TERM NOT = ZERO  OR
 11277        CC-LIVES NOT = ZERO
 11278         MOVE DET-PR-UREC-2          TO TR-DTL2
 11279         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11280         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11281
 11282     IF CC-IND-GRP-TYPE NOT = SPACES
 11283         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11284                                        DET-IND-GRP
 11285     ELSE
 11286         MOVE SPACE                  TO DET-IND-GRP.
 11287
 11288     IF CC-PAY-FREQUENCY NOT = ZEROS
 11289         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11290                                        DET-PMT-FREQ
 11291     ELSE
 11292         MOVE ZEROS                  TO DET-PMT-FREQ.
 11293
 11294     IF CC-POLICY-FORM-NO NOT = SPACES
 11295         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11296                                        DET-POL-FORM
 11297     ELSE
 11298         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 219
* ECS010.cbl
 11299
 11300     IF CC-LOAN-OFFICER NOT = SPACES
 11301         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11302                                        DET-LOAN-OFFICER
 11303     ELSE
 11304         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11305
 11306     IF CC-USER-FIELD NOT = SPACES
 11307         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11308                                        DET-USER-CODE
 11309     ELSE
 11310         MOVE SPACE                  TO DET-USER-CODE.
 11311
 11312     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11313        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11314        CC-POLICY-FORM-NO NOT = SPACES  OR
 11315        CC-LOAN-OFFICER NOT = SPACES  OR
 11316        CC-USER-FIELD NOT = SPACES
 11317         MOVE DET-PR-UREC-3          TO TR-DTL2
 11318         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11319         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11320
 11321**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11322****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11323****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11324****                                    DET-CLM-DEDUCT
 11325**** ELSE
 11326****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11327
 11328     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11329         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11330                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11331                                        DET-CAN-DEDUCT
 11332     ELSE
 11333         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11334
 11335**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11336     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11337         MOVE DET-PR-UREC-4          TO TR-DTL2
 11338         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11339         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11340
 11341     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11342         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11343
 11344     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11345         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11346
 11347     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11348         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11349
 11350     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11351         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11352
 11353     IF CC-LF-BENEFIT-CD NOT = SPACES
 11354         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11355                                     DET-LF-BEN-CD
 11356     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 220
* ECS010.cbl
 11357         MOVE SPACES             TO DET-LF-BEN-CD.
 11358
 11359     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11360         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11361                                     DET-LF-PREM
 11362     ELSE
 11363         MOVE ZEROS              TO DET-LF-PREM.
 11364
 11365     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11366         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11367                                     DET-LF-BEN
 11368     ELSE
 11369         MOVE ZEROS              TO DET-LF-BEN.
 11370
 11371     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11372        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11373        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11374         MOVE DET-PR-UREC-5          TO TR-DTL2
 11375         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11376         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11377
 11378     IF CC-AH-BENEFIT-CD NOT = SPACES
 11379         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11380                                     DET-AH-BEN-CD
 11381     ELSE
 11382         MOVE SPACES             TO DET-AH-BEN-CD.
 11383
 11384     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11385         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11386                                     DET-AH-PREM
 11387     ELSE
 11388         MOVE ZEROS              TO DET-AH-PREM.
 11389
 11390     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11391         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11392                                     DET-AH-BEN
 11393     ELSE
 11394         MOVE ZEROS              TO DET-AH-BEN.
 11395
 11396     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11397        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11398        CC-AH-BENEFIT-AMT NOT = ZEROS
 11399         MOVE DET-PR-UREC-6          TO TR-DTL2
 11400         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11401         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11402
 11403 0910-END-CHANGE-PROCESSING.
 11404
 11405     IF CR-LNAME = ALL '*'
 11406         MOVE SPACES                 TO CR-LNAME.
 11407     IF CR-FNAME = ALL '*'
 11408         MOVE SPACES                 TO CR-FNAME.
 11409     IF CR-INIT = '*'
 11410         MOVE SPACES                 TO CR-INIT.
 11411     IF CR-SOC-SEC = ALL '*'
 11412         MOVE SPACES                 TO CR-SOC-SEC.
 11413     IF CR-JT-LNAME = ALL '*'
 11414         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 221
* ECS010.cbl
 11415     IF CR-JT-FNAME = ALL '*'
 11416         MOVE SPACES                 TO CR-JT-FNAME.
 11417     IF CR-JT-INIT = '*'
 11418         MOVE SPACES                 TO CR-JT-INIT.
 11419     IF CR-POLICY-FORM-NO = ALL '*'
 11420         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11421     IF CR-MEMBER-NO = ALL '*'
 11422         MOVE SPACES                 TO CR-MEMBER-NO.
 11423     IF CR-LOAN-OFFICER = ALL '*'
 11424         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11425     IF CR-USER-CODE = ALL '*'
 11426         MOVE SPACES                 TO CR-USER-CODE.
 11427
 11428     ADD +1 TO BC-G-CTN.
 11429     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 222
* ECS010.cbl
 11431 0920-GET-BANK-FEES.
 11432
 11433     IF CR-CERT-NO = '0008771354 '
 11434        DISPLAY ' MADE IT TO 0920 '
 11435     END-IF
 11436
 11437     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11438     MOVE CR-CARRIER             TO AG-CARRIER
 11439     MOVE CR-GROUPING            TO AG-GROUPING
 11440     MOVE CR-BANK-NO             TO AG-BANK
 11441     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11442     MOVE 'B'                    TO AG-TYPE
 11443
 11444*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11445*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11446*                                THRU 0925-EXIT
 11447*       GO TO 0920-EXIT
 11448*    END-IF
 11449
 11450     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11451
 11452     IF CR-CERT-NO = '0008771354 '
 11453        DISPLAY ' MADE IT AFTER START '
 11454     END-IF
 11455
 11456     .
 11457 0920-READ-ERAGTC.
 11458
 11459     IF ERAGTC-FILE-STATUS = '00'
 11460        READ ERAGTC NEXT RECORD
 11461     IF CR-CERT-NO = '0008771354 '
 11462        DISPLAY ' MADE ONE READ '
 11463     END-IF
 11464
 11465        IF ERAGTC-FILE-STATUS = '00'
 11466           IF (CR-CARRIER         = AG-CARRIER)
 11467              AND (CR-GROUPING    = AG-GROUPING)
 11468              AND (CR-BANK-NO     = AG-BANK)
 11469              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11470                 GO TO 0920-READ-ERAGTC
 11471              ELSE
 11472                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11473                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11474                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11475                                 THRU 0925-EXIT
 11476                    MOVE AG-CONTROL-PRIMARY
 11477                                 TO WS-PREV-BANK-COMM-KEY
 11478                    GO TO 0920-EXIT
 11479                 END-IF
 11480              END-IF
 11481           END-IF
 11482        END-IF
 11483     END-IF
 11484
 11485     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11486*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11487
 11488     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 223
* ECS010.cbl
 11489        AND (PB-I-BANK-FEE NOT = ZEROS)
 11490        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11491        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11492        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11493        MOVE ' '                 TO WS-BNK-RECALC (1)
 11494        MOVE +2                  TO IB
 11495     END-IF
 11496
 11497     .
 11498 0920-EXIT.
 11499     EXIT.
 11500
 11501 0925-BUILD-WORK-BNK-COMM.
 11502
 11503     IF CR-CERT-NO = '0008771354 '
 11504        DISPLAY ' MADE IT TO 0925 '
 11505     END-IF
 11506
 11507     MOVE +1                     TO IA IB
 11508
 11509*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11510*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11511*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11512*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11513*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11514*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11515*       ADD +1                   TO IB
 11516*    END-IF
 11517*    .
 11518*0925-BUILD-CONTINUE.
 11519
 11520     IF CR-CERT-NO = '00087735841'
 11521        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11522        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11523        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11524     END-IF
 11525
 11526*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11527     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11528        (IA > +10)
 11529        OR (IB > +10)
 11530        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11531           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11532           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11533*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11534           IF AG-SPP-FEES (IA) NOT NUMERIC
 11535              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11536           END-IF
 11537           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11538           MOVE AG-RECALC-LV-INDIC (IA)
 11539                                 TO WS-BNK-RECALC (IB)
 11540        ELSE
 11541           MOVE SPACES           TO WS-BNK-AGT (IB)
 11542                                    WS-BNK-TYPE (IB)
 11543                                    WS-BNK-RECALC (IB)
 11544           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11545        END-IF
 11546        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 224
* ECS010.cbl
 11547     END-PERFORM
 11548
 11549     .
 11550 0925-EXIT.
 11551     EXIT.
 11552
 11553 0930-BUILD-CERT-TRLR.
 11554
 11555     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11556     MOVE 'CS'                   TO CS-RECORD-ID
 11557     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11558     MOVE CR-CARRIER             TO CS-CARRIER
 11559     MOVE CR-GROUPING            TO CS-GROUPING
 11560     MOVE CR-STATE               TO CS-STATE
 11561     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11562     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11563     MOVE CR-CERT-NO             TO CS-CERT-NO
 11564     MOVE 'A'                    TO CS-TRAILER-TYPE
 11565
 11566     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11567
 11568     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11569        WRITE CERTIFICATE-TRAILERS
 11570        IF ELCRTT-FILE-STATUS = '00'
 11571           CONTINUE
 11572        ELSE
 11573           IF ELCRTT-FILE-STATUS = '22'
 11574              READ ELCRTT
 11575              IF ELCRTT-FILE-STATUS = '00'
 11576                 MOVE WS-BANK-COMMISSIONS
 11577                                 TO CS-BANK-COMMISSION-AREA
 11578                 REWRITE CERTIFICATE-TRAILERS
 11579                 IF ELCRTT-FILE-STATUS NOT = '00'
 11580                    DISPLAY ' BAD REWRITE ELCRTT '
 11581                                 ELCRTT-FILE-STATUS
 11582                    PERFORM ABEND-PGM
 11583                 END-IF
 11584              ELSE
 11585                 DISPLAY ' BAD READ    ELCRTT '
 11586                                  ELCRTT-FILE-STATUS
 11587                 PERFORM ABEND-PGM
 11588              END-IF
 11589           ELSE
 11590              DISPLAY ' BAD WRITE ELCRTT '
 11591                                 ELCRTT-FILE-STATUS
 11592              PERFORM ABEND-PGM
 11593           END-IF
 11594        END-IF
 11595     END-IF
 11596
 11597     .
 11598 0930-EXIT.
 11599     EXIT.
 11600
 11601 0950-BUILD-CERT-C-TRLR.
 11602
 11603     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11604     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 225
* ECS010.cbl
 11605     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11606     MOVE CR-CARRIER             TO CS-CARRIER.
 11607     MOVE CR-GROUPING            TO CS-GROUPING.
 11608     MOVE CR-STATE               TO CS-STATE.
 11609     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11610     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11611     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11612     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11613
 11614     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11615
 11616     WRITE CERTIFICATE-TRAILERS.
 11617     IF ELCRTT-FILE-STATUS = '00'
 11618        CONTINUE
 11619     ELSE
 11620        IF ELCRTT-FILE-STATUS = '22'
 11621           READ ELCRTT
 11622           IF ELCRTT-FILE-STATUS = '00'
 11623              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11624              REWRITE CERTIFICATE-TRAILERS
 11625              IF ELCRTT-FILE-STATUS NOT = '00'
 11626                 DISPLAY ' BAD REWRITE ELCRTT '
 11627                              ELCRTT-FILE-STATUS
 11628                 PERFORM ABEND-PGM
 11629              END-IF
 11630           ELSE
 11631              DISPLAY ' BAD READ    ELCRTT '
 11632                               ELCRTT-FILE-STATUS
 11633              PERFORM ABEND-PGM
 11634           END-IF
 11635        ELSE
 11636           DISPLAY ' BAD WRITE ELCRTT '
 11637                              ELCRTT-FILE-STATUS
 11638           PERFORM ABEND-PGM
 11639        END-IF
 11640     END-IF.
 11641
 11642     .
 11643 0950-EXIT.
 11644     EXIT.
 11645
 11646
 11647******************************************************************
 11648***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11649******************************************************************
 11650
 11651 1000-SET-COMMISSION-STRUCTURE.
 11652
 11653     MOVE +1                     TO IA
 11654                                    IB.
 11655
 11656 1100-GET-COMMISSION-LEVEL.
 11657
 11658     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11659
 11660     IF WK-AGT = '0000000000' OR SPACES
 11661         MOVE +0                 TO WK-L-RT
 11662                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 226
* ECS010.cbl
 11663                                    WK-A-RT
 11664         GO TO 1200-SET-COMMISSION-LEVEL.
 11665
 11666 1110-LIFE-COMMISSION.
 11667
 11668     IF CR-LFTYP = ZERO  OR
 11669       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11670         MOVE +0 TO WK-L-RT
 11671                    WK-J-RT
 11672         GO TO 1130-A-H-COMMISSION.
 11673
 11674     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11675         GO TO 1120-JOINT-LIFE-COMMISSION.
 11676
 11677     IF WK-L-RT NUMERIC
 11678        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11679         MOVE WK-L-RT                TO WS-COMMISSION
 11680         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11681         MOVE WS-COMMISSION          TO WK-L-RT
 11682         GO TO 1130-A-H-COMMISSION.
 11683
 11684     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11685     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11686     MOVE ZEROS                      TO WS-SUB1.
 11687     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11688
 11689     IF WS-SUB1 = ZEROS
 11690         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11691     ELSE
 11692         MOVE WK-RATE                TO WK-L-RT
 11693         GO TO 1130-A-H-COMMISSION.
 11694
 11695     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11696
 11697     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11698     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11699     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11700     MOVE WK-RATE                    TO WK-L-RT.
 11701
 11702     GO TO 1130-A-H-COMMISSION.
 11703
 11704 1120-JOINT-LIFE-COMMISSION.
 11705
 11706     IF WK-J-RT NUMERIC
 11707        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11708         MOVE WK-J-RT                TO WS-COMMISSION
 11709         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11710         MOVE WS-COMMISSION          TO WK-J-RT
 11711         GO TO 1130-A-H-COMMISSION.
 11712
 11713     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11714     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11715     MOVE ZEROS                      TO WS-SUB1.
 11716     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11717
 11718     IF WS-SUB1 = ZEROS
 11719         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11720     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 227
* ECS010.cbl
 11721         MOVE WK-RATE                TO WK-J-RT
 11722         GO TO 1130-A-H-COMMISSION.
 11723
 11724     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11725
 11726     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11727     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11728     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11729     MOVE WK-RATE                    TO WK-J-RT.
 11730
 11731 1130-A-H-COMMISSION.
 11732
 11733     IF CR-AHTYP = ZERO  OR
 11734       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11735         MOVE +0 TO WK-A-RT
 11736         GO TO 1200-SET-COMMISSION-LEVEL.
 11737
 11738     IF WK-A-RT NUMERIC
 11739        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11740         MOVE WK-A-RT                TO WS-COMMISSION
 11741         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11742         MOVE WS-COMMISSION          TO WK-A-RT
 11743         GO TO 1200-SET-COMMISSION-LEVEL.
 11744
 11745     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11746     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11747     MOVE ZEROS                      TO WS-SUB1.
 11748     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11749
 11750     IF WS-SUB1 = ZEROS
 11751         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11752     ELSE
 11753         MOVE WK-RATE                TO WK-A-RT
 11754         GO TO 1200-SET-COMMISSION-LEVEL.
 11755
 11756     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11757
 11758     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11759     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11760     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11761     MOVE WK-RATE                    TO WK-A-RT.
 11762
 11763 1200-SET-COMMISSION-LEVEL.
 11764
 11765     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11766     IF WK-AGT = '0000000000' OR SPACES
 11767         MOVE SPACE                   TO WK-N-TYPE (IA)
 11768     ELSE
 11769         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11770
 11771     IF CR-LFTYP = ZERO
 11772         MOVE +0                      TO WK-L-RT1  (IA)
 11773     ELSE
 11774         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11775             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11776         ELSE
 11777             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11778
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 228
* ECS010.cbl
 11779     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11780
 11781     IF RC-COMM-FLG = 'X'
 11782        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11783*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11784*             AND (IA = +5))
 11785            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11786            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11787            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11788            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11789
 11790     IF IA LESS THAN +10
 11791         ADD +1 TO IA
 11792         GO TO 1100-GET-COMMISSION-LEVEL.
 11793
 11794     GO TO 1499-SET-COMM-X.
 11795
 11796 1300-READ-ERCTBL-FILE.
 11797
 11798     IF CTBL-SEARCH = LAST-CTBL
 11799         GO TO 1399-READ-ERCTBL-X.
 11800
 11801     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11802
 11803     IF COMM-OPEN-SW = ' '
 11804         MOVE 'X'                        TO COMM-OPEN-SW
 11805         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11806         OPEN INPUT ERCTBL
 11807         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11808             NEXT SENTENCE
 11809            ELSE
 11810             MOVE '41'                   TO ABEND-CODE-1
 11811             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11812             DISPLAY '******************************'
 11813             DISPLAY '***** ERROR LOCATION 012 *****'
 11814             DISPLAY '******************************'
 11815             DISPLAY '******************************'
 11816             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11817             GO TO ABEND-PGM.
 11818
 11819     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11820                                            LAST-CTBL.
 11821     READ ERCTBL.
 11822
 11823     IF ERCTBL-FILE-STATUS = '23'
 11824         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11825                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11826                 ' CTBL: ' CTBL-SEARCH
 11827         MOVE '*'                TO CTBL-ERROR-SWITCH
 11828         MOVE '44'               TO ABEND-CODE-1
 11829         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11830         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11831         DISPLAY '******************************'
 11832         DISPLAY '***** ERROR LOCATION 013 *****'
 11833         DISPLAY '******************************'
 11834         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11835*        IF DTE-CLIENT NOT = 'NCL'
 11836         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 229
* ECS010.cbl
 11837           AND 'AHL'
 11838             GO TO ABEND-PGM
 11839         ELSE
 11840             NEXT SENTENCE
 11841     ELSE
 11842         IF ERCTBL-FILE-STATUS NOT = '00'
 11843             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11844             MOVE '44'               TO ABEND-CODE-1
 11845             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11846             DISPLAY '******************************'
 11847             DISPLAY '***** ERROR LOCATION 014 *****'
 11848             DISPLAY '******************************'
 11849             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11850             GO TO ABEND-PGM.
 11851
 11852     ADD +1                            TO ERCTBL-READS.
 11853
 11854 1399-READ-ERCTBL-X.
 11855     EXIT.
 11856
 11857 1400-GET-COMM-PERCENT.
 11858
 11859     IF CTBL-ERROR
 11860         MOVE ZEROS                      TO WK-RATE
 11861         GO TO 1489-GET-PERCENT-X.
 11862
 11863     MOVE +1 TO IB.
 11864     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11865        (CT-TBF (1) NOT EQUAL +9999999.99)
 11866         ADD +9 TO IB
 11867         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11868            (CT-TBF (2) NOT EQUAL +9999999.99)
 11869             ADD +9 TO IB.
 11870
 11871     IF CR-AGE GREATER CT-AGE (1)
 11872         ADD +3 TO IB
 11873         IF CR-AGE GREATER CT-AGE (2)
 11874             ADD +3 TO IB.
 11875
 11876     IF WS-COMM-TERM GREATER CT-TRM (1)
 11877         ADD +1 TO IB
 11878         IF WS-COMM-TERM GREATER CT-TRM (2)
 11879             ADD +1 TO IB.
 11880
 11881     IF CT-RT (IB) NOT NUMERIC
 11882         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11883         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11884         GO TO 1300-READ-ERCTBL-FILE.
 11885
 11886     MOVE CT-RT (IB) TO WK-RATE.
 11887
 11888 1489-GET-PERCENT-X.
 11889     EXIT.
 11890
 11891 1499-SET-COMM-X.
 11892     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 230
* ECS010.cbl
 11894******************************************************************
 11895***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11896******************************************************************
 11897
 11898 1500-GET-ACCT-LEVEL-LF-COMM.
 11899
 11900     MOVE ZEROS                      TO ACCT-COMM-LF
 11901                                        ACCT-COMM-AH.
 11902
 11903     MOVE +1                         TO IA.
 11904
 11905 1510-ACCT-LEVEL-LOOP.
 11906
 11907     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11908         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11909             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11910             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11911         ELSE
 11912             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11913                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11914
 11915     IF IA LESS THAN +10
 11916         ADD +1 TO IA
 11917         GO TO 1510-ACCT-LEVEL-LOOP.
 11918
 11919 1519-ACCT-LF-COMM-X.
 11920     EXIT.
 11921
 11922
 11923 1550-GET-ACCT-LEVEL-AH-COMM.
 11924
 11925     MOVE ZEROS                      TO ACCT-COMM-AH.
 11926
 11927     MOVE +1                         TO IA.
 11928
 11929 1555-ACCT-LEVEL-LOOP.
 11930
 11931     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11932         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11933             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11934
 11935     IF IA LESS THAN +10
 11936         ADD +1 TO IA
 11937         GO TO 1555-ACCT-LEVEL-LOOP.
 11938
 11939 1599-ACCT-AH-COMM-X.
 11940     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 231
* ECS010.cbl
 11942******************************************************************
 11943***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11944******************************************************************
 11945
 11946 1600-RECALC-COMM-EXTR.
 11947
 11948     IF RC-COMM-FLG = 'X'  OR
 11949        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11950        CR-POLICY-IS-DECLINED  OR
 11951        CR-POLICY-IS-VOID
 11952         GO TO 1899-RECALC-COMM-EXTR-X.
 11953
 11954     MOVE 'X'                           TO RC-COMM-FLG.
 11955
 11956     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11957         GO TO 1899-RECALC-COMM-EXTR-X.
 11958
 11959     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11960
 11961     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11962         GO TO 1899-RECALC-COMM-EXTR-X.
 11963
 11964     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11965
 11966     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11967         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11968             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11969
 11970     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11971         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11972                                           WK-NEW-RATES
 11973         GO TO 1899-RECALC-COMM-EXTR-X.
 11974
 11975     MOVE +1                            TO SUB8.
 11976     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11977
 11978 1610-CK-DUPLICATE-ENTRIES.
 11979     PERFORM 1620-CK-DUPL-ENTR-NEW
 11980         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11981             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11982
 11983 1619-CK-DUPLICATE-ENTRIES-XIT.
 11984     EXIT.
 11985
 11986 1620-CK-DUPL-ENTR-NEW.
 11987     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11988         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11989         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11990         MOVE +0                        TO CR-LCOM-L (SUB11)
 11991                                           CR-LCOM-AH (SUB11)
 11992         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11993         MOVE 11                        TO SUB12.
 11994
 11995 1629-CK-DUPL-ENTR-NEW-XIT.
 11996     EXIT.
 11997
 11998 1700-REVERSE-OLD-COMM-LOOP.
 11999     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 232
* ECS010.cbl
 12000     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 12001
 12002     IF SUB8 LESS THAN +10
 12003         ADD +1 TO SUB8
 12004         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 12005
 12006     MOVE 'O' TO RECALC-TYPE.
 12007
 12008     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12009
 12010     GO TO 1800-MOVE-NEW-COMM-RATES.
 12011
 12012 1710-DO-R-C-EXTRACTS.
 12013
 12014     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12015
 12016     PERFORM 1720-CHECK-COMM-LEVELS
 12017         THRU 1729-CHECK-COMM-LEVELS-EXIT
 12018             VARYING SUB13 FROM +1 BY +1
 12019                 UNTIL SUB13 GREATER THAN 10.
 12020
 12021     MOVE '8'                           TO DE-TRANS.
 12022     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 12023*****PERFORM EXTRACT-DATE-RELOAD.
 12024     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12025     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12026     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 12027     PERFORM EXTRACT-DATE-LOAD.
 12028     MOVE 'R'                           TO DE-REIN.
 12029     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12030     MOVE +1                            TO SUB1.
 12031     PERFORM 3110-REINSURE-ISSUE-LOOP
 12032         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12033
 12034     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12035         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12036                                       2259-END-CANCEL-BUILD
 12037         PERFORM 1720-CHECK-COMM-LEVELS
 12038             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12039                 VARYING SUB13 FROM +1 BY +1
 12040                     UNTIL SUB13 GREATER THAN 10
 12041         MOVE '7'                       TO DE-TRANS
 12042         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12043*********PERFORM EXTRACT-DATE-RELOAD
 12044         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12045         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12046         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12047         PERFORM EXTRACT-DATE-LOAD
 12048         MOVE 'R'                       TO DE-REIN
 12049         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12050         MOVE +1                        TO SUB1
 12051         PERFORM 3210-REINSURE-CANCEL-LOOP
 12052             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12053
 12054 1719-DO-R-C-EXTRACTS-X.
 12055     EXIT.
 12056
 12057 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 233
* ECS010.cbl
 12058
 12059     IF  DE-AGT (SUB13)       =  SPACES  AND
 12060         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12061         DE-L-PC (SUB13)      =  ZEROS   AND
 12062         DE-A-PC (SUB13)      =  ZEROS
 12063         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12064
 12065 1729-CHECK-COMM-LEVELS-EXIT.
 12066     EXIT.
 12067
 12068 1800-MOVE-NEW-COMM-RATES.
 12069     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12070     MOVE 'N'                           TO RECALC-TYPE.
 12071     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12072     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12073                                           CR-COMPENSATION-LEVELS.
 12074     IF DTE-CLIENT = 'DCC'
 12075        IF CR-LF-NSP-PRM NOT = ZEROS
 12076           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12077              (CR-LFPRM + CR-LFPRM-ALT) -
 12078              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12079        END-IF
 12080        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12081           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12082                                        NOT = 'G' AND 'L')
 12083           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12084           CR-AHPRM -
 12085           (CR-AHPRM * CR-LCOM-AH (1))
 12086        END-IF
 12087     END-IF
 12088     .
 12089
 12090 1899-RECALC-COMM-EXTR-X.
 12091     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 234
* ECS010.cbl
 12093******************************************************************
 12094***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12095******************************************************************
 12096
 12097 2000-INITIALIZE-DETAIL-EXTRACT.
 12098
 12099     MOVE SPACES                   TO DETAIL-EXTRACT.
 12100
 12101     MOVE 'DE'                     TO DE-RECORD-ID.
 12102     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12103     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12104
 12105     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12106     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12107
 12108     MOVE CR-NAME                  TO DE-NAME.
 12109     MOVE CR-AGE                   TO DE-AGE.
 12110     MOVE CR-SEX                   TO DE-SEX.
 12111     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12112
 12113     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12114     MOVE CR-LF-TERM               TO DE-LF-TERM
 12115     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12116     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12117     MOVE ZEROS                    TO DE-LF-CNBEN.
 12118     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12119     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12120     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12121     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12122     MOVE ZEROS                    TO DE-LF-RFND.
 12123
 12124     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12125     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12126                                      DE-LF-CANC-EXIT-DT.
 12127
 12128     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12129     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12130     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12131     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12132     MOVE ZEROS                    TO DE-AH-RFND.
 12133
 12134     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12135     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12136                                      DE-AH-CANC-EXIT-DT.
 12137     IF DTE-CLIENT = 'DCC'
 12138        IF CR-ENTRY-STATUS = 'M'
 12139           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12140        ELSE
 12141           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12142              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12143           END-IF
 12144        END-IF
 12145     END-IF
 12146
 12147     IF DTE-CLIENT = 'DCC'
 12148        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12149        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12150     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 235
* ECS010.cbl
 12151        IF (CR-LFTYP NOT = ZERO   AND
 12152           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12153           (CR-AHTYP NOT = ZERO  AND
 12154           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12155           MOVE CR-LIVES           TO DE-LIVES
 12156           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12157                                      DE-CANCEL-CNT-YTD
 12158        END-IF
 12159     END-IF
 12160
 12161     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12162     IF AM-ZIP-PRIME NUMERIC
 12163        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12164      ELSE
 12165        MOVE ZEROS                 TO DE-ZIP.
 12166     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12167
 12168     MOVE CR-APR                   TO DE-APR.
 12169     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12170     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12171     MOVE CR-IND-GRP               TO DE-IG.
 12172     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12173     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12174
 12175     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12176     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12177     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12178
 12179     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12180*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12181
 12182     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12183                                      DE-REI-AHAMT  DE-REI-AHPRM
 12184                                      DE-REI-LFRFND DE-REI-AHRFND
 12185                                      DE-REI-CNAMT.
 12186
 12187     MOVE +1                       TO SUB1.
 12188
 12189* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12190* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12191* CALC IT IN ECS017.
 12192     IF DTE-CLIENT = 'DCC'
 12193        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12194           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12195           IF CR-ACCOUNT = '05500500DD'
 12196              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12197                ' ' DE-REI-LFRFND
 12198           END-IF
 12199        END-IF
 12200        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12201                      OR
 12202           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12203            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12204           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12205           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12206        END-IF
 12207     END-IF
 12208
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 236
* ECS010.cbl
 12209
 12210     PERFORM EXTRACT-DATE-LOAD.
 12211
 12212     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12213                                      WS-DE-INCUR-N
 12214                                      WS-DE-PAY-N
 12215                                      WS-DE-PAID-TO-N
 12216                                      WS-DE-ACC-EXP-DTE-N
 12217                                      WS-DE-ACC-EFF-DTE-N
 12218                                      WS-DE-RSV-INCUR-N
 12219                                      WS-DE-RSV-PAYTO-N
 12220                                      WS-DE-ACC-EXP-DTE-RSV-N
 12221                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12222
 12223 2090-GL-CODE-LOOP.
 12224
 12225     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12226
 12227     IF SUB1 LESS THAN +10
 12228         ADD +1 TO SUB1
 12229         GO TO 2090-GL-CODE-LOOP.
 12230
 12231     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12232
 12233     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12234
 12235     IF (DTE-CLIENT = 'DCC')
 12236        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12237        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12238        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12239        AND (RECALC-TYPE = SPACES)
 12240        MOVE +1                  TO IA
 12241*       IF CR-ACCOUNT = '05500500DD'
 12242**      IF CR-CERT-NO = '0008773536 '
 12243*          DISPLAY ' MADE IT TO 2000 '
 12244*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12245*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12246*             (IB > +10)
 12247*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12248*                MOVE IB TO DIL-BEN-CODE
 12249*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12250*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12251*                DISPLAY DISPLAY-IBNR-LINE
 12252*             END-IF
 12253*          END-PERFORM
 12254*          DISPLAY ' TRLR AREA  '
 12255*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12256*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12257*             (IB > +10)
 12258*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12259*                MOVE IB TO DIL-BEN-CODE
 12260*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12261*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12262*                DISPLAY DISPLAY-IBNR-LINE
 12263*             END-IF
 12264*          END-PERFORM
 12265*       END-IF
 12266        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 237
* ECS010.cbl
 12267           IB > +10
 12268           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12269              CONTINUE
 12270           ELSE
 12271              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12272                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12273                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12274                 COMPUTE DE-A-PC (IB) =
 12275                        WS-BNK-SPP-FEES (IA) / +1000
 12276                 MOVE +0              TO DE-L-PC (IB)
 12277                 ADD +1               TO IA
 12278              END-IF
 12279*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12280*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12281*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12282*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12283*                MOVE +0              TO DE-L-PC (IB)
 12284*                ADD +1               TO IA
 12285*             END-IF
 12286           END-IF
 12287        END-PERFORM
 12288     END-IF
 12289
 12290
 12291
 12292     .
 12293 2099-INIT-DTL-X.
 12294     EXIT.
 12295
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 238
* ECS010.cbl
 12297******************************************************************
 12298***            B U I L D   I S S U E   E X T R A C T           ***
 12299******************************************************************
 12300
 12301 2100-BUILD-ISSUE-EXTRACT.
 12302
 12303     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12304
 12305     MOVE 'I'                      TO DE-TRANS.
 12306
 12307     IF CHECK-BILLED
 12308         MOVE 'N' TO BILLED-SWITCH
 12309     ELSE
 12310         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12311
 12312     MOVE +1                        TO SUB1.
 12313 2150-GA-BILL-LOOP.
 12314
 12315     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12316         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12317
 12318     IF SUB1 LESS THAN +5
 12319         ADD +1 TO SUB1
 12320         GO TO 2150-GA-BILL-LOOP.
 12321
 12322     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12323     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12324                                       DE-BILLED-LFRFND
 12325                                       DE-BILLED-AHPRM
 12326                                       DE-BILLED-AHRFND.
 12327
 12328     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12329         IF PB-LF-BILLED-AMTS = ZERO  AND
 12330            PB-AH-BILLED-AMTS = ZERO
 12331             MOVE ' '                    TO DE-BILL-STATUS
 12332         ELSE
 12333             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12334                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12335                 MOVE 'B'                TO DE-BILL-STATUS
 12336             ELSE
 12337                 MOVE 'R'                TO DE-BILL-STATUS
 12338                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12339                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12340     ELSE
 12341         MOVE 'B'                        TO DE-BILL-STATUS.
 12342
 12343 2190-WRITE-ISSUE-EXTRACT.
 12344
 12345     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12346
 12347 2199-BLD-ISSUE-X.
 12348     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 239
* ECS010.cbl
 12350******************************************************************
 12351***           B U I L D   C A N C E L   E X T R A C T          ***
 12352******************************************************************
 12353
 12354 2200-BUILD-CANCEL-EXTRACT.
 12355
 12356     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12357
 12358     MOVE 'C'                           TO DE-TRANS.
 12359
 12360     IF CR-LFTYP = ZERO
 12361         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12362
 12363     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12364         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12365             CR-LFRFND = +0
 12366              MOVE +0                   TO TEMP-5
 12367              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12368
 12369     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12370          IF CR-LFRFND = +0
 12371              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12372
 12373     MOVE +1 TO TEMP-5.
 12374     MOVE CR-LF-TERM             TO ORIG-TERM.
 12375     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12376     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12377     MOVE '1'                    TO W-VAL-SOURCE.
 12378     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12379
 12380     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12381         MOVE CR-LFAMT TO DE-LF-CNBEN
 12382         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12383
 12384     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12385         GO TO 2220-BLD-DE-CANCEL-SUM.
 12386
 12387     IF REM-TRM3 = CR-LF-TERM
 12388         MOVE CR-LFAMT TO DE-LF-CNBEN
 12389         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12390
 12391     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12392         GO TO 2210-BLD-DE-CANCEL-TEX.
 12393
 12394     IF DTE-CLIENT = 'NCL'
 12395         IF CR-DT LESS THAN 19910101
 12396             GO TO 2205-BLD-DE-CANCEL-BEN.
 12397
 12398     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12399         GO TO 2230-BLD-DE-CANCEL-NP.
 12400
 12401     IF DTE-CLIENT = 'FUL'
 12402         GO TO 2240-BLD-DE-CANCEL-FUL.
 12403
 12404*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12405     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12406        (CR-RATING-CLASS NOT = 'L ')
 12407         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 240
* ECS010.cbl
 12408            (CR-LF-TERM GREATER THAN 060)  AND
 12409            (CR-DT GREATER THAN 19831031)
 12410              GO TO 2230-BLD-DE-CANCEL-NP.
 12411
 12412     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12413         IF (CR-APR GREATER THAN ZERO)  AND
 12414            (CR-LF-TERM GREATER THAN 061)  AND
 12415            (CR-DT GREATER THAN 19830318)
 12416              GO TO 2230-BLD-DE-CANCEL-NP.
 12417
 12418     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12419         IF (CR-APR GREATER THAN ZERO)  AND
 12420            (CR-LF-TERM GREATER THAN 062)  AND
 12421            (CR-DT GREATER THAN 19810831)  AND
 12422            (CR-DT LESS THAN 19830901)
 12423              GO TO 2230-BLD-DE-CANCEL-NP.
 12424
 12425     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12426         IF (CR-APR GREATER THAN ZERO)  AND
 12427            (CR-LF-TERM GREATER THAN 060)  AND
 12428            (CR-DT GREATER THAN 19831231)
 12429              GO TO 2230-BLD-DE-CANCEL-NP.
 12430
 12431 2205-BLD-DE-CANCEL-BEN.
 12432
 12433     IF CR-LF-TERM EQUAL +0
 12434         MOVE +0          TO TEMP-5
 12435     ELSE
 12436         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12437
 12438     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12439
 12440     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12441
 12442 2210-BLD-DE-CANCEL-TEX.
 12443
 12444     DIVIDE CR-LFAMT BY CR-LF-TERM
 12445         GIVING TEX-FACT-1.
 12446     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12447         GIVING TEX-FACT-2
 12448             REMAINDER TEX-FACT-3.
 12449     IF TEX-FACT-3 NOT = ZERO
 12450         ADD +1 TO TEX-FACT-2.
 12451     COMPUTE DE-LF-CNBEN =
 12452         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12453
 12454     IF CR-LFAMT EQUAL +0
 12455         MOVE +0                  TO TEMP-5
 12456     ELSE
 12457         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12458
 12459     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12460
 12461 2220-BLD-DE-CANCEL-SUM.
 12462
 12463     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12464     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12465
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 241
* ECS010.cbl
 12466     IF CR-LFRFND NOT LESS CR-LFPRM
 12467         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12468          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12469
 12470     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12471     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12472     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12473         MOVE TEMP-7             TO DE-LF-CNBEN
 12474       ELSE
 12475         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12476         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12477
 12478     IF CR-LFAMT EQUAL +0
 12479         MOVE +0                  TO TEMP-5
 12480     ELSE
 12481         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12482
 12483     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12484         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12485
 12486 2230-BLD-DE-CANCEL-NP.
 12487
 12488     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12489     MOVE 'L'                        TO  DC-OPTION-CODE.
 12490     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12491     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12492
 12493     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12494       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12495       MOVE '3'                      TO  DC-OPTION-CODE
 12496       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12497       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12498     ELSE
 12499       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12500       MOVE '6'                      TO  DC-OPTION-CODE
 12501       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12502       MOVE +0                       TO  DC-ELAPSED-DAYS
 12503       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12504       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12505
 12506     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12507     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12508     MOVE CR-APR                     TO  CP-LOAN-APR.
 12509     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12510     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12511     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12512     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12513     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12514     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12515
 12516     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12517     IF (DTE-CLIENT = 'DCC')
 12518        AND (AM-DCC-PRODUCT-CODE <> spaces)
 12519        if cr-clp-state = spaces
 12520           move cr-state         to cr-clp-state
 12521        end-if
 12522        if cr-lftyp not = '00' and '  ' and 'DD'
 12523           move 'L'              to ws-dd-ben-type
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 242
* ECS010.cbl
 12524           move cr-lftyp         to ws-dd-ben-code
 12525        else
 12526           move 'A'              to ws-dd-ben-type
 12527           move cr-ahtyp         to ws-dd-ben-code
 12528        end-if
 12529        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12530           ((CR-clp-STATE = DD-STATE (D1))
 12531           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12532           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 12533           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 12534           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12535                           OR
 12536           D1 > max-pdef
 12537        END-PERFORM
 12538        IF D1 <= max-pdef
 12539           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12540              (P1 > +8)
 12541              OR (DD-PROD-CODE (D1 P1) = 'L')
 12542           END-PERFORM
 12543           IF P1 < +9
 12544              MOVE DD-MAX-BEN-AMT (D1 P1)
 12545                                 TO CP-R-MAX-TOT-BEN
 12546           END-IF
 12547        END-IF
 12548     END-IF
 12549
 12550     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12551
 12552     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12553         COMPUTE DE-LF-CNBEN =
 12554                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12555      ELSE
 12556          COMPUTE DE-LF-CNBEN ROUNDED =
 12557                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12558
 12559     IF CR-LFAMT EQUAL +0
 12560         MOVE +0                  TO TEMP-5
 12561     ELSE
 12562         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12563
 12564     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12565
 12566 2240-BLD-DE-CANCEL-FUL.
 12567
 12568     MOVE CR-APR                  TO NP-APR.
 12569     MOVE CR-LF-TERM              TO NP-ORIG.
 12570     MOVE REM-TRM3                TO NP-REM.
 12571     MOVE '2'                     TO NP-OPT.
 12572     MOVE CR-AHPRM                TO NP-AHPRM.
 12573     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12574     MOVE CR-LFAMT                TO NP-BENEFIT.
 12575
 12576*    CALL 'FULNETRM'
 12577*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12578*              NP-ACCOUNT NP-REMAINING.
 12579
 12580     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12581
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 243
* ECS010.cbl
 12582     IF CR-LFAMT EQUAL +0
 12583         MOVE +0                  TO TEMP-5
 12584     ELSE
 12585         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12586
 12587 2250-CONTINUE-CANCEL-BUILD.
 12588
 12589     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12590     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12591     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 12592                                         WS-DE-LF-CANC-DTE-N.
 12593     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12594                                         WS-DE-LF-CANC-EXIT-DT-N.
 12595     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12596
 12597
 12598     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12599     IF (DTE-CLIENT = 'DCC')
 12600        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12601        AND (CR-AHTYP NOT = '00' AND '  ')
 12602        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12603        MOVE CR-AH-TERM          TO ORIG-TERM
 12604        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12605        MOVE '1'                 TO W-VAL-SOURCE
 12606        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12607        PERFORM 8500-REMAINING-TERM-ROUTINE
 12608                                 THRU 8599-REM-TERM-X
 12609        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12610        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12611     END-IF
 12612
 12613     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12614
 12615     IF DTE-CLIENT = 'DCC'
 12616        IF DE-AH-RFND = ZEROS
 12617           MOVE ZEROS                 TO DE-ADDL-CLP
 12618        END-IF
 12619     END-IF
 12620
 12621     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12622     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12623                                         WS-DE-AH-CANC-DTE-N.
 12624     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12625                                         WS-DE-AH-CANC-EXIT-DT-N.
 12626     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12627
 12628     IF PB-LAST-MAINT-BY = 'E570'
 12629         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12630
 12631     IF CHECK-BILLED
 12632         MOVE 'N' TO BILLED-SWITCH
 12633     ELSE
 12634         GO TO 2259-END-CANCEL-BUILD.
 12635
 12636     MOVE +1                        TO SUB1.
 12637 2255-GA-BILL-LOOP.
 12638
 12639     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 244
* ECS010.cbl
 12640         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12641
 12642     IF SUB1 LESS THAN +5
 12643         ADD +1 TO SUB1
 12644         GO TO 2255-GA-BILL-LOOP.
 12645
 12646     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12647     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12648     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12649                                       DE-BILLED-LFRFND
 12650                                       DE-BILLED-AHPRM
 12651                                       DE-BILLED-AHRFND.
 12652
 12653     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12654         IF PB-LF-BILLED-AMTS = ZERO  AND
 12655            PB-AH-BILLED-AMTS = ZERO
 12656             MOVE ' '                    TO DE-BILL-STATUS
 12657         ELSE
 12658             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12659                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12660                 MOVE 'B'                TO DE-BILL-STATUS
 12661             ELSE
 12662                 MOVE 'R'                TO DE-BILL-STATUS
 12663                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12664                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12665     ELSE
 12666         MOVE 'B'                        TO DE-BILL-STATUS.
 12667
 12668 2259-END-CANCEL-BUILD.
 12669     EXIT.
 12670
 12671 2290-WRITE-CANCEL-EXTRACT.
 12672
 12673     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12674
 12675 2299-BLD-CANCEL-X.
 12676     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 245
* ECS010.cbl
 12678******************************************************************
 12679***            B U I L D   C L A I M   E X T R A C T           ***
 12680******************************************************************
 12681
 12682 2300-BUILD-CLAIM-EXTRACT.
 12683
 12684     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12685
 12686     MOVE 'X'                       TO DE-TRANS.
 12687
 12688     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12689
 12690     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12691     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12692
 12693     MOVE INCURRED-DATE             TO DE-INCUR
 12694                                       WS-DE-INCUR-N.
 12695     MOVE REPORTED-DATE             TO DE-REPORTED.
 12696     MOVE PAYMENT-DATE              TO DE-PAY
 12697                                       WS-DE-PAY-N.
 12698     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12699                                       WS-DE-PAID-TO-N.
 12700
 12701     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12702     MOVE PC-CHECK-NO               TO DE-CHECK.
 12703     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12704     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12705     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12706     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12707     INSPECT DE-PAY-CODE
 12708         CONVERTING '1234569' TO 'PFSXEEV'.
 12709
 12710     MOVE AM-NAME                   TO DE-ACC-NAME.
 12711     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12712                                       WS-DE-ACC-EXP-DTE-N.
 12713     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12714                                       WS-DE-ACC-EFF-DTE-N.
 12715     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12716     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12717
 12718     IF DE-DTH  OR  DE-OB-DTH
 12719         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12720     ELSE
 12721         IF CR-AH-LUMP-SUM-DISAB
 12722             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12723                                    TO DE-AH-PREV-STAT.
 12724
 12725     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12726         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12727
 12728 2390-WRITE-CLAIM-EXTRACT.
 12729
 12730     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12731
 12732 2399-BLD-CLAIM-X.
 12733     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 246
* ECS010.cbl
 12735******************************************************************
 12736***          B U I L D   R E S E R V E   E X T R A C T         ***
 12737******************************************************************
 12738
 12739 2400-BUILD-RESERVE-EXTRACT.
 12740
 12741     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12742
 12743     MOVE 'Y'                         TO DE-TRANS.
 12744     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12745
 12746     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12747     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12748     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12749     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12750     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12751     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12752
 12753     IF DTE-CLIENT  =  'NCL'
 12754        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12755            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12756
 12757     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12758
 12759     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12760                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12761
 12762     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12763                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12764
 12765     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12766                                         WS-DE-RSV-INCUR-N.
 12767     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12768     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12769                                         WS-DE-RSV-PAYTO-N.
 12770
 12771     MOVE ZEROS                       TO DE-REI-IBNR
 12772                                         DE-REI-PAYCUR
 12773                                         DE-REI-FUTRSV.
 12774
 12775     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12776
 12777     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12778         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12779
 12780 2490-WRITE-RESERVE-EXTRACT.
 12781
 12782     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12783
 12784 2499-BLD-RESERVE-X.
 12785     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 247
* ECS010.cbl
 12787******************************************************************
 12788***          W R I T E   D E T A I L   E X T R A C T S         ***
 12789******************************************************************
 12790
 12791 2500-WRITE-DETAIL-EXTRACTS.
 12792
 12793
 12794     MOVE  ZEROS            TO  SUB.
 12795
 12796     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12797         GO TO 2520-WRITE-CONTINUE.
 12798
 12799 2510-ZERO-CHARGEBACK-LOOP.
 12800
 12801     ADD  +1                TO  SUB.
 12802
 12803     IF  SUB    GREATER  THAN     +10
 12804         GO TO  2520-WRITE-CONTINUE.
 12805
 12806*    DISPLAY ' CERT NO ' CR-CERT-NO
 12807*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12808*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12809
 12810
 12811     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12812         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12813
 12814     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12815         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12816         OR (WS-DDF-AH-CB (SUB) = 'N')
 12817         MOVE  ZEROS             TO DE-A-PC (SUB)
 12818     END-IF
 12819
 12820     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12821
 12822 2520-WRITE-CONTINUE.
 12823
 12824     IF DTE-CLIENT NOT = 'HER'
 12825         GO TO 2590-WRITE-EXTRACTS.
 12826
 12827     IF DE-REINCO NOT = 'LNL'
 12828         GO TO 2590-WRITE-EXTRACTS.
 12829
 12830     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12831         GO TO 2590-WRITE-EXTRACTS.
 12832
 12833     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12834     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12835     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12836     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12837     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12838     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12839     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12840     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12841     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12842     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12843
 12844     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 248
* ECS010.cbl
 12845     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12846     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12847     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12848     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12849     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12850     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12851     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12852     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12853     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12854
 12855
 12856 2590-WRITE-EXTRACTS.
 12857
 12858     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12859                                     WS-DE-PROC-DT-N.
 12860
 12861     IF DTE-PGM-OPT = '1'
 12862         ADD +1                   TO DE-CNT
 12863*********PERFORM EXTRACT-DATE-RELOAD
 12864         WRITE DETAIL-EXTRACT.
 12865
 12866
 12867 2599-WRT-DETAIL-X.
 12868     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 249
* ECS010.cbl
 12870******************************************************************
 12871***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12872******************************************************************
 12873
 12874 3000-REINSURE-ROUTINE.
 12875
 12876     IF (CR-POLICY-IS-DECLINED) OR
 12877        (CR-POLICY-IS-VOID)
 12878        GO TO 3099-REINSURE-ROUTINE-X.
 12879
 12880     IF REIN-FLG = 'X'
 12881         GO TO 3099-REINSURE-ROUTINE-X.
 12882
 12883     MOVE 'X' TO REIN-FLG.
 12884
 12885     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12886
 12887     IF CR-REIN-TABLE = SPACES OR ZEROS
 12888         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12889
 12890******************************************************************
 12891***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12892******************************************************************
 12893
 12894 3010-RR-READ-REIN.
 12895
 12896     IF REIN-OPEN-SW = ' '
 12897         MOVE 'X'                       TO REIN-OPEN-SW
 12898         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12899         MOVE 'A'                       TO REIN-SRCH-CODE
 12900         OPEN INPUT ERRTBL-IN
 12901         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12902             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12903          ELSE
 12904             MOVE '21'                  TO ABEND-CODE-1
 12905             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12906             DISPLAY '******************************'
 12907             DISPLAY '***** ERROR LOCATION 015 *****'
 12908             DISPLAY '******************************'
 12909             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12910             GO TO ABEND-PGM.
 12911
 12912     IF CR-REIN-TABLE = REIN-SRCH
 12913         GO TO 3019-RR-READ-REIN-X.
 12914
 12915     MOVE +0                            TO REIN-SUB-1.
 12916     MOVE 999999                        TO REIN-LOW-TIME.
 12917     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12918
 12919 3011-RR-CHECK-REIN-SAVE-TABLE.
 12920
 12921     ADD +1                             TO REIN-SUB-1.
 12922     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12923        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12924         GO TO 3015-RR-READ-ERRTBL.
 12925
 12926     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12927         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 250
* ECS010.cbl
 12928         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12929         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12930         GO TO 3019-RR-READ-REIN-X.
 12931
 12932     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12933         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12934         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12935
 12936     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12937
 12938 3015-RR-READ-ERRTBL.
 12939
 12940     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12941
 12942     READ ERRTBL-IN.
 12943
 12944     IF ERRTBL-FILE-STATUS  = '23'
 12945         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12946                                           ' ' CR-FULL-CONTROL
 12947         MOVE '24'                      TO ABEND-CODE-1
 12948         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12949         DISPLAY '******************************'
 12950         DISPLAY '***** ERROR LOCATION 016 *****'
 12951         DISPLAY '******************************'
 12952         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12953         GO TO ABEND-PGM.
 12954
 12955     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12956         NEXT SENTENCE
 12957       ELSE
 12958         MOVE '24'                      TO ABEND-CODE-1
 12959         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12960         DISPLAY '******************************'
 12961         DISPLAY '***** ERROR LOCATION 017 *****'
 12962         DISPLAY '******************************'
 12963         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12964         GO TO ABEND-PGM.
 12965
 12966     ADD +1                            TO ERRTBL-READS.
 12967
 12968     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12969         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12970         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12971         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12972     ELSE
 12973         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12974         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12975         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12976         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12977
 12978 3019-RR-READ-REIN-X.
 12979     EXIT.
 12980
 12981 3020-CALCULATE-REINSURANCE.
 12982
 12983*    IF DTE-CLIENT = '???'  AND
 12984*       (CR-REIN-TABLE = 'SE1')
 12985*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 251
* ECS010.cbl
 12986*        IF CR-STATE NOT = STATE-L
 12987*            MOVE CR-STATE             TO STATE-L
 12988*            PERFORM 8200-STATE-CODE-LOOKUP
 12989*                         THRU 8299-STATE-LOOKUP-X.
 12990
 12991
 12992*    IF DTE-CLIENT = 'DCC'
 12993*       IF CR-LF-NSP-PRM NOT = ZEROS
 12994*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12995*             (CR-LFPRM + CR-LFPRM-ALT) -
 12996*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12997*       END-IF
 12998*       IF CR-AH-NSP-PRM NOT = ZEROS
 12999*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 13000*          CR-AHPRM -
 13001*          (CR-AHPRM * CR-LCOM-AH (1))
 13002*       END-IF
 13003*    END-IF
 13004
 13005
 13006     IF RE-REMAINING (1) = 'I'
 13007         MOVE '*'                      TO RISK-REIN-FLAG
 13008     ELSE
 13009         GO TO 3029-CONTINUE-REIN-CALC.
 13010
 13011     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 13012                                          REIN-CANCEL-AH-SW.
 13013     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 13014                                          REIN-LCNC-EARN-TERM
 13015                                          REIN-LF-CLM-MONTHS
 13016                                          REIN-EARN-AH-TERM
 13017                                          REIN-ACNC-EARN-TERM
 13018                                          REIN-AH-PRIOR-CLMS-PAID
 13019                                          REIN-AH-CLM-MONTHS
 13020                                          REIN-AH-CLM-MTH-1
 13021                                          REIN-AH-CLM-MTH-2
 13022                                          REIN-AH-CLM-MTH-3
 13023                                          REIN-AH-CLM-MTH-4
 13024                                          REIN-AH-CLM-MTH-5.
 13025
 13026*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 13027*    MOVE 'L'                          TO DC-OPTION-CODE.
 13028*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13029*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 13030
 13031     IF CR-LFTYP = ZEROS  OR  SPACES
 13032         GO TO 3023-CONTINUE.
 13033
 13034     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13035
 13036     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 13037       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13038           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13039
 13040     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13041       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13042           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13043
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 252
* ECS010.cbl
 13044     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13045     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13046
 13047     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13048         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13049     ELSE
 13050         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13051
 13052     IF CR-LF-CANC-DT NOT = ZEROS
 13053         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13054         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13055         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13056         IF CR-DT = CR-LF-CANC-DT
 13057             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13058
 13059     IF CR-DTH-DT NOT = ZEROS
 13060         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13061         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13062         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13063
 13064     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13065
 13066
 13067 3023-CONTINUE.
 13068
 13069     IF CR-AHTYP = ZEROS  OR  SPACES
 13070        GO TO 3029-CONTINUE-REIN-CALC.
 13071
 13072     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13073
 13074     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13075       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13076           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13077
 13078     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13079       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13080           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13081
 13082     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13083     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13084
 13085     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13086         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13087     ELSE
 13088         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13089
 13090     IF CR-AH-CANC-DT NOT = ZEROS
 13091         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13092         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13093         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13094         IF CR-DT = CR-AH-CANC-DT
 13095             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13096
 13097     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13098         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13099         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13100         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13101
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 253
* ECS010.cbl
 13102     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13103         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13104         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13105         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13106
 13107     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13108         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13109         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13110         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13111
 13112     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13113         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13114         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13115         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13116
 13117     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13118         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13119         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13120         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13121
 13122     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13123
 13124
 13125     GO TO 3029-CONTINUE-REIN-CALC.
 13126
 13127
 13128 3025-CALC-ELAPSED-MONTHS.
 13129
 13130     MOVE 'L'                          TO DC-OPTION-CODE.
 13131     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13132     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13133     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13134     MOVE '1'                          TO DC-OPTION-CODE.
 13135     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13136     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13137                                          DC-ODD-DAYS-OVER
 13138                                          DC-ELAPSED-DAYS.
 13139     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13140
 13141 3026-CALC-EXIT.
 13142     EXIT.
 13143
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 254
* ECS010.cbl
 13145 3029-CONTINUE-REIN-CALC.
 13146
*13147                             COPY ECSRTPFM.
 13148******************************************************************07/10/97
 13149*                                                                *ECSRTPFM
 13150*                            ECSRTPFM                            *   LV001
 13151*                            VMOD=2.002                          *ECSRTPFM
 13152*                                                                *ECSRTPFM
 13153******************************************************************ECSRTPFM
 13154                                                                  ECSRTPFM
 13155     IF    CR-LFAMT  NUMERIC                                      00000072
 13156           NEXT SENTENCE                                          00000073
 13157        ELSE                                                      00000074
 13158           MOVE ZEROS TO CR-LFAMT.                                00000075
 13159                                                                  00000076
 13160     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13161           NEXT SENTENCE                                          00000078
 13162        ELSE                                                      00000079
 13163           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13164                                                                  00000081
 13165                                                                  00000082
 13166     IF    CR-LFPRM  NUMERIC                                      00000083
 13167           NEXT SENTENCE                                          00000084
 13168        ELSE                                                      00000085
 13169           MOVE ZEROS TO CR-LFPRM.                                00000086
 13170                                                                  00000087
 13171     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13172           NEXT SENTENCE                                          00000089
 13173        ELSE                                                      00000090
 13174           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13175                                                                  00000092
 13176                                                                  00000093
 13177     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13178           NEXT SENTENCE                                          00000095
 13179        ELSE                                                      00000096
 13180           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13181                                                                  00000098
 13182     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13183           NEXT SENTENCE                                          00000100
 13184        ELSE                                                      00000101
 13185           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13186                                                                  00000103
 13187     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13188           NEXT SENTENCE                                          00000105
 13189        ELSE                                                      00000106
 13190           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13191                                                                  00000108
 13192     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13193     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13194     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13195         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13196     ELSE                                                         ECSRTPFM
 13197         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13198     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13199                                                                  ECSRTPFM
 13200     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13201     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13202     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 255
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13203         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13204     ELSE                                                         ECSRTPFM
 13205         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13206     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13207                                                                  ECSRTPFM
 13208     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13209         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13210             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13211                                                                  ECSRTPFM
 13212
 13213     MOVE 'X'                  TO REIN-RT-SW.
 13214     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13215     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13216     MOVE ' '                  TO REIN-RT-SW.
 13217
 13218 3030-RE-CALCULATE-REINSURANCE.
 13219
 13220     IF AM-RECALC-REIN = 'Y'
 13221         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13222            CR-REIN-SPEC = SPACE  AND
 13223            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13224             PERFORM 3600-RC-REINSURANCE
 13225                 THRU 3799-RC-REINSURANCE-X.
 13226
 13227     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13228         VARYING SUB1 FROM 1 BY 1
 13229             UNTIL REIN-COMP (SUB1) = SPACES.
 13230
 13231     GO TO 3099-REINSURE-ROUTINE-X.
 13232
 13233 3040-REIN-REC-CNT.
 13234
 13235     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13236         GO TO 3049-RRC-XIT.
 13237
 13238     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13239         VARYING B-SUB FROM 1 BY 1
 13240             UNTIL B-SUB GREATER THAN 50.
 13241
 13242 3049-RRC-XIT.
 13243     EXIT.
 13244
 13245 3050-REIN-COMP-ADD.
 13246
 13247     IF RB-COMPANY (B-SUB) = SPACES
 13248         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13249     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13250         MOVE 1   TO RB-COUNT (B-SUB)
 13251         MOVE +50 TO B-SUB.
 13252
 13253 3059-RCA-XIT.
 13254     EXIT.
 13255
 13256 3099-REINSURE-ROUTINE-X.
 13257     EXIT.
 13258
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 256
* ECS010.cbl
 13260******************************************************************
 13261***                R E I N S U R E   I S S U E S               ***
 13262******************************************************************
 13263
 13264 3100-REINSURE-ISSUE.
 13265
 13266     IF  REIN-COMP (1) = SPACES
 13267         GO TO 3199-REINSURE-ISSUE-X.
 13268
 13269     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13270     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13271     MOVE 'I'      TO DE-TRANS.
 13272     MOVE 'R'      TO DE-REIN.
 13273*****PERFORM EXTRACT-DATE-RELOAD.
 13274     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13275     MOVE +1       TO SUB1.
 13276
 13277 3110-REINSURE-ISSUE-LOOP.
 13278
 13279     IF REIN-COMP (SUB1) = SPACES
 13280         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13281
 13282     IF UPDATING-RISK-PREMIUMS
 13283       IF REIN-REM-SW (SUB1) NOT = 'I'
 13284         ADD +1 TO SUB1
 13285         GO TO 3110-REINSURE-ISSUE-LOOP.
 13286
 13287     IF REIN-REM-SW (SUB1) = 'Z'
 13288         ADD +1 TO SUB1
 13289         GO TO 3110-REINSURE-ISSUE-LOOP.
 13290
 13291     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13292     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13293     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13294     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13295     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13296     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13297
 13298     IF REIN-REM-SW (SUB1) NOT = 'I'
 13299         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13300
 13301     IF RWF-LFPRM = ZEROS  AND
 13302        RWF-AHPRM = ZEROS
 13303         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13304
 13305     IF RWF-LFPRM NOT = ZEROS
 13306         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13307         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13308
 13309     IF RWF-AHPRM NOT = ZEROS
 13310         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13311         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13312
 13313 3115-CONTINUE-ISSUE-LOOP.
 13314
 13315     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13316     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13317
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 257
* ECS010.cbl
 13318     IF DE-REI-LFAMT NOT = ZERO
 13319        OR DE-REI-LFPRM NOT = ZERO
 13320        OR DE-REI-AHAMT NOT = ZERO
 13321        OR DE-REI-AHPRM NOT = ZERO
 13322         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13323                 2599-WRT-DETAIL-X
 13324         ADD +1 TO BC-R-ISS.
 13325
 13326     ADD +1 TO SUB1.
 13327     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13328     PERFORM EXTRACT-DATE-LOAD.
 13329
 13330     GO TO 3110-REINSURE-ISSUE-LOOP.
 13331
 13332 3119-REINSURE-ISSUE-LOOP-END.
 13333     EXIT.
 13334
 13335 3190-REINSURE-ISSUE-PRINT.
 13336
 13337     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13338     IF RW-ACCUM-LF NOT = ZERO
 13339         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13340         MOVE CR-LF-TERM               TO TRD-LFTRM
 13341         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13342         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13343     IF RW-ACCUM-AH NOT = ZERO
 13344         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13345         MOVE CR-AH-TERM               TO TRD-AHTRM
 13346         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13347         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13348     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13349         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13350
 13351 3199-REINSURE-ISSUE-X.
 13352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 258
* ECS010.cbl
 13354******************************************************************
 13355***               R E I N S U R E   C A N C E L S              ***
 13356******************************************************************
 13357
 13358 3200-REINSURE-CANCEL.
 13359
 13360     IF REIN-COMP (1) = SPACES
 13361         GO TO 3299-REINSURE-CANCEL-X.
 13362
 13363     IF CR-LFRFND = ZERO
 13364        AND CR-AHRFND = ZERO
 13365         GO TO 3299-REINSURE-CANCEL-X.
 13366
 13367     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13368             VARYING SUB1 FROM +1 BY +1 UNTIL
 13369                       REIN-COMP (SUB1) = SPACES.
 13370
 13371     IF REIN-RT-SW = 'X'
 13372         GO TO 3299-REINSURE-CANCEL-X.
 13373
 13374     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13375     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13376     MOVE 'R'      TO DE-REIN.
 13377*****PERFORM EXTRACT-DATE-RELOAD.
 13378     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13379     MOVE +1       TO SUB1.
 13380
 13381 3210-REINSURE-CANCEL-LOOP.
 13382
 13383     IF REIN-COMP (SUB1) = SPACES
 13384         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13385
 13386     IF REIN-REM-SW (SUB1) = 'Z'
 13387         ADD +1        TO SUB1
 13388         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13389         PERFORM EXTRACT-DATE-LOAD
 13390         GO TO 3210-REINSURE-CANCEL-LOOP.
 13391
 13392     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13393     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13394
 13395     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13396     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13397     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13398     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13399     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13400     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13401     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13402     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13403     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13404
 13405     IF REIN-REM-SW (SUB1) NOT = 'I'
 13406         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13407
 13408     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13409        VOIDING-LF-CANCEL
 13410         NEXT SENTENCE
 13411     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 259
* ECS010.cbl
 13412         MOVE ZEROS             TO DE-REI-LFRFND.
 13413
 13414     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13415        VOIDING-AH-CANCEL
 13416         NEXT SENTENCE
 13417     ELSE
 13418         MOVE ZEROS             TO DE-REI-AHRFND.
 13419
 13420 3215-CONTINUE-CANCEL-LOOP.
 13421
 13422     IF RWF-LF-RUNOFF-SW = 'N'
 13423         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13424             MOVE ZEROS         TO DE-LF-TYPE
 13425                                   DE-REI-LFAMT
 13426                                   DE-REI-LFPRM
 13427                                   DE-REI-LFRFND
 13428                                   DE-REI-CNAMT.
 13429
 13430     IF RWF-AH-RUNOFF-SW = 'N'
 13431         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13432             MOVE ZEROS         TO DE-AH-TYPE
 13433                                   DE-REI-AHAMT
 13434                                   DE-REI-AHPRM
 13435                                   DE-REI-AHRFND.
 13436
 13437     IF DE-REI-LFAMT NOT = ZERO
 13438        OR DE-REI-LFPRM NOT = ZERO
 13439        OR DE-REI-AHAMT NOT = ZERO
 13440        OR DE-REI-AHPRM NOT = ZERO
 13441        OR DE-REI-LFRFND NOT = ZERO
 13442        OR DE-REI-AHRFND NOT = ZERO
 13443        OR DE-REI-CNAMT NOT = ZERO
 13444         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13445                                            2599-WRT-DETAIL-X
 13446         ADD +1 TO BC-R-CNC.
 13447
 13448     ADD +1 TO SUB1.
 13449     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13450     PERFORM EXTRACT-DATE-LOAD.
 13451     GO TO 3210-REINSURE-CANCEL-LOOP.
 13452
 13453 3219-REINSURE-CANCEL-LOOP-END.
 13454     EXIT.
 13455
 13456 3290-REINSURE-CANCEL-PRINT.
 13457
 13458     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13459     IF RW-ACCUM-LF NOT = ZERO
 13460         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13461         MOVE CR-LF-TERM               TO TRD-LFTRM
 13462         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13463         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13464     IF RW-ACCUM-AH NOT = ZERO
 13465         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13466         MOVE CR-AH-TERM               TO TRD-AHTRM
 13467         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13468         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13469     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 260
* ECS010.cbl
 13470         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13471
 13472 3299-REINSURE-CANCEL-X.
 13473     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 261
* ECS010.cbl
 13475******************************************************************
 13476***                R E I N S U R E   C L A I M S               ***
 13477******************************************************************
 13478
 13479 3300-REINSURE-CLAIM.
 13480
 13481*    IF DTE-CLIENT = '???'
 13482*       IF (REIN-RT-SW NOT = 'X')  AND
 13483*          (PC-PAYMENT-TYPE = '5' OR '6')
 13484*        GO TO 3399-REINSURE-CLAIM-X.
 13485
 13486     IF REIN-COMP (1) = SPACES
 13487         GO TO 3399-REINSURE-CLAIM-X.
 13488
 13489     IF REIN-RT-SW = 'X'
 13490         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13491         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13492         MOVE CR-DISAMT   TO RW-AHCLMWK
 13493         ADD  CR-DISEXP   TO RW-AHCLMWK
 13494     ELSE
 13495         IF PC-CLAIM-TYPE  = 1 OR 3
 13496             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13497             MOVE +0                  TO RW-AHCLMWK
 13498         ELSE
 13499             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13500             MOVE +0                  TO RW-LFCLMWK.
 13501
 13502     MOVE +0                          TO RW-LFCLM
 13503                                         RW-AHCLM.
 13504     IF RW-LFCLMWK = ZERO
 13505        AND RW-AHCLMWK = ZERO
 13506         GO TO 3399-REINSURE-CLAIM-X.
 13507
 13508     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13509         VARYING SUB1 FROM +1 BY +1
 13510             UNTIL REIN-COMP (SUB1) = SPACES.
 13511
 13512     IF REIN-RT-SW = 'X'
 13513         GO TO 3399-REINSURE-CLAIM-X.
 13514
 13515     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13516     MOVE ZEROS                TO RW-ACCUM-CLM.
 13517     MOVE 'R'                  TO DE-REIN.
 13518*****PERFORM EXTRACT-DATE-RELOAD.
 13519     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13520     MOVE +1                   TO SUB1.
 13521
 13522 3310-REINSURE-CLAIM-LOOP.
 13523
 13524     IF REIN-COMP (SUB1) = SPACES
 13525         GO TO 3390-REINSURE-CLAIM-PRINT.
 13526
 13527     IF REIN-REM-SW (SUB1) = 'Z'
 13528         ADD +1        TO SUB1
 13529         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13530         PERFORM EXTRACT-DATE-LOAD
 13531         GO TO 3310-REINSURE-CLAIM-LOOP.
 13532
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 262
* ECS010.cbl
 13533     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13534     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13535
 13536     IF PC-CLAIM-TYPE  = 1 OR 3
 13537         IF RWF-LF-RUNOFF-SW = 'N'
 13538           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13539               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13540
 13541     IF PC-CLAIM-TYPE  = 2 OR 4
 13542         IF RWF-AH-RUNOFF-SW = 'N'
 13543           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13544               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13545
 13546     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13547     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13548     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13549     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13550
 13551     IF PC-CLAIM-TYPE  = 1 OR 3
 13552         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13553         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13554     ELSE
 13555         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13556         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13557
 13558     IF PC-CLAIM-TYPE = 1 OR 3
 13559         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13560            AND DE-REI-CLAIM-AMT
 13561             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13562         ELSE
 13563             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13564     ELSE
 13565         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13566            AND DE-REI-CLAIM-AMT
 13567             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13568         ELSE
 13569             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13570
 13571 3320-REINSURE-CLAIM-LOOP-GO.
 13572
 13573     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13574     ADD +1                     TO BC-R-CLM.
 13575
 13576 3330-REINSURE-CLAIM-LOOP-ADD.
 13577
 13578     ADD +1                     TO SUB1.
 13579     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13580     PERFORM EXTRACT-DATE-LOAD.
 13581     GO TO 3310-REINSURE-CLAIM-LOOP.
 13582
 13583 3390-REINSURE-CLAIM-PRINT.
 13584
 13585     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13586     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13587         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13588         MOVE CR-LF-TERM               TO TRD-LFTRM
 13589         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13590         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 263
* ECS010.cbl
 13591     ELSE
 13592         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13593         MOVE CR-AH-TERM               TO TRD-AHTRM
 13594         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13595         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13596         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13597         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13598         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13599         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13600     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13601
 13602 3399-REINSURE-CLAIM-X.
 13603     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 264
* ECS010.cbl
 13605******************************************************************
 13606***              R E I N S U R E   R E S E R V E S             ***
 13607******************************************************************
 13608
 13609 3400-REINSURE-RESERVE.
 13610
 13611     IF REIN-COMP (1) = SPACES
 13612         GO TO 3499-REINSURE-RESERVE-X.
 13613
 13614     IF PC-CLAIM-TYPE = '1' OR '3'
 13615         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13616         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13617         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13618         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13619         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13620     ELSE
 13621         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13622         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13623         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13624         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13625         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13626
 13627     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13628                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13629     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13630         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13631          GO TO 3499-REINSURE-RESERVE-X.
 13632
 13633     IF DTE-CLIENT NOT = 'MIC'
 13634         GO TO 3405-REINSURE-RESERVE-CONT.
 13635
 13636     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13637         GO TO 3405-REINSURE-RESERVE-CONT.
 13638
 13639     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13640     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13641     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13642     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13643                                        CP-CLAIM-TYPE.
 13644     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13645     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13646     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13647     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13648     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13649     MOVE '3'                        TO CP-CDT-METHOD.
 13650     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13651     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13652                                        CP-RATING-BENEFIT-AMT.
 13653     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13654     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13655
 13656 3405-REINSURE-RESERVE-CONT.
 13657
 13658     PERFORM 3500-REINSURE-CALC-RESERVE
 13659         THRU 3599-REINSURE-CALC-RESERVE-X
 13660             VARYING SUB1 FROM +1 BY +1
 13661                 UNTIL REIN-COMP (SUB1) = SPACES.
 13662
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 265
* ECS010.cbl
 13663     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13664     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13665     MOVE 'R'            TO DE-REIN.
 13666*****PERFORM EXTRACT-DATE-RELOAD.
 13667     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13668     MOVE +1             TO SUB1.
 13669
 13670 3410-REINSURE-RESERVE-LOOP.
 13671
 13672     IF REIN-COMP (SUB1) = SPACES
 13673         GO TO 3490-REINSURE-RESERVE-PRINT.
 13674
 13675     IF REIN-REM-SW (SUB1) = 'Z'
 13676         ADD +1 TO SUB1
 13677         GO TO 3410-REINSURE-RESERVE-LOOP.
 13678
 13679     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13680     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13681
 13682     IF PC-CLAIM-TYPE  = 1 OR 3
 13683         IF RWF-LF-RUNOFF-SW = 'N'
 13684           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13685               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13686
 13687     IF PC-CLAIM-TYPE  = 2 OR 4
 13688         IF RWF-AH-RUNOFF-SW = 'N'
 13689           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13690               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13691
 13692     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13693     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13694     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13695     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13696
 13697     IF PC-CLAIM-TYPE = 1 OR 3
 13698         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13699         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13700         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13701     ELSE
 13702         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13703         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13704         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13705
 13706     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13707     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13708     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13709
 13710     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13711        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13712        OR DE-REI-FUTRSV
 13713         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13714                                            2599-WRT-DETAIL-X
 13715         ADD +1 TO BC-R-CRS.
 13716
 13717 3415-REINSURE-RESERVE-LOOP-ADD.
 13718
 13719     ADD +1 TO SUB1.
 13720     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 266
* ECS010.cbl
 13721     PERFORM EXTRACT-DATE-LOAD.
 13722     GO TO 3410-REINSURE-RESERVE-LOOP.
 13723
 13724 3490-REINSURE-RESERVE-PRINT.
 13725
 13726     IF RW-ACCUM-IBNR   = ZERO  AND
 13727        RW-ACCUM-PAYCUR = ZERO  AND
 13728        RW-ACCUM-FUTRSV = ZERO
 13729         GO TO 3499-REINSURE-RESERVE-X.
 13730
 13731     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13732     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13733     MOVE 'IBNR'                    TO TRD-IBNRX.
 13734     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13735     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13736     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13737     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13738
 13739     IF PC-CLAIM-TYPE = 1
 13740         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13741     ELSE
 13742         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13743     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13744
 13745     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13746
 13747 3499-REINSURE-RESERVE-X.
 13748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 267
* ECS010.cbl
 13750******************************************************************
 13751***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13752******************************************************************
 13753
 13754 3500-REINSURE-CALC-RESERVE.
 13755
 13756     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13757     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13758                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13759
 13760     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13761        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13762          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13763       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13764
 13765     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13766        MOVE ZERO TO CO-SUB.
 13767
 13768     IF CO-SUB NOT = ZERO
 13769        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13770           IF PC-CLAIM-TYPE = '1' OR '3'
 13771             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13772                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13773
 13774     IF PC-CLAIM-TYPE  = 1 OR 3
 13775         IF RWF-LF-RUNOFF-SW = 'N'
 13776           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13777               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13778
 13779     IF CO-SUB NOT = ZERO
 13780        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13781           IF PC-CLAIM-TYPE = '2' OR '4'
 13782             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13783                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13784
 13785     IF PC-CLAIM-TYPE  = 2 OR 4
 13786         IF RWF-AH-RUNOFF-SW = 'N'
 13787           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13788               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13789
 13790     IF DTE-CLIENT NOT = 'MIC'
 13791         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13792
 13793     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13794         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13795
 13796     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13797
 13798     IF CR-AHTYP = ZERO  OR
 13799        CO-SUB = ZERO
 13800         GO TO 3505-REIN-CALC-RESERVE-CONT
 13801     ELSE
 13802         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13803             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13804
 13805     COMPUTE MAX-REM-TERM ROUNDED =
 13806                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13807
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 268
* ECS010.cbl
 13808     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13809         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13810
 13811     COMPUTE CP-ORIGINAL-TERM =
 13812                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13813
 13814     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13815
 13816     IF  CP-RETURN-CODE = ZERO
 13817         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13818
 13819 3505-REIN-CALC-RESERVE-CONT.
 13820
 13821     IF SUB1 = RE-100-COMP
 13822         GO TO 3520-REIN-REMAINDER-RSRV.
 13823
 13824     IF CR-LFAMT NOT = ZERO  AND
 13825        RWF-LFAMT NOT = ZERO
 13826         IF DTE-CLIENT NOT = 'MIC'
 13827             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13828                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13829             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13830                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13831             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13832                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13833         ELSE
 13834             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13835             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13836             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13837
 13838     IF CR-AHAMT NOT = ZERO  AND
 13839        RWF-AHAMT NOT = ZERO
 13840         IF DTE-CLIENT NOT = 'MIC'
 13841             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13842                         RWF-AHAMT) / CR-AHAMT
 13843             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13844                         RWF-AHAMT) / CR-AHAMT
 13845             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13846                         RWF-AHAMT) / CR-AHAMT
 13847         ELSE
 13848             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13849             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13850             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13851
 13852 3510-REINSURE-CALC-RESERVE-ADD.
 13853
 13854     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13855     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13856     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13857     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13858     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13859     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13860
 13861     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13862         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13863
 13864     IF CO-SUB = ZERO
 13865         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 269
* ECS010.cbl
 13866
 13867 3513-REIN-CHK-LF-RSRV-LIMIT.
 13868     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13869         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13870
 13871     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13872         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13873
 13874     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13875                                      (RWF-LFCLM +
 13876                                       RWF-DTH-PAYCUR +
 13877                                       RWF-DTH-FUTRSV).
 13878
 13879     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13880         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13881
 13882     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13883
 13884     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13885         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13886         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13887     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13888         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13889
 13890     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13891
 13892     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13893         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13894         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13895     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13896         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13897
 13898 3515-REIN-CHK-AH-RSRV-LIMIT.
 13899     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13900         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13901
 13902     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13903         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13904
 13905     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13906                                      (RWF-AHCLM +
 13907                                       RWF-DIS-PAYCUR +
 13908                                       RWF-DIS-FUTRSV).
 13909
 13910     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13911         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13912
 13913     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13914
 13915     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13916         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13917         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13918     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13919         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13920
 13921     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13922
 13923     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 270
* ECS010.cbl
 13924         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13925         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13926     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13927         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13928
 13929 3519-REINSURE-CALC-RESERVE-END.
 13930
 13931     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13932        OR RWF-DTH-FUTRSV
 13933         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13934
 13935     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13936        OR RWF-DIS-FUTRSV
 13937         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13938
 13939     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13940
 13941 3520-REIN-REMAINDER-RSRV.
 13942
 13943     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13944     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13945     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13946     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13947     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13948     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13949
 13950     PERFORM 3530-REIN-SUB-RSRV
 13951         THRU 3539-REIN-SUB-RSRV-X
 13952             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13953
 13954     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13955
 13956 3530-REIN-SUB-RSRV.
 13957
 13958     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13959     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13960     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13961     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13962     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13963     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13964
 13965 3539-REIN-SUB-RSRV-X.
 13966     EXIT.
 13967
 13968 3540-CONT-REIN-CALC-RESERVE.
 13969
 13970     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13971         MOVE 'X' TO REIN-BUS-FLAG.
 13972     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13973
 13974 3599-REINSURE-CALC-RESERVE-X.
 13975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 271
* ECS010.cbl
 13977******************************************************************
 13978***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13979******************************************************************
 13980
 13981*REINSURANCE-CALCULATIONS.
*13982                             COPY ECSRIRTN.
 13983******************************************************************04/30/98
 13984*                                                                *ECSRIRTN
 13985*                            ECSRIRTN                            *   LV012
 13986*                            VMOD=2.025.                         *ECSRIRTN
 13987*                                                                *ECSRIRTN
 13988******************************************************************ECSRIRTN
 13989******************************************************************
 13990*                   C H A N G E   L O G
 13991*
 13992* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13993*-----------------------------------------------------------------
 13994*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13995* EFFECTIVE    NUMBER
 13996*-----------------------------------------------------------------
 13997* 062703                   PEMA  ADD DCC CLIENT ID TO
 13998*                                SPECIAL CEDED CLAIM CALC
 13999* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 14000* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 14001                                                                  ECSRIRTN
 14002 REINSURE-CALC.                                                   ECSRIRTN
 14003                                                                  ECSRIRTN
 14004     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 14005     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14006     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 14007     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 14008                                   REIN-REM-SW (SUB1).            ECSRIRTN
 14009                                                                  ECSRIRTN
 14010     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 14011                                   WS-RWF-EP-STOP-DATE-N             CL*12
 14012                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 14013                                                                  ECSRIRTN
 14014     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14015                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 14016                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 14017                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14018                                                                  ECSRIRTN
 14019     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14020        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14021          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14022          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14023          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14024                                                                  ECSRIRTN
 14025     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14026        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14027         GO TO CALC-CONTINUED.                                    ECSRIRTN
 14028                                                                  ECSRIRTN
 14029     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 14030                                          WS-RWF-EP-STOP-DATE-N      CL*12
 14031                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 14032                                                                  ECSRIRTN
 14033     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 14034         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 272
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14035                                                                  ECSRIRTN
 14036     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 14037         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14038                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14039                                                                  ECSRIRTN
 14040     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14041         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14042                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14043                                                                  ECSRIRTN
 14044 CALC-CONTINUED.                                                  ECSRIRTN
 14045                                                                  ECSRIRTN
 14046     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14047     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14048                                                                  ECSRIRTN
 14049     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14050         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14051     ELSE                                                         ECSRIRTN
 14052         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14053     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14054                                                                  ECSRIRTN
 14055     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14056     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14057     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14058         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14059     ELSE                                                         ECSRIRTN
 14060         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14061     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14062                                                                  ECSRIRTN
 14063     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14064         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14065         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14066         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14067         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14068         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14069         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14070                                                                  ECSRIRTN
 14071     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14072         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14073                                                                  ECSRIRTN
 14074     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14075         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14076                                                                  ECSRIRTN
 14077     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14078         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14079                                                                  ECSRIRTN
 14080     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14081     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14082                                                                  ECSRIRTN
 14083     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14084         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14085                                                                  ECSRIRTN
 14086     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14087       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14088        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14089        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14090           NEXT SENTENCE                                          ECSRIRTN
 14091       ELSE                                                       ECSRIRTN
 14092           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 273
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14093                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 14094                                                                  ECSRIRTN
 14095     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14096         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14097            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14098             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14099                                                                  ECSRIRTN
 14100     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14101         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14102            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14103             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14104                                                                  ECSRIRTN
 14105     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14106         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14107             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14108                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14109             ELSE                                                 ECSRIRTN
 14110                 NEXT SENTENCE                                    ECSRIRTN
 14111         ELSE                                                     ECSRIRTN
 14112             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14113                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14114                                                                  ECSRIRTN
 14115     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14116         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14117             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14118                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14119             ELSE                                                 ECSRIRTN
 14120                 NEXT SENTENCE                                    ECSRIRTN
 14121         ELSE                                                     ECSRIRTN
 14122             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14123                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14124                                                                  ECSRIRTN
 14125     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14126         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14127                                                                  ECSRIRTN
 14128     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14129         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14130         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14131                                                                  ECSRIRTN
 14132     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14133         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14134                                                                  ECSRIRTN
 14135     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14136         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14137         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14138                                                                  ECSRIRTN
 14139     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14140         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14141                                                                  ECSRIRTN
 14142     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14143         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14144                                                                  ECSRIRTN
 14145     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14146                                                                  ECSRIRTN
 14147 REINSURE-CK-LIFE.                                                ECSRIRTN
 14148                                                                  ECSRIRTN
 14149     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14150         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 274
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14151                                                                  ECSRIRTN
 14152     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14153         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14154                                                                  ECSRIRTN
 14155     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14156         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14157             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14158                                                                  ECSRIRTN
 14159     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14160                                                                  ECSRIRTN
 14161     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14162         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14163             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14164         ELSE                                                     ECSRIRTN
 14165             NEXT SENTENCE                                        ECSRIRTN
 14166     ELSE                                                         ECSRIRTN
 14167         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14168             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14169                                                                  ECSRIRTN
 14170     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14171         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14172             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14173         ELSE                                                     ECSRIRTN
 14174             NEXT SENTENCE                                        ECSRIRTN
 14175     ELSE                                                         ECSRIRTN
 14176         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14177             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14178                                                                  ECSRIRTN
 14179     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14180         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14181             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14182                                                                  ECSRIRTN
 14183     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14184         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14185            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14186                                                                  ECSRIRTN
 14187     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14188         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14189             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14190                                                                  ECSRIRTN
 14191     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14192         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14193            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14194                                                                  ECSRIRTN
 14195     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14196         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14197             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14198                                                                  ECSRIRTN
 14199     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14200         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14201            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14202            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14203             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14204                                                                  ECSRIRTN
 14205     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14206         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14207            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14208             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 275
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14209                                                                  ECSRIRTN
 14210     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14211         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14212             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14213                                                                  ECSRIRTN
 14214     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14215         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14216             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14217                                                                  ECSRIRTN
 14218     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14219        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14220           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14221            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14222                                                                  ECSRIRTN
 14223     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14224         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14225            CR-IND-GRP = '1'                                      ECSRIRTN
 14226             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14227                                                                  ECSRIRTN
 14228     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14229         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14230            CR-IND-GRP = '1'                                      ECSRIRTN
 14231             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14232                                                                  ECSRIRTN
 14233     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14234         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14235            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14236            CR-IND-GRP = '1'                                      ECSRIRTN
 14237             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14238                                                                  ECSRIRTN
 14239     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14240         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14241            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14242            CR-IND-GRP = '1'                                      ECSRIRTN
 14243             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14244                                                                  ECSRIRTN
 14245     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14246         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14247            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14248                                                                  ECSRIRTN
 14249     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14250        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14251                                                                  ECSRIRTN
 14252     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14253         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14254                                                                  ECSRIRTN
 14255     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14256         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14257                                                                  ECSRIRTN
 14258     IF CR-LF-TERM  NUMERIC                                       00002331
 14259        NEXT SENTENCE                                             00002332
 14260     ELSE                                                         00002333
 14261        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14262     END-IF
 14263                                                                  00002335
 14264     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14265         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14266                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 276
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14267     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 14268         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14269                                                                  ECSRIRTN
 14270     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14273         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14274                                                                  ECSRIRTN
 14275     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14276         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14277                                                                  ECSRIRTN
 14278     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14279                                                                  ECSRIRTN
 14280 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14281     EXIT.                                                        ECSRIRTN
 14282                                                                  ECSRIRTN
 14283 REINSURE-CK-AH.                                                  ECSRIRTN
 14284                                                                  ECSRIRTN
 14285     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14286         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14287                                                                  ECSRIRTN
 14288     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14289         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14290                                                                  ECSRIRTN
 14291     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14292         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14293             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14294                                                                  ECSRIRTN
 14295     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14296                                                                  ECSRIRTN
 14297     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14298         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14299             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14300         ELSE                                                     ECSRIRTN
 14301             NEXT SENTENCE                                        ECSRIRTN
 14302     ELSE                                                         ECSRIRTN
 14303         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14304             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14305                                                                  ECSRIRTN
 14306     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14307         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14308             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14309                                                                  ECSRIRTN
 14310     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14311         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14312             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14313                                                                  ECSRIRTN
 14314     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14315         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14316             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14317                                                                  ECSRIRTN
 14318     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14319         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14320             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14321                                                                  ECSRIRTN
 14322     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14323         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14324            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 277
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14325             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14326                                                                  ECSRIRTN
 14327     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14328         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14329             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14330                                                                  ECSRIRTN
 14331     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14332         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14333            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14334                                                                  ECSRIRTN
 14335     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14336         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14337            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14338                                                                  ECSRIRTN
 14339     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14340         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14341             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14342                                                                  ECSRIRTN
 14343     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14344        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14345                                                                  ECSRIRTN
 14346     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14347         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14348                                                                  ECSRIRTN
 14349     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14350         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14351                                                                  ECSRIRTN
 14352     IF CR-AH-TERM  NUMERIC                                       00002331
 14353        NEXT SENTENCE                                             00002332
 14354     ELSE                                                         00002333
 14355        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14356     END-IF
 14357                                                                  00002335
 14358     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14359         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14360                                                                  ECSRIRTN
 14361     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14362         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14363                                                                  ECSRIRTN
 14364     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14365                                                                  ECSRIRTN
 14366     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14367         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14368             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14369                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14370                                                                  ECSRIRTN
 14371     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14372         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14373             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14374                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14375                                                                  ECSRIRTN
 14376     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14377     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14378                                                                  ECSRIRTN
 14379     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14380         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14381                                                                  ECSRIRTN
 14382     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 278
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14383         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 14384                                                                  ECSRIRTN
 14385     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14386                                                                  ECSRIRTN
 14387     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14388                                                                  ECSRIRTN
 14389     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14390         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14391                                                                  ECSRIRTN
 14392     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14393         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14394                                                                  ECSRIRTN
 14395     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14396                                                                  ECSRIRTN
 14397 REINSURE-CK-AH-X.                                                ECSRIRTN
 14398     EXIT.                                                        ECSRIRTN
 14399                                                                  ECSRIRTN
 14400 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14401                                                                  ECSRIRTN
 14402     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14403        RS-AH-BEN = ZERO                                          ECSRIRTN
 14404         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14405                                                                  ECSRIRTN
 14406     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14407        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14408         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14409                                                                  ECSRIRTN
 14410     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14411                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14412                                                                  ECSRIRTN
 14413     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14414         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14415             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14416                                     WT-AHBEN-HI.                 ECSRIRTN
 14417     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14418         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14419             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14420                                     WT-AHMOA-HI.                 ECSRIRTN
 14421                                                                  ECSRIRTN
 14422     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14423     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14424                                                                  ECSRIRTN
 14425     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14426         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14427                                                                  ECSRIRTN
 14428     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14429         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14430                                                                  ECSRIRTN
 14431     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14432                                                                  ECSRIRTN
 14433     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14434         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14435                                                                  ECSRIRTN
 14436     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14437         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14438                                       / RW-AHWRK                 ECSRIRTN
 14439       ELSE                                                       ECSRIRTN
 14440         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 279
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14441                                                                  ECSRIRTN
 14442     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14443         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14444                                       / RS-LIFE-BEN              ECSRIRTN
 14445       ELSE                                                       ECSRIRTN
 14446         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14447                                                                  ECSRIRTN
 14448     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14449        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14450          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14451          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14452                                      / CR-AH-TERM.               ECSRIRTN
 14453                                                                  ECSRIRTN
 14454     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14455        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14456          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14457          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14458               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14459            ELSE                                                  ECSRIRTN
 14460                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14461                                                                  ECSRIRTN
 14462     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14463        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14464        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14465          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14466          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14467                                      / CR-AH-TERM                ECSRIRTN
 14468         ELSE                                                     ECSRIRTN
 14469          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14470          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14471               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14472            ELSE                                                  ECSRIRTN
 14473                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14474                                                                  ECSRIRTN
 14475 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14476     EXIT.                                                        ECSRIRTN
 14477                                                                  ECSRIRTN
 14478                                                                  ECSRIRTN
 14479 REIN-CALC-LIFE.                                                  ECSRIRTN
 14480                                                                  ECSRIRTN
 14481     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14482         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14483     ELSE                                                         ECSRIRTN
 14484         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14485                                                                  ECSRIRTN
 14486     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14487         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14488     ELSE                                                         ECSRIRTN
 14489         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14490           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14491               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14492           ELSE                                                   ECSRIRTN
 14493               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14494                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14495                                                                  ECSRIRTN
 14496 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14497                                                                  ECSRIRTN
 14498     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 280
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14499                                                                  ECSRIRTN
 14500     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14501         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14502                                                                  ECSRIRTN
 14503     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14504         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14505         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14506                                                                  ECSRIRTN
 14507     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14508         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14509                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14510         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14511                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14512     ELSE                                                         ECSRIRTN
 14513         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14514             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14515             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14516                                                                  ECSRIRTN
 14517     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14518         (WT-LF-QC = '2' AND                                         CL**8
 14519          PGM-SUB = +50  AND                                         CL**8
 14520          DTE-CLIENT = 'LAP'))                                       CL**8
 14521          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14522     ELSE                                                         ECSRIRTN
 14523         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14524                                                                  ECSRIRTN
 14525     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14526         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14527         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14528         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14529                                                                  ECSRIRTN
 14530     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14531                                                                  ECSRIRTN
 14532 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14533                                                                  ECSRIRTN
 14534     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14535         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14536         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14537                                                                  ECSRIRTN
 14538     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14539     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14540     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14541                                       RW-LFPRM.                  ECSRIRTN
 14542                                                                  ECSRIRTN
 14543 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14544                                                                  ECSRIRTN
 14545     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14546                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14547                                                                  ECSRIRTN
 14548     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14549        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14550                                                                  ECSRIRTN
 14551     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14552        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14553         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14554     ELSE                                                         ECSRIRTN
 14555         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14556         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 281
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14557                                                                  ECSRIRTN
 14558                                                                  ECSRIRTN
 14559 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14560     EXIT.                                                        ECSRIRTN
 14561                                                                  ECSRIRTN
 14562 REIN-CALC-AH.                                                    ECSRIRTN
 14563                                                                  ECSRIRTN
 14564     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14565         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14566             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14567                                 WT-AHBEN-HI.                     ECSRIRTN
 14568                                                                  ECSRIRTN
 14569     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14570         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14571             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14572                                 WT-AHMOA-HI.                     ECSRIRTN
 14573                                                                  ECSRIRTN
 14574     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14575     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14576                                                                  ECSRIRTN
 14577     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14578         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14579                                                                  ECSRIRTN
 14580     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14581         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14582                                                                  ECSRIRTN
 14583     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14584         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14585                                                                  ECSRIRTN
 14586     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14587         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14588     ELSE                                                         ECSRIRTN
 14589         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14590             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14591         ELSE                                                     ECSRIRTN
 14592             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14593             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14594                                                                  ECSRIRTN
 14595 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14596                                                                  ECSRIRTN
 14597     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14598         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14599                                                                  ECSRIRTN
 14600     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14601         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14602         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14603                                                                  ECSRIRTN
 14604     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14605         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14606                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14607         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14608                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14609     ELSE                                                         ECSRIRTN
 14610         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14611             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14612             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14613                                                                  ECSRIRTN
 14614     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 282
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14615         (WT-AH-QC = '2' AND                                         CL**8
 14616          PGM-SUB = +50  AND                                         CL**8
 14617          DTE-CLIENT = 'LAP'))                                       CL**8
 14618         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14619     ELSE                                                         ECSRIRTN
 14620         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14621                                                                  ECSRIRTN
 14622     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14623         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14624            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14625                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14626                                                                  ECSRIRTN
 14627     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14628         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14629         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14630         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14631                                                                  ECSRIRTN
 14632     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14633                                                                  ECSRIRTN
 14634 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14635                                                                  ECSRIRTN
 14636     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14637         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14638         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14639                                                                  ECSRIRTN
 14640     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14641     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14642     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14643                                    RW-AHPRM.                     ECSRIRTN
 14644                                                                  ECSRIRTN
 14645 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14646                                                                  ECSRIRTN
 14647     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14648                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14649                                                                  ECSRIRTN
 14650     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14651                                                                  ECSRIRTN
 14652     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14653        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14654         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14655     ELSE                                                         ECSRIRTN
 14656         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14657         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14658                                                                  ECSRIRTN
 14659                                                                  ECSRIRTN
 14660 REIN-CALC-AH-X.                                                  ECSRIRTN
 14661     EXIT.                                                        ECSRIRTN
 14662                                                                  ECSRIRTN
 14663 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14664                                                                  ECSRIRTN
 14665     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14666     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14667     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14668     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14669                                                                  ECSRIRTN
 14670     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14671         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14672                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 283
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14673     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 14674        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14675           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14676                                                                  ECSRIRTN
 14677     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14678        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14679           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14680                                                                  ECSRIRTN
 14681 REINSURE-CALC-X.                                                 ECSRIRTN
 14682                                                                  ECSRIRTN
 14683     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14684         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14685                                                                  ECSRIRTN
 14686     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14687                                                                  ECSRIRTN
 14688 REINSURE-SUBTRACT.                                               ECSRIRTN
 14689                                                                  ECSRIRTN
 14690     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14691     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14692     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14693     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14694                                                                  ECSRIRTN
 14695 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14696     EXIT.                                                        ECSRIRTN
 14697                                                                  ECSRIRTN
 14698 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14699                                                                  ECSRIRTN
 14700     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14701     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14702                                                                  ECSRIRTN
 14703     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14704         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14705                                                                  ECSRIRTN
 14706     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14707         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14708                                                                  ECSRIRTN
 14709     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14710         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14711             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14712                                                                  ECSRIRTN
 14713     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14714         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14715                                                                  ECSRIRTN
 14716     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14717         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14718         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14719                                                                  ECSRIRTN
 14720     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14721        MOVE ZERO                TO REIN-FACTOR
 14722     ELSE                                                         ECSRIRTN
 14723        IF DTE-CLIENT = 'GIC'  AND
 14724           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14725           MOVE +1.0             TO REIN-FACTOR
 14726        ELSE
 14727           IF DTE-CLIENT = 'DCC'
 14728              COMPUTE REIN-FACTOR = CR-LFRFND /
 14729                 (CR-LFPRM + CR-LFPRM-ALT)
 14730           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 284
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14731              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 14732                 (CR-LFPRM + CR-LFPRM-ALT)
 14733            END-IF
 14734         END-IF
 14735     END-IF
 14736                                                                  ECSRIRTN
 14737     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14738         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14739             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14740                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14741                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14742             ELSE                                                 ECSRIRTN
 14743                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14744                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14745                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14746                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14747         ELSE                                                     ECSRIRTN
 14748             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14749                 compute rein-factor rounded =
 14750                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14751                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 14752                    rein-factor
 14753             ELSE                                                 ECSRIRTN
 14754*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14755*                   * REIN-CALCED-LIFE *
 14756*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14757                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14758                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14759                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14760                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14761                                                                  ECSRIRTN
 14762     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14763         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14764             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14765                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14766                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14767             ELSE                                                 ECSRIRTN
 14768                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14769                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14770                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14771                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14772                                                                  ECSRIRTN
 14773     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14774                                                                  ECSRIRTN
 14775                                                                  ECSRIRTN
 14776 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14777                                                                  ECSRIRTN
 14778     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14779       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14780         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14781         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14782                                                                  ECSRIRTN
 14783     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14784       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14785           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14786           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14787       ELSE                                                       ECSRIRTN
 14788           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 285
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14789               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14790                                                                  ECSRIRTN
 14791     IF FLAT-CANCEL-LF                                            ECSRIRTN
 14792         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14793         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14794                                                                  ECSRIRTN
 14795     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14796         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14797         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14798                                                                  ECSRIRTN
 14799     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14800     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14801     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14802                                         RW-LFRFND.               ECSRIRTN
 14803                                                                  ECSRIRTN
 14804 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14805                                                                  ECSRIRTN
 14806     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14807                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14808                                                                  ECSRIRTN
 14809     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14810        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14811                                                                  ECSRIRTN
 14812     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14813        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14814         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14815     ELSE                                                         ECSRIRTN
 14816         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14817         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14818                                                                  ECSRIRTN
 14819                                                                  ECSRIRTN
 14820 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14821                                                                  ECSRIRTN
 14822     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14823         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14824                                                                  ECSRIRTN
 14825     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14826         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14827             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14828                                                                  ECSRIRTN
 14829     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14830         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14831         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14832             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14833                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14834         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14835                                                                  ECSRIRTN
 14836     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14837         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14838                                                                  ECSRIRTN
 14839     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14840         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14841         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14842                                                                  ECSRIRTN
 14843     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14844        MOVE ZERO                TO REIN-FACTOR
 14845     ELSE
 14846        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 286
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14847           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14848            MOVE +1.0            TO REIN-FACTOR
 14849        ELSE
 14850           IF DTE-CLIENT = 'DCC'
 14851              COMPUTE REIN-FACTOR =
 14852                 CR-AHRFND / CR-AHPRM
 14853           ELSE
 14854              COMPUTE REIN-FACTOR ROUNDED =
 14855                                CR-AHRFND-CALC / CR-AHPRM
 14856           END-IF
 14857        END-IF
 14858     END-IF
 14859
 14860     IF CR-AHAMT NOT = ZERO
 14861        IF (DTE-CLIENT = 'DCC')
 14862           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14863           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14864        ELSE
 14865           IF WT-AH-QC = ('1' OR '4')
 14866              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14867              compute rwf-ahrfnd rounded =
 14868                 cr-ahrfnd * rein-factor
 14869           ELSE
 14870              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14871              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14872                       RWF-AHAMT) / CR-AHAMT
 14873           END-IF
 14874        END-IF
 14875     ELSE
 14876        IF RWF-AH-LIMIT = ZERO
 14877           IF WT-AH-QC = ('1' OR '4')
 14878              COMPUTE RWF-AHRFND ROUNDED =
 14879                       CR-AHRFND * WT-AH-PCT
 14880           ELSE
 14881              COMPUTE RWF-AHRFND =
 14882                            REIN-FACTOR * REIN-CALCED-AH
 14883              COMPUTE RWF-AHRFND ROUNDED =
 14884                       RWF-AHRFND * WT-AH-PCT
 14885           END-IF
 14886        END-IF
 14887     END-IF
 14888
 14889     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14890                                                                  ECSRIRTN
 14891                                                                  ECSRIRTN
 14892 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14893                                                                  ECSRIRTN
 14894     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14895       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14896         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14897         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14898                                                                  ECSRIRTN
 14899     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14900       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14901           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14902           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14903       ELSE                                                       ECSRIRTN
 14904           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 287
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14905               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14906                                                                  ECSRIRTN
 14907     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14908         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14909         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14910                                                                  ECSRIRTN
 14911     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14912         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14913         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14914                                                                  ECSRIRTN
 14915     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14916     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14917     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14918                                    RW-AHRFND.                    ECSRIRTN
 14919                                                                  ECSRIRTN
 14920 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14921                                                                  ECSRIRTN
 14922     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14923                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14924                                                                  ECSRIRTN
 14925     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14926                                                                  ECSRIRTN
 14927     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14928        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14929         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14930     ELSE                                                         ECSRIRTN
 14931         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14932         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14933                                                                  ECSRIRTN
 14934                                                                  ECSRIRTN
 14935 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14936                                                                  ECSRIRTN
 14937     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14938         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14939                                                                  ECSRIRTN
 14940     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14941         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14942                                                                  ECSRIRTN
 14943     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14944                                                                  ECSRIRTN
 14945 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14946                                                                  ECSRIRTN
 14947     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14948     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14949                                                                  ECSRIRTN
 14950     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14951         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14952             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14953                                                                  ECSRIRTN
 14954     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14955         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14956                                                                  ECSRIRTN
 14957     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14958         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14959                                                                  ECSRIRTN
 14960 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14961                                                                  ECSRIRTN
 14962     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 288
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 14963         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14964                                                                  ECSRIRTN
 14965     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14966                                                                  ECSRIRTN
 14967 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14968                                                                  ECSRIRTN
 14969     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14970     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14971                                                                  ECSRIRTN
 14972 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14973     EXIT.                                                        ECSRIRTN
 14974                                                                  ECSRIRTN
 14975 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14976                                                                  ECSRIRTN
 14977     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14978         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14979                                                                  ECSRIRTN
 14980 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14981     EXIT.                                                        ECSRIRTN
 14982                                                                  ECSRIRTN
 14983 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14984                                                                  ECSRIRTN
 14985     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14986     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14987                                                                  ECSRIRTN
 14988     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14989         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14990                                                                  ECSRIRTN
 14991     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14992        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14993          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14994          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14995          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14996                                                                  ECSRIRTN
 14997     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14998        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14999          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 15000                                                                  ECSRIRTN
 15001     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 15002                                  RWF-AHCLML.                     ECSRIRTN
 15003                                                                  ECSRIRTN
 15004     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15005         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15006                                                                  ECSRIRTN
 15007     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 15008         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15009                                                                  ECSRIRTN
 15010     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15011         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15012             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 15013                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15014                                                                  ECSRIRTN
 15015     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 15016         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15017                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15018                                                                  ECSRIRTN
 15019     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15020         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 289
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15021                                                                  ECSRIRTN
 15022     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15023         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15024             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 15025                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15026             ELSE                                                 ECSRIRTN
 15027                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 15028         ELSE                                                     ECSRIRTN
 15029             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 15030                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 15031                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15032             ELSE                                                 ECSRIRTN
 15033                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 15034                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 15035                                                                  ECSRIRTN
 15036     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15037         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15038                                                                  ECSRIRTN
 15039     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 15040         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 15041            OR 'DCC'
 15042             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15043                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15044         ELSE                                                     ECSRIRTN
 15045             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15046                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15047                                                                  ECSRIRTN
 15048     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15049         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15050             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15051                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15052                                                                  ECSRIRTN
 15053     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15054         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15055             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15056                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15057                                                                  ECSRIRTN
 15058     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15059         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15060             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15061               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15062                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15063                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15064                  ELSE                                            ECSRIRTN
 15065                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15066                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15067              ELSE                                                ECSRIRTN
 15068                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15069                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15070                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15071                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15072                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15073                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15074                                                                  ECSRIRTN
 15075     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15076                                                                  ECSRIRTN
 15077     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15078                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 290
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15079                                                                  ECSRIRTN
 15080 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15081                                                                  ECSRIRTN
 15082     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 15083         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15084                                                                  ECSRIRTN
 15085     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15086         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15087     ELSE                                                         ECSRIRTN
 15088         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15089                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15090                                                                  ECSRIRTN
 15091     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15092         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15093                                                                  ECSRIRTN
 15094     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15095         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15096             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15097         ELSE                                                     ECSRIRTN
 15098             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15099     ELSE                                                         ECSRIRTN
 15100         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15101             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15102             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15103         ELSE                                                     ECSRIRTN
 15104             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15105             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15106                                                                  ECSRIRTN
 15107                                                                  ECSRIRTN
 15108 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15109                                                                  ECSRIRTN
 15110     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15111         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15112                                                                  ECSRIRTN
 15113     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15114         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15115                                                                  ECSRIRTN
 15116     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15117         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15118                                                                  ECSRIRTN
 15119     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15120     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15121                                                                  ECSRIRTN
 15122     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15123             VARYING                                              ECSRIRTN
 15124         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15125             UNTIL                                                ECSRIRTN
 15126         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15127                                                                  ECSRIRTN
 15128     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15129         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15130     ELSE                                                         ECSRIRTN
 15131         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15132                                                                  ECSRIRTN
 15133 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15134                                                                  ECSRIRTN
 15135     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15136         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 291
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15137                                                                  ECSRIRTN
 15138     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15139       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15140           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 15141                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15142               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15143                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15144               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15145                                                                  ECSRIRTN
 15146     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15147       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15148           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15149                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15150           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15151                                                                  ECSRIRTN
 15152     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15153         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15154                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15155                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15156         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15157                                                                  ECSRIRTN
 15158     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15159         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15160                                                                  ECSRIRTN
 15161     IF INC-SUB = +1                                              ECSRIRTN
 15162         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15163     IF INC-SUB = +2                                              ECSRIRTN
 15164         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15165     IF INC-SUB = +3                                              ECSRIRTN
 15166         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15167     IF INC-SUB = +4                                              ECSRIRTN
 15168         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15169     IF INC-SUB = +5                                              ECSRIRTN
 15170         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15171                                                                  ECSRIRTN
 15172     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15173                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15174                                                                  ECSRIRTN
 15175     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15176         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15177                                                                  ECSRIRTN
 15178     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15179              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15180         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15181     ELSE                                                         ECSRIRTN
 15182         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15183                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15184                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15185                                                                  ECSRIRTN
 15186 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15187      EXIT.                                                       ECSRIRTN
 15188                                                                  ECSRIRTN
 15189 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15190                                                                  ECSRIRTN
 15191     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15192         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15193                                                                  ECSRIRTN
 15194     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 292
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15195         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15196             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15197                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15198                                                                  ECSRIRTN
 15199     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15200         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15201             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15202                                                                  ECSRIRTN
 15203 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15204                                                                  ECSRIRTN
 15205     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15206         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15207         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15208             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15209                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15210         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15211         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15212                                                                  ECSRIRTN
 15213     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15214         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15215                                                                  ECSRIRTN
 15216     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15217         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15218             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15219                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15220             ELSE                                                 ECSRIRTN
 15221                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15222         ELSE                                                     ECSRIRTN
 15223             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15224                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15225                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15226             ELSE                                                 ECSRIRTN
 15227                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15228                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15229                                                                  ECSRIRTN
 15230     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15231         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15232                                                                  ECSRIRTN
 15233     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15234         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15235                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15236     ELSE                                                         ECSRIRTN
 15237         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15238             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15239                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15240                                                                  ECSRIRTN
 15241     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15242         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15243             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15244                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15245                                                                  ECSRIRTN
 15246     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15247         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15248             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15249               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15250                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15251                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15252                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 293
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15253                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15254                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15255              ELSE                                                ECSRIRTN
 15256                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 15257                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15258                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15259                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15260                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15261                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15262                                                                  ECSRIRTN
 15263                                                                  ECSRIRTN
 15264     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15265        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15266                               '220000' OR '230000')              ECSRIRTN
 15267           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15268               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15269                                                                  ECSRIRTN
 15270     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15271                                                                  ECSRIRTN
 15272     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15273                                                                  ECSRIRTN
 15274                                                                  ECSRIRTN
 15275 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15276                                                                  ECSRIRTN
 15277     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15278         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15279                                                                  ECSRIRTN
 15280     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15281         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15282         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15283                                                                  ECSRIRTN
 15284     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15285                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15286                                                                  ECSRIRTN
 15287     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15288         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15289                                                                  ECSRIRTN
 15290     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15291         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15292                                                                  ECSRIRTN
 15293     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15294                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15295         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15296                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15297         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15298     ELSE                                                         ECSRIRTN
 15299         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15300         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15301                                                                  ECSRIRTN
 15302                                                                  ECSRIRTN
 15303 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15304                                                                  ECSRIRTN
 15305     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15306         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15307                                                                  ECSRIRTN
 15308     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15309         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15310                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 294
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15311     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15312                                                                  ECSRIRTN
 15313 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15314                                                                  ECSRIRTN
 15315     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15316     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15317                                                                  ECSRIRTN
 15318     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15319         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15320             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15321                                                                  ECSRIRTN
 15322     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15323     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15324                                                                  ECSRIRTN
 15325     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15326         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15327                                                                  ECSRIRTN
 15328     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15329         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15330                                                                  ECSRIRTN
 15331 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15332                                                                  ECSRIRTN
 15333     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15334         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15335                                                                  ECSRIRTN
 15336     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15337                                                                  ECSRIRTN
 15338 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15339                                                                  ECSRIRTN
 15340     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15341     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15342                                                                  ECSRIRTN
 15343 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15344     EXIT.                                                        ECSRIRTN
 15345                                                                  ECSRIRTN
 15346 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15347                                                                  ECSRIRTN
 15348     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15349         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15350                                                                  ECSRIRTN
 15351 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15352     EXIT.                                                        ECSRIRTN
 15353                                                                  ECSRIRTN
 15354                                                                  ECSRIRTN
 15355 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15356                                                                  ECSRIRTN
 15357     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15358     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15359     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15360     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15361                                                                  ECSRIRTN
 15362     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15363         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15364         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15365         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15366         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15367         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15368         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 295
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15369         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15370         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15371         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15372                                                                  ECSRIRTN
 15373     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15374         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15375                                                                  ECSRIRTN
 15376     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15377                                                                  ECSRIRTN
 15378 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15379                                                                  ECSRIRTN
 15380     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15381                                                                  ECSRIRTN
 15382 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15383     EXIT.                                                        ECSRIRTN
 15384                                                                  ECSRIRTN
 15385 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15386                                                                  ECSRIRTN
 15387     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15388                                                                  ECSRIRTN
 15389     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15390         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15391                                                                  ECSRIRTN
 15392     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15393         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15394             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15395                                                                  ECSRIRTN
 15396     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15397         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15398         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15399         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15400     ELSE                                                         ECSRIRTN
 15401         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15402         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15403         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15404                                                                  ECSRIRTN
 15405     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15406                                                                  ECSRIRTN
 15407     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15408        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15409         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15410                                                                  ECSRIRTN
 15411     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15412         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15413                                                                  ECSRIRTN
 15414 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15415     EXIT.                                                        ECSRIRTN
 15416                                                                  ECSRIRTN
 15417 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15418                                                                  ECSRIRTN
 15419     CONTINUE.                                                    ECSRIRTN
 15420*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15421 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15422     EXIT.                                                        ECSRIRTN
 15423                                                                  ECSRIRTN
 15424 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15425                                                                  ECSRIRTN
 15426     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 296
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15427         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15428                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15429                                                                  ECSRIRTN
 15430     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 15431         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15432                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15433                                                                  ECSRIRTN
 15434     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15435                                                                  ECSRIRTN
 15436     START ERRTBL-IN                                              ECSRIRTN
 15437           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15438             INVALID KEY                                          ECSRIRTN
 15439               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15440                                                                  ECSRIRTN
 15441     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15442     MOVE 0 TO SUB1.                                              ECSRIRTN
 15443 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15444                                                                  ECSRIRTN
 15445     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15446                                                                  ECSRIRTN
 15447     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15448        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15449                                                                  ECSRIRTN
 15450     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15451        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15452        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15453                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15454        GO TO ABEND-PGM.                                          ECSRIRTN
 15455                                                                  ECSRIRTN
 15456     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15457        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15458                                                                  ECSRIRTN
 15459     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15460        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15461                                                                  ECSRIRTN
 15462     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15463        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15464                                                                  ECSRIRTN
 15465     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15466        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15467                                                                  ECSRIRTN
 15468     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15469        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15470                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15471        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15472                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15473        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15474                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15475     END-PERFORM.                                                 ECSRIRTN
 15476     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15477                                                                  ECSRIRTN
 15478     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 297
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15479        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15480                                                                  ECSRIRTN
 15481     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15482        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 15483                                                                  ECSRIRTN
 15484     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15485        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15486                                                                  ECSRIRTN
 15487     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15488        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15489                                                                  ECSRIRTN
 15490     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15491        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15492        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15493        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15494        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15495        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15496        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15497          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15498                                                                  ECSRIRTN
 15499     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15500                                                                  ECSRIRTN
 15501     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15502        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15503        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15504        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15505        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15506                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15507        GO TO ABEND-PGM.                                          ECSRIRTN
 15508                                                                  ECSRIRTN
 15509     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15510                                                                  ECSRIRTN
 15511     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15512                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15513     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15514                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15515     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15516                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15517                                                                  ECSRIRTN
 15518     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15519         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15520     ELSE                                                         ECSRIRTN
 15521         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15522                                                                  ECSRIRTN
 15523     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15524     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15525     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15526     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15527                                                                  ECSRIRTN
 15528 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15529                                                                  ECSRIRTN
 15530     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15531        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15532                                                                  ECSRIRTN
 15533     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15534        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15535                                                                  ECSRIRTN
 15536     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 298
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15537        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15538                                                                  ECSRIRTN
 15539     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15540        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 15541                                                                  ECSRIRTN
 15542     ADD +1 TO SUB1.                                              ECSRIRTN
 15543                                                                  ECSRIRTN
 15544     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15545        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15546        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15547                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15548        GO TO ABEND-PGM.                                          ECSRIRTN
 15549                                                                  ECSRIRTN
 15550     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15551     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15552     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15553     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15554     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15555     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15556     if re-state-exhibit-opt-f = 'Y'
 15557        move 'Y'         to rc2-ecs152-rpt (sub1)
 15558     else
 15559        move 'N'         to rc2-ecs152-rpt (sub1)
 15560     end-if
 15561                                                                  ECSRIRTN
 15562     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15563                                                                  ECSRIRTN
 15564 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15565     EXIT.                                                        ECSRIRTN
 15566                                                                  ECSRIRTN
 15567 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15568                                                                  ECSRIRTN
 15569     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15570                                                                  ECSRIRTN
 15571     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15572                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15573                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15574                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15575                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15576                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15577                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15578                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15579                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15580                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15581                                                                  ECSRIRTN
 15582 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15583     EXIT.                                                        ECSRIRTN
 15584                                                                  ECSRIRTN
 15585 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15586                                                                  ECSRIRTN
 15587     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15588                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15589     move spaces      to rc2-ecs152-rpt (co-sub)
 15590                                                                  ECSRIRTN
 15591     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15592                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15593                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15594                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 299
* ECS010.cbl (/apps/test/cid1s/copy/ECSRIRTN)
 15595                                                                  ECSRIRTN
 15596 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15597     EXIT.                                                        ECSRIRTN
 15598******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 300
* ECS010.cbl
 15600******************************************************************
 15601***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15602******************************************************************
 15603
 15604 3600-RC-REINSURANCE.
 15605
 15606     IF DTE-PGM-OPT NOT = '1'
 15607         GO TO 3799-RC-REINSURANCE-X.
 15608
 15609     IF DTE-CLIENT = 'WSL'
 15610         IF CR-REIN-TABLE = '00A'
 15611             GO TO 3799-RC-REINSURANCE-X.
 15612
 15613     IF CR-REIN-TABLE = SPACES OR ZEROS
 15614         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15615
 15616 3610-CLEAR-RC-REIN.
 15617
 15618     MOVE SPACES TO RC-REIN-LEVELS (1).
 15619     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15620                    RC-REIN-LFPRM (1)
 15621                    RC-REIN-AHAMT (1)
 15622                    RC-REIN-AHPRM (1)
 15623                    RC-REIN-LFRFND (1)
 15624                    RC-REIN-AHRFND (1)
 15625                    RC-REIN-LFCLM (1)
 15626                    RC-REIN-AHCLM (1).
 15627
 15628     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15629         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15630
 15631     MOVE +1 TO SUB1.
 15632     MOVE +0 TO SUB2.
 15633
 15634     GO TO 3630-RC-REIN-LOOP-1.
 15635
 15636 3620-CLEAR-RC-LEVELS.
 15637
 15638     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15639
 15640
 15641 3630-RC-REIN-LOOP-1.
 15642
 15643     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15644         ADD +1 TO SUB2
 15645         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15646         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15647         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15648         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15649         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15650         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15651         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15652         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15653         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15654         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15655
 15656     ADD +1 TO SUB1.
 15657     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 301
* ECS010.cbl
 15658         GO TO 3630-RC-REIN-LOOP-1.
 15659
 15660     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15661
 15662     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15663     IF CR-REIN-TABLE = SPACES OR ZEROS
 15664         MOVE +1                     TO SUB1
 15665         GO TO 3710-RC-REIN-LOOP-2.
 15666
 15667     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15668
 15669 3640-NSP-REIN-RATING-ROUTINE.
 15670
 15671     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15672     MOVE 'L'                        TO DC-OPTION-CODE.
 15673     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15674     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15675     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15676     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15677     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15678     MOVE CR-APR                     TO CP-LOAN-APR.
 15679     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15680     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15681     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15682     MOVE ZEROS                      TO CP-CLASS-CODE.
 15683
 15684     IF DTE-CLIENT = 'TIC'
 15685        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15686            MOVE ZERO                TO CP-CLASS-CODE
 15687        ELSE
 15688            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15689
 15690     MOVE '3'                        TO CP-PROCESS-TYPE.
 15691     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15692     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15693
 15694 3650-NSP-REIN-LIFE.
 15695
 15696     IF CR-LFTYP = ZERO
 15697         GO TO 3660-NSP-REIN-AH.
 15698     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15699        OR (DTE-CLIENT = 'DCC')
 15700         GO TO 3660-NSP-REIN-AH.
 15701     IF DTE-CLIENT NOT = 'LBL'
 15702         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15703             GO TO 3660-NSP-REIN-AH.
 15704
 15705     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15706         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15707         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15708
 15709     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15710     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15711     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15712                                        CP-RATING-BENEFIT-AMT.
 15713     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15714     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15715     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 302
* ECS010.cbl
 15716     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15717     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15718     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15719     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15720
 15721     IF CP-STATE-STD-ABBRV = 'OR'
 15722         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15723
 15724     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15725
 15726     IF CP-ERROR-RATE-NOT-FOUND  OR
 15727        CP-ERROR-RATE-IS-ZERO
 15728         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15729                                     TO WS-ABEND-MESSAGE
 15730         MOVE 0302                   TO WS-ABEND-CODE
 15731         DISPLAY '******************************'
 15732         DISPLAY '***** ERROR LOCATION 018 *****'
 15733         DISPLAY '******************************'
 15734         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15735         GO TO ABEND-PGM.
 15736
 15737     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15738
 15739*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15740*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15741
 15742     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15743                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15744
 15745     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15746
 15747 3660-NSP-REIN-AH.
 15748
 15749     IF CR-AHTYP = ZERO
 15750         GO TO 3669-NSP-REIN-X.
 15751     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15752        OR (DTE-CLIENT = 'DCC')
 15753         GO TO 3669-NSP-REIN-X.
 15754     IF DTE-CLIENT NOT = 'LBL'
 15755         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15756             GO TO 3669-NSP-REIN-X.
 15757
 15758     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15759         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15760         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15761
 15762     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15763     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15764     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15765                                        CP-RATING-BENEFIT-AMT.
 15766     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15767     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15768     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15769     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15770     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15771     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15772     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15773
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 303
* ECS010.cbl
 15774     IF CP-STATE-STD-ABBRV = 'OR'
 15775         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15776
 15777     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15778
 15779     IF CP-ERROR-RATE-NOT-FOUND  OR
 15780        CP-ERROR-RATE-IS-ZERO
 15781         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15782                                     TO WS-ABEND-MESSAGE
 15783         MOVE 0302                   TO WS-ABEND-CODE
 15784         DISPLAY '******************************'
 15785         DISPLAY '***** ERROR LOCATION 019 *****'
 15786         DISPLAY '******************************'
 15787         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15788         GO TO ABEND-PGM.
 15789
 15790     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15791             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15792
 15793     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15794
 15795 3669-NSP-REIN-X.
 15796     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 304
* ECS010.cbl
 15798******************************************************************
 15799***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15800******************************************************************
 15801
 15802 3700-RC-REIN-PERF-CALC.
 15803
*15804                             COPY ECSRTPFM.
 15805******************************************************************07/10/97
 15806*                                                                *ECSRTPFM
 15807*                            ECSRTPFM                            *   LV001
 15808*                            VMOD=2.002                          *ECSRTPFM
 15809*                                                                *ECSRTPFM
 15810******************************************************************ECSRTPFM
 15811                                                                  ECSRTPFM
 15812     IF    CR-LFAMT  NUMERIC                                      00000072
 15813           NEXT SENTENCE                                          00000073
 15814        ELSE                                                      00000074
 15815           MOVE ZEROS TO CR-LFAMT.                                00000075
 15816                                                                  00000076
 15817     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15818           NEXT SENTENCE                                          00000078
 15819        ELSE                                                      00000079
 15820           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15821                                                                  00000081
 15822                                                                  00000082
 15823     IF    CR-LFPRM  NUMERIC                                      00000083
 15824           NEXT SENTENCE                                          00000084
 15825        ELSE                                                      00000085
 15826           MOVE ZEROS TO CR-LFPRM.                                00000086
 15827                                                                  00000087
 15828     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15829           NEXT SENTENCE                                          00000089
 15830        ELSE                                                      00000090
 15831           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15832                                                                  00000092
 15833                                                                  00000093
 15834     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15835           NEXT SENTENCE                                          00000095
 15836        ELSE                                                      00000096
 15837           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15838                                                                  00000098
 15839     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15840           NEXT SENTENCE                                          00000100
 15841        ELSE                                                      00000101
 15842           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15843                                                                  00000103
 15844     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15845           NEXT SENTENCE                                          00000105
 15846        ELSE                                                      00000106
 15847           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15848                                                                  00000108
 15849     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15850     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15851     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15852         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15853     ELSE                                                         ECSRTPFM
 15854         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15855     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 305
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15856                                                                  ECSRTPFM
 15857     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15858     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15859     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15860         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15861     ELSE                                                         ECSRTPFM
 15862         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15863     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15864                                                                  ECSRTPFM
 15865     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15866         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15867             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15868                                                                  ECSRTPFM
 15869
 15870     IF CR-STATE NOT = STATE-L
 15871         MOVE CR-STATE               TO STATE-L
 15872         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15873
 15874     MOVE 'X'                     TO REIN-RT-SW.
 15875     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15876     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15877     MOVE ' '                     TO REIN-RT-SW.
 15878
 15879 3710-RC-REIN-LOOP-2.
 15880
 15881     IF REIN-COMP (SUB1) = SPACES
 15882         GO TO 3730-RC-REIN-EXTRACTS.
 15883
 15884     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15885        ADD +1 TO SUB1
 15886         GO TO 3710-RC-REIN-LOOP-2.
 15887
 15888     MOVE +1 TO SUB2.
 15889
 15890 3720-RC-REIN-LOOP-3.
 15891
 15892     IF RC-REIN-COMP (SUB2) = SPACES
 15893         ADD +1 TO SUB1
 15894         GO TO 3710-RC-REIN-LOOP-2.
 15895
 15896     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15897         ADD +1 TO SUB2
 15898         GO TO 3720-RC-REIN-LOOP-3.
 15899
 15900     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15901        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15902        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15903        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15904         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15905         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15906
 15907     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15908        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15909         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15910         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15911
 15912     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15913         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 306
* ECS010.cbl
 15914         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15915
 15916     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15917         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15918         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15919
 15920     ADD +1 TO SUB2.
 15921     GO TO 3720-RC-REIN-LOOP-3.
 15922
 15923 3730-RC-REIN-EXTRACTS.
 15924
 15925     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15926     MOVE 'R' TO DE-REIN.
 15927     MOVE 'J' TO DE-TRANS.
 15928*****PERFORM EXTRACT-DATE-RELOAD.
 15929     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15930     MOVE +1 TO SUB1.
 15931
 15932 3740-RC-REIN-OLD-ISSUE.
 15933
 15934     IF RC-REIN-COMP (SUB1) = SPACES
 15935         MOVE +1 TO SUB1
 15936         GO TO 3745-RC-REIN-NEW-ISSUE.
 15937
 15938     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15939         ADD +1 TO SUB1
 15940         GO TO 3740-RC-REIN-OLD-ISSUE.
 15941
 15942     IF RC-OLD-ISS (SUB1) = 'X'
 15943         ADD +1 TO SUB1
 15944         GO TO 3740-RC-REIN-OLD-ISSUE.
 15945
 15946     IF RC-REIN-LFAMT (SUB1) = ZERO
 15947        AND RC-REIN-LFPRM (SUB1) = ZERO
 15948        AND RC-REIN-AHAMT (SUB1) = ZERO
 15949        AND RC-REIN-AHPRM (SUB1) = ZERO
 15950         ADD +1 TO SUB1
 15951         GO TO 3740-RC-REIN-OLD-ISSUE.
 15952
 15953     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15954     PERFORM EXTRACT-DATE-LOAD.
 15955     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15956     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15957     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15958     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15959     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15960     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15961
 15962     ADD +1 TO BC-R-ISS.
 15963     ADD +1 TO SUB1.
 15964     GO TO 3740-RC-REIN-OLD-ISSUE.
 15965
 15966 3745-RC-REIN-NEW-ISSUE.
 15967
 15968     IF REIN-COMP (SUB1) = SPACES
 15969         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15970                                         2259-END-CANCEL-BUILD
 15971         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 307
* ECS010.cbl
 15972         MOVE 'K'      TO DE-TRANS
 15973*********PERFORM EXTRACT-DATE-RELOAD
 15974         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15975         MOVE +1       TO SUB1
 15976         GO TO 3750-RC-REIN-OLD-CANCEL.
 15977
 15978     IF REIN-REM-SW (SUB1) = 'Z'
 15979         ADD +1 TO SUB1
 15980         GO TO 3745-RC-REIN-NEW-ISSUE.
 15981
 15982     IF RC-NEW-ISS (SUB1) = 'X'
 15983         ADD +1 TO SUB1
 15984         GO TO 3745-RC-REIN-NEW-ISSUE.
 15985
 15986     IF REIN-LFAMT (SUB1) = ZERO
 15987        AND REIN-LFPRM (SUB1) = ZERO
 15988        AND REIN-AHAMT (SUB1) = ZERO
 15989        AND REIN-AHPRM (SUB1) = ZERO
 15990         ADD +1 TO SUB1
 15991         GO TO 3745-RC-REIN-NEW-ISSUE.
 15992
 15993     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15994     PERFORM EXTRACT-DATE-LOAD.
 15995     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15996     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15997     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15998     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15999     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16000     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16001
 16002     ADD +1 TO BC-R-ISS.
 16003     ADD +1 TO SUB1.
 16004     GO TO 3745-RC-REIN-NEW-ISSUE.
 16005
 16006 3750-RC-REIN-OLD-CANCEL.
 16007
 16008     IF RC-REIN-COMP (SUB1) = SPACES
 16009         MOVE +1 TO SUB1
 16010         GO TO 3755-RC-REIN-NEW-CANCEL.
 16011
 16012     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16013         ADD +1 TO SUB1
 16014         GO TO 3750-RC-REIN-OLD-CANCEL.
 16015
 16016     IF RC-OLD-CNC (SUB1) = 'X'
 16017         ADD +1 TO SUB1
 16018         GO TO 3750-RC-REIN-OLD-CANCEL.
 16019
 16020     IF RC-REIN-LFRFND (SUB1) = ZERO
 16021        AND RC-REIN-AHRFND (SUB1) = ZERO
 16022         ADD +1 TO SUB1
 16023         GO TO 3750-RC-REIN-OLD-CANCEL.
 16024
 16025     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 16026     PERFORM EXTRACT-DATE-LOAD.
 16027     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 16028     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 16029     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 308
* ECS010.cbl
 16030     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16031
 16032     ADD +1 TO BC-R-CNC.
 16033     ADD +1 TO SUB1.
 16034     GO TO 3750-RC-REIN-OLD-CANCEL.
 16035
 16036 3755-RC-REIN-NEW-CANCEL.
 16037
 16038     IF REIN-COMP (SUB1) = SPACES
 16039         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 16040         MOVE 'R' TO DE-REIN
 16041         MOVE 'L' TO DE-TRANS
 16042*********PERFORM EXTRACT-DATE-RELOAD
 16043         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16044         MOVE +1 TO SUB1
 16045         GO TO 3760-RC-REIN-OLD-CLAIM.
 16046
 16047     IF REIN-REM-SW (SUB1) = 'Z'
 16048         ADD +1 TO SUB1
 16049         GO TO 3755-RC-REIN-NEW-CANCEL.
 16050
 16051     IF RC-NEW-CNC (SUB1) = 'X'
 16052         ADD +1 TO SUB1
 16053         GO TO 3755-RC-REIN-NEW-CANCEL.
 16054
 16055     IF REIN-LFRFND (SUB1) = ZERO
 16056        AND REIN-AHRFND (SUB1) = ZERO
 16057         ADD +1 TO SUB1
 16058         GO TO 3755-RC-REIN-NEW-CANCEL.
 16059
 16060     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16061     PERFORM EXTRACT-DATE-LOAD.
 16062     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16063     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16064     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16065     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16066
 16067     ADD +1 TO BC-R-CNC.
 16068     ADD +1 TO SUB1.
 16069     GO TO 3755-RC-REIN-NEW-CANCEL.
 16070
 16071 3760-RC-REIN-OLD-CLAIM.
 16072
 16073     IF RC-REIN-COMP (SUB1) = SPACES
 16074         MOVE +1 TO SUB1
 16075         GO TO 3780-RC-REIN-NEW-CLAIM.
 16076
 16077     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16078         ADD +1 TO SUB1
 16079         GO TO 3760-RC-REIN-OLD-CLAIM.
 16080
 16081     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16082         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16083
 16084     IF RC-REIN-LFCLM (SUB1) = ZERO
 16085         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16086
 16087     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 309
* ECS010.cbl
 16088     PERFORM EXTRACT-DATE-LOAD.
 16089     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16090     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16091     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16092     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16093     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16094     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16095     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16096     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16097     MOVE CR-DTH-PAY-DT TO DE-PAY
 16098                           WS-DE-PAY-N.
 16099
 16100     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16101         MOVE '3' TO DE-TYPE
 16102     ELSE
 16103         MOVE '1' TO DE-TYPE.
 16104
 16105     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16106
 16107     ADD +1 TO BC-R-CLM.
 16108
 16109 3770-RC-REIN-OLD-AH-CLM.
 16110
 16111     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16112         ADD +1 TO SUB1
 16113         GO TO 3760-RC-REIN-OLD-CLAIM.
 16114
 16115     IF RC-REIN-AHCLM (SUB1) = ZERO
 16116         ADD +1 TO SUB1
 16117         GO TO 3760-RC-REIN-OLD-CLAIM.
 16118
 16119     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16120     PERFORM EXTRACT-DATE-LOAD.
 16121     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16122     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16123     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16124     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16125     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16126     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16127     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16128     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16129     MOVE CR-DIS-PAY-DT TO DE-PAY
 16130                           WS-DE-PAY-N.
 16131
 16132     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16133         MOVE '4' TO DE-TYPE
 16134     ELSE
 16135         MOVE '2' TO DE-TYPE.
 16136
 16137     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16138
 16139     ADD +1 TO BC-R-CLM.
 16140     ADD +1 TO SUB1.
 16141
 16142     GO TO 3760-RC-REIN-OLD-CLAIM.
 16143
 16144 3780-RC-REIN-NEW-CLAIM.
 16145
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 310
* ECS010.cbl
 16146     IF REIN-COMP (SUB1) = SPACES
 16147         GO TO 3799-RC-REINSURANCE-X.
 16148
 16149     IF REIN-REM-SW (SUB1) = 'Z'
 16150         ADD +1 TO SUB1
 16151         GO TO 3780-RC-REIN-NEW-CLAIM.
 16152
 16153     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16154         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16155
 16156     IF REIN-LFCLM (SUB1) = ZERO
 16157         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16158
 16159     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16160     PERFORM EXTRACT-DATE-LOAD.
 16161     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16162     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16163     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16164     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16165     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16166     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16167     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16168     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16169     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16170                               WS-DE-PAY-N.
 16171
 16172     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16173         MOVE '3' TO DE-TYPE
 16174     ELSE
 16175         MOVE '1' TO DE-TYPE.
 16176
 16177     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16178
 16179     ADD +1 TO BC-R-CLM.
 16180
 16181 3790-RC-REIN-NEW-AH-CLM.
 16182
 16183     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16184         ADD +1 TO SUB1
 16185         GO TO 3780-RC-REIN-NEW-CLAIM.
 16186
 16187     IF REIN-AHCLM (SUB1) = ZERO
 16188         ADD +1 TO SUB1
 16189         GO TO 3780-RC-REIN-NEW-CLAIM.
 16190
 16191     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16192     PERFORM EXTRACT-DATE-LOAD.
 16193     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16194     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16195     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16196     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16197     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16198     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16199     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16200     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16201     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16202                               WS-DE-PAY-N.
 16203
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 311
* ECS010.cbl
 16204     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16205         MOVE '4' TO DE-TYPE
 16206     ELSE
 16207         MOVE '2' TO DE-TYPE.
 16208
 16209     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16210
 16211     ADD +1 TO BC-R-CLM.
 16212     ADD +1 TO SUB1.
 16213
 16214     GO TO 3780-RC-REIN-NEW-CLAIM.
 16215
 16216 3799-RC-REINSURANCE-X.
 16217     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 312
* ECS010.cbl
 16219******************************************************************
 16220***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16221******************************************************************
 16222
 16223 4000-EP-BUMP-RTN.
 16224
 16225     IF AM-RECALC-COMM = ('Y' OR '1')
 16226        PERFORM 1600-RECALC-COMM-EXTR
 16227                                 THRU 1899-RECALC-COMM-EXTR-X
 16228        MOVE ' '                 TO RECALC-TYPE
 16229     END-IF
 16230
 16231     MOVE '1'    TO EP-FLG.
 16232     ADD +1      TO BC-G-CERTS.
 16233
 16234     MOVE CR-DT               TO HIGH-CERT.
 16235     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16236         MOVE CR-DT           TO LOW-CERT
 16237         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16238
 16239     IF CR-POLICY-IS-REIN-ONLY
 16240         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16241                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16242                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16243                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16244                              DTH-IBNR           DIS-IBNR
 16245                              DTH-PAYCUR         DIS-PAYCUR
 16246                              DTH-FUTRSV         DIS-FUTRSV
 16247         GO TO 4050-EP-DO-REINSURE.
 16248
 16249     MOVE CR-LFAMT       TO WE-LFAMT.
 16250     MOVE CR-LFPRM       TO WE-LFPRM.
 16251     IF CR-LFTYP NOT = ZEROS
 16252         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16253             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16254             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16255         ELSE
 16256             MOVE ZEROS               TO WE-LFAMT-ALT
 16257                                         WE-LFPRM-ALT.
 16258
 16259     MOVE SPACES         TO REIN-EP-FLG
 16260                            WE-REIN-CO.
 16261     MOVE CR-LFRFND      TO WE-LFRFND.
 16262     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16263     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16264     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16265     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16266     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16267     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16268     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16269
 16270     MOVE CR-AHPRM       TO WE-AHPRM.
 16271     MOVE CR-AHAMT       TO WE-AHAMT.
 16272     MOVE CR-AHRFND      TO WE-AHRFND.
 16273     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16274     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16275     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16276     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 313
* ECS010.cbl
 16277     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16278     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16279     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16280
 16281     IF CR-POLICY-IS-RESTORE  OR
 16282        CR-POLICY-IS-REISSUE
 16283        OR CR-POLICY-IS-MONTHLY
 16284         MOVE ZEROS      TO WE-LFPRM
 16285                            WE-LFPRM-ALT
 16286                            WE-AHPRM.
 16287
 16288     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16289                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16290                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16291                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16292                              DTH-IBNR           DIS-IBNR
 16293                              DTH-PAYCUR         DIS-PAYCUR
 16294                              DTH-FUTRSV         DIS-FUTRSV.
 16295
 16296*     DISPLAY ' B4 4100 '
 16297     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16298*     DISPLAY ' AFTER 4100 '
 16299
 16300     IF CR-POLICY-IS-DECLINED  OR
 16301        CR-POLICY-IS-VOID
 16302         GO TO 4099-EP-BUMP-RTN-X.
 16303
 16304 4050-EP-DO-REINSURE.
 16305
 16306     MOVE 'R' TO REIN-EP-FLG.
 16307     MOVE +1  TO SUB5.
 16308
 16309 4090-EP-DO-REINSURE-LOOP.
 16310
 16311*     DISPLAY ' 4090 '
 16312     IF REIN-COMP (SUB5) = SPACES
 16313         MOVE SPACE TO REIN-EP-FLG
 16314         GO TO 4099-EP-BUMP-RTN-X.
 16315
 16316     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16317        REIN-LF-AH-FLGS (SUB5) = SPACES
 16318         ADD +1 TO SUB5
 16319         GO TO 4090-EP-DO-REINSURE-LOOP.
 16320
 16321     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16322        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16323          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16324          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16325          (RCT-REIN-CO (CO-SUB) = SPACES).
 16326
 16327     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16328        (RCT-REIN-CO (CO-SUB) = SPACES)
 16329        MOVE ZERO TO CO-SUB.
 16330
 16331*     DISPLAY ' 4090 A '
 16332*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16333     ADD +1 TO BC-R-CERTS.
 16334     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 314
* ECS010.cbl
 16335     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16336     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16337
 16338     IF (DTE-CLIENT = 'DCC')
 16339        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16340*        DISPLAY ' B4 CEDE FACT '
 16341*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16342*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16343*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16344        COMPUTE WS-CEDE-FACT =
 16345           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16346*        DISPLAY ' AFTER CEDE FACT '
 16347        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16348           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16349                                     NOT = 'G' AND 'L')
 16350           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16351*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16352*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16353           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16354           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16355        END-IF
 16356     END-IF
 16357
 16358     MOVE RWF-LFPRM      TO WE-LFPRM.
 16359     MOVE RWF-LFAMT      TO WE-LFAMT.
 16360     MOVE RWF-LFRFND     TO WE-LFRFND.
 16361     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16362     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16363     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16364     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16365     MOVE +0             TO WE-LFAMT-ALT
 16366                            WE-LFPRM-ALT
 16367                            WE-DTHEXP
 16368                            WE-NUM-DTH-CLM.
 16369
 16370*     DISPLAY ' 4090 B '
 16371     IF (DTE-CLIENT EQUAL 'NSL') AND
 16372        (CR-REIN-TABLE EQUAL 'NAR')
 16373        CONTINUE
 16374     ELSE
 16375      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16376       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16377        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16378            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16379        COMPUTE WE-LFAMT ROUNDED EQUAL
 16380                           CR-LFAMT * WS-CEDE-FACT
 16381        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16382                           CR-LFAMT-ALT * WS-CEDE-FACT
 16383        IF (DTE-CLIENT = 'CID')
 16384           AND (CR-LF-NSP-PRM > +0)
 16385           AND (CR-ENTRY-DATE > 20031130)
 16386           AND (WT-LF-QC NOT = '1' AND '3')
 16387           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16388              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16389           MOVE +0            TO WE-LFPRM-ALT
 16390        ELSE
 16391          IF (DTE-CLIENT = 'CID')
 16392             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 315
* ECS010.cbl
 16393             AND (CR-ENTRY-DATE > 20030430)
 16394             AND (WT-LF-QC NOT = '1' AND '3')
 16395             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16396             MOVE +0            TO WE-LFPRM-ALT
 16397          ELSE
 16398             COMPUTE WE-LFPRM ROUNDED EQUAL
 16399                           CR-LFPRM * WS-CEDE-FACT
 16400             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16401                           CR-LFPRM-ALT * WS-CEDE-FACT
 16402          END-IF
 16403        END-IF
 16404        IF (DTE-CLIENT = 'CID')
 16405           AND (CR-LF-NSP-PRM > +0)
 16406           AND (CR-LFRFND-CALC > +0)
 16407           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16408           AND (WT-LF-QC NOT = '1' AND '4')
 16409           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16410              (CR-LFPRM + CR-LFPRM-ALT)
 16411           COMPUTE WE-LFRFND =
 16412              REIN-FACTOR * REIN-CALCED-LIFE
 16413           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16414              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16415*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16416*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16417*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16418        ELSE
 16419
 16420          IF (DTE-CLIENT = 'CID')
 16421           AND (CR-LF-NSP-PRM > +0)
 16422           AND (CR-LFRFND-CALC > +0)
 16423           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16424           AND (WT-LF-QC NOT = '1' AND '4')
 16425           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16426           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16427              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16428
 16429          END-IF
 16430        END-IF
 16431       ELSE
 16432         MOVE +0 TO WS-CEDE-FACT
 16433       END-IF
 16434      END-IF
 16435     END-IF
 16436
 16437*     DISPLAY ' 4090 C '
 16438     IF DTE-CLIENT = 'DCC'
 16439        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16440           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16441                                   NOT = 'G' AND 'L')
 16442           AND (CR-AHAMT NOT = ZEROS)
 16443*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16444           COMPUTE WS-CEDE-FACT =
 16445               RWF-AHAMT / CR-AHAMT
 16446           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16447*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16448*          / CR-AHPRM * CR-AHRFND
 16449           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16450           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 316
* ECS010.cbl
 16451        END-IF
 16452     END-IF
 16453
 16454     MOVE RWF-AHPRM      TO WE-AHPRM.
 16455
 16456     MOVE RWF-AHAMT      TO WE-AHAMT
 16457     MOVE RWF-AHRFND     TO WE-AHRFND.
 16458     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16459     MOVE +0             TO WE-DSPY-EXP
 16460                            WE-NUM-DIS-CLM.
 16461     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16462     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16463     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16464
 16465     IF  RWF-LF-RUNOFF-SW = 'N'
 16466             OR
 16467         RWF-AH-RUNOFF-SW = 'N'
 16468         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16469
 16470     IF  RWF-LF-RUNOFF-SW = 'N'
 16471         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16472     ELSE
 16473         MOVE 99999999             TO STOP-LF-DATE.
 16474
 16475     IF  RWF-AH-RUNOFF-SW = 'N'
 16476         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16477     ELSE
 16478         MOVE 99999999             TO STOP-AH-DATE.
 16479
 16480     IF CR-POLICY-IS-RESTORE  OR
 16481        CR-POLICY-IS-REISSUE
 16482        OR CR-POLICY-IS-MONTHLY
 16483         MOVE ZEROS      TO WE-LFPRM
 16484                            WE-LFPRM-ALT
 16485                            WE-AHPRM.
 16486
 16487*     DISPLAY ' B4 4100-EP-DO-LF '
 16488     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16489*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16490
 16491     IF CO-SUB NOT = ZERO
 16492       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16493         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16494             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16495
 16496     ADD +1 TO SUB5.
 16497     GO TO 4090-EP-DO-REINSURE-LOOP.
 16498
 16499 4099-EP-BUMP-RTN-X.
 16500     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 317
* ECS010.cbl
 16502******************************************************************
 16503***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16504******************************************************************
 16505
 16506 4100-EP-DO-LF.
 16507
 16508     MOVE +0                         TO ISS-BEN  EPR-R78
 16509                                        CNC-BEN  EPR-PRO
 16510                                        ISS-PRM  EPR-ST
 16511                                        ISS-PRMTAX
 16512                                        CNC-PRM  ACTIVE-COUNT.
 16513     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16514
 16515     IF CR-LFTYP = ZERO
 16516         GO TO 4200-EP-DO-AH.
 16517
 16518     IF REIN-EP-FLG = 'R'
 16519         IF REIN-LF-FLG (SUB5) = SPACE
 16520             GO TO 4200-EP-DO-AH.
 16521
 16522     IF CR-APR NOT NUMERIC
 16523         MOVE ZERO TO CR-APR.
 16524
 16525     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16526     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16527     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16528
 16529     IF CR-POLICY-IS-DECLINED  OR
 16530        CR-POLICY-IS-VOID
 16531         GO TO 4191-CONTINUE.
 16532
 16533     MOVE CR-LF-TERM             TO ORIG-TERM.
 16534     MOVE CLAS-INDEXL            TO W-NDX.
 16535
 16536     IF CR-DT GREATER EW-COV-DTE
 16537         MOVE CR-DT              TO EW-COV-DTE.
 16538
 16539     IF (NOT CR-POLICY-IS-RESTORE) AND
 16540        (NOT CR-POLICY-IS-REISSUE)
 16541        AND (NOT CR-POLICY-IS-MONTHLY)
 16542         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16543         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16544             ADD CR-LIVES TO EW-ISS-CNT
 16545             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16546                                    (ORIG-TERM * CR-LIVES)
 16547             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16548             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16549             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16550                                   (ORIG-TERM * ISS-BEN)
 16551         ELSE
 16552             IF (DTE-CLIENT = 'DCC')
 16553                AND (CR-LFTYP = 'DD')
 16554                CONTINUE
 16555             ELSE
 16556                ADD +1 TO EW-ISS-CNT
 16557             END-IF
 16558             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16559             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 318
* ECS010.cbl
 16560             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16561             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16562                                   (ORIG-TERM * ISS-BEN).
 16563
 16564     MOVE RUN-DATE        TO VALUATION-DT.
 16565     MOVE '2'             TO W-VAL-SOURCE.
 16566
 16567     IF REIN-EP-FLG = 'R'
 16568         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16569            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16570             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16571             MOVE '10'              TO W-VAL-SOURCE.
 16572
 16573     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16574
 16575     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16576        (REM-TRM3 GREATER ZERO)
 16577        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16578            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16579                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16580            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16581                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16582          ELSE
 16583            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16584            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16585
 16586     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16587
 16588     IF DTE-CLIENT = 'GIC'
 16589         IF REIN-EP-FLG NOT = 'R'  AND
 16590            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16591            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16592            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16593
 16594     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16595         GO TO 4105-EP-DO-LF-REIN-CHK.
 16596
 16597     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16598             AND
 16599         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16600             AND
 16601         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16602                 OR
 16603             CR-LF-CANC-DT EQUAL ZEROS)
 16604             AND
 16605         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16606                 OR
 16607             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16608         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16609         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16610                 VARYING
 16611             SUBM FROM +1 BY +1
 16612                 UNTIL
 16613             SUBM GREATER THAN +13.
 16614
 16615     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16616     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16617
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 319
* ECS010.cbl
 16618 4105-EP-DO-LF-REIN-CHK.
 16619
 16620     IF REIN-EP-FLG = 'R'  AND
 16621        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16622         NEXT SENTENCE
 16623     ELSE
 16624         GO TO 4110-EP-DO-LF-CLM.
 16625
 16626     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16627         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16628             GO TO 4130-EP-DO-LF-EP.
 16629
 16630     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16631         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16632             GO TO 4130-EP-DO-LF-EP.
 16633
 16634 4110-EP-DO-LF-CLM.
 16635
 16636     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16637         NEXT  SENTENCE
 16638       ELSE
 16639         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16640
 16641     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16642     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16643
 16644     IF CR-LF-STATUS-AT-DEATH = ' '
 16645         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16646             GO TO 4115-EP-DO-LF-CLM-EPR.
 16647
 16648     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16649     ADD +1             TO EW-CLM-CRT.
 16650
 16651 4115-EP-DO-LF-CLM-EPR.
 16652
 16653     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16654         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16655         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16656     END-IF
 16657     .
 16658 4120-EP-DO-LF-CNCL.
 16659
 16660     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16661        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16662         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16663             GO TO 4190-EP-DO-LF-COMM
 16664         ELSE
 16665             GO TO 4130-EP-DO-LF-EP.
 16666
 16667     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16668         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16669         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16670
 16671     IF CR-LFTYP NOT = 'DD'
 16672        ADD +1                    TO EW-CNC-CNT
 16673     END-IF
 16674
 16675     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 320
* ECS010.cbl
 16676
 16677     IF DTE-CLIENT = 'GIC'
 16678         IF REIN-EP-FLG NOT = 'R'  AND
 16679            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16680             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16681
 16682*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16683*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16684*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16685*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16686
 16687     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16688     MOVE 'L'                   TO  DC-OPTION-CODE.
 16689     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16690     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16691
 16692     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16693     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16694     MOVE '1'                     TO  DC-OPTION-CODE.
 16695     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16696     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16697     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16698                                      DC-ODD-DAYS-OVER
 16699                                      DC-ELAPSED-DAYS.
 16700     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16701     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16702
 16703     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16704         ADD  +1                  TO  MONTHS-DIFF-LF.
 16705
 16706     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16707
 16708     if (dte-client = 'AHL')
 16709        and (cr-lf-cancel-exit-date < 20120401)
 16710        go to 4120-continue-life-cancel
 16711     end-if
 16712
 16713     IF DTE-CLIENT = 'ACE'
 16714         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16715
 16716     MOVE  ZEROS                  TO  SUB.
 16717
 16718 4120-LIFE-CHARGEBACK-LOOP.
 16719
 16720     ADD    +1                    TO  SUB.
 16721
 16722     IF  SUB  GREATER THAN  +10
 16723         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16724
 16725     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16726         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16727         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16728
 16729     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16730         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16731
 16732     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16733         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 321
* ECS010.cbl
 16734
 16735     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16736
 16737
 16738 4120-CONTINUE-LIFE-CANCEL.
 16739
 16740     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16741     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16742
 16743     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16744         GO TO 4190-EP-DO-LF-COMM.
 16745
 16746     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16747         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16748         GO TO 4190-EP-DO-LF-COMM.
 16749
 16750     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16751     MOVE '3'           TO W-VAL-SOURCE.
 16752     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16753
 16754     IF REM-TRM3 = CR-LF-TERM
 16755         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16756         GO TO 4190-EP-DO-LF-COMM.
 16757
 16758     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16759         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16760
 16761     IF DTE-CLIENT = 'NCL'
 16762         IF CR-DT LESS THAN 19910101
 16763             GO TO 4121-EP-DO-LF-CNC-BEN.
 16764
 16765     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16766         GO TO 4126-EP-DO-LF-CNCL-NP.
 16767
 16768     IF DTE-CLIENT = 'FUL'
 16769         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16770
 16771*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16772     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16773        (CR-RATING-CLASS NOT = 'L ')
 16774         IF (CR-APR GREATER THAN ZERO)  AND
 16775            (CR-LF-TERM GREATER THAN 060)  AND
 16776            (CR-DT GREATER THAN 19831031)
 16777              GO TO 4126-EP-DO-LF-CNCL-NP.
 16778
 16779     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16780         IF (CR-APR GREATER THAN ZERO)  AND
 16781            (CR-LF-TERM GREATER THAN 061)  AND
 16782            (CR-DT GREATER THAN 19830318)
 16783              GO TO 4126-EP-DO-LF-CNCL-NP.
 16784
 16785     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16786         IF (CR-APR GREATER THAN ZERO)  AND
 16787            (CR-LF-TERM GREATER THAN 062)  AND
 16788            (CR-DT GREATER THAN 19810831)  AND
 16789            (CR-DT LESS THAN 19830901)
 16790              GO TO 4126-EP-DO-LF-CNCL-NP.
 16791
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 322
* ECS010.cbl
 16792     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16793         IF (CR-APR GREATER THAN ZERO)  AND
 16794            (CR-LF-TERM GREATER THAN 060)  AND
 16795            (CR-DT GREATER THAN 19831231)
 16796              GO TO 4126-EP-DO-LF-CNCL-NP.
 16797
 16798 4121-EP-DO-LF-CNC-BEN.
 16799
 16800     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16801
 16802     COMPUTE TEMP-3 ROUNDED EQUAL
 16803         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16804
 16805     MOVE TEMP-3                 TO CNC-BEN.
 16806
 16807     GO TO 4190-EP-DO-LF-COMM.
 16808
 16809 4122-EP-DO-LF-CNCL-TEX.
 16810
 16811     DIVIDE WE-LFAMT BY CR-LF-TERM
 16812         GIVING TEX-FACT-1.
 16813     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16814         GIVING TEX-FACT-2
 16815             REMAINDER TEX-FACT-3.
 16816     IF TEX-FACT-3 NOT = ZERO
 16817         ADD +1 TO TEX-FACT-2.
 16818
 16819     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16820
 16821     GO TO 4190-EP-DO-LF-COMM.
 16822
 16823 4124-EP-DO-LF-CNCL-SUM.
 16824
 16825     IF WE-LFRFND = ZERO
 16826         GO TO 4130-EP-DO-LF-EP.
 16827
 16828     MOVE WE-LFRFND TO CNC-PRM.
 16829
 16830     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16831
 16832     IF WE-LFRFND NOT LESS WE-LFPRM
 16833         MOVE WE-LFAMT TO CNC-BEN
 16834          GO TO 4130-EP-DO-LF-EP.
 16835
 16836
 16837     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16838
 16839     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16840         MOVE TEMP-7 TO CNC-BEN
 16841          GO TO 4130-EP-DO-LF-EP.
 16842
 16843     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16844     MOVE '4'           TO W-VAL-SOURCE.
 16845     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16846
 16847     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16848         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16849         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 323
* ECS010.cbl
 16850
 16851 4126-EP-DO-LF-CNCL-NP.
 16852
 16853     IF WE-LFAMT = ZERO
 16854        GO TO 4190-EP-DO-LF-COMM.
 16855
 16856     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16857     MOVE 'L'                        TO  DC-OPTION-CODE.
 16858     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16859     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16860
 16861     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16862       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16863       MOVE '3'                      TO  DC-OPTION-CODE
 16864       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16865       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16866     ELSE
 16867       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16868       MOVE '6'                      TO  DC-OPTION-CODE
 16869       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16870       MOVE +0                       TO  DC-ELAPSED-DAYS
 16871       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16872       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16873
 16874     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16875     MOVE CR-APR                     TO  CP-LOAN-APR.
 16876     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16877     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16878     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16879     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16880     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16881     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16882
 16883
 16884     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16885     IF (DTE-CLIENT = 'DCC')
 16886        AND (AM-DCC-PRODUCT-CODE <> spaces)
 16887        if cr-clp-state = spaces
 16888           move cr-state         to cr-clp-state
 16889        end-if
 16890        if cr-lftyp not = '00' and '  ' and 'DD'
 16891           move 'L'              to ws-dd-ben-type
 16892           move cr-lftyp         to ws-dd-ben-code
 16893        else
 16894           move 'A'              to ws-dd-ben-type
 16895           move cr-ahtyp         to ws-dd-ben-code
 16896        end-if
 16897        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16898           ((CR-clp-STATE = DD-STATE (D1))
 16899           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16900           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 16901           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 16902           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16903                           OR
 16904           D1 > max-pdef
 16905        END-PERFORM
 16906        IF D1 <= max-pdef
 16907           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 324
* ECS010.cbl
 16908              (P1 > +8)
 16909              OR (DD-PROD-CODE (D1 P1) = 'L')
 16910           END-PERFORM
 16911           IF P1 < +9
 16912              MOVE DD-MAX-BEN-AMT (D1 P1)
 16913                                 TO CP-R-MAX-TOT-BEN
 16914           END-IF
 16915        END-IF
 16916     END-IF
 16917
 16918     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16919
 16920     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16921       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16922       GO TO 4130-EP-DO-LF-EP
 16923     ELSE
 16924       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16925
 16926     GO TO 4190-EP-DO-LF-COMM.
 16927
 16928 4128-EP-DO-LF-CNCL-FUL.
 16929
 16930     IF WE-LFAMT = ZERO
 16931        GO TO 4190-EP-DO-LF-COMM.
 16932
 16933     MOVE CR-APR              TO NP-APR.
 16934     MOVE CR-LF-TERM          TO NP-ORIG.
 16935     MOVE REM-TRM3            TO NP-REM.
 16936     MOVE '2'                 TO NP-OPT.
 16937     MOVE CR-AHPRM            TO NP-AHPRM.
 16938     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16939     MOVE CR-LFAMT            TO NP-BENEFIT.
 16940
 16941*    CALL 'FULNETRM'
 16942*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16943*              NP-ACCOUNT NP-REMAINING.
 16944
 16945     MOVE NP-REMAINING TO CNC-BEN.
 16946
 16947     GO TO 4190-EP-DO-LF-COMM.
 16948
 16949 4130-EP-DO-LF-EP.
 16950
 16951     MOVE SPACE                  TO STATUTORY-SWITCH.
 16952
 16953     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16954     MOVE '5'           TO W-VAL-SOURCE.
 16955
 16956     IF REIN-EP-FLG = 'R'
 16957       IF REIN-REM-SW (SUB5) = 'I'
 16958           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16959           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16960           GO TO 4190-EP-DO-LF-COMM.
 16961
 16962     IF REIN-EP-FLG = 'R'
 16963         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16964            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16965             MOVE '*'               TO LIFE-EARNED-SWITCH
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 325
* ECS010.cbl
 16966             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16967             MOVE '10'              TO W-VAL-SOURCE.
 16968
 16969     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16970
 16971     IF REM-TRM2 GREATER CR-LF-TERM
 16972         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16973         GO TO 4190-EP-DO-LF-COMM.
 16974
 16975     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16976         GO TO 4180-EP-DO-LF-EP-SUM.
 16977
 16978     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16979         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16980             IF REM-TRM2 NOT GREATER THAN +0
 16981                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16982                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16983                 GO TO 4190-EP-DO-LF-COMM
 16984             ELSE
 16985                 NEXT SENTENCE
 16986         ELSE
 16987             IF W-BAL-REMTRM NOT GREATER +0
 16988                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16989                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16990                 GO TO 4190-EP-DO-LF-COMM
 16991             ELSE
 16992                 NEXT SENTENCE
 16993     ELSE
 16994        IF DTE-CLIENT = 'NCL'  AND
 16995           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16996            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16997        ELSE
 16998         IF REM-TRM2 NOT GREATER +0  OR
 16999            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17000             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17001             GO TO 4190-EP-DO-LF-COMM.
 17002
 17003     MOVE +1 TO ACTIVE-COUNT.
 17004
 17005     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17006         GO TO 4140-EP-DO-LF-EP-TEX.
 17007
 17008     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17009         GO TO 4150-EP-DO-LF-EP-NP.
 17010
 17011*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17012     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17013        (CR-RATING-CLASS NOT = 'L ')
 17014         IF (CR-APR GREATER THAN ZERO)  AND
 17015            (CR-LF-TERM GREATER THAN 060)  AND
 17016            (CR-DT GREATER THAN 19831031)
 17017             MOVE '*'             TO STATUTORY-SWITCH
 17018              GO TO 4150-EP-DO-LF-EP-NP.
 17019
 17020     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17021         IF (CR-APR GREATER THAN ZERO)  AND
 17022            (CR-LF-TERM GREATER THAN 061)  AND
 17023            (CR-DT GREATER THAN 19830318)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 326
* ECS010.cbl
 17024             MOVE '*'             TO STATUTORY-SWITCH
 17025              GO TO 4150-EP-DO-LF-EP-NP.
 17026
 17027     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17028         IF (CR-APR GREATER THAN ZERO)  AND
 17029            (CR-LF-TERM GREATER THAN 062)  AND
 17030            (CR-DT GREATER THAN 19810831)  AND
 17031            (CR-DT LESS THAN 19830901)
 17032             MOVE '*'             TO STATUTORY-SWITCH
 17033              GO TO 4150-EP-DO-LF-EP-NP.
 17034
 17035     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17036         IF (CR-APR GREATER THAN ZERO)  AND
 17037            (CR-LF-TERM GREATER THAN 060)  AND
 17038            (CR-DT GREATER THAN 19831231)
 17039             MOVE '*'             TO STATUTORY-SWITCH
 17040              GO TO 4150-EP-DO-LF-EP-NP.
 17041
 17042     GO TO 4160-EP-DO-LF-EP-R78.
 17043
 17044 4140-EP-DO-LF-EP-TEX.
 17045
 17046     IF CR-PMT-FREQ = 0
 17047       DISPLAY '*************************************'
 17048       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 17049       DISPLAY '*************************************'
 17050       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 17051       DISPLAY '*************************************'
 17052       COMPUTE TEX-FACT-4 =
 17053          (CR-LF-TERM * CR-LF-TERM) +
 17054                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17055     ELSE
 17056        COMPUTE TEX-FACT-4 =
 17057         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17058
 17059     IF CR-PMT-FREQ = 0
 17060       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17061           GIVING TEX-FACT-5
 17062               REMAINDER TEX-FACT-6
 17063     ELSE
 17064        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17065            GIVING TEX-FACT-5
 17066                REMAINDER TEX-FACT-6.
 17067
 17068     IF CR-PMT-FREQ > 0
 17069        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17070
 17071     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17072     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17073         (TEX-FACT-5 * CR-PMT-FREQ) +
 17074         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17075     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17076
 17077     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17078
 17079     GO TO 4170-EP-DO-LF-EP-PRO.
 17080
 17081 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 327
* ECS010.cbl
 17082
 17083     IF WE-LFPRM = ZERO
 17084         GO TO 4160-EP-DO-LF-EP-R78.
 17085
 17086     if cr-apr = zeros
 17087        display ' found 0 apr cert ' cr-cert-no
 17088        go to 4160-ep-do-lf-ep-r78
 17089     end-if
 17090     IF DTE-CLIENT = 'CRI'
 17091       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17092             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17093           GO TO 4160-EP-DO-LF-EP-R78.
 17094
 17095     IF DTE-CLIENT = 'AHL'
 17096        GO TO 4160-EP-DO-LF-EP-R78
 17097     END-IF
 17098
 17099     IF DTE-CLIENT = 'NCL'
 17100       IF CR-DT LESS THAN 19910101
 17101           GO TO 4160-EP-DO-LF-EP-R78.
 17102
 17103     IF REM-TRM1 = CR-LF-TERM
 17104         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17105         GO TO 4190-EP-DO-LF-COMM.
 17106
 17107     MOVE CR-APR TO NP-APR.
 17108     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17109     MOVE REM-TRM1 TO NP-REM.
 17110     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17111     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17112         MOVE CR-LOAN-TERM TO NP-ORIG.
 17113
 17114     MOVE 'R' TO NP-OPT.
 17115     CALL 'ECSNETRM'
 17116         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17117
 17118     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17119
 17120     IF STATUTORY-REQUIREMENT
 17121         MOVE EPR-R78                TO EPR-ST.
 17122
 17123 4160-EP-DO-LF-EP-R78.
 17124
 17125     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17126        (DTE-CLIENT EQUAL 'NCL')
 17127        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17128           (CR-MO EQUAL EOM-MO)
 17129           MOVE '*'            TO OB-DATE-1-SWITCH
 17130           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17131           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17132           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17133           COMPUTE WS-EPR-R78 (SUB3 1) =
 17134                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17135           GO TO 4190-EP-DO-LF-COMM
 17136        ELSE
 17137        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17138           (CR-MO EQUAL OB-MO (1))
 17139           MOVE '*'            TO OB-DATE-2-SWITCH
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 328
* ECS010.cbl
 17140           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17141           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17142           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17143           COMPUTE WS-EPR-R78 (SUB3 2) =
 17144                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17145           GO TO 4190-EP-DO-LF-COMM
 17146        ELSE
 17147        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17148           (CR-MO EQUAL OB-MO (2))
 17149           MOVE '*'            TO OB-DATE-3-SWITCH
 17150           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17151           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17152           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17153           COMPUTE WS-EPR-R78 (SUB3 3) =
 17154                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17155           GO TO 4190-EP-DO-LF-COMM
 17156        ELSE
 17157           GO TO 4190-EP-DO-LF-COMM.
 17158
 17159     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17160
 17161     IF DTE-R78 = '1'
 17162         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17163     ELSE
 17164         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17165
 17166     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17167
 17168     IF REM-TRM1 GREATER THAN +0
 17169         COMPUTE TEMP-7 ROUNDED EQUAL
 17170             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17171     ELSE
 17172         MOVE WE-LFPRM                TO TEMP-7.
 17173
 17174     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17175         MOVE TEMP-7                 TO EPR-ST.
 17176
 17177     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17178         MOVE ZEROS                  TO TEMP-8
 17179         GO TO 4165-END-LF-EP-R78.
 17180
 17181     IF EPR-ST = ZEROS
 17182         MOVE TEMP-7                 TO EPR-ST.
 17183
 17184     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17185         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17186         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17187         IF DTE-R78 = '1'
 17188             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17189
 17190     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17191
 17192     COMPUTE TEMP-8 ROUNDED =
 17193               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17194
 17195 4165-END-LF-EP-R78.
 17196
 17197     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 329
* ECS010.cbl
 17198         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17199     ELSE
 17200         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17201
 17202 4170-EP-DO-LF-EP-PRO.
 17203
 17204     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17205         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17206     ELSE
 17207         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17208
 17209     IF REM-TRM1 GREATER THAN +0
 17210         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17211     ELSE
 17212         MOVE WE-LFPRM                  TO TEMP-7.
 17213
 17214     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17215         MOVE ZEROS                     TO TEMP-8
 17216         GO TO 4175-END-LF-EP-PRO.
 17217
 17218     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17219         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17220             COMPUTE TEMP-5 ROUNDED =
 17221                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17222         ELSE
 17223             COMPUTE TEMP-5 ROUNDED =
 17224                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17225
 17226     COMPUTE TEMP-8 ROUNDED =
 17227                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17228
 17229     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17230
 17231 4175-END-LF-EP-PRO.
 17232
 17233     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17234
 17235     GO TO 4185-EP-DO-LF-STATUTORY.
 17236
 17237 4180-EP-DO-LF-EP-SUM.
 17238
 17239     IF REM-TRM1 NOT GREATER +0
 17240         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17241         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17242         GO TO 4190-EP-DO-LF-COMM.
 17243
 17244     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17245
 17246     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17247         MOVE ZEROS                 TO TEMP-7
 17248     ELSE
 17249         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17250                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17251
 17252     IF TEMP-7 NOT GREATER ZERO
 17253         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17254             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17255             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 330
* ECS010.cbl
 17256         ELSE
 17257             MOVE ZEROS             TO TEMP-7.
 17258
 17259     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17260     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17261     IF DTE-R78 = '1'
 17262         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17263
 17264     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17265     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17266
 17267     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17268
 17269     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17270
 17271     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17272         GO TO 4185-EP-DO-LF-STATUTORY.
 17273
 17274     MOVE EPR-R78                  TO EPR-ST.
 17275
 17276     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17277         MOVE ZEROS                 TO TEMP-8
 17278     ELSE
 17279         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17280                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17281
 17282     IF TEMP-8 NOT GREATER ZERO
 17283         GO TO 4185-EP-DO-LF-STATUTORY.
 17284
 17285     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17286                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17287
 17288     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17289                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17290
 17291     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17292                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17293
 17294 4185-EP-DO-LF-STATUTORY.
 17295
 17296*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17297*07636          MOVE EPR-R78                TO EPR-ST.
 17298     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17299         MOVE EPR-PRO                TO EPR-ST.
 17300
 17301     IF DTE-CLIENT = 'AHL'
 17302        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17303           MOVE EPR-R78          TO EPR-ST
 17304        ELSE
 17305           MOVE EPR-PRO          TO EPR-ST
 17306        END-IF
 17307     END-IF
 17308
 17309     IF (DTE-CLIENT = 'CID')
 17310        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17311                   OR
 17312            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17313            AND (CR-DT > 20091231)))
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 331
* ECS010.cbl
 17314        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17315        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17316           GO TO 4187-EP-DO-LF-STAT-ROA
 17317     END-IF.
 17318
 17319     IF EPR-ST NOT = ZEROS
 17320         GO TO 4190-EP-DO-LF-COMM.
 17321
 17322     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17323         MOVE EPR-R78                TO EPR-ST
 17324     ELSE
 17325         MOVE EPR-PRO                TO EPR-ST.
 17326
 17327     GO TO 4190-EP-DO-LF-COMM.
 17328
 17329 4187-EP-DO-LF-STAT-ROA.
 17330     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17331     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17332     MOVE 'L'                        TO DC-OPTION-CODE.
 17333     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17334     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17335     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17336        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17337        MOVE '3'                     TO  DC-OPTION-CODE
 17338        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17339                              8099-DATE-CONVERT-X
 17340        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17341     ELSE
 17342        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17343        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17344        MOVE +0                      TO  DC-ELAPSED-DAYS
 17345        MOVE '6'                     TO  DC-OPTION-CODE
 17346        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17347                              8099-DATE-CONVERT-X
 17348        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17349     END-IF.
 17350     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17351     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17352     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17353     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17354     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17355     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17356     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17357     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17358     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17359     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17360                                        CP-LOAN-TERM.
 17361     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17362                                        CP-RATING-BENEFIT-AMT.
 17363     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17364     MOVE CR-APR                     TO CP-LOAN-APR.
 17365     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17366     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17367     MOVE '6'                        TO CP-EARNING-METHOD.
 17368     MOVE '3'                        TO CP-PROCESS-TYPE.
 17369     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17370     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17371         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 332
* ECS010.cbl
 17372     ELSE
 17373         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17374     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17375     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17376     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17377     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17378     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17379     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17380
 17381     IF CP-STATE-STD-ABBRV = 'OR'
 17382        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17383     END-IF
 17384
 17385     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 17386        COMPUTE CP-ORIGINAL-BENEFIT =
 17387         (CR-LFAMT - CR-LFPRM)
 17388     END-IF
 17389
 17390     IF CP-TRUNCATED-LIFE
 17391        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17392     END-IF
 17393
 17394     IF CP-TERM-IS-DAYS
 17395        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17396     ELSE
 17397        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17398     END-IF
 17399
 17400     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17401
 17402     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17403
 17404 4190-EP-DO-LF-COMM.
 17405
 17406     MOVE +0 TO SUB1.
 17407     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17408         10 TIMES.
 17409
 17410     IF REIN-EP-FLG NOT = 'R'  OR
 17411        CR-POLICY-IS-REIN-ONLY
 17412         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17413         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17414         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17415         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17416
 17417     ADD ISS-BEN TO EW-ISS-BEN.
 17418     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17419     ADD CNC-BEN TO EW-CNC-BEN.
 17420     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17421     ADD ISS-PRM TO EW-ISS-PRM.
 17422     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17423     ADD CNC-PRM TO EW-CNC-PRM.
 17424     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17425
 17426     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17427     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17428     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17429
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 333
* ECS010.cbl
 17430     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17431        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17432     END-IF
 17433     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17434        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17435     END-IF
 17436
 17437     if dte-client = 'AHL'
 17438        COMPUTE ISS-PRMTAX =
 17439           (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17440           (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17441     else
 17442        COMPUTE ISS-PRMTAX rounded =
 17443           (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17444           (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17445     end-if
 17446
 17447     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17448
 17449     IF LIFE-FULLY-EARNED
 17450         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17451                                            (ISS-PRM - EPR-R78)
 17452         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17453                                            (ISS-PRM - EPR-PRO)
 17454         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17455                                            (ISS-PRM - EPR-ST).
 17456
 17457     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17458         IF  REIN-EP-FLG NOT = 'R'
 17459                 OR
 17460             CR-POLICY-IS-REIN-ONLY
 17461             MOVE 'L'      TO W-CLAIM-TYPE
 17462             MOVE EPR-R78  TO W-OPT-R78
 17463             MOVE EPR-PRO  TO W-OPT-PRO
 17464             MOVE EPR-ST   TO W-OPT-ST
 17465             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17466             MOVE ZEROS    TO EW-CLM-IBNR
 17467         ELSE
 17468             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17469                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17470                 MOVE ZEROS      TO EW-CLM-IBNR
 17471             ELSE
 17472                 MOVE ZEROS      TO EW-CLM-IBNR
 17473     ELSE
 17474         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17475             ADD WE-DTH-IBNR
 17476                       TO EW-CLM-IBNR
 17477         ELSE
 17478             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17479                     AND
 17480                 CR-DT GREATER THAN LAST-YRS-DATE
 17481                 COMPUTE  EW-CLM-IBNR
 17482                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17483
 17484     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17485     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17486
 17487 4191-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 334
* ECS010.cbl
 17488
 17489     MOVE 'Y'          TO EW-LEVEL-USED.
 17490
 17491     IF CR-POLICY-UNDERWRITTEN
 17492         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17493         MOVE EPEC-OPT-WORK-TABLE
 17494                              TO EPEC-UNDW-OPT-DATA-TABLE
 17495     ELSE
 17496         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17497         MOVE EPEC-OPT-WORK-TABLE
 17498                              TO EPEC-OPT-DATA-TABLE.
 17499
 17500     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 335
* ECS010.cbl
 17502 4194-SLOT-INTO-EFFECTED-MONTHS.
 17503
 17504     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17505             AND
 17506         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17507             AND
 17508         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17509                 OR
 17510          CR-LF-CANC-DT EQUAL ZEROS)
 17511             AND
 17512         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17513                 OR
 17514          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17515         MOVE 'Y'                 TO W-TABLE-USED-SW
 17516         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17517             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17518                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17519                 + CR-LIVES
 17520         ELSE
 17521             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17522                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17523
 17524 4194-EXIT.
 17525     EXIT.
 17526
 17527 4196-CALC-REM-AMT.
 17528
 17529     IF CR-LFTYP = 'QD'
 17530        MOVE +15.0               TO CR-APR
 17531     END-IF
 17532
 17533     MOVE +0                     TO WS-REM-AMT
 17534     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17535        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17536           COMPUTE WS-REM-AMT =
 17537             CR-LFAMT + CR-LFAMT-ALT
 17538        ELSE
 17539           MOVE CR-LFAMT         TO WS-REM-AMT
 17540        END-IF
 17541        GO TO 4199-EXIT
 17542     END-IF
 17543
 17544     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17545
 17546     IF REM-TRM1 = CR-LF-TERM
 17547        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17548           COMPUTE WS-REM-AMT =
 17549             CR-LFAMT + CR-LFAMT-ALT
 17550        ELSE
 17551           MOVE CR-LFAMT         TO WS-REM-AMT
 17552        END-IF
 17553        GO TO 4199-EXIT
 17554     END-IF
 17555
 17556     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17557        GO TO 4198-ORDINARY-REM
 17558     END-IF
 17559
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 336
* ECS010.cbl
 17560     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17561        GO TO 4198-CALC-TEXAS-REM
 17562     END-IF
 17563
 17564     IF CR-LFTYP = 'QD'
 17565        MOVE +15.0               TO CR-APR
 17566        MOVE 'N'                 TO
 17567                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17568        GO TO 4198-CALC-NET-PAY-REM
 17569     END-IF
 17570
 17571     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17572        GO TO 4198-CALC-NET-PAY-REM
 17573     END-IF
 17574
 17575     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17576        (CR-RATING-CLASS NOT = 'L ')
 17577         IF (CR-LF-TERM GREATER THAN +60) AND
 17578            (CR-DT GREATER THAN 19831031) AND
 17579            (CR-APR GREATER THAN ZERO)
 17580             GO TO 4198-CALC-NET-PAY-REM
 17581        END-IF
 17582     END-IF
 17583
 17584     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17585         IF (CR-LF-TERM GREATER THAN +61) AND
 17586            (CR-DT  GREATER THAN 19830318) AND
 17587            (CR-APR GREATER THAN ZERO)
 17588             GO TO 4198-CALC-NET-PAY-REM
 17589        END-IF
 17590     END-IF
 17591
 17592     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17593         IF (CR-LF-TERM GREATER THAN +62) AND
 17594            (CR-DT  GREATER THAN 19810831) AND
 17595            (CR-DT  LESS THAN 19830901) AND
 17596            (CR-APR GREATER THAN ZERO)
 17597             GO TO 4198-CALC-NET-PAY-REM
 17598        END-IF
 17599     END-IF
 17600
 17601     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17602         IF (CR-LF-TERM GREATER THAN +60) AND
 17603            (CR-DT  GREATER THAN 19831231) AND
 17604            (CR-APR GREATER THAN ZERO)
 17605             GO TO 4198-CALC-NET-PAY-REM
 17606        END-IF
 17607     END-IF
 17608
 17609     .
 17610 4198-ORDINARY-REM.
 17611
 17612     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17613         COMPUTE WS-REM-AMT ROUNDED =
 17614                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17615     ELSE
 17616         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17617     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 337
* ECS010.cbl
 17618
 17619     GO TO 4199-EXIT
 17620
 17621     .
 17622 4198-CALC-TEXAS-REM.
 17623
 17624     DIVIDE CR-LFAMT BY CR-LF-TERM
 17625         GIVING TEX-FACT-1.
 17626     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17627         GIVING TEX-FACT-2
 17628         REMAINDER TEX-FACT-3.
 17629
 17630     IF TEX-FACT-3 NOT = ZERO
 17631         ADD +1                  TO TEX-FACT-2
 17632     END-IF
 17633
 17634     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17635         MOVE CR-LFAMT           TO WS-REM-AMT
 17636     ELSE
 17637         COMPUTE WS-REM-AMT ROUNDED =
 17638             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17639     END-IF
 17640
 17641     GO TO 4199-EXIT
 17642
 17643     .
 17644 4198-CALC-NET-PAY-REM.
 17645
 17646     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17647     MOVE 'L'                        TO DC-OPTION-CODE.
 17648     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17649     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17650
 17651     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17652        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17653        MOVE '3'                 TO  DC-OPTION-CODE
 17654        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17655                                  8099-DATE-CONVERT-X
 17656        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17657     ELSE
 17658        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17659        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17660        MOVE +0                  TO  DC-ELAPSED-DAYS
 17661        MOVE '6'                 TO  DC-OPTION-CODE
 17662        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17663                                  8099-DATE-CONVERT-X
 17664        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17665     END-IF
 17666
 17667     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17668        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17669     ELSE
 17670        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17671     END-IF
 17672     MOVE CR-APR                 TO  CP-LOAN-APR
 17673     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17674     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17675     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 338
* ECS010.cbl
 17676     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17677                                 TO CP-SPECIAL-CALC-CD
 17678     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17679                                 TO  CP-BENEFIT-TYPE
 17680     MOVE CLAS-I-EP (CLAS-INDEXL)
 17681                                 TO  CP-EARNING-METHOD
 17682
 17683     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17684     IF (DTE-CLIENT = 'DCC')
 17685        AND (AM-DCC-PRODUCT-CODE <> spaces)
 17686        if cr-clp-state = spaces
 17687           move cr-state         to cr-clp-state
 17688        end-if
 17689        if cr-lftyp not = '00' and '  ' and 'DD'
 17690           move 'L'              to ws-dd-ben-type
 17691           move cr-lftyp         to ws-dd-ben-code
 17692        else
 17693           move 'A'              to ws-dd-ben-type
 17694           move cr-ahtyp         to ws-dd-ben-code
 17695        end-if
 17696        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17697           ((CR-clp-STATE = DD-STATE (D1))
 17698           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17699           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 17700           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 17701           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17702                           OR
 17703           D1 > max-pdef
 17704        END-PERFORM
 17705        IF D1 <= max-pdef
 17706           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17707              (P1 > +8)
 17708              OR (DD-PROD-CODE (D1 P1) = 'L')
 17709           END-PERFORM
 17710           IF P1 < +9
 17711              MOVE DD-MAX-BEN-AMT (D1 P1)
 17712                                 TO CP-R-MAX-TOT-BEN
 17713           END-IF
 17714        END-IF
 17715     END-IF
 17716
 17717     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17718
 17719     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17720
 17721     .
 17722 4199-EXIT.
 17723     EXIT.
 17724
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 339
* ECS010.cbl
 17726******************************************************************
 17727***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17728******************************************************************
 17729
 17730 4200-EP-DO-AH.
 17731
 17732     MOVE +0                         TO ISS-BEN  EPR-R78
 17733                                        CNC-BEN  EPR-PRO
 17734                                        ISS-PRM  EPR-ST
 17735                                        CNC-PRM
 17736                                        WX-CLM-AMT
 17737                                        WX-CLM-EXP
 17738                                        WX-CLM-CNT
 17739                                        WX-CLM-CRT
 17740                                        WX-ACTIVE-COUNT
 17741                                        ISS-PRMTAX
 17742                                        WX-CNC-CNT.
 17743     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17744
 17745     IF CR-AHTYP = ZERO
 17746         GO TO 4295-EP-DO-COUNT.
 17747
 17748     IF REIN-EP-FLG = 'R'
 17749         IF REIN-AH-FLG (SUB5) = SPACE
 17750             GO TO 4295-EP-DO-COUNT.
 17751
 17752     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17753     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17754     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17755
 17756     IF CR-POLICY-IS-DECLINED  OR
 17757        CR-POLICY-IS-VOID
 17758         GO TO 4290-CONTINUE.
 17759
 17760     MOVE CR-AH-TERM           TO ORIG-TERM.
 17761
 17762     IF CR-DT GREATER EW-COV-DTE
 17763         MOVE CR-DT            TO EW-COV-DTE.
 17764
 17765     IF NOT CR-POLICY-IS-RESTORE  AND
 17766        NOT CR-POLICY-IS-REISSUE
 17767        AND NOT CR-POLICY-IS-MONTHLY
 17768         MOVE WE-AHAMT         TO ISS-BEN
 17769         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17770         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17771         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17772         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17773                                   (ORIG-TERM * ISS-BEN).
 17774
 17775     MOVE CLAS-INDEXA     TO W-NDX.
 17776     MOVE RUN-DATE        TO VALUATION-DT
 17777     MOVE '6'             TO W-VAL-SOURCE.
 17778
 17779     IF REIN-EP-FLG = 'R'
 17780         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17781            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17782             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17783             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 340
* ECS010.cbl
 17784
 17785     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17786
 17787     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17788        (REM-TRM3 GREATER ZERO)
 17789        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17790            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17791                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17792            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17793                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17794          ELSE
 17795            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17796            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17797
 17798     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17799         GO TO 4210-BY-OPT-LOGIC.
 17800
 17801     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17802             AND
 17803         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17804             AND
 17805         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17806                 OR
 17807          CR-AH-CANC-DT EQUAL ZEROS)
 17808         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17809         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17810                 VARYING
 17811             SUBM FROM +1 BY +1
 17812                 UNTIL
 17813             SUBM GREATER THAN +13.
 17814
 17815     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17816     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17817
 17818 4210-BY-OPT-LOGIC.
 17819
 17820     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17821         ADD CR-LIVES TO EW-ISS-CNT
 17822         MOVE WE-AHPRM TO ISS-PRM
 17823         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17824                                (ORIG-TERM * CR-LIVES)
 17825         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17826         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17827         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17828                                   (ORIG-TERM * ISS-BEN)
 17829         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17830         GO TO 4225-CONTINUE.
 17831
 17832     IF (NOT CR-POLICY-IS-RESTORE) AND
 17833        (NOT CR-POLICY-IS-REISSUE)
 17834        AND (NOT CR-POLICY-IS-MONTHLY)
 17835        ADD +1 TO EW-ISS-CNT.
 17836
 17837     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17838
 17839     .
 17840 4225-CONTINUE.
 17841
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 341
* ECS010.cbl
 17842     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17843         NEXT  SENTENCE
 17844       ELSE
 17845         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17846
 17847     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17848     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17849     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17850     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17851     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17852     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17853
 17854     MOVE +0           TO SUB1.
 17855
 17856     IF DTE-CLIENT = 'DCC'
 17857        IF CR-AH-CANC-DT NOT = ZEROS
 17858           MOVE CR-AH-TERM       TO ORIG-TERM
 17859           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17860           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17861           MOVE '1'              TO W-VAL-SOURCE
 17862           PERFORM 8500-REMAINING-TERM-ROUTINE
 17863                                 THRU 8599-REM-TERM-X
 17864           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17865        END-IF
 17866     END-IF
 17867
 17868     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17869         10 TIMES.
 17870     MOVE +0                     TO SUB16
 17871     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17872        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17873
 17874     IF REIN-EP-FLG NOT = 'R'  OR
 17875        CR-POLICY-IS-REIN-ONLY
 17876         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17877         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17878         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17879         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17880
 17881     ADD ISS-BEN TO EW-ISS-BEN.
 17882     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17883     ADD CNC-BEN TO EW-CNC-BEN.
 17884     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17885     ADD ISS-PRM TO EW-ISS-PRM.
 17886     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17887     ADD CNC-PRM TO EW-CNC-PRM.
 17888     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17889
 17890     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17891     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17892     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17893
 17894     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17895        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17896     END-IF
 17897     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17898        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17899     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 342
* ECS010.cbl
 17900
 17901     if dte-client = 'AHL'
 17902        COMPUTE ISS-PRMTAX =
 17903           (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17904           (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17905     else
 17906        COMPUTE ISS-PRMTAX rounded =
 17907           (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17908           (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17909     end-if
 17910
 17911     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17912
 17913     IF A-H-FULLY-EARNED
 17914         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17915                                            (ISS-PRM - EPR-R78)
 17916         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17917                                            (ISS-PRM - EPR-PRO)
 17918         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17919                                            (ISS-PRM - EPR-ST).
 17920
 17921     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17922         IF  REIN-EP-FLG NOT = 'R'
 17923                 OR
 17924             CR-POLICY-IS-REIN-ONLY
 17925             MOVE 'A'      TO W-CLAIM-TYPE
 17926             MOVE EPR-R78  TO W-OPT-R78
 17927             MOVE EPR-PRO  TO W-OPT-PRO
 17928             MOVE EPR-ST   TO W-OPT-ST
 17929             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17930             MOVE ZEROS    TO EW-CLM-IBNR
 17931         ELSE
 17932             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17933                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17934                 MOVE ZEROS TO EW-CLM-IBNR
 17935             ELSE
 17936                 MOVE ZEROS TO EW-CLM-IBNR
 17937     ELSE
 17938         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17939             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17940         ELSE
 17941             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17942                 IF  CR-AH-POLICY-IS-ACTIVE
 17943                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17944                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17945                 ELSE
 17946                     NEXT SENTENCE
 17947             ELSE
 17948                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17949                     COMPUTE  EW-CLM-IBNR
 17950                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17951
 17952     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17953     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17954
 17955 4290-CONTINUE.
 17956*     DISPLAY ' 4290 '
 17957
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 343
* ECS010.cbl
 17958     MOVE 'Y'          TO EW-LEVEL-USED.
 17959
 17960     IF CR-POLICY-UNDERWRITTEN
 17961         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17962         MOVE EPEC-OPT-WORK-TABLE
 17963                              TO EPEC-UNDW-OPT-DATA-TABLE
 17964     ELSE
 17965         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17966         MOVE EPEC-OPT-WORK-TABLE
 17967                              TO EPEC-OPT-DATA-TABLE.
 17968
 17969
 17970 4295-EP-DO-COUNT.
 17971
 17972     IF REIN-EP-FLG = 'R'
 17973         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17974     ELSE
 17975         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17976
 17977     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 344
* ECS010.cbl
 17979 4296-SLOT-INTO-EFFECTED-MONTHS.
 17980
 17981     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17982             AND
 17983         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17984             AND
 17985         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17986                 OR
 17987          CR-AH-CANC-DT EQUAL ZEROS)
 17988         MOVE 'Y'                 TO W-TABLE-USED-SW
 17989         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17990             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17991                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17992                 + CR-LIVES
 17993         ELSE
 17994             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17995                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17996
 17997 4296-EXIT.
 17998     EXIT.
 17999
 18000 4299-EPBX.
 18001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 345
* ECS010.cbl
 18003******************************************************************
 18004***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 18005******************************************************************
 18006
 18007 4300-EP-COMM-LOOP.
 18008
 18009     IF DTE-CLIENT = 'DMD'
 18010         GO TO 4350-EP-COMM-LOOP-X.
 18011
 18012     ADD +1                         TO SUB1.
 18013     MOVE ZEROS                     TO SUB16.
 18014
 18015     IF CR-ADDL-CLP NOT NUMERIC
 18016        MOVE ZEROS               TO CR-ADDL-CLP
 18017     END-IF
 18018     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 18019         GO TO 4350-EP-COMM-LOOP-X.
 18020
 18021 4300-AGENT-LOOP.
 18022
 18023     ADD +1                         TO SUB16.
 18024
 18025     IF SUB16 GREATER THAN WS-LOOP-MAX
 18026         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18027         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18028         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18029                                     TO WS-ABEND-MESSAGE
 18030         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18031         MOVE 4001                   TO WS-ABEND-CODE
 18032         GO TO ABEND-PGM.
 18033
 18034     IF EW-AGT-NO (SUB16) = SPACES
 18035         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 18036         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 18037     ELSE
 18038         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 18039            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 18040             NEXT SENTENCE
 18041         ELSE
 18042             GO TO 4300-AGENT-LOOP.
 18043
 18044     IF EW-LF-AH = AH-OVERRIDE-L1
 18045         GO TO 4350-EP-COMM-LOOP-A.
 18046
 18047     IF (DTE-CLIENT = 'DCC')
 18048        AND (REIN-EP-FLG = 'R')
 18049        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18050        AND (WE-LFPRM NOT = ZEROS)
 18051        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18052           COMPUTE ISS-WK ROUNDED =
 18053              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 18054        ELSE
 18055           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 18056               (CR-LFAMT + CR-LFAMT-ALT)
 18057           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 18058              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 18059        END-IF
 18060     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 346
* ECS010.cbl
 18061        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18062                             OR 'J' OR 'N'
 18063           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 18064        ELSE
 18065           IF CR-AGT-TYPE (SUB1) = 'A'
 18066              COMPUTE ISS-WK ROUNDED =
 18067                   CR-LF-CLP * CR-LCOM-L (SUB1)
 18068           ELSE
 18069              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18070                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 18071                 COMPUTE ISS-WK ROUNDED =
 18072                      CR-LF-CLP * CR-LCOM-L (SUB1)
 18073              ELSE
 18074                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 18075                    * CR-LCOM-L (SUB1)
 18076              END-IF
 18077           END-IF
 18078        END-IF
 18079     END-IF
 18080
 18081     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18082
 18083     MOVE ZEROS                  TO CNC-WK
 18084                                    CNC-FACT
 18085     IF DTE-CLIENT EQUAL 'XXX'
 18086         IF NOT CR-NO-LF-CHARGEBACK
 18087            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18088            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18089                                + CNC-WK
 18090            GO TO 4300-CONTINUE-LOOP.
 18091
 18092     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18093        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18094
 18095      IF (DTE-CLIENT = 'DCC')
 18096         AND (REIN-EP-FLG = 'R')
 18097         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18098         AND (WE-LFRFND NOT = ZEROS)
 18099         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18100            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18101            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18102               CR-LCOM-L (SUB1)
 18103            IF CR-ACCOUNT = '05500500DD'
 18104               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18105            END-IF
 18106         ELSE
 18107            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18108            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18109               * CR-LCOM-L (SUB1)
 18110         END-IF
 18111      ELSE
 18112        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18113                              OR 'L' OR 'J' OR 'K')
 18114           AND (CNC-PRM > +0)
 18115           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18116           IF CR-CANCEL-REASON = 'R'
 18117              MOVE 1             TO CNC-FACT
 18118           END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 347
* ECS010.cbl
 18119           COMPUTE CNC-WK = CNC-FACT *
 18120              (CR-LCOM-L (SUB1) * +1000)
 18121*       ELSE
 18122*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18123*          AND (CNC-PRM > +0)
 18124*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18125*                                THRU 4380-EXIT
 18126*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18127*          COMPUTE CNC-WK = CNC-FACT *
 18128*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18129*       ELSE
 18130*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18131*              AND (CR-AHTYP NOT = '00' AND '  ')
 18132*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18133*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18134*             COMPUTE CNC-WK = CNC-FACT *
 18135*                (CR-AHPRM - (CR-LFPRM-ALT
 18136*                + CR-ADDL-CLP))
 18137         ELSE
 18138            IF (CR-AGT-TYPE (SUB1) = 'A')
 18139                      OR
 18140              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18141                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18142              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18143              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18144                CR-LCOM-L (SUB1)
 18145            ELSE
 18146               COMPUTE CNC-WK  ROUNDED =
 18147                 CNC-PRM * CR-LCOM-L (SUB1)
 18148            END-IF
 18149         END-IF
 18150*       END-IF
 18151      END-IF
 18152        COMPUTE EW-CNC-COM (SUB16) =
 18153                                  EW-CNC-COM (SUB16) + CNC-WK
 18154     END-IF
 18155
 18156     if (ws-dcc-cnc-flag = 'Y')
 18157        and (rein-ep-flg not = 'R')
 18158        move cnc-wk              to dx-l-pc (sub1)
 18159     end-if
 18160
 18161     .
 18162 4300-CONTINUE-LOOP.
 18163
 18164*     DISPLAY ' 4300 CONTINUE '
 18165     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18166               OR
 18167        ((ISS-WK - CNC-WK) = ZEROS)
 18168        MOVE ZEROS              TO COMM-WK
 18169     ELSE
 18170        COMPUTE EC-FACT ROUNDED =
 18171           EPR-R78 / (ISS-PRM - CNC-PRM)
 18172        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18173     END-IF
 18174
 18175     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18176
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 348
* ECS010.cbl
 18177     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18178               OR
 18179        ((ISS-WK - CNC-WK) = ZEROS)
 18180        MOVE ZEROS              TO COMM-WK
 18181     ELSE
 18182        COMPUTE EC-FACT ROUNDED =
 18183           EPR-PRO / (ISS-PRM - CNC-PRM)
 18184        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18185     END-IF
 18186     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18187
 18188     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18189               OR
 18190        ((ISS-WK - CNC-WK) = ZEROS)
 18191        MOVE ZEROS              TO COMM-WK
 18192     ELSE
 18193        COMPUTE EC-FACT ROUNDED =
 18194           EPR-ST / (ISS-PRM - CNC-PRM)
 18195        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18196     END-IF
 18197
 18198     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18199
 18200     IF LIFE-FULLY-EARNED
 18201         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18202                                                CR-LCOM-L (SUB1)
 18203         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18204                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18205         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18206                                                CR-LCOM-L (SUB1)
 18207         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18208                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18209
 18210     GO TO 4350-EP-COMM-LOOP-X.
 18211
 18212 4350-EP-COMM-LOOP-A.
 18213
 18214     IF (DTE-CLIENT = 'DCC')
 18215        AND (REIN-EP-FLG = 'R')
 18216        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18217        AND (WE-AHPRM NOT = ZEROS)
 18218
 18219        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18220           COMPUTE ISS-WK ROUNDED =
 18221              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18222        ELSE
 18223           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18224           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18225              * CR-LCOM-AH (SUB1)
 18226        END-IF
 18227     ELSE
 18228        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18229                                    OR 'J' OR 'N'
 18230           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18231        ELSE
 18232           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18233             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18234              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 349
* ECS010.cbl
 18235              + CR-ADDL-CLP)
 18236           ELSE
 18237              IF (CR-AGT-TYPE (SUB1) = 'M')
 18238                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18239                              = 'G' OR 'L')
 18240                 COMPUTE ISS-WK ROUNDED =
 18241                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18242              ELSE
 18243                 IF CR-AGT-TYPE (SUB1) = 'A'
 18244                    COMPUTE ISS-WK ROUNDED =
 18245                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18246                 ELSE
 18247                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18248                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18249                                     'D')
 18250                       COMPUTE ISS-WK ROUNDED =
 18251                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18252                    ELSE
 18253                       COMPUTE ISS-WK  ROUNDED =
 18254                         ISS-PRM * CR-LCOM-AH (SUB1)
 18255                    END-IF
 18256                 END-IF
 18257              END-IF
 18258           END-IF
 18259        END-IF
 18260     END-IF
 18261
 18262     COMPUTE EW-ISS-COM (SUB16) =
 18263             EW-ISS-COM (SUB16) + ISS-WK.
 18264
 18265     MOVE ZEROS                  TO CNC-WK
 18266     IF DTE-CLIENT EQUAL 'XXX'
 18267         IF NOT CR-NO-LF-CHARGEBACK
 18268           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18269           COMPUTE EW-CNC-COM (SUB16) =
 18270                   EW-CNC-COM (SUB16) + CNC-WK
 18271           GO TO 4300-CONTINUE-LOOP-AH.
 18272
 18273     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18274        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18275        EVALUATE TRUE
 18276           WHEN DTE-CLIENT = 'DCC'
 18277             AND (REIN-EP-FLG = 'R')
 18278             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18279             AND (WE-AHRFND NOT = ZEROS)
 18280             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18281                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18282                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18283                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18284             ELSE
 18285                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18286                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18287                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18288             END-IF
 18289           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18290             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18291             AND (CNC-PRM > +0)
 18292             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 350
* ECS010.cbl
 18293           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18294             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18295             AND (CNC-PRM > +0)
 18296             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18297           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18298                              OR 'L' OR 'J' OR 'K')
 18299             AND (CNC-PRM > +0)
 18300             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18301             IF CR-CANCEL-REASON = 'R'
 18302                MOVE 1             TO CNC-FACT
 18303             END-IF
 18304             COMPUTE CNC-WK = CNC-FACT *
 18305                (CR-LCOM-AH (SUB1) * +1000)
 18306
 18307           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18308             AND (CNC-PRM > +0)
 18309             AND (CNC-PRM = ISS-PRM)
 18310             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18311
 18312           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18313             AND (CNC-PRM > +0)
 18314             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18315           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18316              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18317                              = 'G' OR 'L')
 18318              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18319              COMPUTE CNC-WK = CNC-FACT *
 18320                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18321           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18322              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18323              IF (CR-CANCEL-REASON = 'R')
 18324                 AND (CNC-PRM > +0)
 18325                 MOVE +1      TO CNC-FACT
 18326              END-IF
 18327              COMPUTE CNC-WK = CNC-FACT *
 18328              (CR-AHPRM - (CR-LFPRM-ALT
 18329                 + CR-ADDL-CLP))
 18330           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18331                      OR
 18332              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18333               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18334               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18335               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18336                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18337            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18338                      CNC-PRM * CR-LCOM-AH (SUB1)
 18339        END-EVALUATE
 18340        COMPUTE EW-CNC-COM (SUB16) =
 18341           EW-CNC-COM (SUB16) + CNC-WK
 18342     END-IF
 18343
 18344     if (ws-dcc-cnc-flag = 'Y')
 18345        and (rein-ep-flg not = 'R')
 18346        move cnc-wk              to dx-a-pc (sub1)
 18347     end-if
 18348
 18349*      IF (DTE-CLIENT = 'DCC')
 18350*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 351
* ECS010.cbl
 18351*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18352*         AND (WE-AHRFND NOT = ZEROS)
 18353*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18354*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18355*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18356*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18357*         ELSE
 18358*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18359*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18360*            * CR-LCOM-AH (SUB1)
 18361*         END-IF
 18362*      ELSE
 18363*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18364*                              OR 'L' OR 'J' OR 'K')
 18365*           AND (CNC-PRM > +0)
 18366*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18367*           IF CR-CANCEL-REASON = 'R'
 18368*              MOVE 1             TO CNC-FACT
 18369*           END-IF
 18370*           COMPUTE CNC-WK = CNC-FACT *
 18371*              (CR-LCOM-AH (SUB1) * +1000)
 18372*        ELSE
 18373*          IF CR-AGT-TYPE (SUB1) = 'N'
 18374*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18375*                                 THRU 4380-EXIT
 18376**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18377**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18378**            IF CNC-PRM NOT = ISS-PRM
 18379**               COMPUTE CNC-WK = CNC-FACT *
 18380**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18381**            ELSE
 18382**               COMPUTE CNC-WK = CNC-FACT *
 18383**               (CR-LCOM-AH (SUB1) * +1000)
 18384**            END-IF
 18385*          ELSE
 18386*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18387*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18388*                              = 'G' OR 'L')
 18389*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18390*              COMPUTE CNC-WK = CNC-FACT *
 18391*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18392*           ELSE
 18393*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18394*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18395*                 IF CR-CANCEL-REASON = 'R'
 18396*                    MOVE +1      TO CNC-FACT
 18397*                 END-IF
 18398*                 COMPUTE CNC-WK = CNC-FACT *
 18399*                 (CR-AHPRM - (CR-LFPRM-ALT
 18400*                    + CR-ADDL-CLP))
 18401*              ELSE
 18402*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18403*                           OR
 18404*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18405*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18406*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18407*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18408*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 352
* ECS010.cbl
 18409*                 ELSE
 18410*                    COMPUTE CNC-WK  ROUNDED =
 18411*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18412*                 END-IF
 18413*              END-IF
 18414*           END-IF
 18415*          END-IF
 18416*        END-IF
 18417**       END-IF
 18418*      END-IF
 18419*        COMPUTE EW-CNC-COM (SUB16) =
 18420*           EW-CNC-COM (SUB16) + CNC-WK
 18421*     END-IF
 18422
 18423     .
 18424 4300-CONTINUE-LOOP-AH.
 18425
 18426     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18427        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18428        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18429        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18430        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18431           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18432        END-IF
 18433     END-IF
 18434
 18435*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18436     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18437                OR
 18438        ((ISS-WK - CNC-WK) = ZEROS)
 18439        MOVE ZEROS          TO COMM-WK
 18440     ELSE
 18441        COMPUTE EC-FACT ROUNDED =
 18442           EPR-R78 / (ISS-PRM - CNC-PRM)
 18443        IF WS-DDF-AH-CB (SUB1) = 'N'
 18444           MOVE ISS-WK           TO COMM-WK
 18445        ELSE
 18446           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18447        END-IF
 18448     END-IF
 18449
 18450     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18451
 18452     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18453                OR
 18454        ((ISS-WK - CNC-WK) = ZEROS)
 18455        MOVE ZEROS          TO COMM-WK
 18456     ELSE
 18457        COMPUTE EC-FACT ROUNDED =
 18458           EPR-PRO / (ISS-PRM - CNC-PRM)
 18459        IF WS-DDF-AH-CB (SUB1) = 'N'
 18460           MOVE ISS-WK           TO COMM-WK
 18461        ELSE
 18462           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18463        END-IF
 18464     END-IF
 18465
 18466     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 353
* ECS010.cbl
 18467
 18468     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18469                OR
 18470        ((ISS-WK - CNC-WK) = ZEROS)
 18471        MOVE ZEROS          TO COMM-WK
 18472     ELSE
 18473        EVALUATE TRUE
 18474           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18475              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18476                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18477                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18478           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18479             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18480              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18481           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18482              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18483              MOVE ISS-WK TO COMM-WK
 18484           WHEN OTHER
 18485              COMPUTE EC-FACT ROUNDED =
 18486                EPR-ST / (ISS-PRM - CNC-PRM)
 18487              COMPUTE COMM-WK ROUNDED = EC-FACT
 18488                 * (ISS-WK - CNC-WK)
 18489        END-EVALUATE
 18490     END-IF
 18491
 18492     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18493
 18494     IF A-H-FULLY-EARNED
 18495         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18496                                                CR-LCOM-AH (SUB1)
 18497         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18498                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18499         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18500                                                CR-LCOM-AH (SUB1)
 18501         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18502                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18503
 18504 4350-EP-COMM-LOOP-X.
 18505     EXIT.
 18506
 18507******************************************************************
 18508***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18509******************************************************************
 18510
 18511 4375-EP-BANK-COMM.
 18512*     DISPLAY ' 4375 '
 18513
 18514     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18515        GO TO 4375-EXIT
 18516     END-IF
 18517     .
 18518 4375-BANK-LOOP.
 18519
 18520     ADD +1                      TO SUB16
 18521
 18522     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18523        GO TO 4375-EXIT
 18524     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 354
* ECS010.cbl
 18525
 18526     IF SUB16 GREATER THAN WS-LOOP-MAX
 18527         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18528         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18529         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18530                                     TO WS-ABEND-MESSAGE
 18531         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18532         MOVE 4001                   TO WS-ABEND-CODE
 18533         PERFORM ABEND-PGM
 18534     END-IF
 18535
 18536     IF EW-AGT-NO (SUB16) = SPACES
 18537        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18538        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18539     ELSE
 18540        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18541           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18542           CONTINUE
 18543        ELSE
 18544           GO TO 4375-BANK-LOOP
 18545        END-IF
 18546     END-IF
 18547
 18548     IF CS-COM-TYP  (SUB1) = 'B'
 18549        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18550     END-IF
 18551
 18552     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18553
 18554     MOVE ZEROS                  TO CNC-WK
 18555                                    CNC-FACT
 18556
 18557     IF (CS-COM-TYP (SUB1) = 'B')
 18558        AND (CNC-PRM > +0)
 18559        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18560        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18561     END-IF
 18562
 18563     COMPUTE EW-CNC-COM (SUB16) =
 18564                  EW-CNC-COM (SUB16) + CNC-WK
 18565
 18566     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18567                OR
 18568        ((ISS-WK - CNC-WK) = ZEROS)
 18569        MOVE ZEROS          TO COMM-WK
 18570     ELSE
 18571        COMPUTE EC-FACT ROUNDED =
 18572           EPR-R78 / (ISS-PRM - CNC-PRM)
 18573        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18574     END-IF
 18575
 18576     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18577
 18578     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18579                OR
 18580        ((ISS-WK - CNC-WK) = ZEROS)
 18581        MOVE ZEROS          TO COMM-WK
 18582     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 355
* ECS010.cbl
 18583        COMPUTE EC-FACT ROUNDED =
 18584           EPR-PRO / (ISS-PRM - CNC-PRM)
 18585        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18586     END-IF
 18587
 18588     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18589
 18590     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18591                OR
 18592        ((ISS-WK - CNC-WK) = ZEROS)
 18593        MOVE ZEROS          TO COMM-WK
 18594     ELSE
 18595        COMPUTE EC-FACT ROUNDED =
 18596           EPR-ST / (ISS-PRM - CNC-PRM)
 18597        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18598     END-IF
 18599
 18600     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18601
 18602     IF A-H-FULLY-EARNED
 18603        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18604        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18605                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18606        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18607                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18608     END-IF
 18609
 18610     .
 18611 4375-EXIT.
 18612     EXIT.
 18613
 18614
 18615 4376-DCC-DDF-SPEC.
 18616
 18617     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18618                                 THRU 4910-EXIT
 18619
 18620     display ' acct - cert ' cr-account ' ' cr-cert-no
 18621     display ' orig term rem term ' orig-term ' ' rem-trm1
 18622     display ' agt type ' cr-agt-type (sub1)
 18623     COMPUTE CP-MONTH =
 18624        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18625     IF CP-MONTH = 0
 18626        MOVE 12 TO CP-MONTH
 18627     END-IF
 18628
 18629     EVALUATE TRUE
 18630        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18631           PERFORM 4380-REF-CSO-ADMIN-FEE
 18632                                 THRU 4380-EXIT
 18633        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18634           AND (CR-CANCEL-REASON = 'R')
 18635              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18636        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18637           EVALUATE TRUE
 18638              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18639                 OR (NOT DD-IU-PRESENT)
 18640                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 356
* ECS010.cbl
 18641                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18642                       / CR-AH-CLP
 18643                 end-if
 18644                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18645                    (CR-LCOM-AH (SUB1) * +1000)
 18646               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18647                  AND (DD-IU-PRESENT)
 18648                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18649                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18650                     WS-LO-UEF) * 3/12
 18651                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18652                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18653                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18654                    (CR-LCOM-AH (SUB1) * +1000)
 18655                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18656                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18657                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18658                     * (CP-MONTH - 3) / 9
 18659              WHEN (ORIG-TERM - REM-TRM1) > 12
 18660                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18661                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18662                    CP-MONTH / 12)
 18663           END-EVALUATE
 18664        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18665           EVALUATE TRUE
 18666              WHEN CR-CANCEL-REASON = 'R'
 18667                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18668                    + CR-ADDL-CLP))
 18669              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18670                 OR (NOT DD-IU-PRESENT)
 18671                   if ueclp-clp-fact = zeros
 18672                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18673                       / CR-AH-CLP
 18674                   end-if
 18675                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18676                       (CR-AHPRM - (CR-AH-CLP
 18677                       + CR-ADDL-CLP))
 18678              WHEN (ORIG-TERM - REM-TRM1) < 13
 18679                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18680                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18681                     WS-LO-UEF) * 3/12
 18682                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18683                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18684                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18685                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18686                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18687                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18688                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18689                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18690              WHEN (ORIG-TERM - REM-TRM1) > 12
 18691                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18692                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18693                    WS-LO-UEF) * CP-MONTH / 12)
 18694           END-EVALUATE
 18695     END-EVALUATE
 18696
 18697     .
 18698 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 357
* ECS010.cbl
 18699     EXIT.
 18700
 18701
 18702
 18703 4380-REF-CSO-ADMIN-FEE.
 18704
 18705*    IF CR-AH-CANC-DT NOT = ZEROS
 18706*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18707*       MOVE CR-AH-TERM          TO ORIG-TERM
 18708*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18709*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18710*       MOVE '1'                 TO W-VAL-SOURCE
 18711*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18712*                                THRU 8599-REM-TERM-X
 18713*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18714*    END-IF
 18715
 18716     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18717                                 THRU 4910-EXIT
 18718
 18719     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18720        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18721
 18722     MOVE ZEROS                  TO CNC-WK
 18723
 18724     EVALUATE TRUE
 18725        WHEN (REM-TRM1 = 0)
 18726           OR (CR-CANCEL-REASON = 'R')
 18727           DISPLAY ' REM TERM = 0 OR REPO'
 18728           MOVE 0                TO CNC-WK
 18729
 18730        WHEN REM-TRM1 = ORIG-TERM
 18731           DISPLAY ' REM TERM  = ORIG TERM '
 18732           MOVE ISS-WK           TO CNC-WK
 18733
 18734        WHEN (ORIG-TERM - REM-TRM1) < 4
 18735           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18736           COMPUTE CP-MONTH =
 18737              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18738           IF CP-MONTH = 0
 18739              MOVE 12 TO CP-MONTH
 18740           END-IF
 18741           DISPLAY ' CP MONTH ' CP-MONTH
 18742           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18743              (DD-1ST-YR-ALLOW (D1)
 18744              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18745              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18746           COMPUTE CNC-WK = W-FACTOR * 1
 18747
 18748**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18749
 18750        WHEN (ORIG-TERM - REM-TRM1) < 13
 18751           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18752           COMPUTE CP-MONTH =
 18753              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18754           IF CP-MONTH = 0
 18755              MOVE 12 TO CP-MONTH
 18756           END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 358
* ECS010.cbl
 18757           DISPLAY ' CP MONTH ' CP-MONTH
 18758           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18759              DD-1ST-YR-ALLOW (D1))
 18760              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18761              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18762           COMPUTE CNC-WK = W-FACTOR * 1
 18763
 18764****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18765
 18766        WHEN OTHER
 18767           DISPLAY ' OTHER '
 18768           COMPUTE CP-MONTH =
 18769              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18770           IF CP-MONTH = 0
 18771              MOVE 12 TO CP-MONTH
 18772           END-IF
 18773           DISPLAY ' CP MONTH ' CP-MONTH
 18774           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18775              DD-1ST-YR-ALLOW (D1))
 18776              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18777              * CP-MONTH / 12)
 18778           COMPUTE CNC-WK = W-FACTOR * 1
 18779     END-EVALUATE
 18780
 18781     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18782        ' ' CNC-WK
 18783
 18784     .
 18785 4380-EXIT.
 18786     EXIT.
 18787
 18788******************************************************************
 18789******************************************************************
 18790******************************************************************
 18791******************************************************************
 18792******************************************************************
 18793******************************************************************
 18794******************************************************************
 18795******************************************************************
 18796******************************************************************
 18797******************************************************************
 18798***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18799******************************************************************
 18800
 18801 S-4100-EP-DO-LF.
 18802
 18803     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18804                                        EPR-PRO
 18805                                        EPR-ST.
 18806
 18807     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18808     MOVE 'L'                    TO DC-OPTION-CODE.
 18809     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18810
 18811     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18812     MOVE -1                     TO DC-ELAPSED-DAYS.
 18813     MOVE '6'                    TO DC-OPTION-CODE.
 18814     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 359
* ECS010.cbl
 18815
 18816     MOVE +0                     TO DC-ELAPSED-MONTHS
 18817                                    DC-ELAPSED-DAYS.
 18818
 18819     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18820     MOVE ' '                    TO DC-OPTION-CODE.
 18821     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18822
 18823     IF NO-CONVERSION-ERROR
 18824        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18825     ELSE
 18826         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18827                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18828                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18829         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18830                                     TO WS-ABEND-MESSAGE
 18831         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18832         MOVE 4001                   TO WS-ABEND-CODE
 18833         GO TO ABEND-PGM.
 18834
 18835     IF CR-LFTYP = ZERO
 18836         GO TO S-4200-EP-DO-AH.
 18837
 18838     IF REIN-LF-FLG (SUB5) = SPACE
 18839         GO TO S-4200-EP-DO-AH.
 18840
 18841     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18842     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18843     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18844
 18845     MOVE CR-LF-TERM             TO ORIG-TERM.
 18846     MOVE CLAS-INDEXL            TO W-NDX.
 18847
 18848 S-4120-EP-DO-LF-CNCL.
 18849
 18850     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18851        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18852         GO TO S-4130-EP-DO-LF-EP.
 18853
 18854     COMPUTE EARNED-BY-CANCEL =
 18855                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18856
 18857 S-4130-EP-DO-LF-EP.
 18858
 18859     MOVE SPACE                  TO STATUTORY-SWITCH.
 18860
 18861     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18862     MOVE '9'                    TO W-VAL-SOURCE.
 18863     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18864
 18865     IF REM-TRM2 GREATER CR-LF-TERM
 18866         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18867         GO TO S-4190-EP-DO-LF-COMM.
 18868
 18869     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18870         GO TO S-4180-EP-DO-LF-EP-SUM.
 18871
 18872     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 360
* ECS010.cbl
 18873         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18874             IF REM-TRM2 NOT GREATER THAN +0
 18875                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18876                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18877                 GO TO S-4190-EP-DO-LF-COMM
 18878             ELSE
 18879                 NEXT SENTENCE
 18880         ELSE
 18881             IF W-BAL-REMTRM NOT GREATER +0
 18882                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18883                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18884                 GO TO S-4190-EP-DO-LF-COMM
 18885             ELSE
 18886                 NEXT SENTENCE
 18887     ELSE
 18888        IF (DTE-CLIENT EQUAL 'NCL') AND
 18889           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18890             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18891        ELSE
 18892         IF REM-TRM2 NOT GREATER +0  OR
 18893            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18894             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18895             GO TO S-4190-EP-DO-LF-COMM.
 18896
 18897     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18898         GO TO S-4140-EP-DO-LF-EP-TEX.
 18899
 18900     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18901         GO TO S-4150-EP-DO-LF-EP-NP.
 18902
 18903*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18904     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18905        (CR-RATING-CLASS NOT = 'L ')
 18906         IF (CR-APR GREATER THAN ZERO)  AND
 18907            (CR-LF-TERM GREATER THAN 060)  AND
 18908            (CR-DT GREATER THAN 19831031)
 18909             MOVE '*'             TO STATUTORY-SWITCH
 18910              GO TO S-4150-EP-DO-LF-EP-NP.
 18911
 18912     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18913         IF (CR-APR GREATER THAN ZERO)  AND
 18914            (CR-LF-TERM GREATER THAN 061)  AND
 18915            (CR-DT GREATER THAN 19830318)
 18916             MOVE '*'             TO STATUTORY-SWITCH
 18917              GO TO S-4150-EP-DO-LF-EP-NP.
 18918
 18919     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18920         IF (CR-APR GREATER THAN ZERO)  AND
 18921            (CR-LF-TERM GREATER THAN 062)  AND
 18922            (CR-DT GREATER THAN 19810831)  AND
 18923            (CR-DT LESS THAN 19830901)
 18924             MOVE '*'             TO STATUTORY-SWITCH
 18925              GO TO S-4150-EP-DO-LF-EP-NP.
 18926
 18927     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18928         IF (CR-APR GREATER THAN ZERO)  AND
 18929            (CR-LF-TERM GREATER THAN 060)  AND
 18930            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 361
* ECS010.cbl
 18931             MOVE '*'             TO STATUTORY-SWITCH
 18932              GO TO S-4150-EP-DO-LF-EP-NP.
 18933
 18934     GO TO S-4160-EP-DO-LF-EP-R78.
 18935
 18936 S-4140-EP-DO-LF-EP-TEX.
 18937
 18938     COMPUTE TEX-FACT-4 =
 18939         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18940     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18941         GIVING TEX-FACT-5
 18942             REMAINDER TEX-FACT-6.
 18943     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18944     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18945         (TEX-FACT-5 * CR-PMT-FREQ) +
 18946         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18947     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18948
 18949     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18950
 18951     GO TO S-4170-EP-DO-LF-EP-PRO.
 18952
 18953 S-4150-EP-DO-LF-EP-NP.
 18954
 18955     IF WE-LFPRM = ZERO
 18956         GO TO S-4160-EP-DO-LF-EP-R78.
 18957
 18958     IF DTE-CLIENT = 'CRI'
 18959       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18960             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18961           GO TO S-4160-EP-DO-LF-EP-R78.
 18962
 18963     IF DTE-CLIENT = 'NCL'
 18964       IF CR-DT LESS THAN 19910101
 18965           GO TO S-4160-EP-DO-LF-EP-R78.
 18966
 18967     IF REM-TRM1 = CR-LF-TERM
 18968         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18969         GO TO S-4190-EP-DO-LF-COMM.
 18970
 18971     MOVE CR-APR TO NP-APR.
 18972     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18973     MOVE REM-TRM1 TO NP-REM.
 18974     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18975     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18976         MOVE CR-LOAN-TERM TO NP-ORIG.
 18977     MOVE 'R' TO NP-OPT.
 18978     CALL 'ECSNETRM'
 18979         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18980
 18981     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18982
 18983     IF STATUTORY-REQUIREMENT
 18984         MOVE EPR-R78                TO EPR-ST.
 18985
 18986 S-4160-EP-DO-LF-EP-R78.
 18987
 18988     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 362
* ECS010.cbl
 18989        (DTE-CLIENT EQUAL 'NCL')
 18990        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18991           (CR-MO EQUAL EOM-MO)
 18992           MOVE '*'            TO OB-DATE-1-SWITCH
 18993           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18994           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18995           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18996           COMPUTE WS-EPR-R78 (SUB3 1) =
 18997                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18998           GO TO S-4190-EP-DO-LF-COMM
 18999        ELSE
 19000        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19001           (CR-MO EQUAL OB-MO (1))
 19002           MOVE '*'            TO OB-DATE-2-SWITCH
 19003           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19004           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19005           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19006           COMPUTE WS-EPR-R78 (SUB3 2) =
 19007                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 19008           GO TO S-4190-EP-DO-LF-COMM
 19009        ELSE
 19010        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19011           (CR-MO EQUAL OB-MO (2))
 19012           MOVE '*'            TO OB-DATE-3-SWITCH
 19013           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19014           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19015           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19016           COMPUTE WS-EPR-R78 (SUB3 3) =
 19017                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 19018           GO TO S-4190-EP-DO-LF-COMM
 19019        ELSE
 19020           GO TO S-4190-EP-DO-LF-COMM.
 19021
 19022     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19023
 19024     IF DTE-R78 = '1'
 19025         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 19026     ELSE
 19027         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19028
 19029     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19030
 19031     IF REM-TRM1 GREATER THAN +0
 19032         COMPUTE TEMP-7 ROUNDED EQUAL
 19033             WE-LFPRM - (WE-LFPRM * TEMP-4)
 19034     ELSE
 19035         MOVE WE-LFPRM                TO TEMP-7.
 19036
 19037     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19038         MOVE TEMP-7                 TO EPR-ST.
 19039
 19040     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19041         MOVE ZEROS                  TO TEMP-8
 19042         GO TO S-4165-END-LF-EP-R78.
 19043
 19044     IF EPR-ST NOT = ZEROS
 19045         MOVE TEMP-7                 TO EPR-ST.
 19046
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 363
* ECS010.cbl
 19047     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19048         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 19049         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 19050         IF DTE-R78 = '1'
 19051             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 19052
 19053     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19054
 19055     COMPUTE TEMP-8 ROUNDED =
 19056               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 19057
 19058 S-4165-END-LF-EP-R78.
 19059
 19060     IF EPR-R78 = ZEROS
 19061         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 19062     ELSE
 19063         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 19064
 19065 S-4170-EP-DO-LF-EP-PRO.
 19066
 19067     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19068         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 19069     ELSE
 19070         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19071
 19072     IF REM-TRM1 GREATER THAN +0
 19073         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 19074     ELSE
 19075         MOVE WE-LFPRM                  TO TEMP-7.
 19076
 19077     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19078         MOVE ZEROS                     TO TEMP-8
 19079         GO TO S-4175-END-LF-EP-PRO.
 19080
 19081     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19082         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19083             COMPUTE TEMP-5 ROUNDED =
 19084                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19085         ELSE
 19086             COMPUTE TEMP-5 ROUNDED =
 19087                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19088
 19089     COMPUTE TEMP-8 ROUNDED =
 19090                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19091
 19092     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19093
 19094 S-4175-END-LF-EP-PRO.
 19095
 19096     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19097
 19098     GO TO S-4185-EP-DO-LF-STATUTORY.
 19099
 19100 S-4180-EP-DO-LF-EP-SUM.
 19101
 19102     IF REM-TRM1 NOT GREATER +0
 19103         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19104         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 364
* ECS010.cbl
 19105         GO TO S-4190-EP-DO-LF-COMM.
 19106
 19107     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19108         MOVE ZEROS                 TO TEMP-7
 19109     ELSE
 19110         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19111                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19112
 19113     IF TEMP-7 NOT GREATER ZERO
 19114         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19115             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19116             GO TO S-4190-EP-DO-LF-COMM
 19117         ELSE
 19118             MOVE ZEROS             TO TEMP-7.
 19119
 19120     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19121     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19122     IF DTE-R78 = '1'
 19123         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19124
 19125     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19126     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19127
 19128     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19129
 19130     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19131
 19132     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19133         GO TO S-4185-EP-DO-LF-STATUTORY.
 19134
 19135     MOVE EPR-R78                  TO EPR-ST.
 19136
 19137     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19138         MOVE ZEROS                 TO TEMP-8
 19139     ELSE
 19140         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19141                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19142
 19143     IF TEMP-8 NOT GREATER ZERO
 19144         GO TO S-4185-EP-DO-LF-STATUTORY.
 19145
 19146     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19147                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19148
 19149     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19150                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19151
 19152     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19153                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19154
 19155 S-4185-EP-DO-LF-STATUTORY.
 19156
 19157*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19158*08473          MOVE EPR-R78                TO EPR-ST.
 19159
 19160     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19161         MOVE EPR-PRO                TO EPR-ST.
 19162
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 365
* ECS010.cbl
 19163     IF (DTE-CLIENT = 'CID') AND
 19164        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19165        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19166        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19167           GO TO S-4187-EP-DO-LF-STAT-ROA
 19168     END-IF.
 19169
 19170     IF EPR-ST NOT = ZEROS
 19171         GO TO S-4190-EP-DO-LF-COMM.
 19172
 19173     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19174         MOVE EPR-R78                TO EPR-ST
 19175     ELSE
 19176         MOVE EPR-PRO                TO EPR-ST.
 19177
 19178     GO TO S-4190-EP-DO-LF-COMM.
 19179
 19180 S-4187-EP-DO-LF-STAT-ROA.
 19181     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19182     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19183     MOVE 'L'                        TO DC-OPTION-CODE.
 19184     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19185     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19186     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19187        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19188        MOVE '3'                 TO  DC-OPTION-CODE
 19189        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19190                              8099-DATE-CONVERT-X
 19191        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19192     ELSE
 19193        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19194        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19195        MOVE +0                  TO  DC-ELAPSED-DAYS
 19196        MOVE '6'                 TO  DC-OPTION-CODE
 19197        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19198                              8099-DATE-CONVERT-X
 19199        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19200     END-IF
 19201     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19202     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19203     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19204     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19205     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19206     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19207     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19208     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19209     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19210     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19211                                        CP-LOAN-TERM.
 19212     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19213                                        CP-RATING-BENEFIT-AMT.
 19214     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19215         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19216     ELSE
 19217         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19218     END-IF.
 19219     MOVE CR-APR                     TO CP-LOAN-APR.
 19220     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 366
* ECS010.cbl
 19221     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19222     MOVE '6'                        TO CP-EARNING-METHOD.
 19223     MOVE '3'                        TO CP-PROCESS-TYPE.
 19224     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19225     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19226         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19227     ELSE
 19228         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19229     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19230     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19231     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19232     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19233     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19234     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19235
 19236
 19237     IF CP-STATE-STD-ABBRV = 'OR'
 19238        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19239     END-IF
 19240
 19241     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19242        COMPUTE CP-ORIGINAL-BENEFIT =
 19243         (CR-LFAMT - CR-LFPRM)
 19244     END-IF
 19245
 19246     IF CP-TRUNCATED-LIFE
 19247        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19248     END-IF
 19249
 19250     IF CP-TERM-IS-DAYS
 19251        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19252     ELSE
 19253        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19254     END-IF
 19255
 19256     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19257
 19258     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19259
 19260 S-4190-EP-DO-LF-COMM.
 19261
 19262     IF EARNED-BY-CANCEL = ZEROS
 19263         GO TO S-4195-LF-COMM-CONTINUE.
 19264
 19265     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19266         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19267
 19268     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19269         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19270
 19271     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19272         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19273
 19274 S-4195-LF-COMM-CONTINUE.
 19275
 19276     MOVE +0 TO SUB1.
 19277     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19278         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 367
* ECS010.cbl
 19279
 19280     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19281     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19282     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19283
 19284     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19285     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19286     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19287
 19288     MOVE 'Y'          TO EW-LEVEL-USED.
 19289
 19290     IF CR-POLICY-UNDERWRITTEN
 19291         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19292
 19293     ELSE
 19294         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19295
 19296     GO TO S-4200-EP-DO-AH.
 19297
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 368
* ECS010.cbl
 19299******************************************************************
 19300***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19301******************************************************************
 19302
 19303 S-4200-EP-DO-AH.
 19304
 19305     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19306                                        EPR-PRO
 19307                                        EPR-ST.
 19308
 19309     IF CR-AHTYP = ZERO
 19310         GO TO S-4299-EPBX.
 19311
 19312     IF REIN-AH-FLG (SUB5) = SPACE
 19313         GO TO S-4299-EPBX.
 19314
 19315     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19316     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19317     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19318
 19319     MOVE CR-AH-TERM           TO ORIG-TERM.
 19320     MOVE CLAS-INDEXA          TO W-NDX.
 19321
 19322     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19323     MOVE '9'                    TO W-VAL-SOURCE.
 19324     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19325
 19326 S-4220-EP-DO-AH-CNCL.
 19327
 19328     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19329         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19330
 19331 S-4230-EP-DO-AH-EP.
 19332
 19333     IF REM-TRM2 GREATER CR-AH-TERM
 19334         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19335         GO TO S-4290-EP-DO-AH-COMM.
 19336
 19337     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19338         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19339
 19340 S-4235-CHECK-OB-AH-NCL.
 19341
 19342     IF (DTE-CLIENT EQUAL 'NCL') AND
 19343        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19344           MOVE WE-AHPRM         TO EPR-R78
 19345                                    EPR-PRO
 19346                                    EPR-ST
 19347        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19348           (CR-MO EQUAL EOM-MO)
 19349           MOVE '*'            TO OB-DATE-1-SWITCH
 19350           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19351           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19352           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19353           COMPUTE WS-EPR-R78 (SUB3 1) =
 19354                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19355            GO TO S-4290-EP-DO-AH-COMM
 19356        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 369
* ECS010.cbl
 19357        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19358           (CR-MO EQUAL OB-MO (1))
 19359           MOVE '*'            TO OB-DATE-2-SWITCH
 19360           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19361           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19362           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19363           COMPUTE WS-EPR-R78 (SUB3 2) =
 19364                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19365            GO TO S-4290-EP-DO-AH-COMM
 19366        ELSE
 19367        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19368           (CR-MO EQUAL OB-MO (2))
 19369           MOVE '*'            TO OB-DATE-3-SWITCH
 19370           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19371           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19372           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19373           COMPUTE WS-EPR-R78 (SUB3 3) =
 19374                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19375            GO TO S-4290-EP-DO-AH-COMM
 19376        ELSE
 19377            GO TO S-4290-EP-DO-AH-COMM.
 19378
 19379     IF REM-TRM2 NOT GREATER +0
 19380         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19381         GO TO S-4290-EP-DO-AH-COMM.
 19382
 19383     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19384         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19385         GO TO S-4290-EP-DO-AH-COMM.
 19386
 19387     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19388     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19389     IF DTE-R78 = '1'
 19390         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19391     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19392
 19393     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19394         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19395     ELSE
 19396         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19397
 19398     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19399     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19400
 19401     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19402     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19403
 19404     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19405
 19406*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19407*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19408
 19409     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19410
 19411     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19412        (CR-DT GREATER THAN  19921231)
 19413         IF CR-AH-TERM GREATER THAN  +61
 19414             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 370
* ECS010.cbl
 19415             MOVE '*' TO STATUTORY-SWITCH-AH
 19416             GO TO S-4245-EP-DO-AH-EP-AN
 19417         ELSE
 19418             GO TO S-4250-EP-DO-AH-STATUTORY.
 19419
 19420     IF AH-EARN-METHOD EQUAL 'N'
 19421         GO TO S-4240-EP-DO-AH-EP-NP.
 19422
 19423     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19424         MOVE 'A' TO AH-EARN-METHOD
 19425         GO TO S-4245-EP-DO-AH-EP-AN.
 19426
 19427     GO TO S-4250-EP-DO-AH-STATUTORY.
 19428
 19429 S-4240-EP-DO-AH-EP-NP.
 19430
 19431     IF WE-AHPRM = ZERO
 19432         GO TO S-4250-EP-DO-AH-STATUTORY.
 19433
 19434     IF CR-APR GREATER THAN +0
 19435         NEXT SENTENCE
 19436     ELSE
 19437         GO TO S-4250-EP-DO-AH-STATUTORY.
 19438
 19439     IF DTE-CLIENT = 'NCL'
 19440       IF CR-DT LESS THAN 19910101
 19441           GO TO S-4250-EP-DO-AH-STATUTORY.
 19442
 19443     IF REM-TRM1 = CR-AH-TERM
 19444         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19445         GO TO S-4290-EP-DO-AH-COMM.
 19446
 19447     MOVE CR-APR TO NP-APR.
 19448     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19449     MOVE REM-TRM1 TO NP-REM.
 19450     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19451     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19452         MOVE CR-LOAN-TERM TO NP-ORIG.
 19453     MOVE 'R' TO NP-OPT.
 19454     CALL 'ECSNETRM'
 19455         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19456
 19457     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19458
 19459     GO TO S-4250-EP-DO-AH-STATUTORY.
 19460
 19461 S-4245-EP-DO-AH-EP-AN.
 19462     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19463     MOVE 'L'                        TO DC-OPTION-CODE.
 19464     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19465     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19466     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19467     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19468     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19469     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19470     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19471     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19472     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 371
* ECS010.cbl
 19473     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19474                                        CP-RATING-BENEFIT-AMT.
 19475     IF CP-STATE-STD-ABBRV = 'OR'
 19476         COMPUTE CP-RATING-BENEFIT-AMT =
 19477                                  CR-AHAMT * REM-TRM1.
 19478     MOVE CR-APR                     TO CP-LOAN-APR.
 19479     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19480     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19481     MOVE '3'                        TO CP-PROCESS-TYPE.
 19482     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19483     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19484
 19485     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19486         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19487     ELSE
 19488         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19489
 19490     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19491     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19492     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19493     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19494     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19495     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19496
 19497     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19498
 19499     IF CP-ERROR-RATE-NOT-FOUND  OR
 19500        CP-ERROR-RATE-IS-ZERO  OR
 19501        CP-ERROR-IN-DATES
 19502         GO TO S-4250-EP-DO-AH-STATUTORY.
 19503
 19504     COMPUTE EPR-R78 ROUNDED =
 19505             (REM-TRM1 * WE-AHAMT / +100 *
 19506               CP-PREMIUM-RATE)
 19507              / CR-AHPRM-CALC * CR-AHPRM
 19508
 19509     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19510
 19511     IF STATUTORY-REQUIREMENT-AH
 19512         MOVE EPR-R78                TO EPR-ST
 19513         GO TO S-4290-EP-DO-AH-COMM.
 19514
 19515 S-4250-EP-DO-AH-STATUTORY.
 19516     IF (DTE-CLIENT EQUAL 'CID') AND
 19517        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19518         GO TO S-4267-EP-DO-AH-STAT-ROA
 19519     END-IF.
 19520
 19521 S-4250-EP-DO-AH-STATUTORY-VA.
 19522
 19523     MOVE EPR-R78                    TO EPR-ST.
 19524
 19525     MOVE +0                         TO SUB1.
 19526
 19527 S-4255-EP-AH-STAT-LOOP.
 19528     ADD +1 TO SUB1.
 19529
 19530     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 372
* ECS010.cbl
 19531         MOVE EPR-PRO                TO EPR-ST
 19532     ELSE
 19533         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19534             GO TO S-4255-EP-AH-STAT-LOOP.
 19535
 19536     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19537         CR-DT GREATER THAN 19831031)
 19538                    OR
 19539        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19540         CR-DT GREATER THAN 19820629)
 19541                    OR
 19542        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19543         CR-DT GREATER THAN 19830831)
 19544             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19545
 19546     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19547       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19548         IF CR-DT LESS THAN 19970101
 19549             MOVE EPR-R78            TO EPR-ST
 19550         ELSE
 19551             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19552
 19553     GO TO S-4290-EP-DO-AH-COMM.
 19554
 19555 S-4267-EP-DO-AH-STAT-ROA.
 19556     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19557     MOVE 'L'                        TO DC-OPTION-CODE.
 19558     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19559     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19560     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19561     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19562     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19563     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19564     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19565     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19566     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19567     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19568                                        CP-RATING-BENEFIT-AMT.
 19569     IF CP-STATE-STD-ABBRV = 'OR'
 19570         COMPUTE CP-RATING-BENEFIT-AMT =
 19571                                  CR-AHAMT * REM-TRM1.
 19572     MOVE CR-APR                     TO CP-LOAN-APR.
 19573     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19574     MOVE 'A'                        TO CP-EARNING-METHOD.
 19575     MOVE '3'                        TO CP-PROCESS-TYPE.
 19576     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19577     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19578     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19579         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19580     ELSE
 19581         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19582     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19583     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19584     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19585     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19586     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19587     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19588
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 373
* ECS010.cbl
 19589     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19590
 19591     IF CP-ERROR-RATE-NOT-FOUND  OR
 19592        CP-ERROR-RATE-IS-ZERO  OR
 19593        CP-ERROR-IN-DATES
 19594         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19595
 19596     COMPUTE EPR-ST ROUNDED =
 19597             (REM-TRM1 * WE-AHAMT / +100 *
 19598               CP-PREMIUM-RATE)
 19599              / CR-AHPRM-CALC * CR-AHPRM
 19600
 19601     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19602
 19603     GO TO S-4290-EP-DO-AH-COMM.
 19604
 19605 S-4290-EP-DO-AH-COMM.
 19606
 19607     IF EARNED-BY-CANCEL = ZEROS
 19608         GO TO S-4295-AH-COMM-CONTINUE.
 19609
 19610     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19611         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19612
 19613     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19614         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19615
 19616     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19617         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19618
 19619 S-4295-AH-COMM-CONTINUE.
 19620
 19621     MOVE +0           TO SUB1.
 19622     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19623         10 TIMES.
 19624
 19625     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19626     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19627     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19628
 19629     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19630     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19631     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19632
 19633     MOVE 'Y'          TO EW-LEVEL-USED.
 19634
 19635     IF CR-POLICY-UNDERWRITTEN
 19636         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19637     ELSE
 19638         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19639
 19640
 19641 S-4299-EPBX.
 19642     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 374
* ECS010.cbl
 19644******************************************************************
 19645***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19646******************************************************************
 19647
 19648 S-4300-EP-COMM-LOOP.
 19649
 19650     ADD +1 TO SUB1.
 19651     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19652         GO TO S-4399-EP-COMM-LOOP-X.
 19653
 19654     IF EW-LF-AH = AH-OVERRIDE-L1
 19655         GO TO S-4350-EP-COMM-LOOP-A.
 19656
 19657*    IF CR-AGT-TYPE (SUB1) = 'K'
 19658*       COMPUTE COMM-WK =
 19659     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19660     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19661     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19662                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19663
 19664     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19665     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19666     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19667                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19668
 19669     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19670     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19671
 19672     GO TO S-4399-EP-COMM-LOOP-X.
 19673
 19674 S-4350-EP-COMM-LOOP-A.
 19675
 19676     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19677     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19678     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19679                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19680
 19681     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19682     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19683     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19684                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19685
 19686     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19687     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19688
 19689 S-4399-EP-COMM-LOOP-X.
 19690     EXIT.
 19691
 19692******************************************************************
 19693******************************************************************
 19694******************************************************************
 19695******************************************************************
 19696******************************************************************
 19697******************************************************************
 19698******************************************************************
 19699******************************************************************
 19700******************************************************************
 19701******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 375
* ECS010.cbl
 19703******************************************************************
 19704***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19705******************************************************************
 19706
 19707 4400-EP-FIND-TAB-ENT.
 19708
 19709     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19710         GO TO 4490-EP-FIND-TAB-SUB.
 19711     MOVE +1 TO SUB9.
 19712
 19713 4450-EP-FIND-TAB-LOOP.
 19714
 19715     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19716         GO TO 4490-EP-FIND-TAB-SUB.
 19717     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19718         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19719         GO TO 4490-EP-FIND-TAB-SUB.
 19720
 19721     ADD +1 TO SUB9.
 19722     IF SUB9 GREATER THAN +31
 19723         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19724         MOVE 0201 TO WS-ABEND-CODE
 19725         DISPLAY '******************************'
 19726         DISPLAY '***** ERROR LOCATION 020 *****'
 19727         DISPLAY '******************************'
 19728         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19729         GO TO ABEND-PGM.
 19730
 19731     GO TO 4450-EP-FIND-TAB-LOOP.
 19732
 19733 4490-EP-FIND-TAB-SUB.
 19734
 19735     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19736         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19737             ADD +1 TO SUB10
 19738             MOVE SUB10 TO SUB3
 19739             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19740         ELSE
 19741             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19742
 19743     IF WE-LF-AH = AH-OVERRIDE-L1
 19744         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19745             ADD +1 TO SUB10
 19746             MOVE SUB10 TO SUB3
 19747             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19748         ELSE
 19749             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19750
 19751*    IF SUB3 GREATER THAN +220
 19752*    IF SUB3 GREATER THAN +300
 19753     IF SUB3 GREATER THAN +900
 19754         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19755         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19756         MOVE 0202 TO WS-ABEND-CODE
 19757         DISPLAY '******************************'
 19758         DISPLAY '***** ERROR LOCATION 021 *****'
 19759         DISPLAY '******************************'
 19760         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 376
* ECS010.cbl
 19761         GO TO ABEND-PGM.
 19762
 19763     IF CR-POLICY-UNDERWRITTEN
 19764         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19765         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19766                                     TO EPEC-OPT-WORK-TABLE
 19767     ELSE
 19768         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19769         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19770
 19771     MOVE WE-REIN-CO         TO EW-REIN-CO
 19772                                EPEC-REIN-CO (SUB3)
 19773                                EPEC-REIN-CO-II (SUB3).
 19774     MOVE WE-LF-AH           TO EW-LF-AH
 19775                                EPEC-LF-AH (SUB3)
 19776                                EPEC-LF-AH-II (SUB3).
 19777     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19778                                EPEC-BEN-TYPE (SUB3)
 19779                                EPEC-BEN-TYPE-II (SUB3).
 19780
 19781 4499-EP-FIND-TAB-ENT-X.
 19782     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 377
* ECS010.cbl
 19784******************************************************************
 19785***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19786******************************************************************
 19787
 19788 4500-BUILD-EPEC-EXTRACT.
 19789
 19790     IF (DTE-CLIENT = 'DCC')
 19791*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19792        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19793     END-IF
 19794
 19795     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19796         VARYING SUB2 FROM +1 BY +1
 19797             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19798
 19799     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19800
 19801     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19802
 19803
 19804 4510-BUILD-EPEC-EXT.
 19805
 19806     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19807     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19808     IF EW-LEVEL-USED = 'Y'
 19809         MOVE SPACE                     TO W-UNDERWRITING-SW
 19810         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19811                 4518-BUILD-EPEC-RCD-X.
 19812
 19813     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19814     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19815     IF EW-LEVEL-USED = 'Y'
 19816         MOVE '*'                       TO W-UNDERWRITING-SW
 19817         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19818                 4518-BUILD-EPEC-RCD-X.
 19819
 19820     GO TO 4519-BUILD-EPEC-EXT-X.
 19821
 19822 4511-BUILD-EPEC-RECORD.
 19823
 19824     MOVE SPACES                        TO EP-RECORD.
 19825     MOVE 'EP'                          TO EP-RECORD-ID.
 19826     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19827     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19828     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19829     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19830                                           WS-EP-EFF-DTE-N.
 19831     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19832     IF EP-REI-CO NOT = SPACES
 19833         MOVE 'R'                       TO EP-REIN.
 19834     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19835     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19836
 19837     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19838     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19839     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19840
 19841     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 378
* ECS010.cbl
 19842     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19843     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19844
 19845     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19846     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19847     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19848     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19849
 19850     IF DTE-CLIENT NOT = 'NCL'
 19851         GO TO 4512-BUILD-EPEC-CONTINUE.
 19852
 19853     IF W-UNDERWRITTEN-DATA
 19854         GO TO 4512-BUILD-EPEC-CONTINUE.
 19855
 19856     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19857         GO TO 4512-BUILD-EPEC-CONTINUE.
 19858
 19859     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19860        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19861        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19862         NEXT SENTENCE
 19863     ELSE
 19864         GO TO 4512-BUILD-EPEC-CONTINUE.
 19865
 19866     IF OB-DATE-1-USED  OR
 19867        OB-DATE-2-USED  OR
 19868        OB-DATE-3-USED
 19869         NEXT SENTENCE
 19870     ELSE
 19871         GO TO 4512-BUILD-EPEC-CONTINUE.
 19872
 19873     IF OB-DATE-1-USED
 19874         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19875             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19876                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19877             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19878                                   EW-EPR-ST
 19879             GO TO 4512-BUILD-EPEC-CONTINUE
 19880         ELSE
 19881             GO TO 4512-BUILD-EPEC-CONTINUE.
 19882
 19883     IF OB-DATE-2-USED
 19884         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19885             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19886                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19887             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19888                                   EW-EPR-ST
 19889             GO TO 4512-BUILD-EPEC-CONTINUE
 19890         ELSE
 19891             GO TO 4512-BUILD-EPEC-CONTINUE.
 19892
 19893     IF OB-DATE-3-USED
 19894         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19895             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19896                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19897             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19898                                   EW-EPR-ST
 19899             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 379
* ECS010.cbl
 19900         ELSE
 19901             GO TO 4512-BUILD-EPEC-CONTINUE.
 19902
 19903 4512-BUILD-EPEC-CONTINUE.
 19904
 19905     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19906     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19907     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19908
 19909     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19910     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19911     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19912
 19913     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19914
 19915     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19916     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19917     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19918
 19919     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19920     MOVE ZEROS                         TO EP-CLM-PV.
 19921
 19922     if (dte-client = 'AHL')
 19923        and (ep-rcd-type = 'A')
 19924        and (ep-ben-code (1:1) = 'M')
 19925*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19926        continue
 19927     else
 19928        IF EP-RCD-TYPE = 'A' OR 'U'
 19929           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19930              PERFORM 4599A-CALC-IBNR
 19931                                 THRU 4599A-CALC-EXIT
 19932           end-if
 19933        end-if
 19934     end-if
 19935
 19936     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19937
 19938     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19939     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19940
 19941     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19942
 19943     IF EW-ISS-CNT = ZERO
 19944         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19945                                           EP-AVG-AGE
 19946       ELSE
 19947         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19948                                EW-ORIG-TERM / EW-ISS-CNT
 19949         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19950
 19951     IF EW-INFORCE-CNT = ZERO
 19952         MOVE ZERO                      TO EP-AVG-REM-TERM
 19953       ELSE
 19954         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19955                             EW-REM-TERM / EW-INFORCE-CNT.
 19956
 19957     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 380
* ECS010.cbl
 19958         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19959                                           EP-WEIGHTED-AGE
 19960       ELSE
 19961         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19962                                  EW-TERM-BEN / EW-ISS-BEN
 19963         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19964                                   EW-AGE-BEN / EW-ISS-BEN.
 19965
 19966     MOVE ZEROS                         TO
 19967         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19968         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19969
 19970     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19971                                           WS-EP-HI-COV-DT-N.
 19972     MOVE HIGH-CERT                     TO EP-HI-CERT
 19973                                           WS-EP-HI-CERT-N.
 19974     MOVE LOW-CERT                      TO EP-LO-CERT
 19975                                           WS-EP-LO-CERT-N.
 19976     IF DTE-PGM-OPT = '3'
 19977         MOVE 'P'                       TO EP-PURGE.
 19978
 19979     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19980         GO TO 4514-CONTINUE.
 19981
 19982     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19983
 19984     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19985         MOVE +1                 TO EP-LIFE-YEARS
 19986     ELSE
 19987         MOVE ZEROS              TO W-LIFE-YEARS
 19988         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19989                 VARYING
 19990             SUBM FROM +1 BY +1
 19991                 UNTIL
 19992             SUBM GREATER THAN +13
 19993         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19994             = W-LIFE-YEARS / 12
 19995             - (EPEC-LIFE-CTR (SUB2 1)
 19996             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19997         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19998         IF  EP-LIFE-YEARS LESS THAN +1
 19999             MOVE +1             TO EP-LIFE-YEARS.
 20000
 20001 4514-CONTINUE.
 20002
 20003     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 20004
 20005     MOVE SPACES                        TO EC-RECORD.
 20006     MOVE '1'                           TO WS-SEQ-NBR.
 20007     MOVE +0                            TO SUB3.
 20008     MOVE +0                            TO SUB4.
 20009     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 20010         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 20011         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 20012
 20013     GO TO 4518-BUILD-EPEC-RCD-X.
 20014
 20015 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 381
* ECS010.cbl
 20016
 20017     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 20018
 20019 4515-EXIT.
 20020     EXIT.
 20021
 20022 4518-BUILD-EPEC-RCD-X.
 20023     EXIT.
 20024
 20025 4519-BUILD-EPEC-EXT-X.
 20026     EXIT.
 20027
 20028 4520-BUILD-EPEC-LOAD-COMM.
 20029
 20030     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 20031
 20032     ADD +1 TO SUB3  SUB4.
 20033     MOVE ZEROS                  TO LEVELS-BUILT.
 20034
 20035 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20036
 20037     IF SUB4 GREATER THAN WS-LOOP-MAX
 20038         IF AGT-SW = 'X'
 20039             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20040                 THRU 4900-WRT-SUMMARY-X
 20041             MOVE ' '            TO AGT-SW
 20042             MOVE WS-LOOP-MAX    TO  SUB4
 20043             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20044         ELSE
 20045             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 20046
 20047     IF LEVELS-BUILT EQUAL +5
 20048         IF AGT-SW = 'X'
 20049             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20050                 THRU 4900-WRT-SUMMARY-X
 20051             MOVE ' '            TO AGT-SW
 20052             MOVE ZEROS          TO LEVELS-BUILT
 20053             ADD 1 TO WS-SEQ-NBR
 20054             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 20055             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 20056                     4540-BUILD-CLEAR-X
 20057                 VARYING SUB3 FROM +1 BY +1
 20058                 UNTIL SUB3 GREATER THAN +5
 20059             MOVE +1             TO SUB3
 20060             GO TO 4531-BUILD-EPEC-LOAD-COMM
 20061         ELSE
 20062             MOVE +1             TO SUB3
 20063             MOVE ZEROS          TO LEVELS-BUILT
 20064             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 20065
 20066     IF SUB4 GREATER THAN WS-LOOP-MAX
 20067         IF AGT-SW = 'X'
 20068             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20069                 THRU 4900-WRT-SUMMARY-X
 20070             MOVE ' '                   TO AGT-SW
 20071             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20072         ELSE
 20073             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 382
* ECS010.cbl
 20074
 20075 4531-BUILD-EPEC-LOAD-COMM.
 20076
 20077     IF (EW-AGT-NO (SUB4) = SPACES)
 20078                  OR
 20079        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20080         (EW-CNC-COM (SUB4) = ZEROS) AND
 20081         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20082         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20083         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20084         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20085         (EW-ECR-ST (SUB4) = ZEROS))
 20086         PERFORM 4540-BUILD-EPEC-CLEAR
 20087             THRU 4540-BUILD-CLEAR-X
 20088         ADD +1 TO SUB4
 20089         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20090
 20091     MOVE 'X'                           TO AGT-SW.
 20092     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20093     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20094     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20095     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20096     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20097     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20098     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20099     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20100     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20101
 20102     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20103
 20104     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20105
 20106 4539-BUILD-EPEC-LOAD-COMM-X.
 20107     EXIT.
 20108
 20109 4540-BUILD-EPEC-CLEAR.
 20110
 20111     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20112     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20113     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20114                                           EC-CNC-COMM (SUB3)
 20115                                           EC-COMM-78 (SUB3)
 20116                                           EC-COMM-PR (SUB3)
 20117                                           EC-COMM-ST (SUB3)
 20118                                           EC-COMM-78-ADJ (SUB3)
 20119                                           EC-COMM-PR-ADJ (SUB3).
 20120
 20121 4540-BUILD-CLEAR-X.
 20122     EXIT.
 20123
 20124 4541-CALC-IBNR.
 20125
 20126     MOVE +0                    TO TOT-AH-IBNR
 20127                                   TOT-AH-PRM
 20128                                   TOT-AH-PD-CLMS
 20129                                   TOT-AH-CLMRSV
 20130                                   TOT-LF-IBNR
 20131                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 383
* ECS010.cbl
 20132                                   TOT-LF-PD-CLMS
 20133                                   TOT-LF-CLMRSV
 20134
 20135     MOVE +0                    TO RTOT-AH-IBNR
 20136                                   RTOT-AH-PRM
 20137                                   RTOT-AH-PRMB
 20138                                   RTOT-AH-PD-CLMS
 20139                                   RTOT-AH-CLMRSV
 20140                                   RTOT-LF-IBNR
 20141                                   RTOT-LF-PRM
 20142                                   RTOT-LF-PD-CLMS
 20143                                   RTOT-LF-CLMRSV
 20144
 20145     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20146        (SUB2 > +900)
 20147        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20148*       IF W-UNDERWRITTEN-DATA
 20149*          MOVE EPEC-LEVELS-II (SUB2)
 20150*                                TO EPEC-WORK
 20151*       ELSE
 20152           MOVE EPEC-LEVELS (SUB2)
 20153                                 TO EPEC-WORK
 20154*       END-IF
 20155*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20156           IF EW-REIN-CO = SPACES
 20157              CONTINUE
 20158*             IF EW-LF-AH = 'L'
 20159*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20160*                   + EW-EPR-ST
 20161*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20162*                   + EW-CLM-AMT
 20163*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20164*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20165*             ELSE
 20166*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20167*                   + EW-EPR-ST
 20168*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20169*                   + EW-CLM-AMT
 20170*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20171*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20172           ELSE
 20173              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20174                 EW-LF-AH ' ' EW-BEN-TYPE
 20175              IF EW-LF-AH = 'L'
 20176                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20177                    + EW-EPR-ST
 20178                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20179                    + EW-CLM-AMT
 20180                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20181                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20182              ELSE
 20183                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20184                    + EW-EPR-ST
 20185                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20186                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20187                       + EW-EPR-ST
 20188                 END-IF
 20189                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 384
* ECS010.cbl
 20190                    + EW-CLM-AMT
 20191                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20192                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20193              END-IF
 20194           END-IF
 20195*       END-IF
 20196     END-PERFORM
 20197
 20198*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20199*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20200*    IF TOT-AH-IBNR < ZEROS
 20201*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20202*    END-IF
 20203*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20204*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20205*    IF TOT-LF-IBNR < ZEROS
 20206*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20207*    END-IF
 20208
 20209     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20210        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20211     IF RTOT-AH-IBNR < ZEROS
 20212        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20213     END-IF
 20214     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20215        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20216     IF RTOT-LF-IBNR < ZEROS
 20217        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20218     END-IF
 20219
 20220     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20221        (SUB2 > +900)
 20222        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20223*       IF W-UNDERWRITTEN-DATA
 20224*          MOVE EPEC-LEVELS-II (SUB2)
 20225*                                TO EPEC-WORK
 20226*       ELSE
 20227           MOVE EPEC-LEVELS (SUB2)
 20228                                 TO EPEC-WORK
 20229*       END-IF
 20230*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20231           IF EW-REIN-CO = SPACES
 20232              CONTINUE
 20233*             IF EW-LF-AH = 'L'
 20234*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20235*                   / TOT-LF-PRM
 20236*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20237*                   * RTOT-LF-IBNR
 20238**                  * TOT-LF-IBNR
 20239*             ELSE
 20240*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20241*                   / TOT-AH-PRM
 20242*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20243*                   * RTOT-AH-IBNR
 20244**                  * TOT-AH-IBNR
 20245*             END-IF
 20246           ELSE
 20247              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 385
* ECS010.cbl
 20248                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20249                    EW-EPR-ST ' ' RTOT-AH-PRM
 20250              IF EW-LF-AH = 'L'
 20251                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20252                    / RTOT-LF-PRM
 20253                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20254                    * RTOT-LF-IBNR
 20255              ELSE
 20256                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20257                    / RTOT-AH-PRMB
 20258                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20259                    * RTOT-AH-IBNR
 20260              END-IF
 20261              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20262                 move zeros to ew-clm-ibnr
 20263              end-if
 20264           END-IF
 20265*       END-IF
 20266*       IF W-UNDERWRITTEN-DATA
 20267*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20268*       ELSE
 20269           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20270*       END-IF
 20271     END-PERFORM
 20272
 20273     .
 20274 4541-EXIT.
 20275     EXIT.
 20276
 20277 4545-BUILD-BASE.
 20278
 20279     MOVE 'EC'                   TO EC-RECORD-ID.
 20280     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20281     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20282     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20283     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20284                                    WS-EC-EFF-DTE.
 20285     MOVE EW-REIN-CO             TO EC-REI-CO.
 20286     IF EC-REI-CO NOT = SPACES
 20287         MOVE 'R'                TO EC-REIN.
 20288     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20289     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20290     IF DTE-PGM-OPT = '3'
 20291         MOVE 'P'                TO EC-PURGE.
 20292     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20293
 20294 4545-BUILD-BASE-X.
 20295     EXIT.
 20296
 20297******************************************************************
 20298***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20299******************************************************************
 20300
 20301 4550-CLEAR-EPEC-TOTALS.
 20302
 20303     MOVE LOW-CERT             TO SV-LO-CERT.
 20304     MOVE HIGH-CERT            TO SV-HI-CERT.
 20305     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 386
* ECS010.cbl
 20306     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20307
 20308     MOVE +1                   TO SUB9.
 20309     MOVE +0                   TO SUB10.
 20310     MOVE ZERO                 TO EW-REIN-CO
 20311                                  EW-BEN-TYPE.
 20312     MOVE SPACE                TO EP-FLG
 20313                                  EW-LF-AH
 20314                                  EW-LEVEL-USED
 20315                                  W-TABLE-USED-SW.
 20316
 20317     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20318                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20319                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20320                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20321                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20322                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20323                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20324                                  EW-CLM-AMT     EW-COV-DTE
 20325                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20326                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20327                                  EW-CLM-CRT     EW-ISS-CNT
 20328                                  EW-CNC-CNT     EW-AGE
 20329                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20330                                  EW-AGE-BEN     EW-TERM-BEN
 20331                                  EW-ISS-PRM-TAX
 20332                                  EW-REM-TERM.
 20333
 20334     MOVE +1 TO SUB1.
 20335     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20336     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20337         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20338     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20339                                    EPEC-UNDW-OPT-DATA-TABLE.
 20340     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20341         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20342
 20343     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20344         VARYING SUB3 FROM +1 BY +1
 20345*        UNTIL SUB3 GREATER THAN +300.
 20346*        UNTIL SUB3 GREATER THAN +220.
 20347         UNTIL SUB3 GREATER THAN +900.
 20348
 20349     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20350
 20351 4555-CLEAR-EPEC-COMM.
 20352
 20353     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20354                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20355                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20356                EW-ECR-ST  (SUB1).
 20357     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20358                                    EW-AGT-TYPE (SUB1).
 20359
 20360     ADD +1 TO SUB1.
 20361
 20362 4560-CLEAR-EPEC-ALL.
 20363
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 387
* ECS010.cbl
 20364     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20365                                    EPEC-LEVELS-II (SUB1).
 20366     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20367
 20368 4570-CLEAR-EPEC-SUB-A.
 20369
 20370     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20371     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20372*        UNTIL SUB2 GREATER +300.
 20373         UNTIL SUB2 GREATER +900.
 20374
 20375 4580-CLEAR-EPEC-SUB-B.
 20376
 20377     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20378     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20379
 20380 4589-CLEAR-EPEC-TOTALS-X.
 20381     EXIT.
 20382
 20383 4590-INIT-OB.
 20384
 20385     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20386     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20387     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20388
 20389 4590-EXIT.
 20390     EXIT.
 20391
 20392 4599-BUILD-EPEC-EXTRACT-X.
 20393     EXIT.
 20394
 20395*********************************************************
 20396*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20397*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20398*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20399*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20400*  IN THE DATE CARD.                                    *
 20401*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20402*********************************************************
 20403
 20404 4599A-CALC-IBNR.
 20405
 20406     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20407        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20408                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20409         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20410                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20411                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20412
 20413     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20414         MOVE ZEROS                 TO EW-CLM-IBNR
 20415         GO TO 4599A-CALC-EXIT.
 20416
 20417     IF EP-REIN = 'R'
 20418         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20419
 20420     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20421
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 388
* ECS010.cbl
 20422 4599A-CALC-EXIT.
 20423      EXIT.
 20424 4599B-SEARCH.
 20425      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 389
* ECS010.cbl
 20427******************************************************************
 20428***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20429******************************************************************
 20430
 20431 4600-GET-OPT-IBNR.
 20432
 20433     IF  CR-POLICY-IS-ACTIVE
 20434         IF  CR-POLICY-IS-REISSUE
 20435             OR CR-POLICY-IS-MONTHLY
 20436             IF  W-LIFE
 20437                 GO TO 4600-EXIT
 20438             ELSE
 20439                 NEXT SENTENCE
 20440         ELSE
 20441             NEXT SENTENCE
 20442     ELSE
 20443         IF  W-LIFE
 20444             GO TO 4600-EXIT.
 20445
 20446     IF  W-LIFE
 20447         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20448     ELSE
 20449         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20450
 20451 4600-EXIT.
 20452     EXIT.
 20453
 20454 4620-DETERMINE-LIFE-IBNR.
 20455
 20456     IF  CR-LF-POLICY-IS-ACTIVE
 20457         ADD +1                  TO W-LF-ACTIVE
 20458         IF  CR-LF-POLICY-IS-REISSUE
 20459             OR CR-LF-POLICY-IS-MONTHLY
 20460             MOVE ZEROS          TO W-WK-IBNR
 20461             ADD +1              TO W-LF-REISSUE
 20462             GO TO 4620-EXIT
 20463         ELSE
 20464             NEXT SENTENCE
 20465     ELSE
 20466         ADD +1                  TO W-LF-INACTIVE
 20467         MOVE ZEROS              TO W-WK-IBNR
 20468         GO TO 4620-EXIT.
 20469
 20470     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20471         MOVE ZEROS              TO W-WK-IBNR
 20472         ADD +1                  TO W-LF-CALC-B
 20473         GO TO 4620-EXIT.
 20474
 20475     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20476                 AND
 20477             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20478                 AND
 20479             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20480             OR
 20481         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20482                 AND
 20483             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20484                 AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 390
* ECS010.cbl
 20485             REM-TRM2 NOT GREATER THAN ZERO)
 20486         MOVE ZEROS              TO W-WK-IBNR
 20487         ADD +1                  TO W-LF-BALLOON
 20488         GO TO 4620-EXIT
 20489     ELSE
 20490         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20491                 AND
 20492             REM-TRM2 NOT GREATER THAN ZERO)
 20493             ADD +1              TO W-LF-REMTERM-0
 20494             MOVE ZEROS          TO W-WK-IBNR
 20495             GO TO 4620-EXIT.
 20496
 20497     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20498
 20499     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20500         ADD +1                  TO W-LF-REMAMT-0
 20501         MOVE ZEROS              TO W-WK-IBNR
 20502         GO TO 4620-EXIT.
 20503
 20504     IF  AM-LIFE-IBNR-PCT NUMERIC
 20505             AND
 20506         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20507         COMPUTE W-WK-IBNR ROUNDED
 20508             = CP-REMAINING-AMT
 20509             / 1000
 20510             * AM-LIFE-IBNR-PCT
 20511     ELSE
 20512         COMPUTE W-WK-IBNR ROUNDED
 20513             = CP-REMAINING-AMT
 20514             / 1000
 20515             * COMPANY-IBNR-LIFE-FACTOR.
 20516
 20517     IF  CR-LF-IS-REIN-ONLY
 20518         ADD +1                  TO W-LF-REIN
 20519     ELSE
 20520         ADD +1                  TO W-LF-DATA-USED
 20521         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20522         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20523         IF  CR-LFTYP = '01'
 20524             ADD CP-REMAINING-AMT
 20525                                 TO W-01-REMAMT
 20526             ADD +1              TO W-01-DATA-USED
 20527         ELSE
 20528         IF  CR-LFTYP = '02'
 20529             ADD CP-REMAINING-AMT
 20530                                 TO W-02-REMAMT
 20531             ADD +1              TO W-02-DATA-USED
 20532         ELSE
 20533         IF  CR-LFTYP = '03'
 20534             ADD CP-REMAINING-AMT
 20535                                 TO W-03-REMAMT
 20536             ADD +1              TO W-03-DATA-USED
 20537         ELSE
 20538         IF  CR-LFTYP = '04'
 20539             ADD CP-REMAINING-AMT
 20540                                 TO W-04-REMAMT
 20541             ADD +1              TO W-04-DATA-USED
 20542         ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 391
* ECS010.cbl
 20543         IF  CR-LFTYP = '05'
 20544             ADD CP-REMAINING-AMT
 20545                                 TO W-05-REMAMT
 20546             ADD +1              TO W-05-DATA-USED
 20547         ELSE
 20548         IF  CR-LFTYP = '06'
 20549             ADD CP-REMAINING-AMT
 20550                                 TO W-06-REMAMT
 20551             ADD +1              TO W-06-DATA-USED
 20552         ELSE
 20553         IF  CR-LFTYP = '30'
 20554             ADD CP-REMAINING-AMT
 20555                                 TO W-30-REMAMT
 20556             ADD +1              TO W-30-DATA-USED
 20557         ELSE
 20558         IF  CR-LFTYP = '31'
 20559             ADD CP-REMAINING-AMT
 20560                                 TO W-31-REMAMT
 20561             ADD +1              TO W-31-DATA-USED
 20562         ELSE
 20563             ADD CP-REMAINING-AMT
 20564                                 TO W-XX-REMAMT
 20565             ADD +1              TO W-XX-DATA-USED.
 20566
 20567     IF  CR-POLICY-IS-REIN-ONLY
 20568             OR
 20569         CR-LF-IS-REIN-ONLY
 20570         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20571         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20572         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20573     ELSE
 20574         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20575
 20576 4620-EXIT.
 20577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 392
* ECS010.cbl
 20579 4640-GET-A-H-EARNED-PREMIUM.
 20580
 20581     IF  CR-AH-POLICY-IS-ACTIVE
 20582         ADD +1                  TO W-AH-ACTIVE
 20583         IF  CR-AH-POLICY-IS-REISSUE
 20584             OR CR-AH-POLICY-IS-MONTHLY
 20585             ADD +1              TO W-AH-REISSUE
 20586         ELSE
 20587             NEXT SENTENCE
 20588     ELSE
 20589         ADD +1                  TO W-AH-INACTIVE.
 20590
 20591     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20592         ADD +1                  TO W-AH-CALC-B
 20593         GO TO 4640-EXIT.
 20594
 20595     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20596         MOVE 'Y'                TO W-RTRM-0-SW
 20597     ELSE
 20598         MOVE SPACES             TO W-RTRM-0-SW.
 20599
 20600     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20601
 20602****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20603******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20604******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20605******        THAT CLAIM.
 20606
 20607     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20608
 20609     IF  CR-POLICY-IS-REIN-ONLY
 20610              OR
 20611         CR-AH-IS-REIN-ONLY
 20612         ADD +1                  TO W-AH-REIN
 20613         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20614         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20615         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20616         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20617         GO TO 4640-EXIT.
 20618
 20619     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20620                                    W-EPEC-EP-IN.
 20621     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20622                                    W-CLAIMS-MADE-PAID-IN.
 20623     ADD +1                      TO W-AH-DATA-USED.
 20624     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20625     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20626
 20627     IF  W-CLMAMT GREATER THAN ZEROS
 20628         ADD +1                  TO W-AH-CLAIM-CTR
 20629         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20630
 20631     IF  W-RTRM-0
 20632             AND
 20633         NOT CR-POLICY-IS-REIN-ONLY
 20634             AND
 20635         NOT CR-AH-IS-REIN-ONLY
 20636         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 393
* ECS010.cbl
 20637         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20638         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20639         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20640         ADD +1                  TO W-AH-REMTERM-0.
 20641
 20642 4640-EXIT.
 20643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 394
* ECS010.cbl
 20645 4650-DETERMINE-CLM-AMT-AH.
 20646
 20647     MOVE ZEROS                  TO W-CLMAMT.
 20648
 20649     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20650             OR
 20651         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20652         GO TO 4650-EXIT.
 20653
 20654     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20655             AND
 20656         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20657         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20658         MOVE 'L'                    TO DC-OPTION-CODE
 20659         PERFORM 8000-DATE-CONVERT-ROUTINE
 20660             THRU 8099-DATE-CONVERT-X
 20661         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20662         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20663         MOVE 'L'                    TO DC-OPTION-CODE
 20664         PERFORM 8000-DATE-CONVERT-ROUTINE
 20665             THRU 8099-DATE-CONVERT-X
 20666         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20667         IF  DATE-CONVERSION-ERROR
 20668             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20669             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20670             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20671             MOVE 0303               TO WS-ABEND-CODE
 20672             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20673             GO TO ABEND-PGM
 20674         ELSE
 20675             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20676             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20677             MOVE '1'                TO DC-OPTION-CODE
 20678             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20679                                        DC-ELAPSED-DAYS
 20680             PERFORM 8000-DATE-CONVERT-ROUTINE
 20681                 THRU 8099-DATE-CONVERT-X
 20682             IF  DATE-CONVERSION-ERROR
 20683                 DISPLAY 'DIS TO PTO DATE ERROR '
 20684                     CR-FULL-CONTROL
 20685                 MOVE 'DIS TO PTO DATE ERROR '
 20686                                     TO WS-ABEND-MESSAGE
 20687                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20688                 MOVE 0303           TO WS-ABEND-CODE
 20689                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20690                 GO TO ABEND-PGM
 20691             ELSE
 20692                 COMPUTE W-CLMAMT ROUNDED
 20693                     = CR-AHAMT
 20694                     * (DC-ELAPSED-DAYS / 30)
 20695                 GO TO 4650-EXIT.
 20696
 20697     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20698             OR
 20699         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20700         GO TO 4650-EXIT.
 20701
 20702     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 395
* ECS010.cbl
 20703         = CR-AHAMT * 3.
 20704
 20705     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20706         MOVE CR-DISAMT          TO W-CLMAMT
 20707     ELSE
 20708         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20709
 20710     IF  NOT CR-POLICY-IS-REIN-ONLY
 20711              AND
 20712         NOT CR-AH-IS-REIN-ONLY
 20713         ADD +1          TO W-CLM-EXCEPT-CNT
 20714         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20715
 20716 4650-EXIT.
 20717     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 396
* ECS010.cbl
 20719 4660-DETERMINE-EARNED-PREMIUM.
 20720
 20721     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20722
 20723     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20724
 20725     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20726
 20727     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20728         MOVE ZEROS              TO W-EARNED-PREMIUM
 20729         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20730         MOVE '7'                TO W-VAL-SOURCE
 20731         PERFORM 8500-REMAINING-TERM-ROUTINE
 20732             THRU 8599-REM-TERM-X
 20733         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20734         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20735         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20736         MOVE EPR-R78            TO W-OPT-R78
 20737         MOVE EPR-PRO            TO W-OPT-PRO
 20738         MOVE EPR-ST             TO W-OPT-ST
 20739         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20740         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20741     ELSE
 20742         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20743
 20744     COMPUTE W-EARNED-PREMIUM ROUNDED
 20745         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20746
 20747     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20748         ADD +1                  TO W-EP-LESS-THAN-0
 20749         MOVE ZERO               TO W-EARNED-PREMIUM.
 20750
 20751 4660-EXIT.
 20752     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 397
* ECS010.cbl
 20754 4666-SAVE-AHCR-DATA.
 20755
 20756     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20757                                    WX-STATUS-AT-SETTLEMENT.
 20758
 20759     MOVE ZEROS                  TO WX-CANC-DT
 20760                                    WX-EOM-RUN-DATE
 20761                                    WX-SETTLEMENT-EXIT-DATE.
 20762
 20763     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20764         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20765         MOVE CR-AH-STATUS-AT-CANCEL
 20766                                 TO WX-STATUS-AT-CANCEL
 20767         MOVE ZEROS              TO CR-AH-CANC-DT
 20768                                    WS-CR-AH-CANC-DT-N
 20769         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20770
 20771     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20772         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20773                                 TO WX-SETTLEMENT-EXIT-DATE
 20774         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20775                                 TO WX-STATUS-AT-SETTLEMENT
 20776         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20777                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20778         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20779
 20780     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20781     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20782
 20783 4666-EXIT.
 20784     EXIT.
 20785
 20786 4668-RESTORE-AHCR-DATA.
 20787
 20788     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20789         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20790                                    WS-CR-AH-CANC-DT-N
 20791         MOVE WX-STATUS-AT-CANCEL
 20792                                 TO CR-AH-STATUS-AT-CANCEL.
 20793
 20794     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20795         MOVE WX-SETTLEMENT-EXIT-DATE
 20796                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20797                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20798         MOVE WX-STATUS-AT-SETTLEMENT
 20799                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20800
 20801     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20802
 20803 4668-EXIT.
 20804     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 398
* ECS010.cbl
 20806 4670-CALC-EP.
 20807
 20808     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20809         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20810         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20811         GO TO 4670-EXIT.
 20812
 20813     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20814         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20815         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20816         GO TO 4670-EXIT.
 20817
 20818***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20819
 20820     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20821         COMPUTE W-EARNED-PREMIUM
 20822             = (W-OPT-PRO + W-OPT-R78) / +2
 20823         ADD W-EARNED-PREMIUM    TO W-M-EP
 20824     ELSE
 20825         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20826             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20827             ADD W-EARNED-PREMIUM
 20828                                 TO W-R-EP
 20829         ELSE
 20830             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20831                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20832                 ADD W-EARNED-PREMIUM
 20833                                 TO W-P-EP
 20834             ELSE
 20835                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20836                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20837                         = (W-OPT-PRO * +.6667)
 20838                         + (W-OPT-R78 * +.3333)
 20839                     ADD W-EARNED-PREMIUM
 20840                                 TO W-1-EP
 20841                 ELSE
 20842                     ADD +1      TO W-OTHERS-COUNT
 20843                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20844
 20845 4670-EXIT.
 20846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 399
* ECS010.cbl
 20848 4680-CALC-REMAINING-AMT-LF.
 20849
 20850     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20851     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20852     MOVE CR-APR                 TO CP-LOAN-APR.
 20853     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20854
 20855     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20856         MOVE +1                 TO CR-PMT-FREQ.
 20857
 20858     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20859
 20860     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20861     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20862                                    CP-RATING-BENEFIT-AMT.
 20863     IF CP-STATE-STD-ABBRV = 'OR'
 20864         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20865     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20866     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20867     MOVE ZEROS                  TO CP-REMAINING-AMT
 20868                                    CP-REMAINING-AMT-PRV
 20869                                    CP-RETURN-CODE
 20870                                    CP-RETURN-CODE-2.
 20871
 20872     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20873     IF (DTE-CLIENT = 'DCC')
 20874        AND (AM-DCC-PRODUCT-CODE <> spaces)
 20875        if cr-clp-state = spaces
 20876           move cr-state         to cr-clp-state
 20877        end-if
 20878        if cr-lftyp not = '00' and '  ' and 'DD'
 20879           move 'L'              to ws-dd-ben-type
 20880           move cr-lftyp         to ws-dd-ben-code
 20881        else
 20882           move 'A'              to ws-dd-ben-type
 20883           move cr-ahtyp         to ws-dd-ben-code
 20884        end-if
 20885        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20886           ((CR-clp-STATE = DD-STATE (D1))
 20887           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20888           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 20889           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 20890           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20891                           OR
 20892           D1 > max-pdef
 20893        END-PERFORM
 20894        IF D1 <= max-pdef
 20895           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20896              (P1 > +8)
 20897              OR (DD-PROD-CODE (D1 P1) = 'L')
 20898           END-PERFORM
 20899           IF P1 < +9
 20900              MOVE DD-MAX-BEN-AMT (D1 P1)
 20901                                 TO CP-R-MAX-TOT-BEN
 20902           END-IF
 20903        END-IF
 20904     END-IF
 20905
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 400
* ECS010.cbl
 20906     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20907
 20908     IF  CP-RETURN-CODE NOT = ZERO
 20909         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20910                             TO WS-ABEND-MESSAGE
 20911         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20912         MOVE 2001           TO WS-ABEND-CODE
 20913         GO TO ABEND-PGM.
 20914
 20915 4680-EXIT.
 20916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 401
* ECS010.cbl
 20918******************************************************************
 20919***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20920******************************************************************
 20921
 20922 4700-CALC-OPT-IBNR.
 20923
 20924     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20925     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20926
 20927     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20928             VARYING
 20929         SUB2 FROM +1 BY +1
 20930             UNTIL
 20931*        SUB2 GREATER THAN 300.
 20932*        SUB2 GREATER THAN 220.
 20933         SUB2 GREATER THAN 900.
 20934
 20935     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20936                                 TO EPEC-OPT-WORK-TABLE.
 20937     MOVE '*'                    TO W-UNDERWRITING-SW.
 20938
 20939     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20940             VARYING
 20941         SUB2 FROM +1 BY +1
 20942             UNTIL
 20943*        SUB2 GREATER THAN 300.
 20944*        SUB2 GREATER THAN 220.
 20945         SUB2 GREATER THAN 900.
 20946
 20947 4700-EXIT.
 20948     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 402
* ECS010.cbl
 20950 4710-PROCESS-THRU-EPEC-TABLE.
 20951
 20952     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20953         GO TO 4710-EXIT.
 20954
 20955     IF  W-UNDERWRITTEN-DATA
 20956         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20957     ELSE
 20958         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20959
 20960     IF EW-LEVEL-USED NOT = 'Y'
 20961         GO TO 4710-EXIT.
 20962
 20963     IF  EW-REIN-CO GREATER THAN SPACES
 20964         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20965         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20966             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20967             IF  W-WK-IBNR GREATER THAN ZEROS
 20968                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20969                 GO TO 4710-EXIT
 20970             ELSE
 20971                 GO TO 4710-EXIT
 20972         ELSE
 20973             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20974                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20975                 GO TO 4710-EXIT
 20976             ELSE
 20977                 GO TO 4710-EXIT.
 20978
 20979     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20980
 20981     IF  EW-LF-AH EQUAL 'L'
 20982         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20983             GO TO 4710-EXIT
 20984         ELSE
 20985             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20986             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20987     ELSE
 20988         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20989                 GREATER THAN ZEROS
 20990             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20991             ADD W-WK-IBNR       TO W-AH-IBNR
 20992         ELSE
 20993             GO TO 4710-EXIT.
 20994
 20995     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20996     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20997     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20998
 20999     IF  W-UNDERWRITTEN-DATA
 21000         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 21001     ELSE
 21002         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 21003
 21004
 21005     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21006     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 21007
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 403
* ECS010.cbl
 21008 4710-EXIT.
 21009     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 404
* ECS010.cbl
 21011 4720-PROCESS-LIFE.
 21012
 21013     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 21014
 21015 4720-EXIT.
 21016     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 405
* ECS010.cbl
 21018 4730-PROCESS-A-H.
 21019
 21020     IF  AM-TARGET-LOSS-RATIO NUMERIC
 21021             AND
 21022         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 21023         MOVE AM-TARGET-LOSS-RATIO
 21024                                 TO W-TARGET-LOSS-RATIO
 21025     ELSE
 21026         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 21027             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 21028                                 TO W-TARGET-LOSS-RATIO
 21029             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 21030
 21031     IF  W-NOT-REIN-PROCESS
 21032         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 21033         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 21034
 21035     COMPUTE W-IBNR-1 ROUNDED
 21036         = EPEC-EARNED-PREMIUM-AH (SUB2)
 21037         * COMPANY-IBNR-AH-FACTOR
 21038         * W-TARGET-LOSS-RATIO.
 21039
 21040     COMPUTE W-IBNR-2 ROUNDED
 21041         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 21042         * W-TARGET-LOSS-RATIO)
 21043         - EPEC-CLAIMS-MADE-PAID (SUB2).
 21044
 21045     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 21046         MOVE W-IBNR-1           TO W-WK-IBNR
 21047         IF  W-NOT-REIN-PROCESS
 21048             ADD +1              TO W-AH-IBNR-1-CNT
 21049             ADD W-IBNR-1        TO W-AH-IBNR-1
 21050         ELSE
 21051             NEXT SENTENCE
 21052     ELSE
 21053         MOVE W-IBNR-2           TO W-WK-IBNR
 21054         IF  W-NOT-REIN-PROCESS
 21055             ADD +1              TO W-AH-IBNR-2-CNT
 21056             ADD W-IBNR-2        TO W-AH-IBNR-2.
 21057
 21058 4730-EXIT.
 21059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 406
* ECS010.cbl
 21061 4735-GET-BUSINESS-ADJUSTMENT.
 21062
 21063     IF  CR-GRPTYP NOT NUMERIC
 21064         MOVE '99'               TO INDEXBS
 21065     ELSE
 21066         MOVE CR-GRPTYP          TO INDEXBS.
 21067
 21068     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 21069             AND
 21070         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21071             NOT EQUAL ZEROS
 21072             AND
 21073         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21074             NOT EQUAL +1.0000
 21075         MOVE INDEXBS           TO W-EDIT-7
 21076         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 21077             = W-TARGET-LOSS-RATIO
 21078             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 21079
 21080 4735-EXIT.
 21081     EXIT.
 21082
 21083 4740-CREATE-DETAIL-EXTR.
 21084
 21085     IF DTE-PGM-OPT NOT = '1'
 21086         GO TO 4740-EXIT.
 21087
 21088     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 21089         GO TO 4740-EXIT.
 21090
 21091     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21092     MOVE ZEROS                  TO REPORTED-DATE
 21093                                    PAY-TO-DATE.
 21094
 21095     MOVE SPACES                 TO TR-DTL2.
 21096     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21097
 21098     MOVE EOM-YR                 TO TRD-ISYR.
 21099     MOVE EOM-MO                 TO TRD-ISMO.
 21100     MOVE EOM-DA                 TO TRD-ISDA.
 21101     MOVE ZERO                   TO TRD-AGE.
 21102
 21103     IF  EW-LF-AH EQUAL 'L'
 21104         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21105     ELSE
 21106         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21107
 21108     MOVE SPACES                 TO TRD-PAYCURX
 21109                                    TRD-PAYCUR-SPACE
 21110                                    TRD-FUTRSV-SPACE
 21111                                    TRD-FUTRSVX.
 21112
 21113     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21114     MOVE 'IBNR'                 TO TRD-IBNRX.
 21115     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21116     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21117
 21118     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 407
* ECS010.cbl
 21119         IF  W-REIN-IN-PROCESS
 21120             MOVE ' ACCT/BEN REIN RSV UW'
 21121                                 TO TRD-RSV-ACTION
 21122         ELSE
 21123             MOVE ' ACCT/BEN RESERVES UW'
 21124                                 TO TRD-RSV-ACTION
 21125     ELSE
 21126         IF  W-REIN-IN-PROCESS
 21127             MOVE ' ACCT/BEN REIN RSV'
 21128                                 TO TRD-RSV-ACTION
 21129         ELSE
 21130             MOVE ' ACCT/BEN RESERVES'
 21131                                 TO TRD-RSV-ACTION.
 21132
 21133     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21134
 21135     MOVE SPACES                 TO DETAIL-EXTRACT.
 21136
 21137     IF  W-REIN-IN-PROCESS
 21138         MOVE EW-REIN-CO         TO DE-REI-COMP
 21139         MOVE 'R'                TO DE-REIN
 21140         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21141         MOVE ZEROS              TO DE-IBNR
 21142     ELSE
 21143         MOVE EW-CLM-IBNR        TO DE-IBNR
 21144         MOVE ZEROS              TO DE-REI-IBNR.
 21145
 21146     MOVE 'DE'                   TO DE-RECORD-ID.
 21147     MOVE 'Y'                    TO DE-TRANS.
 21148     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21149     MOVE '1'                    TO DE-ENTRY-STATUS.
 21150     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21151
 21152     MOVE EOM-RUN-DATE           TO DE-EFF
 21153                                    WS-DE-EFF-N
 21154                                    DE-ENTRY-DTE
 21155                                    WS-DE-ENTRY-DTE-N.
 21156     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21157                                    WS-DE-RSV-INCUR-N.
 21158
 21159     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21160     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21161     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21162                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21163     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21164                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21165
 21166     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21167     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21168     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21169     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21170     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21171*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21172     MOVE AM-IG                  TO DE-IG.
 21173
 21174     IF W-UNDERWRITTEN-DATA
 21175         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21176     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 408
* ECS010.cbl
 21177         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21178
 21179     IF  EW-LF-AH EQUAL 'L'
 21180         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21181         MOVE '1'                TO DE-RESERVE-TYPE
 21182         MOVE ZEROS              TO DE-AH-TYPE
 21183     ELSE
 21184         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21185         MOVE '2'                TO DE-RESERVE-TYPE
 21186         MOVE ZEROS              TO DE-LF-TYPE.
 21187
 21188     MOVE SPACES                 TO DE-NAME
 21189                                    DE-ACC-GPCD
 21190                                    DE-AH-STAT-CDE
 21191                                    DE-LF-STAT-CDE
 21192                                    DE-MEMBER-NO
 21193                                    DE-NAME
 21194                                    DE-SEX.
 21195     MOVE ZEROS                  TO DE-AGE
 21196                                    DE-AH-BEN
 21197                                    DE-AH-CANC-DTE
 21198                                    WS-DE-AH-CANC-DTE-N
 21199                                    DE-AH-CANC-EXIT-DT
 21200                                    WS-DE-AH-CANC-EXIT-DT-N
 21201                                    DE-AH-PRM
 21202                                    DE-AH-RFND
 21203                                    DE-AH-TERM
 21204                                    DE-APR
 21205                                    DE-CANCEL-CNT-ITD
 21206                                    DE-CANCEL-CNT-YTD
 21207                                    DE-FUTRSV
 21208                                    DE-LF-BEN
 21209                                    DE-LF-BEN-ALT
 21210                                    DE-LF-CANC-DTE
 21211                                    WS-DE-LF-CANC-DTE-N
 21212                                    DE-LF-CANC-EXIT-DT
 21213                                    WS-DE-LF-CANC-EXIT-DT-N
 21214                                    DE-LF-CNBEN
 21215                                    DE-LF-CNBEN-ALT
 21216                                    DE-LF-PRM
 21217                                    DE-LF-PRM-ALT
 21218                                    DE-LF-RFND
 21219                                    DE-LF-TERM
 21220                                    DE-LOAN-TERM
 21221                                    DE-LIVES
 21222                                    DE-PAYCUR
 21223                                    DE-PMT-FREQ
 21224                                    DE-REI-AHAMT
 21225                                    DE-REI-AHPRM
 21226                                    DE-REI-AHRFND
 21227                                    DE-REI-CNAMT
 21228                                    DE-REI-FUTRSV
 21229                                    DE-REI-LFAMT
 21230                                    DE-REI-LFPRM
 21231                                    DE-REI-LFRFND
 21232                                    DE-REI-PAYCUR
 21233                                    DE-RSV-REPORTED
 21234                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 409
* ECS010.cbl
 21235                                    WS-DE-RSV-PAYTO-N
 21236                                    DE-MOB-NET-TOT-FEES
 21237                                    DE-SOC-SEC-NO.
 21238
 21239     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21240
 21241     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21242         THRU 2599-WRT-DETAIL-X.
 21243     ADD +1                      TO BC-G-CRS.
 21244
 21245 4740-EXIT.
 21246     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 410
* ECS010.cbl
 21248 4750-UPDATE-REIN.
 21249
 21250     COMPUTE SUB3 = SUB2 + 1.
 21251
 21252     IF  W-UNDERWRITTEN-DATA
 21253         MOVE EPEC-SUB-KEY-II (SUB2)
 21254                                 TO W-SUB-KEY
 21255     ELSE
 21256         MOVE EPEC-SUB-KEY (SUB2)
 21257                                 TO W-SUB-KEY.
 21258
 21259     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21260             VARYING
 21261         SUB3 FROM SUB3 BY +1
 21262             UNTIL
 21263         SUB3 GREATER THAN +900
 21264*        SUB3 GREATER THAN +220
 21265*        SUB3 GREATER THAN +300
 21266             OR
 21267         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21268
 21269 4750-EXIT.
 21270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 411
* ECS010.cbl
 21272 4755-MATCH-REIN-EPEC.
 21273
 21274     IF  W-UNDERWRITTEN-DATA
 21275         MOVE EPEC-LEVELS-II (SUB3)
 21276                                 TO EPEC-WORK
 21277     ELSE
 21278         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21279
 21280     IF  EPEC-LINE-NOT-USED (SUB3)
 21281         GO TO 4755-EXIT.
 21282
 21283     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21284             OR
 21285         EW-REIN-CO EQUAL SPACES
 21286         GO TO 4755-EXIT.
 21287
 21288     IF  W-ISS-BEN GREATER THAN ZEROS
 21289         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21290             COMPUTE W-FACTOR ROUNDED
 21291                 = (EW-ISS-BEN
 21292                 - EPEC-REIN-ISS-BEN (SUB3))
 21293                 / W-ISS-BEN
 21294         ELSE
 21295             COMPUTE W-FACTOR ROUNDED
 21296                 = EW-ISS-BEN
 21297                 / W-ISS-BEN.
 21298
 21299     COMPUTE EW-CLM-IBNR ROUNDED
 21300         = EW-CLM-IBNR
 21301         + (W-WK-IBNR * W-FACTOR).
 21302
 21303     IF  W-UNDERWRITTEN-DATA
 21304         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21305     ELSE
 21306         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21307
 21308 4755-EXIT.
 21309     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 412
* ECS010.cbl
 21311 4760-PROCESS-REIN-ONLY.
 21312
 21313     MOVE ZEROS                  TO W-WK-IBNR.
 21314
 21315     IF  EPEC-LINE-NOT-USED (SUB2)
 21316         GO TO 4760-EXIT.
 21317
 21318     IF  EW-LF-AH EQUAL 'L'
 21319         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21320             GO TO 4760-EXIT
 21321         ELSE
 21322             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21323             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21324     ELSE
 21325         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21326             GO TO 4760-EXIT
 21327         ELSE
 21328             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21329             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21330
 21331 4760-EXIT.
 21332     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 413
* ECS010.cbl
 21334 4770-CREATE-REIN-DETAIL.
 21335
 21336     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21337     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21338
 21339 4770-EXIT.
 21340     EXIT.
 21341
 21342 4799-EXIT.
 21343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 414
* ECS010.cbl
 21345 4800-CALC-EARNED-PREMIUM-AH.
 21346
 21347     MOVE +0                         TO CNC-BEN  EPR-R78
 21348                                        ISS-PRM  EPR-PRO
 21349                                        CNC-PRM  EPR-ST
 21350                                        WX-CLM-AMT
 21351                                        WX-CLM-EXP
 21352                                        WX-CLM-CNT
 21353                                        WX-CLM-CRT
 21354                                        WX-CNC-CNT
 21355                                        ISS-PRMTAX
 21356                                        WX-ACTIVE-COUNT.
 21357     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21358
 21359     MOVE WE-AHPRM TO ISS-PRM.
 21360
 21361     IF DTE-CLIENT = 'GIC'
 21362         IF REIN-EP-FLG NOT = 'R'  AND
 21363            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21364            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21365            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21366
 21367     IF REIN-EP-FLG = 'R'  AND
 21368        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21369         NEXT SENTENCE
 21370     ELSE
 21371         GO TO 4810-EP-DO-AH-CLM.
 21372
 21373     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21374         IF WE-DSPY-AMT NOT = +0
 21375             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21376             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21377             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21378             ADD +1             TO WX-CLM-CNT.
 21379
 21380     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21381         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21382             GO TO 4830-EP-DO-AH-EP.
 21383
 21384     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21385         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21386             GO TO 4830-EP-DO-AH-EP.
 21387
 21388     GO TO 4815-EP-DO-AH-CLM-EPR.
 21389
 21390 4810-EP-DO-AH-CLM.
 21391
 21392     IF WE-DSPY-AMT NOT = +0
 21393         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21394         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21395         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21396         ADD +1             TO WX-CLM-CNT.
 21397
 21398 4815-EP-DO-AH-CLM-EPR.
 21399
 21400     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21401         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21402
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 415
* ECS010.cbl
 21403 4820-EP-DO-AH-CNCL.
 21404
 21405     IF CR-AH-STATUS-AT-CANCEL = ' '
 21406         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21407            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21408             GO TO 4899-EXIT
 21409         ELSE
 21410             GO TO 4830-EP-DO-AH-EP.
 21411
 21412     IF (DTE-CLIENT = 'DCC')
 21413        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21414        IF CR-AHRFND NOT = ZEROS
 21415           ADD +1                TO WX-CNC-CNT
 21416        END-IF
 21417     ELSE
 21418        ADD +1                   TO WX-CNC-CNT
 21419     END-IF
 21420
 21421     MOVE WE-AHRFND TO CNC-PRM.
 21422
 21423*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21424*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21425*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21426*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21427
 21428     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21429     MOVE 'L'                   TO  DC-OPTION-CODE.
 21430     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21431     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21432
 21433     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21434     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21435     MOVE '1'                     TO  DC-OPTION-CODE.
 21436     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21437     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21438                                      DC-ODD-DAYS-OVER
 21439                                      DC-ELAPSED-DAYS.
 21440     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21441     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21442
 21443     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21444         ADD  +1                  TO  MONTHS-DIFF-AH.
 21445
 21446     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21447                                      WS-DCC-DDF-CB-LEVELS
 21448
 21449     if (dte-client = 'AHL')
 21450        and (cr-ah-cancel-exit-date < 20120401)
 21451        go to 4820-continue-ah-cancel
 21452     end-if
 21453
 21454     IF DTE-CLIENT = 'ACE'
 21455         GO TO 4820-CONTINUE-AH-CANCEL.
 21456
 21457     MOVE  ZEROS                  TO  SUB.
 21458
 21459 4820-AH-CHARGEBACK-LOOP.
 21460
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 416
* ECS010.cbl
 21461     ADD    +1                    TO  SUB.
 21462
 21463     IF  SUB  GREATER THAN  +10
 21464         GO TO  4820-CONTINUE-AH-CANCEL.
 21465
 21466     IF CR-CANCEL-REASON = 'R'
 21467        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21468           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21469              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21470              GO TO  4820-AH-CHARGEBACK-LOOP
 21471           END-IF
 21472           IF AM-COM-TYP (SUB) = 'J'
 21473              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21474              GO TO  4820-AH-CHARGEBACK-LOOP
 21475           END-IF
 21476        END-IF
 21477     END-IF
 21478
 21479     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21480         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21481         GO TO  4820-AH-CHARGEBACK-LOOP.
 21482
 21483     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21484         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21485
 21486     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21487         OR (CR-AHRFND = ZEROS)
 21488         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21489     END-IF
 21490
 21491     GO TO  4820-AH-CHARGEBACK-LOOP.
 21492
 21493
 21494 4820-CONTINUE-AH-CANCEL.
 21495
 21496     IF DTE-CLIENT = 'GIC'
 21497         IF REIN-EP-FLG NOT = 'R'  AND
 21498            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21499            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21500
 21501     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21502     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21503
 21504     IF CR-AH-LUMP-SUM-DISAB
 21505         GO TO 4899-EXIT.
 21506
 21507     MOVE WE-AHAMT TO CNC-BEN.
 21508
 21509     GO TO 4899-EXIT.
 21510
 21511 4825-EP-DO-AH-CNCL-SUM.
 21512
 21513     IF WE-DSPY-AMT NOT = +0
 21514         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21515         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21516         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21517         ADD +1             TO WX-CLM-CNT.
 21518
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 417
* ECS010.cbl
 21519     IF WE-AHRFND = ZERO
 21520        GO TO 4830-EP-DO-AH-EP.
 21521
 21522     MOVE WE-AHRFND TO CNC-PRM.
 21523
 21524     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21525
 21526     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21527                                      WS-DCC-DDF-CB-LEVELS
 21528
 21529     IF WE-AHRFND NOT LESS WE-AHPRM
 21530         MOVE WE-AHAMT TO CNC-BEN
 21531          GO TO 4830-EP-DO-AH-EP.
 21532
 21533     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21534     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21535     MOVE TEMP-7 TO CNC-BEN.
 21536
 21537 4830-EP-DO-AH-EP.
 21538
 21539     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21540     MOVE '8'           TO W-VAL-SOURCE.
 21541
 21542     IF REIN-EP-FLG = 'R'
 21543       IF REIN-REM-SW (SUB5) = 'I'
 21544           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21545           GO TO 4899-EXIT.
 21546
 21547     IF REIN-EP-FLG = 'R'
 21548         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21549            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21550             MOVE '*'               TO A-H-EARNED-SWITCH
 21551             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21552             MOVE '10'              TO W-VAL-SOURCE.
 21553
 21554     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21555
 21556     IF REM-TRM2 GREATER CR-AH-TERM
 21557         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21558         GO TO 4899-EXIT.
 21559
 21560     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21561         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21562*
 21563 4835-CHECK-OB-AH-NCL.
 21564
 21565     IF (DTE-CLIENT EQUAL 'NCL') AND
 21566        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21567           MOVE WE-AHPRM         TO EPR-R78
 21568                                    EPR-PRO
 21569                                    EPR-ST
 21570        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21571           (CR-MO EQUAL EOM-MO)
 21572           MOVE '*'            TO OB-DATE-1-SWITCH
 21573           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21574           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21575           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21576           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 418
* ECS010.cbl
 21577                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21578           GO TO 4899-EXIT
 21579        ELSE
 21580        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21581           (CR-MO EQUAL OB-MO (1))
 21582           MOVE '*'            TO OB-DATE-2-SWITCH
 21583           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21584           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21585           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21586           COMPUTE WS-EPR-R78 (SUB3 2) =
 21587                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21588           GO TO 4899-EXIT
 21589        ELSE
 21590        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21591           (CR-MO EQUAL OB-MO (2))
 21592           MOVE '*'            TO OB-DATE-3-SWITCH
 21593           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21594           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21595           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21596           COMPUTE WS-EPR-R78 (SUB3 3) =
 21597                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21598           GO TO 4899-EXIT
 21599        ELSE
 21600           GO TO 4899-EXIT.
 21601
 21602     IF REM-TRM2 NOT GREATER +0
 21603         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21604         GO TO 4899-EXIT.
 21605
 21606     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21607         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21608         GO TO 4899-EXIT.
 21609
 21610     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21611         MOVE +1 TO WX-ACTIVE-COUNT
 21612     ELSE
 21613         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21614
 21615     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21616     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21617     IF DTE-R78 = '1'
 21618         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21619     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21620
 21621     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21622         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21623     ELSE
 21624         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21625
 21626     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21627     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21628
 21629     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21630     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21631
 21632     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21633
 21634*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 419
* ECS010.cbl
 21635*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21636
 21637     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21638
 21639     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21640        (CR-DT GREATER THAN  19921231)
 21641        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21642         IF CR-AH-TERM GREATER THAN  +61
 21643             MOVE 'A' TO AH-EARN-METHOD
 21644             MOVE '*' TO STATUTORY-SWITCH-AH
 21645             GO TO 4845-EP-DO-AH-EP-AN
 21646         ELSE
 21647             GO TO 4860-EP-DO-AH-STATUTORY.
 21648
 21649     IF (AH-EARN-METHOD EQUAL 'N')
 21650                  OR
 21651        ((DTE-CLIENT = 'DCC')
 21652         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21653         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21654                                    NOT = 'G' AND 'D'))
 21655         GO TO 4840-EP-DO-AH-EP-NP
 21656     END-IF
 21657
 21658     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21659         MOVE 'A' TO AH-EARN-METHOD
 21660         GO TO 4845-EP-DO-AH-EP-AN.
 21661
 21662     GO TO 4860-EP-DO-AH-STATUTORY.
 21663
 21664 4840-EP-DO-AH-EP-NP.
 21665
 21666     IF WE-AHPRM = ZERO
 21667         GO TO 4860-EP-DO-AH-STATUTORY.
 21668
 21669     IF CR-APR GREATER THAN +0
 21670         NEXT SENTENCE
 21671     ELSE
 21672         GO TO 4860-EP-DO-AH-STATUTORY.
 21673
 21674     IF DTE-CLIENT = 'NCL'
 21675       IF CR-DT LESS THAN 19910101
 21676           GO TO 4860-EP-DO-AH-STATUTORY.
 21677
 21678     IF REM-TRM1 = CR-AH-TERM
 21679         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21680         GO TO 4899-EXIT.
 21681
 21682     MOVE CR-APR TO NP-APR.
 21683     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21684     MOVE REM-TRM1 TO NP-REM.
 21685     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21686     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21687         MOVE CR-LOAN-TERM TO NP-ORIG.
 21688
 21689     IF (DTE-CLIENT = 'DCC')
 21690        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21691        MOVE 'S'                 TO NP-OPT
 21692     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 420
* ECS010.cbl
 21693        MOVE 'R'                 TO NP-OPT
 21694     END-IF
 21695
 21696
 21697*    MOVE 'R' TO NP-OPT.
 21698     CALL 'ECSNETRM'
 21699         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21700
 21701     IF (DTE-CLIENT = 'DCC')
 21702        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21703        COMPUTE EPR-ST ROUNDED =
 21704           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21705        GO TO 4899-EXIT
 21706     ELSE
 21707        COMPUTE EPR-R78 ROUNDED =
 21708           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21709     END-IF
 21710
 21711     GO TO 4860-EP-DO-AH-STATUTORY.
 21712
 21713 4845-EP-DO-AH-EP-AN.
 21714     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21715     MOVE 'L'                        TO DC-OPTION-CODE.
 21716     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21717     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21718     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21719     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21720     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21721     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21722     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21723     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21724     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21725     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21726                                        CP-RATING-BENEFIT-AMT.
 21727     IF CP-STATE-STD-ABBRV = 'OR'
 21728         COMPUTE CP-RATING-BENEFIT-AMT =
 21729                                  CR-AHAMT * REM-TRM1.
 21730     MOVE CR-APR                     TO CP-LOAN-APR.
 21731     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21732     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21733     MOVE '3'                        TO CP-PROCESS-TYPE.
 21734     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21735     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21736     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21737         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21738     ELSE
 21739         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21740     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21741     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21742     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21743     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21744     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21745     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21746
 21747     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21748
 21749     IF CP-ERROR-RATE-NOT-FOUND  OR
 21750        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 421
* ECS010.cbl
 21751        CP-ERROR-IN-DATES
 21752         GO TO 4860-EP-DO-AH-STATUTORY.
 21753
 21754     COMPUTE EPR-R78 ROUNDED =
 21755             (REM-TRM1 * WE-AHAMT / +100 *
 21756               CP-PREMIUM-RATE)
 21757              / CR-AHPRM-CALC * CR-AHPRM
 21758
 21759     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21760
 21761     IF STATUTORY-REQUIREMENT-AH
 21762         MOVE EPR-R78                TO EPR-ST
 21763         GO TO 4899-EXIT.
 21764
 21765 4860-EP-DO-AH-STATUTORY.
 21766     IF (DTE-CLIENT EQUAL 'CID') AND
 21767        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21768         GO TO 4867-EP-DO-AH-STAT-ROA
 21769     END-IF.
 21770
 21771 4860-EP-DO-AH-STATUTORY-VA.
 21772
 21773     IF (DTE-CLIENT = 'DCC')
 21774        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21775        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21776        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21777        MOVE EPR-R78             TO EPR-ST
 21778        GO TO 4899-EXIT
 21779     END-IF
 21780
 21781     IF (DTE-CLIENT = 'DCC')
 21782        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21783        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21784        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21785        MOVE +1.0000                TO TEMP-6
 21786        IF REM-TRM1 < +9
 21787           COMPUTE TEMP-6 =
 21788              ((9 - (9 - REM-TRM1)) - 1)
 21789              * +.125
 21790        END-IF
 21791        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21792        MOVE EPR-ST              TO EPR-R78
 21793                                    EPR-PRO
 21794        GO TO 4899-EXIT
 21795     END-IF
 21796
 21797     MOVE EPR-R78                    TO EPR-ST.
 21798
 21799***  WE WANT R78 IN AH STAT FOR AHL
 21800
 21801     IF DTE-CLIENT = 'AHL'
 21802        GO TO 4899-EXIT
 21803     END-IF
 21804
 21805     MOVE +0                         TO SUB1.
 21806
 21807 4865-EP-AH-STAT-LOOP.
 21808     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 422
* ECS010.cbl
 21809
 21810     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21811         MOVE EPR-PRO                TO EPR-ST
 21812     ELSE
 21813         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21814             GO TO 4865-EP-AH-STAT-LOOP.
 21815
 21816     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21817         CR-DT GREATER THAN 19831031)  OR
 21818
 21819        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21820         CR-DT GREATER THAN 19820629)  OR
 21821
 21822        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21823         CR-DT GREATER THAN 19830831)  OR
 21824
 21825        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21826         CR-DT GREATER THAN 20091231)
 21827
 21828         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21829
 21830     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21831       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21832         IF CR-DT LESS THAN 19970101
 21833             MOVE EPR-R78            TO EPR-ST
 21834         ELSE
 21835             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21836
 21837     IF DTE-CLIENT = 'DCC'
 21838        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21839           MOVE EPR-PRO          TO EPR-ST
 21840        ELSE
 21841           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21842        END-IF
 21843     END-IF
 21844
 21845     IF (DTE-CLIENT = 'DCC')
 21846        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21847        CONTINUE
 21848     ELSE
 21849        GO TO 4899-EXIT
 21850     END-IF
 21851
 21852*    MOVE ' '                    TO DD-IU-SW
 21853
 21854     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21855                                    WS-DDF-CSO-ADMIN-FEE
 21856                                    WS-DDF-1ST-YR-TOT-EXP
 21857                                    WS-COMM-AND-MFEE
 21858
 21859     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21860        D1 > +10
 21861        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21862           AND (CR-LCOM-AH (D1) NUMERIC)
 21863           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21864              + (CR-LCOM-AH (D1) * +1000)
 21865        END-IF
 21866        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 423
* ECS010.cbl
 21867           AND (CR-LCOM-AH (D1) NUMERIC)
 21868           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21869              + (CR-LCOM-AH (D1) * +1000)
 21870        END-IF
 21871        IF (CR-AGT-TYPE (D1) = 'I' )
 21872           AND (CR-LCOM-AH (D1) NUMERIC)
 21873           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21874              + (CR-LCOM-AH (D1) * +1000)
 21875        END-IF
 21876        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21877           AND (CR-LCOM-AH (D1) NUMERIC)
 21878           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21879              + (CR-LCOM-AH (D1) * +1000)
 21880        END-IF
 21881     END-PERFORM
 21882
 21883     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21884     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21885
 21886     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21887                                 THRU 4910-EXIT
 21888
 21889     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21890        + WS-DDF-1ST-YR-TOT-EXP
 21891
 21892     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21893        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21894     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21895     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21896
 21897     MOVE 'D'                    TO CP-EARNING-METHOD
 21898     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21899     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21900     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21901     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21902     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21903
 21904     IF REIN-EP-FLG = 'R'
 21905        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21906        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21907        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21908     END-IF
 21909
 21910     IF DD-IU-PRESENT
 21911        MOVE 'I'              TO CP-EARNING-METHOD
 21912     END-IF
 21913
 21914     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21915                                 CP-CLP-RATE-UP
 21916
 21917
 21918     display ' cert no ' cr-cert-no
 21919     display ' rate up ' cp-iu-rate-up
 21920     display ' addl clp ' cr-addl-clp
 21921     display ' ah clp  ' cr-ah-clp
 21922     display ' orig prem ' cp-original-premium
 21923
 21924     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 424
* ECS010.cbl
 21925        AND (CP-IU-RATE-UP NOT = ZEROS)
 21926        COMPUTE CP-IU-RATE-UP =
 21927           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21928           / CP-ORIGINAL-PREMIUM))
 21929     END-IF
 21930
 21931     display ' here 4 '
 21932     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21933     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21934
 21935     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21936        + WS-DDF-1ST-YR-TOT-EXP
 21937
 21938     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21939
 21940     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21941
 21942     IF CP-DDF-SPEC-CALC = 'C'
 21943        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21944     ELSE
 21945        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21946        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21947        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21948        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21949        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21950        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21951     END-IF
 21952
 21953     display ' here 6 '
 21954     GO TO 4899-EXIT
 21955
 21956     .
 21957 4867-EP-DO-AH-STAT-ROA.
 21958     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21959     MOVE 'L'                        TO DC-OPTION-CODE.
 21960     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21961     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21962     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21963     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21964     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21965     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21966     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21967     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21968     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21969     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21970                                        CP-RATING-BENEFIT-AMT.
 21971     IF CP-STATE-STD-ABBRV = 'OR'
 21972         COMPUTE CP-RATING-BENEFIT-AMT =
 21973                                  CR-AHAMT * REM-TRM1.
 21974     MOVE CR-APR                     TO CP-LOAN-APR.
 21975     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21976     MOVE 'A'                        TO CP-EARNING-METHOD.
 21977     MOVE '3'                        TO CP-PROCESS-TYPE.
 21978     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21979     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21980     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21981         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21982     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 425
* ECS010.cbl
 21983         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21984     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21985     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21986     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21987     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21988     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21989     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21990
 21991     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21992
 21993     IF CP-ERROR-RATE-NOT-FOUND  OR
 21994        CP-ERROR-RATE-IS-ZERO  OR
 21995        CP-ERROR-IN-DATES
 21996         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21997
 21998     COMPUTE EPR-ST ROUNDED =
 21999             (REM-TRM1 * WE-AHAMT / +100 *
 22000               CP-PREMIUM-RATE)
 22001              / CR-AHPRM-CALC * CR-AHPRM
 22002
 22003     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 22004
 22005     GO TO 4899-EXIT.
 22006
 22007 4899-EXIT.
 22008     EXIT.
 22009******************************************************************
 22010***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 22011******************************************************************
 22012
 22013 4900-WRITE-SUMMARY-EXTRACTS.
 22014
 22015     IF DTE-CLIENT = 'HER'
 22016         IF EP-RECORD-ID = 'EC'  AND
 22017            EP-REINCO = 'LNL'
 22018             GO TO 4900-WRT-SUMMARY-X.
 22019
 22020     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 22021                                     WS-EP-RUN-DTE-N.
 22022
 22023     IF W-UNDERWRITTEN-DATA
 22024         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 22025     ELSE
 22026         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 22027
 22028     IF  DTE-OPT-RESERVE-METHOD-AUTH
 22029         IF VALID-EP-ID
 22030             MOVE 'Y'             TO EP-NEW-DATA-IND.
 22031
 22032     WRITE EP-RECORD.
 22033
 22034     ADD +1                       TO EP-CNT.
 22035
 22036 4900-WRT-SUMMARY-X.
 22037     EXIT.
 22038
 22039 4910-DCC-DFF-FACT-LOOKUP.
 22040
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 426
* ECS010.cbl
 22041     IF CR-CERT-NO = WS-FACT-CERT
 22042        go to 4910-exit
 22043     end-if
 22044
 22045     if cr-clp-state = spaces
 22046        move cr-state            to cr-clp-state
 22047     end-if
 22048     MOVE ' ' TO DD-IU-SW
 22049     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 22050        ((CR-clp-STATE = DD-STATE (D1))
 22051        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 22052        AND ('A'           = DD-BEN-TYPE   (D1))
 22053        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 22054        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 22055                        OR
 22056        D1 > max-pdef
 22057     END-PERFORM
 22058     IF D1 > max-pdef
 22059        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 22060           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 22061        GO TO 4910-EXIT
 22062     END-IF
 22063
 22064     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 22065        (P1 > +8)
 22066        OR (DD-PROD-CODE (D1 P1) = 'I')
 22067     END-PERFORM
 22068     IF P1 < +9
 22069        display ' setting iu present to true '
 22070        SET DD-IU-PRESENT        TO TRUE
 22071     END-IF
 22072
 22073     MOVE CR-AH-TERM             TO WS-DDF-TERM
 22074     IF (CR-LOAN-TERM > WS-DDF-TERM)
 22075        AND (DD-TRUNCATED (D1) = 'Y')
 22076        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 22077        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 22078     END-IF
 22079
 22080     EVALUATE TRUE
 22081        WHEN WS-DDF-TERM > +168
 22082           MOVE 15               TO P1
 22083        WHEN WS-DDF-TERM > +156
 22084           MOVE 14               TO P1
 22085        WHEN WS-DDF-TERM > +144
 22086           MOVE 13               TO P1
 22087        WHEN WS-DDF-TERM > +132
 22088           MOVE 12               TO P1
 22089        WHEN WS-DDF-TERM > +120
 22090           MOVE 11               TO P1
 22091        WHEN WS-DDF-TERM > +108
 22092           MOVE 10               TO P1
 22093        WHEN WS-DDF-TERM > +96
 22094           MOVE 9                TO P1
 22095        WHEN WS-DDF-TERM > +84
 22096           MOVE 8                TO P1
 22097        WHEN WS-DDF-TERM > +72
 22098           MOVE 7                TO P1
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 427
* ECS010.cbl
 22099        WHEN WS-DDF-TERM > +60
 22100           MOVE 6                TO P1
 22101        WHEN WS-DDF-TERM > +48
 22102           MOVE 5                TO P1
 22103        WHEN WS-DDF-TERM > +36
 22104           MOVE 4                TO P1
 22105        WHEN WS-DDF-TERM > +24
 22106           MOVE 3                TO P1
 22107        WHEN WS-DDF-TERM > +12
 22108           MOVE 2                TO P1
 22109        WHEN OTHER
 22110           MOVE 1                TO P1
 22111     END-EVALUATE
 22112
 22113     EVALUATE TRUE
 22114*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22115*          AND (DD-IU-PRESENT)
 22116*          MOVE 2                TO P2
 22117*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22118*          MOVE 1                TO P2
 22119        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22120           MOVE 2                TO P2
 22121        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22122           MOVE 3                TO P2
 22123        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22124           MOVE 4                TO P2
 22125        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22126           MOVE 5                TO P2
 22127        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22128           MOVE 6                TO P2
 22129        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22130           MOVE 7                TO P2
 22131        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22132           MOVE 8                TO P2
 22133        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22134           MOVE 9                TO P2
 22135        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22136           MOVE 10               TO P2
 22137        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22138           MOVE 11               TO P2
 22139        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22140           MOVE 12               TO P2
 22141        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22142           MOVE 13               TO P2
 22143        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22144           MOVE 14               TO P2
 22145        WHEN OTHER
 22146           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22147           MOVE 15               TO P2
 22148     END-EVALUATE
 22149
 22150     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22151     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22152                                 TO WS-LO-UEF
 22153     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22154                                 TO WS-HI-UEF
 22155
 22156     .
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 428
* ECS010.cbl
 22157 4910-EXIT.
 22158     EXIT.
 22159
 22160******************************************************************
 22161***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22162******************************************************************
 22163
 22164 5000-DATE-RANGE-BREAK.
 22165
 22166     IF NO-TRANSACTION-WAS-PROCESSED
 22167         GO TO 5099-DATE-RANGE-BREAK-X.
 22168
 22169     ADD +1  TO RANGE-CNT.
 22170     MOVE +1 TO SUB6.
 22171     MOVE +2 TO SUB7.
 22172     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22173     IF LN-CNT GREATER +50
 22174         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22175                 8750-PRT-RANGE-HEADING.
 22176
 22177     MOVE SPACES                     TO PRT.
 22178     PERFORM 8800-PRINT-ROUTINE.
 22179     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22180     MOVE '  TOTALS'                 TO TPH3-DESC.
 22181     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22182     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22183     PERFORM 5900-CLEAR-TOTAL-PAGES
 22184         THRU 5999-CLEAR-TOTAL-PAGES-X
 22185             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22186
 22187 5099-DATE-RANGE-BREAK-X.
 22188     EXIT.
 22189
 22190 5100-ACCOUNT-BREAK.
 22191
 22192     IF RANGE-CNT NOT = +0
 22193         PERFORM 5000-DATE-RANGE-BREAK
 22194             THRU 5099-DATE-RANGE-BREAK-X
 22195     ELSE
 22196         MOVE +1 TO SUB6
 22197         MOVE +2 TO SUB7
 22198         PERFORM 5800-ADD-PAGES-LEVELS
 22199             THRU 5899-ADD-PAGES-LEVELS-X
 22200         PERFORM 5900-CLEAR-TOTAL-PAGES
 22201             THRU 5999-CLEAR-TOTAL-PAGES-X
 22202                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22203
 22204     MOVE +0 TO RANGE-CNT.
 22205     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22206         VARYING B-SUB FROM 1 BY 1
 22207             UNTIL B-SUB GREATER THAN 50  OR
 22208                   RB-COMPANY (B-SUB) = SPACES.
 22209     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22210         VARYING B-SUB FROM 1 BY 1
 22211             UNTIL B-SUB GREATER THAN 50.
 22212
 22213     IF ACCT-FLG = SPACE
 22214         GO TO 5199-ACCOUNT-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 429
* ECS010.cbl
 22215
 22216     MOVE SPACE TO ACCT-FLG.
 22217     MOVE +2 TO SUB6.
 22218     MOVE +3 TO SUB7.
 22219     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22220     IF LN-CNT GREATER +50
 22221         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22222                 8725-PRT-ACCT-HEADING.
 22223
 22224     MOVE SPACES                     TO PRT.
 22225     PERFORM 8800-PRINT-ROUTINE.
 22226     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22227     MOVE ' TOTALS'                  TO TPH3-DESC.
 22228     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22229     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22230     PERFORM 5900-CLEAR-TOTAL-PAGES
 22231         THRU 5999-CLEAR-TOTAL-PAGES-X
 22232             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22233
 22234 5199-ACCOUNT-BREAK-X.
 22235     EXIT.
 22236
 22237 5200-STATE-BREAK.
 22238
 22239     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22240     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22241     MOVE +3 TO SUB6.
 22242     MOVE +4 TO SUB7.
 22243     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22244
 22245     IF STATE-FLG = SPACE
 22246         GO TO 5299-STATE-BREAK-X.
 22247
 22248     MOVE SPACE         TO STATE-FLG.
 22249     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22250     MOVE 'STATE'       TO TPH1-TYPE.
 22251     MOVE HLD-STATE     TO STATE-L.
 22252
 22253     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22254
 22255     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22256         MOVE SPACES          TO TPH1-DESC
 22257         MOVE HLD-STATE       TO TPH1-ST-CODE
 22258         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22259     ELSE
 22260         MOVE SPACES TO TPH1-DESC
 22261         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22262         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22263
 22264     MOVE 'STATE'  TO TPH2-DESC.
 22265     MOVE 'TOTALS' TO TPH3-DESC.
 22266     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22267     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22268     PERFORM 5900-CLEAR-TOTAL-PAGES
 22269         THRU 5999-CLEAR-TOTAL-PAGES-X
 22270             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22271
 22272 5299-STATE-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 430
* ECS010.cbl
 22273     EXIT.
 22274
 22275 5300-COMP-BREAK.
 22276
 22277     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22278     MOVE +4 TO SUB6.
 22279     MOVE +5 TO SUB7.
 22280     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22281
 22282     IF COMP-FLG = SPACE
 22283         GO TO 5399-COMP-BREAK-X.
 22284
 22285     MOVE ' ' TO COMP-FLG.
 22286     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22287     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22288     MOVE HLD-GROUPING                TO TPH1-DESC.
 22289     MOVE 'COMPANY'                   TO TPH2-DESC.
 22290     MOVE ' TOTALS'                   TO TPH3-DESC.
 22291     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22292     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22293     PERFORM 5900-CLEAR-TOTAL-PAGES
 22294         THRU 5999-CLEAR-TOTAL-PAGES-X
 22295             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22296
 22297 5399-COMP-BREAK-X.
 22298     EXIT.
 22299
 22300 5400-CARR-BREAK.
 22301
 22302     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22303     MOVE +5 TO SUB6.
 22304     MOVE +6 TO SUB7.
 22305     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22306
 22307     IF CARR-FLG = SPACE
 22308         GO TO 5499-CARR-BREAK-X.
 22309
 22310     MOVE ' ' TO CARR-FLG.
 22311     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22312     MOVE 'CARRIER'               TO TPH1-TYPE.
 22313     MOVE HLD-CARRIER             TO TPH1-DESC.
 22314     MOVE 'CARRIER'               TO TPH2-DESC.
 22315     MOVE ' TOTALS'               TO TPH3-DESC.
 22316     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22317     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22318     PERFORM 5900-CLEAR-TOTAL-PAGES
 22319         THRU 5999-CLEAR-TOTAL-PAGES-X
 22320             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22321
 22322 5499-CARR-BREAK-X.
 22323     EXIT.
 22324
 22325 5500-FINAL-BREAK.
 22326
 22327     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22328
 22329     IF FINAL-FLG = SPACE
 22330         GO TO 5599-FINAL-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 431
* ECS010.cbl
 22331
 22332     IF DTE-FICH = '1'
 22333         MOVE '2'  TO  DTE-FICH.
 22334     MOVE +6 TO SUB6.
 22335     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22336     MOVE SPACES   TO TPH1-TYPE.
 22337     MOVE SPACES   TO TPH1-DESC.
 22338     MOVE 'FINAL'  TO TPH2-DESC.
 22339     MOVE 'TOTALS' TO TPH3-DESC.
 22340     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22341     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22342
 22343 5599-FINAL-BREAK-X.
 22344     EXIT.
 22345
 22346 5800-ADD-PAGES-LEVELS.
 22347
 22348     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22349     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22350     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22351     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22352     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22353     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22354     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22355     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22356
 22357 5899-ADD-PAGES-LEVELS-X.
 22358     EXIT.
 22359
 22360 5900-CLEAR-TOTAL-PAGES.
 22361
 22362     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22363             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22364             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22365             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22366
 22367 5999-CLEAR-TOTAL-PAGES-X.
 22368     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 432
* ECS010.cbl
 22370******************************************************************
 22371***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22372******************************************************************
 22373
 22374 6000-TOTAL-PAGE-HEADINGS.
 22375
 22376     MOVE TOTAL-PAGE-HD1 TO PRT.
 22377     PERFORM 8800-PRINT-ROUTINE.
 22378
 22379 6100-ACCT-TOTAL-HEADINGS.
 22380
 22381     MOVE TOTAL-PAGE-HD2 TO PRT.
 22382     MOVE '0' TO P-CTL.
 22383     PERFORM 8800-PRINT-ROUTINE.
 22384     MOVE TOTAL-PAGE-HD3 TO PRT.
 22385     MOVE ' ' TO P-CTL.
 22386     PERFORM 8800-PRINT-ROUTINE.
 22387     PERFORM 8800-PRINT-ROUTINE.
 22388     MOVE +81 TO LN-CNT.
 22389
 22390 6199-PAGE-HEADINGS-X.
 22391     EXIT.
 22392
 22393 6500-PRINT-TOTAL-PAGE.
 22394
 22395     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22396     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22397     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22398
 22399     IF SUB6 = 6 AND ME-DO-UPDATE
 22400         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22401
 22402     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22403
 22404     IF SUB6 = 6 AND ME-DO-UPDATE
 22405         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22406
 22407     COMPUTE TPD-NET-PRM =
 22408         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22409
 22410     IF SUB6 = 6 AND ME-DO-UPDATE
 22411         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22412         GIVING ME-010-NET-L.
 22413
 22414     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22415
 22416     IF SUB6 = 6 AND ME-DO-UPDATE
 22417         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22418
 22419     COMPUTE TPD-PREM-COMP =
 22420         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22421                            - TPL-ACCT-COM (SUB6).
 22422     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22423
 22424     IF SUB6 = 6 AND ME-DO-UPDATE
 22425         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22426
 22427     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 433
* ECS010.cbl
 22428         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22429         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22430         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22431     END-IF.
 22432
 22433     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22434     PERFORM 8800-PRINT-ROUTINE.
 22435     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22436     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22437     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22438     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22439
 22440     IF SUB6 = 6 AND ME-DO-UPDATE
 22441         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22442         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22443
 22444     COMPUTE TPD-NET-PRM =
 22445         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22446
 22447     IF SUB6 = 6 AND ME-DO-UPDATE
 22448         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22449         GIVING ME-010-NET-AH.
 22450
 22451     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22452
 22453     IF SUB6 = 6 AND ME-DO-UPDATE
 22454         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22455
 22456     COMPUTE TPD-PREM-COMP =
 22457         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22458                            - TPA-ACCT-COM (SUB6).
 22459     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22460
 22461     IF SUB6 = 6 AND ME-DO-UPDATE
 22462         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22463
 22464     IF SUB6 = 6
 22465         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22466         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22467         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22468     END-IF.
 22469
 22470     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22471     PERFORM 8800-PRINT-ROUTINE.
 22472
 22473     MOVE 'TOTAL' TO TPD-DESC.
 22474
 22475     COMPUTE TPD-ISS-PRM =
 22476         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22477
 22478     COMPUTE TPD-CNC-PRM =
 22479         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22480
 22481     COMPUTE TPD-NET-PRM =
 22482         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22483         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22484
 22485     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 434
* ECS010.cbl
 22486         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22487
 22488     COMPUTE TPD-PREM-COMP =
 22489         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22490         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22491         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22492
 22493     COMPUTE TPD-CLAIMS =
 22494         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22495
 22496     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22497         NEXT SENTENCE
 22498     ELSE
 22499         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22500         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22501         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22502*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22503*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22504*        MOVE ZEROS               TO SV-LO-CERT
 22505*                                    SV-HI-CERT.
 22506
 22507     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22508     MOVE '0'                     TO P-CTL.
 22509     PERFORM 8800-PRINT-ROUTINE.
 22510     PERFORM 8800-PRINT-ROUTINE.
 22511
 22512 6599-TOTAL-PAGE-PRINT-X.
 22513     EXIT.
 22514*
 22515*
 22516*
 22517**START***********************************************************
 22518*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22519*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22520******************************************************************
 22521*
 22522 6650-GET-RES-STATE-COMM.
 22523*6650-BROWSE-FORWARD.
 22524
 22525     IF DTE-CLIENT NOT = 'DMD'
 22526         GO TO 6700-COMM-EXIT.
 22527
 22528     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22529     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22530     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22531     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22532     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22533     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22534     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22535     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22536
 22537     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22538
 22539*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22540*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22541*VALUE OF PB-CERT-EFF-DT
 22542*
 22543     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 435
* ECS010.cbl
 22544
 22545     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22546
 22547     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22548         GO TO 6700-COMM-EXIT.
 22549
 22550*GET RECORD WHERE POSITIONED
 22551
 22552 6650-READ-ERRESC-NEXT.
 22553     READ ERRESC-IN NEXT RECORD.
 22554
 22555     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22556         GO TO 6700-COMM-EXIT.
 22557
 22558*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22559
 22560     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22561        NEXT SENTENCE
 22562     ELSE
 22563         GO TO 6700-COMM-EXIT.
 22564
 22565     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22566         NEXT SENTENCE
 22567     ELSE
 22568         GO TO 6650-READ-ERRESC-NEXT.
 22569
 22570*  CR-DT  = WS-YYYYMMDD-DT
 22571*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22572*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22573
 22574     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22575         GO TO 6700-COMM-EXIT.
 22576
 22577* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22578
 22579     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22580
 22581     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22582
 22583     IF WS-SUB1 IS GREATER THAN ZERO
 22584         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22585             PERFORM 6680-SET-TABLE-CODE
 22586         ELSE
 22587             PERFORM 6680-SET-COMMISSION.
 22588
 22589     GO TO 6700-COMM-EXIT.
 22590
 22591 6680-SET-TABLE-CODE.
 22592     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22593        MOVE ZEROS             TO WS-SUB1
 22594     ELSE
 22595* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22596* TO COMPUTE AH COMMISSION.
 22597        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22598        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22599        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22600        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22601                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 436
* ECS010.cbl
 22602        PERFORM 6680-READ-CTBL-TABLE
 22603        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22604           MOVE ZEROS          TO WS-SUB1.
 22605
 22606 6680-READ-CTBL-TABLE.
 22607*
 22608* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22609* TO COMPUTE LIFE COMMISSION
 22610
 22611     IF CR-AHTYP = ZERO
 22612        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22613        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22614        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22615
 22616     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22617
 22618     IF ERCTBL-FILE-STATUS EQUAL '00'
 22619* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22620        IF CR-AHTYP NOT = ZERO
 22621             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22622             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22623             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22624             MOVE WK-RATE           TO WS-COMMISSION
 22625                                       PB-I-AH-COMMISSION
 22626        ELSE
 22627* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22628             MOVE CR-LFAMT    TO COMM-CK-AMT
 22629             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22630             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22631             MOVE WK-RATE     TO WS-COMMISSION
 22632                                 PB-I-LIFE-COMMISSION.
 22633
 22634 6680-SET-COMMISSION.
 22635     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22636           MOVE ZEROS         TO WS-SUB1
 22637       ELSE
 22638           MOVE RESC-COMMISSION-PER (WS-SUB)
 22639                              TO WS-COMMISSION WK-RATE
 22640           IF CR-AHTYP NOT = ZERO
 22641                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22642           ELSE
 22643                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22644
 22645 6680-SEARCH-CATEGORY.
 22646     ADD +1 TO WS-SUB.
 22647
 22648     IF WS-SUB IS GREATER THAN +12
 22649         GO TO 6680-EXIT.
 22650
 22651     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22652          MOVE WS-SUB         TO WS-SUB1
 22653          GO TO 6680-EXIT.
 22654
 22655     GO TO 6680-SEARCH-CATEGORY.
 22656
 22657 6680-EXIT.
 22658     EXIT.
 22659
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 437
* ECS010.cbl
 22660 6700-COMM-EXIT.
 22661     EXIT.
 22662*
 22663*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22664
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 438
* ECS010.cbl
 22666******************************************************************
 22667***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22668******************************************************************
 22669
 22670 7000-CLIENT-BILLING-ROUTINE.
 22671*
 22672*
 22673* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22674
 22675     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22676                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22677                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22678                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22679                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22680                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22681                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22682
 22683 7099-BILL-X.
 22684     EXIT.
 22685
 22686
 22687 7500-ADD-UP-REIN-CO.
 22688
 22689     IF RB-COMPANY (B-SUB) NOT = SPACES
 22690         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22691
 22692 7599-ADD-UP-REIN-X.
 22693     EXIT.
 22694
 22695 7900-CLEAR-BILLING-TABLE.
 22696
 22697     MOVE SPACES TO RB-COMPANY (B-SUB).
 22698     MOVE 0      TO RB-COUNT (B-SUB).
 22699
 22700 7999-CLEAR-BILLING-X.
 22701     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 439
* ECS010.cbl
 22703******************************************************************
 22704***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22705******************************************************************
 22706
 22707 8000-DATE-CONVERT-ROUTINE.
 22708
 22709     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22710
 22711 8099-DATE-CONVERT-X.
 22712     EXIT.
 22713
 22714 8000R-CONVERT-STOP-DATE.
 22715
 22716     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22717     MOVE 'L'                     TO DC-OPTION-CODE.
 22718     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22719     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22720     MOVE -1                      TO DC-ELAPSED-DAYS.
 22721     MOVE '6'                     TO DC-OPTION-CODE.
 22722     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22723     MOVE +0                      TO DC-ELAPSED-MONTHS
 22724                                     DC-ELAPSED-DAYS.
 22725     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22726     MOVE ' '                     TO DC-OPTION-CODE.
 22727     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22728
 22729     IF NO-CONVERSION-ERROR
 22730         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22731     ELSE
 22732         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22733                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22734                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22735         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22736                                  TO WS-ABEND-MESSAGE
 22737         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22738         MOVE 4002                TO WS-ABEND-CODE
 22739         GO TO ABEND-PGM.
 22740
 22741 8099R-STOP-DATE-X.
 22742     EXIT.
 22743
 22744
 22745 8100-GET-RATE.
 22746
 22747     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22748
 22749 8199-GET-RATE-X.
 22750     EXIT.
 22751
 22752
 22753 8200-STATE-CODE-LOOKUP.
 22754
 22755     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22756        CLAS-INDEXS NOT = ZERO
 22757         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22758             GO TO 8299-STATE-LOOKUP-X.
 22759
 22760     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 440
* ECS010.cbl
 22761
 22762 8250-STATE-LOOKUP-LOOP.
 22763
 22764     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22765         MOVE 0302 TO WS-ABEND-CODE
 22766         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22767         DISPLAY '******************************'
 22768         DISPLAY '***** ERROR LOCATION 022 *****'
 22769         DISPLAY '******************************'
 22770         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22771         GO TO ABEND-PGM.
 22772
 22773     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22774         ADD +1 TO CLAS-INDEXS
 22775         GO TO 8250-STATE-LOOKUP-LOOP.
 22776
 22777 8299-STATE-LOOKUP-X.
 22778     EXIT.
 22779
 22780
 22781 8300-LIFE-TYPE-LOOKUP.
 22782
 22783     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22784        CLAS-INDEXL NOT = ZERO
 22785         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22786             GO TO 8399-LIFE-LOOKUP-X.
 22787
 22788     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22789
 22790 8350-LIFE-LOOKUP-LOOP.
 22791
 22792     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22793         MOVE 0401 TO WS-ABEND-CODE
 22794         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22795         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22796         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22797         DISPLAY '******************************'
 22798         DISPLAY '***** ERROR LOCATION 023 *****'
 22799         DISPLAY '******************************'
 22800         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22801         IF DTE-CLIENT = 'NCL'
 22802                      OR 'CID' OR 'AHL'
 22803             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22804             MOVE '05'             TO CLAS-LOOK
 22805             GO TO 8350-LIFE-LOOKUP-LOOP
 22806         ELSE
 22807             GO TO ABEND-PGM.
 22808
 22809     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22810         ADD +1 TO CLAS-INDEXL
 22811         GO TO 8350-LIFE-LOOKUP-LOOP.
 22812
 22813     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22814         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22815
 22816 8399-LIFE-LOOKUP-X.
 22817     EXIT.
 22818
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 441
* ECS010.cbl
 22819
 22820 8400-A-H-TYPE-LOOKUP.
 22821
 22822     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22823        CLAS-INDEXA NOT = ZERO
 22824         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22825             GO TO 8499-A-H-LOOKUP-X.
 22826
 22827     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22828
 22829 8450-A-H-LOOKUP-LOOP.
 22830
 22831     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22832         MOVE 0402 TO WS-ABEND-CODE
 22833         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22834         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22835         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22836         DISPLAY '******************************'
 22837         DISPLAY '***** ERROR LOCATION 024 *****'
 22838         DISPLAY '******************************'
 22839         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22840         IF DTE-CLIENT = 'NCL'
 22841             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22842             MOVE '05'             TO CLAS-LOOK
 22843             GO TO 8450-A-H-LOOKUP-LOOP
 22844         ELSE
 22845             GO TO ABEND-PGM.
 22846
 22847     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22848         ADD +1 TO CLAS-INDEXA
 22849         GO TO 8450-A-H-LOOKUP-LOOP.
 22850
 22851 8499-A-H-LOOKUP-X.
 22852     EXIT.
 22853
 22854 8500-REMAINING-TERM-ROUTINE.
 22855
 22856     MOVE ZEROS                      TO CP-REMAINING-TERM
 22857                                        CP-REMAINING-TERM-1
 22858                                        CP-REMAINING-TERM-2
 22859                                        CP-REMAINING-TERM-3
 22860                                        CP-RETURN-CODE
 22861                                        CP-RETURN-CODE-2
 22862                                        REM-TRM1
 22863                                        REM-TRM2
 22864                                        REM-TRM3
 22865                                        TEM-TRM1.
 22866     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22867
 22868     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22869     MOVE 'L'                        TO DC-OPTION-CODE.
 22870     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22871
 22872     IF  NO-CONVERSION-ERROR
 22873         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22874     ELSE
 22875         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22876                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 442
* ECS010.cbl
 22877         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22878         MOVE 3001                   TO WS-ABEND-CODE
 22879         GO TO ABEND-PGM.
 22880
 22881     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22882
 22883     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22884         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22885
 22886     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22887         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22888         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22889                                        DC-ELAPSED-DAYS
 22890         MOVE '3'                    TO DC-OPTION-CODE
 22891         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22892                 8099-DATE-CONVERT-X
 22893         IF  NO-CONVERSION-ERROR
 22894             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22895         ELSE
 22896             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22897
 22898     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22899         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22900
 22901     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22902         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22903         MOVE +1                     TO DC-ELAPSED-MONTHS
 22904         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22905         MOVE '6'                    TO DC-OPTION-CODE
 22906         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22907                 8099-DATE-CONVERT-X
 22908         IF  NO-CONVERSION-ERROR
 22909             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22910             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22911         ELSE
 22912             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22913                                     TO WS-ABEND-MESSAGE
 22914             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22915             MOVE 3002               TO WS-ABEND-CODE
 22916             GO TO ABEND-PGM.
 22917
 22918     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22919     MOVE 'L'                        TO DC-OPTION-CODE.
 22920     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22921
 22922     IF  NO-CONVERSION-ERROR
 22923         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22924     ELSE
 22925         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22926             W-VAL-ERROR (W-VAL-SOURCE)
 22927         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22928             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22929             DC-ERROR-CODE
 22930         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22931         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22932             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22933             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22934             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 443
* ECS010.cbl
 22935*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22936*                                    TO WS-ABEND-MESSAGE
 22937*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22938*        MOVE 3003                   TO WS-ABEND-CODE
 22939*        GO TO ABEND-PGM.
 22940
 22941     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22942     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22943     MOVE '3'                        TO CP-PROCESS-TYPE.
 22944     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22945     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22946     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22947
 22948*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22949*                                    TO CP-REM-TERM-METHOD.
 22950
 22951     IF  DTE-CLIENT = 'FIM'
 22952         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22953
 22954     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22955         IF WE-LF-AH = AH-OVERRIDE-L1
 22956             MOVE '2'                TO CP-REM-TERM-METHOD
 22957         ELSE
 22958             IF CR-LFTYP = '01' OR '03'
 22959                 MOVE '4'            TO CP-REM-TERM-METHOD
 22960             ELSE
 22961                 IF CR-LFTYP = '02' OR '04'
 22962                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22963
 22964     IF  DTE-CLIENT = 'CSL'
 22965         IF  CR-CARRIER = '2'
 22966             IF  CR-LFTYP = '07' OR  '08'
 22967                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22968
 22969     IF  DTE-CLIENT = 'POS'
 22970         IF  CR-CARRIER = '1'
 22971             MOVE '1'                TO CP-REM-TERM-METHOD
 22972         ELSE
 22973             MOVE '2'                TO CP-REM-TERM-METHOD.
 22974
 22975     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22976         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22977
 22978     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22979         GO TO 8540-CALC-REM-TERM-AH.
 22980
 22981 8520-CALC-REM-TERM-LIFE.
 22982
 22983     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22984     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22985     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22986*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22987     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22988                                        CP-LOAN-TERM.
 22989
 22990     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22991             AND
 22992         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 444
* ECS010.cbl
 22993         ADD +1                      TO CP-ORIGINAL-TERM
 22994                                        CP-LOAN-TERM.
 22995
 22996     IF  CP-TERM-IS-DAYS
 22997         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22998     ELSE
 22999         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 23000
 23001     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 23002
 23003     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 23004         ADD +1                      TO W-ORGTRM-0-LF
 23005         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 23006             CR-FULL-CONTROL
 23007         GO TO 8599-REM-TERM-X.
 23008
 23009     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 23010
 23011     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 23012         ADD +1                      TO W-RET-CODE-LF
 23013         GO TO 8599-REM-TERM-X.
 23014*
 23015*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 23016*                                    TO WS-ABEND-MESSAGE
 23017*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23018*        MOVE 2002                   TO WS-ABEND-CODE
 23019*        GO TO ABEND-PGM.
 23020
 23021     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 23022             AND
 23023         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 23024         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 23025         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 23026         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 23027
 23028     IF  CP-REMAINING-TERM-1 NEGATIVE
 23029         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 23030
 23031     IF  CP-REMAINING-TERM-2 NEGATIVE
 23032         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 23033
 23034     IF DTE-CLIENT = 'NCL'
 23035         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23036                                        CP-REMAINING-TERM-3.
 23037
 23038     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23039     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23040     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23041     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23042
 23043     GO TO 8599-REM-TERM-X.
 23044
 23045 8520-EXIT.
 23046     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 445
* ECS010.cbl
 23048 8540-CALC-REM-TERM-AH.
 23049
 23050     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 23051     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 23052     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 23053     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 23054                                        CP-LOAN-TERM.
 23055     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 23056
 23057     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 23058
 23059     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 23060         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 23061             CR-FULL-CONTROL
 23062         ADD +1                      TO W-ORGTRM-0-AH
 23063         GO TO 8599-REM-TERM-X.
 23064
 23065     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 23066
 23067     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 23068         ADD +1                      TO W-RET-CODE-AH
 23069         GO TO 8599-REM-TERM-X.
 23070*
 23071*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 23072*                                    TO WS-ABEND-MESSAGE
 23073*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23074*        MOVE 2001                   TO WS-ABEND-CODE
 23075*        GO TO ABEND-PGM.
 23076
 23077     IF DTE-CLIENT = 'NCL'
 23078         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23079                                        CP-REMAINING-TERM-3.
 23080
 23081     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23082     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23083     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23084     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23085
 23086 8599-REM-TERM-X.
 23087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 446
* ECS010.cbl
 23089
 23090******************************************************************
 23091***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 23092******************************************************************
 23093
 23094 8600-DISPLAY-PRT.
 23095
 23096     IF  DIS-LINE-CNT GREATER THAN 59
 23097         PERFORM 8600-DISPLAY-HD THRU
 23098             8600-HD-EXIT.
 23099
 23100     ADD  1  TO DIS-LINE-CNT.
 23101     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23102     MOVE  SPACES TO DISPLAY-REC
 23103                     DISPLAY-LINE.
 23104
 23105 8600-DISPLAY-EXIT.
 23106     EXIT.
 23107
 23108
 23109 8600-DISPLAY-HD.
 23110
 23111     MOVE '1'  TO  DISPLAY-CC.
 23112     MOVE ZEROS TO DIS-LINE-CNT.
 23113     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23114     ADD +1 TO DIS-LINE-CNT.
 23115     MOVE ' '  TO  DISPLAY-CC.
 23116     MOVE SPACES TO DISPLAY-REC.
 23117     WRITE DISPLAY-REC.
 23118     ADD +1 TO DIS-LINE-CNT.
 23119     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23120     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23121     ADD +1 TO DIS-LINE-CNT.
 23122     MOVE SPACES TO DISPLAY-REC.
 23123     ADD +1 TO DIS-LINE-CNT.
 23124     WRITE DISPLAY-REC.
 23125
 23126 8600-HD-EXIT.
 23127     EXIT.
 23128
 23129******************************************************************
 23130***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23131******************************************************************
 23132
 23133 8600-SETUP-DETAIL-LINE.
 23134
 23135     MOVE SPACES                TO TR-DTL2.
 23136
 23137     MOVE CR-CERT-NO            TO TRD-CERT.
 23138     MOVE CR-YR                 TO TRD-ISYR.
 23139     MOVE CR-MO                 TO TRD-ISMO.
 23140     MOVE CR-DA                 TO TRD-ISDA.
 23141     MOVE CR-AGE                TO TRD-AGE.
 23142
 23143 8689-SETUP-DETAIL-X.
 23144     EXIT.
 23145
 23146 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 447
* ECS010.cbl
 23147
 23148     IF LN-CNT GREATER THAN LN-MX
 23149         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23150                 8799-PRT-HEADINGS-X.
 23151     MOVE TRD-CERT TO SV-TRD-CERT.
 23152     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23153
 23154     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23155         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23156
 23157     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23158     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23159     MOVE TR-DTL TO PRT.
 23160
 23161     IF NOT WS-CHANGE-REC
 23162         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23163     ELSE
 23164         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23165
 23166     PERFORM 8800-PRINT-ROUTINE.
 23167
 23168 8699-PRT-DETAIL-X.
 23169     EXIT.
 23170
 23171 8700-PRINT-REPORT-HEADINGS.
 23172     ADD +1 TO PG-CNT.
 23173     MOVE PG-CNT TO TR-PG.
 23174     MOVE +0 TO LN-CNT.
 23175     MOVE TR-HD-1 TO PRT.
 23176     PERFORM 8800-PRINT-ROUTINE.
 23177     MOVE TR-HD-2 TO PRT.
 23178     PERFORM 8800-PRINT-ROUTINE.
 23179     MOVE TR-HD-3 TO PRT.
 23180     PERFORM 8800-PRINT-ROUTINE.
 23181     ADD +1 TO LN-CNT.
 23182
 23183 8725-PRT-ACCT-HEADING.
 23184     MOVE TR-HD-4 TO PRT.
 23185     PERFORM 8800-PRINT-ROUTINE.
 23186     MOVE TR-HD-5 TO PRT.
 23187     PERFORM 8800-PRINT-ROUTINE.
 23188
 23189 8750-PRT-RANGE-HEADING.
 23190     MOVE TR-HD-6 TO PRT.
 23191     PERFORM 8800-PRINT-ROUTINE.
 23192
 23193 8775-PRT-COLUMN-HEADINGS.
 23194     MOVE TR-HD-7 TO PRT.
 23195     PERFORM 8800-PRINT-ROUTINE.
 23196     MOVE TR-HD-8 TO PRT.
 23197     PERFORM 8800-PRINT-ROUTINE.
 23198     MOVE TR-HD-9 TO PRT.
 23199     PERFORM 8800-PRINT-ROUTINE.
 23200     PERFORM 8800-PRINT-ROUTINE.
 23201
 23202 8799-PRT-HEADINGS-X.
 23203     EXIT.
 23204
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 448
* ECS010.cbl
 23205 8800-PRINT-ROUTINE.
 23206     MOVE P-CTL TO X.
 23207     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23208     ADD +1 TO LN-CNT.
 23209     MOVE SPACES TO PRT.
 23210
 23211 8900-PRINT-A-LINE.
*23212                             COPY ELCPRT2.
 23213******************************************************************04/15/98
 23214*                                                                *ELCPRT2
 23215*                                                                *ELCPRT2
 23216*                            ELCPRT2                             *   LV005
 23217*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23218*                            VMOD=2.002                          *   CL**5
 23219*                                                                *   CL**4
 23220******************************************************************   CL**4
 23221                                                                     CL**4
 23222     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23223        FICH-OPEN    = SPACE                                         CL**4
 23224         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23225         OPEN OUTPUT FICH.                                           CL**4
 23226                                                                     CL**4
 23227     IF DTE-FICH NOT = SPACE                                         CL**4
 23228         MOVE X                  TO  P-CTL                           CL**4
 23229         WRITE FICH-REC FROM PRT.                                    CL**4
 23230                                                                     CL**4
 23231     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23232       MOVE X                    TO  P-CTL                           CL**4
 23233       IF P-CTL = ' '                                                CL**4
 23234         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23235       ELSE                                                          CL**4
 23236         IF P-CTL = '0'                                              CL**4
 23237           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23238         ELSE                                                        CL**4
 23239           IF P-CTL = '-'                                            CL**4
 23240             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23241           ELSE                                                      CL**4
 23242             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23243                                                                     CL**4
 23244******************************************************************   CL**4
 23245
 23246 8999-PRT-LINE-X.
 23247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 449
* ECS010.cbl
 23249******************************************************************
 23250***          E N D   O F   J O B   P R O C E S S I N G         ***
 23251******************************************************************
 23252
 23253 9910-EOJ-1.
 23254     IF TR-CNT = ZERO
 23255         IF (DTE-PGM-OPT = '2' OR '3') OR
 23256            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23257                          'ITY' OR 'DAC' OR 'FLC')
 23258             NEXT SENTENCE
 23259         ELSE
 23260             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23261             MOVE 0703                    TO WS-ABEND-CODE
 23262             DISPLAY '******************************'
 23263             DISPLAY '***** ERROR LOCATION 025 *****'
 23264             DISPLAY '******************************'
 23265             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23266             GO TO ABEND-PGM.
 23267
 23268     MOVE '*'         TO TRANS-EOF-FLAG.
 23269     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23270
 23271     IF EOF-ON-CERT
 23272         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23273         GO TO 9940-EOJ-FIN.
 23274
 23275     GO TO 0330-MATCH-PENDING-TO-CERT.
 23276
 23277 9920-EOJ-2.
 23278     MOVE '*'         TO CERT-EOF-FLAG.
 23279     MOVE HIGH-VALUES TO CIR-CONTROL.
 23280
 23281     IF EOF-ON-TRANS
 23282         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23283         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23284         GO TO 9940-EOJ-FIN.
 23285
 23286     GO TO 0299-READ-CERT-X.
 23287
 23288 9930-EOJ-3.
 23289     IF PROCESSING-COMPLETED
 23290         GO TO 9950-EOJ-FIN-GO.
 23291
 23292     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23293     MOVE 'MISSING ACCOUNT MASTER'
 23294                               TO WS-ABEND-MESSAGE.
 23295     MOVE 0302                 TO WS-ABEND-CODE.
 23296     DISPLAY '******************************'
 23297     DISPLAY '***** ERROR LOCATION 026 *****'
 23298     DISPLAY '******************************'
 23299     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23300     GO TO ABEND-PGM.
 23301
 23302 9940-EOJ-FIN.
 23303     MOVE '*'        TO PROCESSING-FLAG.
 23304     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23305
 23306     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 450
* ECS010.cbl
 23307             0199-READ-ACCOUNT-X.
 23308     GO TO 9940-EOJ-FIN.
 23309
 23310 9950-EOJ-FIN-GO.
 23311     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23312     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23313*
 23314*
 23315* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23316     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23317
 23318 9960-NO-TOTS.
 23319
 23320     MOVE +15                    TO LN-CNT.
 23321     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23322     IF ME-DO-UPDATE
 23323         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23324
 23325     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23326     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23327     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23328
 23329
 23330     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23331     MOVE TR-TTL-HD              TO PRT.
 23332     PERFORM 8800-PRINT-ROUTINE.
 23333     ADD +1 TO LN-CNT.
 23334     MOVE TR-CNT                TO TTL-PT-CNT.
 23335     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23336     MOVE TR-TTL-HD             TO PRT.
 23337     PERFORM 8800-PRINT-ROUTINE.
 23338     ADD +1 TO LN-CNT.
 23339
 23340     IF DUP-CNT = ZERO
 23341         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23342
 23343     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23344
 23345     IF ME-DO-UPDATE
 23346         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23347
 23348     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23349     MOVE TR-TTL-HD               TO PRT.
 23350     PERFORM 8800-PRINT-ROUTINE.
 23351     PERFORM 8800-PRINT-ROUTINE.
 23352     ADD +1 TO LN-CNT.
 23353
 23354     MOVE '1'                           TO  DTL-REC-TYPE.
 23355     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23356     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23357     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23358                                        TO  DTL-CERT-OUT-CONTROL.
 23359     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23360     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23361     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23362
 23363     MOVE +1 TO SUB3.
 23364 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 451
* ECS010.cbl
 23365
 23366     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23367         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23368         MOVE MISMATCH-PAGE-NUMBER
 23369                                 TO  TR-PG
 23370         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23371         MOVE MR-CTL             TO  X
 23372         MOVE X TO LCP-ASA
 23373         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23374             THRU LCP-WRITE-END-MISMATCH-RPT
 23375         MOVE TR-HD-2            TO  MISMATCH-RPT
 23376         MOVE MR-CTL             TO  X
 23377         MOVE X TO LCP-ASA
 23378         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23379             THRU LCP-WRITE-END-MISMATCH-RPT
 23380         MOVE TR-HD-3            TO  MISMATCH-RPT
 23381         MOVE MR-CTL             TO  X
 23382         MOVE X TO LCP-ASA
 23383         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23384             THRU LCP-WRITE-END-MISMATCH-RPT
 23385         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23386         MOVE MR-CTL             TO  X
 23387         MOVE X TO LCP-ASA
 23388         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23389             THRU LCP-WRITE-END-MISMATCH-RPT
 23390         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23391
 23392     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23393
 23394     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23395     MOVE MR-CTL                        TO  X.
 23396     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23397
 23398     MOVE X TO LCP-ASA
 23399     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23400         THRU LCP-WRITE-END-MISMATCH-RPT.
 23401
 23402     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23403     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23404
 23405     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23406     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23407
 23408     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23409     IF  DUPE-STATUS (SUB3)  =  '2'
 23410         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23411     IF  DUPE-STATUS (SUB3)  =  '5'
 23412         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23413     IF  DUPE-STATUS (SUB3)  =  'M'
 23414         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23415     IF  DUPE-STATUS (SUB3)  =  '9'
 23416         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23417     IF  DUPE-STATUS (SUB3)  =  'D'
 23418         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23419     IF  DUPE-STATUS (SUB3)  =  'V'
 23420         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23421     IF  DUPE-STATUS (SUB3)  =  'P'
 23422         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 452
* ECS010.cbl
 23423
 23424     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23425     MOVE MR-CTL                        TO  X.
 23426     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23427
 23428     MOVE X TO LCP-ASA
 23429     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23430         THRU LCP-WRITE-END-MISMATCH-RPT.
 23431
 23432     IF SUB3 LESS THAN DUP-CNT
 23433         ADD +1 TO SUB3
 23434         GO TO 9965-PRT-DUPES.
 23435
 23436 9969-CHECK-MISMATCHED-TOTS.
 23437
 23438     IF W-MM-LF-PRM = ZEROS  AND
 23439        W-MM-AH-PRM = ZEROS  AND
 23440        W-MM-LF-RFD = ZEROS  AND
 23441        W-MM-AH-RFD = ZEROS  AND
 23442        W-MM-LF-CLM = ZEROS  AND
 23443        W-MM-AH-CLM = ZEROS
 23444         GO TO 9970-FIN-TOTS.
 23445
 23446     MOVE SPACES                        TO  MISMATCH-RPT.
 23447     MOVE '0'                           TO  MR-CTL  X.
 23448     MOVE X TO LCP-ASA
 23449     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23450         THRU LCP-WRITE-END-MISMATCH-RPT.
 23451
 23452     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23453     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23454     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23455
 23456     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23457     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23458     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23459
 23460     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23461     MOVE '0'                           TO  MR-CTL  X.
 23462     MOVE X TO LCP-ASA
 23463     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23464         THRU LCP-WRITE-END-MISMATCH-RPT.
 23465
 23466     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23467     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23468     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23469
 23470     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23471     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23472     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23473
 23474     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23475     MOVE '0'                           TO  MR-CTL  X.
 23476     MOVE X TO LCP-ASA
 23477     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23478         THRU LCP-WRITE-END-MISMATCH-RPT.
 23479
 23480     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 453
* ECS010.cbl
 23481     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23482     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23483
 23484     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23485     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23486     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23487
 23488     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23489     MOVE '0'                           TO  MR-CTL  X.
 23490     MOVE X TO LCP-ASA
 23491     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23492         THRU LCP-WRITE-END-MISMATCH-RPT.
 23493
 23494 9970-FIN-TOTS.
 23495
 23496     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23497
 23498     IF ME-DO-UPDATE
 23499         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23500
 23501     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23502     MOVE TR-TTL-HD               TO PRT.
 23503     PERFORM 8800-PRINT-ROUTINE.
 23504
 23505     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23506     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23507     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23508     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23509
 23510     MOVE DE-CNT                  TO TTL-PT-CNT.
 23511     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23512     MOVE TR-TTL-HD               TO PRT.
 23513     PERFORM 8800-PRINT-ROUTINE.
 23514
 23515     MOVE EP-CNT                  TO TTL-PT-CNT.
 23516     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23517     MOVE TR-TTL-HD               TO PRT.
 23518     PERFORM 8800-PRINT-ROUTINE.
 23519     PERFORM 8800-PRINT-ROUTINE.
 23520
 23521     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23522     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23523     MOVE TR-TTL-HD               TO PRT.
 23524     PERFORM 8800-PRINT-ROUTINE.
 23525
 23526     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23527     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23528     MOVE TR-TTL-HD               TO PRT.
 23529     PERFORM 8800-PRINT-ROUTINE.
 23530
 23531     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23532     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23533     MOVE TR-TTL-HD               TO PRT.
 23534     PERFORM 8800-PRINT-ROUTINE.
 23535
 23536     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23537         GO TO 9990-FINAL-CLOSE.
 23538
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 454
* ECS010.cbl
 23539**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23540**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23541**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23542**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23543
 23544     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23545     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23546     MOVE TR-TTL-HD               TO PRT.
 23547     PERFORM 8800-PRINT-ROUTINE.
 23548
 23549     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23550     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23551     MOVE TR-TTL-HD               TO PRT.
 23552     PERFORM 8800-PRINT-ROUTINE.
 23553
 23554     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23555     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23556     MOVE TR-TTL-HD               TO PRT.
 23557     PERFORM 8800-PRINT-ROUTINE.
 23558
 23559     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23560     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23561     MOVE TR-TTL-HD               TO PRT.
 23562     PERFORM 8800-PRINT-ROUTINE.
 23563
 23564     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23565     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23566     MOVE TR-TTL-HD               TO PRT.
 23567     PERFORM 8800-PRINT-ROUTINE.
 23568
 23569     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23570     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23571     MOVE TR-TTL-HD               TO PRT.
 23572     PERFORM 8800-PRINT-ROUTINE.
 23573
 23574     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23575     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23576     MOVE TR-TTL-HD               TO PRT.
 23577     PERFORM 8800-PRINT-ROUTINE.
 23578
 23579     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23580     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23581     MOVE TR-TTL-HD               TO PRT.
 23582     PERFORM 8800-PRINT-ROUTINE.
 23583
 23584     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23585     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23586     MOVE TR-TTL-HD               TO PRT.
 23587     PERFORM 8800-PRINT-ROUTINE.
 23588
 23589     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23590     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23591     MOVE TR-TTL-HD               TO PRT.
 23592     PERFORM 8800-PRINT-ROUTINE.
 23593
 23594     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23595     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23596     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 455
* ECS010.cbl
 23597     PERFORM 8800-PRINT-ROUTINE.
 23598
 23599     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23600     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23601     MOVE TR-TTL-HD               TO PRT.
 23602     PERFORM 8800-PRINT-ROUTINE.
 23603
 23604     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23605     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23606     MOVE TR-TTL-HD               TO PRT.
 23607     PERFORM 8800-PRINT-ROUTINE.
 23608
 23609     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23610     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23611     MOVE TR-TTL-HD               TO PRT.
 23612     PERFORM 8800-PRINT-ROUTINE.
 23613
 23614     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23615     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23616     MOVE TR-TTL-HD               TO PRT.
 23617     PERFORM 8800-PRINT-ROUTINE.
 23618
 23619     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23620     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23621     MOVE TR-TTL-HD               TO PRT.
 23622     PERFORM 8800-PRINT-ROUTINE.
 23623
 23624     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23625     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23626     MOVE TR-TTL-HD               TO PRT.
 23627     PERFORM 8800-PRINT-ROUTINE.
 23628
 23629     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23630     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23631     MOVE TR-TTL-HD               TO PRT.
 23632     PERFORM 8800-PRINT-ROUTINE.
 23633
 23634     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23635     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23636     MOVE TR-TTL-HD               TO PRT.
 23637     PERFORM 8800-PRINT-ROUTINE.
 23638
 23639     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23640     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23641     MOVE TR-TTL-HD               TO PRT.
 23642     PERFORM 8800-PRINT-ROUTINE.
 23643
 23644     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23645     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23646     MOVE TR-TTL-HD               TO PRT.
 23647     PERFORM 8800-PRINT-ROUTINE.
 23648
 23649     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23650     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23651     MOVE TR-TTL-HD               TO PRT.
 23652     PERFORM 8800-PRINT-ROUTINE.
 23653
 23654     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 456
* ECS010.cbl
 23655     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23656     MOVE TR-TTL-HD               TO PRT.
 23657     PERFORM 8800-PRINT-ROUTINE.
 23658
 23659     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23660     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23661     MOVE TR-TTL-HD               TO PRT.
 23662     PERFORM 8800-PRINT-ROUTINE.
 23663
 23664     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23665     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23666     MOVE TR-TTL-HD               TO PRT.
 23667     PERFORM 8800-PRINT-ROUTINE.
 23668
 23669     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23670     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23671     MOVE TR-TTL-HD               TO PRT.
 23672     PERFORM 8800-PRINT-ROUTINE.
 23673
 23674     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23675     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23676     MOVE TR-TTL-HD               TO PRT.
 23677     PERFORM 8800-PRINT-ROUTINE.
 23678
 23679     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23680     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23681     MOVE TR-TTL-HD               TO PRT.
 23682     PERFORM 8800-PRINT-ROUTINE.
 23683
 23684     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23685     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23686     MOVE TR-TTL-HD               TO PRT.
 23687     PERFORM 8800-PRINT-ROUTINE.
 23688
 23689     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23690     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23691     MOVE TR-TTL-HD               TO PRT.
 23692     PERFORM 8800-PRINT-ROUTINE.
 23693
 23694     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23695     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23696     MOVE TR-TTL-HD               TO PRT.
 23697     PERFORM 8800-PRINT-ROUTINE.
 23698
 23699     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23700     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23701     MOVE TR-TTL-HD               TO PRT.
 23702     PERFORM 8800-PRINT-ROUTINE.
 23703
 23704     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23705     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23706     MOVE TR-TTL-HD               TO PRT.
 23707     PERFORM 8800-PRINT-ROUTINE.
 23708
 23709     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23710     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23711     MOVE TR-TTL-HD               TO PRT.
 23712     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 457
* ECS010.cbl
 23713
 23714     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23715     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23716     MOVE TR-TTL-HD               TO PRT.
 23717     PERFORM 8800-PRINT-ROUTINE.
 23718
 23719     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23720     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23721     MOVE TR-TTL-HD               TO PRT.
 23722     PERFORM 8800-PRINT-ROUTINE.
 23723
 23724     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23725     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23726     MOVE TR-TTL-HD               TO PRT.
 23727     PERFORM 8800-PRINT-ROUTINE.
 23728
 23729     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23730     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23731     MOVE TR-TTL-HD               TO PRT.
 23732     PERFORM 8800-PRINT-ROUTINE.
 23733
 23734     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23735     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23736     MOVE TR-TTL-HD               TO PRT.
 23737     PERFORM 8800-PRINT-ROUTINE.
 23738
 23739     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23740     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23741                                  TO TTL-HD-DS.
 23742     MOVE TR-TTL-HD               TO PRT.
 23743     PERFORM 8800-PRINT-ROUTINE.
 23744
 23745     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23746     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23747                                  TO TTL-HD-DS.
 23748     MOVE TR-TTL-HD               TO PRT.
 23749     PERFORM 8800-PRINT-ROUTINE.
 23750
 23751     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23752     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23753                                  TO TTL-HD-DS.
 23754     MOVE TR-TTL-HD               TO PRT.
 23755     PERFORM 8800-PRINT-ROUTINE.
 23756
 23757     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23758     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23759                                  TO TTL-HD-DS.
 23760     MOVE TR-TTL-HD               TO PRT.
 23761     PERFORM 8800-PRINT-ROUTINE.
 23762
 23763     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23764     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23765                                  TO TTL-HD-DS.
 23766     MOVE TR-TTL-HD               TO PRT.
 23767     PERFORM 8800-PRINT-ROUTINE.
 23768
 23769     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23770     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 458
* ECS010.cbl
 23771                                  TO TTL-HD-DS.
 23772     MOVE TR-TTL-HD               TO PRT.
 23773     PERFORM 8800-PRINT-ROUTINE.
 23774
 23775     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23776     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23777     MOVE TR-TTL-HD               TO PRT.
 23778     PERFORM 8800-PRINT-ROUTINE.
 23779
 23780     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23781     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23782     MOVE TR-TTL-HD               TO PRT.
 23783     PERFORM 8800-PRINT-ROUTINE.
 23784
 23785     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23786     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23787     MOVE TR-TTL-HD               TO PRT.
 23788     PERFORM 8800-PRINT-ROUTINE.
 23789
 23790     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23791     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23792     MOVE TR-TTL-HD               TO PRT.
 23793     PERFORM 8800-PRINT-ROUTINE.
 23794
 23795     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23796     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23797     MOVE TR-TTL-HD               TO PRT.
 23798     PERFORM 8800-PRINT-ROUTINE.
 23799
 23800     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23801     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23802     MOVE TR-TTL-HD               TO PRT.
 23803     PERFORM 8800-PRINT-ROUTINE.
 23804
 23805     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23806     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23807     MOVE TR-TTL-HD               TO PRT.
 23808     PERFORM 8800-PRINT-ROUTINE.
 23809
 23810     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23811     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23812     MOVE TR-TTL-HD               TO PRT.
 23813     PERFORM 8800-PRINT-ROUTINE.
 23814
 23815     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23816     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23817     MOVE TR-TTL-HD               TO PRT.
 23818     PERFORM 8800-PRINT-ROUTINE.
 23819
 23820     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23821     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23822     MOVE TR-TTL-HD               TO PRT.
 23823     PERFORM 8800-PRINT-ROUTINE.
 23824
 23825     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23826     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23827     MOVE TR-TTL-HD               TO PRT.
 23828     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 459
* ECS010.cbl
 23829
 23830     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23831     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23832     MOVE TR-TTL-HD               TO PRT.
 23833     PERFORM 8800-PRINT-ROUTINE.
 23834
 23835     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23836     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23837     MOVE TR-TTL-HD               TO PRT.
 23838     PERFORM 8800-PRINT-ROUTINE.
 23839
 23840     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23841     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23842     MOVE TR-TTL-HD               TO PRT.
 23843     PERFORM 8800-PRINT-ROUTINE.
 23844
 23845     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23846     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23847     MOVE TR-TTL-HD               TO PRT.
 23848     PERFORM 8800-PRINT-ROUTINE.
 23849
 23850     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23851     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23852     MOVE TR-TTL-HD               TO PRT.
 23853     PERFORM 8800-PRINT-ROUTINE.
 23854
 23855     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23856     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23857     MOVE TR-TTL-HD               TO PRT.
 23858     PERFORM 8800-PRINT-ROUTINE.
 23859
 23860     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23861     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23862     MOVE TR-TTL-HD               TO PRT.
 23863     PERFORM 8800-PRINT-ROUTINE.
 23864
 23865     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23866     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23867     MOVE TR-TTL-HD               TO PRT.
 23868     PERFORM 8800-PRINT-ROUTINE.
 23869
 23870     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23871     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23872     MOVE TR-TTL-HD               TO PRT.
 23873     PERFORM 8800-PRINT-ROUTINE.
 23874
 23875     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23876     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23877     MOVE TR-TTL-HD               TO PRT.
 23878     PERFORM 8800-PRINT-ROUTINE.
 23879
 23880     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23881     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23882     MOVE TR-TTL-HD               TO PRT.
 23883     PERFORM 8800-PRINT-ROUTINE.
 23884
 23885     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23886     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 460
* ECS010.cbl
 23887     MOVE TR-TTL-HD               TO PRT.
 23888     PERFORM 8800-PRINT-ROUTINE.
 23889
 23890     MOVE W-1-EP                  TO TTL-PT-CNT.
 23891     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23892     MOVE TR-TTL-HD               TO PRT.
 23893     PERFORM 8800-PRINT-ROUTINE.
 23894
 23895     MOVE W-P-EP                  TO TTL-PT-CNT.
 23896     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23897     MOVE TR-TTL-HD               TO PRT.
 23898     PERFORM 8800-PRINT-ROUTINE.
 23899
 23900     MOVE W-M-EP                  TO TTL-PT-CNT.
 23901     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23902     MOVE TR-TTL-HD               TO PRT.
 23903     PERFORM 8800-PRINT-ROUTINE.
 23904
 23905     MOVE W-R-EP                  TO TTL-PT-CNT.
 23906     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23907     MOVE TR-TTL-HD               TO PRT.
 23908     PERFORM 8800-PRINT-ROUTINE.
 23909
 23910     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23911     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23912     MOVE TR-TTL-HD               TO PRT.
 23913     PERFORM 8800-PRINT-ROUTINE.
 23914
 23915     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23916     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23917     MOVE TR-TTL-HD               TO PRT.
 23918     PERFORM 8800-PRINT-ROUTINE.
 23919
 23920     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23921     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23922     MOVE TR-TTL-HD               TO PRT.
 23923     PERFORM 8800-PRINT-ROUTINE.
 23924
 23925     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23926     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23927     MOVE TR-TTL-HD               TO PRT.
 23928     PERFORM 8800-PRINT-ROUTINE.
 23929
 23930     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23931     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23932     MOVE TR-TTL-HD               TO PRT.
 23933     PERFORM 8800-PRINT-ROUTINE.
 23934
 23935     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23936     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23937     MOVE TR-TTL-HD               TO PRT.
 23938     PERFORM 8800-PRINT-ROUTINE.
 23939
 23940     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23941     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23942     MOVE TR-TTL-HD               TO PRT.
 23943     PERFORM 8800-PRINT-ROUTINE.
 23944
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 461
* ECS010.cbl
 23945     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23946     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23947     MOVE TR-TTL-HD               TO PRT.
 23948     PERFORM 8800-PRINT-ROUTINE.
 23949
 23950     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23951     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23952     MOVE TR-TTL-HD               TO PRT.
 23953     PERFORM 8800-PRINT-ROUTINE.
 23954
 23955     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23956     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23957     MOVE TR-TTL-HD               TO PRT.
 23958     PERFORM 8800-PRINT-ROUTINE.
 23959
 23960     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23961     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23962     MOVE TR-TTL-HD               TO PRT.
 23963     PERFORM 8800-PRINT-ROUTINE.
 23964
 23965 9990-FINAL-CLOSE.
*23966                             COPY ELCPRTC.
 23967******************************************************************04/15/98
 23968*                                                                *ELCPRTC
 23969*                                                                *ELCPRTC
 23970*                            ELCPRTC.                            *   LV003
 23971*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23972*                            VMOD=2.002                          *   CL**2
 23973*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23974*                                                                *ELCPRTC
 23975* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23976******************************************************************ELCPRTC
 23977                                                                  ELCPRTC
 23978      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23979          CLOSE FICH.                                             ELCPRTC
 23980                                                                  ELCPRTC
 23981******************************************************************ELCPRTC
 23982
 23983     IF DTE-CLIENT = 'DMD'
 23984         CLOSE ERRESC-IN.
 23985
 23986     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23987
 23988     DISPLAY ' '.
 23989     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23990     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23991     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23992     DISPLAY ' '.
 23993
 23994     MOVE    ' DISPLAY ERROR COUNT = '
 23995       TO  DIS-LINE-REASON.
 23996     MOVE  ERROR-COUNT
 23997       TO  DIS-LINE-REC.
 23998         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23999
 24000     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 24001           DISPLAY-PRT
 24002           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 462
* ECS010.cbl
 24003           ME50-ECS010-BALANCE
 24004           PENDING-EXTRACT  SUMMARY-EXTR.
 24005
 24006     if (dte-client = 'DCC')
 24007        and (dte-pgm-opt = '1')
 24008        close new-detail-extr
 24009     end-if
 24010
 24011     IF DTE-PGM-OPT = '1'
 24012         CLOSE CERT-MASTER-OUT
 24013               DETAIL-EXTR
 24014     end-if
 24015
 24016     IF ERACCTT-FILE-STATUS NOT = '00'
 24017         MOVE '12'                TO ABEND-CODE-1
 24018         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 24019         DISPLAY '******************************'
 24020         DISPLAY '***** ERROR LOCATION 027 *****'
 24021         DISPLAY '******************************'
 24022         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24023           GO TO ABEND-PGM.
 24024
 24025     IF COMM-OPEN-SW = 'X'
 24026         CLOSE ERCTBL
 24027         IF ERCTBL-FILE-STATUS NOT = '00'
 24028             MOVE '42'               TO ABEND-CODE-1
 24029             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 24030             DISPLAY '******************************'
 24031             DISPLAY '***** ERROR LOCATION 028 *****'
 24032             DISPLAY '******************************'
 24033             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24034             GO TO ABEND-PGM.
 24035
 24036     IF REIN-OPEN-SW = 'X'
 24037         CLOSE ERRTBL-IN
 24038         IF ERRTBL-FILE-STATUS NOT = '00'
 24039             MOVE '22'               TO ABEND-CODE-1
 24040             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 24041             DISPLAY '******************************'
 24042             DISPLAY '***** ERROR LOCATION 029 *****'
 24043             DISPLAY '******************************'
 24044             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24045             GO TO ABEND-PGM.
 24046
 24047     MOVE 'C'                         TO CP-IO-FUNCTION.
 24048     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 24049     IF IO-ERROR
 24050         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 24051                                      TO WS-ABEND-MESSAGE
 24052         MOVE 0302                    TO WS-RETURN-CODE
 24053         DISPLAY '******************************'
 24054         DISPLAY '***** ERROR LOCATION 030 *****'
 24055         DISPLAY '******************************'
 24056         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24057         GO TO ABEND-PGM.
 24058
 24059     IF ME-DO-UPDATE
 24060           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 463
* ECS010.cbl
 24061           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 24062           ACCEPT WS-TIME-OF-DAY   FROM TIME
 24063           MOVE WS-TIME              TO ME-010-END
 24064           ADD 1 TO ME-010-RUN-CT
 24065           REWRITE MONTH-END-BALANCES
 24066           DISPLAY 'MONTH-END BALANCES POSTED'
 24067           CLOSE ERMEBL-INOUT
 24068     ELSE
 24069         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 24070
 24071     GO TO 9999-END-THE-JOB.
 24072
 24073 CERT-DATE-LOAD.
*24074     COPY ELCCRTM1.
 24075******************************************************************04/15/98
 24076*                                                                *ELCCRTM1
 24077*                                                                *ELCCRTM1
 24078*                            ELCCRTM1                            *   LV003
 24079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24080*                            VMOD=2.001                          *ELCCRTM1
 24081*                                                                *ELCCRTM1
 24082*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 24083*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 24084*                                                                *ELCCRTM1
 24085******************************************************************ELCCRTM1
 24086     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 24087     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 24088     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 24089     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 24090     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 24091     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 24092     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24093     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24094     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24095                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24096     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24097                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24098     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24099     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24100     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24101     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24102     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24103     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24104           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24105                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24106     END-PERFORM.                                                 ELCCRTM1
 24107                                                                  ELCCRTM1
 24108
 24109 EXTRACT-DATE-LOAD.
*24110     COPY ELCEXTM1.
 24111******************************************************************04/15/98
 24112*                                                                *ELCEXTM1
 24113*                                                                *ELCEXTM1
 24114*                            ELCEXTM1                            *   LV010
 24115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24116*                            VMOD=2.001                          *ELCEXTM1
 24117*                                                                *ELCEXTM1
 24118*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 464
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24119*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24120*                                                                *ELCEXTM1
 24121******************************************************************ELCEXTM1
 24122                                                                  ELCEXTM1
 24123     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24124     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24125     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24126     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24127     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24128     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24129                                                                     CL**9
 24130     EVALUATE TRUE                                                   CL**5
 24131        WHEN DE-ISSUE      OR                                        CL**8
 24132             DE-RC-ISSUE   OR                                        CL**8
 24133             DE-RR-RC-ISS  OR                                        CL**8
 24134             DE-CANCEL     OR                                        CL**8
 24135             DE-RC-CANCEL  OR                                        CL**8
 24136             DE-RR-RC-CNC                                            CL**8
 24137           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24138                                                                     CL**9
 24139        WHEN DE-CLAIM      OR                                        CL**8
 24140             DE-RR-RC-CLM                                            CL**6
 24141           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24142           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24143           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24144           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24145           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24146           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24147                                                                     CL**9
 24148        WHEN DE-RESERVE                                              CL**9
 24149           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24150           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24151           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24152                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24153           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24154                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24155           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24156     END-EVALUATE.                                                   CL**9
 24157                                                                     CL**9
 24158
 24159 EXTRACT-DATE-RELOAD.
*24160     COPY ELCEXTM2.
 24161******************************************************************04/15/98
 24162*                                                                *ELCEXTM2
 24163*                                                                *ELCEXTM2
 24164*                            ELCEXTM2                            *   LV011
 24165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24166*                            VMOD=2.001                          *ELCEXTM2
 24167*                                                                *ELCEXTM2
 24168*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24169*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24170*                                                                *   CL**9
 24171******************************************************************ELCEXTM2
 24172                                                                  ELCEXTM2
 24173     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24174     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24175     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24176     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 465
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24177     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24178     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24179                                                                     CL*10
 24180     EVALUATE TRUE                                                   CL*10
 24181        WHEN DE-ISSUE      OR                                        CL*10
 24182             DE-RC-ISSUE   OR                                        CL*10
 24183             DE-RR-RC-ISS  OR                                        CL*10
 24184             DE-CANCEL     OR                                        CL*10
 24185             DE-RC-CANCEL  OR                                        CL*10
 24186             DE-RR-RC-CNC                                            CL*10
 24187           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24188                                                                     CL*10
 24189        WHEN DE-CLAIM      OR                                        CL*10
 24190             DE-RR-RC-CLM                                            CL**7
 24191           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24192           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24193           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24194           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24195           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24196           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24197                                                                     CL*10
 24198        WHEN DE-RESERVE                                              CL**7
 24199            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24200            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24201            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24202                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24203            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24204                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24205            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24206     END-EVALUATE.                                                   CL**5
 24207                                                                  ELCEXTM2
 24208
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 466
* ECS010.cbl
 24210 ABEND-PGM.
 24211     DISPLAY '******************************'
 24212     DISPLAY '***** ABEND PGM **************'
 24213     DISPLAY '******************************'
*24214                             COPY ELCABEND.
 24215***************************************************************** 04/14/98
 24216*                                                               * ELCABEND
 24217*                            ELCABEND.                          *    LV003
 24218*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24219*                            VMOD 2.002                              CL**2
 24220*                                                               * ELCABEND
 24221*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24222*            AND THEN ABENDS.                                   * ELCABEND
 24223*                                                               * ELCABEND
 24224*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24225*                                                               * ELCABEND
 24226***************************************************************** ELCABEND
 24227*APS-010.                                                         ELCABEND
 24228     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24229     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24230                                                                  ELCABEND
 24231     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24232         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24233         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24234                                 UPON CONSOLE.                    ELCABEND
 24235                                                                  ELCABEND
 24236     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24237         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24238         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24239                                 UPON CONSOLE.                    ELCABEND
 24240                                                                  ELCABEND
 24241     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24242     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24243                                 UPON CONSOLE.                    ELCABEND
 24244                                                                  ELCABEND
 24245     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24246     CALL 'ABORTME'.
 24247                                                                  ELCABEND
 24248 APS-EXIT.                                                        ELCABEND
 24249     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 467
* ECS010.cbl
 24251 9999-END-THE-JOB.
 24252
 24253     DISPLAY ' '.
 24254     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24255         'ECS010 ******'
 24256     DISPLAY ' '.
 24257     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 468
* ECS010.cbl
 24258/
 24259 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24260     IF LCP-ASA = '+'
 24261         WRITE MISMATCH-RPT AFTER 0 LINE
 24262     ELSE
 24263     IF LCP-ASA = ' '
 24264         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24265     ELSE
 24266     IF LCP-ASA = '0'
 24267         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24268     ELSE
 24269     IF LCP-ASA = '-'
 24270         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24271     ELSE
 24272     IF LCP-ASA = '1'
 24273         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24274     ELSE
 24275     IF LCP-ASA = '2'
 24276         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24277     ELSE
 24278     IF LCP-ASA = '3'
 24279         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24280     ELSE
 24281     IF LCP-ASA = '4'
 24282         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24283     ELSE
 24284     IF LCP-ASA = '5'
 24285         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24286     ELSE
 24287     IF LCP-ASA = '6'
 24288         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24289     ELSE
 24290     IF LCP-ASA = '7'
 24291         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24292     ELSE
 24293     IF LCP-ASA = '8'
 24294         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24295     ELSE
 24296     IF LCP-ASA = '9'
 24297         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24298     ELSE
 24299     IF LCP-ASA = 'A'
 24300         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24301     ELSE
 24302     IF LCP-ASA = 'B'
 24303         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24304     ELSE
 24305     IF LCP-ASA = 'C'
 24306         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24307     ELSE
 24308     IF LCP-ASA = 'V'
 24309         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24310     ELSE
 24311     IF LCP-ASA = 'W'
 24312         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24313     ELSE
 24314     DISPLAY 'ASA CODE ERROR'.
 24315 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-14 09:42 Page 469
* ECS010.cbl
 24316     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  296
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     5860356     Code:      139059
