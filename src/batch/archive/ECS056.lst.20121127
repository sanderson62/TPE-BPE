* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS056.cbl
* Options: int("ECS056.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS056.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS056.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS056.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS056.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 02-Nov-12 23:16.
     6*REMARKS.
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS056.cbl
    16* 062304    2004061600004  PEMA  ADD PROCESSING FOR CANCELED
    18* 110304    2004110200007  PEMA  ADD NI AND NU TO LIST OF AH
    19*                                GIANT BEN CODES
    20*                                ADD MS TO LIFE
    21* 072005    2005071100001  PEMA  CREATE CREDIT ON REFUNDS
    22* 080305    2005080300010  PEMA  ADD SUM REM PMTS FORMULA
    23* 071906    2006012700002  PEMA  ADD MI AND MU TO CASH CERT
    24******************************************************************
    25 ENVIRONMENT DIVISION.
    26 INPUT-OUTPUT SECTION.
    27 FILE-CONTROL.
    28
    29     SELECT CERTS                ASSIGN TO SYS010.
    30     SELECT EXTRACT              ASSIGN TO SYS011
    31            ORGANIZATION IS LINE SEQUENTIAL.
    32     SELECT DEBUG-EXTRACT        ASSIGN TO SYS012
    33            ORGANIZATION IS LINE SEQUENTIAL.
    34     SELECT DISK-DATE            ASSIGN TO SYS019.
    35     SELECT PRINTX               ASSIGN TO SYS008.
    36     SELECT FICH                 ASSIGN TO SYS020.
    37
    38     SELECT ERPYAJ               ASSIGN TO ERPYAJ
    39            ORGANIZATION IS INDEXED
    40            ACCESS IS DYNAMIC
    41            RECORD KEY IS PY-CONTROL-PRIMARY
    42            FILE STATUS IS ERPYAJ-FILE-STATUS.
    43
    44     SELECT ERDUEP               ASSIGN TO ERDUEP
    45            ACCESS IS DYNAMIC
    46            ORGANIZATION IS INDEXED
    47            FILE STATUS IS ERDUEP-FILE-STATUS
    48            RECORD KEY IS DP-CONTROL-PRIMARY.
    49
    50 DATA DIVISION.
    51 FILE SECTION.
    52
    53
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS056.cbl
    55 FD  CERTS
*   56                                 COPY ECSCRIFD.
    57******************************************************************07/10/97
    58*                                                                *ECSCRIFD
    59*                            ECSCRIFD                            *   LV001
    60*                            VMOD 2.005                          *ECSCRIFD
    61*                                                                *ECSCRIFD
    62*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
    63*                                                                *ECSCRIFD
    64******************************************************************ECSCRIFD
    65     BLOCK CONTAINS 0 RECORDS
    66     RECORDING MODE F.                                            ECSCRIFD
    67                                                                  ECSCRIFD
    68 01  CERT-IN-RECORD.                                              ECSCRIFD
    69                                                                  ECSCRIFD
    70     12  FILLER                            PIC XXX.               ECSCRIFD
    71     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
    72     12  FILLER                            PIC X(66).             ECSCRIFD
    73     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
    74     12  FILLER                            PIC X(20).             ECSCRIFD
    75     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
    76     12  FILLER                            PIC X(14).             ECSCRIFD
    77     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
    78     12  FILLER                            PIC X(39).             ECSCRIFD
    79     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    80     12  FILLER                            PIC X(45).             ECSCRIFD
    81     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
    82     12  FILLER                            PIC X(35).             ECSCRIFD
    83     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    84     12  FILLER                            PIC X(41).             ECSCRIFD
    85     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
    86     12  FILLER                            PIC X(48).             ECSCRIFD
    87     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
    88     12  FILLER                            PIC X(9).              ECSCRIFD
    89     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
    90     12  FILLER                            PIC X(120).            ECSCRIFD
    91     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    92     12  FILLER                            PIC X(73).             ECSCRIFD
    93     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    94     12  FILLER                            PIC X(464).            ECSCRIFD
    95                                                                  ECSCRIFD
    96******************************************************************ECSCRIFD
*   97                                 COPY ECSCRT01.
    98******************************************************************
    99*                                                                *
   100*                            ECSCRT01                            *
   101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   102*                            VMOD=2.016                          *
   103*                                                                *
   104*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   105*                                                                *
   106*   FILE TYPE = SEQUENTIAL
   107*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   108*                                                                *
   109*   KEY DATA =                         START=4, LEN=36           *
   110*                                                                *
   111*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   112*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   113******************************************************************
   114******************************************************************
   115*                   C H A N G E   L O G
   116*
   117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   118*-----------------------------------------------------------------
   119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   120* EFFECTIVE    NUMBER
   121*-----------------------------------------------------------------
   122* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   123* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   124* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   125* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   126* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   127* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   128* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   129* 032612  CR2011110200001  PEMA  AHL CHANGES
   130******************************************************************
   131
   132 01  CERTIFICATE-RECORD.
   133     12  CR-RECORD-ID                      PIC XX.
   134         88  VALID-CR-ID                      VALUE 'CR'.
   135
   136     12  CR-COMPANY-CD                     PIC X.
   137
   138     12  CR-FULL-CONTROL.
   139         16  CR-CONTROL-1.
   140             20  CR-ACCT-CONTROL.
   141                 24  CR-CARRIER            PIC X.
   142                 24  CR-GROUPING.
   143                     28  CR-GROUP-PREFIX   PIC XXX.
   144                     28  CR-GROUP-PRIME    PIC XXX.
   145                 24  CR-STATE              PIC XX.
   146                 24  CR-ACCOUNT.
   147                     28  CR-ACCT-PREFIX    PIC X(4).
   148                     28  CR-ACCT-PRIME     PIC X(6).
   149             20  CR-DT                     PIC 9(11)  COMP-3.
   150         16  CR-CERT-NO.
   151             20  CR-CERT.
   152                 24  CR-CERT-PREFIX        PIC X(3).
   153                 24  CR-CERT-PRIME         PIC X(7).
   154             20  CR-CERT-SFX               PIC X.
   155
   156     12  CR-INSUREDS-PROFILE.
   157         16  CR-NAME.
   158             20  CR-LNAME                  PIC X(15).
   159             20  CR-FNAME.
   160                 24  CR-1ST-INITIAL        PIC X.
   161                 24  FILLER                PIC X(9).
   162             20  CR-INIT                   PIC X.
   163         16  CR-AGE                        PIC 99.
   164         16  CR-SEX                        PIC X.
   165             88  CR-SEX-MALE                  VALUE 'M'.
   166             88  CR-SEX-FEMALE                VALUE 'F'.
   167         16  CR-SOC-SEC                    PIC X(11).
   168         16  CR-JOINT-NAME.
   169             20  CR-JT-LNAME               PIC X(15).
   170             20  CR-JT-FNAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   171                 24  CR-JT-1ST-INIT        PIC X.
   172                 24  FILLER                PIC X(9).
   173             20  CR-JT-INIT                PIC X.
   174         16  CR-JOINT-AGE                  PIC 99.
   175
   176         16  cr-ahl-ah-claim-no            pic x(9).
   177         16  cr-ahl-ah-cert-seq            pic x(3).
   178         16  cr-hst-proc-lf                pic x.
   179         16  f                             pic x(7).
   180
   181     12  CR-LF-COVERAGE-DATA.
   182         16  CR-LFTYP                      PIC XX.
   183         16  CR-LF-TERM                    PIC S999       COMP-3.
   184         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   185         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   186         16  CR-LF-DEV-CODE                PIC XXX.
   187         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   188
   189         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   190         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   191         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   192         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   193
   194         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   195         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   196         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   197         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   198
   199         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   200         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   201
   202         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   203         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   204
   205         16  CR-LF-REFUND-TYPE             PIC X.
   206         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   207
   208         16  CR-LF-COMM-CHARGEBACK         PIC X.
   209             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   210
   211         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   212
   213         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   214         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   215         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   216
   217         16  cr-ahl-lf-claim-no            pic x(9).
   218         16  cr-ahl-lf-cert-seq            pic x(3).
   219         16  FILLER                        PIC XX.
   220
   221     12  CR-AH-COVERAGE-DATA.
   222         16  CR-AHTYP                      PIC XX.
   223         16  CR-AH-TERM                    PIC S999       COMP-3.
   224         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   225         16  CR-AH-DEV-CODE                PIC XXX.
   226         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   227
   228         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   229         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   230         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   231         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   232
   233         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   234         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   235
   236         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   237         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   238
   239         16  CR-AH-REFUND-TYPE             PIC X.
   240         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   241
   242         16  CR-AH-COMM-CHARGEBACK         PIC X.
   243             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   244
   245         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   246
   247         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   248         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   249         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   250
   251         16  FILLER                        PIC XX.
   252*        16  FILLER                        PIC X(8).
   253
   254     12  CR-LOAN-DATA.
   255         16  CR-LIVES                      PIC S9(7)      COMP-3.
   256         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   257                                           PIC S9(5)V99   COMP-3.
   258         16  CR-BILLED                     PIC S9(7)      COMP-3.
   259         16  CR-APR                        PIC S999V9(4)  COMP-3.
   260         16  CR-PMT-FREQ                   PIC 99.
   261         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   262         16  CR-RATING-CLASS               PIC XX.
   263         16  CR-POLICY-FORM-NO             PIC X(12).
   264         16  CR-GRPTYP                     PIC XX.
   265         16  CR-IND-GRP                    PIC X.
   266             88  CR-INDIVIDUAL                VALUE '1'.
   267             88  CR-GROUP                     VALUE '2'.
   268         16  CR-SKIP                       PIC 99.
   269             88  NO-MONTHS-SKIPPED            VALUE 00.
   270             88  SKIP-JULY                    VALUE 01.
   271             88  SKIP-AUGUST                  VALUE 02.
   272             88  SKIP-SEPTEMBER               VALUE 03.
   273             88  SKIP-JULY-AUG                VALUE 04.
   274             88  SKIP-AUG-SEPT                VALUE 05.
   275             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   276             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   277             88  SKIP-JUNE                    VALUE 08.
   278             88  SKIP-JUNE-JULY               VALUE 09.
   279             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   280             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   281         16  CR-RESIDENT-STATE             PIC XX.
   282         16  CR-RATE-CODE.
   283             20  CR-LF-CLASS-CD            PIC XX.
   284             20  CR-AH-CLASS-CD            PIC XX.
   285         16  CR-MORT.
   286             20  CR-TAB                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   287             20  CR-INT                    PIC 99.
   288             20  CR-GRP                    PIC X.
   289         16  CR-MEMBER-NO                  PIC X(12).
   290         16  CR-OLD-LOF                    PIC XXX.
   291*        16  CR-LOAN-OFFICER               PIC XXX.
   292         16  CR-REIN-TABLE                 PIC XXX.
   293         16  CR-REIN-SPEC                  PIC X.
   294         16  CR-LOAN-1ST-PMT-DT.
   295             20  CR-1ST-PMT-YR             PIC 99.
   296             20  CR-1ST-PMT-MO             PIC 99.
   297             20  CR-1ST-PMT-DA             PIC 99.
   298         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   299         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   300         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   301         16  CR-LAST-ADD-ON-DT             PIC XX.
   302
   303         16  CR-UNDERWRITING-CODE          PIC X.
   304             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   305
   306         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   307         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   308         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   309         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   310
   311     12  CR-STATUS-INFORMATION.
   312         16  CR-ENTRY-STATUS               PIC X.
   313             88  CR-NORMAL-ENTRY              VALUE '1'.
   314             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   315             88  CR-CONVERSION-ENTRY          VALUE '4'.
   316             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   317             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   318             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   319             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   320             88  CR-POLICY-IS-VOID            VALUE 'V'.
   321             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   322             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   323                                                    '5' '9' 'P'.
   324         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   325
   326         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   327         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   328         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   329
   330         16  CR-LF-STATUS-AT-DEATH         PIC X.
   331         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   332
   333         16  CR-LF-CURRENT-STATUS          PIC X.
   334             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   335             88  CR-LF-POLICY-PENDING         VALUE '2'.
   336             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   337             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   338             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   339             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   340             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   341             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   342             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   343             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   344             88  CR-LF-IS-DECLINED            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   345             88  CR-LF-IS-VOID                VALUE 'V'.
   346             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   347                                                    '4' '5' '9'.
   348
   349         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   350
   351         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   352         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   353
   354         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   355         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   356
   357         16  CR-AH-CURRENT-STATUS          PIC X.
   358             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   359             88  CR-AH-POLICY-PENDING         VALUE '2'.
   360             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   361             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   362             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   363             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   364             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   365             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   366             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   367             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   368             88  CR-AH-IS-DECLINED            VALUE 'D'.
   369             88  CR-AH-IS-VOID                VALUE 'V'.
   370             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   371                                                    '4' '5' '9'.
   372         16  CR-LOAN-OFFICER               PIC X(5).
   373         16  CR-CANCEL-REASON              PIC X.
   374         16  cr-xycor-lf-cov-code          pic x(4).
   375         16  cr-xycor-ah-cov-code          pic x(4).
   376         16  FILLER                        PIC X(6).
   377
   378     12  CR-DEATH-CLAIM-DATA.
   379         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   380
   381         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   382         16  CR-DTH-RPT-DT.
   383             20  CR-DTH-RPT-YR             PIC 99.
   384             20  CR-DTH-RPT-MO             PIC 99.
   385             20  CR-DTH-RPT-DA             PIC 99.
   386         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   387
   388         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   389         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   390         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   391         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   392         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   393
   394         16  CR-DTH-AGE                    PIC 99.
   395         16  CR-DTH-PAY-CD                 PIC X.
   396         16  CR-DEATH-CAUSE                PIC X(6).
   397
   398         16  FILLER                        PIC X(16).
   399
   400     12  CR-DISAB-CLAIM-DATA.
   401         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   402
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   403         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   404         16  CR-DIS-RPT-DT.
   405             20  CR-DIS-RPT-YR             PIC 99.
   406             20  CR-DIS-RPT-MO             PIC 99.
   407             20  CR-DIS-RPT-DA             PIC 99.
   408         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   409         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   410
   411         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   412         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   413         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   414         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   415         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   416
   417         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   418         16  CR-DIS-PAY-CD                 PIC X.
   419         16  FILLER                        PIC XX.
   420
   421         16  CR-DISAB-INCURRED-DETAIL.
   422             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   423**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   424                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   425                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   426                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   427
   428         16  CR-DISAB-CAUSE                PIC X(6).
   429         16  FILLER                        PIC X(14).
   430
   431     12  CR-REMIT-TO                       PIC 99.
   432
   433     12  CR-COMPENSATION-LEVELS.
   434         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   435             20  CR-COM-AGT.
   436                 24  CR-COM-AGT-PREFIX     PIC X(4).
   437                 24  CR-COM-AGT-PRIME      PIC X(6).
   438             20  CR-AGT-TYPE               PIC X.
   439             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   440             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   441
   442     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   443     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   444     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   445     12  CR-CLP-STATE                      PIC XX.
   446     12  CR-POST-CARD-IND                  PIC X.
   447     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   448     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   449     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   450     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   451     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   452     12  FILLER                            PIC X(07).
   453
   454     12  CR-CSR-CODE                       PIC XXX.
   455
   456     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   457     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   458
   459     12  CR-MICROFILM-NUMBERS.
   460*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   461         16  FILLER                        PIC X(5).
   462     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   463
   464     12  CR-USER-CODE                      PIC X.
   465     12  CR-USER-FUTURE                    PIC X(9).
   466
   467     12  CR-BENEFICIARY.
   468         16  CR-BANK-NO                    PIC X(10).
   469         16  FILLER                        PIC X(15).
   470
   471     12  CR-ENTRY-BATCH                    PIC X(6).
   472     12  CR-LF-EXIT-BATCH                  PIC X(6).
   473     12  CR-AH-EXIT-BATCH                  PIC X(6).
   474
   475     12  CR-NOTE-SW                        PIC X.
   476
   477     12  CR-ORIGIN-INDICATOR               PIC X.
   478         88  CR-ENTERED-MANUALLY              VALUE '1'.
   479         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   480
   481     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   482     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   483     12  FILLER                            PIC X(33).
   484
   485******************************************************************
   486
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS056.cbl
   488 FD  EXTRACT
   489     BLOCK CONTAINS 0 RECORDS
   490     RECORDING MODE IS F.
   491
   492*         236 BYTES
   493 01  EXTRACT-RECORD.
   494     05  EXT-CAR                 PIC X.
   495     05  WS-TAB1                 PIC X.
   496     05  EXT-GROUP               PIC X(6).
   497     05  WS-TAB2                 PIC X.
   498     05  EXT-STATE               PIC XX.
   499     05  WS-TAB3                 PIC X.
   500     05  EXT-ACCOUNT             PIC X(10).
   501     05  WS-TAB4                 PIC X.
   502     05  EXT-EFF-DATE            PIC X(10).
   503     05  WS-TAB5                 PIC X.
   504     05  EXT-ENT-DATE            PIC X(10).
   505     05  WS-TAB6                 PIC X.
   506     05  EXT-VAL-DATE            PIC X(10).
   507     05  WS-TAB7                 PIC X.
   508     05  EXT-EARN-TERM           PIC 999.
   509     05  WS-TAB8                 PIC X.
   510     05  EXT-CERT-NO             PIC X(11).
   511     05  WS-TAB9                 PIC X.
   512     05  EXT-LF-BEN-CODE         PIC XX.
   513     05  WS-TAB10                PIC X.
   514     05  EXT-AH-BEN-CODE         PIC XX.
   515     05  WS-TAB11                PIC X.
   516     05  EXT-LF-TERM             PIC 999.
   517     05  WS-TAB12                PIC X.
   518     05  EXT-AH-TERM             PIC 999.
   519     05  WS-TAB13                PIC X.
   520     05  EXT-LF-EXP-DATE         PIC X(10).
   521     05  WS-TAB14                PIC X.
   522     05  EXT-AH-EXP-DATE         PIC X(10).
   523     05  WS-TAB15                PIC X.
   524     05  EXT-EXP-PREM            PIC -ZZ,ZZZ,ZZ9.99.
   525     05  WS-TAB16                PIC X.
   526     05  EXT-REC-PREM            PIC -ZZ,ZZZ,ZZ9.99.
   527     05  WS-TAB17                PIC X.
   528     05  EXT-BASE-COMM           PIC -ZZZ,ZZ9.99.
   529     05  WS-TAB18                PIC X.
   530     05  EXT-GA-COMM             PIC -ZZZ,ZZ9.99.
   531     05  WS-TAB19                PIC X.
   532     05  EXT-MISC1               PIC ZZZ,ZZZ,ZZ9.99.
   533     05  WS-TAB20                PIC X.
   534     05  EXT-MISC2               PIC ZZZ,ZZZ,ZZ9.99.
   535     05  WS-TAB21                PIC X.
   536     05  EXT-MISC3               PIC ZZZ,ZZZ,ZZ9.99.
   537     05  WS-TAB22                PIC X.
   538     05  EXT-MISC4               PIC ZZZ,ZZZ,ZZ9.99.
   539     05  WS-TAB23                PIC X.
   540     05  EXT-MISC5               PIC ZZZ,ZZZ,ZZ9.99.
   541
   542
   543 FD  DEBUG-EXTRACT
   544     BLOCK CONTAINS 0 RECORDS
   545     RECORDING MODE IS F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS056.cbl
   546
   547*         236 BYTES
   548 01  DEBUG-EXTRACT-RECORD.
   549     05  DB-ACCOUNT              PIC X(10).
   550     05  DB-TAB1                 PIC X.
   551     05  DB-CERT-NO              PIC X(11).
   552     05  DB-TAB2                 PIC X.
   553     05  DB-EFF-DATE             PIC X(10).
   554     05  DB-TAB3                 PIC X.
   555     05  DB-ENT-DATE             PIC X(10).
   556     05  DB-TAB4                 PIC X.
   557     05  DB-VAL-DATE             PIC X(10).
   558     05  DB-TAB5                 PIC X.
   559     05  DB-PERIOD               PIC 999.
   560     05  DB-TAB6                 PIC X.
   561     05  DB-PAYMENT              PIC -ZZ,ZZZ,ZZ9.99.
   562     05  DB-TAB7                 PIC X.
   563     05  DB-PRINC                PIC -ZZZ,ZZ9.99.
   564     05  DB-TAB8                 PIC X.
   565     05  DB-INTEREST             PIC -Z,ZZ9.99.
   566     05  DB-TAB9                 PIC X.
   567     05  DB-LINS                 PIC -Z,ZZ9.99.
   568     05  DB-TAB10                PIC X.
   569     05  DB-DINS                 PIC -Z,ZZ9.99.
   570     05  DB-TAB11                PIC X.
   571     05  DB-BALANCE              PIC -ZZ,ZZZ,ZZ9.99.
   572     05  DB-TAB12                PIC X.
   573     05  DB-LF-BEN-CODE          PIC XX.
   574     05  DB-TAB13                PIC X.
   575     05  DB-AH-BEN-CODE          PIC XX.
   576     05  DB-TAB14                PIC X.
   577     05  DB-LF-TERM              PIC 999.
   578     05  DB-TAB15                PIC X.
   579     05  DB-AH-TERM              PIC 999.
   580     05  DB-TAB16                PIC X.
   581     05  DB-LF-EXP-DATE          PIC X(10).
   582     05  DB-TAB17                PIC X.
   583     05  DB-AH-EXP-DATE          PIC X(10).
   584
   585 FD  DISK-DATE
*  586                                 COPY ELCDTEFD.
   587******************************************************************04/15/98
   588*                                                                *ELCDTEFD
   589*                                                                *ELCDTEFD
   590*                            ELCDTEFD.                           *   LV002
   591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   592*                            VMOD=2.007                          *   CL**2
   593*                                                                *ELCDTEFD
   594******************************************************************ELCDTEFD
   595     BLOCK CONTAINS 0 RECORDS
   596     RECORDING MODE F.                                            ELCDTEFD
   597                                                                  ELCDTEFD
   598 01  DATE-DISK.                                                   ELCDTEFD
   599     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   600     12  FILLER                      PIC  X(14).                  ELCDTEFD
   601     12  DD-CR1                      PIC  9.                      ELCDTEFD
   602     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   603     12  DD-CR2                      PIC  9.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   604     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   605     12  FILLER                      PIC  X(20).                  ELCDTEFD
   606                                                                  ELCDTEFD
   607 01  DATE-DISK-R.                                                 ELCDTEFD
   608     12  FILLER                      PIC  X(4).                   ELCDTEFD
   609     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   610                                     PIC  X(32).                  ELCDTEFD
   611                                                                  ELCDTEFD
   612 01  DATE-DISK-T.                                                 ELCDTEFD
   613     12  FILLER                      PIC  X(4).                   ELCDTEFD
   614     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   615                                     PIC  X(48).                  ELCDTEFD
   616                                                                  ELCDTEFD
   617 01  DATE-DISK-M.                                                 ELCDTEFD
   618     12  FILLER                      PIC  X(4).                   ELCDTEFD
   619     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   620                                     PIC  X(48).                  ELCDTEFD
   621                                                                  ELCDTEFD
   622 01  DATE-DISK-P.                                                 ELCDTEFD
   623     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   624     12  DD-IDX                      PIC  99.                     ELCDTEFD
   625     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   626     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   627         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   628                                     PIC  X.                      ELCDTEFD
   629         16  FILLER                  PIC  X(46).                  ELCDTEFD
   630     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   631         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   632             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   633             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   634             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   635             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   636         16  FILLER                  PIC  X(16).                  ELCDTEFD
   637                                                                  ELCDTEFD
   638 01  DATE-DISK-E.                                                 ELCDTEFD
   639     12  FILLER                      PIC  X(4).                   ELCDTEFD
   640     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   641                                     PIC  X(4).                   ELCDTEFD
   642                                                                  ELCDTEFD
   643 01  DATE-DISK-C.                                                 ELCDTEFD
   644     12  FILLER                      PIC  X(7).                   ELCDTEFD
   645     12  DD-CARR1-SECPAY-SW          PIC  X.
   646     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   647     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   648     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   649     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   650     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   651     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   652     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   653     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   654     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   655     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   656     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   657     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   658     12  DD-CARR2-SECPAY-SW          PIC  X.
   659     12  FILLER                      PIC  X(7).                   ELCDTEFD
   660                                                                  ELCDTEFD
   661 01  DATE-DISK-OPT.                                               ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   662     12  FILLER                      PIC  X(04).                  ELCDTEFD
   663     12  DD-TLR-DATA.                                             ELCDTEFD
   664         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   665                                     PIC  X(03).                  ELCDTEFD
   666     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   667         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   668                                     PIC  X(06).                  ELCDTEFD
   669     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   670         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   671                                     PIC  X(07).                  ELCDTEFD
   672         16  FILLER                  PIC  X(05).                  ELCDTEFD
   673     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   674                                     PIC  X(96).                  ELCDTEFD
   675******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS056.cbl
   677 FD  PRINTX
*  678                                 COPY ELCPRTFD.
   679******************************************************************04/15/98
   680*                                                                *ELCPRTFD
   681*                                                                *ELCPRTFD
   682*                            ELCPRTFD.                           *   LV003
   683*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   684*                            VMOD=2.006                          *ELCPRTFD
   685******************************************************************ELCPRTFD
   686     RECORDING MODE F                                             ELCPRTFD
   687     LABEL RECORDS OMITTED                                        ELCPRTFD
   688     BLOCK CONTAINS 0 RECORDS
   689     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   690 01  PRT.                                                         ELCPRTFD
   691     12  P-CTL               PIC  X.                                 CL**2
   692     12  P-DATA              PIC  X(132).                         ELCPRTFD
   693******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS056.cbl
   695 FD  FICH
*  696                                 COPY ELCFCHFD.
   697******************************************************************04/15/98
   698*                                                                *ELCFCHFD
   699*                            ELCFCHFD.                           *   LV003
   700*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   701*                            VMOD=2.004                          *   CL**3
   702*                                                                *ELCFCHFD
   703******************************************************************ELCFCHFD
   704     BLOCK CONTAINS 0 RECORDS
   705     RECORDING MODE F.                                            ELCFCHFD
   706                                                                  ELCFCHFD
   707 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   708******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS056.cbl
   710 FD  ERDUEP.
*  711                                 COPY ERCDUEP.
   712******************************************************************
   713*                                                                *
   714*                                                                *
   715*                            ERCDUEP                             *
   716*                            VMOD=2.001                          *
   717*                                                                *
   718*   ONLINE CREDIT SYSTEM                                         *
   719*                                                                *
   720*   FILE DESCRIPTION = DUE PREMIUM MASTER                        *
   721*                                                                *
   722*   FILE TYPE = VSAM,KSDS                                        *
   723*   RECORD SIZE = 512   RECFORM = FIXED                          *
   724*                                                                *
   725*   BASE CLUSTER NAME = ERDUEP                   RKP=2,LEN=26    *
   726*       ALTERNATE PATH = NONE                                    *
   727*                                                                *
   728*   LOG = NO                                                     *
   729*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   730*                                                                *
   731******************************************************************
   732
   733 01  DUE-PREMIUM-RECORD.
   734     12  DP-RECORD-ID                          PIC XX.
   735         88  VALID-DP-ID                          VALUE 'DP'.
   736
   737     12  DP-CONTROL-PRIMARY.
   738         16  DP-COMPANY-CD                     PIC X.
   739         16  DP-CONTROL.
   740             20  DP-ACCOUNT-CONTROL.
   741                 24  DP-CARRIER                PIC X.
   742                 24  DP-GROUPING               PIC X(6).
   743                 24  DP-STATE                  PIC XX.
   744                 24  DP-ACCOUNT                PIC X(10).
   745             20  DP-KEY-FILLER                 PIC X(6).
   746
   747     12  DP-MAINT-INFORMATION.
   748         16  DP-LAST-MONTH-END-DT              PIC XX.
   749         16  DP-LAST-MAINT-DT                  PIC XX.
   750         16  DP-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   751         16  DP-LAST-MAINT-USER                PIC X(4).
   752         16  FILLER                            PIC X(10).
   753
   754     12  DP-FUTURE-SPACE                       PIC X(5).
   755         88  DP-FUTURE-NOT-USED                   VALUE '     '.
   756
   757     12  DP-LAST-EOM-STMT-DT                   PIC XX.
   758
   759     12  DP-LAST-ACTIVITY-DATE.
   760         16  DP-ACT-YEAR                       PIC 99.
   761         16  DP-ACT-MONTH                      PIC 99.
   762         16  DP-ACT-DAY                        PIC 99.
   763
   764     12  DP-MO-END-TOTALS.
   765         16  DP-MONTHLY-TOTALS.
   766             20  DP-BAL-FWD                PIC S9(7)V99   COMP-3.
   767             20  DP-EXP-PREM               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS056.cbl (/apps/prod/cid1p/copy/ERCDUEP)
   768             20  DP-REC-PREM               PIC S9(7)V99   COMP-3.
   769             20  DP-ADJUSTMENTS            PIC S9(7)V99   COMP-3.
   770             20  DP-BASE-COMM              PIC S9(7)V99   COMP-3.
   771             20  DP-GA-COMM                PIC S9(7)V99   COMP-3.
   772             20  DP-END-BAL                PIC S9(7)V99   COMP-3.
   773
   774         16  DP-AGING-TOTALS.
   775             20  DP-CUR                    PIC S9(7)V99   COMP-3.
   776             20  DP-OV30                   PIC S9(7)V99   COMP-3.
   777             20  DP-OV60                   PIC S9(7)V99   COMP-3.
   778             20  DP-OV90                   PIC S9(7)V99   COMP-3.
   779
   780     12  FILLER                                PIC X(394).
   781
   782******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS056.cbl
   784 FD  ERPYAJ.
   785
*  786                                 COPY ERCPYAJ.
   787******************************************************************04/29/98
   788*                                                                *ERCPYAJ
   789*                            ERCPYAJ                             *   LV003
   790*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   791*                            VMOD=2.015                          *   CL**2
   792*                                                                *ERCPYAJ
   793*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *ERCPYAJ
   794*                                                                *ERCPYAJ
   795*                                                                *ERCPYAJ
   796*   FILE TYPE = VSAM,KSDS                                        *ERCPYAJ
   797*   RECORD SIZE = 200  RECFORM = FIXED                           *ERCPYAJ
   798*                                                                *ERCPYAJ
   799*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *ERCPYAJ
   800*       ALTERNATE PATHS = NONE                                   *ERCPYAJ
   801*                                                                *ERCPYAJ
   802*   LOG = YES                                                    *ERCPYAJ
   803*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPYAJ
   804******************************************************************ERCPYAJ
   805******************************************************************
   806*                   C H A N G E   L O G
   807*
   808* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   809*-----------------------------------------------------------------
   810*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   811* EFFECTIVE    NUMBER
   812*-----------------------------------------------------------------
   813* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
   814* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
   815******************************************************************
   816                                                                  ERCPYAJ
   817 01  PENDING-PAY-ADJ.                                             ERCPYAJ
   818     12  PY-RECORD-ID                     PIC XX.                 ERCPYAJ
   819         88  VALID-PY-ID                        VALUE 'PY'.       ERCPYAJ
   820                                                                  ERCPYAJ
   821     12  PY-CONTROL-PRIMARY.                                      ERCPYAJ
   822         16  PY-COMPANY-CD                PIC X.                  ERCPYAJ
   823         16  PY-CARRIER                   PIC X.                  ERCPYAJ
   824         16  PY-GROUPING                  PIC X(6).               ERCPYAJ
   825         16  PY-FIN-RESP                  PIC X(10).              ERCPYAJ
   826         16  PY-ACCOUNT                   PIC X(10).              ERCPYAJ
   827         16  PY-PRODUCER REDEFINES PY-ACCOUNT                     ERCPYAJ
   828                                          PIC X(10).              ERCPYAJ
   829         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCPYAJ
   830         16  PY-RECORD-TYPE               PIC X.                  ERCPYAJ
   831             88  PY-REMIT-RECEIVED            VALUE 'R'.          ERCPYAJ
   832             88  PY-DEPOSIT                   VALUE 'D'.          ERCPYAJ
   833             88  PY-CHARGE-TO-AGENT           VALUE 'C'.          ERCPYAJ
   834             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.          ERCPYAJ
   835             88  PY-ADJ-DEPOSIT               VALUE 'T'.          ERCPYAJ
   836             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.          ERCPYAJ
   837             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.          ERCPYAJ
   838             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.          ERCPYAJ
   839             88  PY-ADD-TO-BALANCE            VALUE 'Z'.          ERCPYAJ
   840             88  PY-FICA-ENTRY                VALUE 'F'.          ERCPYAJ
   841             88  PY-REMIT-IND-GROUPING        VALUE 'G'.          ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS056.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   842             88  PY-POLICY-FEE                VALUE 'W'.          ERCPYAJ
   843             88  PY-DUE-PREM-ADJ              VALUE 'P'.
   844                                                                  ERCPYAJ
   845     12  PY-PYMT-TYPE                     PIC X.                  ERCPYAJ
   846             88  PY-NEW-BUS-PYMT              VALUE 'B'.          ERCPYAJ
   847             88  PY-REINS-PYMT                VALUE 'R'.          ERCPYAJ
   848             88  PY-EXP-PYMT                  VALUE 'E'.          ERCPYAJ
   849                                                                  ERCPYAJ
   850     12  PY-BIL-INV                       PIC X(6).               ERCPYAJ
   851     12  PY-REF-NO                        PIC X(12).              ERCPYAJ
   852                                                                  ERCPYAJ
   853     12  PY-LAST-MAINT-DT                 PIC XX.                 ERCPYAJ
   854     12  PY-LAST-MAINT-BY                 PIC X(4).               ERCPYAJ
   855     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPYAJ
   856                                                                  ERCPYAJ
   857     12  PY-PYADJ-RECORD.                                         ERCPYAJ
   858         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.   ERCPYAJ
   859         16  PY-ENTRY-COMMENT             PIC X(30).              ERCPYAJ
   860         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.               000
   861             20  PY-GL-ACCOUNT            PIC X(10).                   000
   862             20  PY-GL-STATE              PIC X(02).                   000
   863             20  PY-GL-CANC-SW            PIC X(01).                   000
   864                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.                   000
   865                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.                   000
   866             20  PY-GL-COMMENT            PIC X(10).                   000
   867             20  FILLER      REDEFINES PY-GL-COMMENT.                  000
   868                 24  PY-GL-CHECK-NO       PIC 9(06).                   000
   869                 24  FILLER               PIC X(04).                   000
   870             20  FILLER                   PIC X(07).                   ERC
   871         16  PY-SAVE-ACCOUNT              PIC X(10).              ERCPYAJ
   872         16  PY-SAVE-TYPE                 PIC X(01).              ERCPYAJ
   873                                                                  ERCPYAJ
   874         16  PY-LETTERS.                                          ERCPYAJ
   875             20  PY-LETTER OCCURS 3 TIMES                         ERCPYAJ
   876                           INDEXED BY PY-LET-NDX                  ERCPYAJ
   877                                          PIC X(04).              ERCPYAJ
   878                                                                  ERCPYAJ
   879         16  PY-ERCOMP-TYPE               PIC X.
   880             88  PY-ACCOUNT-TYPE              VALUE 'A'.
   881             88  PY-GA-TYPE                   VALUE 'G'.
   882             88  PY-BANK-TYPE                 VALUE 'B'.
   883         16  FILLER                       PIC X(05).
   884                                                                  ERCPYAJ
   885     12  PY-RECORD-STATUS.                                        ERCPYAJ
   886         16  PY-CREDIT-SELECT-DT          PIC XX.                 ERCPYAJ
   887         16  PY-CREDIT-ACCEPT-DT          PIC XX.                 ERCPYAJ
   888         16  PY-BILLED-DATE               PIC XX.                 ERCPYAJ
   889         16  PY-REPORTED-DT               PIC XX.                 ERCPYAJ
   890         16  PY-PMT-APPLIED               PIC X.                  ERCPYAJ
   891             88  PY-ACCOUNT-PMT               VALUE 'A'.          ERCPYAJ
   892             88  PY-GA-PMT                    VALUE 'G'.          ERCPYAJ
   893             88  PY-OVWRITE-PMT               VALUE 'O'.          ERCPYAJ
   894             88  PY-NON-AR-PMT                VALUE 'N'.          ERCPYAJ
   895         16  FILLER                       PIC X(5).               ERCPYAJ
   896         16  PY-INPUT-DT                  PIC XX.                 ERCPYAJ
   897         16  PY-CHECK-NUMBER              PIC X(6).               ERCPYAJ
   898         16  PY-VOID-SW                   PIC X.                  ERCPYAJ
   899             88  PY-CHECK-VOIDED              VALUE 'V'.          ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS056.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   900         16  PY-CHECK-ORIGIN-SW           PIC X.                  ERCPYAJ
   901             88  PY-BILLING-CHECK             VALUE 'B'.          ERCPYAJ
   902             88  PY-REFUND-CHECK              VALUE 'R'.          ERCPYAJ
   903             88  PY-GA-CHECK                  VALUE 'G'.          ERCPYAJ
   904             88  PY-CHECK-WRITTEN             VALUE 'W'.          ERCPYAJ
   905             88  PY-CHECK-REVERSAL            VALUE 'V'.          ERCPYAJ
   906         16  PY-CHECK-WRITTEN-DT          PIC XX.                 ERCPYAJ
   907         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.         ERCPYAJ
   908         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.         ERCPYAJ
   909         16  PY-BILL-FLAG                 PIC X.                  ERCPYAJ
   910             88  PY-BILLED                    VALUE 'B'.          ERCPYAJ
   911         16  PY-AR-FLAG                   PIC X.                  ERCPYAJ
   912             88  PY-AR-CYCLE                  VALUE 'C'.          ERCPYAJ
   913             88  PY-AR-MONTH-END              VALUE 'M'.          ERCPYAJ
   914         16  PY-AR-DATE                   PIC XX.                 ERCPYAJ
   915                                                                  ERCPYAJ
   916     12  PY-GL-CODES.                                             ERCPYAJ
   917         16  PY-GL-DB                     PIC X(14).              ERCPYAJ
   918         16  PY-GL-CR                     PIC X(14).              ERCPYAJ
   919         16  PY-GL-FLAG                   PIC X.                  ERCPYAJ
   920         16  PY-GL-DATE                   PIC XX.                 ERCPYAJ
   921                                                                  ERCPYAJ
   922     12  PY-CANCEL-FEE-FLAG               PIC X(2).               ERCPYAJ
   923     12  FILLER                           PIC X(3).               ERCPYAJ
   924******************************************************************ERCPYAJ
   925
   926
   927 WORKING-STORAGE SECTION.
   928 77  FILLER  PIC X(32) VALUE '********************************'.
   929 77  FILLER  PIC X(32) VALUE '      ECS056  WORKING STORAGE   '.
   930 77  FILLER  PIC X(32) VALUE '********************************'.
   931
   932 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   933     88  END-OF-FILE                VALUE 'Y'.
   934     88  MORE-RECORDS               VALUE 'N'.
   935 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   936 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   937 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   938 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   939 77  SPACE-NP                    PIC X      VALUE '1'.
   940 77  SPACE-1                     PIC X      VALUE ' '.
   941 77  SPACE-2                     PIC X      VALUE '0'.
   942 77  SPACE-3                     PIC X      VALUE '-'.
   943 77  X                           PIC X      VALUE ' '.
   944 77  LNCTR                       PIC S999   VALUE +60 COMP-3.
   945 77  PGCTR                       PIC S9(5)  VALUE +0 COMP-3.
   946
   947 01  HD1.
   948     12  FILLER              PIC  X(44)      VALUE SPACES.
   949     12  FILLER              PIC  X(44)      VALUE
   950             '        DUE PREMIUM AND COMMISSION         '.
   951     12  FILLER              PIC  X(31)      VALUE SPACES.
   952     12  FILLER              PIC  X(08)      VALUE 'ECS056'.
   953
   954 01  HD2.
   955     12  FILLER              PIC  X(51)      VALUE SPACES.
   956     12  HD-CO               PIC  X(30).
   957     12  FILLER              PIC  X(38)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS056.cbl
   958     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   959
   960 01  HD3.
   961     12  FILLER              PIC  X(57)      VALUE SPACES.
   962     12  HD-DT               PIC  X(18).
   963     12  FILLER              PIC  X(44)      VALUE SPACES.
   964     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   965     12  HD-PG               PIC ZZ,ZZ9.
   966
   967 01  HD4.
   968     12  FILLER              PIC  X(44)      VALUE
   969             '-- ACCOUNT TOTALS  --      BEGINNING   EXPEC'.
   970     12  FILLER              PIC  X(44)      VALUE
   971             'TED   RECEIVED              ENDING          '.
   972     12  FILLER              PIC  X(44)      VALUE
   973             '                    DUE      NO OF          '.
   974
   975 01  HD5.
   976     12  FILLER              PIC  X(44)      VALUE
   977             '--CAR GROUP  ST  ACCOUNT--- BALANCE    PREMI'.
   978     12  FILLER              PIC  X(44)      VALUE
   979             'UMS   PREMIUMS  ADJUSTMENTS BALANCE      < 9'.
   980     12  FILLER              PIC  X(44)      VALUE
   981             '0        > 90   COMMISSION   MONTHS         '.
   982 01  DETAIL-LINE.
   983     05  FILLER                  PIC X(4).
   984     05  DTL1-CAR                PIC X.
   985     05  FILLER                  PIC X.
   986     05  DTL1-GRP                PIC X(6).
   987     05  FILLER                  PIC X.
   988     05  DTL1-ST                 PIC XX.
   989     05  FILLER                  PIC X.
   990     05  DTL1-ACCT               PIC X(10).
   991     05  FILLER                  PIC X.
   992     05  DTL1-BEG-BAL            PIC ZZZ,ZZ9.99.
   993     05  FILLER                  PIC X.
   994     05  DTL1-EXP-PREM           PIC ZZZ,ZZ9.99.
   995     05  FILLER                  PIC X.
   996     05  DTL1-REC-PREM           PIC ZZZ,ZZ9.99.
   997     05  FILLER                  PIC X.
   998     05  DTL1-ADJS               PIC ZZZ,ZZ9.99.
   999     05  FILLER                  PIC X.
  1000     05  DTL1-END-BAL            PIC ZZZ,ZZ9.99.
  1001     05  FILLER                  PIC X.
  1002     05  DTL1-DUE-LT90           PIC ZZZ,ZZ9.99.
  1003     05  FILLER                  PIC X.
  1004     05  DTL1-DUE-GT90           PIC ZZZ,ZZ9.99.
  1005     05  FILLER                  PIC X.
  1006     05  DTL1-COMM               PIC ZZZ,ZZ9.99.
  1007     05  FILLER                  PIC X(4).
  1008     05  DTL1-NO-MOS             PIC ZZ9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS056.cbl
  1010 01  WS-DUE-PREM-ADJ-TABLE.
  1011     05  WS-DUEP-ADJ OCCURS 500.
  1012         10  WS-DA-KEY           PIC X(33).
  1013         10  WS-DA-AMOUNT        PIC S9(7)V99 COMP-3.
  1014
  1015 01  WS-DUE-PREM-TABLE.
  1016     05  WS-RECORD.
  1017         10  WS-CAR              PIC X.
  1018         10  WS-GROUP            PIC X(6).
  1019         10  WS-STATE            PIC XX.
  1020         10  WS-ACCOUNT          PIC X(10).
  1021         10  WS-EFF-DATE         PIC X(10).
  1022         10  WS-CERT-NO          PIC X(11).
  1023         10  WS-LF-BEN-CODE      PIC XX.
  1024         10  WS-AH-BEN-CODE      PIC XX.
  1025         10  WS-LF-TERM          PIC ZZ9.
  1026         10  WS-AH-TERM          PIC ZZ9.
  1027         10  WS-LF-EXP-DATE      PIC X(10).
  1028         10  WS-AH-EXP-DATE      PIC X(10).
  1029         10  WS-LF-EXP-PREM      PIC S9(9)V99 COMP-3 VALUE +0.
  1030         10  WS-AH-EXP-PREM      PIC S9(9)V99 COMP-3 VALUE +0.
  1031         10  WS-EXP-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
  1032         10  WS-REC-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
  1033         10  WS-LF-BASE-COMM     PIC S9(7)V99 COMP-3 VALUE +0.
  1034         10  WS-AH-BASE-COMM     PIC S9(7)V99 COMP-3 VALUE +0.
  1035         10  WS-BASE-COMM        PIC S9(7)V99 COMP-3 VALUE +0.
  1036         10  WS-REC-BASE-COMM    PIC S9(7)V99 COMP-3 VALUE +0.
  1037         10  WS-LF-GA-COMM       PIC S9(7)V99 COMP-3 VALUE +0.
  1038         10  WS-AH-GA-COMM       PIC S9(7)V99 COMP-3 VALUE +0.
  1039         10  WS-GA-COMM          PIC S9(7)V99 COMP-3 VALUE +0.
  1040         10  WS-MISC1            PIC S9(7)V99 COMP-3 VALUE +0.
  1041         10  WS-MISC2            PIC S9(7)V99 COMP-3 VALUE +0.
  1042         10  WS-MISC3            PIC S9(7)V99 COMP-3 VALUE +0.
  1043         10  WS-MISC4            PIC S9(7)V99 COMP-3 VALUE +0.
  1044         10  WS-MISC5            PIC S9(7)V99 COMP-3 VALUE +0.
  1045
  1046 01  WS-MISC.
  1047     05  WS-INIT-EXTRACT         PIC X(236) VALUE LOW-VALUES.
  1048     05  WS-INIT-DB-EXTRACT      PIC X(236) VALUE LOW-VALUES.
  1049     05  WS-PYAJ-MATCH-KEY       PIC X(28) VALUE LOW-VALUES.
  1050     05  WS-ERPYAJ-KEY.
  1051         10  WS-PY-COMPANY-CD    PIC X.
  1052         10  WS-PY-CARRIER       PIC X.
  1053         10  WS-PY-GROUPING      PIC X(6).
  1054         10  WS-PY-FIN-RESP      PIC X(10).
  1055         10  WS-PY-ACCOUNT       PIC X(10).
  1056     05  ERDUEP-FILE-STATUS      PIC XX.
  1057     05  ERPYAJ-FILE-STATUS      PIC XX.
  1058     05  WS-HOLD-PRT             PIC X(133).
  1059     05  WS-DUEP-CONTROL         PIC X(19)    VALUE LOW-VALUES.
  1060     05  WS-HOLD-CONTROL.
  1061         10  WS-HOLD-CAR         PIC X.
  1062         10  WS-HOLD-GRP         PIC X(6).
  1063         10  WS-HOLD-ST          PIC XX.
  1064         10  WS-HOLD-ACCT        PIC X(10).
  1065     05  WS-WORK-TERM            PIC S999   COMP-3 VALUE +0.
  1066     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
  1067     05  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS056.cbl
  1068     05  WS-DISPLAY-DATE         PIC ZZZ9(8).
  1069     05  WS-DISPLAY-TERM         PIC Z99.
  1070     05  WS-DISPLAY-RTERM        PIC Z99.99.
  1071     05  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
  1072     05  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
  1073     05  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
  1074     05  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
  1075     05  WS-BIN-LAST-MONTH-DT    PIC XX  VALUE LOW-VALUES.
  1076     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
  1077     05  WS-BIN-1ST-DT           PIC XX  VALUE LOW-VALUES.
  1078     05  WS-DAYS-TO-1ST          PIC S9(3) COMP-3 VALUE +0.
  1079     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
  1080     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
  1081     05  WS-BIN-LF-CAN-DATE      PIC XX  VALUE LOW-VALUES.
  1082     05  WS-BIN-AH-CAN-DATE      PIC XX  VALUE LOW-VALUES.
  1083     05  WS-LF-CAN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1084     05  WS-AH-CAN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1085     05  WS-LF-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1086     05  WS-LF-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  1087     05  WS-AH-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1088     05  WS-AH-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  1089     05  WS-LF-REF               PIC S9(7)V99 COMP-3 VALUE +0.
  1090     05  WS-AH-REF               PIC S9(7)V99 COMP-3 VALUE +0.
  1091     05  WS-LF-CAN-QUAL-SW       PIC X     VALUE 'N'.
  1092         88  CREDIT-LF-CANCEL              VALUE 'Y'.
  1093     05  WS-AH-CAN-QUAL-SW       PIC X     VALUE 'N'.
  1094         88  CREDIT-AH-CANCEL              VALUE 'Y'.
  1095     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
  1096     05  FILLER REDEFINES WS-END-YEAR.
  1097         10  WS-CCYY             PIC 9(7).
  1098         10  WS-MMDD             PIC 9(4).
  1099 01  WS-DEBUG-AREA.
  1100     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1101         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1102         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
  1103         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1104         88  DEBUG-LF-STATUTORY         VALUE '3'.
  1105         88  DEBUG-AH-STATUTORY         VALUE '4'.
  1106
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS056.cbl
  1108
  1109 01  TEXAS-REGS-WORK-AREAS.
  1110     12  TEX-FACT-1              PIC S9(7)V9(2)    COMP-3.
  1111     12  TEX-FACT-2              PIC S9(3)   COMP-3.
  1112     12  TEX-FACT-3              PIC S9(3)   COMP-3.
  1113     12  TEX-FACT-4              PIC S9(7)   COMP-3.
  1114     12  TEX-FACT-5              PIC S9(3)   COMP-3.
  1115     12  TEX-FACT-6              PIC S9(3)   COMP-3.
  1116     12  TEX-FACT-7              PIC S9(7)   COMP-3.
  1117     12  TEX-FACT-8              PIC S9V9(6) COMP-3.
  1118     12  TEX-FACT-9              PIC S9(4)V9(11)   COMP-3.
  1119
  1120 01  NET-PAY-INTERFACE.
  1121     05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  1122     05  NP-ORIG                 PIC S9(3)         COMP-3.
  1123     05  NP-REM                  PIC S9(3)         COMP-3.
  1124     05  NP-OPT                  PIC X(01).
  1125     05  NP-CAP                  PIC S9(3)         COMP-3.
  1126     05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  1127     05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  1128     05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  1129
  1130 01  WS-ABEND-AREA.
  1131     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1132     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1133     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1134     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1135
  1136 01  WORK-ABEND-CODE.
  1137     12  WAC-1                   PIC X.
  1138     12  WAC-2                   PIC X.
  1139     12  WAC-3-4.
  1140         16  WAC-3               PIC X.
  1141         16  WAC-4               PIC X.
  1142
  1143 01  DATE-AREAS.
  1144     05  WS-THIS-MONTH-DATE      PIC 9(11).
  1145     05  WS-LAST-MONTH-DATE      PIC 9(11).
  1146     05  WS-WORK-DATE            PIC 9(11).
  1147     05  FILLER REDEFINES WS-WORK-DATE.
  1148         10  FILLER              PIC XXX.
  1149         10  WS-WORK-CCYY        PIC 9(4).
  1150         10  WS-WORK-MMDD        PIC 9(4).
  1151     05  WS-ISSUE-DATE           PIC 9(11).
  1152     05  FILLER REDEFINES WS-ISSUE-DATE.
  1153         10  FILLER              PIC XXX.
  1154         10  WS-ISSUE-CCYY       PIC 9(4).
  1155         10  WS-ISSUE-MMDD       PIC 9(4).
  1156     05  WS-EXPIRE-DATE          PIC 9(11).
  1157     05  FILLER REDEFINES WS-EXPIRE-DATE.
  1158         10  FILLER              PIC XXX.
  1159         10  WS-EXPIRE-CCYY      PIC 9(4).
  1160         10  WS-EXPIRE-MMDD      PIC 9(4).
  1161     05  WS-ENTRY-DATE           PIC 9(11).
  1162     05  FILLER REDEFINES WS-ENTRY-DATE.
  1163         10  FILLER              PIC XXX.
  1164         10  WS-ENTRY-CCYY       PIC 9(4).
  1165         10  WS-ENTRY-MMDD       PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS056.cbl
  1166     05  WS-CANCEL-DATE          PIC 9(11).
  1167     05  FILLER REDEFINES WS-CANCEL-DATE.
  1168         10  FILLER              PIC XXX.
  1169         10  WS-CANCEL-CCYY      PIC 9(4).
  1170         10  WS-CANCEL-MMDD      PIC 9(4).
  1171     05  WS-CLAIM-DATE           PIC 9(11).
  1172     05  FILLER REDEFINES WS-CLAIM-DATE.
  1173         10  FILLER              PIC XXX.
  1174         10  WS-CLAIM-CCYY       PIC 9(4).
  1175         10  WS-CLAIM-MMDD       PIC 9(4).
  1176     05  WS-POSTING-DATE         PIC X(8).
  1177     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
  1178     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
  1179     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
  1180     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
  1181     05  WS-BIN-VAL-DATES OCCURS 50
  1182                                 PIC XX.
  1183
  1184 01  WS-MISC-AREA.
  1185     12  WS-DP-EXP-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
  1186     12  WS-DP-REC-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
  1187     12  WS-DP-GA-COMM           PIC S9(9)V99 COMP-3 VALUE +0.
  1188     12  WS-DP-BASE-COMM         PIC S9(9)V99 COMP-3 VALUE +0.
  1189     12  WS-DP-ADJ               PIC S9(9)V99 COMP-3 VALUE +0.
  1190*   1ST OCCURANCE           ACCOUNT TOTALS
  1191*   2ND                     STATE
  1192*   3RD                     GROUP
  1193*   4TH                     CARRIER
  1194*   5TH                     FINAL
  1195     12  WS-TOTAL-TABLE OCCURS 5.
  1196         16  WS-TOT-EXP-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
  1197         16  WS-TOT-REC-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
  1198         16  WS-TOT-GA-COMM      PIC S9(9)V99 COMP-3 VALUE +0.
  1199         16  WS-TOT-BASE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
  1200     12  WS-DISPLAY-FLD          PIC 9(9).9(5).
  1201     12  WS-LF-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
  1202     12  WS-AH-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
  1203     12  CERT-IN-CNT             PIC 9(9)     VALUE ZEROS.
  1204     12  WS-INT                  PIC S9(5)V999 COMP-3 VALUE +0.
  1205     12  WS-FINT                 PIC S9(5)V999 COMP-3 VALUE +0.
  1206     12  WS-LINS                 PIC S9(7)V99 COMP-3  VALUE +0.
  1207     12  WS-DINS                 PIC S9(7)V99 COMP-3  VALUE +0.
  1208     12  WS-FLINS                PIC S9(7)V99 COMP-3  VALUE +0.
  1209     12  WS-FDINS                PIC S9(7)V99 COMP-3  VALUE +0.
  1210     12  WS-I                    PIC SV9(9)   COMP-3  VALUE +0.
  1211     12  WS-J                    PIC SV9(9)   COMP-3  VALUE +0.
  1212     12  WS-Y                    PIC S99V9(9)   COMP-3  VALUE +0.
  1213     12  WS-K                    PIC SV9(9)   COMP-3  VALUE +0.
  1214     12  WS-VM                   PIC S9V9(9)  COMP-3  VALUE +0.
  1215     12  WS-P                    PIC S9(7)V99 COMP-3  VALUE +0.
  1216     12  WS-B                    PIC S9(7)V99 COMP-3  VALUE +0.
  1217     12  WS-R                    PIC S9(7)V99 COMP-3  VALUE +0.
  1218     12  WS-I1                   PIC S9(7)V99 COMP-3  VALUE +0.
  1219     12  X1                      PIC S999     COMP-3  VALUE +0.
  1220     12  WS-A                    PIC S999     COMP-3  VALUE +0.
  1221     12  WS-PYAJ-INDEX           PIC S999     COMP-3  VALUE +0.
  1222     12  WS-PYAJ-MAX             PIC S999     COMP-3  VALUE +0.
  1223     12  WS-ANGLEN               PIC S9(5)V9999 COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS056.cbl
  1224     12  WS-OD                   PIC S9(5)V9999 COMP-3  VALUE +0.
  1225     12  WS-AMT                  PIC S9(9)V99 COMP-3  VALUE +0.
  1226     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3  VALUE +0.
  1227     12  WS-ANGLEM               PIC S9(5)V9999 COMP-3  VALUE +0.
  1228     12  WS-ANGLEM-1             PIC S9(5)V9999 COMP-3  VALUE +0.
  1229     12  WS-ANGLEMJ              PIC S9(5)V9999 COMP-3  VALUE +0.
  1230     12  WS-ANGLEMK              PIC S9(5)V9999 COMP-3  VALUE +0.
  1231     12  WS-ANGLEN-M             PIC S9(5)V9999 COMP-3  VALUE +0.
  1232     12  LF-REM-TERM             PIC S999     COMP-3  VALUE +0.
  1233     12  AH-REM-TERM             PIC S999     COMP-3  VALUE +0.
  1234     12  LF-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
  1235     12  AH-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
  1236     12  LF-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
  1237     12  AH-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
  1238     12  REM-TERM                PIC S9(3)V99    COMP-3.
  1239     12  REM-TRM2                PIC S9(3)V99    COMP-3.
  1240     12  WS-LF-EARN-TERM         PIC S999            VALUE ZEROS.
  1241     12  WS-AH-EARN-TERM         PIC S999            VALUE ZEROS.
  1242     12  WS-EARN-TERM            PIC S999            VALUE ZEROS.
  1243     12  WS-GIANT-SW             PIC X           VALUE SPACES.
  1244         88  THIS-IS-A-GIANT-CERT                VALUE 'X'.
  1245
  1246
  1247 01  ABEND-FIELDS.
  1248     12  PGM-SUB                 PIC S999 COMP  VALUE +064.
  1249     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
  1250         88  FIRST-TIME                 VALUE 'Y'.
  1251
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS056.cbl
* 1253                                 COPY ELCCALC.
  1254******************************************************************04/15/98
  1255*                                                                *ELCCALC
  1256*                           ELCCALC.                            *    LV003
  1257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1258*                            VMOD=2.025                          *   CL**3
  1259*                                                                *   CL**2
  1260*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1261*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1262*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1263*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1264*                                                                *   CL**2
  1265*  PASSED TO ELRTRM                                              *   CL**2
  1266*  -----------------                                             *   CL**2
  1267*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1268*  ORIGINAL TERM                                                 *   CL**2
  1269*  BEGINNING DATE                                                *   CL**2
  1270*  ENDING DATE                                                   *   CL**2
  1271*  COMPANY I.D.                                                  *   CL**2
  1272*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1273*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1274*  FREE LOOK DAYS                                                *   CL**2
  1275*                                                                *   CL**2
  1276*  RETURNED FROM ELRTRM                                          *   CL**2
  1277*  ---------------------                                         *   CL**2
  1278*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1279*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1280*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1281*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1282*----------------------------------------------------------------*   CL**2
  1283*  PASSED TO ELRAMT                                              *   CL**2
  1284*  ----------------                                              *   CL**2
  1285*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1286*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1287*  ORIGINAL AMOUNT                                               *   CL**2
  1288*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1289*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1290*  METHOD                                                            CL**2
  1291*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1292*  COMPANY I.D.                                                  *   CL**2
  1293*  BENEFIT TYPE                                                  *   CL**2
  1294*                                                                *   CL**2
  1295*  RETURNED FROM ELRAMT                                          *   CL**2
  1296*  --------------------                                          *   CL**2
  1297*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1298*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1299*  REMAINING AMOUNT FACTOR                                           CL**2
  1300*----------------------------------------------------------------*   CL**2
  1301*  PASSED TO ELRESV                                              *   CL**2
  1302*  -----------------                                             *   CL**2
  1303*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1304*  VALUATION DATE                                                *   CL**2
  1305*  PAID THRU DATE                                                *   CL**2
  1306*  BENEFIT                                                       *   CL**2
  1307*  INCURRED DATE                                                 *   CL**2
  1308*  REPORTED DATE                                                 *   CL**2
  1309*  ISSUE AGE                                                     *   CL**2
  1310*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1311*  CDT PERCENT                                                   *   CL**2
  1312*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1313* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1314* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1315* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1316*                                                                *   CL**2
  1317*  RETURNED FROM ELRESV                                          *   CL**2
  1318*  --------------------                                          *   CL**2
  1319*  CDT TABLE USED                                                *   CL**2
  1320*  CDT FACTOR USED                                               *   CL**2
  1321*  PAY TO CURRENT RESERVE                                        *   CL**2
  1322*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1323*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1324*----------------------------------------------------------------*   CL**2
  1325*  PASSED TO ELRATE                                              *   CL**2
  1326*  ----------------                                              *   CL**2
  1327*  CERT ISSUE DATE                                               *   CL**2
  1328*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1329*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1330*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1331*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1332*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1333*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1334*  DEVIATION CODE                                                *   CL**2
  1335*  ISSUE AGE                                                     *   CL**2
  1336*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1337*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1338*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1339*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1340*  A.P.R.                                                        *   CL**2
  1341*  METHOD                                                            CL**2
  1342*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1343*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1344*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1345*  BENEFIT CODE                                                  *   CL**2
  1346*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1347*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1348*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1349*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1350*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1351*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1352*                                                                *   CL**2
  1353*  RETURNED FROM ELRATE                                          *   CL**2
  1354*  --------------------                                          *   CL**2
  1355*  CALCULATED PREMIUM                                            *   CL**2
  1356*  PREMIUM RATE                                                  *   CL**2
  1357*  MORTALITY CODE                                                *   CL**2
  1358*  MAX ATTAINED AGE                                              *   CL**2
  1359*  MAX AGE                                                       *   CL**2
  1360*  MAX TERM                                                      *   CL**2
  1361*  MAX MONTHLY BENEFIT                                           *   CL**2
  1362*  MAX TOTAL BENIFIT                                             *   CL**2
  1363*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1364*----------------------------------------------------------------*   CL**2
  1365*  PASSED TO ELRFND                                              *   CL**2
  1366*  ----------------                                              *   CL**2
  1367*  CERT ISSUE DATE                                               *   CL**2
  1368*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1369*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1370*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1371*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1372*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1373*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1374*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1375*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1376*  DEVIATION CODE                                                *   CL**2
  1377*  ISSUE AGE                                                     *   CL**2
  1378*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1379*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1380*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1381*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1382*  A.P.R.                                                        *   CL**2
  1383*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1384*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1385*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1386*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1387*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1388*  BENEFIT CODE                                                  *   CL**2
  1389*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1390*                                                                *   CL**2
  1391*  RETURNED FROM ELRFND                                          *   CL**2
  1392*  --------------------                                          *   CL**2
  1393*  CALCULATED REFUND                                             *   CL**2
  1394*----------------------------------------------------------------*   CL**2
  1395*  PASSED TO ELEARN                                              *   CL**2
  1396*  ----------------                                              *   CL**2
  1397*  CERT ISSUE DATE                                               *   CL**2
  1398*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1399*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1400*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1401*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1402*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1403*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1404*  DEVIATION CODE                                                *   CL**2
  1405*  ISSUE AGE                                                     *   CL**2
  1406*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1407*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1408*  A.P.R.                                                        *   CL**2
  1409*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1410*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1411*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1412*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1413*  BENEFIT CODE                                                  *   CL**2
  1414*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1415*                                                                *   CL**2
  1416*  RETURNED FROM ELEARN                                          *   CL**2
  1417*  --------------------                                          *   CL**2
  1418*  INDICATED  EARNINGS                                           *   CL**2
  1419*----------------------------------------------------------------*   CL**2
  1420*                 LENGTH = 450                                   *   CL**2
  1421*                                                                *   CL**2
  1422******************************************************************   CL**2
  1423******************************************************************
  1424*                   C H A N G E   L O G
  1425*
  1426* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1427*-----------------------------------------------------------------
  1428*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1429* EFFECTIVE    NUMBER
  1430*-----------------------------------------------------------------
  1431* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1432* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1433* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1434* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1435* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1436* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1437* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1438* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1439* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1440******************************************************************
  1441                                                                     CL**2
  1442 01  CALCULATION-PASS-AREA.                                          CL**2
  1443     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1444                                     COMP.                           CL**2
  1445                                                                     CL**2
  1446     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1447       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1448       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1449                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1450       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1451       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1452       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1453       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1454       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1455       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1456       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1457       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1458       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1459       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1460       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1461       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1462       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1463       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1464       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1465       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1466       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1467                                                                     CL**2
  1468     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1469       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1470***********************  INPUT AREAS ****************************    CL**2
  1471                                                                     CL**2
  1472     12  CP-CALCULATION-AREA.                                        CL**2
  1473         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1474         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1475         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1476         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1477         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1478           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1479                                                   'I' 'U'.          CL**2
  1480           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1481           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1482         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1483         16  CP-REPORTED-DT        PIC XX.                           CL**2
  1484         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1485         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1486         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1487                                     COMP-3.                         CL**2
  1488         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1489                                     COMP-3.                         CL**2
  1490         16  CP-CDT-METHOD         PIC X.                            CL**2
  1491           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1492           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1493           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1494         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1495           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1496           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1497         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1498                                     COMP-3.                         CL**2
  1499         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1500                                     COMP-3.                         CL**2
  1501         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1502                                     COMP-3.                         CL**2
  1503         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1504                                     COMP-3.                         CL**2
  1505         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1506                                     COMP-3.                         CL**2
  1507         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1508                                     COMP-3.                         CL**2
  1509         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1510                                     COMP-3.                         CL**2
  1511         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1512           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1513           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1514           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1515           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1516           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1517           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1518           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1519         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1520           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1521           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1522           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1523           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1524           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1525           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1526           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1527           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1528           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1529           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1530           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1531           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1532           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1533           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1534         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1535           88  CP-CLAIM                            VALUE '1'.        CL**2
  1536           88  CP-CANCEL                           VALUE '2'.        CL**2
  1537           88  CP-ISSUE                            VALUE '3'.        CL**2
  1538         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1539           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1540           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1541           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  1542           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1543           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1544           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1545           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1546           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1547           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1548           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1549           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1550           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1551           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1552           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1553           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1554           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1555           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1556           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1557                                                     'W' 'X'.        CL**2
  1558           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1559           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1560           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1561           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1562           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1563           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1564           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1565           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1566           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1567           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1568           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1569           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1570           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1571                                                                     CL**2
  1572         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1573                                     COMP-3.                         CL**2
  1574         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1575         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1576         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1577         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1578         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1579           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1580               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1581         16  CP-R78-OPTION         PIC X.                            CL**2
  1582           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1583           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1584                                                                     CL**2
  1585         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1586         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1587         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1588         16  CP-RATE-FILE          PIC X.                            CL**2
  1589         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1590                                     COMP-3.                         CL**2
  1591                                                                     CL**2
  1592         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1593         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1594                                                                     CL**2
  1595         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1596                                     COMP-3.
  1597         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1598                                   PIC S9(5)V99 COMP-3.
  1599         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  1600                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1601         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1602                                     COMP-3.                         CL**2
  1603         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1604                                     COMP-3.
  1605         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1606                                  PIC S9(7)V99 COMP-3.
  1607                                                                     CL**2
  1608         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1609         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1610         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1611           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1612           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1613           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1614           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1615         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1616         16  CP-CARRIER            PIC X.                            CL**2
  1617         16  CP-REIN-FLAG          PIC X.                            CL**2
  1618         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1619           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1620                      '2' '3' '4' '5'.                               CL**2
  1621           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1622           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1623           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1624           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1625           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1626           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1627           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1628           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1629         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1630         16  CP-RATING-METHOD      PIC X.                            CL**2
  1631           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1632           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1633           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1634           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1635           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1636           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1637           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1638           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1639           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1640         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1641                                     COMP-3.                         CL**2
  1642         16  CP-BEN-CATEGORY       PIC X.
  1643         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1644         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1645                                   PIC S99V9(5) COMP-3.
  1646         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1647         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1648                                   PIC S99V9(5) COMP-3.
  1649         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1650         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1651         16  CP-EXPIRE-DT          PIC XX.
  1652         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1653         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1654         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1655         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1656         16  CP-DDF-SPEC-CALC      PIC X.
  1657             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1658             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1659         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1660         16  CP-CANCEL-REASON      PIC X.
  1661         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1662         16  CP-PMT-MODE           PIC X.
  1663         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1664         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1665         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1666         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1667         16  FILLER                PIC X.
  1668                                                                     CL**2
  1669***************    OUTPUT FROM ELRESV   ************************     CL**2
  1670                                                                     CL**2
  1671         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1672                                                                     CL**2
  1673         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1674                                     COMP-3.                         CL**2
  1675         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1676                                     COMP-3.                         CL**2
  1677         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1678                                     COMP-3.                         CL**2
  1679         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1680                                     COMP-3.                         CL**2
  1681         16  FILLER                PIC X(09).                        CL**2
  1682***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1683                                                                     CL**2
  1684         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1685                                     COMP-3.                         CL**2
  1686         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1687                                     COMP-3.                         CL**2
  1688         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1689                                     COMP-3.                         CL**2
  1690         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1691                                     COMP-3.                         CL**2
  1692         16  FILLER                PIC X(12).                        CL**2
  1693                                                                     CL**2
  1694***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1695                                                                     CL**2
  1696         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1697                                     COMP-3.                         CL**2
  1698         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1699                                     COMP-3.                         CL**2
  1700         16  FILLER                PIC X(12).                        CL**2
  1701                                                                     CL**2
  1702***************    OUTPUT FROM ELRATE   *************************    CL**2
  1703                                                                     CL**2
  1704         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1705                                     COMP-3.                         CL**2
  1706         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1707                                     COMP-3.                         CL**2
  1708         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1709         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1710             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1711         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1712                                     COMP-3.                         CL**2
  1713         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1714         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1715         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1716                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1717         16  FILLER                PIC X(07).                        CL**2
  1718                                                                     CL**2
  1719***************    OUTPUT FROM ELRFND   *************************    CL**2
  1720                                                                     CL**2
  1721         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1722                                     COMP-3.                         CL**2
  1723         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1724           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1725           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1726           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1727           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1728           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1729           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1730           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1731           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1732           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1733           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1734           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1735           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1736           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1737           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1738         16  FILLER                PIC X(12).                        CL**2
  1739                                                                     CL**2
  1740***************    OUTPUT FROM ELEARN   *************************    CL**2
  1741                                                                     CL**2
  1742         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1743                                     COMP-3.                         CL**2
  1744         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1745                                     COMP-3.                         CL**2
  1746         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1747                                     COMP-3.                         CL**2
  1748         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1749                                     COMP-3.                         CL**2
  1750         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1751                                     COMP-3.                         CL**2
  1752         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1753                                     COMP-3.                         CL**2
  1754         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1755           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1756           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1757           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1758           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1759           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1760           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1761           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1762           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1763           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1764         16  FILLER                PIC X(12).                        CL**2
  1765                                                                     CL**2
  1766***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1767                                                                     CL**2
  1768         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1769                                     COMP-3.                         CL**2
  1770         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1771                                     COMP-3.                         CL**2
  1772         16  FILLER                PIC X(12).                        CL**2
  1773                                                                     CL**2
  1774***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1775         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1776                                     COMP-3.                         CL**2
  1777         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1778                                     COMP-3.                         CL**2
  1779         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1780                                     COMP-3.                         CL**2
  1781         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1782                                     COMP-3.                         CL**2
  1783         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1784                                     COMP-3.                         CL**2
  1785         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1786                                     COMP-3.                         CL**2
  1787         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1788             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1789             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1790             88  IO-ERROR                         VALUE 'E'.         CL**2
  1791                                                                     CL**2
  1792         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1793                                                                     CL**2
  1794         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1795                                                                     CL**2
  1796         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1797                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1798                                     COMP-3.                         CL**2
  1799                                                                     CL**2
  1800         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1801                                                                     CL**2
  1802         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1803                                     COMP-3.                         CL**2
  1804                                                                     CL**2
  1805         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1806                                     COMP-3.                         CL**2
  1807                                                                     CL**2
  1808         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1809                                     COMP-3.                         CL**2
  1810                                                                     CL**2
  1811         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1812                                     COMP-3.                         CL**2
  1813                                                                     CL**2
  1814         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1815                                     COMP-3.                         CL**2
  1816                                                                     CL**2
  1817         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1818                                     COMP-3.                         CL**2
  1819                                                                     CL**2
  1820         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1821                                     COMP-3.                         CL**2
  1822                                                                     CL**2
  1823         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1824             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1825                                                                     CL**2
  1826         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1827                                     COMP-3.                         CL**2
  1828         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1829                                     COMP-3.
  1830         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1831         16  FILLER                PIC X(15).                        CL**2
  1832******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS056.cbl
  1833/
* 1834                                 COPY ELCDATE.
  1835******************************************************************06/11/98
  1836*                                                                *ELCDATE
  1837*                                                                *ELCDATE
  1838*                            ELCDATE.                            *   LV023
  1839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1840*                            VMOD=2.003                           ELCDATE
  1841*                                                                *ELCDATE
  1842*                                                                *ELCDATE
  1843*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1844*                 LENGTH = 200                                   *   CL*19
  1845******************************************************************ELCDATE
  1846                                                                  ELCDATE
  1847 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1848     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1849     12  DC-OPTION-CODE                PIC X.                        CL*15
  1850         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1851         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1852         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1853         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1854         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1855         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1856         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1857         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1858         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1859         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1860         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1861         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1862         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1863         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1864         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1865         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1866         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1867         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1868         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1869         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1870         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1871         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1872         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1873         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1874         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1875         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1876         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1877         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1878         88  THREE-CHARACTER-BIN                                  ELCDATE
  1879                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1880         88  GREGORIAN-TO-BIN                                        CL**2
  1881                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1882         88  BIN-TO-GREGORIAN                                        CL**2
  1883                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1884         88  JULIAN-TO-BINARY                                        CL**2
  1885                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1886     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1887         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1888         88  DATE-CONVERSION-ERROR                                ELCDATE
  1889                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1890         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1891         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1892         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1893         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1894         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1895         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1896         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1897         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1898         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1899         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1900     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1901         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1902     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1903         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1904         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1905         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1906     12  FILLER                        PIC X.                        CL*15
  1907     12  DC-CONVERSION-DATES.                                        CL*15
  1908         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1909         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1910         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1911         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1912                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1913             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1914             20  SLASH1-1              PIC X.                        CL*15
  1915             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1916             20  SLASH1-2              PIC X.                        CL*15
  1917             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1918         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1919         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1920                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1921             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1922             20  SLASH2-1              PIC X.                        CL*15
  1923             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1924             20  SLASH2-2              PIC X.                        CL*15
  1925             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1926         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1927         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1928                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1929             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1930             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1931             20  DC-YMD-DAY            PIC 99.                       CL*15
  1932         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1933         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1934                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1935             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1936             20  DC-MDY-DAY            PIC 99.                       CL*15
  1937             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1938         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1939             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1940             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1941             20  FILLER                PIC XX.                       CL*15
  1942             20  DC-ALPHA-CENTURY.                                   CL*15
  1943                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1944             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1945         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1946         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1947         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1948         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1949         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1950                                       PIC 9(05).                    CL*20
  1951         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1952             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1953             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1954         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1955         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1956         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1957     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1958         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1959         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1960             20  FILLER                PIC 9(3).                     CL*15
  1961             20  HOLD-CEN-1-CCYY.                                    CL*15
  1962                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1963                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1964             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1965             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1966         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1967             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1968             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1969             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1970                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1971                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1972             20  FILLER                PIC 9(3).                     CL*15
  1973         16  HOLD-CENTURY-1-X.                                       CL*15
  1974             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1975             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1976                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1977                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1978             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1979             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1980         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1981             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1982             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1983             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1984                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1985                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1986             20  FILLER                PIC XXX.                      CL*23
  1987         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1988         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1989         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1990         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1991             20  DC-JULIAN-1-CCYY.                                   CL*15
  1992                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1993                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1994             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1995         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1996         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1997             20  DC-JULIAN-2-CCYY.                                   CL*15
  1998                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1999                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2000             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2001         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2002             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2003             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2004             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2005             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2006             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2007                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  2008                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2009         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2010             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2011             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2012             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2013             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2014             20  DC-EDITB-CCYY.                                      CL*15
  2015                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2016                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2017         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2018         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2019                              DC-GREG-DATE-CYMD.                  ELCDATE
  2020             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2021             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2022             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2023             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2024         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2025         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2026                              DC-GREG-DATE-MDCY.                  ELCDATE
  2027             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2028             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2029             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2030             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2031    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2032        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2033    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2034    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS056.cbl
  2035/
* 2036                                 COPY ELCDTECX.
  2037******************************************************************06/05/98
  2038*                                                                *ELCDTECX
  2039*                            ELCDTECX.                           *   LV005
  2040*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2041*                            VMOD=2.015                          *ELCDTECX
  2042*                                                                *ELCDTECX
  2043*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2044*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2045*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2046*                                                                *ELCDTECX
  2047******************************************************************ELCDTECX
  2048******************************************************************
  2049*                   C H A N G E   L O G
  2050*
  2051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2052*-----------------------------------------------------------------
  2053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2054* EFFECTIVE    NUMBER
  2055*-----------------------------------------------------------------
  2056* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2057*                                  BENEFIT CODES FROM 300 TO 900
  2058* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2059* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2060******************************************************************
  2061 01  DATE-CARD.                                                   ELCDTECX
  2062     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2063     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2064     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2065     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2066     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2067     12  EP-SW                       PIC  X.                      ELCDTECX
  2068         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2069     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2070         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2071     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2072     12  RUN-CENTURY.                                             ELCDTECX
  2073         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2074     12  FILLER                      PIC  X.                         CL**4
  2075     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2076     12  FILLER                      PIC  XXX.                    ELCDTECX
  2077     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2078                                                                  ELCDTECX
  2079 01  FILLER                          PIC  X(7)                       CL**6
  2080                                          VALUE 'OPTIONS'.        ELCDTECX
  2081 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2082     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2083     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2084     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2085         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2086         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2087     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2088     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2089     12  FILLER                      PIC  X.                      ELCDTECX
  2090     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2091     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  2092     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2093     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2094     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  2095     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2096     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2097     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2098     12  FILLER                      PIC  X.                      ELCDTECX
  2099     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2100     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2101     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2102     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2103     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2104     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2105     12  FILLER                      PIC  X.                      ELCDTECX
  2106     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2107     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2108     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2109     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2110     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2111     12  DTE-R78                     PIC  X.                      ELCDTECX
  2112     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2113     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2114     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2115     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2116     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2117     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2118     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2119                                     PIC  X.                      ELCDTECX
  2120         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2121                                                 ' '.             ELCDTECX
  2122         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2123         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2124     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2125         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2126         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2127     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2128     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2129                                     PIC  9.                         CL**4
  2130     12  DTE-SYSTEM.                                              ELCDTECX
  2131         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2132         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2133         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2134         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2135         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2136         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2137         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2138         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2139         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  2140         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  2141         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  2142         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  2143         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  2144         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  2145         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  2146         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  2147         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  2148         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  2149         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  2150         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2151         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  2152         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  2153         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  2154         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  2155         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  2156         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  2157     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  2158         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  2159                                     PIC  X.                      ELCDTECX
  2160     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  2161                                                                  ELCDTECX
  2162 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  2163     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  2164     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  2165     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  2166*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  2167     12  FILLER                      PIC  X.                      ELCDTECX
  2168     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  2169     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  2170     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  2171     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  2172     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  2173     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  2174     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  2175                                                                  ELCDTECX
  2176     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  2177     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  2178     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2179     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2180                                                                  ELCDTECX
  2181     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2182     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2183     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2184     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2185                                                                  ELCDTECX
  2186     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2187     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2188                                                                  ELCDTECX
  2189     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2190     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2191                                                                  ELCDTECX
  2192     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2193                                                                  ELCDTECX
  2194 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2195     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2196     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2197     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2198     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2199     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2200     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2201     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2202                                                                  ELCDTECX
  2203 01  FILLER                          PIC  X(12)                   ELCDTECX
  2204                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2205 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2206     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  2207         16  CNT-ID                  PIC  X.                      ELCDTECX
  2208         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2209                                                                  ELCDTECX
  2210 01  FILLER                          PIC  X(11)                   ELCDTECX
  2211                                          VALUE 'STATE NAMES'.    ELCDTECX
  2212 01  STATE-NAMES.                                                 ELCDTECX
  2213     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2214         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2215         16  STATE-PIC1.                                          ELCDTECX
  2216             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2217             20  FILLER              PIC  XXX.                    ELCDTECX
  2218             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2219             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2220             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2221             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2222                                                                  ELCDTECX
  2223 01  FILLER                          PIC  X(13)                   ELCDTECX
  2224                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2225 01  CARRIER-NAMES.                                               ELCDTECX
  2226     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2227         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2228         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2229         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2230         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2231         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2232         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2233*        16  FILLER                  PIC  X.                      ELCDTECX
  2234         16  CARRIER-SEC-PAY         PIC  X.
  2235             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2236                                                                  ELCDTECX
  2237 01  FILLER                          PIC  X(9)                       CL**6
  2238                                          VALUE 'INS TYPES'.      ELCDTECX
  2239 01  CLAS-INS-TYPES.                                              ELCDTECX
  2240*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2241     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2242         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2243         16  CLAS-I-AB3.                                          ELCDTECX
  2244             20  FILLER              PIC  X.                      ELCDTECX
  2245             20  CLAS-I-AB2.                                      ELCDTECX
  2246                 24  FILLER          PIC  X.                      ELCDTECX
  2247                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2248         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2249             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2250             20  FILLER              PIC  X.                         CL**4
  2251         16  CLAS-I-AB10.                                         ELCDTECX
  2252             20  FILLER              PIC  X(9).                   ELCDTECX
  2253             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2254         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2255         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2256         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2257         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2258             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2259         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2260         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2261         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2262         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2263         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  2264         16  FILLER                  PIC  X(05).
  2265                                                                  ELCDTECX
  2266 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2267                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2268 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2269     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2270                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2271         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2272         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2273         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2274         16  CLAS-MORT-DESC.                                      ELCDTECX
  2275             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2276             20  FILLER              PIC  XX.                        CL**5
  2277             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2278             20  FILLER              PIC  X.                         CL**5
  2279             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2280             20  FILLER              PIC  X.                         CL**5
  2281             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2282             20  FILLER              PIC  X.                         CL**5
  2283             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2284             20  FILLER              PIC  X(5).                      CL**6
  2285                                                                  ELCDTECX
  2286 01  FILLER                          PIC  X(15)                   ELCDTECX
  2287                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2288 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2289     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2290         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2291         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2292         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2293         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2294         16  FILLER                  PIC  X(4).                      CL**6
  2295                                                                  ELCDTECX
  2296 01  FILLER                          PIC  X(7)                       CL**6
  2297                                     VALUE 'INDEXES'.             ELCDTECX
  2298 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2299     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2300     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2301     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2302     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2303     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2304     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2305     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2306     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2307     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2308     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2309     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2310     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2311     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2312     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2313     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2314     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2315     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2316                                                                  ELCDTECX
  2317 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2318     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2319     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2320     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2321     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2322     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2323     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2324     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2325     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2326     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2327     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2328     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2329                                                                  ELCDTECX
  2330 01  FILLER                          PIC  X(13)                   ELCDTECX
  2331                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2332 01  CLAS-MISC.                                                   ELCDTECX
  2333     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2334         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2335         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2336         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2337     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2338     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2339     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2340     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2341     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2342     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2343     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2344     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2345     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2346     12  STATE-L                     PIC  XX.                     ELCDTECX
  2347     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2348     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2349     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2350         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2351         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2352     12  DTE-ABEND-WORK.                                          ELCDTECX
  2353         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2354         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2355                                                                  ELCDTECX
  2356 01  FILLER                          PIC  X(12)                   ELCDTECX
  2357                                     VALUE 'WORKING DATE'.        ELCDTECX
  2358 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2359     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2360         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2361         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2362         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2363     12  WS-CURRENT-DATE.                                         ELCDTECX
  2364         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2365         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2366         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2367         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2368         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2369     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2370         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2371         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2372                                                                  ELCDTECX
  2373 01  FILLER                          PIC  X(12)                   ELCDTECX
  2374                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2375 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2376     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2377         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2378         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2379         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2380                                                                  ELCDTECX
  2381 01  FILLER                          PIC  X(10)                   ELCDTECX
  2382                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2383 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2384     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2385         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2386         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2387                                                                  ELCDTECX
  2388 01  FILLER                          PIC  X(13)                   ELCDTECX
  2389                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2390 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2391     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2392         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2393                                                                  ELCDTECX
  2394 01  FILLER                          PIC  X(13)                   ELCDTECX
  2395                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2396 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2397     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2398     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2399     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2400                                     PIC  X.                         CL**5
  2401     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2402     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2403     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2404     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2405     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2406     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2407     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2408     12  FILLER                      PIC  X(75).                  ELCDTECX
  2409******************************************************************ELCDTECX
  2410*01  MISC-CARR-PCT-DATA.                                          00001521
  2411*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2412*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2413*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2414*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2415*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2416*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2417******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS056.cbl
  2418/
* 2419                                 COPY ELCDTEVR.
  2420***************************************************************** 04/15/98
  2421*                                                                *ELCDTEVR
  2422*                                                                *ELCDTEVR
  2423*                            ELCDTEVR.                           *   LV003
  2424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2425*                            VMOD=2.001                          *   CL**2
  2426*                                                                *ELCDTEVR
  2427*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2428*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2429*                                                                *ELCDTEVR
  2430******************************************************************ELCDTEVR
  2431 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2432     05  WS-RUN-DATE.                                             ELCDTEVR
  2433         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2434         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2435         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2436             15  RUN-CC              PIC  99.                     ELCDTEVR
  2437             15  RUN-YR              PIC  99.                     ELCDTEVR
  2438         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2439         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2440     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2441            WS-RUN-DATE              PIC 9(11).                      CL**2
  2442     05  WS-EP-DT.                                                ELCDTEVR
  2443         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2444         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2445         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2446             15  EP-CC               PIC  99.                     ELCDTEVR
  2447             15  EP-YR               PIC  99.                     ELCDTEVR
  2448         10  EP-MO                   PIC  99.                     ELCDTEVR
  2449         10  EP-DA                   PIC  99.                     ELCDTEVR
  2450     05  WS-EP-DT-N REDEFINES                                        CL**2
  2451            WS-EP-DT                 PIC 9(11).                      CL**2
  2452     05  WS-DTE-CONV-DT.                                             CL**4
  2453         10  FILLER                  PIC  9(03).                     CL**4
  2454         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2455         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2456             15  DTE-CONV-CC         PIC  99.                        CL**4
  2457             15  DTE-CONV-YR         PIC  99.                        CL**4
  2458         10  DTE-CONV-MO             PIC  99.                        CL**4
  2459         10  DTE-CONV-DA             PIC  99.                        CL**4
  2460     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2461            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2462 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2463     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2464         10  FILLER                            PIC 999.           ELCDTEVR
  2465         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2466         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2467             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2468             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2469         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2470         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2471     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2472            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2473     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2474         10  FILLER                            PIC 999.           ELCDTEVR
  2475         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2476         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2477         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2478         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2479     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2480            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2481 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2482     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2483         10  FILLER                            PIC 999.           ELCDTEVR
  2484         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2485         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2486             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2487             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2488         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2489         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2490     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2491            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2492     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2493         10  FILLER                            PIC 999.           ELCDTEVR
  2494         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2495         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2496             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2497             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2498         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2499         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2500     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2501            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2502     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2503         10  FILLER                            PIC 999.           ELCDTEVR
  2504         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2505         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2506             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2507             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2508         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2509         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2510     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2511            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2512 01  WS-RATE-RECORD.                                              ELCDTEVR
  2513         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2514             10  FILLER                        PIC 999.           ELCDTEVR
  2515             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2516             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2517                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2518                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2519             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2520             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2521         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2522                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ECS056.cbl
  2523/
  2524 PROCEDURE DIVISION.
  2525
  2526 0001-DT-CRD-READ SECTION.
* 2527                                 COPY ELCDTERX.
  2528******************************************************************04/15/98
  2529*                                                                *ELCDTERX
  2530*                                                                *ELCDTERX
  2531*                            ELCDTERX.                           *   LV002
  2532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2533*                            VMOD=2.007                          *ELCDTERX
  2534*                                                                *ELCDTERX
  2535*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2536*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2537*      = ELCDTEFD)                                               *ELCDTERX
  2538*                                                                *ELCDTERX
  2539******************************************************************ELCDTERX
  2540                                                                  ELCDTERX
  2541     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2542                                                                  ELCDTERX
  2543     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2544     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2545     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2546                                                                  ELCDTERX
  2547     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2548                                                                  ELCDTERX
  2549******************************************************************ELCDTERX
  2550*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2551*          WARNING MESSAGES.                                      ELCDTERX
  2552******************************************************************ELCDTERX
  2553     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2554         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2555                                                                  ELCDTERX
  2556     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2557                                                                  ELCDTERX
  2558     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2559                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2560                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2561                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2562                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2563                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2564                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2565                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2566                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2567                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2568                                                                  ELCDTERX
  2569     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2570                                                                  ELCDTERX
  2571     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2572                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2573                                                                  ELCDTERX
  2574     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2575     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2576     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2577     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2578                                                                  ELCDTERX
  2579     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2580         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2581     ELSE                                                         ELCDTERX
  2582         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2583                                                                  ELCDTERX
  2584     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2585         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2586     ELSE                                                         ELCDTERX
  2587         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2588                                                                  ELCDTERX
  2589 0005-READ--CARD.                                                 ELCDTERX
  2590     READ DISK-DATE                                               ELCDTERX
  2591         AT END CLOSE DISK-DATE                                   ELCDTERX
  2592             GO TO 0060-READ--TEST.                               ELCDTERX
  2593                                                                  ELCDTERX
  2594     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2595                                                                  ELCDTERX
  2596     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2597         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2598         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2599         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2600         GO TO 0005-READ--CARD.                                   ELCDTERX
  2601                                                                  ELCDTERX
  2602     IF DD-ID = 'CLAD'                                            ELCDTERX
  2603         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2604         GO TO 0005-READ--CARD.                                   ELCDTERX
  2605                                                                  ELCDTERX
  2606     IF DD-ID = 'CLAX'                                            ELCDTERX
  2607         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2608         GO TO 0005-READ--CARD.                                   ELCDTERX
  2609                                                                  ELCDTERX
  2610     IF DD-ID = 'CLAF'                                            ELCDTERX
  2611         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2612         GO TO 0005-READ--CARD.                                   ELCDTERX
  2613                                                                  ELCDTERX
  2614     IF DD-ID = 'CLAC'                                            ELCDTERX
  2615         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2616                                                                  ELCDTERX
  2617     IF DD-ID = 'CARR'                                            ELCDTERX
  2618         GO TO 0015-READ--CARR.                                   ELCDTERX
  2619                                                                  ELCDTERX
  2620     IF DD-ID = 'STAT'                                            ELCDTERX
  2621         GO TO 0020-READ--STAT.                                   ELCDTERX
  2622                                                                  ELCDTERX
  2623     IF DD-ID = 'BUSC'                                            ELCDTERX
  2624         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2625                                                                  ELCDTERX
  2626     IF DD-ID = 'MORT'                                            ELCDTERX
  2627         GO TO 0030-READ--MORT.                                   ELCDTERX
  2628                                                                  ELCDTERX
  2629     IF DD-ID = 'CLAI'                                            ELCDTERX
  2630         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2631                                                                  ELCDTERX
  2632     IF DD-ID = 'COLC'                                            ELCDTERX
  2633         GO TO 0065-READ--COLC.                                   ELCDTERX
  2634                                                                  ELCDTERX
  2635     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2636        DD-IDA = 'CL'                                             ELCDTERX
  2637         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2638                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2639     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2640        DD-IDA = 'PO'                                             ELCDTERX
  2641         GO TO 0050-READ--POXX.                                   ELCDTERX
  2642                                                                  ELCDTERX
  2643     IF DD-ID = 'OPCA'                                            ELCDTERX
  2644         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2645                                                                  ELCDTERX
  2646     IF DD-ID = 'OPST'                                            ELCDTERX
  2647         GO TO 0072-READ--OPST.                                   ELCDTERX
  2648                                                                  ELCDTERX
  2649     IF DD-ID = 'OPBS'                                            ELCDTERX
  2650         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2651                                                                  ELCDTERX
  2652     IF DD-ID = 'OPMS'                                            ELCDTERX
  2653         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2654                                                                  ELCDTERX
  2655     GO TO 0005-READ--CARD.                                       ELCDTERX
  2656                                                                  ELCDTERX
  2657 0010-READ--CLAC.                                                 ELCDTERX
  2658     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2659     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2660     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2661     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2662     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2663     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2664     GO TO 0005-READ--CARD.                                       ELCDTERX
  2665                                                                  ELCDTERX
  2666 0015-READ--CARR.                                                 ELCDTERX
  2667     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2668     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2669        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2670        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2671        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2672        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2673        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2674        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2675        MOVE DD-CARR1-SECPAY-SW
  2676                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2677     END-IF
  2678                                                                  ELCDTERX
  2679     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2680     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2681        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2682        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2683        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2684        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2685        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2686        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2687        MOVE DD-CARR2-SECPAY-SW
  2688                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2689     END-IF
  2690                                                                  ELCDTERX
  2691                                                                  ELCDTERX
  2692     GO TO 0005-READ--CARD.                                       ELCDTERX
  2693                                                                  ELCDTERX
  2694 0020-READ--STAT.                                                 ELCDTERX
  2695     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2696     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2697        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2698         GO TO 0005-READ--CARD.                                   ELCDTERX
  2699                                                                  ELCDTERX
  2700     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2701     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2702     GO TO 0020-READ--STAT.                                       ELCDTERX
  2703                                                                  ELCDTERX
  2704 0025-READ--BUSC.                                                 ELCDTERX
  2705     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2706     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2707        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2708         GO TO 0005-READ--CARD.                                   ELCDTERX
  2709                                                                  ELCDTERX
  2710     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2711     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2712     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2713                                                                  ELCDTERX
  2714 0030-READ--MORT.                                                 ELCDTERX
  2715     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2716     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2717        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2718         GO TO 0005-READ--CARD.                                   ELCDTERX
  2719                                                                  ELCDTERX
  2720     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2721     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2722     GO TO 0030-READ--MORT.                                       ELCDTERX
  2723                                                                  ELCDTERX
  2724 0035-READ--CLXX.                                                 ELCDTERX
  2725     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2726          GO TO 0005-READ--CARD.                                  ELCDTERX
  2727                                                                  ELCDTERX
  2728     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2729         DISPLAY '***********************************************'ELCDTERX
  2730         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2731         DISPLAY '***********************************************'ELCDTERX
  2732         GO TO 0055-READ--STOP.                                   ELCDTERX
  2733                                                                  ELCDTERX
  2734     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2735        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2736         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2737                                                                  ELCDTERX
  2738     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2739        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2740         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2741                                                                  ELCDTERX
  2742*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2743     GO TO 0005-READ--CARD.                                       ELCDTERX
  2744                                                                  ELCDTERX
  2745 0040-READ--CLAI.                                                 ELCDTERX
  2746     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2747     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2748        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2749         GO TO 0005-READ--CARD.                                   ELCDTERX
  2750                                                                  ELCDTERX
  2751     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2752     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2753     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2754                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2755 0045-READ--DUMP.                                                 ELCDTERX
  2756     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2757     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2758                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2759     PERFORM ABEND-PGM.                                           ELCDTERX
  2760                                                                  ELCDTERX
  2761 0050-READ--POXX.                                                 ELCDTERX
  2762     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2763         GO TO 0005-READ--CARD.                                   ELCDTERX
  2764                                                                  ELCDTERX
  2765     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2766         DISPLAY '***********************************************'ELCDTERX
  2767         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2768         DISPLAY '***********************************************'ELCDTERX
  2769         GO TO 0055-READ--STOP.                                   ELCDTERX
  2770                                                                  ELCDTERX
  2771     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2772     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2773     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2774     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2775                                                                  ELCDTERX
  2776     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2777         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2778     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2779         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2780                                                                  ELCDTERX
  2781     GO TO 0005-READ--CARD.                                       ELCDTERX
  2782                                                                  ELCDTERX
  2783 0055-READ--STOP.                                                 ELCDTERX
  2784     GOBACK.                                                      ELCDTERX
  2785                                                                  ELCDTERX
  2786 0060-READ--TEST.                                                 ELCDTERX
  2787     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2788        CLAX-ID         = SPACE  OR                               ELCDTERX
  2789        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2790         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2791                                                                  ELCDTERX
  2792     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2793     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2794                                                                  ELCDTERX
  2795 0065-READ--COLC.                                                 ELCDTERX
  2796     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2797     GO TO 0005-READ--CARD.                                       ELCDTERX
  2798                                                                  ELCDTERX
  2799 0070-READ--OPCA.                                                 ELCDTERX
  2800                                                                  ELCDTERX
  2801     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2802                                                                  ELCDTERX
  2803     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2804             OR                                                   ELCDTERX
  2805         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2806         GO TO 0005-READ--CARD.                                   ELCDTERX
  2807                                                                  ELCDTERX
  2808     ADD 1                       TO INDEXCA.                      ELCDTERX
  2809     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2810                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2811     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2812                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2813 0072-READ--OPST.                                                 ELCDTERX
  2814                                                                  ELCDTERX
  2815     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2816                                                                  ELCDTERX
  2817     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2818             OR                                                   ELCDTERX
  2819         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2820         GO TO 0005-READ--CARD.                                   ELCDTERX
  2821                                                                  ELCDTERX
  2822     ADD 1                       TO INDEXST.                      ELCDTERX
  2823     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2824                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2825     GO TO 0072-READ--OPST.                                       ELCDTERX
  2826                                                                  ELCDTERX
  2827 0074-READ--OPBS.                                                 ELCDTERX
  2828                                                                  ELCDTERX
  2829     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2830                                                                  ELCDTERX
  2831     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2832             OR                                                   ELCDTERX
  2833         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2834         GO TO 0005-READ--CARD.                                   ELCDTERX
  2835                                                                  ELCDTERX
  2836     ADD 1                       TO INDEXBS.                      ELCDTERX
  2837     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2838     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2839                                                                  ELCDTERX
  2840 0079-READ--EXIT.                                                 ELCDTERX
  2841*    EXIT.                                                        ELCDTERX
  2842******************************************************************ELCDTERX
  2843
  2844     MOVE COMPANY-NAME           TO  HD-CO
  2845     MOVE ALPH-DATE              TO  HD-DT
  2846     MOVE WS-CURRENT-DATE        TO  HD-RUN-DT
  2847     MOVE RUN-DATE               TO WS-THIS-MONTH-DATE
  2848
  2849     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2850
  2851     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2852
  2853     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  2854
  2855     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2856
  2857     GOBACK
  2858     .
  2859
  2860 0010-INITIALIZE.
  2861
  2862     MOVE +0                     TO WS-EXP-PREM
  2863                                    WS-REC-PREM
  2864                                    WS-GA-COMM
  2865                                    WS-BASE-COMM
  2866                                    WS-REC-BASE-COMM
  2867
  2868     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  2869        (WS-A > +5)
  2870        MOVE +0                  TO WS-TOT-EXP-PREM (WS-A)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ECS056.cbl
  2871                                    WS-TOT-REC-PREM (WS-A)
  2872                                    WS-TOT-GA-COMM (WS-A)
  2873     END-PERFORM
  2874     MOVE LOW-VALUES             TO WS-ERPYAJ-KEY
  2875
  2876     PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
  2877        (WS-PYAJ-INDEX > +500)
  2878        MOVE LOW-VALUES          TO WS-DA-KEY (WS-PYAJ-INDEX)
  2879        MOVE +0                  TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
  2880     END-PERFORM
  2881
  2882     MOVE +0                     TO WS-PYAJ-INDEX
  2883     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
  2884     MOVE -1                     TO DC-ELAPSED-MONTHS
  2885     MOVE '1'                    TO DC-END-OF-MONTH
  2886     MOVE +0                     TO DC-ELAPSED-DAYS
  2887     MOVE '6'                    TO DC-OPTION-CODE
  2888     PERFORM 8510-DATE-CONVERSION
  2889                                 THRU 8590-EXIT
  2890     IF NO-CONVERSION-ERROR
  2891        MOVE DC-GREG-DATE-CYMD   TO WS-LAST-MONTH-DATE
  2892        MOVE DC-BIN-DATE-2       TO WS-BIN-LAST-MONTH-DT
  2893        DISPLAY ' LAST MONTH IS ' WS-LAST-MONTH-DATE
  2894     ELSE
  2895        DISPLAY ' ERROR IN LAST MONTH DATE CONVERSION '
  2896     END-IF
  2897
  2898     MOVE RUN-DATE               TO WS-WORK-DATE
  2899     MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
  2900     MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
  2901
  2902     .
  2903
  2904 0010-EXIT.
  2905     EXIT.
  2906
  2907 0020-OPEN-FILES.
  2908
  2909     OPEN INPUT CERTS
  2910                ERPYAJ
  2911         OUTPUT EXTRACT PRINTX DEBUG-EXTRACT
  2912         I-O ERDUEP
  2913
  2914     IF ERDUEP-FILE-STATUS = '00' OR '97'
  2915        CONTINUE
  2916     ELSE
  2917        DISPLAY ' ERROR ON ERDUEP OPEN  '
  2918           ERDUEP-FILE-STATUS
  2919        MOVE ' ERROR ON ERDUEP OPEN  '
  2920                                 TO WS-ABEND-MESSAGE
  2921        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2922        PERFORM ABEND-PGM
  2923     END-IF
  2924
  2925     IF ERPYAJ-FILE-STATUS = '00' OR '97'
  2926        CONTINUE
  2927     ELSE
  2928        DISPLAY ' ERROR ON ERPYAJ OPEN  '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ECS056.cbl
  2929           ERPYAJ-FILE-STATUS
  2930        MOVE ' ERROR ON ERPYAJ OPEN  '
  2931                                 TO WS-ABEND-MESSAGE
  2932        MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2933        PERFORM ABEND-PGM
  2934     END-IF
  2935
  2936     MOVE SPACES                 TO EXTRACT-RECORD
  2937     MOVE ';'                    TO WS-TAB1  WS-TAB2  WS-TAB3
  2938                                    WS-TAB4  WS-TAB5  WS-TAB6
  2939                                    WS-TAB7  WS-TAB8  WS-TAB9
  2940                                    WS-TAB10 WS-TAB11 WS-TAB12
  2941                                    WS-TAB13 WS-TAB14 WS-TAB15
  2942                                    WS-TAB16 WS-TAB17 WS-TAB18
  2943                                    WS-TAB19 WS-TAB20 WS-TAB21
  2944                                    WS-TAB22 WS-TAB23
  2945
  2946     MOVE ZEROS                  TO EXT-MISC1
  2947                                    EXT-MISC2
  2948                                    EXT-MISC3
  2949                                    EXT-MISC4
  2950                                    EXT-MISC5
  2951
  2952     MOVE EXTRACT-RECORD         TO WS-INIT-EXTRACT
  2953
  2954     MOVE SPACES                 TO DEBUG-EXTRACT-RECORD
  2955     MOVE ';'                    TO DB-TAB1  DB-TAB2  DB-TAB3
  2956                                    DB-TAB4  DB-TAB5  DB-TAB6
  2957                                    DB-TAB7  DB-TAB8  DB-TAB9
  2958                                    DB-TAB10 DB-TAB11 DB-TAB12
  2959                                    DB-TAB13 DB-TAB14 DB-TAB15
  2960                                    DB-TAB16 DB-TAB17
  2961
  2962     MOVE DEBUG-EXTRACT-RECORD   TO WS-INIT-DB-EXTRACT
  2963
  2964     .
  2965 0020-EXIT.
  2966     EXIT.
  2967
  2968 0030-CLOSE-FILES.
  2969
  2970     DISPLAY ' MADE IT TO CLOSE FILES '
  2971     CLOSE CERTS PRINTX
  2972         EXTRACT ERDUEP DEBUG-EXTRACT
  2973
  2974     IF ERDUEP-FILE-STATUS = '00' OR '97'
  2975        CONTINUE
  2976     ELSE
  2977        DISPLAY ' ERROR ON ERDUEP CLOSE '
  2978           ERDUEP-FILE-STATUS
  2979        MOVE ' ERROR ON ERDUEP OPEN  '
  2980                                 TO WS-ABEND-MESSAGE
  2981        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2982        PERFORM ABEND-PGM
  2983     END-IF
  2984
  2985
  2986     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ECS056.cbl
  2987
  2988 0030-EXIT.
  2989     EXIT.
  2990
  2991 0042-START-ERPYAJ.
  2992
  2993     MOVE LOW-VALUES             TO PY-CONTROL-PRIMARY
  2994     MOVE DTE-CLASIC-COMPANY-CD  TO PY-COMPANY-CD
  2995
  2996     START ERPYAJ KEY IS NOT < PY-CONTROL-PRIMARY
  2997
  2998     IF ERPYAJ-FILE-STATUS = '10' OR '23'
  2999        SET END-OF-FILE          TO TRUE
  3000     ELSE
  3001        IF ERPYAJ-FILE-STATUS NOT = '00'
  3002           MOVE ' ERROR ON ERPYAJ START '
  3003                                 TO WS-ABEND-MESSAGE
  3004           MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3005           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3006           PERFORM ABEND-PGM
  3007        ELSE
  3008           DISPLAY ' GOOD START ON ERPYAJ '
  3009        END-IF
  3010     END-IF
  3011
  3012     .
  3013 0042-EXIT.
  3014     EXIT.
  3015
  3016 0043-READ-ERPYAJ.
  3017
  3018     READ ERPYAJ NEXT RECORD
  3019
  3020     IF (ERPYAJ-FILE-STATUS = '10' OR '23')
  3021        OR (PY-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
  3022        SET END-OF-FILE          TO TRUE
  3023     ELSE
  3024        IF ERPYAJ-FILE-STATUS NOT = '00'
  3025           MOVE ' ERROR ON ERPYAJ READ  '
  3026                                 TO WS-ABEND-MESSAGE
  3027           MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3028           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3029           PERFORM ABEND-PGM
  3030        ELSE
  3031           DISPLAY ' GOOD READ ON ERPYAJ ' PY-CONTROL-PRIMARY
  3032        END-IF
  3033     END-IF
  3034
  3035     .
  3036 0043-EXIT.
  3037     EXIT.
  3038
  3039 0045-PROCESS-ERPYAJ.
  3040
  3041     IF PY-RECORD-TYPE = 'P'
  3042        ADD +1                   TO WS-PYAJ-INDEX
  3043        MOVE PY-CONTROL-PRIMARY  TO WS-DA-KEY (WS-PYAJ-INDEX)
  3044        MOVE PY-ENTRY-AMT        TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ECS056.cbl
  3045*       DISPLAY ' FOUND A HIT '
  3046     END-IF
  3047
  3048     PERFORM 0043-READ-ERPYAJ    THRU 0043-EXIT
  3049
  3050     .
  3051 0045-EXIT.
  3052     EXIT.
  3053
  3054 0050-PROCESS-FILE.
  3055
  3056     PERFORM 0042-START-ERPYAJ   THRU 0042-EXIT
  3057     IF NOT END-OF-FILE
  3058        PERFORM 0043-READ-ERPYAJ THRU 0043-EXIT
  3059     END-IF
  3060
  3061     PERFORM 0045-PROCESS-ERPYAJ THRU 0045-EXIT UNTIL
  3062        END-OF-FILE
  3063     MOVE WS-PYAJ-INDEX          TO WS-PYAJ-MAX
  3064
  3065     CLOSE ERPYAJ
  3066
  3067     IF ERPYAJ-FILE-STATUS = '00' OR '97'
  3068        CONTINUE
  3069     ELSE
  3070        MOVE ' ERROR ON ERPYAJ CLOSE '
  3071                                 TO WS-ABEND-MESSAGE
  3072        MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3073        DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3074        PERFORM ABEND-PGM
  3075     END-IF
  3076
  3077     SET MORE-RECORDS            TO TRUE
  3078     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3079     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  3080     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  3081           END-OF-FILE
  3082
  3083     PERFORM 0150-UPDATE-DUEP    THRU 0150-EXIT
  3084     PERFORM 0300-ACCT-BREAK     THRU 0300-EXIT
  3085     PERFORM 0310-ST-BREAK       THRU 0310-EXIT
  3086     PERFORM 0320-GRP-BREAK      THRU 0320-EXIT
  3087     PERFORM 0330-CAR-BREAK      THRU 0330-EXIT
  3088     PERFORM 0340-FIN-BREAK      THRU 0340-EXIT
  3089
  3090     .
  3091
  3092 0050-EXIT.
  3093     EXIT.
  3094
  3095 0060-READ-CERT.
  3096
  3097     READ CERTS AT END
  3098         SET END-OF-FILE         TO TRUE
  3099     END-READ
  3100
  3101     IF NOT END-OF-FILE
  3102        ADD +1                   TO CERT-IN-CNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ECS056.cbl
  3103        MOVE ' '                 TO WS-GIANT-SW
  3104     END-IF
  3105     .
  3106
  3107 0060-EXIT.
  3108     EXIT.
  3109
  3110 0080-PROCESS-CERT.
  3111
  3112     IF CR-LFTYP NOT = '  ' AND ZEROS
  3113        PERFORM 0207-FIND-LIFE-TYPE
  3114                                 THRU 0207-EXIT
  3115     END-IF
  3116
  3117     IF CR-AHTYP NOT = '  ' AND ZEROS
  3118        PERFORM 0208-FIND-AH-TYPE
  3119                                 THRU 0208-EXIT
  3120     END-IF
  3121
  3122     IF (CR-LFTYP = 'MJ' OR 'MS'
  3123         OR 'NJ' OR 'NL'
  3124         OR 'SJ' OR 'SL')
  3125        OR (CR-AHTYP =
  3126               'MJ' OR 'MS' OR 'MI' OR 'MU'
  3127            OR 'NI' OR 'NJ' OR 'NL' OR 'NU'
  3128            OR 'SI' OR 'SJ' OR 'SL' OR 'SU'
  3129            OR 'MX' OR 'MY' OR 'MZ')
  3130        IF (CR-ENTRY-DATE = WS-THIS-MONTH-DATE)
  3131           OR (CR-LF-CANCEL-EXIT-DATE = WS-THIS-MONTH-DATE)
  3132           OR (CR-AH-CANCEL-EXIT-DATE = WS-THIS-MONTH-DATE)
  3133           SET THIS-IS-A-GIANT-CERT TO TRUE
  3134        ELSE
  3135           MOVE 'V'              TO CR-ENTRY-STATUS
  3136        END-IF
  3137     END-IF
  3138
  3139     IF CR-ACCT-CONTROL NOT = WS-HOLD-CONTROL
  3140        PERFORM 0250-BREAK-RTN   THRU 0250-EXIT
  3141     END-IF
  3142
  3143     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  3144     MOVE CR-DT                  TO WS-ISSUE-DATE
  3145
  3146     IF (CR-ENTRY-STATUS = '9' OR 'D' OR 'V')
  3147                 OR
  3148        ((CR-LFTYP (1:1) NOT = 'M' AND 'N' AND 'S')
  3149        AND (CR-AHTYP (1:1) NOT = 'M' AND 'N' AND 'S'))
  3150        CONTINUE
  3151     ELSE
  3152        IF CR-ENTRY-STATUS NOT = '5'
  3153           PERFORM 0200-CALC-UEP THRU 0200-EXIT
  3154           PERFORM 0090-FIND-ADJ THRU 0090-EXIT
  3155        END-IF
  3156     END-IF
  3157
  3158     IF (WS-EXP-PREM NOT = +0)
  3159        OR (WS-REC-PREM NOT = +0)
  3160        OR (WS-GA-COMM NOT = +0)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ECS056.cbl
  3161        PERFORM 0100-WRITE-EXTRACT
  3162                                 THRU 0100-EXIT
  3163     END-IF
  3164
  3165     MOVE +0                     TO WS-EXP-PREM
  3166                                    WS-REC-PREM
  3167                                    WS-GA-COMM
  3168                                    WS-BASE-COMM
  3169                                    WS-REC-BASE-COMM
  3170
  3171     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3172
  3173     .
  3174
  3175 0080-EXIT.
  3176     EXIT.
  3177
  3178 0090-FIND-ADJ.
  3179
  3180     MOVE CR-COMPANY-CD          TO WS-PYAJ-MATCH-KEY (1:1)
  3181     MOVE CR-CARRIER             TO WS-PYAJ-MATCH-KEY (2:1)
  3182     MOVE CR-GROUPING            TO WS-PYAJ-MATCH-KEY (3:6)
  3183     IF CR-REMIT-TO NOT NUMERIC
  3184        MOVE ZEROS               TO CR-REMIT-TO
  3185     END-IF
  3186     IF CR-REMIT-TO = ZEROS
  3187        MOVE 01                  TO CR-REMIT-TO
  3188     END-IF
  3189     MOVE CR-COM-AGT (CR-REMIT-TO)
  3190                                 TO WS-PYAJ-MATCH-KEY (9:10)
  3191     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  3192        (WS-A > +10)
  3193        OR (CR-AGT-TYPE (WS-A) = 'D' OR 'C')
  3194     END-PERFORM
  3195
  3196     IF WS-A < +11
  3197        MOVE CR-COM-AGT (WS-A)   TO WS-PYAJ-MATCH-KEY (19:10)
  3198     ELSE
  3199        MOVE CR-ACCOUNT          TO WS-PYAJ-MATCH-KEY (19:10)
  3200     END-IF
  3201*    MOVE +0                     TO WS-DP-ADJ
  3202*    DISPLAY ' CERT KEY TO MATCH ' WS-PYAJ-MATCH-KEY
  3203     PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
  3204        (WS-PYAJ-INDEX > WS-PYAJ-MAX)
  3205        IF WS-DA-KEY (WS-PYAJ-INDEX) (1:28) = WS-PYAJ-MATCH-KEY
  3206           COMPUTE WS-DP-ADJ
  3207              = WS-DP-ADJ + WS-DA-AMOUNT (WS-PYAJ-INDEX)
  3208           MOVE LOW-VALUES       TO WS-DA-KEY (WS-PYAJ-INDEX)
  3209        END-IF
  3210     END-PERFORM
  3211
  3212     .
  3213 0090-EXIT.
  3214     EXIT.
  3215
  3216
  3217 0100-WRITE-EXTRACT.
  3218
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ECS056.cbl
  3219     MOVE WS-INIT-EXTRACT        TO EXTRACT-RECORD
  3220
  3221     COMPUTE WS-TOT-EXP-PREM (1) = WS-TOT-EXP-PREM (1)
  3222        + WS-EXP-PREM
  3223
  3224     COMPUTE WS-TOT-REC-PREM (1) = WS-TOT-REC-PREM (1)
  3225        + WS-REC-PREM
  3226
  3227     COMPUTE WS-TOT-BASE-COMM (1) = WS-TOT-BASE-COMM (1)
  3228        + WS-BASE-COMM
  3229
  3230     COMPUTE WS-TOT-GA-COMM (1) = WS-TOT-GA-COMM (1)
  3231        + WS-GA-COMM
  3232
  3233     MOVE CR-CARRIER             TO EXT-CAR
  3234     MOVE CR-GROUPING            TO EXT-GROUP
  3235     MOVE CR-STATE               TO EXT-STATE
  3236     MOVE CR-ACCOUNT             TO EXT-ACCOUNT
  3237     MOVE CR-DT                  TO WS-ISSUE-DATE
  3238     MOVE WS-ISSUE-MMDD (1:2)    TO EXT-EFF-DATE (1:2)
  3239     MOVE '-'                    TO EXT-EFF-DATE (3:1)
  3240                                    EXT-EFF-DATE (6:1)
  3241     MOVE WS-ISSUE-MMDD (3:2)    TO EXT-EFF-DATE (4:2)
  3242     MOVE WS-ISSUE-CCYY          TO EXT-EFF-DATE (7:4)
  3243     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  3244     MOVE WS-ENTRY-MMDD (1:2)    TO EXT-ENT-DATE (1:2)
  3245     MOVE '-'                    TO EXT-ENT-DATE (3:1)
  3246                                    EXT-ENT-DATE (6:1)
  3247     MOVE WS-ENTRY-MMDD (3:2)    TO EXT-ENT-DATE (4:2)
  3248     MOVE WS-ENTRY-CCYY          TO EXT-ENT-DATE (7:4)
  3249     MOVE RUN-DATE               TO WS-ENTRY-DATE
  3250     MOVE WS-ENTRY-MMDD (1:2)    TO EXT-VAL-DATE (1:2)
  3251     MOVE '-'                    TO EXT-VAL-DATE (3:1)
  3252                                    EXT-VAL-DATE (6:1)
  3253     MOVE WS-ENTRY-MMDD (3:2)    TO EXT-VAL-DATE (4:2)
  3254     MOVE WS-ENTRY-CCYY          TO EXT-VAL-DATE (7:4)
  3255
  3256     MOVE WS-EARN-TERM           TO EXT-EARN-TERM
  3257     MOVE CR-CERT-NO             TO EXT-CERT-NO
  3258     MOVE CR-LFTYP               TO EXT-LF-BEN-CODE
  3259     MOVE CR-AHTYP               TO EXT-AH-BEN-CODE
  3260     MOVE CR-LF-TERM             TO EXT-LF-TERM
  3261     MOVE CR-AH-TERM             TO EXT-AH-TERM
  3262     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  3263     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-LF-EXP-DATE (1:2)
  3264     MOVE '-'                    TO EXT-LF-EXP-DATE (3:1)
  3265                                    EXT-LF-EXP-DATE (6:1)
  3266     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-LF-EXP-DATE (4:2)
  3267     MOVE WS-EXPIRE-CCYY         TO EXT-LF-EXP-DATE (7:4)
  3268
  3269     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  3270     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-AH-EXP-DATE (1:2)
  3271     MOVE '-'                    TO EXT-AH-EXP-DATE (3:1)
  3272                                    EXT-AH-EXP-DATE (6:1)
  3273     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-AH-EXP-DATE (4:2)
  3274     MOVE WS-EXPIRE-CCYY         TO EXT-AH-EXP-DATE (7:4)
  3275     MOVE WS-EXP-PREM            TO EXT-EXP-PREM
  3276     MOVE WS-REC-PREM            TO EXT-REC-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ECS056.cbl
  3277     MOVE WS-BASE-COMM           TO EXT-BASE-COMM
  3278
  3279*    IF WS-BASE-COMM > ZEROS
  3280*       MOVE WS-BASE-COMM        TO EXT-BASE-COMM
  3281*    ELSE
  3282*       MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
  3283*    END-IF
  3284
  3285     MOVE WS-GA-COMM             TO EXT-GA-COMM
  3286
  3287     WRITE EXTRACT-RECORD
  3288     PERFORM 0125-ACCUM-DUEP     THRU 0125-EXIT
  3289
  3290     .
  3291
  3292 0100-EXIT.
  3293     EXIT.
  3294 0125-ACCUM-DUEP.
  3295
  3296     IF (WS-DUEP-CONTROL NOT = LOW-VALUES)
  3297        AND (WS-DUEP-CONTROL NOT = CR-ACCT-CONTROL)
  3298        PERFORM 0150-UPDATE-DUEP  THRU 0150-EXIT
  3299        MOVE +0                  TO WS-DP-REC-PREM
  3300                                    WS-DP-EXP-PREM
  3301                                    WS-DP-GA-COMM
  3302                                    WS-DP-BASE-COMM
  3303                                    WS-DP-ADJ
  3304     END-IF
  3305
  3306     MOVE CR-ACCT-CONTROL        TO WS-DUEP-CONTROL
  3307
  3308     COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM + WS-REC-PREM
  3309     COMPUTE WS-DP-EXP-PREM = WS-DP-EXP-PREM + WS-EXP-PREM
  3310     COMPUTE WS-DP-GA-COMM = WS-DP-GA-COMM + WS-GA-COMM
  3311     COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-BASE-COMM
  3312
  3313
  3314
  3315     .
  3316 0125-EXIT.
  3317     EXIT.
  3318
  3319 0150-UPDATE-DUEP.
  3320
  3321     MOVE DTE-CLASIC-COMPANY-CD  TO DP-COMPANY-CD
  3322     MOVE WS-DUEP-CONTROL        TO DP-ACCOUNT-CONTROL
  3323     MOVE LOW-VALUES             TO DP-KEY-FILLER
  3324     READ ERDUEP
  3325     IF ERDUEP-FILE-STATUS = '00'
  3326*       COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
  3327        MOVE WS-DP-REC-PREM      TO DP-REC-PREM
  3328        MOVE WS-DP-EXP-PREM      TO DP-EXP-PREM
  3329        MOVE WS-DP-GA-COMM       TO DP-GA-COMM
  3330        MOVE WS-DP-BASE-COMM     TO DP-BASE-COMM
  3331        MOVE WS-DP-ADJ           TO DP-ADJUSTMENTS
  3332        IF DP-LAST-MONTH-END-DT NOT = BIN-RUN-DATE
  3333*  NEED TO THINK ABOUT THE AGEING STUFF RIGHT HERE
  3334           MOVE DP-END-BAL       TO DP-BAL-FWD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ECS056.cbl
  3335           MOVE BIN-RUN-DATE     TO DP-LAST-MONTH-END-DT
  3336        END-IF
  3337        COMPUTE DP-END-BAL = DP-BAL-FWD + DP-EXP-PREM
  3338           - DP-REC-PREM + DP-ADJUSTMENTS
  3339        REWRITE DUE-PREMIUM-RECORD
  3340     ELSE
  3341        IF ERDUEP-FILE-STATUS = '23'
  3342           MOVE DTE-CLASIC-COMPANY-CD
  3343                                 TO DP-COMPANY-CD
  3344           MOVE WS-DUEP-CONTROL  TO DP-ACCOUNT-CONTROL
  3345           MOVE +0               TO DP-BAL-FWD
  3346                                    DP-ADJUSTMENTS
  3347                                    DP-END-BAL
  3348           MOVE WS-DP-REC-PREM   TO DP-REC-PREM
  3349           MOVE WS-DP-EXP-PREM   TO DP-EXP-PREM
  3350           MOVE WS-DP-GA-COMM    TO DP-GA-COMM
  3351           MOVE WS-DP-BASE-COMM  TO DP-BASE-COMM
  3352           MOVE WS-DP-ADJ        TO DP-ADJUSTMENTS
  3353           COMPUTE DP-END-BAL = DP-BAL-FWD + DP-EXP-PREM
  3354              - DP-REC-PREM + DP-ADJUSTMENTS
  3355           MOVE BIN-RUN-DATE     TO DP-LAST-MONTH-END-DT
  3356           WRITE DUE-PREMIUM-RECORD
  3357        END-IF
  3358     END-IF
  3359
  3360
  3361     .
  3362 0150-EXIT.
  3363     EXIT.
  3364
  3365
  3366 0200-CALC-UEP.
  3367
  3368     MOVE LOW-VALUES             TO WS-BIN-AH-END-DATE
  3369                                    WS-BIN-LF-END-DATE
  3370
  3371     IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3372        CONTINUE
  3373     ELSE
  3374        PERFORM VARYING CLAS-INDEXS FROM +1 BY +1 UNTIL
  3375            (CLAS-INDEXS = CLAS-MAXS) OR
  3376            CR-STATE = STATE-SUB (CLAS-INDEXS)
  3377        END-PERFORM
  3378        IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3379           CONTINUE
  3380        ELSE
  3381           DISPLAY 'STATE ' CR-STATE ' NOT IN TABLE'
  3382           MOVE 0302 TO WS-RETURN-CODE
  3383           PERFORM ABEND-PGM
  3384        END-IF
  3385     END-IF
  3386
  3387     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  3388     MOVE 'L'                    TO DC-OPTION-CODE
  3389     PERFORM 8510-DATE-CONVERSION
  3390                                 THRU 8590-EXIT
  3391     MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  3392                                    WS-BIN-CR-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ECS056.cbl
  3393
  3394     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  3395        MOVE ZEROS               TO CR-LOAN-1ST-PMT-DT
  3396     END-IF
  3397
  3398     MOVE LOW-VALUES             TO CP-FIRST-PAY-DATE
  3399
  3400     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  3401        MOVE CR-LOAN-1ST-PMT-DT  TO DC-GREG-DATE-1-YMD
  3402        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  3403                                    DC-ELAPSED-DAYS
  3404        MOVE '3'                 TO DC-OPTION-CODE
  3405        PERFORM 8510-DATE-CONVERSION
  3406                                 THRU 8590-EXIT
  3407        IF NO-CONVERSION-ERROR
  3408           MOVE DC-BIN-DATE-1   TO CP-FIRST-PAY-DATE
  3409                                   WS-BIN-1ST-DT
  3410        ELSE
  3411           MOVE ZEROS           TO CR-LOAN-1ST-PMT-DT
  3412        END-IF
  3413      END-IF
  3414
  3415     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  3416        MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT
  3417     END-IF
  3418
  3419     IF CR-LOAN-1ST-PMT-DT = ZEROS
  3420        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  3421        MOVE +1                  TO DC-ELAPSED-MONTHS
  3422        MOVE ZEROS               TO DC-ELAPSED-DAYS
  3423        MOVE '6'                 TO DC-OPTION-CODE
  3424        PERFORM 8510-DATE-CONVERSION
  3425                                 THRU 8590-EXIT
  3426        MOVE DC-BIN-DATE-2       TO CP-FIRST-PAY-DATE
  3427                                    WS-BIN-1ST-DT
  3428        MOVE DC-GREG-DATE-1-YMD  TO CR-LOAN-1ST-PMT-DT
  3429     END-IF
  3430
  3431     MOVE WS-BIN-CR-DT           TO DC-BIN-DATE-1
  3432     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-2
  3433     MOVE '1'                    TO DC-OPTION-CODE
  3434     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  3435                                    DC-ELAPSED-DAYS
  3436     PERFORM 8510-DATE-CONVERSION
  3437                                 THRU 8590-EXIT
  3438     IF NO-CONVERSION-ERROR
  3439        MOVE DC-ELAPSED-DAYS     TO WS-DAYS-TO-1ST
  3440     ELSE
  3441        MOVE +30                 TO WS-DAYS-TO-1ST
  3442     END-IF
  3443
  3444     MOVE CR-LF-EXPIRE-DATE      TO WS-WORK-DATE
  3445
  3446     MOVE LOW-VALUES             TO WS-BIN-LF-CAN-DATE
  3447     MOVE +0                     TO WS-LF-CAN-TERM
  3448     MOVE 'N'                    TO WS-LF-CAN-QUAL-SW
  3449
  3450     IF CR-LF-CANC-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ECS056.cbl
  3451        MOVE CR-LF-CANC-DT       TO DC-GREG-DATE-CYMD
  3452        MOVE 'L'                 TO DC-OPTION-CODE
  3453        PERFORM 8510-DATE-CONVERSION
  3454                                 THRU 8590-EXIT
  3455        IF NO-CONVERSION-ERROR
  3456           MOVE DC-BIN-DATE-1    TO WS-BIN-LF-CAN-DATE
  3457        ELSE
  3458           MOVE LOW-VALUES       TO WS-BIN-LF-CAN-DATE
  3459        END-IF
  3460        MOVE BIN-RUN-DATE        TO DC-BIN-DATE-2
  3461        MOVE '1'                 TO DC-OPTION-CODE
  3462        MOVE +0                  TO DC-ELAPSED-MONTHS
  3463                                    DC-ELAPSED-DAYS
  3464        PERFORM 8510-DATE-CONVERSION
  3465                                 THRU 8590-EXIT
  3466        IF NO-CONVERSION-ERROR
  3467           MOVE DC-ELAPSED-MONTHS
  3468                                 TO WS-LF-CAN-TERM
  3469           IF (WS-LF-CAN-TERM > +0)
  3470              AND (WS-BIN-LF-CAN-DATE > WS-BIN-1ST-DT)
  3471              SUBTRACT +1        FROM WS-LF-CAN-TERM
  3472           END-IF
  3473           IF (WS-LF-CAN-TERM > +0)
  3474              AND (WS-THIS-MONTH-DATE = CR-LF-CANCEL-EXIT-DATE)
  3475              SET CREDIT-LF-CANCEL TO TRUE
  3476           END-IF
  3477        END-IF
  3478     END-IF
  3479
  3480*    IF (CR-LF-CANC-DT NOT = ZEROS) AND
  3481*       (CR-LF-CANC-DT < WS-WORK-DATE)
  3482*       MOVE CR-LF-CANC-DT           TO WS-WORK-DATE
  3483*    END-IF
  3484
  3485     IF (CR-LF-CANCEL-EXIT-DATE NOT = ZEROS)
  3486        AND (CR-LF-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3487        MOVE CR-LF-CANCEL-EXIT-DATE
  3488                                 TO WS-WORK-DATE
  3489     END-IF
  3490
  3491     IF (CR-LF-CLAIM-EXIT-DATE NOT = ZEROS) AND
  3492        (CR-LF-CLAIM-EXIT-DATE < WS-WORK-DATE)
  3493        MOVE CR-LF-CLAIM-EXIT-DATE   TO WS-WORK-DATE
  3494     END-IF
  3495
  3496     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3497     MOVE 'L'                    TO DC-OPTION-CODE
  3498     PERFORM 8510-DATE-CONVERSION
  3499                                 THRU 8590-EXIT
  3500     IF NO-CONVERSION-ERROR
  3501        MOVE DC-BIN-DATE-1       TO WS-BIN-LF-END-DATE
  3502     ELSE
  3503        DISPLAY ' NO LIFE COVERAGE ?? ' CR-ACCT-CONTROL
  3504           '   ' CR-CERT-NO
  3505     END-IF
  3506
  3507     MOVE CR-AH-EXPIRE-DATE          TO WS-WORK-DATE
  3508
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ECS056.cbl
  3509     MOVE LOW-VALUES             TO WS-BIN-AH-CAN-DATE
  3510     MOVE +0                     TO WS-AH-CAN-TERM
  3511     MOVE 'N'                    TO WS-AH-CAN-QUAL-SW
  3512
  3513     IF CR-AH-CANC-DT NOT = ZEROS
  3514        MOVE CR-AH-CANC-DT       TO DC-GREG-DATE-CYMD
  3515        MOVE 'L'                 TO DC-OPTION-CODE
  3516        PERFORM 8510-DATE-CONVERSION
  3517                                 THRU 8590-EXIT
  3518        IF NO-CONVERSION-ERROR
  3519           MOVE DC-BIN-DATE-1    TO WS-BIN-AH-CAN-DATE
  3520        ELSE
  3521           MOVE LOW-VALUES       TO WS-BIN-AH-CAN-DATE
  3522        END-IF
  3523        MOVE BIN-RUN-DATE        TO DC-BIN-DATE-2
  3524        MOVE '1'                 TO DC-OPTION-CODE
  3525        MOVE +0                  TO DC-ELAPSED-MONTHS
  3526                                    DC-ELAPSED-DAYS
  3527        PERFORM 8510-DATE-CONVERSION
  3528                                 THRU 8590-EXIT
  3529        IF NO-CONVERSION-ERROR
  3530           MOVE DC-ELAPSED-MONTHS
  3531                                 TO WS-AH-CAN-TERM
  3532           IF (WS-AH-CAN-TERM > +0)
  3533              AND (WS-BIN-AH-CAN-DATE > WS-BIN-1ST-DT)
  3534              SUBTRACT +1        FROM WS-AH-CAN-TERM
  3535           END-IF
  3536           IF (WS-AH-CAN-TERM > +0)
  3537              AND (WS-THIS-MONTH-DATE = CR-AH-CANCEL-EXIT-DATE)
  3538              SET CREDIT-AH-CANCEL TO TRUE
  3539           END-IF
  3540        END-IF
  3541     END-IF
  3542
  3543*    IF (CR-AH-CANC-DT NOT = ZEROS) AND
  3544*       (CR-AH-CANC-DT < WS-WORK-DATE)
  3545*       MOVE CR-AH-CANC-DT           TO WS-WORK-DATE
  3546*    END-IF
  3547
  3548     IF (CR-AH-CANCEL-EXIT-DATE NOT = ZEROS)
  3549        AND (CR-AH-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3550        MOVE CR-AH-CANCEL-EXIT-DATE
  3551                                 TO WS-WORK-DATE
  3552     END-IF
  3553
  3554     IF (CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS) AND
  3555        (CR-AH-SETTLEMENT-EXIT-DATE < WS-WORK-DATE)
  3556        MOVE CR-AH-SETTLEMENT-EXIT-DATE
  3557                                     TO WS-WORK-DATE
  3558     END-IF
  3559
  3560     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3561     MOVE 'L'                    TO DC-OPTION-CODE
  3562     PERFORM 8510-DATE-CONVERSION
  3563                                 THRU 8590-EXIT
  3564     IF NO-CONVERSION-ERROR
  3565        MOVE DC-BIN-DATE-1       TO WS-BIN-AH-END-DATE
  3566     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ECS056.cbl
  3567        DISPLAY ' NO AH COVERAGE ' CR-ACCT-CONTROL
  3568           '   ' CR-CERT-NO
  3569     END-IF
  3570
  3571     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  3572     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  3573     MOVE '3'                        TO CP-PROCESS-TYPE
  3574     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  3575     MOVE DTE-CLIENT                 TO CP-COMPANY-ID
  3576     MOVE SPACES                     TO CP-ACCT-FLD-5
  3577     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD
  3578
  3579*    IF (WS-BIN-LF-END-DATE NOT > BIN-RUN-DATE)
  3580*       AND (NOT THIS-IS-A-GIANT-CERT)
  3581*       AND (NOT CREDIT-LF-CANCEL)
  3582*       MOVE ZEROS               TO CR-LFPRM
  3583*                                   CR-LFTYP
  3584*                                   CR-LF-TERM
  3585*                                   CR-LFPRM-RATE
  3586*    END-IF
  3587
  3588     IF (WS-BIN-LF-END-DATE NOT > WS-BIN-LAST-MONTH-DT)
  3589        AND (NOT THIS-IS-A-GIANT-CERT)
  3590        MOVE ZEROS               TO CR-LFPRM
  3591                                    CR-LFTYP
  3592                                    CR-LF-TERM
  3593                                    CR-LFPRM-RATE
  3594     END-IF
  3595
  3596*    IF (WS-BIN-AH-END-DATE NOT > BIN-RUN-DATE)
  3597*       AND (NOT THIS-IS-A-GIANT-CERT)
  3598*       AND (NOT CREDIT-AH-CANCEL)
  3599*       MOVE ZEROS               TO CR-AHPRM
  3600*                                   CR-AHTYP
  3601*                                   CR-AH-TERM
  3602*                                   CR-AHPRM-RATE
  3603*    END-IF
  3604
  3605     IF (WS-BIN-AH-END-DATE NOT > WS-BIN-LAST-MONTH-DT)
  3606        AND (NOT THIS-IS-A-GIANT-CERT)
  3607        MOVE ZEROS               TO CR-AHPRM
  3608                                    CR-AHTYP
  3609                                    CR-AH-TERM
  3610                                    CR-AHPRM-RATE
  3611     END-IF
  3612
  3613     IF CR-LF-TERM > CR-AH-TERM
  3614        MOVE CR-LF-TERM          TO WS-WORK-TERM
  3615     ELSE
  3616        MOVE CR-AH-TERM          TO WS-WORK-TERM
  3617     END-IF
  3618
  3619     IF (CR-LFTYP = '00' OR '  ')
  3620        AND (CR-AHTYP = '00' OR '  ')
  3621        CONTINUE
  3622     ELSE
  3623        PERFORM 0205-CALC-REM-TERMS
  3624                                 THRU 0205-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ECS056.cbl
  3625        IF LF-REM-TERM > AH-REM-TERM
  3626           MOVE LF-REM-TERM      TO REM-TERM
  3627        ELSE
  3628           MOVE AH-REM-TERM      TO REM-TERM
  3629        END-IF
  3630
  3631        PERFORM 0210-CALC-UEP    THRU 0210-EXIT
  3632     END-IF
  3633
  3634
  3635     .
  3636
  3637 0200-EXIT.
  3638     EXIT.
  3639
  3640 0205-CALC-REM-TERMS.
  3641
  3642     MOVE +0                     TO LF-REM-TERM
  3643                                    AH-REM-TERM
  3644                                    REM-TERM
  3645
  3646     IF CR-LFTYP NOT = '  ' AND ZEROS
  3647        PERFORM 0207-FIND-LIFE-TYPE
  3648                                 THRU 0207-EXIT
  3649        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  3650           CONTINUE
  3651        ELSE
  3652           PERFORM 0220-CALC-LF-REM-TERM
  3653                                 THRU 0220-EXIT
  3654        END-IF
  3655     END-IF
  3656
  3657     IF CR-AHTYP NOT = '  ' AND ZEROS
  3658        PERFORM 0208-FIND-AH-TYPE
  3659                                 THRU 0208-EXIT
  3660        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  3661           CONTINUE
  3662        ELSE
  3663           PERFORM 0225-CALC-AH-REM-TERM
  3664                                 THRU 0225-EXIT
  3665        END-IF
  3666     END-IF
  3667
  3668
  3669     .
  3670 0205-EXIT.
  3671    EXIT.
  3672
  3673 0207-FIND-LIFE-TYPE.
  3674
  3675     IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3676        CONTINUE
  3677     ELSE
  3678        PERFORM VARYING CLAS-INDEXL FROM +1 BY +1 UNTIL
  3679         (CLAS-INDEXL = CLAS-MAXL) OR
  3680         (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
  3681        END-PERFORM
  3682        IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ECS056.cbl
  3683           CONTINUE
  3684        ELSE
  3685           DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  3686           DISPLAY 'RETURN CODE - 0401'
  3687           MOVE 0401 TO WS-RETURN-CODE
  3688           PERFORM ABEND-PGM
  3689        END-IF
  3690     END-IF
  3691
  3692     .
  3693 0207-EXIT.
  3694     EXIT.
  3695
  3696 0208-FIND-AH-TYPE.
  3697
  3698     IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3699        CONTINUE
  3700     ELSE
  3701        PERFORM VARYING CLAS-INDEXA FROM +1 BY +1 UNTIL
  3702            (CLAS-INDEXA = CLAS-MAXA) OR
  3703            (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
  3704        END-PERFORM
  3705        IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3706           CONTINUE
  3707        ELSE
  3708           DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
  3709           DISPLAY 'RETURN CODE - 0401'
  3710           MOVE 0401 TO WS-RETURN-CODE
  3711           PERFORM ABEND-PGM
  3712        END-IF
  3713     END-IF
  3714
  3715     .
  3716 0208-EXIT.
  3717     EXIT.
  3718
  3719 0210-CALC-UEP.
  3720
  3721     MOVE ZEROS                  TO WS-REM-AMT
  3722     IF THIS-IS-A-GIANT-CERT
  3723        PERFORM 0215-CALC-RECEIVE
  3724                                 THRU 0215-EXIT
  3725     ELSE
  3726        MOVE +0            TO WS-BASE-COMM
  3727                              WS-GA-COMM
  3728        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3729           (X1 > +10)
  3730           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3731              COMPUTE WS-BASE-COMM = WS-BASE-COMM
  3732              + (CR-LFPRM * CR-LCOM-L (X1))
  3733              + (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3734              + (CR-AHPRM * CR-LCOM-AH (X1))
  3735           END-IF
  3736           IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  3737              COMPUTE WS-GA-COMM = WS-GA-COMM +
  3738                 (CR-LFPRM * CR-LCOM-L (X1)) +
  3739                 (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
  3740                 (CR-AHPRM * CR-LCOM-AH (X1))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ECS056.cbl
  3741           END-IF
  3742        END-PERFORM
  3743        IF (CR-LFTYP (1:1) = 'M')
  3744           OR (CR-AHTYP (1:1) = 'M')
  3745*          COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
  3746           COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  3747           COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
  3748           IF (CREDIT-LF-CANCEL)
  3749              OR (CREDIT-AH-CANCEL)
  3750              PERFORM 0212-CALC-CANCEL-CREDIT
  3751                                 THRU 0212-EXIT
  3752           ELSE
  3753             IF RUN-DATE = CR-ENTRY-DATE
  3754              COMPUTE WS-EXP-PREM = WS-EXP-PREM
  3755                 * WS-EARN-TERM
  3756              COMPUTE WS-BASE-COMM = WS-BASE-COMM
  3757                 * WS-EARN-TERM
  3758              COMPUTE WS-GA-COMM   = WS-GA-COMM
  3759                 * WS-EARN-TERM
  3760             END-IF
  3761             COMPUTE WS-EXP-PREM =
  3762              (WS-EXP-PREM - WS-BASE-COMM)
  3763           END-IF
  3764        ELSE
  3765           IF (CR-LFTYP (1:1) = 'S')
  3766              OR (CR-AHTYP (1:1) = 'S')
  3767              PERFORM 0240-CALC-SRP
  3768                                 THRU 0240-EXIT
  3769           ELSE
  3770              PERFORM 0230-CALC-UEP
  3771                                 THRU 0230-EXIT
  3772           END-IF
  3773        END-IF
  3774     END-IF
  3775
  3776     .
  3777
  3778 0210-EXIT.
  3779     EXIT.
  3780
  3781 0212-CALC-CANCEL-CREDIT.
  3782
  3783     MOVE ZEROS                  TO WS-EXP-PREM
  3784                                    WS-LF-EXP-PREM
  3785                                    WS-AH-EXP-PREM
  3786                                    WS-LF-BASE-COMM
  3787                                    WS-AH-BASE-COMM
  3788                                    WS-LF-GA-COMM
  3789                                    WS-AH-GA-COMM
  3790
  3791
  3792     IF CREDIT-LF-CANCEL
  3793        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3794           (X1 > +10)
  3795           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3796              COMPUTE WS-LF-BASE-COMM = WS-LF-BASE-COMM
  3797              + (CR-LFPRM * CR-LCOM-L (X1))
  3798              + (CR-LFPRM-ALT * CR-LCOM-L (X1))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ECS056.cbl
  3799           END-IF
  3800           IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  3801              COMPUTE WS-LF-GA-COMM = WS-LF-GA-COMM +
  3802                 (CR-LFPRM * CR-LCOM-L (X1)) +
  3803                 (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3804           END-IF
  3805        END-PERFORM
  3806        COMPUTE WS-LF-EXP-PREM = CR-LFPRM * WS-LF-CAN-TERM
  3807        COMPUTE WS-LF-BASE-COMM = WS-LF-BASE-COMM * WS-LF-CAN-TERM
  3808        COMPUTE WS-LF-GA-COMM = WS-LF-GA-COMM * WS-LF-CAN-TERM
  3809     END-IF
  3810
  3811     IF CREDIT-AH-CANCEL
  3812        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3813           (X1 > +10)
  3814           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3815              COMPUTE WS-AH-BASE-COMM = WS-AH-BASE-COMM
  3816              + (CR-AHPRM * CR-LCOM-AH (X1))
  3817           END-IF
  3818           IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  3819              COMPUTE WS-AH-GA-COMM = WS-AH-GA-COMM +
  3820                 (CR-AHPRM * CR-LCOM-AH (X1))
  3821           END-IF
  3822        END-PERFORM
  3823        COMPUTE WS-AH-EXP-PREM = CR-AHPRM * WS-AH-CAN-TERM
  3824        COMPUTE WS-AH-BASE-COMM = WS-AH-BASE-COMM * WS-AH-CAN-TERM
  3825        COMPUTE WS-AH-GA-COMM = WS-AH-GA-COMM * WS-AH-CAN-TERM
  3826     END-IF
  3827
  3828     COMPUTE WS-EXP-PREM = WS-LF-EXP-PREM + WS-AH-EXP-PREM
  3829     COMPUTE WS-BASE-COMM = WS-LF-BASE-COMM + WS-AH-BASE-COMM
  3830     COMPUTE WS-GA-COMM = WS-LF-GA-COMM + WS-AH-GA-COMM
  3831     COMPUTE WS-EXP-PREM = (WS-EXP-PREM - WS-BASE-COMM) * -1
  3832
  3833     .
  3834 0212-EXIT.
  3835     EXIT.
  3836
  3837
  3838 0215-CALC-RECEIVE.
  3839
  3840     MOVE +0                     TO WS-GA-COMM
  3841                                    WS-REC-BASE-COMM
  3842
  3843     IF WS-THIS-MONTH-DATE = CR-ENTRY-DATE
  3844        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3845           (X1 > +10)
  3846           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3847              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM +
  3848                 (CR-LFPRM * CR-LCOM-L (X1)) +
  3849                 (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
  3850                 (CR-AHPRM * CR-LCOM-AH (X1))
  3851           END-IF
  3852        END-PERFORM
  3853        COMPUTE WS-REC-PREM = (CR-LFPRM + CR-LFPRM-ALT + CR-AHPRM)
  3854     END-IF
  3855
  3856     IF WS-THIS-MONTH-DATE = CR-LF-CANCEL-EXIT-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ECS056.cbl
  3857        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3858           (X1 > +10)
  3859           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3860              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM -
  3861                 (CR-LFRFND * CR-LCOM-L (X1))
  3862           END-IF
  3863        END-PERFORM
  3864        COMPUTE WS-REC-PREM = WS-REC-PREM - CR-LFRFND
  3865     END-IF
  3866
  3867     IF WS-THIS-MONTH-DATE = CR-AH-CANCEL-EXIT-DATE
  3868        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3869           (X1 > +10)
  3870           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3871              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM -
  3872                 (CR-AHRFND * CR-LCOM-AH (X1))
  3873           END-IF
  3874        END-PERFORM
  3875        COMPUTE WS-REC-PREM = WS-REC-PREM - CR-AHRFND
  3876     END-IF
  3877
  3878     COMPUTE WS-REC-PREM = WS-REC-PREM - WS-REC-BASE-COMM
  3879*    COMPUTE WS-REC-PREM = (CR-LFPRM + CR-LFPRM-ALT + CR-AHPRM)
  3880*       - WS-REC-BASE-COMM
  3881
  3882     .
  3883
  3884 0215-EXIT.
  3885     EXIT.
  3886
  3887 0220-CALC-LF-REM-TERM.
  3888
  3889     MOVE ZEROS                  TO LF-REM-TERM
  3890     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-1
  3891     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-2
  3892
  3893     IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  3894        MOVE ZEROS               TO WS-LF-EARN-TERM
  3895     ELSE
  3896        MOVE '1'                 TO DC-OPTION-CODE
  3897        PERFORM 8510-DATE-CONVERSION
  3898                                 THRU 8590-EXIT
  3899        IF NO-CONVERSION-ERROR
  3900           MOVE DC-ELAPSED-MONTHS
  3901                                 TO WS-LF-EARN-TERM
  3902           IF DC-ODD-DAYS-OVER > +0
  3903              ADD +1             TO WS-LF-EARN-TERM
  3904           END-IF
  3905        ELSE
  3906           DISPLAY ' PROBLEM WITH LIFE EARN TERM '
  3907              CR-ACCT-CONTROL '   ' CR-CERT-NO
  3908        END-IF
  3909     END-IF
  3910
  3911     IF CR-LF-TERM NOT = ZEROS
  3912        COMPUTE LF-REM-TERM = CR-LF-TERM - WS-LF-EARN-TERM
  3913     END-IF
  3914
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ECS056.cbl
  3915*    IF WS-BIN-LF-END-DATE = LOW-VALUES
  3916*       MOVE ZEROS               TO LF-REM-TERM
  3917*    ELSE
  3918*       MOVE BIN-RUN-DATE        TO DC-BIN-DATE-1
  3919*       MOVE WS-BIN-LF-END-DATE  TO DC-BIN-DATE-2
  3920*       MOVE '1'                 TO DC-OPTION-CODE
  3921*       IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  3922*          MOVE +1               TO LF-REM-TERM
  3923*       ELSE
  3924*          PERFORM 8510-DATE-CONVERSION
  3925*                                THRU 8590-EXIT
  3926*          IF NO-CONVERSION-ERROR
  3927*             MOVE DC-ELAPSED-MONTHS
  3928*                                TO LF-REM-TERM
  3929*             IF DC-ODD-DAYS-OVER > +0
  3930*                ADD +1          TO LF-REM-TERM
  3931*             END-IF
  3932*          ELSE
  3933*             DISPLAY ' ERROR WITH LIFE REM TERM '
  3934*               CR-ACCT-CONTROL '  ' CR-CERT-NO
  3935*             MOVE ZEROS         TO LF-REM-TERM
  3936*          END-IF
  3937*       END-IF
  3938*    END-IF
  3939
  3940*    IF LF-REM-TERM > CR-LF-TERM
  3941*       MOVE CR-LF-TERM          TO LF-REM-TERM
  3942*       DISPLAY ' LF REM TERM > LF TERM ' CR-ACCT-CONTROL
  3943*          '   ' CR-CERT-NO
  3944*    END-IF
  3945
  3946*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  3947
  3948*    MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3949*                                TO CP-BENEFIT-TYPE
  3950*    MOVE CLAS-I-BAL (CLAS-INDEXL)
  3951*                                TO CP-SPECIAL-CALC-CD
  3952*    MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3953*                                   CP-LOAN-TERM
  3954
  3955*    IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  3956*       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  3957*       ADD +1                   TO CP-ORIGINAL-TERM
  3958*                                   CP-LOAN-TERM
  3959*    END-IF
  3960
  3961*    IF CP-TERM-IS-DAYS
  3962*       MOVE CR-LF-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
  3963*    ELSE
  3964*       MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  3965*    END-IF
  3966
  3967*    MOVE DTE-REM-TRM-CALC-OPTION
  3968*    MOVE '3'                    TO CP-REM-TRM-CALC-OPTION
  3969
  3970*    PERFORM 0510-GET-REMAINING-TERM
  3971*                                THRU 0510-EXIT
  3972
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ECS056.cbl
  3973*    IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  3974*         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  3975*       MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
  3976*       COMPUTE CP-REMAINING-TERM-1 =
  3977*                      CP-REMAINING-TERM-1 - 1
  3978*       COMPUTE CP-REMAINING-TERM-2 =
  3979*                      CP-REMAINING-TERM-2 - 1
  3980*    END-IF
  3981
  3982*    IF CP-REMAINING-TERM-1 NEGATIVE
  3983*        MOVE ZEROS              TO CP-REMAINING-TERM-1
  3984*    END-IF
  3985
  3986*    IF CP-REMAINING-TERM-2 NEGATIVE
  3987*        MOVE ZEROS              TO CP-REMAINING-TERM-2
  3988*    END-IF
  3989
  3990*    MOVE CP-REMAINING-TERM-1    TO LF-REM-TRM1
  3991*    MOVE CP-REMAINING-TERM-2    TO LF-REM-TRM2
  3992*    DISPLAY ' LF CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
  3993*       ' REM2 ' LF-REM-TRM2
  3994
  3995     .
  3996
  3997 0220-EXIT.
  3998     EXIT.
  3999
  4000 0225-CALC-AH-REM-TERM.
  4001
  4002     MOVE +0                     TO AH-REM-TERM
  4003     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-1
  4004     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-2
  4005
  4006     IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  4007        MOVE ZEROS               TO WS-AH-EARN-TERM
  4008     ELSE
  4009        MOVE '1'                 TO DC-OPTION-CODE
  4010        PERFORM 8510-DATE-CONVERSION
  4011                                 THRU 8590-EXIT
  4012        IF NO-CONVERSION-ERROR
  4013           MOVE DC-ELAPSED-MONTHS
  4014                                 TO WS-AH-EARN-TERM
  4015           IF DC-ODD-DAYS-OVER > +0
  4016              ADD +1             TO WS-AH-EARN-TERM
  4017           END-IF
  4018        ELSE
  4019           DISPLAY ' PROBLEM WITH  AH  EARN TERM '
  4020              CR-ACCT-CONTROL '   ' CR-CERT-NO
  4021        END-IF
  4022     END-IF
  4023
  4024     IF CR-AH-TERM NOT = ZEROS
  4025        COMPUTE AH-REM-TERM = CR-AH-TERM - WS-AH-EARN-TERM
  4026     END-IF
  4027
  4028*    IF WS-BIN-AH-END-DATE = LOW-VALUES
  4029*       MOVE ZEROS               TO AH-REM-TERM
  4030*    ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ECS056.cbl
  4031*       MOVE BIN-RUN-DATE        TO DC-BIN-DATE-1
  4032*       MOVE WS-BIN-AH-END-DATE  TO DC-BIN-DATE-2
  4033*       IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  4034*          MOVE +1               TO AH-REM-TERM
  4035*       ELSE
  4036*          MOVE '1'              TO DC-OPTION-CODE
  4037*          PERFORM 8510-DATE-CONVERSION
  4038*                                THRU 8590-EXIT
  4039*          IF NO-CONVERSION-ERROR
  4040*             MOVE DC-ELAPSED-MONTHS
  4041*                                TO AH-REM-TERM
  4042*             IF DC-ODD-DAYS-OVER > +0
  4043*                ADD +1          TO AH-REM-TERM
  4044*             END-IF
  4045*          ELSE
  4046*             DISPLAY ' ERROR WITH  AH  REM TERM '
  4047*               CR-ACCT-CONTROL '  ' CR-CERT-NO
  4048*             MOVE ZEROS         TO AH-REM-TERM
  4049*          END-IF
  4050*       END-IF
  4051*    END-IF
  4052
  4053*    IF AH-REM-TERM > CR-AH-TERM
  4054*       MOVE CR-AH-TERM          TO AH-REM-TERM
  4055*       DISPLAY ' AH REM TERM > AH TERM ' CR-ACCT-CONTROL
  4056*          '   ' CR-CERT-NO
  4057*    END-IF
  4058
  4059*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  4060
  4061*    MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  4062*                                TO CP-BENEFIT-TYPE
  4063*    MOVE CLAS-I-BAL (CLAS-INDEXA)
  4064*                                TO CP-SPECIAL-CALC-CD
  4065*    MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  4066*                                   CP-LOAN-TERM
  4067
  4068*    MOVE DTE-REM-TRM-CALC-OPTION
  4069*    MOVE '3'                    TO CP-REM-TRM-CALC-OPTION
  4070
  4071*    PERFORM 0510-GET-REMAINING-TERM
  4072*                                THRU 0510-EXIT
  4073
  4074*    IF CP-REMAINING-TERM-1 NEGATIVE
  4075*        MOVE ZEROS              TO CP-REMAINING-TERM-1
  4076*    END-IF
  4077
  4078*    IF CP-REMAINING-TERM-2 NEGATIVE
  4079*        MOVE ZEROS              TO CP-REMAINING-TERM-2
  4080*    END-IF
  4081
  4082*    MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
  4083*    MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
  4084*    DISPLAY ' AH CERT ' CR-CERT-NO ' TERM ' CR-AH-TERM
  4085*       ' REM2 ' AH-REM-TRM2
  4086*
  4087     .
  4088
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ECS056.cbl
  4089 0225-EXIT.
  4090     EXIT.
  4091
  4092 0230-CALC-UEP.
  4093
  4094*    DISPLAY ' MADE IT TO 0230 ' CR-CERT-NO
  4095
  4096     COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  4097
  4098     MOVE WS-EARN-TERM           TO WS-DISPLAY-FLD
  4099     IF CR-CERT-NO = '0004052380 '
  4100        DISPLAY ' EARN TRM ' WS-DISPLAY-FLD
  4101     END-IF
  4102     IF CR-LOAN-TERM NOT NUMERIC
  4103        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4104     END-IF
  4105     IF CR-LOAN-TERM = ZEROS
  4106        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4107     END-IF
  4108     IF CR-LOAN-TERM = ZEROS
  4109        MOVE CR-AH-TERM          TO CR-LOAN-TERM
  4110     END-IF
  4111*    COMPUTE WS-I = CR-APR / +1200
  4112
  4113*    MOVE WS-I                   TO WS-DISPLAY-FLD
  4114*    DISPLAY ' WS I ' WS-DISPLAY-FLD
  4115*
  4116*    COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4117*       + (CR-AHPRM-RATE / +1000))
  4118
  4119*    MOVE WS-J                   TO WS-DISPLAY-FLD
  4120*    DISPLAY ' WS J ' WS-DISPLAY-FLD
  4121
  4122*    COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
  4123
  4124*    MOVE WS-VM                  TO WS-DISPLAY-FLD
  4125*    DISPLAY ' WS VM ' WS-DISPLAY-FLD
  4126*
  4127*    COMPUTE WS-ANGLEMJ = (1 - ((1 + WS-J)
  4128*       ** (WS-WORK-TERM * -1))) / WS-J
  4129
  4130*    MOVE WS-ANGLEMJ             TO WS-DISPLAY-FLD
  4131*    DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
  4132*    COMPUTE WS-ANGLEN = (1 - ((1 + WS-I)
  4133*       ** (CR-LOAN-TERM * -1))) / WS-I
  4134
  4135*    MOVE WS-ANGLEN              TO WS-DISPLAY-FLD
  4136*    DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
  4137*    COMPUTE WS-ANGLEM = (1 - ((1 + WS-I)
  4138*       ** (WS-WORK-TERM * -1))) / WS-I
  4139
  4140*    MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4141*    DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
  4142*    COMPUTE WS-ANGLEN-M = (1 - ((1 + WS-I)
  4143*       ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
  4144
  4145*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4146*    DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ECS056.cbl
  4147
  4148*    IF CR-LFAMT = ZEROS
  4149*       COMPUTE CR-LFAMT = CR-AHAMT * WS-WORK-TERM
  4150*    END-IF
  4151
  4152*    COMPUTE WS-P = CR-LFAMT / WS-ANGLEN
  4153*    MOVE WS-P                   TO WS-DISPLAY-FLD
  4154*    DISPLAY ' WS P       ' WS-DISPLAY-FLD
  4155*    COMPUTE WS-B = WS-P * WS-ANGLEN-M
  4156*    MOVE WS-B                   TO WS-DISPLAY-FLD
  4157*    DISPLAY ' WS B       ' WS-DISPLAY-FLD
  4158*    COMPUTE WS-R = (CR-LFAMT - (WS-B * WS-VM))
  4159*       / WS-ANGLEMJ
  4160*    MOVE WS-R                   TO WS-DISPLAY-FLD
  4161*    DISPLAY ' WS R       ' WS-DISPLAY-FLD
  4162
  4163*    MOVE CR-LFAMT               TO WS-AMT
  4164
  4165*    MOVE CR-LFPRM-RATE          TO WS-DISPLAY-FLD
  4166*    DISPLAY ' LF RATE ' WS-DISPLAY-FLD
  4167*    MOVE CR-AHPRM-RATE          TO WS-DISPLAY-FLD
  4168*    DISPLAY ' AH RATE ' WS-DISPLAY-FLD
  4169
  4170*    MOVE +0                     TO WS-LF-PRM
  4171*                                   WS-AH-PRM
  4172*    PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4173*       (WS-A > WS-EARN-TERM)
  4174*       IF WS-A = +1
  4175*          COMPUTE WS-I1 ROUNDED = (WS-AMT * (WS-I / +30
  4176*             * (CR-PMT-EXTENSION-DAYS + +30)) * +100) / +100
  4177*       ELSE
  4178*          COMPUTE WS-I1 ROUNDED = (WS-AMT * WS-I * +100)
  4179*             / +100
  4180*       END-IF
  4181*       MOVE WS-I1               TO WS-DISPLAY-FLD
  4182*       DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
  4183*       DISPLAY ' RUN DATE ' RUN-DATE
  4184*       DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
  4185*       IF RUN-DATE = CR-ENTRY-DATE
  4186*          COMPUTE WS-LF-PRM = WS-LF-PRM
  4187*             + (WS-AMT / +1000 * CR-LFPRM-RATE)
  4188*          COMPUTE WS-AH-PRM = WS-AH-PRM
  4189*             + (WS-AMT / +1000 * CR-AHPRM-RATE)
  4190*          COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4191*          COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4192*       ELSE
  4193*          COMPUTE WS-LF-PRM = WS-AMT / +1000 * CR-LFPRM-RATE
  4194*          COMPUTE WS-AH-PRM = WS-AMT / +1000 * CR-AHPRM-RATE
  4195*       END-IF
  4196*       MOVE WS-AMT              TO WS-DISPLAY-FLD
  4197*       DISPLAY ' WS-AMT B4    ' WS-AMT
  4198*       COMPUTE WS-AMT ROUNDED = (.05 + (WS-AMT - (WS-R
  4199*          - WS-I1 - (WS-LF-PRM + WS-AH-PRM))) * +100)
  4200*          / +100
  4201*       MOVE WS-AMT              TO WS-DISPLAY-FLD
  4202*       DISPLAY ' WS-AMT AFTER ' WS-AMT
  4203*       IF WS-AMT < +0
  4204*          COMPUTE WS-P = WS-P + WS-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ECS056.cbl
  4205*          MOVE ZEROS            TO WS-AMT
  4206*       END-IF
  4207*       IF WS-A = CR-LOAN-TERM
  4208*          IF WS-AMT > ZEROS
  4209*             IF WS-R > WS-AMT
  4210*                COMPUTE WS-R = WS-R - WS-AMT
  4211*                MOVE ZEROS      TO WS-AMT
  4212*             ELSE
  4213*                MOVE CR-LFAMT-ALT TO WS-R
  4214*                MOVE ZEROS      TO WS-AMT
  4215*             END-IF
  4216*          END-IF
  4217*       END-IF
  4218*    END-PERFORM
  4219
  4220*    COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
  4221
  4222*    DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
  4223*    DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
  4224*    DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
  4225*    DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
  4226*       - WS-BASE-COMM
  4227
  4228
  4229*    MOVE CR-LFPRM-RATE          TO WS-DISPLAY-FLD
  4230*    DISPLAY ' LFRATE   ' WS-DISPLAY-FLD
  4231*    MOVE CR-AHPRM-RATE          TO WS-DISPLAY-FLD
  4232*    DISPLAY ' AHRATE   ' WS-DISPLAY-FLD
  4233*    MOVE CR-APR                 TO WS-DISPLAY-FLD
  4234*    DISPLAY ' APR      ' WS-DISPLAY-FLD
  4235     COMPUTE WS-I = CR-APR / +1200
  4236*    MOVE WS-I                   TO WS-DISPLAY-FLD
  4237*    DISPLAY ' WS I     ' WS-DISPLAY-FLD
  4238
  4239     COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4240        + (CR-AHPRM-RATE / +1000))
  4241*    MOVE WS-J                   TO WS-DISPLAY-FLD
  4242*    DISPLAY ' WS J     ' WS-DISPLAY-FLD
  4243     COMPUTE WS-K = WS-I + (CR-LFPRM-RATE / +1000)
  4244
  4245*    I = APR/1200
  4246*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4247*    RA = PAYMENT AMOUNT
  4248*    WK5-CSL = THE BALANCE (PAY OFF )
  4249*    WK3 = THE ACCUMULATED PREMIUM
  4250*    WK2 = (1 + I) ^ (m * -1)
  4251*
  4252*
  4253     COMPUTE WS-OD = (1 + (WS-DAYS-TO-1ST * WS-I / 30))
  4254        / (1 + WS-I)
  4255
  4256*    MOVE WS-DAYS-TO-1ST         TO WS-DISPLAY-FLD
  4257*    DISPLAY ' DYS 2 1ST' WS-DISPLAY-FLD
  4258*    MOVE WS-OD                  TO WS-DISPLAY-FLD
  4259*    DISPLAY ' WS OD    ' WS-DISPLAY-FLD
  4260     COMPUTE WS-ANGLEN-M = ((1 - ((1 + WS-I)
  4261        ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I)
  4262        / WS-OD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ECS056.cbl
  4263     COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
  4264*    MOVE WS-VM                  TO WS-DISPLAY-FLD
  4265*    DISPLAY ' WS VM    ' WS-DISPLAY-FLD
  4266     COMPUTE WS-ANGLEN-M = WS-ANGLEN-M * WS-VM
  4267*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4268*    DISPLAY ' WS AN-M  ' WS-DISPLAY-FLD
  4269     COMPUTE WS-ANGLEMJ = ((1 - ((1 + WS-J)
  4270        ** (WS-WORK-TERM * -1))) / WS-J) / WS-OD
  4271*    MOVE WS-ANGLEMJ             TO WS-DISPLAY-FLD
  4272*    DISPLAY ' WS AMJ   ' WS-DISPLAY-FLD
  4273     COMPUTE WS-ANGLEM = ((1 - ((1 + WS-I)
  4274        ** (WS-WORK-TERM * -1))) / WS-I) / WS-OD
  4275*    MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4276*    DISPLAY ' WS AM    ' WS-DISPLAY-FLD
  4277     COMPUTE WS-ANGLEM-1 = (1 - ((1 + WS-J)
  4278        ** ((WS-WORK-TERM - 1) * -1))) / WS-J
  4279
  4280
  4281     IF CR-LFAMT = ZEROS
  4282        COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEM
  4283     END-IF
  4284
  4285     IF CR-LFAMT-ALT > +0
  4286        COMPUTE WS-P = (CR-LFAMT * WS-OD - (CR-LFAMT-ALT *
  4287           (1 + WS-K) ** (WS-WORK-TERM * -1))) / WS-ANGLEM-1
  4288     ELSE
  4289        COMPUTE WS-P = CR-LFAMT / (WS-ANGLEMJ + WS-ANGLEN-M)
  4290     END-IF
  4291*    MOVE WS-P                   TO WS-DISPLAY-FLD
  4292*    DISPLAY ' WS P     ' WS-DISPLAY-FLD
  4293     COMPUTE WS-ANGLEN-M = (1 - ((1 + WS-I)
  4294        ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
  4295*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4296*    DISPLAY ' WS AN-M  ' WS-DISPLAY-FLD
  4297     MOVE +0                     TO WS-LF-PRM
  4298                                    WS-AH-PRM
  4299                                    WS-LF-REF
  4300                                    WS-AH-REF
  4301                                    WS-LF-MIN-TERM
  4302                                    WS-LF-MAX-TERM
  4303                                    WS-AH-MIN-TERM
  4304                                    WS-AH-MAX-TERM
  4305     IF WS-LF-CAN-TERM > +0
  4306        COMPUTE WS-LF-MIN-TERM = WS-EARN-TERM - WS-LF-CAN-TERM
  4307        COMPUTE WS-LF-MAX-TERM = WS-LF-MIN-TERM + WS-LF-CAN-TERM
  4308           - +1
  4309     END-IF
  4310
  4311     IF WS-AH-CAN-TERM > +0
  4312        COMPUTE WS-AH-MIN-TERM = WS-EARN-TERM - WS-AH-CAN-TERM
  4313        COMPUTE WS-AH-MAX-TERM = WS-AH-MIN-TERM + WS-AH-CAN-TERM
  4314           - +1
  4315     END-IF
  4316
  4317     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4318        (WS-A > WS-EARN-TERM)
  4319        IF CR-LFAMT-ALT > +0
  4320           COMPUTE WS-ANGLEM = (1 - ((1 + WS-J)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ECS056.cbl
  4321             ** ((WS-WORK-TERM - WS-A) * -1))) / WS-J
  4322           COMPUTE WS-AMT = (WS-P * WS-ANGLEM) +
  4323             (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4324             ** (WS-WORK-TERM - WS-A + 1)))
  4325        ELSE
  4326
  4327           COMPUTE WS-ANGLEM = (1 - ((1 + WS-J)
  4328             ** ((WS-WORK-TERM - WS-A + 1) * -1))) / WS-J
  4329           COMPUTE WS-VM = (1 / (1 + WS-J))
  4330             ** (WS-WORK-TERM - WS-A + 1)
  4331           COMPUTE WS-AMT = WS-P *
  4332             (WS-ANGLEM + (WS-ANGLEN-M * WS-VM))
  4333        END-IF
  4334*       IF WS-A = +1
  4335*          MOVE WS-VM               TO WS-DISPLAY-FLD
  4336*          DISPLAY ' WS VM    ' WS-DISPLAY-FLD
  4337*          MOVE WS-ANGLEM           TO WS-DISPLAY-FLD
  4338*          DISPLAY ' WS AM    ' WS-DISPLAY-FLD
  4339*          MOVE WS-AMT TO WS-DISPLAY-FLD
  4340*          DISPLAY ' AMT FIRST ' WS-DISPLAY-FLD
  4341*       END-IF
  4342        IF RUN-DATE = CR-ENTRY-DATE
  4343           COMPUTE WS-LF-PRM = WS-LF-PRM
  4344              + (WS-AMT / +1000 * CR-LFPRM-RATE)
  4345           IF CR-LFAMT-ALT > +0
  4346              COMPUTE WS-AH-PRM = WS-AH-PRM +
  4347                (WS-AMT - (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4348                ** (WS-WORK-TERM - WS-A + 1)))) *
  4349                (CR-AHPRM-RATE / 1000)
  4350           ELSE
  4351              COMPUTE WS-AH-PRM = WS-AH-PRM
  4352                + (WS-AMT / +1000 * CR-AHPRM-RATE)
  4353           END-IF
  4354*          MOVE WS-LF-PRM           TO WS-DISPLAY-FLD
  4355*          DISPLAY ' WS LFPRM ' WS-DISPLAY-FLD
  4356           COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4357           COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4358        ELSE
  4359           COMPUTE WS-LF-PRM = WS-AMT * CR-LFPRM-RATE / +1000
  4360           IF CR-LFAMT-ALT > +0
  4361              COMPUTE WS-AH-PRM =
  4362                (WS-AMT - (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4363                ** (WS-WORK-TERM - WS-A + 1)))) *
  4364                (CR-AHPRM-RATE / 1000)
  4365           ELSE
  4366              COMPUTE WS-AH-PRM = WS-AMT * CR-AHPRM-RATE / +1000
  4367           END-IF
  4368        END-IF
  4369        IF (CREDIT-LF-CANCEL)
  4370           AND (WS-LF-CAN-TERM > +0)
  4371           AND (WS-A NOT < WS-LF-MIN-TERM)
  4372           AND (WS-A NOT > WS-LF-MAX-TERM)
  4373           MOVE WS-A             TO WS-DISPLAY-FLD
  4374           DISPLAY ' FOUND LF ADJUST ' CR-ACCT-CONTROL
  4375              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4376           MOVE WS-LF-PRM        TO WS-DISPLAY-FLD
  4377           DISPLAY '  LF REFUND ' WS-DISPLAY-FLD
  4378           COMPUTE WS-LF-REF = WS-LF-REF + WS-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ECS056.cbl
  4379        END-IF
  4380        IF (CREDIT-AH-CANCEL)
  4381           AND (WS-AH-CAN-TERM > +0)
  4382           AND (WS-A NOT < WS-AH-MIN-TERM)
  4383           AND (WS-A NOT > WS-AH-MAX-TERM)
  4384           MOVE WS-A             TO WS-DISPLAY-FLD
  4385           DISPLAY ' FOUND AH ADJUST ' CR-ACCT-CONTROL
  4386              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4387           MOVE WS-AH-PRM        TO WS-DISPLAY-FLD
  4388           DISPLAY '  AH REFUND ' WS-DISPLAY-FLD
  4389           COMPUTE WS-AH-REF = WS-AH-REF + WS-AH-PRM
  4390        END-IF
  4391     END-PERFORM
  4392
  4393     IF (WS-LF-REF > +0)
  4394        OR (WS-AH-REF > +0)
  4395        COMPUTE WS-EXP-PREM = (WS-LF-REF + WS-AH-REF) * -1
  4396     ELSE
  4397        COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
  4398     END-IF
  4399
  4400     MOVE +0                     TO WS-BASE-COMM
  4401                                    WS-GA-COMM
  4402     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  4403        (X1 > +10)
  4404        IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  4405           COMPUTE WS-BASE-COMM = WS-BASE-COMM
  4406*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4407*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4408           + (WS-LF-PRM / (1 - CR-LCOM-L (X1))
  4409              * CR-LCOM-L (X1))
  4410           + (WS-AH-PRM / (1 - CR-LCOM-AH (X1))
  4411              * CR-LCOM-AH (X1))
  4412
  4413
  4414
  4415
  4416        END-IF
  4417        IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  4418           COMPUTE WS-GA-COMM = WS-GA-COMM
  4419*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4420*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4421           + (WS-LF-PRM / (1 - CR-LCOM-L (X1))
  4422              * CR-LCOM-L (X1))
  4423           + (WS-AH-PRM / (1 - CR-LCOM-AH (X1))
  4424              * CR-LCOM-AH (X1))
  4425        END-IF
  4426     END-PERFORM
  4427     .
  4428
  4429 0230-EXIT.
  4430     EXIT.
  4431
  4432 0240-CALC-SRP.
  4433
  4434     DISPLAY ' MADE IT TO 0240 ' CR-CERT-NO
  4435
  4436     COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ECS056.cbl
  4437
  4438     IF CR-LOAN-TERM NOT NUMERIC
  4439        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4440     END-IF
  4441     IF CR-LOAN-TERM = ZEROS
  4442        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4443     END-IF
  4444     IF CR-LOAN-TERM = ZEROS
  4445        MOVE CR-AH-TERM          TO CR-LOAN-TERM
  4446     END-IF
  4447
  4448     COMPUTE WS-I = CR-APR / +1200
  4449
  4450     COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4451        + (CR-AHPRM-RATE / +1000))
  4452
  4453     COMPUTE WS-K = WS-I + (CR-LFPRM-RATE / +1000)
  4454
  4455     COMPUTE WS-Y = (1 + (WS-DAYS-TO-1ST * WS-K / 30))
  4456        / (1 + WS-K)
  4457
  4458     COMPUTE WS-ANGLEMK = ((1 - ((1 + WS-K)
  4459        ** (WS-WORK-TERM * -1))) / WS-K)
  4460
  4461     IF CR-LFAMT = ZEROS
  4462        COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEM
  4463     END-IF
  4464     MOVE CR-LFAMT               TO WS-AMT
  4465
  4466     COMPUTE WS-P = WS-AMT / ((WS-ANGLEMK / WS-Y)
  4467        - ((((WS-WORK-TERM - WS-ANGLEMK) / WS-K)
  4468        * CR-AHPRM-RATE / 1000)
  4469        + WS-ANGLEMK / WS-Y * (WS-DAYS-TO-1ST - 30) / 30
  4470        * CR-AHPRM-RATE / 1000))
  4471
  4472     MOVE +0                     TO WS-LF-PRM
  4473                                    WS-AH-PRM
  4474                                    WS-LF-REF
  4475                                    WS-AH-REF
  4476                                    WS-LF-MIN-TERM
  4477                                    WS-LF-MAX-TERM
  4478                                    WS-AH-MIN-TERM
  4479                                    WS-AH-MAX-TERM
  4480                                    WS-LINS WS-DINS
  4481                                    WS-FLINS WS-FDINS
  4482                                    WS-INT   WS-FINT
  4483     IF WS-LF-CAN-TERM > +0
  4484        COMPUTE WS-LF-MIN-TERM = WS-EARN-TERM - WS-LF-CAN-TERM
  4485        COMPUTE WS-LF-MAX-TERM = WS-LF-MIN-TERM + WS-LF-CAN-TERM
  4486           - +1
  4487     END-IF
  4488
  4489     IF WS-AH-CAN-TERM > +0
  4490        COMPUTE WS-AH-MIN-TERM = WS-EARN-TERM - WS-AH-CAN-TERM
  4491        COMPUTE WS-AH-MAX-TERM = WS-AH-MIN-TERM + WS-AH-CAN-TERM
  4492           - +1
  4493     END-IF
  4494
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ECS056.cbl
  4495***  THE BELOW 3 FIELDS ARE FOR CALCULATING THE FEES AND INT
  4496***  FOR THE TIME BETWEEN THE EFF DATE AND 1ST PMT DATE ONLY
  4497
  4498     COMPUTE WS-FINT = WS-AMT * (1 + WS-I *
  4499        (WS-DAYS-TO-1ST - 30) / 30) - WS-AMT
  4500
  4501     COMPUTE WS-FLINS = WS-AMT * CR-LFPRM-RATE / 1000
  4502        * (WS-DAYS-TO-1ST - 30) / 30
  4503
  4504     COMPUTE WS-FDINS = WS-P * WS-WORK-TERM * CR-AHPRM-RATE
  4505        / 1000 * (WS-DAYS-TO-1ST - 30) / 30
  4506
  4507     IF CR-ACCOUNT = '0005500363'
  4508*    IF CR-CERT-NO = '0126880300 ' OR '0018664366 '
  4509     MOVE WS-INIT-DB-EXTRACT     TO DEBUG-EXTRACT-RECORD
  4510     MOVE CR-ACCOUNT             TO DB-ACCOUNT
  4511     MOVE CR-CERT-NO             TO DB-CERT-NO
  4512
  4513     MOVE CR-DT                  TO WS-ISSUE-DATE
  4514     MOVE WS-ISSUE-MMDD (1:2)    TO DB-EFF-DATE (1:2)
  4515     MOVE '-'                    TO DB-EFF-DATE (3:1)
  4516                                    DB-EFF-DATE (6:1)
  4517     MOVE WS-ISSUE-MMDD (3:2)    TO DB-EFF-DATE (4:2)
  4518     MOVE WS-ISSUE-CCYY          TO DB-EFF-DATE (7:4)
  4519     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  4520     MOVE WS-ENTRY-MMDD (1:2)    TO DB-ENT-DATE (1:2)
  4521     MOVE '-'                    TO DB-ENT-DATE (3:1)
  4522                                    DB-ENT-DATE (6:1)
  4523     MOVE WS-ENTRY-MMDD (3:2)    TO DB-ENT-DATE (4:2)
  4524     MOVE WS-ENTRY-CCYY          TO DB-ENT-DATE (7:4)
  4525     MOVE RUN-DATE               TO WS-ENTRY-DATE
  4526     MOVE WS-ENTRY-MMDD (1:2)    TO DB-VAL-DATE (1:2)
  4527     MOVE '-'                    TO DB-VAL-DATE (3:1)
  4528                                    DB-VAL-DATE (6:1)
  4529     MOVE WS-ENTRY-MMDD (3:2)    TO DB-VAL-DATE (4:2)
  4530     MOVE WS-ENTRY-CCYY          TO DB-VAL-DATE (7:4)
  4531     MOVE ZEROS                  TO DB-PERIOD
  4532     MOVE WS-P                   TO DB-PAYMENT
  4533     MOVE ZEROS                  TO DB-PRINC
  4534     MOVE WS-FINT                TO DB-INTEREST
  4535     MOVE WS-FLINS               TO DB-LINS
  4536     MOVE WS-FDINS               TO DB-DINS
  4537     MOVE WS-AMT                 TO DB-BALANCE
  4538     MOVE CR-LFTYP               TO DB-LF-BEN-CODE
  4539     MOVE CR-AHTYP               TO DB-AH-BEN-CODE
  4540     MOVE CR-LF-TERM             TO DB-LF-TERM
  4541     MOVE CR-AH-TERM             TO DB-AH-TERM
  4542     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4543     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-LF-EXP-DATE (1:2)
  4544     MOVE '-'                    TO DB-LF-EXP-DATE (3:1)
  4545                                    DB-LF-EXP-DATE (6:1)
  4546     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-LF-EXP-DATE (4:2)
  4547     MOVE WS-EXPIRE-CCYY         TO DB-LF-EXP-DATE (7:4)
  4548
  4549     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4550     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-AH-EXP-DATE (1:2)
  4551     MOVE '-'                    TO DB-AH-EXP-DATE (3:1)
  4552                                    DB-AH-EXP-DATE (6:1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ECS056.cbl
  4553     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-AH-EXP-DATE (4:2)
  4554     MOVE WS-EXPIRE-CCYY         TO DB-AH-EXP-DATE (7:4)
  4555     WRITE DEBUG-EXTRACT-RECORD
  4556     END-IF
  4557
  4558     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4559        (WS-A > WS-EARN-TERM)
  4560
  4561        IF RUN-DATE = CR-ENTRY-DATE
  4562           COMPUTE WS-LINS = WS-LINS + WS-FLINS
  4563              + (WS-AMT / 1000 * CR-LFPRM-RATE)
  4564           COMPUTE WS-DINS = WS-DINS + WS-FDINS
  4565              + (WS-WORK-TERM - WS-A + 1) * WS-P
  4566              * CR-AHPRM-RATE / 1000
  4567           COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4568           COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4569        ELSE
  4570           COMPUTE WS-LINS = WS-FLINS
  4571              + (WS-AMT / 1000 * CR-LFPRM-RATE)
  4572           COMPUTE WS-DINS = WS-FDINS
  4573              + (WS-WORK-TERM - WS-A + 1) * WS-P
  4574              * CR-AHPRM-RATE / 1000
  4575        END-IF
  4576
  4577        COMPUTE WS-INT = WS-AMT * WS-I
  4578        COMPUTE WS-INT = WS-INT + WS-FINT
  4579
  4580        IF WS-A = +1
  4581           COMPUTE WS-AMT = WS-AMT - WS-P + WS-LINS
  4582              + WS-DINS + WS-INT
  4583        ELSE
  4584           COMPUTE WS-AMT = WS-AMT -
  4585             (WS-P - WS-INT - WS-LINS - WS-DINS)
  4586        END-IF
  4587
  4588
  4589        IF (CREDIT-LF-CANCEL)
  4590           AND (WS-LF-CAN-TERM > +0)
  4591           AND (WS-A NOT < WS-LF-MIN-TERM)
  4592           AND (WS-A NOT > WS-LF-MAX-TERM)
  4593           MOVE WS-A             TO WS-DISPLAY-FLD
  4594           DISPLAY ' FOUND LF ADJUST ' CR-ACCT-CONTROL
  4595              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4596           MOVE WS-LINS          TO WS-DISPLAY-FLD
  4597           DISPLAY '  LF REFUND ' WS-DISPLAY-FLD
  4598           COMPUTE WS-LF-REF = WS-LF-REF + WS-LINS
  4599        END-IF
  4600        IF (CREDIT-AH-CANCEL)
  4601           AND (WS-AH-CAN-TERM > +0)
  4602           AND (WS-A NOT < WS-AH-MIN-TERM)
  4603           AND (WS-A NOT > WS-AH-MAX-TERM)
  4604           MOVE WS-A             TO WS-DISPLAY-FLD
  4605           DISPLAY ' FOUND AH ADJUST ' CR-ACCT-CONTROL
  4606              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4607           MOVE WS-DINS          TO WS-DISPLAY-FLD
  4608           DISPLAY '  AH REFUND ' WS-DISPLAY-FLD
  4609           COMPUTE WS-AH-REF = WS-AH-REF + WS-DINS
  4610        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ECS056.cbl
  4611
  4612
  4613
  4614        MOVE +0                  TO WS-FLINS
  4615                                    WS-FDINS
  4616                                    WS-FINT
  4617
  4618
  4619     IF CR-ACCOUNT = '0005500363'
  4620*    IF CR-CERT-NO = '0126880300 ' OR '0018664366 '
  4621     MOVE WS-INIT-DB-EXTRACT     TO DEBUG-EXTRACT-RECORD
  4622     MOVE CR-ACCOUNT             TO DB-ACCOUNT
  4623     MOVE CR-CERT-NO             TO DB-CERT-NO
  4624
  4625     MOVE CR-DT                  TO WS-ISSUE-DATE
  4626     MOVE WS-ISSUE-MMDD (1:2)    TO DB-EFF-DATE (1:2)
  4627     MOVE '-'                    TO DB-EFF-DATE (3:1)
  4628                                    DB-EFF-DATE (6:1)
  4629     MOVE WS-ISSUE-MMDD (3:2)    TO DB-EFF-DATE (4:2)
  4630     MOVE WS-ISSUE-CCYY          TO DB-EFF-DATE (7:4)
  4631     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  4632     MOVE WS-ENTRY-MMDD (1:2)    TO DB-ENT-DATE (1:2)
  4633     MOVE '-'                    TO DB-ENT-DATE (3:1)
  4634                                    DB-ENT-DATE (6:1)
  4635     MOVE WS-ENTRY-MMDD (3:2)    TO DB-ENT-DATE (4:2)
  4636     MOVE WS-ENTRY-CCYY          TO DB-ENT-DATE (7:4)
  4637     MOVE RUN-DATE               TO WS-ENTRY-DATE
  4638     MOVE WS-ENTRY-MMDD (1:2)    TO DB-VAL-DATE (1:2)
  4639     MOVE '-'                    TO DB-VAL-DATE (3:1)
  4640                                    DB-VAL-DATE (6:1)
  4641     MOVE WS-ENTRY-MMDD (3:2)    TO DB-VAL-DATE (4:2)
  4642     MOVE WS-ENTRY-CCYY          TO DB-VAL-DATE (7:4)
  4643     MOVE WS-A                   TO DB-PERIOD
  4644     MOVE WS-P                   TO DB-PAYMENT
  4645     COMPUTE DB-PRINC = WS-P - WS-INT - WS-LINS - WS-DINS
  4646     MOVE WS-INT                 TO DB-INTEREST
  4647     MOVE WS-LINS                TO DB-LINS
  4648     MOVE WS-DINS                TO DB-DINS
  4649     MOVE WS-AMT                 TO DB-BALANCE
  4650     MOVE CR-LFTYP               TO DB-LF-BEN-CODE
  4651     MOVE CR-AHTYP               TO DB-AH-BEN-CODE
  4652     MOVE CR-LF-TERM             TO DB-LF-TERM
  4653     MOVE CR-AH-TERM             TO DB-AH-TERM
  4654     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4655     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-LF-EXP-DATE (1:2)
  4656     MOVE '-'                    TO DB-LF-EXP-DATE (3:1)
  4657                                    DB-LF-EXP-DATE (6:1)
  4658     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-LF-EXP-DATE (4:2)
  4659     MOVE WS-EXPIRE-CCYY         TO DB-LF-EXP-DATE (7:4)
  4660
  4661     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4662     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-AH-EXP-DATE (1:2)
  4663     MOVE '-'                    TO DB-AH-EXP-DATE (3:1)
  4664                                    DB-AH-EXP-DATE (6:1)
  4665     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-AH-EXP-DATE (4:2)
  4666     MOVE WS-EXPIRE-CCYY         TO DB-AH-EXP-DATE (7:4)
  4667
  4668     WRITE DEBUG-EXTRACT-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ECS056.cbl
  4669     END-IF
  4670     END-PERFORM
  4671
  4672     IF (WS-LF-REF > +0)
  4673        OR (WS-AH-REF > +0)
  4674        COMPUTE WS-EXP-PREM = (WS-LF-REF + WS-AH-REF) * -1
  4675     ELSE
  4676        COMPUTE WS-EXP-PREM = (WS-LINS + WS-DINS)
  4677     END-IF
  4678
  4679     MOVE +0                     TO WS-BASE-COMM
  4680                                    WS-GA-COMM
  4681     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  4682        (X1 > +10)
  4683        IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  4684           COMPUTE WS-BASE-COMM = WS-BASE-COMM
  4685*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4686*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4687           + (WS-LINS / (1 - CR-LCOM-L (X1))
  4688              * CR-LCOM-L (X1))
  4689           + (WS-DINS / (1 - CR-LCOM-AH (X1))
  4690              * CR-LCOM-AH (X1))
  4691
  4692
  4693
  4694
  4695        END-IF
  4696        IF CR-AGT-TYPE (X1) = 'O' OR 'P'
  4697           COMPUTE WS-GA-COMM = WS-GA-COMM
  4698*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4699*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4700           + (WS-LINS / (1 - CR-LCOM-L (X1))
  4701              * CR-LCOM-L (X1))
  4702           + (WS-DINS / (1 - CR-LCOM-AH (X1))
  4703              * CR-LCOM-AH (X1))
  4704        END-IF
  4705     END-PERFORM
  4706     .
  4707
  4708 0240-EXIT.
  4709     EXIT.
  4710
  4711 0250-BREAK-RTN.
  4712
  4713*    DISPLAY ' MADE IT TO 0250      BREAK '
  4714     IF WS-HOLD-CAR NOT = CR-CARRIER
  4715        PERFORM 0300-ACCT-BREAK  THRU 0300-EXIT
  4716        PERFORM 0310-ST-BREAK    THRU 0310-EXIT
  4717        PERFORM 0320-GRP-BREAK   THRU 0320-EXIT
  4718        PERFORM 0330-CAR-BREAK   THRU 0330-EXIT
  4719     ELSE
  4720        IF WS-HOLD-GRP NOT = CR-GROUPING
  4721           PERFORM 0300-ACCT-BREAK
  4722                                 THRU 0300-EXIT
  4723           PERFORM 0310-ST-BREAK THRU 0310-EXIT
  4724           PERFORM 0320-GRP-BREAK
  4725                                 THRU 0320-EXIT
  4726        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ECS056.cbl
  4727           IF WS-HOLD-ST NOT = CR-STATE
  4728              PERFORM 0300-ACCT-BREAK
  4729                                 THRU 0300-EXIT
  4730              PERFORM 0310-ST-BREAK
  4731                                 THRU 0310-EXIT
  4732           ELSE
  4733              IF WS-HOLD-ACCT NOT = CR-ACCOUNT
  4734                 PERFORM 0300-ACCT-BREAK
  4735                                 THRU 0300-EXIT
  4736              END-IF
  4737           END-IF
  4738        END-IF
  4739     END-IF
  4740     .
  4741 0250-EXIT.
  4742     EXIT.
  4743
  4744 0300-ACCT-BREAK.
  4745
  4746*    DISPLAY ' MADE IT TO 0300 ACCT BREAK '
  4747     IF (WS-TOT-EXP-PREM (1) = ZEROS)
  4748        AND (WS-TOT-REC-PREM (1) = ZEROS)
  4749        AND (WS-TOT-GA-COMM (1) = ZEROS)
  4750        CONTINUE
  4751     ELSE
  4752        MOVE SPACES              TO DETAIL-LINE
  4753        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4754        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4755        MOVE WS-HOLD-ST          TO DTL1-ST
  4756        MOVE WS-HOLD-ACCT        TO DTL1-ACCT
  4757        MOVE WS-TOT-EXP-PREM (1) TO DTL1-EXP-PREM
  4758        MOVE WS-TOT-REC-PREM (1) TO DTL1-REC-PREM
  4759        MOVE WS-TOT-GA-COMM (1)  TO DTL1-COMM
  4760        MOVE DETAIL-LINE         TO P-DATA
  4761        MOVE SPACE-1             TO P-CTL
  4762        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4763
  4764        COMPUTE WS-TOT-EXP-PREM (2) = WS-TOT-EXP-PREM (2)
  4765           + WS-TOT-EXP-PREM (1)
  4766        COMPUTE WS-TOT-REC-PREM (2) = WS-TOT-REC-PREM (2)
  4767           + WS-TOT-REC-PREM (1)
  4768        COMPUTE WS-TOT-GA-COMM (2) = WS-TOT-GA-COMM (2)
  4769           + WS-TOT-GA-COMM (1)
  4770     END-IF
  4771     MOVE +0                     TO WS-TOT-EXP-PREM (1)
  4772                                    WS-TOT-REC-PREM (1)
  4773                                    WS-TOT-GA-COMM  (1)
  4774
  4775     .
  4776 0300-EXIT.
  4777     EXIT.
  4778
  4779 0310-ST-BREAK.
  4780
  4781*    DISPLAY ' MADE IT TO 0310  ST  BREAK '
  4782     IF (WS-TOT-EXP-PREM (2) = ZEROS)
  4783        AND (WS-TOT-REC-PREM (2) = ZEROS)
  4784        AND (WS-TOT-GA-COMM (2) = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ECS056.cbl
  4785        CONTINUE
  4786     ELSE
  4787        MOVE SPACES              TO DETAIL-LINE
  4788        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4789        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4790        MOVE WS-HOLD-ST          TO DTL1-ST
  4791        MOVE SPACES              TO DTL1-ACCT
  4792        MOVE WS-TOT-EXP-PREM (2) TO DTL1-EXP-PREM
  4793        MOVE WS-TOT-REC-PREM (2) TO DTL1-REC-PREM
  4794        MOVE WS-TOT-GA-COMM (2)  TO DTL1-COMM
  4795        MOVE DETAIL-LINE         TO P-DATA
  4796        MOVE SPACE-2             TO P-CTL
  4797        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4798
  4799        COMPUTE WS-TOT-EXP-PREM (3) = WS-TOT-EXP-PREM (3)
  4800           + WS-TOT-EXP-PREM (2)
  4801        COMPUTE WS-TOT-REC-PREM (3) = WS-TOT-REC-PREM (3)
  4802           + WS-TOT-REC-PREM (2)
  4803        COMPUTE WS-TOT-GA-COMM (3) = WS-TOT-GA-COMM (3)
  4804           + WS-TOT-GA-COMM (2)
  4805     END-IF
  4806
  4807     MOVE +0                     TO WS-TOT-EXP-PREM (2)
  4808                                    WS-TOT-REC-PREM (2)
  4809                                    WS-TOT-GA-COMM  (2)
  4810
  4811     .
  4812 0310-EXIT.
  4813     EXIT.
  4814
  4815 0320-GRP-BREAK.
  4816
  4817*    DISPLAY ' MADE IT TO 0320 GRP  BREAK '
  4818     IF (WS-TOT-EXP-PREM (3) = ZEROS)
  4819        AND (WS-TOT-REC-PREM (3) = ZEROS)
  4820        AND (WS-TOT-GA-COMM (3) = ZEROS)
  4821        CONTINUE
  4822     ELSE
  4823        MOVE SPACES              TO DETAIL-LINE
  4824        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4825        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4826        MOVE SPACES              TO DTL1-ST
  4827        MOVE SPACES              TO DTL1-ACCT
  4828        MOVE WS-TOT-EXP-PREM (3) TO DTL1-EXP-PREM
  4829        MOVE WS-TOT-REC-PREM (3) TO DTL1-REC-PREM
  4830        MOVE WS-TOT-GA-COMM (3)  TO DTL1-COMM
  4831        MOVE DETAIL-LINE         TO P-DATA
  4832        MOVE SPACE-2             TO P-CTL
  4833        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4834
  4835        COMPUTE WS-TOT-EXP-PREM (4) = WS-TOT-EXP-PREM (4)
  4836           + WS-TOT-EXP-PREM (3)
  4837        COMPUTE WS-TOT-REC-PREM (4) = WS-TOT-REC-PREM (4)
  4838           + WS-TOT-REC-PREM (3)
  4839        COMPUTE WS-TOT-GA-COMM (4) = WS-TOT-GA-COMM (4)
  4840           + WS-TOT-GA-COMM (3)
  4841     END-IF
  4842
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* ECS056.cbl
  4843     MOVE +0                     TO WS-TOT-EXP-PREM (3)
  4844                                    WS-TOT-REC-PREM (3)
  4845                                    WS-TOT-GA-COMM  (3)
  4846
  4847     .
  4848 0320-EXIT.
  4849     EXIT.
  4850
  4851 0330-CAR-BREAK.
  4852
  4853     DISPLAY ' MADE IT TO 0330 CAR  BREAK '
  4854     IF (WS-TOT-EXP-PREM (4) = ZEROS)
  4855        AND (WS-TOT-REC-PREM (4) = ZEROS)
  4856        AND (WS-TOT-GA-COMM (4) = ZEROS)
  4857        CONTINUE
  4858     ELSE
  4859        MOVE SPACES              TO DETAIL-LINE
  4860        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4861        MOVE SPACES              TO DTL1-GRP
  4862        MOVE SPACES              TO DTL1-ST
  4863        MOVE SPACES              TO DTL1-ACCT
  4864        MOVE WS-TOT-EXP-PREM (4) TO DTL1-EXP-PREM
  4865        MOVE WS-TOT-REC-PREM (4) TO DTL1-REC-PREM
  4866        MOVE WS-TOT-GA-COMM (4)  TO DTL1-COMM
  4867        MOVE DETAIL-LINE         TO P-DATA
  4868        MOVE SPACE-2             TO P-CTL
  4869        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4870
  4871        COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  4872           + WS-TOT-EXP-PREM (4)
  4873        COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  4874           + WS-TOT-REC-PREM (4)
  4875        COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  4876           + WS-TOT-GA-COMM (4)
  4877     END-IF
  4878
  4879     MOVE +0                     TO WS-TOT-EXP-PREM (4)
  4880                                    WS-TOT-REC-PREM (4)
  4881                                    WS-TOT-GA-COMM  (4)
  4882
  4883     .
  4884 0330-EXIT.
  4885     EXIT.
  4886
  4887 0340-FIN-BREAK.
  4888
  4889     DISPLAY ' MADE IT TO 0340 FIN  BREAK '
  4890     IF (WS-TOT-EXP-PREM (5) = ZEROS)
  4891        AND (WS-TOT-REC-PREM (5) = ZEROS)
  4892        AND (WS-TOT-GA-COMM (5) = ZEROS)
  4893        CONTINUE
  4894     ELSE
  4895        MOVE SPACES              TO DETAIL-LINE
  4896        MOVE SPACES              TO DTL1-CAR
  4897        MOVE SPACES              TO DTL1-GRP
  4898        MOVE SPACES              TO DTL1-ST
  4899        MOVE SPACES              TO DTL1-ACCT
  4900        MOVE ' GRAND TOTALS '    TO DETAIL-LINE (1:14)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* ECS056.cbl
  4901        MOVE WS-TOT-EXP-PREM (5) TO DTL1-EXP-PREM
  4902        MOVE WS-TOT-REC-PREM (5) TO DTL1-REC-PREM
  4903        MOVE WS-TOT-GA-COMM (5)  TO DTL1-COMM
  4904        MOVE DETAIL-LINE         TO P-DATA
  4905        MOVE SPACE-2             TO P-CTL
  4906        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4907
  4908*       COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  4909*          + WS-TOT-EXP-PREM (4)
  4910*       COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  4911*          + WS-TOT-REC-PREM (4)
  4912*       COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  4913*          + WS-TOT-GA-COMM (4)
  4914     END-IF
  4915
  4916     .
  4917 0340-EXIT.
  4918     EXIT.
  4919
  4920
  4921
  4922 0510-GET-REMAINING-TERM.
  4923
  4924     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
  4925
  4926     .
  4927
  4928 0510-EXIT.
  4929     EXIT.
  4930
  4931 8600-HD-RTN.
  4932
  4933     MOVE +0                     TO LNCTR
  4934     MOVE HD1                    TO  P-DATA
  4935     MOVE SPACE-NP               TO  P-CTL
  4936
  4937     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4938
  4939     ADD +1                      TO  PGCTR
  4940
  4941     MOVE PGCTR                  TO  HD-PG
  4942     MOVE HD2                    TO  P-DATA
  4943     MOVE SPACE-1                TO  P-CTL
  4944
  4945     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4946
  4947     MOVE HD3                    TO  P-DATA
  4948     MOVE SPACE-1                TO  P-CTL
  4949
  4950     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4951
  4952     MOVE SPACE-2                TO  P-CTL
  4953     MOVE HD4                    TO  P-DATA
  4954
  4955     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4956
  4957     MOVE HD5                    TO  P-DATA
  4958     MOVE SPACE-1                TO  P-CTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* ECS056.cbl
  4959     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4960
  4961     MOVE SPACES                 TO  P-DATA
  4962     MOVE SPACE-1                TO  P-CTL
  4963     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4964
  4965     MOVE +10                    TO  LNCTR
  4966*    MOVE SPACE-2                TO  P-CTL
  4967
  4968     .
  4969 8699-EXIT.
  4970     EXIT.
  4971
  4972 8800-PRT-RTN.
  4973
  4974     IF LNCTR > +56
  4975        MOVE PRT                 TO WS-HOLD-PRT
  4976        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  4977        MOVE WS-HOLD-PRT         TO PRT
  4978     END-IF
  4979
  4980     MOVE P-CTL                  TO X
  4981     IF P-CTL = SPACE-1
  4982        ADD +1                   TO LNCTR
  4983     ELSE
  4984        IF P-CTL = SPACE-2
  4985           ADD +2                TO LNCTR
  4986        ELSE
  4987           IF P-CTL = SPACE-3
  4988              ADD +3             TO LNCTR
  4989           END-IF
  4990        END-IF
  4991     END-IF
  4992
  4993     .
  4994 8850-COPY-PRT-RTN.
* 4995                                 COPY ELCPRT2.
  4996******************************************************************04/15/98
  4997*                                                                *ELCPRT2
  4998*                                                                *ELCPRT2
  4999*                            ELCPRT2                             *   LV005
  5000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  5001*                            VMOD=2.002                          *   CL**5
  5002*                                                                *   CL**4
  5003******************************************************************   CL**4
  5004                                                                     CL**4
  5005     IF DTE-FICH NOT = SPACE AND                                     CL**4
  5006        FICH-OPEN    = SPACE                                         CL**4
  5007         MOVE 'X'                TO  FICH-OPEN                       CL**4
  5008         OPEN OUTPUT FICH.                                           CL**4
  5009                                                                     CL**4
  5010     IF DTE-FICH NOT = SPACE                                         CL**4
  5011         MOVE X                  TO  P-CTL                           CL**4
  5012         WRITE FICH-REC FROM PRT.                                    CL**4
  5013                                                                     CL**4
  5014     IF DTE-FICH = SPACE OR '2'                                      CL**4
  5015       MOVE X                    TO  P-CTL                           CL**4
  5016       IF P-CTL = ' '                                                CL**4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* ECS056.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  5017         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  5018       ELSE                                                          CL**4
  5019         IF P-CTL = '0'                                              CL**4
  5020           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  5021         ELSE                                                        CL**4
  5022           IF P-CTL = '-'                                            CL**4
  5023             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  5024           ELSE                                                      CL**4
  5025             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  5026                                                                     CL**4
  5027******************************************************************   CL**4
  5028
  5029 8800-EXIT.
  5030     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* ECS056.cbl
  5032 8510-DATE-CONVERSION.
  5033
  5034     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  5035
  5036     .
  5037
  5038 8590-EXIT.
  5039     EXIT.
  5040
  5041
  5042
  5043
  5044 ABEND-PGM.
* 5045                                 COPY ELCABEND.
  5046***************************************************************** 04/14/98
  5047*                                                               * ELCABEND
  5048*                            ELCABEND.                          *    LV003
  5049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5050*                            VMOD 2.002                              CL**2
  5051*                                                               * ELCABEND
  5052*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  5053*            AND THEN ABENDS.                                   * ELCABEND
  5054*                                                               * ELCABEND
  5055*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  5056*                                                               * ELCABEND
  5057***************************************************************** ELCABEND
  5058*APS-010.                                                         ELCABEND
  5059     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  5060     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  5061                                                                  ELCABEND
  5062     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  5063         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5064         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5065                                 UPON CONSOLE.                    ELCABEND
  5066                                                                  ELCABEND
  5067     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  5068         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5069         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5070                                 UPON CONSOLE.                    ELCABEND
  5071                                                                  ELCABEND
  5072     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5073     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5074                                 UPON CONSOLE.                    ELCABEND
  5075                                                                  ELCABEND
  5076     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  5077     CALL 'ABORTME'.
  5078                                                                  ELCABEND
  5079 APS-EXIT.                                                        ELCABEND
  5080     EXIT.                                                        ELCABEND
  5081
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       73648     Code:       18831
