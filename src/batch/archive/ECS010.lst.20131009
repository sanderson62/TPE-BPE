* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   4
* ECS010.cbl
    84 ENVIRONMENT DIVISION.
    85 CONFIGURATION SECTION.
    86 SPECIAL-NAMES.
    87     C02 IS LCP-CH2
    88     C03 IS LCP-CH3
    89     C04 IS LCP-CH4
    90     C05 IS LCP-CH5
    91     C06 IS LCP-CH6
    92     C07 IS LCP-CH7
    93     C08 IS LCP-CH8
    94     C09 IS LCP-CH9
    95     C10 IS LCP-CH10
    96     C11 IS LCP-CH11
    97     C12 IS LCP-CH12
    98     S01 IS LCP-P01
    99     S02 IS LCP-P02.
   100
   101 INPUT-OUTPUT SECTION.
   102 FILE-CONTROL.
   103
   104     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   105
   106     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   107
   108     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   109                             ACCESS IS SEQUENTIAL
   110                             ORGANIZATION IS INDEXED
   111                             FILE STATUS IS ERACCTT-FILE-STATUS
   112                             RECORD KEY IS AM-CONTROL-PRIMARY.
   113
   114     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   115                             ACCESS IS DYNAMIC
   116                             ORGANIZATION IS INDEXED
   117                             FILE STATUS IS ERRTBL-FILE-STATUS
   118                             RECORD KEY IS RE-CONTROL-PRIMARY.
   119
   120     SELECT ERCTBL           ASSIGN TO ERCTBLT
   121                             ACCESS IS DYNAMIC
   122                             ORGANIZATION IS INDEXED
   123                             FILE STATUS IS ERCTBL-FILE-STATUS
   124                             RECORD KEY IS CT-CONTROL-PRIMARY.
   125
   126     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   127                             ORGANIZATION INDEXED
   128                             ACCESS DYNAMIC
   129                             RECORD KEY ME-CONTROL-PRIMARY
   130                             FILE STATUS ERMEBL-FILE-STATUS.
   131
   132     SELECT ERRESC-IN        ASSIGN TO ERRESC
   133                             ORGANIZATION IS INDEXED
   134                             ACCESS IS DYNAMIC
   135                             RECORD KEY IS ERRESC-RECORD-KEY
   136                             FILE STATUS IS ERRESC-FILE-STATUS.
   137
   138     SELECT ELCRTT           ASSIGN TO ELCRTT
   139                             ACCESS IS DYNAMIC
   140                             ORGANIZATION IS INDEXED
   141                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   5
* ECS010.cbl
   142                             RECORD KEY IS CS-CONTROL-PRIMARY.
   143
   144     SELECT ERAGTC           ASSIGN TO ERAGTC
   145                             ACCESS IS DYNAMIC
   146                             ORGANIZATION IS INDEXED
   147                             FILE STATUS IS ERAGTC-FILE-STATUS
   148                             RECORD KEY IS AG-CONTROL-PRIMARY.
   149
   150     SELECT ERPDEF           ASSIGN TO ERPDEF
   151                             ACCESS IS DYNAMIC
   152                             ORGANIZATION IS INDEXED
   153                             FILE STATUS IS ERPDEF-FILE-STATUS
   154                             RECORD KEY IS PD-CONTROL-PRIMARY.
   155
   156     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   157
   158     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   159
   160     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   161
   162     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   163
   164
   165     SELECT ME-ECS010-BALANCE
   166                             ASSIGN TO SYS012
   167                             ORGANIZATION IS LINE SEQUENTIAL.
   168
   169     SELECT ME50-ECS010-BALANCE
   170                             ASSIGN TO SYS013
   171                             ORGANIZATION IS LINE SEQUENTIAL.
   172
   173     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   174
   175     SELECT DISK-DATE        ASSIGN TO SYS019.
   176
   177     SELECT PRINT-COPY       ASSIGN TO SYS008.
   178
   179     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   180
   181     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   6
* ECS010.cbl
   183 DATA DIVISION.
   184 FILE SECTION.
   185
   186 FD  PENDING-EXTRACT
   187     BLOCK CONTAINS 0 RECORDS
   188     RECORDING MODE F.
   189
*  190                             COPY ERCEXTD.
   191******************************************************************04/29/98
   192*                                                                *ERCEXTD
   193*                                                                *ERCEXTD
   194*                            ERCEXTD                             *   LV002
   195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   196*                            VMOD=2.002                          *   CL**2
   197*                                                                *ERCEXTD
   198*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   199*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   200*                                                                *ERCEXTD
   201*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   202*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   203*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   204*                                                                *ERCEXTD
   205*         RECORD                                                 *ERCEXTD
   206*          TYPE          PROGRAM USING                           *ERCEXTD
   207*        --------        --------------------------------        *ERCEXTD
   208*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   209*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   210*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   211*                                                                *ERCEXTD
   212* -------------------------------------------------------------- *ERCEXTD
   213*                                                                *ERCEXTD
   214*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   215*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   216*                                                                *ERCEXTD
   217*   FILENAME = EREXTD                                            *ERCEXTD
   218*                                                                *ERCEXTD
   219******************************************************************ERCEXTD
   220                                                                  ERCEXTD
   221 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   222     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   223         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   224                                                                  ERCEXTD
   225     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   226         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   227         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   228         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   229                                                                  ERCEXTD
   230     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   231                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   7
* ECS010.cbl
   233 FD  CERT-MASTER-IN
*  234                             COPY ECSCRIFD.
   235******************************************************************07/10/97
   236*                                                                *ECSCRIFD
   237*                            ECSCRIFD                            *   LV001
   238*                            VMOD 2.005                          *ECSCRIFD
   239*                                                                *ECSCRIFD
   240*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   241*                                                                *ECSCRIFD
   242******************************************************************ECSCRIFD
   243     BLOCK CONTAINS 0 RECORDS
   244     RECORDING MODE F.                                            ECSCRIFD
   245                                                                  ECSCRIFD
   246 01  CERT-IN-RECORD.                                              ECSCRIFD
   247                                                                  ECSCRIFD
   248     12  FILLER                            PIC XXX.               ECSCRIFD
   249     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   250     12  FILLER                            PIC X(66).             ECSCRIFD
   251     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   252     12  FILLER                            PIC X(20).             ECSCRIFD
   253     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   254     12  FILLER                            PIC X(14).             ECSCRIFD
   255     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   256     12  FILLER                            PIC X(39).             ECSCRIFD
   257     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   258     12  FILLER                            PIC X(45).             ECSCRIFD
   259     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   260     12  FILLER                            PIC X(35).             ECSCRIFD
   261     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   262     12  FILLER                            PIC X(41).             ECSCRIFD
   263     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   264     12  FILLER                            PIC X(48).             ECSCRIFD
   265     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   266     12  FILLER                            PIC X(9).              ECSCRIFD
   267     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   268     12  FILLER                            PIC X(120).            ECSCRIFD
   269     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   270     12  FILLER                            PIC X(73).             ECSCRIFD
   271     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   272     12  FILLER                            PIC X(464).            ECSCRIFD
   273                                                                  ECSCRIFD
   274******************************************************************ECSCRIFD
   275
   276 01  CI-RECORD.
   277     12  FILLER          PIC  X(03).
   278     12  CI-ACCOUNT-CONTROL.
   279         16  CI-CARRIER      PIC  X(01).
   280         16  CI-GROUPING     PIC  X(06).
   281         16  CI-STATE        PIC  X(02).
   282         16  CI-ACCOUNT      PIC  X(10).
   283     12  FILLER          PIC  X(06).
   284     12  CI-CERT-NO.
   285         16  CI-CERT     PIC X(10).
   286         16  CI-CERT-SFX PIC X.
   287     12  FILLER          PIC  X(1017).
   288
   289******************************************************
   290*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   8
* ECS010.cbl
   291*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   292*   COMMERCIAL FEDERAL BANK
   293******************************************************
   294 01  CF-RECORD.
   295     12  FILLER          PIC X(759).
   296     12  CF-THIRD-AGENT  PIC X(10).
   297     12  FILLER          PIC X(7).
   298     12  CF-FOURTH-AGENT PIC X(10).
   299     12  FILLER          PIC X(270).
   300
   301******************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page   9
* ECS010.cbl
   303 FD  ERACCTT-IN.
   304
*  305                             COPY ERCACCT.
   306******************************************************************04/19/98
   307*                                                                *ERCACCT
   308*                                                                *ERCACCT
   309*                            ERCACCT                             *   LV031
   310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   311*                            VMOD=2.031                          *ERCACCT
   312*                                                                *ERCACCT
   313*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   314*                                                                *ERCACCT
   315*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   316*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   317*                                                                *ERCACCT
   318*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   319*                                                                *ERCACCT
   320*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   321*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   322*                                                                *ERCACCT
   323*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   324*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   325*                                                                *ERCACCT
   326*   LOG = NO                                                     *ERCACCT
   327*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   328*                                                                *ERCACCT
   329*                                                                *ERCACCT
   330******************************************************************ERCACCT
   331*                   C H A N G E   L O G
   332*
   333* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   334*-----------------------------------------------------------------
   335*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   336* EFFECTIVE    NUMBER
   337*-----------------------------------------------------------------
   338* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   339* 092705    2005050300006  PEMA  ADD SPP LEASES
   340* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   341* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   342* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   343* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   344* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   345******************************************************************
   346                                                                  ERCACCT
   347 01  ACCOUNT-MASTER.                                              ERCACCT
   348     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   349         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   350                                                                  ERCACCT
   351     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   352         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   353         16  AM-MSTR-CNTRL.                                       ERCACCT
   354             20  AM-CONTROL-A.                                    ERCACCT
   355                 24  AM-CARRIER            PIC X.                 ERCACCT
   356                 24  AM-GROUPING.                                 ERCACCT
   357                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   358                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   359                 24  AM-STATE              PIC XX.                ERCACCT
   360                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   361                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   362                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   363             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   364                                           PIC X(19).             ERCACCT
   365             20  AM-CNTRL-B.                                      ERCACCT
   366                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   367                 24  FILLER                PIC X(4).              ERCACCT
   368             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   369                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   370                                                                  ERCACCT
   371     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   372         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   373         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   374         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   375         16  AM-VG-STATE                   PIC XX.                ERCACCT
   376         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   377         16  AM-VG-DATE.                                          ERCACCT
   378             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   379             20  FILLER                    PIC X(4).              ERCACCT
   380         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   381                                           PIC 9(11)      COMP-3. ERCACCT
   382     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   383         16  FILLER                        PIC X(10).
   384         16  AM-VG-KEY3.
   385             20  AM-VG3-ACCOUNT            PIC X(10).
   386             20  AM-VG3-EXP-DT             PIC XX.
   387         16  FILLER                        PIC X(4).
   388     12  AM-MAINT-INFORMATION.                                    ERCACCT
   389         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   390         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   391         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   392         16  FILLER                        PIC XX.                ERCACCT
   393                                                                  ERCACCT
   394     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   395     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   396                                                                  ERCACCT
   397     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   398         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   399         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   400                                                                  ERCACCT
   401     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   402     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   403                                                                  ERCACCT
   404     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   405     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   406                                                                  ERCACCT
   407     12  AM-NAME                           PIC X(30).             ERCACCT
   408     12  AM-PERSON                         PIC X(30).             ERCACCT
   409     12  AM-ADDRS                          PIC X(30).             ERCACCT
   410     12  AM-CITY.
   411         16  AM-ADDR-CITY                  PIC X(28).
   412         16  AM-ADDR-STATE                 PIC XX.
   413     12  AM-ZIP.                                                  ERCACCT
   414         16  AM-ZIP-PRIME.                                        ERCACCT
   415             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   416                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   417             20  FILLER                    PIC X(4).              ERCACCT
   418         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   419     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   420         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   421         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   422         16  FILLER                        PIC XXX.               ERCACCT
   423     12  AM-TEL-NO.                                               ERCACCT
   424         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   425         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   426         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   427     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   428         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   429         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   430                                                                  ERCACCT
   431     12  AM-COMM-STRUCTURE.                                       ERCACCT
   432         16  AM-DEFN-1.                                           ERCACCT
   433             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   434                 24  AM-AGT.                                      ERCACCT
   435                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   436                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   437                 24  AM-COM-TYP            PIC X.                 ERCACCT
   438                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   439                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   440                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   441                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   442                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   443                 24  AM-GL-CODES           PIC X.                 ERCACCT
   444                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   445                 24  FILLER                PIC X(01).             ERCACCT
   446         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   447             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   448                 24  FILLER                PIC X(11).             ERCACCT
   449                 24  AM-L-COMA             PIC XXX.               ERCACCT
   450                 24  AM-J-COMA             PIC XXX.               ERCACCT
   451                 24  AM-A-COMA             PIC XXX.               ERCACCT
   452                 24  FILLER                PIC X(6).              ERCACCT
   453                                                                  ERCACCT
   454     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   455         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   456                                                                  ERCACCT
   457     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   458                                                                  ERCACCT
   459     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   460         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   461         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   462     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   463         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   464         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   465     12  AM-GPCD                           PIC 99.                ERCACCT
   466     12  AM-IG                             PIC X.                 ERCACCT
   467         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   468         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   469     12  AM-STATUS                         PIC X.                 ERCACCT
   470         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   471         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   472         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   473         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   474         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   475         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   476     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   477     12  AM-ID-NO                          PIC X(11).             ERCACCT
   478                                                                  ERCACCT
   479     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   480     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   481     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   482     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   483     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   484     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   485     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   486     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   487     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   488                                                                  ERCACCT
   489     12  AM-USER-FIELDS.                                          ERCACCT
   490         16  AM-FLD-1                      PIC XX.                ERCACCT
   491         16  AM-FLD-2                      PIC XX.                ERCACCT
   492         16  AM-FLD-3                      PIC XX.                ERCACCT
   493         16  AM-FLD-4                      PIC XX.                ERCACCT
   494         16  AM-FLD-5                      PIC XX.                ERCACCT
   495                                                                  ERCACCT
   496     12  AM-1ST-PROD-DATE.                                        ERCACCT
   497         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   498         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   499         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   500     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   501     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   502         16  AM-PUR-YR                     PIC XX.                ERCACCT
   503         16  AM-PUR-MO                     PIC XX.                ERCACCT
   504         16  AM-PUR-DA                     PIC XX.                ERCACCT
   505     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   506     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   507     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   508     12  AM-INACTIVE-DATE.                                        ERCACCT
   509         16  AM-INA-MO                     PIC 99.                ERCACCT
   510         16  AM-INA-DA                     PIC 99.                ERCACCT
   511         16  AM-INA-YR                     PIC 99.                ERCACCT
   512     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   513                                                                  ERCACCT
   514     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   515     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   516                                                                  ERCACCT
   517     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   518         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   519         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   520         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   521         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   522                                                                  ERCACCT
   523     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   524         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   525         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   526                                                                  ERCACCT
   527     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   528                                                                  ERCACCT
   529     12  AM-OVER-SHORT.                                           ERCACCT
   530         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   531         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   532                                                                  ERCACCT
   533     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   534     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   535                                                                  ERCACCT
   536     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   537     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   538                                                                  ERCACCT
   539     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   540     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   541     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   542     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   543     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   544     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   545     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   546     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   547     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   548     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   549     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   550     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   551     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   552     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   553     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   554     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   555                                                                  ERCACCT
   556     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   557                                                                  ERCACCT
   558     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   559     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   560                                                                  ERCACCT
   561     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   562     12  AM-EARN-METHODS.                                         ERCACCT
   563         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   564             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   565             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   566             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   567             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   568         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   569             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   570             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   571             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   572             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   573         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   574             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   575             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   576             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   577             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   578             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   579             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   580                                                                  ERCACCT
   581     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   582     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   583     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   584                                                                  ERCACCT
   585     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   586     12  AM-RET-P-E                        PIC X.                 ERCACCT
   587     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   588     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   589     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   590     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   591         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   592         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   593     12  AM-RETRO-EARNINGS.                                       ERCACCT
   594         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   595         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   596         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   597     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   598         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   599         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   600     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   601         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   602         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   603         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   604     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   605     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   606                                                                  ERCACCT
   607     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   608         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   609         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   610         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   611         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   612         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   613                                                                  ERCACCT
   614     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   615                                                                  ERCACCT
   616     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   617                                                                  ERCACCT
   618     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   619         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   620                                                                  ERCACCT
   621     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   622         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   623         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   624                                                                  ERCACCT
   625     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   626         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   627                                                                  ERCACCT
   628     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   629         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   630         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   631                                                                  ERCACCT
   632     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   633                                                                  ERCACCT
   634     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   635     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   636     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   637     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   638     12  AM-DCC-UEF-STATE                  PIC XX.
   639     12  FILLER                            PIC XXX.
   640     12  AM-REPORT-CODE-3                  PIC X(10).
   641*    12  FILLER                            PIC X(22).             ERCACCT
   642                                                                  ERCACCT
   643     12  AM-RESERVE-DATE.                                         ERCACCT
   644         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   645         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   646         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   647                                                                  ERCACCT
   648     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   649     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   650         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   651         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   652         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   653         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   654                                                                  ERCACCT
   655     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   656         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   657         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   658         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   659         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   660                                                                  ERCACCT
   661     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   662         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   663             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   664             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   665             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   666             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   667             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   668             20  FILLER                    PIC XX.                ERCACCT
   669         16  FILLER                        PIC X(80).             ERCACCT
   670                                                                  ERCACCT
   671     12  AM-TRANSFER-DATA.                                        ERCACCT
   672         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   673             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   674             20  AM-TRNFROM-GROUPING.                             ERCACCT
   675                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   676                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   677             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   678             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   679                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   680                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   681             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   682         16  AM-TRANSFERRED-TO.                                   ERCACCT
   683             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   684             20  AM-TRNTO-GROUPING.                               ERCACCT
   685                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   686                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   687             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   688             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   689                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   690                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   691             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   692         16  FILLER                        PIC X(10).             ERCACCT
   693                                                                  ERCACCT
   694     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   695                                                                  ERCACCT
   696     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   697         16  AM-DEFN-1-SAVED.                                     ERCACCT
   698             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   699                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   700                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   701                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   702                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   703                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   704                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   705                 24  FILLER                PIC X.                 ERCACCT
   706                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   707                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   708                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   709         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   710             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   711                 24  FILLER                PIC X(11).             ERCACCT
   712                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   713                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   714                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   715                 24  FILLER                PIC X(6).              ERCACCT
   716                                                                  ERCACCT
   717     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   718         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   719            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   720            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   721            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   722                                                                  ERCACCT
   723     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   724     12  FILLER                            PIC X(120).            ERCACCT
   725                                                                  ERCACCT
   726     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   727         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   728         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   729             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   730             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   731                                                          COMP-3. ERCACCT
   732             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   733                                                          COMP-3. ERCACCT
   734         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   735             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   736             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   737                                                          COMP-3. ERCACCT
   738             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   739                                                          COMP-3. ERCACCT
   740                                                                  ERCACCT
   741     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   742         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   743         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   744         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   745         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   746             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   747                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   748                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   749             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   750                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   751                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   752             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   753                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   754                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   755         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   756             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   757                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   758                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   759                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   760             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   761                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   762                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   763             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   764                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   765                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   766                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   767     12  AM-COMMENTS.                                             ERCACCT
   768         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   769                                                                  ERCACCT
   770     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   771         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   772         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   773         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   774         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   775         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   776             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   777             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   778             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   779             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   780         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   781             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   782             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   783             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   784         16  FILLER                        PIC X(102).            ERCACCT
   785                                                                  ERCACCT
   786     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   787         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   788             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   789             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   790             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   791             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   792             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   793         16  FILLER                          PIC X(10).           ERCACCT
   794******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  18
* ECS010.cbl
   796 FD  ERRTBL-IN.
   797
*  798                             COPY ERCREIN.
   799******************************************************************07/27/93
   800*                                                                *ERCREIN
   801*                            ERCREIN                             *   LV009
   802*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   803*                            VMOD=2.010                          *   CL**9
   804*                                                                *ERCREIN
   805*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   806*                                                                *ERCREIN
   807*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   808*                                                                *ERCREIN
   809*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   810*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   811*                                                                *ERCREIN
   812*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   813*       ALTERNATE PATH = NONE                                    *ERCREIN
   814*                                                                *ERCREIN
   815*   LOG = NO                                                     *ERCREIN
   816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   817*                                                                *ERCREIN
   818******************************************************************ERCREIN
   819*                   C H A N G E   L O G
   820*
   821* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   822*-----------------------------------------------------------------
   823*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   824* EFFECTIVE    NUMBER
   825*-----------------------------------------------------------------
   826* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   827* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   828******************************************************************
   829 01  REINSURANCE-RECORD.                                          ERCREIN
   830     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   831         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   832                                                                  ERCREIN
   833     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   834         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   835         16  RE-KEY.                                              ERCREIN
   836             20  RE-CODE                   PIC X.                 ERCREIN
   837                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   838                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   839             20  RE-TABLE                  PIC XXX.               ERCREIN
   840             20  FILLER                    PIC XXX.               ERCREIN
   841         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   842             20  FILLER                    PIC X.                 ERCREIN
   843             20  RE-COMPANY.                                      ERCREIN
   844                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   845                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   846                                                                  ERCREIN
   847     12  RE-MAINT-INFORMATION.                                    ERCREIN
   848         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   849         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   850         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   851         16  FILLER                        PIC X(10).             ERCREIN
   852                                                                  ERCREIN
   853     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   854         16  RE-100-COMP                   PIC 99.                ERCREIN
   855                                                                  ERCREIN
   856         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   857             20  RE-REI-COMP-NO.                                  ERCREIN
   858                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   859                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   860             20  RE-LF-QC                  PIC X.                 ERCREIN
   861             20  RE-AH-QC                  PIC X.                 ERCREIN
   862             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   863             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   864             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   865             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   866             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   867             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   868             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   869             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   870             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   871             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   872             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   873             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   874             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   875             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   876             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   877             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   878             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   879             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   880             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   881             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   882             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   883             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   887             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   888             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   889             20  RE-REMAINING              PIC X.                 ERCREIN
   890             20  RE-LF-RUNOFF-SW           PIC X.                      000
   891             20  RE-AH-RUNOFF-SW           PIC X.                      000
   892             20  FILLER                    PIC X(19).                  000
   893                                                                  ERCREIN
   894         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   895         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   896         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   897         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   898             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   899                                                                  ERCREIN
   900         16  FILLER                        PIC X(27).             ERCREIN
   901                                                                  ERCREIN
   902     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   903         16  RE-NAME                       PIC X(30).             ERCREIN
   904         16  RE-LF-PE                      PIC X.                 ERCREIN
   905         16  RE-AH-PE                      PIC X.                 ERCREIN
   906         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   907         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   908         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   909         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   910         16  RE-PRT-ST                     PIC X.                 ERCREIN
   911         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   912         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   913         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   914         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   915         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   916         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   917         16  RE-LF-COMM                    PIC X.                 ERCREIN
   918         16  RE-AH-COMM                    PIC X.                 ERCREIN
   919         16  RE-LF-TAX                     PIC X.                 ERCREIN
   920         16  RE-AH-TAX                     PIC X.                 ERCREIN
   921         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   922         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   923         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   924                                                                  ERCREIN
   925         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   926             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   927                                                                  ERCREIN
   928         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   929             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   930                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   931                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   932                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   933                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   934             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   935                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   936                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   937                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   938                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   939                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   940                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   941                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   942                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   943             20  FILLER                    PIC XXX.               ERCREIN
   944             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   945                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   946                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   947                                                                  ERCREIN
   948         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   949             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   950                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   951                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   952                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   953                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   954             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   955                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   956                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   957                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   958                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   959                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   960                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   961                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   962                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   963             20  FILLER                    PIC XXX.               ERCREIN
   964             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   965                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   966                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   967                                                                  ERCREIN
   968         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   969                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   970         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   971                                                                  ERCREIN
   972         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   973         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   974         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   975         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   976         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   977         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   978         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   979         16  RE-MORT-SW                    PIC X.                 ERCREIN
   980         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   981             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   982             88  RE-CEDED                          VALUE 'C'.        CL**2
   983             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   984             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   985                                                                  ERCREIN
   986         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   987             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   988         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   989             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   990         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   991             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   992         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   993             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   994         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   995             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   996                                                                     CL**3
   997         16  RE-PRT-CRSV                   PIC X.                    CL**5
   998                                                                     CL**5
   999         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1000                                                                     CL**8
  1001         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1002                                                                     CL**8
  1003         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1004                                                                     CL**9
  1005         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1006             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1007             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1008
  1009         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1010             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1011                                                                     CL**9
  1012         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1013         16  FILLER                        PIC X(2281).              CL**9
  1014                                                                  ERCREIN
  1015         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1016                                                                  ERCREIN
  1017******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  22
* ECS010.cbl
  1019 FD  ERCTBL.
  1020
* 1021                             COPY ERCCTBL.
  1022******************************************************************04/29/98
  1023*                                                                *ERCCTBL
  1024*                                                                *ERCCTBL
  1025*                            ERCCTBL                             *   LV002
  1026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1027*                            VMOD=2.003                              CL**2
  1028*                                                                *ERCCTBL
  1029*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1030*                                                                *ERCCTBL
  1031*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1032*                                                                *ERCCTBL
  1033*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1034*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1035*                                                                *ERCCTBL
  1036*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1037*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1038*                                                                *ERCCTBL
  1039*   LOG = NO                                                     *ERCCTBL
  1040*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1041*                                                                *ERCCTBL
  1042*                                                                *ERCCTBL
  1043******************************************************************ERCCTBL
  1044                                                                  ERCCTBL
  1045 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1046     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1047         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1048                                                                  ERCCTBL
  1049     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1050         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1051         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1052         16  CT-CNTRL-2.                                          ERCCTBL
  1053             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1054             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1055                                                                  ERCCTBL
  1056     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1057         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1058         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1059         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1060         16  FILLER                        PIC X(31).             ERCCTBL
  1061                                                                  ERCCTBL
  1062     12  CT-LIMITS.                                               ERCCTBL
  1063         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1064                                                                  ERCCTBL
  1065         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1066                                                                  ERCCTBL
  1067         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1068                                                                  ERCCTBL
  1069     12  CT-RATES.                                                ERCCTBL
  1070         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1071             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1072             20  CT-RT-R   REDEFINES                              ERCCTBL
  1073                 CT-RT                     PIC XXX.               ERCCTBL
  1074                                                                  ERCCTBL
  1075     12  FILLER                            PIC  X(42).            ERCCTBL
  1076                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  23
* ECS010.cbl
  1077******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  24
* ECS010.cbl
  1079 FD  ERMEBL-INOUT.
  1080
* 1081                             COPY ERCMEBL.
  1082******************************************************************04/29/98
  1083*                                                                 ERCMEBL
  1084*                                                                 ERCMEBL
  1085*                            ERCMEBL                             *   LV004
  1086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1087*                            VMOD 2.004                          *   CL**2
  1088*                                                                *ERCMEBL
  1089*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1090*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1091*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1092*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1093*                                                                *ERCMEBL
  1094*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1095*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1096*                                                                *ERCMEBL
  1097*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1098*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1099*                                                                *ERCMEBL
  1100******************************************************************ERCMEBL
  1101                                                                  ERCMEBL
  1102 01  MONTH-END-BALANCES.                                          ERCMEBL
  1103     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1104     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1105         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1106         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1107     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1108     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1109     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1110     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1111     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1112     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1118     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1119     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1120     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1121     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1122     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1123     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1124     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1125     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1126     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1127     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1128     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1129     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1130     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1131     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1132     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1133     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1134     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1135     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1136     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1137     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1138     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1140     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1141     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1142     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1143     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1144     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1145     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1146     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1147     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1148     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1149     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1150     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1151     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1152     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1153     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1154     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1155     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1156     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1157     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1158     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1159     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1160     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1161     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1162     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1163     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1164     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1165     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1166     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1167     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1168     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1169     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1170     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1171     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1172     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1173     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1174     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1175     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1176     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1177     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1178     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1179     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1180     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1181     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1182     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1183     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1184     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1187     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1188     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1189     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1190     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1191     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1192     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1193     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1194     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1195     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1196     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1197     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1198     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1199     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1200     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1201     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1202     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1203     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1204     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1205     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1206     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1207     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1208     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1209     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1210     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1211     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1212     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1213     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1214     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1215     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1216     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1217     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1218     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1219     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1220     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1221     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1222     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1223     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1224     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1225     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1226     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1236     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1237     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1238     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1239     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1240     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1241     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1242     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1243     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1244     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1245     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1246     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1247     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1248     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1249     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1250     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1251     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1252     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1253     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1254     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1255     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1256     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1257     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1258     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1259     12  FILLER                  PIC  X(88).                         CL**2
  1260******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  28
* ECS010.cbl
  1262 FD  CERT-MASTER-OUT
* 1263                             COPY ECSCROFD.
  1264******************************************************************07/10/97
  1265*                                                                *ECSCROFD
  1266*                            ECSCROFD                            *   LV001
  1267*                            VMOD=2.002                          *ECSCROFD
  1268*                                                                *ECSCROFD
  1269*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1270*                                                                *ECSCROFD
  1271******************************************************************ECSCROFD
  1272     RECORDING MODE F                                             ECSCROFD
  1273     LABEL RECORDS STANDARD                                       ECSCROFD
  1274     BLOCK CONTAINS 0 RECORDS
  1275     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1276 01  CERT-OUT-RECORD.                                             ECSCROFD
  1277     12  FILLER                            PIC  XXX.              ECSCROFD
  1278     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1279     12  FILLER                            PIC  X(1017).          ECSCROFD
  1280                                                                  ECSCROFD
  1281******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  29
* ECS010.cbl
  1283 FD  DETAIL-EXTR
  1284     BLOCK CONTAINS 0 RECORDS
  1285     RECORDING MODE F.
  1286
* 1287                             COPY ECSEXT01.
  1288******************************************************************04/29/98
  1289*                                                                *ECSEXT01
  1290*                            ECSEXT01                            *   LV015
  1291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1292*                            VMOD=2.015                          *ECSEXT01
  1293*                                                                *ECSEXT01
  1294*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1295*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1296*                                                                *ECSEXT01
  1297*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1298*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1299*                                                                *ECSEXT01
  1300*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1301*                                                                *ECSEXT01
  1302******************************************************************ECSEXT01
  1303******************************************************************
  1304*                   C H A N G E   L O G
  1305*
  1306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1307*-----------------------------------------------------------------
  1308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1309* EFFECTIVE    NUMBER
  1310*-----------------------------------------------------------------
  1311* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1312* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1313* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1314* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1315* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1316* 032612  CR2011110200001  PEMA  AHL CHANGES
  1317******************************************************************
  1318                                                                  ECSEXT01
  1319 01  DETAIL-EXTRACT.                                              ECSEXT01
  1320     02 DETAIL-FILE.                                              ECSEXT01
  1321     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1322         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1323                                                                  ECSEXT01
  1324     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1325                                                                  ECSEXT01
  1326     12  DE-REIN                           PIC X.                 ECSEXT01
  1327                                                                  ECSEXT01
  1328     12  DE-CONTROL.                                              ECSEXT01
  1329         16  DE-CNTRL1.                                           ECSEXT01
  1330             20  DE-CARRIER                PIC X.                 ECSEXT01
  1331             20  DE-GROUPING.                                     ECSEXT01
  1332                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1333                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1334             20  DE-STATE                  PIC XX.                ECSEXT01
  1335             20  DE-ACCOUNT.                                      ECSEXT01
  1336                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1337                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1338         16  DE-CNTRL2.                                           ECSEXT01
  1339             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1340             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1341                 24 DE-CERT-NO.                                   ECSEXT01
  1342                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1343                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1344                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1345                                                                  ECSEXT01
  1346     12  DE-TRANS                          PIC X.                 ECSEXT01
  1347         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1348         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1349         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1350         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1351         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1352         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1353         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1354         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1355         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1356         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1357                                                                  ECSEXT01
  1358     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1359     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1360                                                                  ECSEXT01
  1361     12  DE-NAME.                                                 ECSEXT01
  1362         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1363         16  DE-FNAME.                                            ECSEXT01
  1364             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1365             20  FILLER                    PIC X(9).              ECSEXT01
  1366         16  DE-INIT                       PIC X.                 ECSEXT01
  1367     12  DE-AGE                            PIC 99.                ECSEXT01
  1368     12  DE-SEX                            PIC X.                 ECSEXT01
  1369     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1370                                                                  ECSEXT01
  1371     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1372     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1373     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1374     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1375     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1376     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1377     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1378     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1379     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1380                                                                  ECSEXT01
  1381     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1382     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1383     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1384     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1385                                                                  ECSEXT01
  1386     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1387     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1388     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1389     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1390     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1391                                                                  ECSEXT01
  1392     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1393     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1394     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1395     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1396                                                                  ECSEXT01
  1397     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1398     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1399                                           PIC S9(5)V99   COMP-3.
  1400     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1401     12  FILLER REDEFINES DE-NUM-BILLED.
  1402         16  DE-CLP-STATE                  PIC XX.
  1403         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1404     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1405     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1406                                                                  ECSEXT01
  1407     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1408     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1409     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1410     12  DE-IG                             PIC X.                 ECSEXT01
  1411     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1412*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1413     12  DE-MEMBER-NO.                                            ECSEXT01
  1414         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1415         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1416         16  FILLER                        PIC X(03).             ECSEXT01
  1417     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1418                                                                  ECSEXT01
  1419     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1420         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1421                                                                  ECSEXT01
  1422     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1423     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1424                                                                  ECSEXT01
  1425     12  DE-REI-AREA.                                             ECSEXT01
  1426         16  DE-REI-COMP.                                         ECSEXT01
  1427             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1428             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1429         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1430         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1431         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1432         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1433         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1434         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1435         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1436                                                                  ECSEXT01
  1437     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1438     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1439         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1440         16  F                             PIC X.
  1441*    12  FILLER                            PIC X(5).              ECSEXT01
  1442                                                                  ECSEXT01
  1443     12  DE-BILLED-AREA.                                          ECSEXT01
  1444         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1445             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1446                                                                  ECSEXT01
  1447         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1448             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1449             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1450             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1451             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1452             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1453             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1454                                                                  ECSEXT01
  1455         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1456             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1457                                                                  ECSEXT01
  1458         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1459         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1460         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1461         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1462                                                                  ECSEXT01
  1463         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1464*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1465*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1466                                                                  ECSEXT01
  1467     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1468         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1469         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1470         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1471                                                                  ECSEXT01
  1472     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1473         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1474         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1475     12  DE-CANCEL-REASON                  PIC X.
  1476                                                                  ECSEXT01
  1477     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1478     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1479                                                                  ECSEXT01
  1480     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1481         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1482             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1483         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1484             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1485                                                                  ECSEXT01
  1486     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1487         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1488                                                                  ECSEXT01
  1489     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1490     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1491         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1492         16  FILLER                        PIC X.
  1493                                                                  ECSEXT01
  1494****************************************************************  ECSEXT01
  1495**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1496****************************************************************  ECSEXT01
  1497     12  DE-COMM-LEVELS.                                          ECSEXT01
  1498         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1499             20  DE-AGT.                                          ECSEXT01
  1500                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1501                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1502             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1503             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1504             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1505                                                                  ECSEXT01
  1506     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1507****************************************************************  ECSEXT01
  1508*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1509****************************************************************  ECSEXT01
  1510     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1511     12  FILLER                            PIC X(334).            ECSEXT01
  1512     12  DE-TYPE                           PIC X.                 ECSEXT01
  1513         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1514         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1515         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1516         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1517         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1518         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1519                                                                  ECSEXT01
  1520     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1521     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1522                                                                  ECSEXT01
  1523     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1524     12  DE-REPORTED.                                             ECSEXT01
  1525         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1526         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1527         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1528     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1529     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1530                                                                  ECSEXT01
  1531     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1532     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1533     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1534     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1535     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1536     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1537         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1538         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1539         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1540         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1541         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1542         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1543         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1544                                                                  ECSEXT01
  1545     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1546                                                                  ECSEXT01
  1547     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1548     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1549     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1550     12  FILLER                            PIC XX.                ECSEXT01
  1551     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1552                                                                  ECSEXT01
  1553     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1554     12  DE-BENEFICIARY                    PIC X(10).
  1555     12  filler redefines de-beneficiary.
  1556         16  de-birth-date                 pic 9(11)  comp-3.
  1557         16  f                             pic x(4).
  1558     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1559     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1560     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1561     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1562     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1563     12  DE-CLM-CLASS                      PIC XX.
  1564     12  DE-CLM-DEV                        PIC XXX.
  1565     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1566     12  de-xycor-cert-seq                 pic x(3).
  1567     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1568     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1569     12  DE-XYCOR-STATUS                   PIC X.
  1570     12  FILLER                            PIC X(4).              ECSEXT01
  1571                                                                  ECSEXT01
  1572     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1573                                                                  ECSEXT01
  1574****************************************************************  ECSEXT01
  1575*******               RESERVE EXTRACT                      *****  ECSEXT01
  1576****************************************************************  ECSEXT01
  1577     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1578     12  FILLER                            PIC X(334).            ECSEXT01
  1579                                                                  ECSEXT01
  1580     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1581         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1582         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1583                                                                  ECSEXT01
  1584     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1585     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1586     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1587                                                                  ECSEXT01
  1588     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1589                                                                  ECSEXT01
  1590     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1591     12  DE-RSV-REPORTED.                                         ECSEXT01
  1592         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1593         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1594         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1595     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1596                                                                  ECSEXT01
  1597     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1598     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1599     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1600                                                                  ECSEXT01
  1601     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1602     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1603     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1604                                                                  ECSEXT01
  1605     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1606                                                                  ECSEXT01
  1607     12  DE-RATE-CLASS                     PIC XX.
  1608     12  DE-DEV-CODE                       PIC XXX.
  1609     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1610     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1611     12  FILLER                            PIC X(58).             ECSEXT01
  1612                                                                  ECSEXT01
  1613     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1614******************************************************************ECSEXT01
  1615
  1616 FD  NEW-DETAIL-EXTR
  1617     BLOCK CONTAINS 0 RECORDS
  1618     RECORDING MODE F.
  1619
* 1620                                 COPY ECSEXX01.
  1621******************************************************************
  1622*                                                                *
  1623*                            ECSEXX01                            *
  1624*                            VMOD=2.015                          *
  1625*                                                                *
  1626*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1627*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1628*                                                                *
  1629*   FILE TYPE = SEQUENTIAL                                       *
  1630*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1631*                                                                *
  1632*   KEY DATA =                                   START=5, LEN=36 *
  1633*                                                                *
  1634******************************************************************
  1635******************************************************************
  1636*                   C H A N G E   L O G
  1637*
  1638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1639*-----------------------------------------------------------------
  1640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1641* EFFECTIVE    NUMBER
  1642*-----------------------------------------------------------------
  1643*                                    TEMPORARY
  1644******************************************************************
  1645
  1646 01  NEW-DETAIL-EXTRACT.
  1647     02 NEW-DETAIL-FILE.
  1648     12  DX-RECORD-ID                      PIC XX.
  1649         88  VALID-DX-ID                      VALUE 'DX'.
  1650
  1651     12  DX-COMPANY-CD                     PIC X.
  1652
  1653     12  DX-REIN                           PIC X.
  1654
  1655     12  DX-CONTROL.
  1656         16  DX-CNTRL1.
  1657             20  DX-CARRIER                PIC X.
  1658             20  DX-GROUPING.
  1659                 24  DX-GROUP-PREFIX       PIC XXX.
  1660                 24  DX-GROUP-PRIME        PIC XXX.
  1661             20  DX-STATE                  PIC XX.
  1662             20  DX-ACCOUNT.
  1663                 24  DX-ACCT-PREFIX        PIC X(4).
  1664                 24  DX-ACCT-PRIME         PIC X(6).
  1665         16  DX-CNTRL2.
  1666             20  DX-EFF                    PIC 9(11)  COMP-3.
  1667             20  DX-CERT.
  1668                 24 DX-CERT-NO.
  1669                     28  DX-CRT-PREFIX     PIC XXX.
  1670                     28  DX-CRT-PRIME      PIC X(7).
  1671                 24  DX-CRT-SUF            PIC X.
  1672
  1673     12  DX-TRANS                          PIC X.
  1674         88  DX-ISSUE                         VALUE 'I'.
  1675         88  DX-RC-ISSUE                      VALUE '8'.
  1676         88  DX-CANCEL                        VALUE 'C'.
  1677         88  DX-RC-CANCEL                     VALUE '7'.
  1678         88  DX-CLAIM                         VALUE 'X'.
  1679         88  DX-RESTORE                       VALUE 'R'.
  1680         88  DX-RESERVE                       VALUE 'Y'.
  1681         88  DX-RR-RC-ISS                     VALUE 'J'.
  1682         88  DX-RR-RC-CNC                     VALUE 'K'.
  1683         88  DX-RR-RC-CLM                     VALUE 'L'.
  1684
  1685     12  DX-REPORT-CODX-1                  PIC X(10).
  1686     12  DX-REPORT-CODX-2                  PIC X(10).
  1687
  1688     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1689         16  DX-LNAME                      PIC X(15).
  1690         16  DX-FNAME.
  1691             20  DX-1ST-INIT-FNAME         PIC X.
  1692             20  FILLER                    PIC X(9).
  1693         16  DX-INIT                       PIC X.
  1694     12  DX-AGE                            PIC 99.
  1695     12  DX-SEX                            PIC X.
  1696     12  DX-SOC-SEC-NO                     PIC X(11).
  1697
  1698     12  DX-LF-TYPE                        PIC XX.
  1699     12  DX-LF-TERM                        PIC 999        COMP-3.
  1700     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1701     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1702     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1703     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1704     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1705     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1706     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1707
  1708     12  DX-LF-STAT-CDE                    PIC X.
  1709     12  DX-LF-PREV-STAT                   PIC X.
  1710     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1711     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1712
  1713     12  DX-AH-TYPE                        PIC XX.
  1714     12  DX-AH-TERM                        PIC 999        COMP-3.
  1715     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1716     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1717     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1718
  1719     12  DX-AH-STAT-CDE                    PIC X.
  1720     12  DX-AH-PREV-STAT                   PIC X.
  1721     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1722     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1723
  1724     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1725     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1726                                           PIC S9(5)V99   COMP-3.
  1727     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1728     12  FILLER REDEFINES DX-NUM-BILLED.
  1729         16  DX-CLP-STATE                  PIC XX.
  1730         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1731     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1732     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1733
  1734     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1735     12  DX-PMT-FREQ                       PIC 99.
  1736     12  DX-ACC-GPCD                       PIC XX.
  1737     12  DX-IG                             PIC X.
  1738     12  DX-REMIT-TO                       PIC XX.
  1739*    12  DX-MEMBER-NO                      PIC X(12).
  1740     12  DX-MEMBER-NO.
  1741         16  DX-MASTER-POLICY              PIC X(06).
  1742         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1743         16  FILLER                        PIC X(03).
  1744     12  DX-LN-OFFICER                     PIC XXX.
  1745
  1746     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1747         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1748
  1749     12  DX-ENTRY-STATUS                   PIC X.
  1750     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1751
  1752     12  DX-REI-AREA.
  1753         16  DX-REI-COMP.
  1754             20  DX-REINCO                 PIC XXX.
  1755             20  DX-REINCO-SUB             PIC XXX.
  1756         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1757         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1758         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1759         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1760         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1761         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1762         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1763
  1764     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1765     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1766         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1767         16  F                             PIC X.
  1768*    12  FILLER                            PIC X(5).
  1769
  1770     12  DX-BILLED-AREA.
  1771         16  DX-GL-INTERFACE-CODES.
  1772             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1773
  1774         16  DX-BILL-SW                    PIC X.
  1775             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1776             88  DX-RECORD-RETURNED           VALUE 'R'.
  1777             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1778             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1779             88  DX-OVERRIDX-AH               VALUE 'A'.
  1780             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1781
  1782         16  DX-REFUND-SW                  PIC X.
  1783             88  DX-REFUND-CREATED            VALUE 'Y'.
  1784
  1785         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1786         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1787         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1788         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1789
  1790         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1791*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1792*            88  DX-BILLED-GA                 VALUE 'B'.
  1793
  1794     12  DX-BILL-STATUS                    PIC X.
  1795         88  DX-NO-PRE-BILL                   VALUE ' '.
  1796         88  DX-BILLED                        VALUE 'B'.
  1797         88  DX-REVERSE                       VALUE 'R'.
  1798
  1799     12  DX-REVERSE-REASONS.
  1800         16  DX-REVERSE-REASON-1           PIC X.
  1801         16  DX-REVERSE-REASON-2           PIC X.
  1802     12  DX-CANCEL-REASON                  PIC X.
  1803
  1804     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1805     12  DX-RECALC-TYPE                    PIC X.
  1806
  1807     12  DX-CHARGEBACK-CODES.
  1808         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1809             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1810         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1811             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1812
  1813     12  DX-UNDERWRITING-CODE              PIC X.
  1814         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1815
  1816     12  DX-NCL-POOL-CODE                  PIC XXX.
  1817     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1818         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1819         16  FILLER                        PIC X.
  1820
  1821****************************************************************
  1822**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1823****************************************************************
  1824     12  DX-COMM-LEVELS.
  1825         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1826             20  DX-AGT.
  1827                 24  DX-AGT-PREFIX         PIC X(4).
  1828                 24  DX-AGT-PRIME          PIC X(6).
  1829             20  DX-AGT-TYPE               PIC X.
  1830             20  DX-L-PC                   PIC S999V99    COMP-3.
  1831             20  DX-A-PC                   PIC S999V99    COMP-3.
  1832
  1833     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1834****************************************************************
  1835*******                 CLAIM EXTRACT                      *****
  1836****************************************************************
  1837     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1838     12  FILLER                            PIC X(334).
  1839     12  DX-TYPE                           PIC X.
  1840         88  DX-DTH                           VALUE '1'.
  1841         88  DX-AH                            VALUE '2'.
  1842         88  DX-OB-DTH                        VALUE '3'.
  1843         88  DX-OB-AH                         VALUE '4'.
  1844         88  DX-DEATH                         VALUES '1' '3'.
  1845         88  DX-DISABILITY                    VALUES '2' '4'.
  1846
  1847     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1848     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1849
  1850     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1851     12  DX-REPORTED.
  1852         16  DX-RPT-YR                     PIC 99.
  1853         16  DX-RPT-MO                     PIC 99.
  1854         16  DX-RPT-DA                     PIC 99.
  1855     12  DX-PAY                            PIC 9(11)      COMP-3.
  1856     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1857
  1858     12  DX-CNUM                           PIC X(7).
  1859     12  DX-CHECK                          PIC X(7).
  1860     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1861     12  DX-DAYS-DISAB                     PIC 999.
  1862     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1863     12  DX-PAY-CODE                       PIC X.
  1864         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1865         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1866         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1867         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1868         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1869         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1870         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1871
  1872     12  DX-CLM-ERR                        PIC XX.
  1873
  1874     12  DX-ACC-NAME                       PIC X(30).
  1875     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1876     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1877     12  FILLER                            PIC XX.
  1878     12  DX-LOAN-OFFICER                   PIC XXX.
  1879
  1880     12  DX-LOAN-TYPE                      PIC X(02).
  1881     12  DX-BENEFICIARY                    PIC X(10).
  1882     12  filler redefines DX-beneficiary.
  1883         16  DX-birth-date                 pic 9(11)  comp-3.
  1884         16  f                             pic x(4).
  1885     12  DX-LOAN-CLASS                     PIC X(02).
  1886     12  DX-LOSS-CODE                      PIC X(06).
  1887     12  DX-ASSOCIATES                     PIC X(01).
  1888     12  DX-LEGAL-STATE                    PIC X(02).
  1889     12  DX-CLM-CAUSE                      PIC X(6).
  1890     12  DX-CLM-CLASS                      PIC XX.
  1891     12  DX-CLM-DEV                        PIC XXX.
  1892     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1893     12  DX-xycor-cert-seq                 pic x(3).
  1894     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1895     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1896     12  DX-XYCOR-STATUS                   PIC X.
  1897     12  FILLER                            PIC X(4).
  1898
  1899     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1900
  1901****************************************************************
  1902*******               RESERVE EXTRACT                      *****
  1903****************************************************************
  1904     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1905     12  FILLER                            PIC X(334).
  1906
  1907     12  DX-RESERVE-TYPE                   PIC X.
  1908         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1909         88  DX-AH-RSV                        VALUE '2' '4'.
  1910
  1911     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1912     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1913     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1914
  1915     12  DX-CLMNO                          PIC X(7).
  1916
  1917     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1918     12  DX-RSV-REPORTED.
  1919         16  DX-RSV-RPT-YR                 PIC 99.
  1920         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1921         16  DX-RSV-RPT-DA                 PIC 99.
  1922     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1923
  1924     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1925     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1926     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1927
  1928     12  DX-RSV-ACC-NAME                   PIC X(30).
  1929     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1930     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1931
  1932     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1933
  1934     12  DX-RATE-CLASS                     PIC XX.
  1935     12  DX-DEV-CODE                       PIC XXX.
  1936     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1937     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1938     12  FILLER                            PIC X(58).
  1939
  1940     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1941******************************************************************
  1942
  1943 FD  SUMMARY-EXTR
  1944     BLOCK CONTAINS 0 RECORDS
  1945     RECORDING MODE F.
  1946
* 1947                             COPY ECSEPC01.
  1948******************************************************************
  1949*                                                                *
  1950*                            ECSEPC01                            *
  1951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1952*                            VMOD=2.008                          *
  1953*                                                                *
  1954*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1955*                                                                *
  1956*   FILE TYPE = SEQUENTIAL                                       *
  1957*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1958*                                                                *
  1959*   KEY DATA =                                  START=5, LEN=31  *
  1960*                                                                *
  1961*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1962*                                                                *
  1963******************************************************************
  1964
  1965 01  EP-RECORD.
  1966     02 EP-FILE.
  1967     12  EP-RECORD-ID                      PIC XX.
  1968         88  VALID-EP-ID                      VALUE 'EP'.
  1969
  1970     12  EP-COMPANY-CD                     PIC X.
  1971
  1972     12  EP-REIN                           PIC X.
  1973         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1974
  1975     12  EP-CONTROL.
  1976         16  EP-CNTRL-1.
  1977             20  EP-COMPANY.
  1978                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1979                 24  EP-GROUPING.
  1980                     28  EP-GROUP-PREFIX   PIC XXX.
  1981                     28  EP-GROUP-PRIME    PIC XXX.
  1982             20  EP-STATE                  PIC XX.
  1983             20  EP-ACCOUNT.
  1984                 24  EP-ACCT-PREFIX        PIC X(4).
  1985                 24  EP-ACCT-PRIME         PIC X(6).
  1986         16  EP-CNTRL-2.
  1987             20  EP-DATES.
  1988                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1989                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1990
  1991     12  EP-REI-CO.
  1992         16  EP-REINCO                     PIC XXX.
  1993         16  EP-REINCO-SUB                 PIC XXX.
  1994
  1995     12  EP-RCD-TYPE                       PIC X.
  1996         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1997         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1998         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1999         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2000         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2001         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2002     12  EP-BEN-CODE                       PIC XX.
  2003     12  FILLER                            PIC X.
  2004
  2005     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2006     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2007     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2008
  2009     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2010     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2011     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2012
  2013     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2014     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2015     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2016     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2017
  2018     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2019     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2020     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2021
  2022     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2023     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2024     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2025
  2026     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2027     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2028     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2029     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2030     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2031
  2032     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2033     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2034     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2035
  2036     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2037     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2038     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2039
  2040     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2041         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2042         16  EP-NEW-DATA-IND               PIC X(01).
  2043             88  EP-NEW-DATA                   VALUE 'Y'.
  2044         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2045         16  FILLER                        PIC X(19).
  2046
  2047     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2048     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2049     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2050
  2051     12  FILLER                            PIC XXX.
  2052
  2053     12  EP-UNDERWRITING-CODE              PIC X.
  2054         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2055
  2056     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
  2057
  2058     12  FILLER                            PIC X(30).
  2059*    12  FILLER                            PIC X(34).
  2060
  2061     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2062     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2063     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2064     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2065     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2066     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2067
  2068     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2069
  2070     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2071     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2072
  2073     12  EP-PURGE                          PIC X.
  2074         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2075
  2076     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2077
  2078     02 EC-RECORD     REDEFINES     EP-FILE.
  2079     12  EC-RECORD-ID                      PIC XX.
  2080         88  VALID-EC-ID                      VALUE 'EC'.
  2081
  2082     12  EC-COMPANY-CD                     PIC X.
  2083
  2084     12  EC-REIN                           PIC X.
  2085         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2086
  2087     12  EC-CONTROL.
  2088         16  EC-CARRIER                    PIC X.
  2089         16  EC-GROUPING.
  2090             20  EC-GROUP-PREFIX           PIC XXX.
  2091             20  EC-GROUP-PRIME            PIC XXX.
  2092         16  EC-STATE                      PIC XX.
  2093         16  EC-ACCOUNT.
  2094             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2095             20  EC-ACCT-PRIME             PIC X(6).
  2096         16  EC-DATES.
  2097             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2098             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2099
  2100     12  EC-REI-CO.
  2101         16  EC-REINCO                     PIC XXX.
  2102         16  EC-REINCO-SUB                 PIC XXX.
  2103
  2104     12  EC-RCD-TYPE                       PIC X.
  2105         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2106         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2107         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2108         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2109         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2110     12  EC-BEN-CODE                       PIC XX.
  2111     12  EC-SEQ-NBR                        PIC X.
  2112         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2113         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2114
  2115     12  EC-AGENTS-DATA.
  2116         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2117             20  EC-AGT-NO.
  2118                 24  EC-AGT-PREFIX         PIC X(4).
  2119                 24  EC-AGT-PRIME          PIC X(6).
  2120             20  EC-AGT-TYPE               PIC X.
  2121             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2122             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2123             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2124             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2125             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2126
  2127     12  EC-UNDERWRITING-CODE              PIC X.
  2128         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2129
  2130     12  EC-AGENTS-DATA-II.
  2131         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2132             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2133             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2134
  2135     12  FILLER                            PIC X(7).
  2136
  2137     12  EC-PURGE                          PIC X.
  2138         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2139
  2140     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2141
  2142******************************************************************
  2143
  2144 FD  ERRESC-IN.
* 2145                             COPY ERCRESC.
  2146******************************************************************04/29/98
  2147*                                                                *ERCRESC
  2148*                            ERCRESC                             *   LV002
  2149*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2150*                            VMOD=2.003                          *   CL**2
  2151*                                                                *ERCRESC
  2152*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2153*                                                                *ERCRESC
  2154*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2155*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2156*                                                                *ERCRESC
  2157*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2158*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2159*                                                                *ERCRESC
  2160*   LOG = NO                                                     *ERCRESC
  2161*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2162*                                                                *ERCRESC
  2163******************************************************************ERCRESC
  2164                                                                  ERCRESC
  2165 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2166                                                                  ERCRESC
  2167     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2168         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2169         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2170         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2171         15  RESC-STATE                PIC   XX.                  ERCRESC
  2172         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2173         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2174         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2175         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2176*                                           YYYYMMDD              ERCRESC
  2177     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2178                                                                  ERCRESC
  2179     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2180         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2181             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2182             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2183             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2184                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2185                                                                  ERCRESC
  2186     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2187     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2188     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2189*                                          YYYYMMDD               ERCRESC
  2190 FD  ELCRTT.
  2191
* 2192                             COPY ELCCRTT.
  2193******************************************************************
  2194*                                                                *ELCCRTT
  2195*                            ELCCRTT.                            *
  2196*                                                                *ELCCRTT
  2197*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2198*                                                                *ELCCRTT
  2199*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2200*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2201*                                                                *ELCCRTT
  2202*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2203*                                                                *ELCCRTT
  2204*   LOG = YES                                                    *ELCCRTT
  2205*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2206******************************************************************
  2207*                   C H A N G E   L O G
  2208*
  2209* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2210*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  45
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2211*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2212* EFFECTIVE    NUMBER
  2213*-----------------------------------------------------------------
  2214* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2215* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2216* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2217******************************************************************
  2218                                                                  ELCCRTT
  2219 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2220     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2221         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2222                                                                  ELCCRTT
  2223     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2224         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2225         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2226         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2227         16  CS-STATE                      PIC XX.                ELCCRTT
  2228         16  CS-ACCOUNT                    PIC X(10).
  2229         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2230         16  CS-CERT-NO.                                          ELCCRTT
  2231             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2232             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2233         16  CS-TRAILER-TYPE               PIC X.
  2234             88  COMM-TRLR           VALUE 'A'.
  2235             88  FUTURE-TRLR         VALUE 'B'.
  2236             88  CERT-DATA-TRLR      VALUE 'C'.
  2237                                                                  ELCCRTT
  2238     12  CS-DATA-AREA                      PIC X(516).
  2239
  2240     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2241         16  CS-BANK-COMMISSION-AREA.
  2242             20  CS-BANK-COMMS       OCCURS 10.
  2243                 24  CS-AGT                PIC X(10).
  2244                 24  CS-COM-TYP            PIC X.
  2245                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2246                 24  CS-RECALC-LV-INDIC    PIC X.
  2247                 24  FILLER                PIC X(10).
  2248
  2249         16  FILLER                        PIC X(256).
  2250
  2251     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2252         16  CS-VIN-NUMBER                 PIC X(17).
  2253         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2254         16  FILLER                        PIC X(498).
  2255
  2256******************************************************************ELCCRTT
  2257
  2258 FD  ERAGTC.
  2259
* 2260                             COPY ERCAGTC.
  2261******************************************************************
  2262*                                                                *
  2263*                                                                *
  2264*                            ERCAGTC                             *
  2265*                            VMOD=2.001                          *
  2266*                                                                *
  2267*   ONLINE CREDIT SYSTEM                                         *
  2268*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  46
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2269*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2270*                                                                *
  2271*   FILE TYPE = VSAM,KSDS                                        *
  2272*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2273*                                                                *
  2274*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2275*       ALTERNATE PATH = NONE                                    *
  2276*                                                                *
  2277*   LOG = NO                                                     *
  2278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2279*                                                                *
  2280******************************************************************
  2281*                   C H A N G E   L O G
  2282*
  2283* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2284*-----------------------------------------------------------------
  2285*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2286* EFFECTIVE    NUMBER
  2287*-----------------------------------------------------------------
  2288* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2289* 111004                         NEW FILE AND COPYBOOK
  2290* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2291******************************************************************
  2292
  2293 01  AGENT-COMMISSIONS.
  2294     12  AG-RECORD-ID                          PIC XX.
  2295         88  VALID-CO-ID                          VALUE 'AG'.
  2296
  2297     12  AG-CONTROL-PRIMARY.
  2298         16  AG-COMPANY-CD                     PIC X.
  2299         16  AG-CONTROL.
  2300             20  AG-CTL-1.
  2301                 24  AG-CARR-GROUP.
  2302                     28  AG-CARRIER            PIC X.
  2303                     28  AG-GROUPING           PIC X(6).
  2304                 24  AG-BANK                   PIC X(10).
  2305             20  AG-CTL-2.
  2306                 24  AG-EXP-DT                 PIC XX.
  2307         16  AG-TYPE                           PIC X.
  2308             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2309             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2310
  2311     12  AG-MAINT-INFORMATION.
  2312         16  AG-LAST-MAINT-DT                  PIC XX.
  2313         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2314         16  AG-LAST-MAINT-USER                PIC X(4).
  2315         16  FILLER                            PIC X(10).
  2316
  2317     12  AG-EFF-DT                             PIC XX.
  2318     12  AG-COMM-STRUCTURE.
  2319         16  AG-AGT-COMMS OCCURS 10.
  2320             20  AG-AGT                PIC X(10).
  2321             20  AG-COM-TYP            PIC X.
  2322             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2323             20  AG-RECALC-LV-INDIC    PIC X.
  2324             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2325             20  AG-LRCALC-LV-INDIC    PIC X.
  2326             20  FILLER                PIC X(05).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2327
  2328     12  FILLER                  PIC X(145).
  2329******************************************************************
  2330
  2331 FD  ERPDEF.
  2332
* 2333                             COPY ERCPDEF.
  2334******************************************************************
  2335*                                                                *
  2336*                                                                *
  2337*                            ERCPDEF.                            *
  2338*                                                                *
  2339*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2340*                                                                *
  2341*    FILE TYPE = VSAM,KSDS                                       *
  2342*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2343*                                                                *
  2344*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2345*                                                                *
  2346*    LOG = YES                                                   *
  2347*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2348******************************************************************
  2349 01  PRODUCT-MASTER.
  2350    12  PD-RECORD-ID                 PIC X(02).
  2351        88  VALID-PD-ID                  VALUE 'PD'.
  2352
  2353    12  PD-CONTROL-PRIMARY.
  2354        16  PD-COMPANY-CD            PIC X.
  2355        16  PD-STATE                 PIC XX.
  2356        16  PD-PRODUCT-CD            PIC XXX.
  2357        16  PD-FILLER                PIC X(7).
  2358        16  PD-BEN-TYPE              PIC X.
  2359        16  PD-BEN-CODE              PIC XX.
  2360        16  PD-PROD-EXP-DT           PIC XX.
  2361
  2362    12  FILLER                       PIC X(50).
  2363
  2364    12  PD-PRODUCT-DATA OCCURS 8.
  2365        16  PD-PROD-CODE             PIC X.
  2366            88  PD-PROD-LIFE           VALUE 'L'.
  2367            88  PD-PROD-PROP           VALUE 'P'.
  2368            88  PD-PROD-AH             VALUE 'A'.
  2369            88  PD-PROD-IU             VALUE 'I'.
  2370            88  PD-PROD-GAP            VALUE 'G'.
  2371        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2372        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2373        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2374        16  PD-MAX-TERM              PIC S999        COMP-3.
  2375        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2376        16  FILLER                   PIC X.
  2377        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2378        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2379        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2380        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2381        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2382        16  PD-REC-CRIT-PERIOD       PIC X.
  2383        16  PD-RTW-MOS               PIC 99.
  2384        16  FILLER                   PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  48
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  2385
  2386    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2387
  2388    12  PD-TERM-LIMITS OCCURS 15.
  2389        16  PD-LOW-TERM              PIC S999        COMP-3.
  2390        16  PD-HI-TERM               PIC S999        COMP-3.
  2391
  2392*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2393    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2394        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2395        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2396
  2397    12  PD-EARN-FACTORS.
  2398        16  FILLER OCCURS 15.
  2399            20  FILLER OCCURS 15.
  2400                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2401
  2402    12  PD-PRODUCT-DESC              PIC X(80).
  2403    12  PD-TRUNCATED                 PIC X.
  2404    12  FILLER                       PIC X(59).
  2405
  2406    12  PD-MAINT-INFORMATION.
  2407        16  PD-LAST-MAINT-DT         PIC X(02).
  2408        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2409        16  PD-LAST-MAINT-BY         PIC X(04).
  2410
  2411 FD  ME-ECS010-BALANCE
  2412     RECORDING MODE IS F
  2413     BLOCK CONTAINS 0 RECORDS.
  2414 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2415
  2416 FD  ME50-ECS010-BALANCE
  2417     RECORDING MODE IS F
  2418     BLOCK CONTAINS 0 RECORDS.
  2419 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2420
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  49
* ECS010.cbl
  2422 FD  DISK-DATE
* 2423                             COPY ELCDTEFD.
  2424******************************************************************04/15/98
  2425*                                                                *ELCDTEFD
  2426*                                                                *ELCDTEFD
  2427*                            ELCDTEFD.                           *   LV002
  2428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2429*                            VMOD=2.007                          *   CL**2
  2430*                                                                *ELCDTEFD
  2431******************************************************************ELCDTEFD
  2432     BLOCK CONTAINS 0 RECORDS
  2433     RECORDING MODE F.                                            ELCDTEFD
  2434                                                                  ELCDTEFD
  2435 01  DATE-DISK.                                                   ELCDTEFD
  2436     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2437     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2438     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2439     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2440     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2441     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2442     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2443                                                                  ELCDTEFD
  2444 01  DATE-DISK-R.                                                 ELCDTEFD
  2445     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2446     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2447                                     PIC  X(32).                  ELCDTEFD
  2448                                                                  ELCDTEFD
  2449 01  DATE-DISK-T.                                                 ELCDTEFD
  2450     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2451     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2452                                     PIC  X(48).                  ELCDTEFD
  2453                                                                  ELCDTEFD
  2454 01  DATE-DISK-M.                                                 ELCDTEFD
  2455     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2456     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2457                                     PIC  X(48).                  ELCDTEFD
  2458                                                                  ELCDTEFD
  2459 01  DATE-DISK-P.                                                 ELCDTEFD
  2460     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2461     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2462     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2463     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2464         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2465                                     PIC  X.                      ELCDTEFD
  2466         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2467     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2468         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2469             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2470             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2471             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2472             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2473         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2474                                                                  ELCDTEFD
  2475 01  DATE-DISK-E.                                                 ELCDTEFD
  2476     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2477     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2478                                     PIC  X(4).                   ELCDTEFD
  2479                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  50
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2480 01  DATE-DISK-C.                                                 ELCDTEFD
  2481     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2482     12  DD-CARR1-SECPAY-SW          PIC  X.
  2483     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2484     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2485     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2486     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2487     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2488     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2489     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2490     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2491     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2492     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2493     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2494     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2495     12  DD-CARR2-SECPAY-SW          PIC  X.
  2496     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2497                                                                  ELCDTEFD
  2498 01  DATE-DISK-OPT.                                               ELCDTEFD
  2499     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2500     12  DD-TLR-DATA.                                             ELCDTEFD
  2501         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2502                                     PIC  X(03).                  ELCDTEFD
  2503     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2504         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2505                                     PIC  X(06).                  ELCDTEFD
  2506     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2507         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2508                                     PIC  X(07).                  ELCDTEFD
  2509         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2510     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2511                                     PIC  X(96).                  ELCDTEFD
  2512******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  51
* ECS010.cbl
  2514 FD  PRINT-COPY
* 2515                             COPY ELCPRTFD.
  2516******************************************************************04/15/98
  2517*                                                                *ELCPRTFD
  2518*                                                                *ELCPRTFD
  2519*                            ELCPRTFD.                           *   LV003
  2520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2521*                            VMOD=2.006                          *ELCPRTFD
  2522******************************************************************ELCPRTFD
  2523     RECORDING MODE F                                             ELCPRTFD
  2524     LABEL RECORDS OMITTED                                        ELCPRTFD
  2525     BLOCK CONTAINS 0 RECORDS
  2526     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2527 01  PRT.                                                         ELCPRTFD
  2528     12  P-CTL               PIC  X.                                 CL**2
  2529     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2530******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  52
* ECS010.cbl
  2532 FD  MISMATCH-REPORT
  2533     RECORDING MODE F.
  2534
  2535 01  MISMATCH-RPT.
  2536     12  MR-CTL              PIC X.
  2537     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  53
* ECS010.cbl
  2539 FD  FICH
* 2540                             COPY ELCFCHFD.
  2541******************************************************************04/15/98
  2542*                                                                *ELCFCHFD
  2543*                            ELCFCHFD.                           *   LV003
  2544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2545*                            VMOD=2.004                          *   CL**3
  2546*                                                                *ELCFCHFD
  2547******************************************************************ELCFCHFD
  2548     BLOCK CONTAINS 0 RECORDS
  2549     RECORDING MODE F.                                            ELCFCHFD
  2550                                                                  ELCFCHFD
  2551 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2552******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  54
* ECS010.cbl
  2554 FD  DISPLAY-PRT
  2555     RECORDING MODE IS F
  2556     LABEL RECORDS ARE STANDARD
  2557     BLOCK CONTAINS 0 RECORDS
  2558     RECORD CONTAINS 133 CHARACTERS.
  2559
  2560 01  DISPLAY-REC.
  2561     05  DISPLAY-CC           PIC X.
  2562     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  55
* ECS010.cbl
  2564 WORKING-STORAGE SECTION.
  2565 77  LCP-ASA                       PIC X.
  2566 77  FILLER  PIC X(32)  VALUE '********************************'.
  2567 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2568 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2569
  2570 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2571 77  ws-dcc-cnc-flag         pic x  value ' '.
  2572 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2573 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2574 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2575 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2576 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2577 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2578 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2579 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2580 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2581 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2582 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2583 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2584 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2585 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2586 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2587 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2588 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2589 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2590 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2591 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2592 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2593 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2594 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2595 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2596 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2597 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2598 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2599 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2600 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2601 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2602 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2603 77  X                       PIC X.
  2604 77  DD-FLG                  PIC X               VALUE SPACE.
  2605 77  AGT-SW                  PIC X               VALUE SPACE.
  2606 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2607 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2608 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2609 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2610 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2611 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2612 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2613 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2614 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2615 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2616 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2617 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2618 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2619 77  SV-TRD-CERT             PIC X(11).
  2620 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2621 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  56
* ECS010.cbl
  2622 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2623*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2624*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2625 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2626 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2627 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2628 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2629 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2630 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2631 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2632 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2633 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2634 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2635 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2636 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2637 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2638 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2639 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2640 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2641 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2642 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2643 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2644 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2645 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2646 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2647 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2648 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2649 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2650 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2651 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2652 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2653 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2654 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2655 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2656 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2657 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2658 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2659 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2660 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2661 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2662 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2663 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2664 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2665 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2666 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2667 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2668 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2669 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2670 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2671 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2672 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2674 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2675 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2676 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2677 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2678 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2679 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  57
* ECS010.cbl
  2680 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2681 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2682 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2683 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2684 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2685 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2686 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2687 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2688 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2689 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2690 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2691 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2692 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2693 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2694 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2695 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2696 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2697 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2698 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2699 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2700 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2701 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2702 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2703 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2704 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2705 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2706 77  D1                      PIC S999 COMP-3 VALUE +0.
  2707 77  P1                      PIC S999 COMP-3 VALUE +0.
  2708 77  P2                      PIC S999 COMP-3 VALUE +0.
  2709 77  DD-IU-SW                    PIC X   VALUE ' '.
  2710     88  DD-IU-PRESENT                 VALUE 'Y'.
  2711 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2712 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2713 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2714 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2715 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2716 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2717 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2718 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2719 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2720 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2721
  2722 01  MONTH-END-DATA.
  2723     12  ME-START-DATE.
  2724         16  ME-START-MO         PIC 99.
  2725         16  FILLER              PIC X.
  2726         16  ME-START-DA         PIC 99.
  2727         16  FILLER              PIC X.
  2728         16  ME-START-YR         PIC 99.
  2729     12  ME-CNDS-DATE            PIC 9(6).
  2730     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2731         16  ME-CNDS-MO          PIC 99.
  2732         16  ME-CNDS-DA          PIC 99.
  2733         16  ME-CNDS-YR          PIC 99.
  2734     12  ME-START-TIME           PIC 9(6).
  2735     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2736         88  ME-DO-UPDATE        VALUE 'Y'.
  2737         88  ME-NO-UPDATE        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  58
* ECS010.cbl
  2738     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2739
  2740 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2741 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2742     'Life Claims Paid'.
  2743
  2744 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2745     'A&H Claims Paid'.
  2746
  2747 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2748     'Output Certificate Master Records Prior Month'.
  2749
  2750 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2751     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2752
  2753 01  WS-ME-BALANCE-REC.
  2754     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2755     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2756     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2757     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2758     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2759     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2760     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2761
  2762 01  WS-ME50-BALANCE-REC.
  2763     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2764     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2765     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2766     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2767     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2768     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2769     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2770     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2771     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2772
  2773 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2774 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2775 01  WS-BANK-COMMISSIONS.
  2776     12  WS-BANK-COMMS           OCCURS 10.
  2777         16  WS-BNK-AGT          PIC X(10).
  2778         16  WS-BNK-TYPE         PIC X.
  2779         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2780         16  WS-BNK-RECALC       PIC X.
  2781         16  FILLER              PIC X(10).
  2782
  2783 01  PENDING-MATCH-CONTROL.
  2784     12  PENDING-ACCOUNT-CONTROL.
  2785         16  PEND-MATCH-CARRIER    PIC X.
  2786         16  PEND-MATCH-GROUPING   PIC X(6).
  2787         16  PEND-MATCH-STATE      PIC XX.
  2788         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2789     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2790     12  PEND-MATCH-CERT-NO.
  2791         16  PEND-MATCH-CERT       PIC X(10).
  2792         16  PEND-MATCH-CERT-SFX   PIC X.
  2793 01  PENDING-RECORD-TYPE           PIC X.
  2794     88  ISSUE-TRANSACTION            VALUE '1'.
  2795     88  CANCEL-TRANSACTION           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  59
* ECS010.cbl
  2796     88  CLAIM-TRANSACTION            VALUE '3'.
  2797     88  RESERVE-TRANSACTION          VALUE '4'.
  2798     88  UPDATE-TRANSACTION           VALUE '5'.
  2799
  2800 01  CLM-INCUR-REIN-DATE.
  2801     12  CIRD-CCYY.
  2802         16  CIRD-CC         PIC 99.
  2803         16  CIRD-YR         PIC 99.
  2804     12  CIRD-MO             PIC 99.
  2805
  2806 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2807
  2808 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2809
  2810 01  REIN-BILLING-TABLE.
  2811     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2812         16  RB-COMPANY      PIC X(6).
  2813         16  RB-COUNT        PIC S9(5)   COMP-3.
  2814
  2815 01  B-SUB                   PIC S9(4)   COMP.
  2816
  2817 01  BINARY-COUNTERS     COMP      SYNC.
  2818     12  IA                  PIC S999            VALUE +0.
  2819     12  IB                  PIC S999            VALUE +0.
  2820     12  SUB                 PIC S999            VALUE +0.
  2821     12  SUBM                PIC S999            VALUE +0.
  2822     12  SUB3                PIC S999            VALUE +0.
  2823     12  SUB4                PIC S999            VALUE +0.
  2824     12  SUB5                PIC S999            VALUE +0.
  2825     12  SUB6                PIC S999            VALUE +0.
  2826     12  SUB7                PIC S999            VALUE +0.
  2827     12  SUB8                PIC S999            VALUE +0.
  2828     12  SUB9                PIC S999            VALUE +0.
  2829     12  SUB10               PIC S999            VALUE +0.
  2830     12  SUB11               PIC S999            VALUE +0.
  2831     12  SUB12               PIC S999            VALUE +0.
  2832     12  SUB13               PIC S999            VALUE +0.
  2833     12  SUB14               PIC S999            VALUE +0.
  2834     12  SUB15               PIC S999            VALUE +0.
  2835     12  SUB16               PIC S999            VALUE +0.
  2836     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2837 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2838
  2839 01  WS.
  2840     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2841     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2842     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2843     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2844
  2845     12  WS-ABEND-CODE         PIC 9(4).
  2846     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2847         16  ABEND-CODE-1    PIC XX.
  2848         16  ABEND-CODE-2.
  2849             20  AC2-ONE     PIC X.
  2850             20  AC2-TWO     PIC X.
  2851
  2852     12  CTBL-SEARCH.
  2853         16  CTBL-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  60
* ECS010.cbl
  2854         16  CTBL-TABLE-CD   PIC XXX.
  2855         16  CTBL-BEN-TYPE   PIC X.
  2856         16  CTBL-BEN-CODE   PIC XX.
  2857     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2858     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2859     12  WS-COMM-TERM        PIC S999            COMP-3.
  2860     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2861         88  CTBL-ERROR         VALUE '*'.
  2862
  2863     12  REIN-SPEC.
  2864         16  REIN-SPEC-A     PIC X.
  2865         16  REIN-SPEC-B     PIC X.
  2866         16  REIN-SPEC-C     PIC X.
  2867
  2868     12  WS-CHECK-NUMBER.
  2869         16  WS-CHECK-NO     PIC X(4).
  2870         16  FILLER          PIC XXX.
  2871
  2872     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2873         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2874         88  AH-EARN-NET                         VALUE 'N'.
  2875
  2876     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2877     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2878
  2879 01  DCC-DDF-WORK-AREA.
  2880     05  F OCCURS 800.
  2881         10  DD-STATE                 PIC XX.
  2882         10  DD-PRODUCT-CD            PIC XXX.
  2883         10  DD-FILLER                PIC X(7).
  2884         10  DD-BEN-TYPE              PIC X.
  2885         10  DD-BEN-CODE              PIC XX.
  2886         10  DD-PROD-EXP-DT           PIC XX.
  2887         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2888         10  DD-PROD-DATA OCCURS 8.
  2889             15  DD-PROD-CODE         PIC X.
  2890             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2891         10  DD-EARN-FACTORS.
  2892             15  F OCCURS 15.
  2893                 20  F OCCURS 15.
  2894                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2895         10  DD-TRUNCATED        PIC X.
  2896
  2897 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2898 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2899 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2900 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2901 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2902 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2903 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2904 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2905
  2906 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2907 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2908 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2909 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2910
  2911 01  WS-LEVELS-CHARGEBACK-SWITCHES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  61
* ECS010.cbl
  2912     12  WS-LF-CHARGEBACK-LEVELS.
  2913         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2914     12  WS-AH-CHARGEBACK-LEVELS.
  2915         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2916 01  WS-DCC-DDF-CB.
  2917     12  WS-DCC-DDF-CB-LEVELS.
  2918         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2919*****************************************************************
  2920*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2921*****************************************************************
  2922*RESIDENT STATE TAXES MASTER(ERRESC)
  2923*
  2924 01  WORK-AREAS.
  2925     12  WS-ERRESC-KEY.
  2926         16 WS-ERRESC-SEARCH-KEY.
  2927             20  WS-ERRESC-COMPANY-CD PIC  X.
  2928             20  WS-ERRESC-CARRIER    PIC  X.
  2929             20  WS-ERRESC-GROUP      PIC X(6).
  2930             20  WS-ERRESC-STATE      PIC XX.
  2931             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2932         16 WS-ERRESC-RESIDUAL-KEY.
  2933             20  WS-ERRESC-AGENT      PIC X(10).
  2934             20  WS-ERRESC-RES-STATE  PIC XX.
  2935             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2936*                                          YYYYMMDD
  2937     12  WS-YYYYMMDD-DT               PIC 9(8).
  2938     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2939     12  WS-SUB                       PIC    99  COMP-3.
  2940     12  WS-SUB1                      PIC    99  COMP-3.
  2941*****************************************************************
  2942*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2943*****************************************************************
  2944
  2945 01  COMM-WORK-AREAS.
  2946     12  FILLER              PIC  X(17)
  2947         VALUE 'COMMON WORK AREAS'.
  2948     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2949     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2950     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2951     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2952     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2953     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2954     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2955     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2956     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2957     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2958     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2959     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2960     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2961     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2962     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2963     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2964     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2965     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2966     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2967
  2968     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2969                                         COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  62
* ECS010.cbl
  2970     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2971                                         COMP-3 VALUE ZEROS.
  2972     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2973                                         COMP-3 VALUE ZEROS.
  2974     12  W-EDIT-FIELD        PIC ----------9.
  2975     12  W-EDIT-FIELD2       PIC ----------9.99.
  2976     12  W-EDIT-7            PIC Z(06)9.
  2977     12  W-FACTOR            PIC S9(09)V9(08)
  2978                                         COMP-3 VALUE ZEROS.
  2979     12  W-IBNR-1            PIC S9(07)V9(02)
  2980                                         COMP-3 VALUE ZEROS.
  2981     12  W-IBNR-2            PIC S9(07)V9(02)
  2982                                         COMP-3 VALUE ZEROS.
  2983     12  W-ISS-BEN           PIC S9(11)V9(02)
  2984                                         COMP-3 VALUE ZEROS.
  2985     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2986                                         COMP-3 VALUE ZEROS.
  2987     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2988     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2989     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2990     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2991     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2992     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2993     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2994     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2995     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2996     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2997     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2998     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2999     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3000     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3001     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3002     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3003                                         COMP-3 VALUE ZEROS.
  3004     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3005     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3006     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3007     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3008     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3009     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3010     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3011     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3012     12  W-POLICY-INACTIVE-CTR
  3013                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3014     12  W-POLICY-REISSUE-CTR
  3015                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3016     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3017     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3018     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3019                                         COMP-3 VALUE ZEROS.
  3020     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3021     12  W-WK-IBNR           PIC S9(07)V9(02)
  3022                                         COMP-3 VALUE ZEROS.
  3023
  3024     12  W-CLAIM-TYPE        PIC  X(01).
  3025         88  W-A-H                              VALUE 'A'.
  3026         88  W-LIFE                             VALUE 'L'.
  3027     12  W-CUTOFF-DATE       PIC  9(08).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  63
* ECS010.cbl
  3028     12  W-DIS-DT            PIC  XX.
  3029     12  W-DIS-PTO-DT        PIC  XX.
  3030     12  WK-LEVEL.
  3031         16  WK-AGT          PIC X(10).
  3032         16  WK-A-TYPE       PIC X.
  3033         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3034         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3035         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3036         16  FILLER          PIC X(6).
  3037     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3038         16  FILLER          PIC X(11).
  3039         16  WK-L-RTX        PIC X(3).
  3040         16  WK-J-RTX        PIC X(3).
  3041         16  WK-A-RTX        PIC X(3).
  3042         16  FILLER          PIC X(6).
  3043     12  WK-NEW-RATES.
  3044         16  WK-N-R      OCCURS 10.
  3045             20  WK-N-AGT    PIC X(10).
  3046             20  WK-N-TYPE   PIC X.
  3047             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3048             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3049     12  W-LIFE-YEARS-ZERO.
  3050         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3051         16  FILLER          PIC  X(01)         VALUE SPACES.
  3052         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3053         16  FILLER          PIC  X(01)         VALUE SPACES.
  3054         16  FILLER          PIC  X(01)         VALUE SPACES.
  3055         16  FILLER          PIC  X(01)         VALUE SPACES.
  3056         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3057         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3058         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3059         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3060         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3061         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3062         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3063         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3064         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3065         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3066         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3067         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3068         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3069         16  FILLER          PIC S9(09)V9(02) COMP-3
  3070                                                VALUE ZEROS.
  3071         16  FILLER          PIC S9(09)V9(02) COMP-3
  3072                                                VALUE ZEROS.
  3073         16  FILLER          PIC S9(09)V9(02) COMP-3
  3074                                                VALUE ZEROS.
  3075         16  FILLER          PIC S9(09)V9(02) COMP-3
  3076                                                VALUE ZEROS.
  3077         16  FILLER          PIC S9(11)V9(02) COMP-3
  3078                                                VALUE ZEROS.
  3079
  3080     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3081         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3082     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  3083         88  W-REIN-PROCESS                     VALUE 'Y'.
  3084         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  3085     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  64
* ECS010.cbl
  3086         88  W-SELECTION-ON                     VALUE 'Y'.
  3087         88  W-SELECTION-OFF                    VALUE SPACES.
  3088     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3089         88  W-RTRM-0                           VALUE 'Y'.
  3090         88  W-RTRM-NOT-0                       VALUE SPACES.
  3091     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3092     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3093         88  W-TABLE-USED                       VALUE 'Y'.
  3094         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3095     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3096         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3097
  3098     12  W-VAL-ERRORS.
  3099         16  FILLER          PIC  X(40)
  3100             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3101         16  FILLER          PIC  X(40)
  3102             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3103         16  FILLER          PIC  X(40)
  3104             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3105         16  FILLER          PIC  X(40)
  3106             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3107         16  FILLER          PIC  X(40)
  3108             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3109         16  FILLER          PIC  X(40)
  3110             VALUE 'RUN DATE EPEC - A&H - '.
  3111         16  FILLER          PIC  X(40)
  3112             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3113         16  FILLER          PIC  X(40)
  3114             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3115         16  FILLER          PIC  X(40)
  3116             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3117     12  FILLER REDEFINES W-VAL-ERRORS.
  3118         16  W-VAL-ERROR OCCURS 9 TIMES
  3119                             PIC  X(40).
  3120
  3121     12  W-WORK-DATE         PIC  X(02).
  3122     12  SAVE-WK-NEW-RATES.
  3123         16  FILLER          PIC X(170).
  3124
  3125***   The following data area is for NCL only
  3126*    12  W-WORK-OB-DATA OCCURS 300.
  3127*    12  W-WORK-OB-DATA OCCURS 220.
  3128     12  W-WORK-OB-DATA OCCURS 900.
  3129         16  WS-OB-REIN-CO       PIC X(06).
  3130         16  WS-OB-LF-AH         PIC X.
  3131         16  WS-OB-BENEFIT-CODE  PIC XX.
  3132         16  WS-OB-EARNED OCCURS 3.
  3133             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3134
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  65
* ECS010.cbl
  3136 01  EPEC-WORK-AREAS.
  3137     12  WE-REIN-CO          PIC X(6).
  3138     12  WE-LF-AH            PIC X.
  3139     12  WE-BEN-TYPE         PIC XX.
  3140     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3141     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3142     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3143     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3144     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3145     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3146     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3147     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3148     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3149     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3150     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3151     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3152     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3153     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3154     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3155     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3156     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3157     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3158     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3159     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3160     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3161     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3162     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3163     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3164     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3165     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3166     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3167     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3168     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3169     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3170     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3171     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3172     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3173     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3174     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3175     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3176     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3177     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3178     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3179     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3180     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3181     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3182     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3183     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3184     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3185     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3186     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3187     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3188     12  WX-SETTLEMENT-EXIT-DATE
  3189                             PIC  9(11)      COMP-3.
  3190     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3191     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3192     12  WX-STATUS-AT-SETTLEMENT
  3193                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  66
* ECS010.cbl
  3194     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3195
  3196 01  EPEC-WORK.
  3197     12  EW-REIN-CO          PIC X(6).
  3198     12  EW-SUB-KEY.
  3199         16  EW-LF-AH        PIC X.
  3200         16  EW-BEN-TYPE     PIC XX.
  3201     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3202     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3203     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3204     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3205     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3206     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3207     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3208     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3209     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3210     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3211     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3212     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3213     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3214     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3215     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3216     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3217     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3218     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3219     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3220     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3221     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3222     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3223     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3224     12  EW-AGENTS       OCCURS 10.
  3225         16  EW-AGT-NO       PIC X(10).
  3226         16  EW-AGT-TYPE     PIC X.
  3227         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3228         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3229         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3230         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3231         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3232         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3233         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3234     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3235     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3236     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3237     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3238     12  EW-AGE              PIC S9(9)       COMP-3.
  3239     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3240     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3241     12  EW-LEVEL-USED       PIC X.
  3242
  3243 01  EPEC-TOTALS.
  3244     12  EPEC-LEVELS     OCCURS 900.
  3245*    12  EPEC-LEVELS     OCCURS 220.
  3246*    12  EPEC-LEVELS     OCCURS 300.
  3247         16  EPEC-REIN-CO          PIC X(6).
  3248         16  EPEC-SUB-KEY.
  3249             24  EPEC-LF-AH        PIC X.
  3250             24  EPEC-BEN-TYPE     PIC XX.
  3251*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  67
* ECS010.cbl
  3252         16  FILLER                PIC X(699).
  3253     12  EPEC-LEVELS-END           PIC X(6).
  3254
  3255 01  EPEC-UNDERWRITTEN-TOTALS.
  3256     12  EPEC-LEVELS-II  OCCURS 900.
  3257*    12  EPEC-LEVELS-II  OCCURS 220.
  3258*    12  EPEC-LEVELS-II  OCCURS 300.
  3259         16  EPEC-REIN-CO-II       PIC X(6).
  3260         16  EPEC-SUB-KEY-II.
  3261             24  EPEC-LF-AH-II     PIC X.
  3262             24  EPEC-BEN-TYPE-II  PIC XX.
  3263*        16  FILLER                PIC X(694).
  3264         16  FILLER                PIC X(699).
  3265     12  EPEC-LEVELS-END-II        PIC X(6).
  3266
  3267
  3268 01  FILLER                      PIC  X(11)
  3269                                 VALUE 'OPT RSV TBL'.
  3270*
  3271* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3272*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3273*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3274*      EPEC-OPT-GRP  (108)
  3275*
  3276*      300 X 108 = 32400.
  3277*
  3278 01  EPEC-OPT-DATA-TABLE.
  3279*    12  FILLER                  PIC X(32400).
  3280*    12  FILLER                  PIC X(23760).
  3281     12  FILLER                  PIC X(97200).
  3282
  3283 01  FILLER                      PIC  X(16)
  3284                                 VALUE 'OPT RSV TBL UNDW'.
  3285 01  EPEC-UNDW-OPT-DATA-TABLE.
  3286*    12  FILLER                  PIC X(32400).
  3287*    12  FILLER                  PIC X(23760).
  3288     12  FILLER                  PIC X(97200).
  3289
  3290 01  FILLER                      PIC  X(16)
  3291                                 VALUE 'OPT RSV TBL WORK'.
  3292 01  EPEC-OPT-WORK-TABLE.
  3293*    12  EPEC-OPT-GRP        OCCURS 300.
  3294*    12  EPEC-OPT-GRP        OCCURS 220.
  3295     12  EPEC-OPT-GRP        OCCURS 900.
  3296         16  EPEC-REIN-CO-OPT
  3297                             PIC  X(06).
  3298         16  EPEC-SUB-KEY-OPT.
  3299             24  EPEC-LF-AH-OPT
  3300                             PIC  X(01).
  3301             24  EPEC-BEN-TYPE-OPT
  3302                             PIC  X(02).
  3303         16  EPEC-OPT-DATA.
  3304             20  EPEC-REIN-ONLY-IND
  3305                             PIC  X(01).
  3306                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3307             20  EPEC-LINE-NOT-USED-IND
  3308                             PIC  X(01).
  3309                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  68
* ECS010.cbl
  3310             20  EPEC-LIFE-CTR-USED-IND
  3311                             PIC  X(01).
  3312                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3313                 88  EPEC-LIFE-CTR-NOT-USED
  3314                                           VALUE ' '.
  3315             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3316                             PIC S9(09)       COMP-3.
  3317             20  EPEC-EARNED-PREMIUM-AH
  3318                             PIC S9(09)V9(02) COMP-3.
  3319             20  EPEC-CLAIMS-MADE-PAID
  3320                             PIC S9(09)V9(02) COMP-3.
  3321             20  EPEC-CLM-EXP
  3322                             PIC S9(09)V9(02) COMP-3.
  3323             20  EPEC-LIFE-IBNR
  3324                             PIC S9(09)V9(02) COMP-3.
  3325             20  EPEC-REIN-ISS-BEN
  3326                             PIC S9(11)V9(02) COMP-3.
  3327
  3328 01  FILLER                  PIC X(09)
  3329                                 VALUE 'EOM TABLE'.
  3330
  3331 01  EOM-DATE-TABLE.
  3332     12  EOM-DATE            OCCURS 13
  3333                             PIC 9(08).
  3334
  3335 01  EPEC-SUBS.
  3336     12  EPEC-SUB-LEVELS OCCURS 31.
  3337         16  EPEC-SUB-REIN   PIC X(6).
  3338         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3339         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3340     12  EPEC-SUBS-END       PIC X(6).
  3341
  3342 01  SAVE-REIN-WORK.
  3343     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3344     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3345     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3346     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3347     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3348
  3349 01  SAVE-REIN-TABLE.
  3350     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3351         16  SR-TIME         PIC 9(6).
  3352         16  SR-ENTRY.
  3353             20  FILLER      PIC XX.
  3354             20  SR-CONTROL  PIC X(8).
  3355             20  FILLER      PIC X(3990).
  3356
  3357
* 3358                             COPY ECSRITAB.
  3359******************************************************************04/29/98
  3360*                                                                *ECSRITAB
  3361*                            ECSRITAB                            *   LV015
  3362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3363*                            VMOD=2.015                          *ECSRITAB
  3364*                                                                *ECSRITAB
  3365*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3366*                                                                *ECSRITAB
  3367******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  69
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3368 01  REIN-WORK-AREAS.                                             ECSRITAB
  3369     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3370     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3371     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3372     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3373     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3374     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3375     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3376     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3377     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3378     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3379     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3380         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3381             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3382             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3383             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3384     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3385     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3386     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3387     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3388     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3389     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3390     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3391     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3392     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3393     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3394     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3395     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3396     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3397     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3398     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3399     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3400     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3401     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3402     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3403     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3404     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3405     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3406     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3407                                                                  ECSRITAB
  3408 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3409     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3410         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3411         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3412             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3413             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3414         16  REIN-WORK-FLDS.                                      ECSRITAB
  3415             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3416             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3417             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3418             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3419             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3420             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3421             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3422             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3423             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3424             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3425             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3426             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3427             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3428             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3429             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3430             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3431             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3432             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3433             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3434             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3435             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3436             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3437             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3438             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3439             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3440             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3441             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3442             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3443     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3444                                                                  ECSRITAB
  3445     12  RWF-FIELDS.                                              ECSRITAB
  3446         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3447         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3448         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3449         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3450         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3451         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3452         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3453         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3454         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3455         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3456         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3457         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3458         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3459         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3460         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3461         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3462         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3463         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3464         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3465         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3466         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3467         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3468         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3469         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3470         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3471         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3472         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3473         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3474                                                                  ECSRITAB
  3475     12  WT-COMP-INFO.                                            ECSRITAB
  3476         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3477         16  WT-LF-QC                PIC X.                       ECSRITAB
  3478         16  WT-AH-QC                PIC X.                       ECSRITAB
  3479         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3480         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3481         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3482         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3483         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3484         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3485         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3486         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3487         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3488         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3489         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3490         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3491         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3492         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3493         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3494         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3495         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3496         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3497         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3498         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3499         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3500         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3501         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3502         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3503         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3504         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3505         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3506         16  WT-REMAINING            PIC X.                       ECSRITAB
  3507         16  FILLER                  PIC X(21).                   ECSRITAB
  3508                                                                  ECSRITAB
  3509 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3510     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3511     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3512     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3513     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3514     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3515     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3516     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3517     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3518     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3519     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3520     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3521     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3522     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3523     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3524     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3525     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3526     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3527     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3528     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3529     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3530     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3531     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3532     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3533     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3534                                                                  ECSRITAB
  3535     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3536         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3537     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3538         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3539     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3540         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3541     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3542         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3543     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3544         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3545     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3546         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3547                                                                  ECSRITAB
  3548     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3549         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3550         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3551         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3552         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3553         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3554         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3555         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3556         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3557         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3558         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3559         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3560         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3561         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3562         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3563         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3564         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3565         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3566         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3567         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3568         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3569         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3570         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3571         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3572     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3573     12  REIN-SEARCH.                                             ECSRITAB
  3574         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3575         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3576         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3577         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3578     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3579     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3580     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3581     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3582     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3583     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3584     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3585     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3586     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3587     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3588     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3589     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3590     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3591     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3592     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3593     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3594     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3595     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3596     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3597     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3598     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3599     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3600     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3601     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3602     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3603                                                                  ECSRITAB
  3604 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3605* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3606     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3607         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3608         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3609         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3610         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3611         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3612         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3613         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3614         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3615         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3616                                                                  ECSRITAB
  3617 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3618     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3619         16  RC2-REIN-CO.                                         ECSRITAB
  3620             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3621             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3622         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3623         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3624         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3625         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3626         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3627         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3628                                                                  ECSRITAB
  3629 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3630     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3631         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3632         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3633     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3634                                                                  ECSRITAB
  3635 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3636     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3637         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3638         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3639         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3640 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3641     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3642         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3643                                                                  ECSRITAB
  3644 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3645******************************************************************ECSRITAB
  3646
* 3647                             COPY ELCPSEVR.
  3648******************************************************************04/16/98
  3649*                                                                *ELCPSEVR
  3650*                                                                *ELCPSEVR
  3651*                            ELCPSEVR                            *   LV003
  3652*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3653*                            VMOD=2.001                          *ELCPSEVR
  3654*                                                                *ELCPSEVR
  3655*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3656*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3657*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3658******************************************************************ELCPSEVR
  3659                                                                  ELCPSEVR
  3660 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3661     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3662         10  FILLER               PIC 999.                        ELCPSEVR
  3663         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3664         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3665             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3666             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3667         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3668         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3669     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3670            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3671     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3672         10  FILLER              PIC 999.                         ELCPSEVR
  3673         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3674         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3675             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3676             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3677         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3678         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3679     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3680            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3681 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3682     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3683                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3684         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3685             15  FILLER              PIC 999.                     ELCPSEVR
  3686             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3687             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3688                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3689                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3690             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3691             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3692         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3693                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3694         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3695             15  FILLER              PIC 999.                     ELCPSEVR
  3696             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3697             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3698                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3699                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3700             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3701             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3702         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3703                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3704         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3705             15  FILLER              PIC 999.                     ELCPSEVR
  3706             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3707             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3708                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3709                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3710             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3711             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3712         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3713                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3714     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3715         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3716         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3717         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3718             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3719             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3720         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3721         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3722     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3723            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3724
* 3725                             COPY ELCEPCVR.
  3726******************************************************************05/15/98
  3727*                                                                *ELCEPCVR
  3728*                                                                *ELCEPCVR
  3729*                            ELCEPCVR                            *   LV003
  3730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3731*                            VMOD=2.001                          *ELCEPCVR
  3732*                                                                *ELCEPCVR
  3733*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3734*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3735*                                                                *ELCEPCVR
  3736******************************************************************ELCEPCVR
  3737 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3738     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3739         10  FILLER            PIC 999.                           ELCEPCVR
  3740         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3741         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3742             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3743             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3744         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3745         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3746     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3747            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3748     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3749         10  FILLER            PIC 999.                              CL**5
  3750         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3751         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3752             15  EC-EXP-CC     PIC 99.                               CL**5
  3753             15  EC-EXP-YR     PIC 99.                               CL**5
  3754         10  EC-EXP-MO         PIC 99.                               CL**5
  3755         10  EC-EXP-DA         PIC 99.                               CL**5
  3756     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3757            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3758     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3759         10  FILLER            PIC 999.                           ELCEPCVR
  3760         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3761         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3762             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3763             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3764         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3765         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3766     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3767            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3768     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3769         10  FILLER            PIC 999.                              CL**5
  3770         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3771         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3772             15  EC-EFF-CC     PIC 99.                               CL**5
  3773             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3774         10  EC-EFF-MO         PIC 99.                               CL**5
  3775         10  EC-EFF-DA         PIC 99.                               CL**5
  3776     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3777            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3778     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3779         10  FILLER            PIC 999.                           ELCEPCVR
  3780         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3781         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3782             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3783             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3784         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3785         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3786     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3787            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3788     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3789         10  FILLER            PIC 999.                           ELCEPCVR
  3790         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3791         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3792             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3793             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3794         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3795         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3796     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3797            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3798     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3799         10  FILLER            PIC 999.                           ELCEPCVR
  3800         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3801         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3802             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3803             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3804         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3805         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3806     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3807            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3808     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3809         10  FILLER            PIC 999.                           ELCEPCVR
  3810         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3811         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3812             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3813             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3814         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3815         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3816     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3817            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3818     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3819         10  FILLER            PIC 999.                           ELCEPCVR
  3820         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3821         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3822             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3823             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3824         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3825         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3826     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3827            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3828
* 3829                             COPY ELCREINV.
  3830******************************************************************04/18/98
  3831*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3832*                                                                *ELCREINV
  3833*                            ELCREINV                            *   LV003
  3834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3835*                            VMOD=2.001                          *ELCREINV
  3836*                                                                *ELCREINV
  3837*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3838*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3839*                                                                *ELCREINV
  3840******************************************************************ELCREINV
  3841                                                                  ELCREINV
  3842 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3843     05  WS-RE-LO-DATE.                                              CL**3
  3844         10 FILLER                     PIC 999.                      CL**3
  3845         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3846         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3847            15 RE-LO-CC                PIC 99.                       CL**3
  3848            15 RE-LO-YR                PIC 99.                       CL**3
  3849         10 RE-LO-MO                   PIC 99.                       CL**3
  3850         10 RE-LO-DA                   PIC 99.                       CL**3
  3851     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3852            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3853     05  WS-RE-HI-DATE.                                              CL**3
  3854         10 FILLER                     PIC 999.                      CL**3
  3855         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3856         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3857            15 RE-HI-CC                PIC 99.                       CL**3
  3858            15 RE-HI-YR                PIC 99.                       CL**3
  3859         10 RE-HI-MO                   PIC 99.                       CL**3
  3860         10 RE-HI-DA                   PIC 99.                       CL**3
  3861     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3862            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3863     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3864         10 FILLER                     PIC 999.                   ELCREINV
  3865         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3866         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3867            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3868            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3869         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3870         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3871     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3872            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3873     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3874         10  FILLER                    PIC 999.                   ELCREINV
  3875         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3876         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3877             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3878             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3879         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3880         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3881     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3882            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3883     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3884         10  FILLER                    PIC 999.                   ELCREINV
  3885         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3886         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3887             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3888             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3889         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3890         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3891     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3892            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3893
  3894 01  RC-REIN-HOLD-AREAS.
  3895     12  RC-REIN-LEVELS  OCCURS 30.
  3896         16  RC-REIN-COMP    PIC X(6).
  3897         16  RC-OLD-ISS      PIC X.
  3898         16  RC-NEW-ISS      PIC X.
  3899         16  RC-OLD-CNC      PIC X.
  3900         16  RC-NEW-CNC      PIC X.
  3901         16  RC-OLD-LF-CLM   PIC X.
  3902         16  RC-OLD-AH-CLM   PIC X.
  3903         16  RC-NEW-LF-CLM   PIC X.
  3904         16  RC-NEW-AH-CLM   PIC X.
  3905         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3906         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3907         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3908         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3909         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3910         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3911         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3912         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3913         16  RC-REIN-REM-SW  PIC X.
  3914     12  RC-REIN-LEVELS-END  PIC X(6).
  3915
  3916 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3917     12  TPC-COUNTERS    OCCURS 6.
  3918         16  TPL-ISS-PRM     PIC S9(9)V99.
  3919         16  TPA-ISS-PRM     PIC S9(9)V99.
  3920         16  TPL-CNC-PRM     PIC S9(9)V99.
  3921         16  TPA-CNC-PRM     PIC S9(9)V99.
  3922         16  TPL-ACCT-COM    PIC S9(9)V99.
  3923         16  TPA-ACCT-COM    PIC S9(9)V99.
  3924         16  TPL-CLAIMS      PIC S9(9)V99.
  3925         16  TPA-CLAIMS      PIC S9(9)V99.
  3926
  3927 01  HLD-DTS SYNC.
  3928     12  EOM-RUN-DATE        PIC 9(08).
  3929     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3930         16  EOM-CCYY.
  3931             20  EOM-CC      PIC 99.
  3932             20  EOM-YR      PIC 99.
  3933         16  EOM-MO          PIC 99.
  3934         16  EOM-DA          PIC 99.
  3935
  3936****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3937****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3938     12  OB-RUN-DATES OCCURS 2.
  3939         16  OB-CCYY         PIC 9(4).
  3940         16  OB-MO           PIC 99.
  3941         16  OB-DA           PIC 99.
  3942
  3943     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3944         88  OB-DATE-1-USED     VALUE '*'.
  3945     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3946         88  OB-DATE-2-USED     VALUE '*'.
  3947     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  79
* ECS010.cbl
  3948         88  OB-DATE-3-USED     VALUE '*'.
  3949     12  EARNING-START-DATE  PIC 9(08).
  3950     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3951         16  E-ERN-START-CC  PIC 99.
  3952         16  E-ERN-START-YR  PIC 99.
  3953         16  E-ERN-START-MO  PIC 99.
  3954         16  E-ERN-START-DA  PIC 99.
  3955     12  EARNING-STOP-DATE   PIC 9(08).
  3956     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3957         16  E-ERN-STOP-CC   PIC 99.
  3958         16  E-ERN-STOP-YR   PIC 99.
  3959         16  E-ERN-STOP-MO   PIC 99.
  3960         16  E-ERN-STOP-DA   PIC 99.
  3961     12  STOP-LF-DATE        PIC 9(08).
  3962     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3963         16  STOP-LF-CC      PIC 99.
  3964         16  STOP-LF-YR      PIC 99.
  3965         16  STOP-LF-MO      PIC 99.
  3966         16  STOP-LF-DA      PIC 99.
  3967     12  STOP-AH-DATE        PIC 9(08).
  3968     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3969         16  STOP-AH-CC      PIC 99.
  3970         16  STOP-AH-YR      PIC 99.
  3971         16  STOP-AH-MO      PIC 99.
  3972         16  STOP-AH-DA      PIC 99.
  3973     12  BIN-VALUATION-DT    PIC XX.
  3974     12  BIN-EOM-RUN-DATE    PIC XX.
  3975     12  LAST-YRS-DATE       PIC 9(08).
  3976     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3977         16  LYD-CCYY        PIC 9(04).
  3978         16  LYD-CCYR REDEFINES LYD-CCYY.
  3979             20  LYD-CC      PIC 99.
  3980             20  LYD-YR      PIC 99.
  3981         16  LYD-MO          PIC 99.
  3982         16  LYD-DA          PIC 99.
  3983     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3984     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3985         16  VAL-CC          PIC 99.
  3986         16  VAL-YR          PIC 99.
  3987         16  VAL-MO          PIC 99.
  3988         16  VAL-DA          PIC 99.
  3989     12  INCURRED-DATE       PIC 9(08).
  3990     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3991         16  DTO-CC          PIC 99.
  3992         16  DTO-YR          PIC 99.
  3993         16  DTO-MO          PIC 99.
  3994         16  DTO-DA          PIC 99.
  3995     12  REPORTED-DATE.
  3996         16  RPT-YR          PIC 99.
  3997         16  RPT-MO          PIC 99.
  3998         16  RPT-DA          PIC 99.
  3999     12  PAYMENT-DATE        PIC 9(08).
  4000     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4001         16  PAY-CC          PIC 99.
  4002         16  PAY-YR          PIC 99.
  4003         16  PAY-MO          PIC 99.
  4004         16  PAY-DA          PIC 99.
  4005     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  80
* ECS010.cbl
  4006     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4007         16  PAYTO-CC        PIC 99.
  4008         16  PAYTO-YR        PIC 99.
  4009         16  PAYTO-MO        PIC 99.
  4010         16  PAYTO-DA        PIC 99.
  4011
  4012 01  AH-RES-STATE-TABLE.
  4013     12  FILLER              PIC X(42)       VALUE
  4014             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4015     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4016
  4017 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4018     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4019
  4020 01  BILLING-COUNTERS    COMP-3.
  4021     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4022     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4023     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4024     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4025     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4026     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4027     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4028     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4029     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4030     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4031     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4032     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4033     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4034     12  BC-COMM             PIC S9(5)           VALUE +0.
  4035     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4036     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4037     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4038     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4039     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4040     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4041     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4042     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4043     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4044     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4045
  4046 01  FLAGS SYNC.
  4047     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4048         88  CHECK-BILLED                        VALUE 'Y'.
  4049     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4050         88  EOF-ON-TRANS                        VALUE '*'.
  4051     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4052         88  EOF-ON-CERT                         VALUE '*'.
  4053     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4054         88  PROCESSING-COMPLETED                VALUE '*'.
  4055     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4056         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4057     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4058         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4059     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4060         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4061     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4062         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4063     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  81
* ECS010.cbl
  4064         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4065     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4066         88  A-H-FULLY-EARNED                    VALUE '*'.
  4067     12  CNCL-FLG            PIC X               VALUE SPACE.
  4068     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4069         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4070         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4071     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4072         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4073     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4074         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4075     12  EP-FLG              PIC X               VALUE SPACE.
  4076     12  END-FLG             PIC X               VALUE SPACE.
  4077     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4078     12  PRIOR-CERT-IN-CNTRL.
  4079         16  PCIC-FIRST      PIC x(19)  value low-values.
  4080         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4081         16  pcic-cert-no    pic x(11)  value low-values.
  4082     12  ACCT-FLG            PIC X               VALUE SPACE.
  4083     12  STATE-FLG           PIC X               VALUE SPACE.
  4084     12  COMP-FLG            PIC X               VALUE SPACE.
  4085     12  CARR-FLG            PIC X               VALUE SPACE.
  4086     12  FINAL-FLG           PIC X               VALUE SPACE.
  4087     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4088     12  REIN-FLG            PIC X               VALUE SPACE.
  4089     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4090     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4091
  4092 01  TEXAS-REG-WORK-AREAS   SYNC.
  4093     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4094     12  TEX-FACT-2          PIC S999        COMP-3.
  4095     12  TEX-FACT-3          PIC S999        COMP-3.
  4096     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4097     12  TEX-FACT-5          PIC S999        COMP-3.
  4098     12  TEX-FACT-6          PIC S999        COMP-3.
  4099     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4100     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4101     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4102
  4103 01  NET-PAY-INTERFACE.
  4104     12  NP-APR              PIC S999V9(4)   COMP-3.
  4105     12  NP-ORIG             PIC S999        COMP-3.
  4106     12  NP-REM              PIC S999        COMP-3.
  4107     12  NP-OPT              PIC X.
  4108     12  NP-CAP              PIC S999        COMP-3.
  4109     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4110     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4111     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4112     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4113     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4114     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4115     12  NP-ACCOUNT          PIC X(10).
  4116
  4117 01  HOLDERS SYNC.
  4118     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4119     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4120     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4121     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  82
* ECS010.cbl
  4122     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4123     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4124     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4125     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4126     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4127     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4128     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4129     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4130     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4131     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4132     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4133     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4134     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4135     12  REM-TRM1            PIC S999V99  COMP-3.
  4136     12  REM-TRM2            PIC S999V99  COMP-3.
  4137     12  REM-TRM3            PIC S999V99  COMP-3.
  4138     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4139     12  TEM-TRM1            PIC S999V99  COMP-3.
  4140     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4141     12  ORIG-TERM           PIC S999V99  COMP-3.
  4142     12  HLD-CONTROL.
  4143         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4144         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4145         16  HLD-STATE       PIC XX              VALUE SPACES.
  4146         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4147     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4148
  4149 01  DISPLAY-IBNR-LINE.
  4150     05  FILLER                  PIC X       VALUE SPACES.
  4151     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4152     05  FILLER                  PIC XX      VALUE SPACES.
  4153     05  DIL-TYPE                PIC X       VALUE SPACES.
  4154     05  FILLER                  PIC X       VALUE SPACES.
  4155     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4156     05  FILLER                  PIC XXX     VALUE SPACES.
  4157     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4158
  4159 01  DISPLAY-HD-1.
  4160     05  FILLER      PIC X       VALUE SPACES.
  4161     05  FILLER      PIC X(50)   VALUE SPACES.
  4162     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4163     05  FILLER      PIC X(51)   VALUE SPACES.
  4164     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4165
  4166 01  DISPLAY-HD-2.
  4167     05  FILLER                 PIC X       VALUE SPACE.
  4168     05  FILLER                 PIC X(57)   VALUE SPACES.
  4169     05  DIS-DATE               PIC X(8).
  4170     05  FILLER                 PIC X(66)   VALUE SPACES.
  4171
  4172 01  DISPLAY-LINE.
  4173     05  DL-FULL.
  4174         10  FILLER           PIC X       VALUE SPACE.
  4175         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4176         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4177
  4178 01  PRT-HDNGS SYNC.
  4179     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  83
* ECS010.cbl
  4180         16  FILLER      PIC X       VALUE '1'.
  4181         16  FILLER      PIC X(53)   VALUE SPACES.
  4182         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4183         16  FILLER      PIC X(48)   VALUE SPACES.
  4184         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4185     12  TR-HD-2.
  4186         16  FILLER      PIC X       VALUE SPACE.
  4187         16  FILLER      PIC X(47)   VALUE SPACES.
  4188         16  TRHDNM      PIC X(30).
  4189         16  FILLER      PIC X(42)   VALUE SPACES.
  4190         16  TR-RN-DT    PIC X(8).
  4191     12  TR-HD-3.
  4192         16  FILLER      PIC X       VALUE SPACE.
  4193         16  FILLER      PIC X(53)   VALUE SPACES.
  4194         16  TR-MODAYR   PIC X(18).
  4195         16  FILLER      PIC X       VALUE SPACE.
  4196         16  TR-YRASK    PIC X       VALUE SPACE.
  4197         16  FILLER      PIC X(46)   VALUE SPACES.
  4198         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4199         16  TR-PG       PIC ZZ,ZZ9.
  4200     12  TR-HD-4.
  4201         16  FILLER      PIC X       VALUE SPACE.
  4202         16  TR-AGCY     PIC X(30).
  4203     12  TR-HD-5.
  4204         16  FILLER      PIC X       VALUE SPACE.
  4205         16  TR-CARR     PIC X.
  4206         16  FILLER      PIC X       VALUE '-'.
  4207         16  TR-GROUP    PIC X(6).
  4208         16  FILLER      PIC X       VALUE '-'.
  4209         16  TR-ST-NO    PIC X(2).
  4210         16  FILLER      PIC X       VALUE '-'.
  4211         16  TR-AG-NO    PIC X(10).
  4212         16  FILLER      PIC X(23)   VALUE SPACES.
  4213         16  TR5-RP-TYP.
  4214             20  FILLER  PIC X(20)   VALUE
  4215                     '* * * * TRANSACTION '.
  4216             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4217     12  TR-HD-6.
  4218         16  FILLER      PIC X       VALUE SPACE.
  4219         16  TR-CE-MO    PIC XX.
  4220         16  FILLER      PIC X       VALUE '-'.
  4221         16  TR-CE-DA    PIC XX.
  4222         16  FILLER      PIC X       VALUE '-'.
  4223         16  TR-CE-YR    PIC XX.
  4224         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4225         16  TR-CX.
  4226             20  TR-CX-MO PIC XX.
  4227             20  HSHR1    PIC X.
  4228             20  TR-CX-DA PIC XX.
  4229             20  HSHR2    PIC X.
  4230             20  TR-CX-YR PIC XX.
  4231     12  TR-HD-7.
  4232         16  FILLER  PIC X      VALUE '0'.
  4233         16  FILLER  PIC X(24)  VALUE SPACES.
  4234         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4235         16  TR-7-LF PIC X(6).
  4236         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4237         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  84
* ECS010.cbl
  4238         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4239         16  TR-7-AH PIC X(6).
  4240         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4241         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4242     12  TR-HD-8.
  4243         16  FILLER  PIC X      VALUE SPACE.
  4244         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4245         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4246         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4247         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4248         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4249     12  TR-HD-9.
  4250         16  FILLER  PIC X      VALUE SPACE.
  4251         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4252         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4253         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4254         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4255         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4256         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4257     12  TR-TTL-HD.
  4258         16  FILLER      PIC X       VALUE '0'.
  4259         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4260         16  FILLER      PIC XX      VALUE SPACES.
  4261         16  TTL-HD-DS   PIC X(60)   VALUE
  4262             'ECS010 CONTROL TOTALS'.
  4263
  4264 01  TR-DTL.
  4265     12  FILLER                  PIC X           VALUE SPACE.
  4266     12  TR-DTL1.
  4267         16  TRD-CERT            PIC X(11).
  4268         16  TRD-ISDT.
  4269             20  FILLER          PIC X           VALUE SPACE.
  4270             20  TRD-ISMO        PIC XX.
  4271             20  TRD-IS-S1       PIC X           VALUE '/'.
  4272             20  TRD-ISDA        PIC XX.
  4273             20  TRD-IS-S2       PIC X           VALUE '/'.
  4274             20  TRD-ISYR        PIC XX.
  4275             20  FILLER          PIC X           VALUE SPACE.
  4276         16  TRD-AGE             PIC XX.
  4277     12  TR-DTL2.
  4278         16  FILLER              PIC X           VALUE SPACE.
  4279         16  TRD-LFTYP           PIC XXX.
  4280         16  FILLER              PIC X           VALUE SPACE.
  4281         16  TRD-LFTRM           PIC ZZ9.
  4282         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4283         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4284         16  TRD-LFACTDT.
  4285             20  FILLER          PIC X           VALUE SPACE.
  4286             20  TRD-LFACTMO     PIC XX.
  4287             20  TRD-LF-S1       PIC X           VALUE '/'.
  4288             20  TRD-LFACTDA     PIC XX.
  4289             20  TRD-LF-S2       PIC X           VALUE '/'.
  4290             20  TRD-LFACTYR     PIC XX.
  4291             20  FILLER          PIC X           VALUE SPACE.
  4292         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4293         16  FILLER              PIC X           VALUE SPACE.
  4294         16  TRD-LF-STATUS       PIC X.
  4295         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  85
* ECS010.cbl
  4296         16  TRD-AHTYP           PIC XXX.
  4297         16  FILLER              PIC X           VALUE SPACE.
  4298         16  TRD-AHTRM           PIC ZZ9.
  4299         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4300         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4301         16  TRD-AHACTDT.
  4302             20  FILLER          PIC X           VALUE SPACE.
  4303             20  TRD-AHACTMO     PIC XX.
  4304             20  TRD-AH-S1       PIC X           VALUE '/'.
  4305             20  TRD-AHACTDA     PIC XX.
  4306             20  TRD-AH-S2       PIC X           VALUE '/'.
  4307             20  TRD-AHACTYR     PIC XX.
  4308             20  FILLER          PIC X           VALUE SPACE.
  4309         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4310         16  FILLER              PIC X           VALUE SPACE.
  4311         16  TRD-AH-STATUS       PIC X.
  4312     12  TR-DTL3 REDEFINES TR-DTL2.
  4313         16  FILLER              PIC X(20).
  4314         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4315         16  FILLER              PIC X.
  4316         16  TRD-IBNRX           PIC X(4).
  4317         16  FILLER              PIC X(2).
  4318         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4319         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4320                                 PIC X(11).
  4321         16  FILLER              PIC X.
  4322         16  TRD-PAYCURX         PIC X(8).
  4323         16  FILLER              PIC X(2).
  4324         16  TRD-FUTRSV-DATA.
  4325             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4326             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4327                                 PIC X(11).
  4328             20  FILLER          PIC X.
  4329             20  TRD-FUTRSVX     PIC X(6).
  4330         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4331             20  TRD-BENEFIT-X   PIC X(10).
  4332             20  TRD-BENEFIT-CODE
  4333                                 PIC X(02).
  4334             20  FILLER          PIC X(06).
  4335         16  FILLER              PIC X(4).
  4336         16  TRD-RSV-DESC        PIC X(6).
  4337         16  TRD-RSV-ACTION      PIC X(21).
  4338
  4339 01  DET-PR-UREC.
  4340     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4341     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4342     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4343     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4344     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4345     12  DET-SEX             PIC X.
  4346     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4347     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4348     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4349     12  DET-PR-MEM          PIC X(12).
  4350     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4351     12  DET-PR-SS           PIC X(11).
  4352     12  FILLER              PIC XXX      VALUE SPACES.
  4353     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  86
* ECS010.cbl
  4354
  4355 01  DET-PR-UREC-2.
  4356     12  FILLER              PIC X        VALUE SPACE.
  4357     12  DET-LF-DESC         PIC XX.
  4358     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4359     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4360     12  FILLER              PIC X(4)     VALUE ' TO '.
  4361     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4362     12  FILLER              PIC X        VALUE SPACE.
  4363     12  DET-AH-DESC         PIC XX.
  4364     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4365     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4366     12  FILLER              PIC X(4)     VALUE ' TO '.
  4367     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4368     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4369     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4370     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4371     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4372     12  FILLER              PIC X(5)     VALUE SPACES.
  4373     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4374
  4375 01  DET-PR-UREC-3.
  4376     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4377     12  DET-IND-GRP         PIC X.
  4378     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4379     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4380     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4381     12  DET-POL-FORM        PIC X(12).
  4382     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4383     12  DET-LOAN-OFFICER    PIC XXX.
  4384     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4385     12  DET-USER-CODE       PIC X.
  4386     12  FILLER              PIC X(8)     VALUE SPACES.
  4387     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4388
  4389 01  DET-PR-UREC-4.
  4390     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4391     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4392     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4393     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4394     12  FILLER              PIC X(37)    VALUE SPACES.
  4395     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4396
  4397 01  DET-PR-UREC-5.
  4398     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4399     12  DET-LF-BEN-CD       PIC XX.
  4400     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4401     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4402     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4403     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4404     12  FILLER              PIC X(30)    VALUE SPACES.
  4405     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4406
  4407 01  DET-PR-UREC-6.
  4408     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4409     12  DET-AH-BEN-CD       PIC XX.
  4410     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4411     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  87
* ECS010.cbl
  4412     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4413     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4414     12  FILLER              PIC X(30)    VALUE SPACES.
  4415     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4416
  4417 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4418     88  WS-CHANGE-REC              VALUE 'Y'.
  4419
  4420 01  TOTAL-PAGE-HD1.
  4421     12  FILLER              PIC X               VALUE SPACE.
  4422     12  TPH1-TYPE           PIC X(8).
  4423     12  TPH1-DESC.
  4424         16  TPH1-ST-CODE    PIC XX.
  4425         16  FILLER          PIC XXX.
  4426         16  TPH1-ST-DESC    PIC X(20).
  4427
  4428 01  TOTAL-PAGE-HD2.
  4429     12  FILLER              PIC X           VALUE SPACE.
  4430     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4431     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4432     12  FILLER              PIC X(9)        VALUE SPACES.
  4433     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4434     12  FILLER              PIC X(11)       VALUE SPACES.
  4435     12  FILLER              PIC X(3)        VALUE 'NET'.
  4436     12  FILLER              PIC X(11)       VALUE SPACES.
  4437     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4438     12  FILLER              PIC X(10)       VALUE SPACES.
  4439     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4440
  4441 01  TOTAL-PAGE-HD3.
  4442     12  FILLER              PIC X           VALUE SPACE.
  4443     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4444     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4445     12  FILLER              PIC X(10)       VALUE SPACES.
  4446     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4447     12  FILLER              PIC X(10)       VALUE SPACES.
  4448     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4449     12  FILLER              PIC X(7)        VALUE SPACES.
  4450     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4451     12  FILLER              PIC X(08)       VALUE SPACES.
  4452     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4453     12  FILLER              PIC X(11)       VALUE SPACES.
  4454     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4455
  4456 01  TOTAL-PAGE-DETAIL.
  4457     12  FILLER              PIC X(5).
  4458     12  TPD-DESC            PIC X(6).
  4459     12  FILLER              PIC X(3).
  4460     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4461     12  FILLER              PIC X(2).
  4462     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4463     12  FILLER              PIC X(2).
  4464     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4465     12  FILLER              PIC X(2).
  4466     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4467     12  FILLER              PIC X(2).
  4468     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4469     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  88
* ECS010.cbl
  4470     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4471     12  FILLER              PIC X(4).
  4472     12  TPD-LO-CERT         PIC X(6).
  4473     12  FILLER              PIC X(2).
  4474     12  TPD-HI-CERT         PIC X(6).
  4475*    12  FILLER              PIC X.
  4476*    12  TPD-LO-CERT         PIC X(8).
  4477*    12  FILLER              PIC X.
  4478*    12  TPD-HI-CERT         PIC X(8).
  4479
  4480 01  DUPE-CERT-TABLE.
  4481     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4482         16  DUPE-ENTRY      PIC X(36).
  4483         16  DUPE-STATUS     PIC X(01).
  4484         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4485         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4486
  4487 01  MISMATCH-HEADING-1.
  4488     12  FILLER              PIC X           VALUE '1'.
  4489     12  FILLER              PIC X(45)       VALUE SPACES.
  4490     12  FILLER              PIC X(42)       VALUE
  4491             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4492     12  FILLER              PIC X(35)       VALUE SPACES.
  4493     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4494
  4495 01  MISMATCH-HEADING-2.
  4496     12  FILLER              PIC X           VALUE '0'.
  4497     12  FILLER              PIC X(44)       VALUE
  4498             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4499     12  FILLER              PIC X(44)       VALUE
  4500             'YPE      CERT IN CONTROL                    '.
  4501     12  FILLER              PIC X(44)       VALUE
  4502             '        CERT OUT CONTROL           STATUS   '.
  4503
  4504 01  MISMATCH-DETAIL.
  4505     12  FILLER              PIC X           VALUE '0'.
  4506     12  FILLER              PIC X           VALUE SPACES.
  4507     12  DTL-MATCH-CONTROL   PIC X(36).
  4508     12  FILLER              PIC X(3)        VALUE SPACES.
  4509     12  DTL-REC-TYPE        PIC X.
  4510     12  FILLER              PIC X(2)        VALUE SPACES.
  4511     12  DTL-REC-TYPE-DESC   PIC X(3).
  4512     12  FILLER              PIC X(3)        VALUE SPACES.
  4513     12  DTL-CERT-IN-CONTROL
  4514                             PIC X(36).
  4515     12  FILLER              PIC X           VALUE SPACES.
  4516     12  DTL-CERT-OUT-CONTROL
  4517                             PIC X(36).
  4518     12  FILLER              PIC X           VALUE SPACES.
  4519     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4520     12  FILLER              PIC X(2)        VALUE SPACES.
  4521
  4522 01  MISMATCH-DETAIL-2.
  4523     12  FILLER              PIC X           VALUE ' '.
  4524     12  FILLER              PIC X           VALUE SPACES.
  4525     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4526             ' LIFE PREMIUM = '.
  4527     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  89
* ECS010.cbl
  4528     12  FILLER              PIC X           VALUE SPACES.
  4529     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4530             'LIFE ALT PREM = '.
  4531     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4532     12  FILLER              PIC XX          VALUE SPACES.
  4533     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4534             'A/H PREMIUM = '.
  4535     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4536     12  FILLER              PIC X(39)       VALUE SPACES.
  4537
  4538 01  MISMATCH-DETAIL-3.
  4539     12  FILLER              PIC X           VALUE ' '.
  4540     12  FILLER              PIC X           VALUE SPACES.
  4541     12  FILLER              PIC X(16)       VALUE
  4542             ' LIFE  REFUND = '.
  4543     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4544     12  FILLER              PIC X           VALUE SPACES.
  4545     12  FILLER              PIC X(16)       VALUE
  4546             'A & H  REFUND = '.
  4547     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4548     12  FILLER              PIC X(72)       VALUE SPACES.
  4549
  4550 01  MISMATCH-DETAIL-4.
  4551     12  FILLER              PIC X           VALUE ' '.
  4552     12  FILLER              PIC X           VALUE SPACES.
  4553     12  FILLER              PIC X(16)       VALUE
  4554             ' LIFE  CLAIM  = '.
  4555     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4556     12  FILLER              PIC X           VALUE SPACES.
  4557     12  FILLER              PIC X(16)       VALUE
  4558             'A & H  CLAIM  = '.
  4559     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4560     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  90
* ECS010.cbl
  4562*
  4563*
  4564* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  91
* ECS010.cbl
  4566 01  PB-STARTS-HERE              PIC X(48)
  4567       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4568
* 4569                             COPY ERCPNDB.
  4570******************************************************************
  4571*                                                                *
  4572*                                                                *
  4573*                            ERCPNDB.                            *
  4574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4575*                            VMOD=2.025                          *
  4576*                                                                *
  4577*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4578*                                                                *
  4579******************************************************************
  4580*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4581*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4582******************************************************************
  4583*                                                                *
  4584*                                                                *
  4585*   FILE TYPE = VSAM,KSDS                                        *
  4586*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4587*                                                                *
  4588*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4589*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4590*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4591*                                                 RKP=13,LEN=36  *
  4592*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4593*                                      AND CHG-SEQ.)             *
  4594*                                                RKP=49,LEN=11   *
  4595*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4596*                                      AND CHG-SEQ.)             *
  4597*                                                RKP=60,LEN=15   *
  4598*                                                                *
  4599*   LOG = NO                                                     *
  4600*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4601******************************************************************
  4602******************************************************************
  4603*                   C H A N G E   L O G
  4604*
  4605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4606*-----------------------------------------------------------------
  4607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4608* EFFECTIVE    NUMBER
  4609*-----------------------------------------------------------------
  4610* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4611* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4612* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4613* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4614* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4615* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4616* 032306                   PEMA  ADD BOW LOAN NUMBER
  4617* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4618* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4619* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4620* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4621* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4622* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4623* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  92
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4624* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4625******************************************************************
  4626
  4627 01  PENDING-BUSINESS.
  4628     12  PB-RECORD-ID                     PIC XX.
  4629         88  VALID-PB-ID                        VALUE 'PB'.
  4630
  4631     12  PB-CONTROL-PRIMARY.
  4632         16  PB-COMPANY-CD                PIC X.
  4633         16  PB-ENTRY-BATCH               PIC X(6).
  4634         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4635         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4636
  4637     12  PB-CONTROL-BY-ACCOUNT.
  4638         16  PB-COMPANY-CD-A1             PIC X.
  4639         16  PB-CARRIER                   PIC X.
  4640         16  PB-GROUPING.
  4641             20  PB-GROUPING-PREFIX       PIC XXX.
  4642             20  PB-GROUPING-PRIME        PIC XXX.
  4643         16  PB-STATE                     PIC XX.
  4644         16  PB-ACCOUNT.
  4645             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4646             20  PB-ACCOUNT-PRIME         PIC X(6).
  4647         16  PB-CERT-EFF-DT               PIC XX.
  4648         16  PB-CERT-NO.
  4649             20  PB-CERT-PRIME            PIC X(10).
  4650             20  PB-CERT-SFX              PIC X.
  4651         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4652
  4653         16  PB-RECORD-TYPE               PIC X.
  4654             88  PB-MAILING-DATA                VALUE '0'.
  4655             88  PB-ISSUE                       VALUE '1'.
  4656             88  PB-CANCELLATION                VALUE '2'.
  4657             88  PB-BATCH-TRAILER               VALUE '9'.
  4658
  4659     12  PB-CONTROL-BY-ORIG-BATCH.
  4660         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4661         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4662         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4663         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4664
  4665     12  PB-CONTROL-BY-CSR.
  4666         16  PB-CSR-COMPANY-CD            PIC X.
  4667         16  PB-CSR-ID                    PIC X(4).
  4668         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4669         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4670         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4671******************************************************************
  4672*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4673******************************************************************
  4674
  4675     12  PB-LAST-MAINT-DT                 PIC XX.
  4676     12  PB-LAST-MAINT-BY                 PIC X(4).
  4677     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4678
  4679     12  PB-RECORD-BODY                   PIC X(375).
  4680
  4681     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4682         16  PB-CERT-ORIGIN               PIC X.
  4683             88  CLASIC-CREATED-CERT         VALUE '1'.
  4684         16  PB-I-NAME.
  4685             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4686             20  PB-I-INSURED-FIRST-NAME.
  4687                 24  PB-I-INSURED-1ST-INIT PIC X.
  4688                 24  FILLER                PIC X(9).
  4689             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4690         16  PB-I-AGE                     PIC S99   COMP-3.
  4691         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4692         16  PB-I-BIRTHDAY                PIC XX.
  4693         16  PB-I-INSURED-SEX             PIC X.
  4694             88  PB-SEX-MALE     VALUE 'M'.
  4695             88  PB-SEX-FEMALE   VALUE 'F'.
  4696
  4697         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4698         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4699         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4700         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4701         16  PB-I-SKIP-CODE               PIC X.
  4702             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4703             88  PB-SKIP-JULY              VALUE '1'.
  4704             88  PB-SKIP-AUGUST            VALUE '2'.
  4705             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4706             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4707             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4708             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4709             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4710             88  PB-SKIP-JUNE              VALUE '8'.
  4711             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4712             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4713             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4714         16  PB-I-TERM-TYPE               PIC X.
  4715             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4716             88  PB-PAID-WEEKLY            VALUE 'W'.
  4717             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4718             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4719             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4720         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4721         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4722         16  PB-I-DATA-ENTRY-SW           PIC X.
  4723             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4724             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4725             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4726             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4727         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4728         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4729*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4730         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4731         16  FILLER                       PIC X.
  4732
  4733         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4734             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4735             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4736                                                   '90' THRU '99'.
  4737         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4738                                          PIC XX.
  4739         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4740         16  PB-I-AMOUNT-FINANCED REDEFINES
  4741                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4742         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4743         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4744                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4745         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4746         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4747         16  PB-I-CLP-AMOUNT REDEFINES
  4748                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4749         16  PB-I-LF-CALC-FLAG            PIC X.
  4750             88 PB-COMP-LF-PREM               VALUE '?'.
  4751         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4752         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4753         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4754         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4755         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4756         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4757         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4758         16  PB-I-LF-ABBR                 PIC XXX.
  4759         16  PB-I-LF-INPUT-CD             PIC XX.
  4760
  4761         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4762             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4763             88  PB-INVALID-AH               VALUE '  ' '00'
  4764                                                   '90' THRU '99'.
  4765         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4766         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4767         16  PB-I-AH-CALC-FLAG            PIC X.
  4768             88 PB-COMP-AH-PREM                  VALUE '?'.
  4769         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4770         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4771         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4772         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4773         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4774         16  PB-I-AH-ABBR                 PIC XXX.
  4775         16  PB-I-AH-INPUT-CD             PIC XXX.
  4776
  4777         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4778         16  PB-I-REIN-TABLE              PIC XXX.
  4779         16  PB-I-BUSINESS-TYPE           PIC 99.
  4780         16  PB-I-INDV-GRP-CD             PIC X.
  4781         16  PB-I-MORT-CODE.
  4782             20  PB-I-TABLE               PIC X.
  4783             20  PB-I-INTEREST            PIC XX.
  4784             20  PB-I-MORT-TYP            PIC X.
  4785         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4786         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4787         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4788         16  PB-I-INDV-GRP-OVRD           PIC X.
  4789         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4790         16  PB-I-SIG-SW                  PIC X.
  4791             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4792         16  PB-I-RATE-CLASS              PIC XX.
  4793         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4794         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4795         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4796         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4797         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4798         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4799         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4800         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4801         16  PB-I-OB-FLAG                 PIC X.
  4802             88  PB-I-OB                      VALUE 'B'.
  4803             88  PB-I-SUMMARY                 VALUE 'Z'.
  4804         16  PB-I-ENTRY-STATUS            PIC X.
  4805             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4806                                              'M' '5' '9' '2'.
  4807             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4808             88  PB-I-POLICY-PENDING          VALUE '2'.
  4809             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4810             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4811             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4812             88  PB-I-REIN-ONLY               VALUE '9'.
  4813             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4814             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4815             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4816             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4817         16  PB-I-INT-CODE                PIC X.
  4818             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4819             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4820         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4821         16  PB-I-SOC-SEC-NO              PIC X(11).
  4822         16  PB-I-MEMBER-NO               PIC X(12).
  4823         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4824*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4825         16  PB-I-OLD-LOF                 PIC XXX.
  4826         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4827         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4828         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4829         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4830         16  PB-I-LIFE-INDICATOR          PIC X.
  4831             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4832         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4833         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4834                                          PIC S9(5)V99    COMP-3.
  4835         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4836             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4837             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4838         16  PB-I-1ST-PMT-DT              PIC XX.
  4839         16  PB-I-JOINT-INSURED.
  4840             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4841             20 PB-I-JOINT-FIRST-NAME.
  4842                24  PB-I-JOINT-FIRST-INIT PIC X.
  4843                24  FILLER                PIC X(9).
  4844             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4845*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4846         16  PB-I-BENEFICIARY-NAME.
  4847             20  PB-I-BANK-NUMBER         PIC X(10).
  4848             20  FILLER                   PIC X(15).
  4849         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4850         16  PB-I-REFERENCE               PIC X(12).
  4851         16  FILLER REDEFINES PB-I-REFERENCE.
  4852             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4853             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4854             20  PB-I-CLP-STATE           PIC XX.
  4855         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4856             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4857             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4858             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4859         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4860         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4861         16  PB-I-RESIDENT-STATE          PIC XX.
  4862         16  PB-I-RATE-CODE               PIC X(4).
  4863         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4864         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4865         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4866         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4867         16  PB-I-BANK-NOCHRGB            PIC 99.
  4868         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4869         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4870
  4871     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4872         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4873             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4874         16  PB-C-CANCEL-ORIGIN           PIC X.
  4875             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4876         16  PB-C-LF-CANCEL-DT            PIC XX.
  4877         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4878         16  PB-C-LF-CALC-REQ             PIC X.
  4879             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4880         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4881         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4882         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4883             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4884         16  PB-C-AH-CANCEL-DT            PIC XX.
  4885         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4886         16  PB-C-AH-CALC-REQ             PIC X.
  4887             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4888         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4889         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4890         16  PB-C-LAST-NAME               PIC X(15).
  4891         16  PB-C-REFUND-SW               PIC X.
  4892             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4893             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4894         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4895         16  PB-C-PAYEE-CODE              PIC X(6).
  4896         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4897         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4898         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4899         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4900         16  PB-C-REFERENCE               PIC X(12).
  4901         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4902         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4903         16  PB-C-POST-CARD-IND           PIC X.
  4904         16  PB-C-CANCEL-REASON           PIC X.
  4905         16  PB-C-REF-INTERFACE-SW        PIC X.
  4906         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4907         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4908         16  FILLER                       PIC X(01).
  4909*        16  FILLER                       PIC X(18).
  4910         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4911*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4912         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4913         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4914             20  PB-CI-INSURED-NAME.
  4915                 24  PB-CI-LAST-NAME      PIC X(15).
  4916                 24  PB-CI-INITIALS       PIC XX.
  4917             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4918             20  PB-CI-INSURED-SEX        PIC X.
  4919             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4920             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4921             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4922             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4923             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4924             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4925             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4926             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4927             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4928             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4929             20  PB-CI-RATE-CLASS         PIC XX.
  4930             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4931             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4932             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4933             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4934             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4935             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4936             20  PB-CI-LF-ABBR            PIC X(3).
  4937             20  PB-CI-AH-ABBR            PIC X(3).
  4938             20  PB-CI-OB-FLAG            PIC X.
  4939                 88  PB-CI-OB                VALUE 'B'.
  4940             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4941                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4942                                           'M' '4' '5' '9' '2'.
  4943                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4944                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4945                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4946                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4947                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4948                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4949                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4950                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4951                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4952                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4953                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4954                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4955             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4956                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4957                                           'M' '4' '5' '9' '2'.
  4958                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4959                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4960                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4961                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4962                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4963                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4964                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4965                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4966                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4967                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4968                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4969                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4970             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4971             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4972             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4973             20  PB-CI-MEMBER-NO          PIC X(12).
  4974             20  PB-CI-INT-CODE           PIC X.
  4975                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4976                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4977             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4978             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4979             20  PB-CI-COMP-EXCP-SW       PIC X.
  4980                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4981                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4982             20  PB-CI-ENTRY-STATUS       PIC X.
  4983             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4984             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4985             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4986             20  PB-CI-DEATH-DT           PIC XX.
  4987             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4988             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4989             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4990             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4991             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4992             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4993             20  PB-CI-ENTRY-DT              PIC XX.
  4994             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4995             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4996             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4997             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4998             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4999             20  PB-CI-OLD-LOF               PIC XXX.
  5000*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5001             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5002             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5003             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5004             20  PB-CI-INDV-GRP-CD           PIC X.
  5005             20  PB-CI-BENEFICIARY-NAME.
  5006                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5007                 24  FILLER                  PIC X(15).
  5008             20  PB-CI-NOTE-SW               PIC X.
  5009             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5010             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5011             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5012             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5013             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5014             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5015             20  PB-CI-FIRST-NAME            PIC X(10).
  5016             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5017
  5018         16  FILLER                       PIC X(13).
  5019*032306  16  FILLER                       PIC X(27).
  5020*        16  FILLER                       PIC X(46).
  5021
  5022     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5023         16  FILLER                       PIC X(10).
  5024         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5025         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5026         16  PB-M-INSURED-MID-INIT        PIC X.
  5027         16  PB-M-INSURED-AGE             PIC 99.
  5028         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5029         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5030         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5031         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5032         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5033         16  PB-M-INSURED-CITY-STATE.
  5034             20  PB-M-INSURED-CITY        PIC X(28).
  5035             20  PB-M-INSURED-STATE       PIC XX.
  5036         16  PB-M-INSURED-ZIP-CODE.
  5037             20  PB-M-INSURED-ZIP-PRIME.
  5038                 24  PB-M-INSURED-ZIP-1   PIC X.
  5039                     88  PB-M-CANADIAN-POST-CODE
  5040                                             VALUE 'A' THRU 'Z'.
  5041                 24  FILLER               PIC X(4).
  5042             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5043         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5044                                        PB-M-INSURED-ZIP-CODE.
  5045             20  PM-M-INS-CAN-POST1       PIC XXX.
  5046             20  PM-M-INS-CAN-POST2       PIC XXX.
  5047             20  FILLER                   PIC XXX.
  5048         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5049         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5050         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5051         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5052         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5053         16  PB-M-CRED-BENE-CITYST.
  5054             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5055             20  PB-M-CRED-BENE-STATE     PIC XX.
  5056
  5057         16  FILLER                       PIC X(92).
  5058
  5059     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5060         16  FILLER                       PIC X(10).
  5061         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5062         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5063         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5064         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5065         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5066         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5067         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5068         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5069         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5070         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5071         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5072         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5073         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5074         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5075         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5076         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5077         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5078         16  PB-ACCOUNT-NAME              PIC X(30).
  5079         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5080         16  PB-REFERENCE                 PIC X(12).
  5081         16  PB-B-RECEIVED-DT             PIC XX.
  5082         16  FILLER                       PIC X(234).
  5083
  5084     12  PB-RECORD-STATUS.
  5085         16  PB-CREDIT-SELECT-DT          PIC XX.
  5086         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5087         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5088         16  PB-BILLING-STATUS            PIC X.
  5089             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5090             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5091             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5092         16  PB-RECORD-BILL               PIC X.
  5093             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5094             88  PB-RECORD-RETURNED           VALUE 'R'.
  5095             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5096             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5097             88  PB-OVERRIDE-AH               VALUE 'A'.
  5098             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5099         16  PB-BATCH-ENTRY               PIC X.
  5100             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5101             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5102             88  PB-REISSUED-CERT             VALUE 'E'.
  5103             88  PB-MONTHLY-CERT              VALUE 'M'.
  5104             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5105             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5106             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5107         16  PB-FORCE-CODE                PIC X.
  5108             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5109             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5110             88  PB-CANCEL-FORCE              VALUE '8'.
  5111             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5112             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5113             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5114             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5115             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5116             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5117             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5118         16  PB-FATAL-FLAG                PIC X.
  5119             88  PB-FATAL-ERRORS              VALUE 'X'.
  5120         16  PB-FORCE-ER-CD               PIC X.
  5121             88  PB-FORCE-ERRORS              VALUE 'F'.
  5122             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5123         16  PB-WARN-ER-CD                PIC X.
  5124             88  PB-WARNING-ERRORS            VALUE 'W'.
  5125         16  FILLER                       PIC X.
  5126         16  PB-OUT-BAL-CD                PIC X.
  5127             88  PB-OUT-OF-BAL                VALUE 'O'.
  5128         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5129         16  PB-AH-OVERRIDE-L1            PIC X.
  5130         16  PB-INPUT-DT                  PIC XX.
  5131         16  PB-INPUT-BY                  PIC X(4).
  5132         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5133         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5134         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5135         16  PB-LF-EARNING-METHOD         PIC X.
  5136         16  PB-AH-EARNING-METHOD         PIC X.
  5137         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5138         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5139         16  PB-REIN-CD                   PIC XXX.
  5140         16  PB-LF-REFUND-TYPE            PIC X.
  5141         16  PB-AH-REFUND-TYPE            PIC X.
  5142         16  PB-ACCT-EFF-DT               PIC XX.
  5143         16  PB-ACCT-EXP-DT               PIC XX.
  5144         16  PB-COMPANY-ID                PIC X(3).
  5145         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5146         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5147         16  PB-SV-CARRIER                PIC X.
  5148         16  PB-SV-GROUPING               PIC X(6).
  5149         16  PB-SV-STATE                  PIC XX.
  5150         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5151         16  PB-GA-BILLING-INFO.
  5152             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5153                                          PIC XX.
  5154         16  PB-SV-REMIT-TO  REDEFINES
  5155             PB-GA-BILLING-INFO           PIC X(10).
  5156         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5157         16  PB-I-LOAN-OFFICER            PIC X(5).
  5158         16  PB-I-VIN                     PIC X(17).
  5159
  5160         16  FILLER                       PIC X(04).
  5161         16  IMNET-BYPASS-SW              PIC X.
  5162
  5163******************************************************************
  5164*                COMMON EDIT ERRORS                              *
  5165******************************************************************
  5166
  5167     12  PB-COMMON-ERRORS.
  5168         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5169                                           PIC S9(4)     COMP.
  5170
  5171******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 102
* ECS010.cbl
  5173 01  PC-STARTS-HERE              PIC X(48)
  5174       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5175
* 5176                             COPY ERCPNDC.
  5177******************************************************************04/29/98
  5178*                                                                *ERCPNDC
  5179*                                                                *ERCPNDC
  5180*                            ERCPNDC                             *   LV003
  5181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5182*                            VMOD=2.004                          *   CL**2
  5183*                                                                *ERCPNDC
  5184*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5185*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5186*                                                                *ERCPNDC
  5187*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5188*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5189*                                                                *ERCPNDC
  5190*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5191*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5192*                                                                *ERCPNDC
  5193*   LOG = YES                                                    *ERCPNDC
  5194*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5195******************************************************************ERCPNDC
  5196                                                                  ERCPNDC
  5197 01  PENDING-CLAIMS.                                              ERCPNDC
  5198     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5199         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5200                                                                  ERCPNDC
  5201     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5202         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5203         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5204         16  PC-GROUPING.                                         ERCPNDC
  5205             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5206             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5207         16  PC-STATE                     PIC XX.                 ERCPNDC
  5208         16  PC-ACCOUNT.                                          ERCPNDC
  5209             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5210             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5211         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5212         16  PC-CERT-NO.                                          ERCPNDC
  5213             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5214             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5215         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5216         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5217                                                                  ERCPNDC
  5218         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5219             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5220             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5221         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5222                                                                  ERCPNDC
  5223     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5224     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5225     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5226                                                                  ERCPNDC
  5227     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5228         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5229             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5230             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 103
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5231             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5232             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5233         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5234         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5235         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5236         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5237         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5238         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5239         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5240         16  FILLER                       PIC XX.                 ERCPNDC
  5241         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5242             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5243             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5244             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5245             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5246             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5247             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5248             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5249                                                                  ERCPNDC
  5250         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5251         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5252         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5253         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5254                                                                  ERCPNDC
  5255         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5256         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5257         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5258                                                                  ERCPNDC
  5259         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5260             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5261                                                                  ERCPNDC
  5262         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5263         16  FILLER                       PIC X(48).              ERCPNDC
  5264                                                                  ERCPNDC
  5265         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5266             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5267                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5268                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5269             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5270             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5271             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5272             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5273             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5274             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5275             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5276             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5277             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5278             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5279             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5280             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5281             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5282                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5283             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5284                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5285                                               '4' '5' '9' '2'.   ERCPNDC
  5286                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5287                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5288                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5289                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5290                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5291                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5292                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5293                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5294                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5295             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5296                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5297                                               '4' '5' '9' '2'.   ERCPNDC
  5298                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5299                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5300                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5301                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5302                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5303                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5304                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5305                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5306                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5307             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5308             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5309             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5310             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5311             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5312                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5313                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5314             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5315             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5316             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5317             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5318             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5319             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5320             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5321             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5322         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5323         16  PC-CC-CLP-STATE              PIC XX.
  5324         16  FILLER                       PIC X(14).              ERCPNDC
  5325         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5326         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5327         16  FILLER                       PIC X(34).              ERCPNDC
  5328                                                                  ERCPNDC
  5329     12  PC-RECORD-STATUS.                                        ERCPNDC
  5330         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5331         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5332         16  FILLER                       PIC XX.                 ERCPNDC
  5333         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5334             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5335         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5336             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5337             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5338                                                     '8'.         ERCPNDC
  5339         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5340             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5341             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5342         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5343             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5344         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5345         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5346         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5347         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5348             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5349         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5350         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5351                                                                  ERCPNDC
  5352     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5353         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5354             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5355         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5356             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5357                                                                  ERCPNDC
  5358     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5359         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5360                                                                  ERCPNDC
  5361     12  FILLER                           PIC X(25).              ERCPNDC
  5362                                                                  ERCPNDC
  5363******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 106
* ECS010.cbl
  5365 01  CC-STARTS-HERE              PIC X(48)
  5366       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5367
* 5368                             COPY ERCCRTC.
  5369******************************************************************04/29/98
  5370*                                                                *ERCCRTC
  5371*                                                                *ERCCRTC
  5372*                            ERCCRTC                             *   LV003
  5373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5374*                            VMOD=2.005                          *   CL**3
  5375*                                                                *ERCCRTC
  5376*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5377*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5378*                       ISSUES AND CANCELS)                      *ERCCRTC
  5379*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5380*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5381*                                                                *ERCCRTC
  5382*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5383*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5384*                                                                *ERCCRTC
  5385*   LOG = YES                                                    *ERCCRTC
  5386*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5387******************************************************************ERCCRTC
  5388*                   C H A N G E   L O G
  5389*
  5390* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5391*-----------------------------------------------------------------
  5392*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5393* EFFECTIVE    NUMBER
  5394*-----------------------------------------------------------------
  5395* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5396******************************************************************
  5397 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5398     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5399         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5400                                                                  ERCCRTC
  5401     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5402         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5403         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5404         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5405         16  CC-STATE                     PIC XX.                 ERCCRTC
  5406         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5407         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5408         16  CC-CERT-NO.                                          ERCCRTC
  5409             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5410             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5411                                                                  ERCCRTC
  5412         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5413                                                                  ERCCRTC
  5414     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5415     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5416     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5417                                                                  ERCCRTC
  5418     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5419                                                                  ERCCRTC
  5420     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5421         16  FILLER                       PIC X(10).              ERCCRTC
  5422         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 107
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5423             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5424             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5425                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5426                 24  FILLER               PIC X(9).               ERCCRTC
  5427             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5428         16  CC-AGE                       PIC S99.                ERCCRTC
  5429         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5430         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5431         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5432             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5433             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5434         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5435             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5436             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5437                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5438                 24  FILLER               PIC X(9).               ERCCRTC
  5439             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5440         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5441         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5442         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5443         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5444         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5445         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5446         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5447         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5448         16  CC-OLD-LOF                   PIC XXX.
  5449*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5450         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5451         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5452         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5453         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5454         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5455         16  FILLER                       PIC X(3).               ERCCRTC
  5456         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5457         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5458         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5459         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5460         16  CC-LOAN-OFFICER              PIC X(5).
  5461         16  FILLER                       PIC XXX.                ERCCRTC
  5462     12  CC-RECORD-STATUS.                                        ERCCRTC
  5463         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5464         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5465     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5466         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5467         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5468         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5469         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5470     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5471     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5472         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5473             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5474         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5475             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5476     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5477         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5478         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5479         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5480         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5481                                                                  ERCCRTC
  5482     12  FILLER                           PIC X(05).              ERCCRTC
  5483******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 109
* ECS010.cbl
  5485 01  CR-STARTS-HERE              PIC X(48)
  5486       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5487
* 5488                             COPY ECSCRT01.
  5489******************************************************************
  5490*                                                                *
  5491*                            ECSCRT01                            *
  5492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5493*                            VMOD=2.016                          *
  5494*                                                                *
  5495*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5496*                                                                *
  5497*   FILE TYPE = SEQUENTIAL
  5498*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5499*                                                                *
  5500*   KEY DATA =                         START=4, LEN=36           *
  5501*                                                                *
  5502*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5503*                                                                *
  5504******************************************************************
  5505******************************************************************
  5506*                   C H A N G E   L O G
  5507*
  5508* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5509*-----------------------------------------------------------------
  5510*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5511* EFFECTIVE    NUMBER
  5512*-----------------------------------------------------------------
  5513* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5514* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5515* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5516* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5517* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5518* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5519* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5520* 032612  CR2011110200001  PEMA  AHL CHANGES
  5521******************************************************************
  5522
  5523 01  CERTIFICATE-RECORD.
  5524     12  CR-RECORD-ID                      PIC XX.
  5525         88  VALID-CR-ID                      VALUE 'CR'.
  5526
  5527     12  CR-COMPANY-CD                     PIC X.
  5528
  5529     12  CR-FULL-CONTROL.
  5530         16  CR-CONTROL-1.
  5531             20  CR-ACCT-CONTROL.
  5532                 24  CR-CARRIER            PIC X.
  5533                 24  CR-GROUPING.
  5534                     28  CR-GROUP-PREFIX   PIC XXX.
  5535                     28  CR-GROUP-PRIME    PIC XXX.
  5536                 24  CR-STATE              PIC XX.
  5537                 24  CR-ACCOUNT.
  5538                     28  CR-ACCT-PREFIX    PIC X(4).
  5539                     28  CR-ACCT-PRIME     PIC X(6).
  5540             20  CR-DT                     PIC 9(11)  COMP-3.
  5541         16  CR-CERT-NO.
  5542             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 110
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5543                 24  CR-CERT-PREFIX        PIC X(3).
  5544                 24  CR-CERT-PRIME         PIC X(7).
  5545             20  CR-CERT-SFX               PIC X.
  5546
  5547     12  CR-INSUREDS-PROFILE.
  5548         16  CR-NAME.
  5549             20  CR-LNAME                  PIC X(15).
  5550             20  CR-FNAME.
  5551                 24  CR-1ST-INITIAL        PIC X.
  5552                 24  FILLER                PIC X(9).
  5553             20  CR-INIT                   PIC X.
  5554         16  CR-AGE                        PIC 99.
  5555         16  CR-SEX                        PIC X.
  5556             88  CR-SEX-MALE                  VALUE 'M'.
  5557             88  CR-SEX-FEMALE                VALUE 'F'.
  5558         16  CR-SOC-SEC                    PIC X(11).
  5559         16  CR-JOINT-NAME.
  5560             20  CR-JT-LNAME               PIC X(15).
  5561             20  CR-JT-FNAME.
  5562                 24  CR-JT-1ST-INIT        PIC X.
  5563                 24  FILLER                PIC X(9).
  5564             20  CR-JT-INIT                PIC X.
  5565         16  CR-JOINT-AGE                  PIC 99.
  5566
  5567         16  cr-ahl-ah-claim-no            pic x(9).
  5568         16  cr-ahl-ah-cert-seq            pic x(3).
  5569         16  cr-hst-proc-lf                pic x.
  5570         16  f                             pic x(7).
  5571
  5572     12  CR-LF-COVERAGE-DATA.
  5573         16  CR-LFTYP                      PIC XX.
  5574         16  CR-LF-TERM                    PIC S999       COMP-3.
  5575         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5576         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5577         16  CR-LF-DEV-CODE                PIC XXX.
  5578         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5579
  5580         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5581         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5582         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5583         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5584
  5585         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5586         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5587         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5588         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5589
  5590         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5591         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5592
  5593         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5594         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5595
  5596         16  CR-LF-REFUND-TYPE             PIC X.
  5597         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5598
  5599         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5600             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5601
  5602         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5603
  5604         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5605         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5606         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5607
  5608         16  cr-ahl-lf-claim-no            pic x(9).
  5609         16  cr-ahl-lf-cert-seq            pic x(3).
  5610         16  FILLER                        PIC XX.
  5611
  5612     12  CR-AH-COVERAGE-DATA.
  5613         16  CR-AHTYP                      PIC XX.
  5614         16  CR-AH-TERM                    PIC S999       COMP-3.
  5615         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5616         16  CR-AH-DEV-CODE                PIC XXX.
  5617         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5618
  5619         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5620         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5621         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5622         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5623
  5624         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5625         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5626
  5627         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5628         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5629
  5630         16  CR-AH-REFUND-TYPE             PIC X.
  5631         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5632
  5633         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5634             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5635
  5636         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5637
  5638         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5639         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5640         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5641
  5642         16  FILLER                        PIC XX.
  5643*        16  FILLER                        PIC X(8).
  5644
  5645     12  CR-LOAN-DATA.
  5646         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5647         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5648                                           PIC S9(5)V99   COMP-3.
  5649         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5650         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5651         16  CR-PMT-FREQ                   PIC 99.
  5652         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5653         16  CR-RATING-CLASS               PIC XX.
  5654         16  CR-POLICY-FORM-NO             PIC X(12).
  5655         16  CR-GRPTYP                     PIC XX.
  5656         16  CR-IND-GRP                    PIC X.
  5657             88  CR-INDIVIDUAL                VALUE '1'.
  5658             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5659         16  CR-SKIP                       PIC 99.
  5660             88  NO-MONTHS-SKIPPED            VALUE 00.
  5661             88  SKIP-JULY                    VALUE 01.
  5662             88  SKIP-AUGUST                  VALUE 02.
  5663             88  SKIP-SEPTEMBER               VALUE 03.
  5664             88  SKIP-JULY-AUG                VALUE 04.
  5665             88  SKIP-AUG-SEPT                VALUE 05.
  5666             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5667             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5668             88  SKIP-JUNE                    VALUE 08.
  5669             88  SKIP-JUNE-JULY               VALUE 09.
  5670             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5671             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5672         16  CR-RESIDENT-STATE             PIC XX.
  5673         16  CR-RATE-CODE.
  5674             20  CR-LF-CLASS-CD            PIC XX.
  5675             20  CR-AH-CLASS-CD            PIC XX.
  5676         16  CR-MORT.
  5677             20  CR-TAB                    PIC X.
  5678             20  CR-INT                    PIC 99.
  5679             20  CR-GRP                    PIC X.
  5680         16  CR-MEMBER-NO                  PIC X(12).
  5681         16  CR-OLD-LOF                    PIC XXX.
  5682*        16  CR-LOAN-OFFICER               PIC XXX.
  5683         16  CR-REIN-TABLE                 PIC XXX.
  5684         16  CR-REIN-SPEC                  PIC X.
  5685         16  CR-LOAN-1ST-PMT-DT.
  5686             20  CR-1ST-PMT-YR             PIC 99.
  5687             20  CR-1ST-PMT-MO             PIC 99.
  5688             20  CR-1ST-PMT-DA             PIC 99.
  5689         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5690         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5691         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5692         16  CR-LAST-ADD-ON-DT             PIC XX.
  5693
  5694         16  CR-UNDERWRITING-CODE          PIC X.
  5695             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5696
  5697         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5698         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5699         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5700         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5701
  5702     12  CR-STATUS-INFORMATION.
  5703         16  CR-ENTRY-STATUS               PIC X.
  5704             88  CR-NORMAL-ENTRY              VALUE '1'.
  5705             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5706             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5707             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5708             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5709             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5710             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5711             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5712             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5713             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5714                                                    '5' '9' 'P'.
  5715         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5716
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5717         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5718         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5719         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5720
  5721         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5722         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5723
  5724         16  CR-LF-CURRENT-STATUS          PIC X.
  5725             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5726             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5727             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5728             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5729             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5730             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5731             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5732             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5733             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5734             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5735             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5736             88  CR-LF-IS-VOID                VALUE 'V'.
  5737             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5738                                                    '4' '5' '9'.
  5739
  5740         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5741
  5742         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5743         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5744
  5745         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5746         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5747
  5748         16  CR-AH-CURRENT-STATUS          PIC X.
  5749             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5750             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5751             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5752             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5753             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5754             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5755             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5756             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5757             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5758             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5759             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5760             88  CR-AH-IS-VOID                VALUE 'V'.
  5761             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5762                                                    '4' '5' '9'.
  5763         16  CR-LOAN-OFFICER               PIC X(5).
  5764         16  CR-CANCEL-REASON              PIC X.
  5765         16  cr-xycor-lf-cov-code          pic x(4).
  5766         16  cr-xycor-ah-cov-code          pic x(4).
  5767         16  FILLER                        PIC X(6).
  5768
  5769     12  CR-DEATH-CLAIM-DATA.
  5770         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5771
  5772         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5773         16  CR-DTH-RPT-DT.
  5774             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5775             20  CR-DTH-RPT-MO             PIC 99.
  5776             20  CR-DTH-RPT-DA             PIC 99.
  5777         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5778
  5779         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5780         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5781         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5782         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5783         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5784
  5785         16  CR-DTH-AGE                    PIC 99.
  5786         16  CR-DTH-PAY-CD                 PIC X.
  5787         16  CR-DEATH-CAUSE                PIC X(6).
  5788
  5789         16  FILLER                        PIC X(16).
  5790
  5791     12  CR-DISAB-CLAIM-DATA.
  5792         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5793
  5794         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5795         16  CR-DIS-RPT-DT.
  5796             20  CR-DIS-RPT-YR             PIC 99.
  5797             20  CR-DIS-RPT-MO             PIC 99.
  5798             20  CR-DIS-RPT-DA             PIC 99.
  5799         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5800         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5801
  5802         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5803         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5804         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5805         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5806         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5807
  5808         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5809         16  CR-DIS-PAY-CD                 PIC X.
  5810         16  FILLER                        PIC XX.
  5811
  5812         16  CR-DISAB-INCURRED-DETAIL.
  5813             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5814**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5815                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5816                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5817                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5818
  5819         16  CR-DISAB-CAUSE                PIC X(6).
  5820         16  FILLER                        PIC X(14).
  5821
  5822     12  CR-REMIT-TO                       PIC 99.
  5823
  5824     12  CR-COMPENSATION-LEVELS.
  5825         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5826             20  CR-COM-AGT.
  5827                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5828                 24  CR-COM-AGT-PRIME      PIC X(6).
  5829             20  CR-AGT-TYPE               PIC X.
  5830             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5831             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5832
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5833     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5834     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5835     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5836     12  CR-CLP-STATE                      PIC XX.
  5837     12  CR-POST-CARD-IND                  PIC X.
  5838     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5839     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5840     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5841     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5842     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5843     12  FILLER                            PIC X(07).
  5844
  5845     12  CR-CSR-CODE                       PIC XXX.
  5846
  5847     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5848     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5849
  5850     12  CR-MICROFILM-NUMBERS.
  5851*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5852         16  FILLER                        PIC X(5).
  5853     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5854
  5855     12  CR-USER-CODE                      PIC X.
  5856     12  CR-USER-FUTURE                    PIC X(9).
  5857
  5858     12  CR-BENEFICIARY.
  5859         16  CR-BANK-NO                    PIC X(10).
  5860         16  FILLER                        PIC X(15).
  5861
  5862     12  CR-ENTRY-BATCH                    PIC X(6).
  5863     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5864     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5865
  5866     12  CR-NOTE-SW                        PIC X.
  5867
  5868     12  CR-ORIGIN-INDICATOR               PIC X.
  5869         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5870         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5871
  5872     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5873     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5874     12  FILLER                            PIC X(33).
  5875
  5876******************************************************************
* 5877                             COPY ELCCRTVR.
  5878***************************************************************** 04/24/98
  5879*                                                                *ELCCRTVR
  5880*                                                                *ELCCRTVR
  5881*                            ELCCRTVR                            *   LV003
  5882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5883*                            VMOD=2.001                          *ELCCRTVR
  5884*                                                                *ELCCRTVR
  5885*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5886*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5887*                                                                *ELCCRTVR
  5888******************************************************************ELCCRTVR
  5889                                                                  ELCCRTVR
  5890 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5891     05  WS-CR-DT.                                                ELCCRTVR
  5892         10  FILLER                PIC 999.                       ELCCRTVR
  5893         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5894         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5895             15  CR-CC             PIC 99.                        ELCCRTVR
  5896             15  CR-YR             PIC 99.                        ELCCRTVR
  5897         10  CR-MO                 PIC 99.                        ELCCRTVR
  5898         10  CR-DA                 PIC 99.                        ELCCRTVR
  5899     05  WS-CR-DT-N REDEFINES                                        CL**2
  5900            WS-CR-DT               PIC 9(11).                        CL**2
  5901     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5902         10  FILLER                    PIC 999.                   ELCCRTVR
  5903         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5904         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5905             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5906             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5907         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5908         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5909     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5910            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5911     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5912         10  FILLER                    PIC 999.                   ELCCRTVR
  5913         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5914         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5915             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5916             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5917         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5918         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5919     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5920            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5921     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5922         10  FILLER                    PIC 999.                   ELCCRTVR
  5923         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5924         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5925             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5926             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5927         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5928         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5929     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5930            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5931     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5932         10  FILLER                    PIC 999.                   ELCCRTVR
  5933         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5934         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5935             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5936             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5937         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5938         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5939     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5940            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5941     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5942         10  FILLER                    PIC 999.                   ELCCRTVR
  5943         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5944         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5945             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5946             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5947         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5948         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5949     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5950            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5951     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5952         10  FILLER                    PIC 999.                   ELCCRTVR
  5953         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5954         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5955             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5956             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5957         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5958         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5959     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5960            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5961     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5962         10  FILLER                    PIC 999.                   ELCCRTVR
  5963         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5964         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5965             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5966             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5967         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5968         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5969     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5970            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5971     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5972         10  FILLER                    PIC 999.                   ELCCRTVR
  5973         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5974         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5975             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5976             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5977         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5978         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5979     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5980            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5981     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5982         10  FILLER                    PIC 999.                   ELCCRTVR
  5983         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5984         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5985             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5986             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5987         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5988         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5989     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5990          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5991     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5992         10  FILLER                    PIC 999.                   ELCCRTVR
  5993         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5994         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5995             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5996             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5997         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5998         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5999     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6000            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6001     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6002         10  FILLER                    PIC 999.                   ELCCRTVR
  6003         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6004         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6005             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6006             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6007         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6008         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6009     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6010            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6011     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6012         10  FILLER                    PIC 999.                   ELCCRTVR
  6013         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6014         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6015             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6016             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6017         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6018         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6019     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6020            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6021     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6022         10  FILLER                    PIC 999.                   ELCCRTVR
  6023         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6024         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6025             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6026             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6027         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6028         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6029     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6030            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6031     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6032         10  FILLER                    PIC 999.                   ELCCRTVR
  6033         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6034         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6035             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6036             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6037         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6038         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6039     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6040            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6041     05  COPY-NDX                      PIC 9.                        CL**6
  6042     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6043         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6044             15  FILLER                PIC 999.                   ELCCRTVR
  6045             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6046             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6047                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6048                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6049             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6050             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6051         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6052                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6053
  6054 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 119
* ECS010.cbl
* 6056                             COPY ELCDATE.
  6057******************************************************************06/11/98
  6058*                                                                *ELCDATE
  6059*                                                                *ELCDATE
  6060*                            ELCDATE.                            *   LV023
  6061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6062*                            VMOD=2.003                           ELCDATE
  6063*                                                                *ELCDATE
  6064*                                                                *ELCDATE
  6065*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6066*                 LENGTH = 200                                   *   CL*19
  6067******************************************************************ELCDATE
  6068                                                                  ELCDATE
  6069 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6070     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6071     12  DC-OPTION-CODE                PIC X.                        CL*15
  6072         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6073         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6074         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6075         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6076         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6077         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6078         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6079         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6080         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6081         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6082         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6083         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6084         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6085         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6086         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6087         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6088         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6089         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6090         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6091         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6092         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6093         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6094         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6095         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6096         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6097         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6098         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6099         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6100         88  THREE-CHARACTER-BIN                                  ELCDATE
  6101                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6102         88  GREGORIAN-TO-BIN                                        CL**2
  6103                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6104         88  BIN-TO-GREGORIAN                                        CL**2
  6105                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6106         88  JULIAN-TO-BINARY                                        CL**2
  6107                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6108     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6109         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6110         88  DATE-CONVERSION-ERROR                                ELCDATE
  6111                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6112         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6113         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 120
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6114         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6115         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6116         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6117         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6118         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6119         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6120         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6121         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6122     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6123         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6124     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6125         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6126         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6127         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6128     12  FILLER                        PIC X.                        CL*15
  6129     12  DC-CONVERSION-DATES.                                        CL*15
  6130         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6131         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6132         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6133         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6134                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6135             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6136             20  SLASH1-1              PIC X.                        CL*15
  6137             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6138             20  SLASH1-2              PIC X.                        CL*15
  6139             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6140         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6141         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6142                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6143             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6144             20  SLASH2-1              PIC X.                        CL*15
  6145             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6146             20  SLASH2-2              PIC X.                        CL*15
  6147             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6148         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6149         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6150                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6151             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6152             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6153             20  DC-YMD-DAY            PIC 99.                       CL*15
  6154         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6155         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6156                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6157             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6158             20  DC-MDY-DAY            PIC 99.                       CL*15
  6159             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6160         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6161             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6162             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6163             20  FILLER                PIC XX.                       CL*15
  6164             20  DC-ALPHA-CENTURY.                                   CL*15
  6165                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6166             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6167         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6168         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6169         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6170         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6171         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6172                                       PIC 9(05).                    CL*20
  6173         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6174             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6175             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6176         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6177         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6178         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6179     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6180         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6181         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6182             20  FILLER                PIC 9(3).                     CL*15
  6183             20  HOLD-CEN-1-CCYY.                                    CL*15
  6184                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6185                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6186             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6187             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6188         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6189             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6190             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6191             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6192                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6193                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6194             20  FILLER                PIC 9(3).                     CL*15
  6195         16  HOLD-CENTURY-1-X.                                       CL*15
  6196             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6197             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6198                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6199                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6200             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6201             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6202         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6203             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6204             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6205             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6206                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6207                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6208             20  FILLER                PIC XXX.                      CL*23
  6209         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6210         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6211         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6212         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6213             20  DC-JULIAN-1-CCYY.                                   CL*15
  6214                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6215                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6216             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6217         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6218         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6219             20  DC-JULIAN-2-CCYY.                                   CL*15
  6220                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6221                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6222             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6223         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6224             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6225             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6226             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6227             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6228             20  DC-EDITA-CCYY.                                      CL*15
  6229                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6230                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6231         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6232             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6233             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6234             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6235             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6236             20  DC-EDITB-CCYY.                                      CL*15
  6237                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6238                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6239         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6240         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6241                              DC-GREG-DATE-CYMD.                  ELCDATE
  6242             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6243             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6244             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6245             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6246         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6247         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6248                              DC-GREG-DATE-MDCY.                  ELCDATE
  6249             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6250             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6251             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6252             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6253    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6254        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6255    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6256    12  FILLER                         PIC X(28).                    CL*26
* 6257                             COPY ELCFUNDT.
  6258***************************************************************** 12/03/98
  6259*                                                               * ELCFUNDT
  6260*                            ELCFUNDT.                          *    LV004
  6261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6262*                            VMOD=2.001                         * ELCFUNDT
  6263*                                                               * ELCFUNDT
  6264*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6265*                                                               * ELCFUNDT
  6266***************************************************************** ELCFUNDT
  6267                                                                  ELCFUNDT
  6268                                                                  ELCFUNDT
  6269 01  FUNCTION-DATE.                                                  CL**2
  6270     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6271     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6272         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6273         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6274             15  WS-FN-CC          PIC 99.                           CL**3
  6275             15  WS-FN-YR          PIC 99.                           CL**3
  6276         10  WS-FN-MO              PIC 99.                           CL**3
  6277         10  WS-FN-DA              PIC 99.                           CL**3
  6278     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6279     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6280     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6281     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6282     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6283         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6284         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6285         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6286     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6287     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 123
* ECS010.cbl
  6288
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 124
* ECS010.cbl
  6290 01  CPA-STARTS-HERE             PIC X(48)
  6291       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6292                             COPY ELCCALC.
  6293******************************************************************04/15/98
  6294*                                                                *ELCCALC
  6295*                           ELCCALC.                            *    LV003
  6296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6297*                            VMOD=2.025                          *   CL**3
  6298*                                                                *   CL**2
  6299*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6300*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6301*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6302*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6303*                                                                *   CL**2
  6304*  PASSED TO ELRTRM                                              *   CL**2
  6305*  -----------------                                             *   CL**2
  6306*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6307*  ORIGINAL TERM                                                 *   CL**2
  6308*  BEGINNING DATE                                                *   CL**2
  6309*  ENDING DATE                                                   *   CL**2
  6310*  COMPANY I.D.                                                  *   CL**2
  6311*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6312*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6313*  FREE LOOK DAYS                                                *   CL**2
  6314*                                                                *   CL**2
  6315*  RETURNED FROM ELRTRM                                          *   CL**2
  6316*  ---------------------                                         *   CL**2
  6317*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6318*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6319*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6320*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6321*----------------------------------------------------------------*   CL**2
  6322*  PASSED TO ELRAMT                                              *   CL**2
  6323*  ----------------                                              *   CL**2
  6324*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6325*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6326*  ORIGINAL AMOUNT                                               *   CL**2
  6327*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6328*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6329*  METHOD                                                            CL**2
  6330*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6331*  COMPANY I.D.                                                  *   CL**2
  6332*  BENEFIT TYPE                                                  *   CL**2
  6333*                                                                *   CL**2
  6334*  RETURNED FROM ELRAMT                                          *   CL**2
  6335*  --------------------                                          *   CL**2
  6336*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6337*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6338*  REMAINING AMOUNT FACTOR                                           CL**2
  6339*----------------------------------------------------------------*   CL**2
  6340*  PASSED TO ELRESV                                              *   CL**2
  6341*  -----------------                                             *   CL**2
  6342*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6343*  VALUATION DATE                                                *   CL**2
  6344*  PAID THRU DATE                                                *   CL**2
  6345*  BENEFIT                                                       *   CL**2
  6346*  INCURRED DATE                                                 *   CL**2
  6347*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 125
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6348*  ISSUE AGE                                                     *   CL**2
  6349*  TERM                                                          *   CL**2
  6350*  CDT PERCENT                                                   *   CL**2
  6351*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6352* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6353* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6354* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6355*                                                                *   CL**2
  6356*  RETURNED FROM ELRESV                                          *   CL**2
  6357*  --------------------                                          *   CL**2
  6358*  CDT TABLE USED                                                *   CL**2
  6359*  CDT FACTOR USED                                               *   CL**2
  6360*  PAY TO CURRENT RESERVE                                        *   CL**2
  6361*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6362*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6363*----------------------------------------------------------------*   CL**2
  6364*  PASSED TO ELRATE                                              *   CL**2
  6365*  ----------------                                              *   CL**2
  6366*  CERT ISSUE DATE                                               *   CL**2
  6367*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6368*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6369*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6370*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6371*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6372*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6373*  DEVIATION CODE                                                *   CL**2
  6374*  ISSUE AGE                                                     *   CL**2
  6375*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6376*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6377*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6378*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6379*  A.P.R.                                                        *   CL**2
  6380*  METHOD                                                            CL**2
  6381*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6382*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6383*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6384*  BENEFIT CODE                                                  *   CL**2
  6385*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6386*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6387*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6388*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6389*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6390*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6391*                                                                *   CL**2
  6392*  RETURNED FROM ELRATE                                          *   CL**2
  6393*  --------------------                                          *   CL**2
  6394*  CALCULATED PREMIUM                                            *   CL**2
  6395*  PREMIUM RATE                                                  *   CL**2
  6396*  MORTALITY CODE                                                *   CL**2
  6397*  MAX ATTAINED AGE                                              *   CL**2
  6398*  MAX AGE                                                       *   CL**2
  6399*  MAX TERM                                                      *   CL**2
  6400*  MAX MONTHLY BENEFIT                                           *   CL**2
  6401*  MAX TOTAL BENIFIT                                             *   CL**2
  6402*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6403*----------------------------------------------------------------*   CL**2
  6404*  PASSED TO ELRFND                                              *   CL**2
  6405*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6406*  CERT ISSUE DATE                                               *   CL**2
  6407*  REFUND DATE                                                   *   CL**2
  6408*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6409*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6410*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6411*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6412*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6413*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6414*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6415*  DEVIATION CODE                                                *   CL**2
  6416*  ISSUE AGE                                                     *   CL**2
  6417*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6418*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6419*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6420*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6421*  A.P.R.                                                        *   CL**2
  6422*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6423*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6424*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6425*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6426*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6427*  BENEFIT CODE                                                  *   CL**2
  6428*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6429*                                                                *   CL**2
  6430*  RETURNED FROM ELRFND                                          *   CL**2
  6431*  --------------------                                          *   CL**2
  6432*  CALCULATED REFUND                                             *   CL**2
  6433*----------------------------------------------------------------*   CL**2
  6434*  PASSED TO ELEARN                                              *   CL**2
  6435*  ----------------                                              *   CL**2
  6436*  CERT ISSUE DATE                                               *   CL**2
  6437*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6438*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6439*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6440*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6441*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6442*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6443*  DEVIATION CODE                                                *   CL**2
  6444*  ISSUE AGE                                                     *   CL**2
  6445*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6446*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6447*  A.P.R.                                                        *   CL**2
  6448*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6449*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6450*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6451*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6452*  BENEFIT CODE                                                  *   CL**2
  6453*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6454*                                                                *   CL**2
  6455*  RETURNED FROM ELEARN                                          *   CL**2
  6456*  --------------------                                          *   CL**2
  6457*  INDICATED  EARNINGS                                           *   CL**2
  6458*----------------------------------------------------------------*   CL**2
  6459*                 LENGTH = 450                                   *   CL**2
  6460*                                                                *   CL**2
  6461******************************************************************   CL**2
  6462******************************************************************
  6463*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6464*
  6465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6466*-----------------------------------------------------------------
  6467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6468* EFFECTIVE    NUMBER
  6469*-----------------------------------------------------------------
  6470* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6471* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6472* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6473* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6474* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6475* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6476* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6477* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6478* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6479******************************************************************
  6480                                                                     CL**2
  6481 01  CALCULATION-PASS-AREA.                                          CL**2
  6482     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6483                                     COMP.                           CL**2
  6484                                                                     CL**2
  6485     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6486       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6487       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6488                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6489       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6490       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6491       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6492       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6493       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6494       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6495       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6496       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6497       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6498       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6499       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6500       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6501       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6502       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6503       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6504       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6505       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6506                                                                     CL**2
  6507     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6508       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6509***********************  INPUT AREAS ****************************    CL**2
  6510                                                                     CL**2
  6511     12  CP-CALCULATION-AREA.                                        CL**2
  6512         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6513         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6514         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6515         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6516         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6517           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6518                                                   'I' 'U'.          CL**2
  6519           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6520           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6521         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6522         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6523         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6524         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6525         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6526                                     COMP-3.                         CL**2
  6527         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6528                                     COMP-3.                         CL**2
  6529         16  CP-CDT-METHOD         PIC X.                            CL**2
  6530           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6531           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6532           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6533         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6534           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6535           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6536         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6537                                     COMP-3.                         CL**2
  6538         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6539                                     COMP-3.                         CL**2
  6540         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6541                                     COMP-3.                         CL**2
  6542         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6543                                     COMP-3.                         CL**2
  6544         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6545                                     COMP-3.                         CL**2
  6546         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6547                                     COMP-3.                         CL**2
  6548         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6549                                     COMP-3.                         CL**2
  6550         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6551           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6552           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6553           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6554           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6555           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6556           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6557           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6558         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6559           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6560           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6561           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6562           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6563           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6564           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6565           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6566           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6567           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6568           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6569           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6570           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6571           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6572           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6573         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6574           88  CP-CLAIM                            VALUE '1'.        CL**2
  6575           88  CP-CANCEL                           VALUE '2'.        CL**2
  6576           88  CP-ISSUE                            VALUE '3'.        CL**2
  6577         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6578           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6579           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6580           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6581           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6582           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6583           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6584           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6585           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6586           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6587           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6588           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6589           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6590           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6591           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6592           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6593           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6594           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6595           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6596                                                     'W' 'X'.        CL**2
  6597           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6598           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6599           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6600           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6601           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6602           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6603           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6604           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6605           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6606           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6607           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6608           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6609           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6610                                                                     CL**2
  6611         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6612                                     COMP-3.                         CL**2
  6613         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6614         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6615         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6616         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6617         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6618           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6619               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6620         16  CP-R78-OPTION         PIC X.                            CL**2
  6621           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6622           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6623                                                                     CL**2
  6624         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6625         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6626         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6627         16  CP-RATE-FILE          PIC X.                            CL**2
  6628         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6629                                     COMP-3.                         CL**2
  6630                                                                     CL**2
  6631         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6632         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6633                                                                     CL**2
  6634         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6635                                     COMP-3.
  6636         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6637                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6638         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6639                                     COMP-3.                         CL**2
  6640         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6641                                     COMP-3.                         CL**2
  6642         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6643                                     COMP-3.
  6644         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6645                                  PIC S9(7)V99 COMP-3.
  6646                                                                     CL**2
  6647         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6648         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6649         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6650           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6651           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6652           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6653           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6654         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6655         16  CP-CARRIER            PIC X.                            CL**2
  6656         16  CP-REIN-FLAG          PIC X.                            CL**2
  6657         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6658           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6659                      '2' '3' '4' '5'.                               CL**2
  6660           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6661           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6662           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6663           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6664           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6665           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6666           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6667           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6668         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6669         16  CP-RATING-METHOD      PIC X.                            CL**2
  6670           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6671           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6672           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6673           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6674           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6675           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6676           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6677           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6678           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6679         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6680                                     COMP-3.                         CL**2
  6681         16  CP-BEN-CATEGORY       PIC X.
  6682         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6683         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6684                                   PIC S99V9(5) COMP-3.
  6685         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6686         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6687                                   PIC S99V9(5) COMP-3.
  6688         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6689         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6690         16  CP-EXPIRE-DT          PIC XX.
  6691         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6692         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6693         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6694         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6695         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6696             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6697             88  CP-CALC-CLP              VALUE 'C'.
  6698         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6699         16  CP-CANCEL-REASON      PIC X.
  6700         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6701         16  CP-PMT-MODE           PIC X.
  6702         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6703         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6704         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6705         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6706         16  FILLER                PIC X.
  6707                                                                     CL**2
  6708***************    OUTPUT FROM ELRESV   ************************     CL**2
  6709                                                                     CL**2
  6710         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6711                                                                     CL**2
  6712         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6713                                     COMP-3.                         CL**2
  6714         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6715                                     COMP-3.                         CL**2
  6716         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6717                                     COMP-3.                         CL**2
  6718         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6719                                     COMP-3.                         CL**2
  6720         16  FILLER                PIC X(09).                        CL**2
  6721***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6722                                                                     CL**2
  6723         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6724                                     COMP-3.                         CL**2
  6725         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6726                                     COMP-3.                         CL**2
  6727         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6728                                     COMP-3.                         CL**2
  6729         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6730                                     COMP-3.                         CL**2
  6731         16  FILLER                PIC X(12).                        CL**2
  6732                                                                     CL**2
  6733***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6734                                                                     CL**2
  6735         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6736                                     COMP-3.                         CL**2
  6737         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6738                                     COMP-3.                         CL**2
  6739         16  FILLER                PIC X(12).                        CL**2
  6740                                                                     CL**2
  6741***************    OUTPUT FROM ELRATE   *************************    CL**2
  6742                                                                     CL**2
  6743         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6744                                     COMP-3.                         CL**2
  6745         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6746                                     COMP-3.                         CL**2
  6747         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6748         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6749             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6750         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6751                                     COMP-3.                         CL**2
  6752         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6753         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6754         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6755                                   PIC S9(7)V99 COMP-3.
  6756         16  FILLER                PIC X(07).                        CL**2
  6757                                                                     CL**2
  6758***************    OUTPUT FROM ELRFND   *************************    CL**2
  6759                                                                     CL**2
  6760         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6761                                     COMP-3.                         CL**2
  6762         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6763           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6764           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6765           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6766           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6767           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6768           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6769           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6770           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6771           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6772           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6773           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6774           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6775           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6776           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6777         16  FILLER                PIC X(12).                        CL**2
  6778                                                                     CL**2
  6779***************    OUTPUT FROM ELEARN   *************************    CL**2
  6780                                                                     CL**2
  6781         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6782                                     COMP-3.                         CL**2
  6783         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6784                                     COMP-3.                         CL**2
  6785         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6786                                     COMP-3.                         CL**2
  6787         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6788                                     COMP-3.                         CL**2
  6789         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6790                                     COMP-3.                         CL**2
  6791         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6792                                     COMP-3.                         CL**2
  6793         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6794           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6795           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6796           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6797           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6798           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6799           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6800           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6801           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6802           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6803         16  FILLER                PIC X(12).                        CL**2
  6804                                                                     CL**2
  6805***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6806                                                                     CL**2
  6807         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6808                                     COMP-3.                         CL**2
  6809         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6810                                     COMP-3.                         CL**2
  6811         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6812                                                                     CL**2
  6813***************   MISC WORK AREAS    *****************************   CL**2
  6814         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6815                                     COMP-3.                         CL**2
  6816         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6817                                     COMP-3.                         CL**2
  6818         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6819                                     COMP-3.                         CL**2
  6820         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6821                                     COMP-3.                         CL**2
  6822         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6823                                     COMP-3.                         CL**2
  6824         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6825                                     COMP-3.                         CL**2
  6826         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6827             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6828             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6829             88  IO-ERROR                         VALUE 'E'.         CL**2
  6830                                                                     CL**2
  6831         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6832                                                                     CL**2
  6833         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6834                                                                     CL**2
  6835         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6836                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6837                                     COMP-3.                         CL**2
  6838                                                                     CL**2
  6839         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6840                                                                     CL**2
  6841         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6842                                     COMP-3.                         CL**2
  6843                                                                     CL**2
  6844         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6845                                     COMP-3.                         CL**2
  6846                                                                     CL**2
  6847         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6848                                     COMP-3.                         CL**2
  6849                                                                     CL**2
  6850         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6851                                     COMP-3.                         CL**2
  6852                                                                     CL**2
  6853         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6854                                     COMP-3.                         CL**2
  6855                                                                     CL**2
  6856         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6857                                     COMP-3.                         CL**2
  6858                                                                     CL**2
  6859         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6860                                     COMP-3.                         CL**2
  6861                                                                     CL**2
  6862         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6863             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6864                                                                     CL**2
  6865         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6866                                     COMP-3.                         CL**2
  6867         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6868                                     COMP-3.
  6869         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 134
* ECS010.cbl
  6870         16  FILLER                PIC X(15).                        CL**2
  6871******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 135
* ECS010.cbl
* 6873                             COPY ELCDTECX.
  6874******************************************************************06/05/98
  6875*                                                                *ELCDTECX
  6876*                            ELCDTECX.                           *   LV005
  6877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6878*                            VMOD=2.015                          *ELCDTECX
  6879*                                                                *ELCDTECX
  6880*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6881*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6882*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6883*                                                                *ELCDTECX
  6884******************************************************************ELCDTECX
  6885******************************************************************
  6886*                   C H A N G E   L O G
  6887*
  6888* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6889*-----------------------------------------------------------------
  6890*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6891* EFFECTIVE    NUMBER
  6892*-----------------------------------------------------------------
  6893* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6894*                                  BENEFIT CODES FROM 300 TO 900
  6895* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6896* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6897******************************************************************
  6898 01  DATE-CARD.                                                   ELCDTECX
  6899     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6900     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6901     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6902     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6903     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6904     12  EP-SW                       PIC  X.                      ELCDTECX
  6905         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6906     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6907         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6908     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6909     12  RUN-CENTURY.                                             ELCDTECX
  6910         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6911     12  FILLER                      PIC  X.                         CL**4
  6912     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6913     12  FILLER                      PIC  XXX.                    ELCDTECX
  6914     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6915                                                                  ELCDTECX
  6916 01  FILLER                          PIC  X(7)                       CL**6
  6917                                          VALUE 'OPTIONS'.        ELCDTECX
  6918 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6919     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6920     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6921     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6922         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6923         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6924     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6925     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6926     12  FILLER                      PIC  X.                      ELCDTECX
  6927     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6928     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6929     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6930     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 136
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6931     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6932     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6933     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6934     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6935     12  FILLER                      PIC  X.                      ELCDTECX
  6936     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6937     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6938     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6939     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6940     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6941     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6942     12  FILLER                      PIC  X.                      ELCDTECX
  6943     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6944     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6945     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6946     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6947     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6948     12  DTE-R78                     PIC  X.                      ELCDTECX
  6949     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6950     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6951     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6952     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6953     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6954     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6955     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6956                                     PIC  X.                      ELCDTECX
  6957         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6958                                                 ' '.             ELCDTECX
  6959         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6960         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6961     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6962         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6963         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6964     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6965     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6966                                     PIC  9.                         CL**4
  6967     12  DTE-SYSTEM.                                              ELCDTECX
  6968         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6969         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6970         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6971         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6972         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6973         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6974         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6975         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6976         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6977         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6978         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6979         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6980         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6981         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6982         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6983         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6984         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6985         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6986         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6987         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  6988         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6989         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6990         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6991         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6992         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6993         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6994     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6995         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6996                                     PIC  X.                      ELCDTECX
  6997     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6998                                                                  ELCDTECX
  6999 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7000     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7001     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7002     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7003*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7004     12  FILLER                      PIC  X.                      ELCDTECX
  7005     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7006     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7007     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7008     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7009     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7010     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7011     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7012                                                                  ELCDTECX
  7013     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7014     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7015     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7016     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7017                                                                  ELCDTECX
  7018     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7019     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7020     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7021     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7022                                                                  ELCDTECX
  7023     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7024     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7025                                                                  ELCDTECX
  7026     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7027     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7028                                                                  ELCDTECX
  7029     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7030                                                                  ELCDTECX
  7031 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7032     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7033     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7034     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7035     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7036     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7037     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7038     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7039                                                                  ELCDTECX
  7040 01  FILLER                          PIC  X(12)                   ELCDTECX
  7041                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7042 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7043     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7044         16  CNT-ID                  PIC  X.                      ELCDTECX
  7045         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7046                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7047 01  FILLER                          PIC  X(11)                   ELCDTECX
  7048                                          VALUE 'STATE NAMES'.    ELCDTECX
  7049 01  STATE-NAMES.                                                 ELCDTECX
  7050     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7051         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7052         16  STATE-PIC1.                                          ELCDTECX
  7053             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7054             20  FILLER              PIC  XXX.                    ELCDTECX
  7055             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7056             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7057             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7058             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7059                                                                  ELCDTECX
  7060 01  FILLER                          PIC  X(13)                   ELCDTECX
  7061                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7062 01  CARRIER-NAMES.                                               ELCDTECX
  7063     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7064         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7065         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7066         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7067         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7068         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7069         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7070*        16  FILLER                  PIC  X.                      ELCDTECX
  7071         16  CARRIER-SEC-PAY         PIC  X.
  7072             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7073                                                                  ELCDTECX
  7074 01  FILLER                          PIC  X(9)                       CL**6
  7075                                          VALUE 'INS TYPES'.      ELCDTECX
  7076 01  CLAS-INS-TYPES.                                              ELCDTECX
  7077*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7078     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7079         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7080         16  CLAS-I-AB3.                                          ELCDTECX
  7081             20  FILLER              PIC  X.                      ELCDTECX
  7082             20  CLAS-I-AB2.                                      ELCDTECX
  7083                 24  FILLER          PIC  X.                      ELCDTECX
  7084                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7085         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7086             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7087             20  FILLER              PIC  X.                         CL**4
  7088         16  CLAS-I-AB10.                                         ELCDTECX
  7089             20  FILLER              PIC  X(9).                   ELCDTECX
  7090             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7091         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7092         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7093         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7094         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7095             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7096         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7097         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7098         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7099         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7100         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7101         16  FILLER                  PIC  X(05).
  7102                                                                  ELCDTECX
  7103 01  FILLER                          PIC  X(16)                   ELCDTECX
  7104                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7105 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7106     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7107                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7108         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7109         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7110         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7111         16  CLAS-MORT-DESC.                                      ELCDTECX
  7112             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7113             20  FILLER              PIC  XX.                        CL**5
  7114             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7115             20  FILLER              PIC  X.                         CL**5
  7116             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7117             20  FILLER              PIC  X.                         CL**5
  7118             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7119             20  FILLER              PIC  X.                         CL**5
  7120             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7121             20  FILLER              PIC  X(5).                      CL**6
  7122                                                                  ELCDTECX
  7123 01  FILLER                          PIC  X(15)                   ELCDTECX
  7124                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7125 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7126     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7127         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7128         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7129         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7130         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7131         16  FILLER                  PIC  X(4).                      CL**6
  7132                                                                  ELCDTECX
  7133 01  FILLER                          PIC  X(7)                       CL**6
  7134                                     VALUE 'INDEXES'.             ELCDTECX
  7135 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7136     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7137     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7138     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7139     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7140     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7141     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7142     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7143     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7144     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7145     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7146     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7147     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7148     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7149     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7150     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7151     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7152     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7153                                                                  ELCDTECX
  7154 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7155     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7156     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7157     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7158     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7159     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7160     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7161     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7162     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7163     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7164     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7165     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7166                                                                  ELCDTECX
  7167 01  FILLER                          PIC  X(13)                   ELCDTECX
  7168                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7169 01  CLAS-MISC.                                                   ELCDTECX
  7170     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7171         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7172         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7173         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7174     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7175     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7176     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7177     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7178     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7179     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7180     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7181     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7182     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7183     12  STATE-L                     PIC  XX.                     ELCDTECX
  7184     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7185     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7186     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7187         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7188         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7189     12  DTE-ABEND-WORK.                                          ELCDTECX
  7190         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7191         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7192                                                                  ELCDTECX
  7193 01  FILLER                          PIC  X(12)                   ELCDTECX
  7194                                     VALUE 'WORKING DATE'.        ELCDTECX
  7195 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7196     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7197         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7198         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7199         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7200     12  WS-CURRENT-DATE.                                         ELCDTECX
  7201         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7202         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7203         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7204         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7205         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7206     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7207         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7208         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7209                                                                  ELCDTECX
  7210 01  FILLER                          PIC  X(12)                   ELCDTECX
  7211                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7212 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7213     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7214         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7215         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7216         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7217                                                                  ELCDTECX
  7218 01  FILLER                          PIC  X(10)                   ELCDTECX
  7219                                     VALUE 'STATE TLRS'.          ELCDTECX
  7220 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7221     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7222         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7223         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7224                                                                  ELCDTECX
  7225 01  FILLER                          PIC  X(13)                   ELCDTECX
  7226                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7227 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7228     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7229         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7230                                                                  ELCDTECX
  7231 01  FILLER                          PIC  X(13)                   ELCDTECX
  7232                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7233 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7234     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7235     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7236     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7237                                     PIC  X.                         CL**5
  7238     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7239     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7240     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7241     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7242     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7243     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7244     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7245     12  FILLER                      PIC  X(75).                  ELCDTECX
  7246******************************************************************ELCDTECX
  7247*01  MISC-CARR-PCT-DATA.                                          00001521
  7248*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7249*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7250*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7251*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7252*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7253*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7254******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 142
* ECS010.cbl
* 7256                             COPY ELCDTEVR.
  7257***************************************************************** 04/15/98
  7258*                                                                *ELCDTEVR
  7259*                                                                *ELCDTEVR
  7260*                            ELCDTEVR.                           *   LV003
  7261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7262*                            VMOD=2.001                          *   CL**2
  7263*                                                                *ELCDTEVR
  7264*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7265*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7266*                                                                *ELCDTEVR
  7267******************************************************************ELCDTEVR
  7268 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7269     05  WS-RUN-DATE.                                             ELCDTEVR
  7270         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7271         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7272         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7273             15  RUN-CC              PIC  99.                     ELCDTEVR
  7274             15  RUN-YR              PIC  99.                     ELCDTEVR
  7275         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7276         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7277     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7278            WS-RUN-DATE              PIC 9(11).                      CL**2
  7279     05  WS-EP-DT.                                                ELCDTEVR
  7280         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7281         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7282         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7283             15  EP-CC               PIC  99.                     ELCDTEVR
  7284             15  EP-YR               PIC  99.                     ELCDTEVR
  7285         10  EP-MO                   PIC  99.                     ELCDTEVR
  7286         10  EP-DA                   PIC  99.                     ELCDTEVR
  7287     05  WS-EP-DT-N REDEFINES                                        CL**2
  7288            WS-EP-DT                 PIC 9(11).                      CL**2
  7289     05  WS-DTE-CONV-DT.                                             CL**4
  7290         10  FILLER                  PIC  9(03).                     CL**4
  7291         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7292         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7293             15  DTE-CONV-CC         PIC  99.                        CL**4
  7294             15  DTE-CONV-YR         PIC  99.                        CL**4
  7295         10  DTE-CONV-MO             PIC  99.                        CL**4
  7296         10  DTE-CONV-DA             PIC  99.                        CL**4
  7297     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7298            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7299 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7300     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7301         10  FILLER                            PIC 999.           ELCDTEVR
  7302         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7303         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7304             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7305             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7306         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7307         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7308     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7309            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7310     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7311         10  FILLER                            PIC 999.           ELCDTEVR
  7312         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7313         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 143
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7314         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7315         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7316     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7317            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7318 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7319     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7320         10  FILLER                            PIC 999.           ELCDTEVR
  7321         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7322         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7323             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7324             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7325         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7326         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7327     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7328            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7329     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7330         10  FILLER                            PIC 999.           ELCDTEVR
  7331         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7332         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7333             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7334             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7335         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7336         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7337     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7338            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7339     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7340         10  FILLER                            PIC 999.           ELCDTEVR
  7341         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7342         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7343             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7344             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7345         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7346         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7347     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7348            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7349 01  WS-RATE-RECORD.                                              ELCDTEVR
  7350         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7351             10  FILLER                        PIC 999.           ELCDTEVR
  7352             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7353             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7354                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7355                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7356             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7357             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7358         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7359                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 144
* ECS010.cbl
* 7361                             COPY ELCACCTV.
  7362******************************************************************04/14/98
  7363*                                                                *ELCACCTV
  7364*                            ELCACCTV                            *   LV002
  7365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7366*                            VMOD=2.001                          *ELCACCTV
  7367*                                                                *ELCACCTV
  7368*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7369*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7370*                                                                *ELCACCTV
  7371*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7372*                                                                *ELCACCTV
  7373******************************************************************ELCACCTV
  7374                                                                  ELCACCTV
  7375 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7376                                                                  ELCACCTV
  7377     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7378         10  FILLER            PIC 999.                           ELCACCTV
  7379         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7380         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7381             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7382             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7383         10  AM-EXP-MO         PIC 99.                               CL**5
  7384         10  AM-EXP-DA         PIC 99.                               CL**5
  7385     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7386            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7387     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7388         10  FILLER                    PIC 999.                   ELCACCTV
  7389         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7390         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7391             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7392             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7393         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7394         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7395     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7396            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7397     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7398         10  FILLER                    PIC 999.                   ELCACCTV
  7399         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7400         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7401             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7402             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7403         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7404         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7405     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7406            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7407     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7408         10 FILLER                     PIC 999.                   ELCACCTV
  7409         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7410         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7411            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7412            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7413         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7414         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7415     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7416            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7417     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7418         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 145
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7419         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7420         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7421            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7422            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7423         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7424         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7425     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7426            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7427     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7428         10  FILLER                    PIC 999.                   ELCACCTV
  7429         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7430         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7431             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7432             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7433         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7434         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7435     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7436            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7437     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7438         10  FILLER                    PIC 999.                   ELCACCTV
  7439         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7440         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7441             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7442             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7443         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7444         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7445     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7446            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7447     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7448         10  FILLER                    PIC 999.                   ELCACCTV
  7449         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7450         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7451             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7452             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7453         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7454         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7455     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7456            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7457     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7458         10  FILLER                    PIC 999.                   ELCACCTV
  7459         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7460         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7461             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7462             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7463         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7464         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7465     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7466            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 146
* ECS010.cbl
* 7468                             COPY ELCEXTVR.
  7469******************************************************************04/15/98
  7470*                                                                *ELCEXTVR
  7471*                                                                *ELCEXTVR
  7472*                             ELCEXTVR                           *   LV002
  7473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7474*                            VMOD=2.001                          *ELCEXTVR
  7475*                                                                *ELCEXTVR
  7476*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7477*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7478*                                                                *ELCEXTVR
  7479******************************************************************ELCEXTVR
  7480 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7481     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7482         10  FILLER              PIC 999.                         ELCEXTVR
  7483         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7484         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7485             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7486             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7487         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7488         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7489     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7490            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7491 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7492     05  WS-DE-EFF.                                               ELCEXTVR
  7493         10  FILLER              PIC 999.                         ELCEXTVR
  7494         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7495         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7496             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7497             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7498         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7499         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7500     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7501            WS-DE-EFF            PIC 9(11).                          CL**2
  7502     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7503         10  FILLER              PIC 999.                         ELCEXTVR
  7504         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7505         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7506             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7507             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7508         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7509         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7510     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7511            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7512     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7513         10  FILLER                 PIC 999.                      ELCEXTVR
  7514         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7515         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7516             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7517             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7518         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7519         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7520     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7521            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7522     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7523         10  FILLER                 PIC 999.                      ELCEXTVR
  7524         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7525         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 147
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7526             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7527             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7528         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7529         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7530     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7531            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7532     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7533         10  FILLER                 PIC 999.                      ELCEXTVR
  7534         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7535         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7536             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7537             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7538         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7539         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7540     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7541            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7542     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7543         10  FILLER                 PIC 999.                      ELCEXTVR
  7544         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7545         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7546             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7547             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7548         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7549         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7550     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7551            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7552     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7553         10  FILLER                 PIC 999.                      ELCEXTVR
  7554         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7555         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7556             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7557             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7558         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7559         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7560     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7561            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7562     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7563         10  FILLER                 PIC 999.                         CL**5
  7564         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7565         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7566             15  DE-CP-CC           PIC 99.                          CL**5
  7567             15  DE-CP-YR           PIC 99.                          CL**5
  7568         10  DE-CP-MO               PIC 99.                          CL**5
  7569         10  DE-CP-DA               PIC 99.                          CL**5
  7570     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7571            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7572     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7573         10  FILLER                 PIC 999.                         CL**5
  7574         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7575         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7576             15  DE-RP-CC           PIC 99.                          CL**5
  7577             15  DE-RP-YR           PIC 99.                          CL**5
  7578         10  DE-RP-MO                      PIC 99.                   CL**5
  7579         10  DE-RP-DA                      PIC 99.                   CL**5
  7580     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7581            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7582     05  WS-DE-INCUR.                                             ELCEXTVR
  7583         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7584         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7585         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7586             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7587             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7588         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7589         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7590     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7591            WS-DE-INCUR             PIC 9(11).                       CL**2
  7592     05  WS-DE-PAY.                                               ELCEXTVR
  7593         10  FILLER                 PIC 999.                      ELCEXTVR
  7594         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7595         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7596             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7597             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7598         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7599         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7600     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7601            WS-DE-PAY               PIC 9(11).                       CL**2
  7602     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7603         10  FILLER                 PIC 999.                      ELCEXTVR
  7604         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7605         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7606             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7607             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7608         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7609         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7610     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7611            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7612     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7613         10 FILLER                  PIC 999.                      ELCEXTVR
  7614         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7615         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7616            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7617            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7618         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7619         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7620     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7621            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7622     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7623         10 FILLER                  PIC 999.                      ELCEXTVR
  7624         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7625         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7626            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7627            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7628         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7629         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7630     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7631            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7632     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7633         10  FILLER                 PIC 999.                      ELCEXTVR
  7634         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7635         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7636             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7637             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7638         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7639         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7640     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7641            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7642     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7643         10  FILLER                 PIC 999.                      ELCEXTVR
  7644         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7645         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7646             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7647             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7648         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7649         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7650     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7651            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7652     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7653         10  FILLER                        PIC 999.               ELCEXTVR
  7654         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7655         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7656                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7657             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7658             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7659         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7660         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7661     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7662            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7663     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7664         10  FILLER                        PIC 999.               ELCEXTVR
  7665         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7666         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7667                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7668             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7669             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7670         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7671         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7672     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7673            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7674                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 150
* ECS010.cbl
  7676 PROCEDURE DIVISION.
  7677
  7678 0000-START.
  7679
  7680******************************************************************
  7681***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7682******************************************************************
  7683
  7684*0003-LOAD-DATE-CARD.
* 7685                             COPY ELCDTERX.
  7686******************************************************************04/15/98
  7687*                                                                *ELCDTERX
  7688*                                                                *ELCDTERX
  7689*                            ELCDTERX.                           *   LV002
  7690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7691*                            VMOD=2.007                          *ELCDTERX
  7692*                                                                *ELCDTERX
  7693*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7694*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7695*      = ELCDTEFD)                                               *ELCDTERX
  7696*                                                                *ELCDTERX
  7697******************************************************************ELCDTERX
  7698                                                                  ELCDTERX
  7699     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7700                                                                  ELCDTERX
  7701     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7702     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7703     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7704                                                                  ELCDTERX
  7705     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7706                                                                  ELCDTERX
  7707******************************************************************ELCDTERX
  7708*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7709*          WARNING MESSAGES.                                      ELCDTERX
  7710******************************************************************ELCDTERX
  7711     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7712         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7713                                                                  ELCDTERX
  7714     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7715                                                                  ELCDTERX
  7716     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7717                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7718                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7719                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7720                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7721                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7722                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7723                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7724                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7725                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7726                                                                  ELCDTERX
  7727     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7728                                                                  ELCDTERX
  7729     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7730                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7731                                                                  ELCDTERX
  7732     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7733     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 151
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7734     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7735     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7736                                                                  ELCDTERX
  7737     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7738         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7739     ELSE                                                         ELCDTERX
  7740         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7741                                                                  ELCDTERX
  7742     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7743         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7744     ELSE                                                         ELCDTERX
  7745         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7746                                                                  ELCDTERX
  7747 0005-READ--CARD.                                                 ELCDTERX
  7748     READ DISK-DATE                                               ELCDTERX
  7749         AT END CLOSE DISK-DATE                                   ELCDTERX
  7750             GO TO 0060-READ--TEST.                               ELCDTERX
  7751                                                                  ELCDTERX
  7752     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7753                                                                  ELCDTERX
  7754     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7755         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7756         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7757         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7758         GO TO 0005-READ--CARD.                                   ELCDTERX
  7759                                                                  ELCDTERX
  7760     IF DD-ID = 'CLAD'                                            ELCDTERX
  7761         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7762         GO TO 0005-READ--CARD.                                   ELCDTERX
  7763                                                                  ELCDTERX
  7764     IF DD-ID = 'CLAX'                                            ELCDTERX
  7765         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7766         GO TO 0005-READ--CARD.                                   ELCDTERX
  7767                                                                  ELCDTERX
  7768     IF DD-ID = 'CLAF'                                            ELCDTERX
  7769         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7770         GO TO 0005-READ--CARD.                                   ELCDTERX
  7771                                                                  ELCDTERX
  7772     IF DD-ID = 'CLAC'                                            ELCDTERX
  7773         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7774                                                                  ELCDTERX
  7775     IF DD-ID = 'CARR'                                            ELCDTERX
  7776         GO TO 0015-READ--CARR.                                   ELCDTERX
  7777                                                                  ELCDTERX
  7778     IF DD-ID = 'STAT'                                            ELCDTERX
  7779         GO TO 0020-READ--STAT.                                   ELCDTERX
  7780                                                                  ELCDTERX
  7781     IF DD-ID = 'BUSC'                                            ELCDTERX
  7782         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7783                                                                  ELCDTERX
  7784     IF DD-ID = 'MORT'                                            ELCDTERX
  7785         GO TO 0030-READ--MORT.                                   ELCDTERX
  7786                                                                  ELCDTERX
  7787     IF DD-ID = 'CLAI'                                            ELCDTERX
  7788         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7789                                                                  ELCDTERX
  7790     IF DD-ID = 'COLC'                                            ELCDTERX
  7791         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7792                                                                  ELCDTERX
  7793     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7794        DD-IDA = 'CL'                                             ELCDTERX
  7795         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7796                                                                  ELCDTERX
  7797     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7798        DD-IDA = 'PO'                                             ELCDTERX
  7799         GO TO 0050-READ--POXX.                                   ELCDTERX
  7800                                                                  ELCDTERX
  7801     IF DD-ID = 'OPCA'                                            ELCDTERX
  7802         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7803                                                                  ELCDTERX
  7804     IF DD-ID = 'OPST'                                            ELCDTERX
  7805         GO TO 0072-READ--OPST.                                   ELCDTERX
  7806                                                                  ELCDTERX
  7807     IF DD-ID = 'OPBS'                                            ELCDTERX
  7808         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7809                                                                  ELCDTERX
  7810     IF DD-ID = 'OPMS'                                            ELCDTERX
  7811         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7812                                                                  ELCDTERX
  7813     GO TO 0005-READ--CARD.                                       ELCDTERX
  7814                                                                  ELCDTERX
  7815 0010-READ--CLAC.                                                 ELCDTERX
  7816     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7817     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7818     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7819     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7820     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7821     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7822     GO TO 0005-READ--CARD.                                       ELCDTERX
  7823                                                                  ELCDTERX
  7824 0015-READ--CARR.                                                 ELCDTERX
  7825     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7826     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7827        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7828        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7829        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7830        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7831        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7832        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7833        MOVE DD-CARR1-SECPAY-SW
  7834                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7835     END-IF
  7836                                                                  ELCDTERX
  7837     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7838     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7839        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7840        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7841        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7842        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7843        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7844        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7845        MOVE DD-CARR2-SECPAY-SW
  7846                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7847     END-IF
  7848                                                                  ELCDTERX
  7849                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7850     GO TO 0005-READ--CARD.                                       ELCDTERX
  7851                                                                  ELCDTERX
  7852 0020-READ--STAT.                                                 ELCDTERX
  7853     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7854     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7855        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7856         GO TO 0005-READ--CARD.                                   ELCDTERX
  7857                                                                  ELCDTERX
  7858     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7859     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7860     GO TO 0020-READ--STAT.                                       ELCDTERX
  7861                                                                  ELCDTERX
  7862 0025-READ--BUSC.                                                 ELCDTERX
  7863     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7864     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7865        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7866         GO TO 0005-READ--CARD.                                   ELCDTERX
  7867                                                                  ELCDTERX
  7868     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7869     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7870     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7871                                                                  ELCDTERX
  7872 0030-READ--MORT.                                                 ELCDTERX
  7873     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7874     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7875        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7876         GO TO 0005-READ--CARD.                                   ELCDTERX
  7877                                                                  ELCDTERX
  7878     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7879     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7880     GO TO 0030-READ--MORT.                                       ELCDTERX
  7881                                                                  ELCDTERX
  7882 0035-READ--CLXX.                                                 ELCDTERX
  7883     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7884          GO TO 0005-READ--CARD.                                  ELCDTERX
  7885                                                                  ELCDTERX
  7886     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7887         DISPLAY '***********************************************'ELCDTERX
  7888         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7889         DISPLAY '***********************************************'ELCDTERX
  7890         GO TO 0055-READ--STOP.                                   ELCDTERX
  7891                                                                  ELCDTERX
  7892     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7893        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7894         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7895                                                                  ELCDTERX
  7896     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7897        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7898         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7899                                                                  ELCDTERX
  7900*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7901     GO TO 0005-READ--CARD.                                       ELCDTERX
  7902                                                                  ELCDTERX
  7903 0040-READ--CLAI.                                                 ELCDTERX
  7904     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7905     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7906        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7907         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7908                                                                  ELCDTERX
  7909     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7910     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7911     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7912                                                                  ELCDTERX
  7913 0045-READ--DUMP.                                                 ELCDTERX
  7914     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7915     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7916                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7917     PERFORM ABEND-PGM.                                           ELCDTERX
  7918                                                                  ELCDTERX
  7919 0050-READ--POXX.                                                 ELCDTERX
  7920     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7921         GO TO 0005-READ--CARD.                                   ELCDTERX
  7922                                                                  ELCDTERX
  7923     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7924         DISPLAY '***********************************************'ELCDTERX
  7925         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7926         DISPLAY '***********************************************'ELCDTERX
  7927         GO TO 0055-READ--STOP.                                   ELCDTERX
  7928                                                                  ELCDTERX
  7929     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7930     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7931     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7932     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7933                                                                  ELCDTERX
  7934     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7935         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7936     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7937         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7938                                                                  ELCDTERX
  7939     GO TO 0005-READ--CARD.                                       ELCDTERX
  7940                                                                  ELCDTERX
  7941 0055-READ--STOP.                                                 ELCDTERX
  7942     GOBACK.                                                      ELCDTERX
  7943                                                                  ELCDTERX
  7944 0060-READ--TEST.                                                 ELCDTERX
  7945     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7946        CLAX-ID         = SPACE  OR                               ELCDTERX
  7947        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7948         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7949                                                                  ELCDTERX
  7950     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7951     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7952                                                                  ELCDTERX
  7953 0065-READ--COLC.                                                 ELCDTERX
  7954     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7955     GO TO 0005-READ--CARD.                                       ELCDTERX
  7956                                                                  ELCDTERX
  7957 0070-READ--OPCA.                                                 ELCDTERX
  7958                                                                  ELCDTERX
  7959     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7960                                                                  ELCDTERX
  7961     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7962             OR                                                   ELCDTERX
  7963         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7964         GO TO 0005-READ--CARD.                                   ELCDTERX
  7965                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7966     ADD 1                       TO INDEXCA.                      ELCDTERX
  7967     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7968                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7969     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7970                                                                  ELCDTERX
  7971 0072-READ--OPST.                                                 ELCDTERX
  7972                                                                  ELCDTERX
  7973     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7974                                                                  ELCDTERX
  7975     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7976             OR                                                   ELCDTERX
  7977         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7978         GO TO 0005-READ--CARD.                                   ELCDTERX
  7979                                                                  ELCDTERX
  7980     ADD 1                       TO INDEXST.                      ELCDTERX
  7981     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7982                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7983     GO TO 0072-READ--OPST.                                       ELCDTERX
  7984                                                                  ELCDTERX
  7985 0074-READ--OPBS.                                                 ELCDTERX
  7986                                                                  ELCDTERX
  7987     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7988                                                                  ELCDTERX
  7989     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7990             OR                                                   ELCDTERX
  7991         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7992         GO TO 0005-READ--CARD.                                   ELCDTERX
  7993                                                                  ELCDTERX
  7994     ADD 1                       TO INDEXBS.                      ELCDTERX
  7995     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7996     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7997                                                                  ELCDTERX
  7998 0079-READ--EXIT.                                                 ELCDTERX
  7999*    EXIT.                                                        ELCDTERX
  8000******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 156
* ECS010.cbl
  8002******************************************************************
  8003***           O P E N   F I L E S   R O U T I N E              ***
  8004******************************************************************
  8005
  8006     DISPLAY ' '.
  8007     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8008         'ECS010 ******'
  8009     DISPLAY ' '.
  8010
  8011     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8012     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8013     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8014     .
  8015 0080-OPEN-FILES.
  8016*    IF DTE-PGM-OPT = '1'
  8017*       open output detail-extr
  8018*    end-if
  8019     OPEN INPUT  PENDING-EXTRACT
  8020                 CERT-MASTER-IN
  8021                 ERACCTT-IN
  8022                 ERAGTC
  8023
  8024          I-O    ERMEBL-INOUT
  8025                 ELCRTT
  8026
  8027          OUTPUT SUMMARY-EXTR
  8028                 ME-ECS010-BALANCE
  8029                 ME50-ECS010-BALANCE
  8030                 DISPLAY-PRT
  8031                 MISMATCH-REPORT
  8032                 PRINT-COPY.
  8033     IF DTE-CLIENT = 'DCC'
  8034        OPEN INPUT ERPDEF
  8035     END-IF
  8036
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 157
* ECS010.cbl
  8038*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8039     IF DTE-CLIENT NOT = 'DMD'
  8040         NEXT SENTENCE
  8041     ELSE
  8042         OPEN INPUT ERRESC-IN
  8043            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8044                NEXT SENTENCE
  8045            ELSE
  8046                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8047                MOVE 'ERROR OPENING ERRESC FILE'
  8048                                        TO WS-ABEND-MESSAGE
  8049                GO TO ABEND-PGM.
  8050*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8051
  8052     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8053         NEXT SENTENCE
  8054       ELSE
  8055         MOVE '11'                    TO ABEND-CODE-1
  8056         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8057         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8058         GO TO ABEND-PGM.
  8059
  8060     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8061        CONTINUE
  8062     ELSE
  8063        DISPLAY ' OPEN ERROR ELCRTT '
  8064        MOVE '31'                TO ABEND-CODE-1
  8065        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8066        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8067        GO TO ABEND-PGM
  8068     END-IF
  8069
  8070     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8071        CONTINUE
  8072     ELSE
  8073        DISPLAY ' OPEN ERROR ERAGTC '
  8074        MOVE '41'                TO ABEND-CODE-1
  8075        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8076        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8077        GO TO ABEND-PGM
  8078     END-IF
  8079
  8080     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8081        CONTINUE
  8082     ELSE
  8083        DISPLAY ' OPEN ERROR ERPDEF '
  8084        MOVE '61'                TO ABEND-CODE-1
  8085        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8086        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8087        GO TO ABEND-PGM
  8088     END-IF
  8089
  8090     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8091         NEXT SENTENCE
  8092       ELSE
  8093         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8094
  8095           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 158
* ECS010.cbl
  8096              and (dte-pgm-opt = '1')
  8097              open output new-detail-extr
  8098           end-if
  8099
  8100     IF DTE-PGM-OPT = '1'
  8101         OPEN OUTPUT  CERT-MASTER-OUT
  8102                      DETAIL-EXTR
  8103     ELSE
  8104         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8105         MOVE '*'                     TO TRANS-EOF-FLAG.
  8106
  8107     MOVE 'R'                         TO CP-RATE-FILE.
  8108     MOVE 'O'                         TO CP-IO-FUNCTION.
  8109     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8110     IF IO-ERROR
  8111         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8112                                      TO WS-ABEND-MESSAGE
  8113         MOVE 0302                    TO WS-RETURN-CODE
  8114         GO TO ABEND-PGM.
  8115
  8116******************************************************************
  8117***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8118******************************************************************
  8119
  8120 0090-INITIALIZATION-ROUTINE.
  8121
  8122     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8123     MOVE WS-TIME                     TO ME-START-TIME.
  8124     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8125                                         TR-RN-DT.
  8126     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8127     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8128     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8129     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8130     MOVE COMPANY-NAME                TO TRHDNM.
  8131     MOVE ALPH-DATE                   TO TR-MODAYR.
  8132     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8133     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8134
  8135     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8136     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8137     COMPUTE LYD-MO = LYD-MO - 1.
  8138     IF LYD-MO = ZERO
  8139         MOVE 12                      TO LYD-MO
  8140         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8141
  8142     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8143
  8144
  8145     IF DTE-CLIENT = 'CID'
  8146         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8147         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8148     ELSE
  8149       IF DTE-CLIENT = 'AHL'
  8150         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8151         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8152       ELSE
  8153         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 159
* ECS010.cbl
  8154         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8155       END-IF
  8156     END-IF.
  8157
  8158     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8159         GO TO 0090-CONTINUE.
  8160
  8161     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8162     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8163     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8164     MOVE '6'                    TO DC-OPTION-CODE.
  8165     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8166
  8167     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8168         MOVE '**** WORK DATE CALC ERROR ****'
  8169                                 TO WS-ABEND-MESSAGE
  8170         MOVE '90'               TO ABEND-CODE-1
  8171         MOVE '0'                TO AC2-ONE
  8172         MOVE DC-ERROR-CODE      TO AC2-TWO
  8173         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8174         GO TO ABEND-PGM.
  8175
  8176     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8177
  8178     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8179     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8180
  8181     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8182             VARYING
  8183         SUBM FROM +2 BY +1
  8184             UNTIL
  8185         SUBM GREATER THAN +12.
  8186
  8187     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8188
  8189     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8190             VARYING
  8191         SUBM FROM +1 BY +1
  8192             UNTIL
  8193         SUBM GREATER THAN +13.
  8194
  8195     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8196*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8197     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8198                                    DC-ELAPSED-MONTHS.
  8199     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8200     MOVE 1                      TO DC-END-OF-MONTH.
  8201     MOVE '6'                    TO DC-OPTION-CODE.
  8202     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8203
  8204     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8205         MOVE '**** CUT OFF DATE ERROR ****'
  8206                                 TO WS-ABEND-MESSAGE
  8207         MOVE '90'               TO ABEND-CODE-1
  8208         MOVE '0'                TO AC2-ONE
  8209         MOVE DC-ERROR-CODE      TO AC2-TWO
  8210         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8211         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 160
* ECS010.cbl
  8212
  8213     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8214     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8215
  8216 0090-CONTINUE.
  8217
  8218     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8219     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8220     MOVE +0                     TO DC-ELAPSED-DAYS.
  8221     MOVE '6'                    TO DC-OPTION-CODE.
  8222     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8223
  8224     IF NO-CONVERSION-ERROR
  8225        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8226
  8227     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8228     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8229     MOVE +0                     TO DC-ELAPSED-DAYS.
  8230     MOVE '6'                    TO DC-OPTION-CODE.
  8231     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8232
  8233     IF NO-CONVERSION-ERROR
  8234        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8235
  8236     MOVE +0                     TO DC-ELAPSED-MONTHS
  8237                                    DC-ELAPSED-DAYS.
  8238
  8239     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8240     MOVE 'CR'                   TO CR-RECORD-ID.
  8241     MOVE ZEROS                  TO
  8242               CR-AGE                  CR-JOINT-AGE
  8243               CR-LFTYP                CR-AHTYP
  8244               CR-LF-TERM              CR-AH-TERM
  8245               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8246               CR-LF-TERM-IN-DAYS
  8247               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8248               CR-LFAMT                CR-AHAMT
  8249               CR-LFPRM                CR-AHPRM
  8250               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8251               CR-LFPRM-CALC           CR-AHPRM-CALC
  8252               CR-LFPRM-RATE           CR-AHPRM-RATE
  8253               CR-LFAMT-ALT
  8254               CR-LFPRM-ALT
  8255               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8256               CR-LFPRM-RATE-ALT
  8257               CR-LFRFND               CR-AHRFND
  8258               CR-LFRFND-CALC          CR-AHRFND-CALC
  8259               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8260               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8261               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8262               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8263               CR-LIVES                CR-APR
  8264               CR-BILLED
  8265               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8266               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8267               CR-PMT-FREQ             CR-LOAN-TERM
  8268               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8269               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 161
* ECS010.cbl
  8270               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8271               CR-LF-CANC-DT           CR-AH-CANC-DT
  8272               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8273               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8274               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8275               CR-DTH-DT               CR-DIS-DT
  8276               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8277               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8278                                       CR-DIS-PTO-DT
  8279               CR-DTHAMT               CR-DISAMT
  8280               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8281               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8282               CR-DTHEXP               CR-DISEXP
  8283               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8284               CR-DTH-AGE              CR-DAYS-DISAB
  8285               CR-DIS-INCUR-DT (1)
  8286***            CR-CLAIM-DEDUCT-WITHHELD
  8287               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8288               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8289               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8290               CR-MOB-NET-TOT-FEES
  8291               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8292               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8293
  8294     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8295                                       CR-DISAB-DETAIL-DATA (3)
  8296                                       CR-DISAB-DETAIL-DATA (4)
  8297                                       CR-DISAB-DETAIL-DATA (5).
  8298
  8299     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8300
  8301     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8302     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8303        IA > +10
  8304        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8305     END-PERFORM
  8306     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8307
  8308     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8309
  8310     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8311                          EPEC-TOTALS      EPEC-SUBS
  8312                          EPEC-UNDERWRITTEN-TOTALS.
  8313
  8314     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8315                          EPEC-LEVELS-END-II.
  8316     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8317                          DUPE-CERT-TABLE.
  8318
  8319     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8320     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8321     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8322                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8323     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8324                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8325
  8326     IF RUN-DATE NOT = EP-DT
  8327         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 162
* ECS010.cbl
  8328     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8329     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8330     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8331     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8332
  8333     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8334         MOVE +1000                   TO DUP-MAX.
  8335
  8336     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8337     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8338     IF ME-DO-UPDATE
  8339         READ ERMEBL-INOUT INVALID KEY
  8340                       CLOSE ERMEBL-INOUT
  8341                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8342
  8343     IF DTE-CLIENT = 'DCC'
  8344        MOVE 0 TO B-SUB
  8345        MOVE DTE-CLASIC-COMPANY-CD
  8346                                 TO PD-CONTROL-PRIMARY
  8347        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8348        IF ERPDEF-FILE-STATUS = '00'
  8349           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8350              READ ERPDEF NEXT RECORD
  8351              IF ERPDEF-FILE-STATUS = '00'
  8352                 ADD 1 TO B-SUB
  8353                 IF B-SUB > 800
  8354                    DISPLAY ' DDF UEP TABLE BLEW '
  8355                    GO TO ABEND-PGM
  8356                 END-IF
  8357                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8358                 MOVE PD-PRODUCT-CD
  8359                                 TO DD-PRODUCT-CD (B-SUB)
  8360                 MOVE PD-BEN-TYPE
  8361                                 TO DD-BEN-TYPE (B-SUB)
  8362                 MOVE PD-BEN-CODE
  8363                                 TO DD-BEN-CODE (B-SUB)
  8364                 MOVE PD-PROD-EXP-DT
  8365                                 TO DD-PROD-EXP-DT (B-SUB)
  8366                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8367                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8368                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8369                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8370                    P2 > +8
  8371                    MOVE PD-PROD-CODE (P2)
  8372                                 TO DD-PROD-CODE (B-SUB P2)
  8373                    MOVE PD-MAX-AMT (P2)
  8374                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8375                 END-PERFORM
  8376                 MOVE PD-EARN-FACTORS
  8377                                 TO DD-EARN-FACTORS (B-SUB)
  8378              END-IF
  8379           END-PERFORM
  8380        END-IF
  8381        CLOSE ERPDEF
  8382     END-IF
  8383
  8384     GO TO 0150-READ-ACCOUNT-MASTER.
  8385
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 163
* ECS010.cbl
  8386 0090-EXIT.
  8387     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 164
* ECS010.cbl
  8389 0095-GET-EOM-DATES.
  8390
  8391     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8392     MOVE '6'                    TO DC-OPTION-CODE.
  8393     MOVE 1                      TO DC-ELAPSED-MONTHS
  8394                                    DC-END-OF-MONTH.
  8395     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8396     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8397
  8398     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8399         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8400                                 TO WS-ABEND-MESSAGE
  8401         MOVE '90'               TO ABEND-CODE-1
  8402         MOVE '0'                TO AC2-ONE
  8403         MOVE DC-ERROR-CODE      TO AC2-TWO
  8404         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8405         GO TO ABEND-PGM.
  8406
  8407     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8408                                     DC-BIN-DATE-1.
  8409     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8410     MOVE ' '                    TO  DC-OPTION-CODE.
  8411     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8412
  8413     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8414         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8415                                 TO WS-ABEND-MESSAGE
  8416         MOVE '90'               TO ABEND-CODE-1
  8417         MOVE '0'                TO AC2-ONE
  8418         MOVE DC-ERROR-CODE      TO AC2-TWO
  8419         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8420         GO TO ABEND-PGM.
  8421
  8422     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8423
  8424 0095-EXIT.
  8425     EXIT.
  8426
  8427 0096-DISPLAY-EOM-DATES.
  8428
  8429     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8430
  8431 0096-EXIT.
  8432     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 165
* ECS010.cbl
  8434******************************************************************
  8435***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8436******************************************************************
  8437
  8438 0100-ACCT-MASTER-READ-ROUTINE.
  8439
  8440     IF EP-FLG = '1'
  8441        ADD +1                   TO BC-ACT-ACCTS
  8442        IF DTE-OPT-RESERVE-METHOD-AUTH
  8443           PERFORM 4700-CALC-OPT-IBNR
  8444                                 THRU 4700-EXIT
  8445        END-IF
  8446        PERFORM 4500-BUILD-EPEC-EXTRACT
  8447                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8448     END-IF
  8449
  8450     IF TRANSACTION-WAS-PROCESSED
  8451         MOVE '1'                     TO ACCT-FLG
  8452                                         STATE-FLG
  8453                                         COMP-FLG
  8454                                         CARR-FLG
  8455                                         FINAL-FLG.
  8456
  8457 0150-READ-ACCOUNT-MASTER.
  8458
  8459     READ ERACCTT-IN AT END
  8460         GO TO 9930-EOJ-3.
  8461
  8462     ADD +1                            TO ERACCTT-READS.
  8463
* 8464     COPY ELCACCTI.
  8465******************************************************************04/14/98
  8466*                                                                *ELCACCTI
  8467*                            ELCACCTI                            *   LV003
  8468*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8469*                            VMOD=2.001                          *ELCACCTI
  8470*                                                                *ELCACCTI
  8471*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8472*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8473*                                                                *ELCACCTI
  8474*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8475*                                                                *ELCACCTI
  8476******************************************************************ELCACCTI
  8477     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8478     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8479     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8480     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8481     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8482     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8483     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8484     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8485     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8486
  8487     IF FIRST-ACCOUNT EQUAL +1
  8488        MOVE +0                  TO FIRST-ACCOUNT
  8489        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8490
  8491     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 166
* ECS010.cbl
  8492         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8493     ELSE
  8494     IF AM-GROUPING NOT = HLD-GROUPING
  8495         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8496     ELSE
  8497     IF AM-STATE NOT = HLD-STATE
  8498         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8499     ELSE
  8500     IF AM-ACCOUNT NOT = HLD-ACCT
  8501         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8502     ELSE
  8503     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8504
  8505     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8506        (AM-GROUPING NOT = HLD-GROUPING)
  8507         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8508
  8509 0190-PROCESS-NEW-ACCOUNT.
  8510
  8511     IF AM-CARRIER NOT = HLD-CARRIER
  8512         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8513
  8514     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8515     MOVE AM-CARRIER            TO TR-CARR.
  8516     MOVE AM-GROUPING           TO TR-GROUP.
  8517     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8518     MOVE AM-NAME               TO TR-AGCY.
  8519     MOVE AM-EFF-MO             TO TR-CE-MO.
  8520     MOVE AM-EFF-DA             TO TR-CE-DA.
  8521     MOVE AM-EFF-YR             TO TR-CE-YR.
  8522     MOVE AM-STATE              TO TR-ST-NO.
  8523     IF AM-EXPIRE-DT =  99999999999
  8524         MOVE 'CURRENT '        TO TR-CX
  8525     ELSE
  8526         MOVE AM-EXP-MO         TO TR-CX-MO
  8527         MOVE AM-EXP-DA         TO TR-CX-DA
  8528         MOVE AM-EXP-YR         TO TR-CX-YR
  8529         MOVE '-'               TO HSHR1  HSHR2.
  8530
  8531     ADD +1 TO BC-ACCTS.
  8532
  8533     IF AM-RECORD-ID = '**'
  8534         ADD +1 TO BC-NEW-ACCTS.
  8535     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8536         ADD +1 TO BC-ER-ACCTS.
  8537
  8538     MOVE ZEROS                 TO SV-LO-CERT
  8539                                   SV-HI-CERT.
  8540     MOVE SPACE                 TO TRANSACTION-FLAG
  8541                                   LST-TRD-CERT
  8542                                   LST-TRD-ISDT
  8543                                   OB-DATE-1-SWITCH
  8544                                   OB-DATE-2-SWITCH
  8545                                   OB-DATE-3-SWITCH.
  8546     MOVE +81                   TO LN-CNT.
  8547
  8548     IF DTE-CLIENT = 'DCC'
  8549        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 167
* ECS010.cbl
  8550        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8551           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8552              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8553           END-IF
  8554           IF AM-COMM-CHARGEBACK (SUB) = 99
  8555              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8556           END-IF
  8557        END-PERFORM
  8558     END-IF
  8559     .
  8560 0199-READ-ACCOUNT-X.
  8561     EXIT.
  8562
  8563 0199A-CARRIER-TABLE-LOOKUP.
  8564
  8565     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8566            VARYING CLAS-INDEXCN FROM 1 BY 1
  8567         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8568               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8569
  8570     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8571         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8572         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8573                                 TO WS-ABEND-MESSAGE
  8574         MOVE 4004               TO WS-ABEND-CODE
  8575         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8576         GO TO ABEND-PGM.
  8577
  8578 0199A-LOOKUP-XIT.
  8579     EXIT.
  8580 0199B-SEARCH-CARRIER-TABLE.
  8581     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 168
* ECS010.cbl
  8583******************************************************************
  8584***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8585******************************************************************
  8586
  8587 0200-CERT-MASTER-READ-ROUTINE.
  8588
  8589     IF EOF-ON-CERT
  8590         GO TO 0299-READ-CERT-X.
  8591
  8592     IF FIRST-CERT EQUAL +1
  8593        MOVE +0                  TO FIRST-CERT
  8594        GO TO 0250-READ-CERT-MASTER.
  8595
  8596     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8597
  8598     PERFORM CERT-DATE-LOAD.
  8599
  8600     IF CR-IND-GRP = 'I'  OR  '1'
  8601         MOVE '1'                    TO CR-IND-GRP
  8602     ELSE
  8603         MOVE '2'                    TO CR-IND-GRP.
  8604
  8605     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8606         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8607     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8608         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8609
  8610************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8611     IF DTE-CLIENT NOT = 'NSL'
  8612         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8613                                      CR-AH-REI-RISK-PRM.
  8614******************************************************************
  8615
  8616**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8617****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8618     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8619         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8620
  8621     MOVE CR-STATE                   TO STATE-L.
  8622     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8623
  8624     IF CR-LFTYP NOT = ZERO
  8625         MOVE CR-LFTYP               TO CLAS-LOOK
  8626         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8627
  8628     IF CR-AHTYP NOT = ZERO
  8629         MOVE CR-AHTYP               TO CLAS-LOOK
  8630         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8631
  8632     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8633     MOVE 'L'                    TO DC-OPTION-CODE
  8634     MOVE +0                     TO DC-ELAPSED-MONTHS
  8635                                    DC-ELAPSED-DAYS
  8636     PERFORM 8000-DATE-CONVERT-ROUTINE
  8637                                 THRU 8099-DATE-CONVERT-X
  8638     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8639
  8640     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 169
* ECS010.cbl
  8641        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8642        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8643        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8644        PERFORM 0395-GET-CERT-TRLRS
  8645                                 THRU 0395-EXIT
  8646     END-IF
  8647
  8648     IF RUN-MO NOT = 01
  8649         GO TO 0250-READ-CERT-MASTER.
  8650
  8651     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8652                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8653
  8654     IF ((CR-LFTYP NOT = ZERO)  AND
  8655         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8656        ((CR-AHTYP NOT = ZERO)  AND
  8657         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8658           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8659
  8660     .
  8661 0250-READ-CERT-MASTER.
  8662
  8663     READ CERT-MASTER-IN
  8664               AT END GO TO 9920-EOJ-2.
  8665
  8666     ADD +1 TO CMIN-CNT.
  8667
  8668*     DISPLAY ' READ CERT ' CIR-CONTROL
  8669     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8670         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8671         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8672         DISPLAY 'SECOND - '  CIR-CONTROL
  8673         MOVE 0612                    TO WS-ABEND-CODE
  8674         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8675         GO TO ABEND-PGM.
  8676
  8677     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8678         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8679            pcic-dt ' ' pcic-cert-no
  8680         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8681            GO TO 0250-READ-CERT-MASTER
  8682         ELSE
  8683            MOVE 'DUPLICATE CERT ON FILE'
  8684                                      TO WS-ABEND-MESSAGE
  8685            MOVE 0302                 TO WS-ABEND-CODE
  8686            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8687            GO TO ABEND-PGM.
  8688
  8689******************************************************
  8690*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8691*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8692*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8693******************************************************
  8694     IF DTE-CLIENT = 'CID'
  8695        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8696           IF (CF-THIRD-AGENT  = '0000713100') OR
  8697              (CF-FOURTH-AGENT = '0000713100')
  8698              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 170
* ECS010.cbl
  8699           ELSE
  8700              GO TO 0250-READ-CERT-MASTER
  8701           END-IF
  8702        ELSE
  8703           IF COMPANY-NAME = '        PEOPLES TRUST'
  8704              IF CI-ACCOUNT = '0000845800'
  8705                 CONTINUE
  8706              ELSE
  8707                 GO TO 0250-READ-CERT-MASTER
  8708              END-IF
  8709           ELSE
  8710              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8711                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8712                    (CF-FOURTH-AGENT = '0000681700')
  8713                    CONTINUE
  8714                 ELSE
  8715                    GO TO 0250-READ-CERT-MASTER
  8716                 END-IF
  8717              ELSE
  8718                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8719                    IF CI-ACCOUNT = '0001107200'
  8720                       CONTINUE
  8721                    ELSE
  8722                       GO TO 0250-READ-CERT-MASTER
  8723                    END-IF
  8724                 END-IF
  8725              END-IF
  8726           END-IF
  8727        END-IF
  8728     END-IF
  8729
  8730******************************************************
  8731     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8732
  8733 0299-READ-CERT-X.
  8734     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 171
* ECS010.cbl
  8736******************************************************************
  8737***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8738******************************************************************
  8739
  8740 0300-READ-PENDING-TRANSACTIONS.
  8741
  8742     READ PENDING-EXTRACT
  8743                   AT END GO TO 9910-EOJ-1.
  8744
  8745     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8746
  8747     IF NOT ED-PENDING-BUSINESS  AND
  8748        NOT ED-PENDING-CLAIMS  AND
  8749        NOT ED-CERT-CHANGES
  8750           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8751                                               ED-RECORD-TYPE
  8752           MOVE 0301                        TO WS-ABEND-CODE
  8753           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8754           GO TO ABEND-PGM.
  8755
  8756     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8757
  8758     IF DTE-CLIENT = 'NCL'
  8759         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8760             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8761                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8762             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8763
  8764     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8765         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8766         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8767         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8768         MOVE 0603                    TO WS-ABEND-CODE
  8769         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8770         GO TO ABEND-PGM.
  8771
  8772     ADD +1 TO TR-CNT.
  8773
  8774     IF ISSUE-TRANSACTION   OR
  8775        CANCEL-TRANSACTION  OR
  8776        CLAIM-TRANSACTION   OR
  8777        RESERVE-TRANSACTION OR
  8778        UPDATE-TRANSACTION
  8779         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8780         GO TO 0330-MATCH-PENDING-TO-CERT.
  8781
  8782     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8783
  8784     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8785     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8786             PENDING-RECORD-TYPE ')'.
  8787
  8788     MOVE 0301                   TO WS-ABEND-CODE.
  8789     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8790     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 172
* ECS010.cbl
  8792 0310-SET-UP-MATCHING-KEY.
  8793
  8794     IF ED-PENDING-BUSINESS
  8795         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8796         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8797         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8798         MOVE PB-STATE           TO PEND-MATCH-STATE
  8799         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8800         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8801         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8802         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8803
  8804     IF ED-PENDING-CLAIMS
  8805         ADD +1                  TO W-PENDING-CLMS
  8806         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8807         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8808         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8809         MOVE PC-STATE           TO PEND-MATCH-STATE
  8810         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8811         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8812         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8813         IF PC-CLAIMS
  8814             MOVE '3'            TO PENDING-RECORD-TYPE
  8815         ELSE
  8816             IF PC-RESERVES
  8817                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8818
  8819     IF ED-CERT-CHANGES
  8820         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8821         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8822         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8823         MOVE CC-STATE           TO PEND-MATCH-STATE
  8824         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8825         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8826         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8827         MOVE '5'                TO PENDING-RECORD-TYPE.
  8828
  8829     MOVE ' '                    TO DC-OPTION-CODE.
  8830     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8831     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8832
  8833 0310-EXIT.
  8834     EXIT.
  8835
  8836******************************************************************
  8837***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8838******************************************************************
  8839
  8840 0330-MATCH-PENDING-TO-CERT.
  8841
  8842     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8843         GO TO 0390-CERT-MISMATCH-ERROR.
  8844
  8845     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8846*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8847       IF CLAIM-TRANSACTION
  8848*         DISPLAY ' CLAIM '
  8849         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 173
* ECS010.cbl
  8850            NOT PC-NON-CHARGEBLE-EXPENSE
  8851             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8852                                      OR
  8853                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8854                  GO TO 0390-CERT-MISMATCH-ERROR.
  8855
  8856     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8857       IF RESERVE-TRANSACTION
  8858*         DISPLAY ' RESV '
  8859         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8860                                  OR
  8861            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8862              GO TO 0390-CERT-MISMATCH-ERROR.
  8863
  8864     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8865         IF ISSUE-TRANSACTION
  8866*           DISPLAY ' ISSUE '
  8867             GO TO 0380-DUPLICATE-CERT-ERROR
  8868         ELSE
  8869             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8870
  8871     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8872         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8873         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8874                                               0299-READ-CERT-X
  8875         GO TO 0330-MATCH-PENDING-TO-CERT.
  8876
  8877     IF ISSUE-TRANSACTION
  8878         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8879     ELSE
  8880         GO TO 0390-CERT-MISMATCH-ERROR.
  8881
  8882 0350-MATCH-PENDING-TO-ACCOUNT.
  8883
  8884     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8885       ADD +1  TO ERROR-COUNT
  8886         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8887           TO  DL-FULL
  8888             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8889         MOVE    ' PENDING CONTROL = '
  8890           TO  DIS-LINE-REASON
  8891         MOVE  PENDING-MATCH-CONTROL
  8892           TO  DIS-LINE-REC
  8893             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8894         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8895           TO  DIS-LINE-REASON
  8896         MOVE  PENDING-MATCH-CONTROL
  8897           TO  DIS-LINE-REC
  8898             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8899         MOVE  SPACES
  8900           TO  DISPLAY-LINE
  8901             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8903         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8904         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8905         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8906         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8907         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8908         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 174
* ECS010.cbl
  8909         AM-MSTR-CNTRL AM-EFFECT-DT
  8910         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8911            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8912            GO TO 0300-READ-PENDING-TRANSACTIONS
  8913         ELSE
  8914            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8915                                      TO WS-ABEND-MESSAGE
  8916            MOVE 0302 TO WS-ABEND-CODE
  8917            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8918            GO TO ABEND-PGM.
  8919
  8920     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8921         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8922                                              0199-READ-ACCOUNT-X
  8923         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8924
  8925     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8926        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8927         GO TO 0500-APPLY-PENDING-BUSINESS.
  8928
  8929     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8930                                       0199-READ-ACCOUNT-X.
  8931     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8932
  8933
  8934 0370-ACCOUNT-MISMATCH-ERROR.
  8935
  8936     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8937     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8938     MOVE 'MISMATCH ACCOUNT ERROR'
  8939                               TO WS-ABEND-MESSAGE.
  8940     MOVE 0302 TO WS-ABEND-CODE.
  8941         DISPLAY '******************************'
  8942         DISPLAY '***** ERROR LOCATION 009 *****'
  8943         DISPLAY '******************************'
  8944     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8945     GO TO ABEND-PGM.
  8946
  8947
  8948 0380-DUPLICATE-CERT-ERROR.
  8949
  8950     IF PB-I-OB  OR  PB-I-SUMMARY
  8951         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8952
  8953     ADD +1 TO DUP-CNT.
  8954
  8955     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8956         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8957         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8958                                         PB-I-LF-ALT-PREMIUM-AMT
  8959         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8960         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8961         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8962
  8963     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8964     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8965
  8966*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 175
* ECS010.cbl
  8967*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8968*    GO TO ABEND-PGM.
  8969
  8970
  8971 0390-CERT-MISMATCH-ERROR.
  8972
  8973     IF ISSUE-TRANSACTION  OR
  8974        CANCEL-TRANSACTION  OR
  8975        CLAIM-TRANSACTION
  8976         ADD +1                  TO  MISMATCH-COUNT.
  8977
  8978     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  8979       ADD  +1  TO  ERROR-COUNT
  8980         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8981           TO  DL-FULL
  8982             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8983         MOVE    ' TRANS CONTROL = '
  8984           TO  DIS-LINE-REASON
  8985         MOVE  PENDING-MATCH-CONTROL
  8986           TO  DIS-LINE-REC
  8987             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8988         MOVE    ' TRANS TYPE    = '
  8989           TO  DIS-LINE-REASON
  8990         MOVE  PENDING-RECORD-TYPE
  8991           TO  DIS-LINE-REC
  8992             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8993         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8994           TO  DL-FULL
  8995             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8996         MOVE    ' CERT IN CTL   = '
  8997           TO  DIS-LINE-REASON
  8998         MOVE  CIR-CONTROL
  8999           TO  DIS-LINE-REC
  9000             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9001         MOVE    ' BYPASSED TRANS  = '
  9002           TO  DIS-LINE-REASON
  9003         MOVE  PENDING-MATCH-CONTROL
  9004           TO  DIS-LINE-REC
  9005             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9006         MOVE  SPACES
  9007           TO  DISPLAY-LINE
  9008             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9009         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9010
  9011     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9012     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9013
  9014     IF ISSUE-TRANSACTION
  9015         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9016     ELSE
  9017         IF CANCEL-TRANSACTION
  9018             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9019         ELSE
  9020             IF CLAIM-TRANSACTION
  9021                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9022             ELSE
  9023                 IF RESERVE-TRANSACTION
  9024                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 176
* ECS010.cbl
  9025                 ELSE
  9026                     IF UPDATE-TRANSACTION
  9027                         MOVE 'CHG'
  9028                                 TO  DTL-REC-TYPE-DESC.
  9029
  9030     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9031     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9032     MOVE 'DROPPED'              TO  DTL-STATUS.
  9033
  9034     IF ISSUE-TRANSACTION
  9035         MOVE PB-I-LF-PREMIUM-AMT
  9036                                 TO  MD2-LF-PREM
  9037         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9038                                 TO  MD2-LF-ALT-PREM
  9039         MOVE PB-I-AH-PREMIUM-AMT
  9040                                 TO  MD2-AH-PREM
  9041         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9042         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9043         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9044     ELSE
  9045         IF CANCEL-TRANSACTION
  9046             MOVE PB-C-LF-CANCEL-AMT
  9047                                 TO  MD3-LF-REFUND
  9048             MOVE PB-C-AH-CANCEL-AMT
  9049                                 TO  MD3-AH-REFUND
  9050             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9051             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9052         ELSE
  9053             IF CLAIM-TRANSACTION
  9054                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9055                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9056                     MOVE ZEROS             TO MD4-AH-CLAIM
  9057                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9058                 ELSE
  9059                     MOVE ZEROS             TO MD4-LF-CLAIM
  9060                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9061                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9062
  9063     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9064         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9065         MOVE MISMATCH-PAGE-NUMBER
  9066                                 TO  TR-PG
  9067         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9068         MOVE MR-CTL             TO  X
  9069         MOVE X TO LCP-ASA
  9070         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9071             THRU LCP-WRITE-END-MISMATCH-RPT
  9072         MOVE TR-HD-2            TO  MISMATCH-RPT
  9073         MOVE MR-CTL             TO  X
  9074         MOVE X TO LCP-ASA
  9075         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9076             THRU LCP-WRITE-END-MISMATCH-RPT
  9077         MOVE TR-HD-3            TO  MISMATCH-RPT
  9078         MOVE MR-CTL             TO  X
  9079         MOVE X TO LCP-ASA
  9080         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9081             THRU LCP-WRITE-END-MISMATCH-RPT
  9082         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 177
* ECS010.cbl
  9083         MOVE MR-CTL             TO  X
  9084         MOVE X TO LCP-ASA
  9085         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9086             THRU LCP-WRITE-END-MISMATCH-RPT
  9087         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9088
  9089     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9090     MOVE MR-CTL                 TO  X.
  9091     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9092
  9093     MOVE X TO LCP-ASA
  9094     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9095         THRU LCP-WRITE-END-MISMATCH-RPT.
  9096
  9097     IF ISSUE-TRANSACTION
  9098         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9099         MOVE MR-CTL             TO  X
  9100         ADD +1                  TO  MISMATCH-LINE-COUNT
  9101         MOVE X TO LCP-ASA
  9102         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9103             THRU LCP-WRITE-END-MISMATCH-RPT.
  9104
  9105     IF CANCEL-TRANSACTION
  9106         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9107         MOVE MR-CTL             TO  X
  9108         ADD +1                  TO  MISMATCH-LINE-COUNT
  9109         MOVE X TO LCP-ASA
  9110         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9111             THRU LCP-WRITE-END-MISMATCH-RPT.
  9112
  9113     IF CLAIM-TRANSACTION
  9114         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9115         MOVE MR-CTL             TO  X
  9116         ADD +1                  TO  MISMATCH-LINE-COUNT
  9117         MOVE X TO LCP-ASA
  9118         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9119             THRU LCP-WRITE-END-MISMATCH-RPT.
  9120
  9121     MOVE SPACES                 TO  MISMATCH-RPT.
  9122
  9123     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9124
  9125 0395-GET-CERT-TRLRS.
  9126
  9127     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9128     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9129     MOVE CR-CARRIER             TO CS-CARRIER
  9130     MOVE CR-GROUPING            TO CS-GROUPING
  9131     MOVE CR-STATE               TO CS-STATE
  9132     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9133     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9134     MOVE CR-CERT-NO             TO CS-CERT-NO
  9135     MOVE 'A'                    TO CS-TRAILER-TYPE
  9136
  9137     READ ELCRTT
  9138
  9139     IF ELCRTT-FILE-STATUS = '00'
  9140        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 178
* ECS010.cbl
  9141                                 TO WS-BANK-COMMISSIONS
  9142     ELSE
  9143        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9144           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9145           PERFORM ABEND-PGM
  9146        END-IF
  9147     END-IF
  9148
  9149     .
  9150 0395-EXIT.
  9151     EXIT.
  9152
  9153******************************************************************
  9154***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9155******************************************************************
  9156
  9157 0400-WRITE-CERT-RECORD.
  9158*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9159
  9160     IF CERTIFICATE-RECORD = LOW-VALUES
  9161         GO TO 0499-WRITE-CERT-X.
  9162
  9163     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9164         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9165         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9166            ' ' cr-dt ' ' cr-cert-no
  9167         ADD  +1  TO  ERROR-COUNT
  9168         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9169           TO  DL-FULL
  9170             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9171         MOVE    ' CERT. CONTROL = '
  9172           TO  DIS-LINE-REASON
  9173         MOVE  CR-FULL-CONTROL
  9174           TO  DIS-LINE-REC
  9175             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9176         MOVE  SPACES
  9177           TO  DISPLAY-LINE
  9178             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9179            if dte-pgm-opt = '1'
  9180               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9181               ADD +1 TO CMOT-CNT
  9182            end-if
  9183            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9184                                 thru 0299-READ-CERT-X
  9185               GO TO 0400-WRITE-CERT-RECORD.
  9186
  9187*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9188
  9189     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9190         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9191                                              0199-READ-ACCOUNT-X
  9192         GO TO 0400-WRITE-CERT-RECORD.
  9193
  9194     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9195        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9196         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9197                                              0199-READ-ACCOUNT-X
  9198         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 179
* ECS010.cbl
  9199
  9200*     DISPLAY ' BEFORE REIN '
  9201     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9202*     DISPLAY ' AFTER REIN '
  9203
  9204     IF CR-LFTYP = ZEROS  AND
  9205        CR-DTHEXP NOT = ZEROS
  9206         ADD +1                     TO W-LFTYP-99
  9207         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9208         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9209
  9210     IF CR-AHTYP = ZEROS  AND
  9211        CR-DISEXP NOT = ZEROS
  9212         ADD +1                     TO W-AHTYP-99
  9213         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9214         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9215
  9216*     DISPLAY ' BEFORE EP BUMP'
  9217     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9218*     DISPLAY ' AFTER EP BUMP'
  9219
  9220      if (dte-client = 'DCC')
  9221         and (ws-dcc-cnc-flag = 'Y')
  9222         write new-detail-extract
  9223      end-if
  9224
  9225     IF CR-LFTYP = '99'
  9226         MOVE '00'                  TO CR-LFTYP.
  9227     IF CR-AHTYP = '99'
  9228         MOVE '00'                  TO CR-AHTYP.
  9229
  9230*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9231*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9232
  9233     IF CR-NH-INT-ON-REF NOT NUMERIC
  9234         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9235     END-IF
  9236
  9237     IF  CR-POLICY-IS-ACTIVE
  9238         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9239         IF  CR-POLICY-IS-REISSUE
  9240             OR CR-POLICY-IS-MONTHLY
  9241             ADD +1              TO W-POLICY-REISSUE-CTR
  9242         ELSE
  9243             IF  CR-POLICY-IS-REIN-ONLY
  9244                 ADD +1          TO W-POLICY-REIN-CTR
  9245             ELSE
  9246                 NEXT SENTENCE
  9247     ELSE
  9248         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9249
  9250     IF DTE-PGM-OPT = '1'
  9251       IF REIN-IS-RISK-PREMIUM  AND
  9252          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9253         IF NOT CR-POLICY-IS-REISSUE  AND
  9254            NOT CR-POLICY-IS-DECLINED  AND
  9255            NOT CR-POLICY-IS-VOID
  9256            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 180
* ECS010.cbl
  9257             MOVE '*'            TO RISK-PREM-FLAG
  9258             PERFORM 3100-REINSURE-ISSUE THRU
  9259                     3199-REINSURE-ISSUE-X.
  9260
* 9261     COPY ELCCRTM2.
  9262******************************************************************04/16/98
  9263*                                                                *ELCCRTM2
  9264*                                                                *ELCCRTM2
  9265*                            ELCCRTM2                            *   LV004
  9266*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9267*                            VMOD=2.001                          *ELCCRTM2
  9268*                                                                *ELCCRTM2
  9269*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9270*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9271*                                                                *ELCCRTM2
  9272******************************************************************ELCCRTM2
  9273     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9274     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9275     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9276     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9277     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9278     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9279                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9280     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9281     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9282     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9283     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9284                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9285     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9286     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9287     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9288     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9289     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9290                                                                     CL**4
  9291     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9292                UNTIL COPY-NDX > 5                                   CL**4
  9293           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9294                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9295     END-PERFORM.                                                 ELCCRTM2
  9296                                                                  ELCCRTM2
  9297
  9298     IF DTE-PGM-OPT = '1'
  9299         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9300         ADD +1 TO CMOT-CNT.
  9301
  9302     move zeros                  to ueclp-clp-fact
  9303     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9304                                    RISK-REIN-FLAG
  9305                                    RISK-PREM-FLAG
  9306                                    RC-COMM-FLG.
  9307
  9308 0499-WRITE-CERT-X.
  9309     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 181
* ECS010.cbl
  9311******************************************************************
  9312***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9313******************************************************************
  9314
  9315 0500-APPLY-PENDING-BUSINESS.
  9316
  9317     IF CANCEL-TRANSACTION
  9318*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9319         GO TO 0600-PROCESS-CANCELLATIONS.
  9320
  9321     IF CLAIM-TRANSACTION
  9322*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9323         GO TO 0700-PROCESS-CLAIMS.
  9324
  9325     IF RESERVE-TRANSACTION
  9326*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9327         GO TO 0800-PROCESS-RESERVES.
  9328
  9329     IF UPDATE-TRANSACTION
  9330*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9331         GO TO 0900-PROCESS-CERT-CHANGES.
  9332
  9333******************************************************************
  9334***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9335******************************************************************
  9336
  9337 0505-PROCESS-ISSUES.
  9338
  9339     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9340     PERFORM CERT-DATE-LOAD.
  9341
  9342     ADD +1                      TO  W-POL-ISSUES.
  9343
  9344     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9345     MOVE PB-CARRIER             TO  CR-CARRIER.
  9346     MOVE PB-GROUPING            TO  CR-GROUPING.
  9347     MOVE PB-STATE               TO  CR-STATE.
  9348     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9349     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9350                                     WS-CR-BIN-DATE
  9351     MOVE ' '                    TO  DC-OPTION-CODE.
  9352     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9353     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9354                                     WS-CR-DT-N.
  9355     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9356
  9357*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9358     MOVE PB-I-NAME              TO  CR-NAME.
  9359     MOVE PB-I-AGE               TO  CR-AGE.
  9360     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9361     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9362
  9363     IF PB-I-JOINT-COVERAGE
  9364         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9365         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9366     ELSE
  9367        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9368           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 182
* ECS010.cbl
  9369             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9370
  9371     IF PB-I-SUMMARY  OR
  9372        DTE-CLIENT = 'DMD'
  9373         MOVE PB-I-LIVES         TO  CR-LIVES.
  9374
  9375     IF PB-I-NUM-BILLED NOT NUMERIC
  9376        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9377
  9378     IF PB-I-STATE-TAX NOT NUMERIC
  9379        MOVE ZEROS               TO PB-I-STATE-TAX.
  9380
  9381     IF PB-I-MUNI-TAX NOT NUMERIC
  9382        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9383     IF PB-I-TOT-FEES NOT NUMERIC
  9384        MOVE ZEROS               TO PB-I-TOT-FEES
  9385     END-IF
  9386     IF PB-I-ADDL-CLP NOT NUMERIC
  9387        MOVE ZEROS               TO PB-I-ADDL-CLP
  9388     END-IF
  9389
  9390     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9391     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9392     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9393     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9394     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9395     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9396     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9397     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9398     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9399     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9400     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9401     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9402     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9403
  9404     IF PB-I-RATE-CLASS-OVRD = SPACES
  9405         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9406     ELSE
  9407         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9408
  9409     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9410     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9411
  9412     IF PB-I-INDV-GRP-OVRD = SPACES
  9413         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9414     ELSE
  9415         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9416
  9417     IF CR-IND-GRP = 'I'  OR  '1'
  9418         MOVE '1'                TO  CR-IND-GRP
  9419     ELSE
  9420         MOVE '2'                TO  CR-IND-GRP.
  9421
  9422     IF PB-I-SKIP-CODE = '1'
  9423         MOVE 01                 TO  CR-SKIP.
  9424     IF PB-I-SKIP-CODE = '2'
  9425         MOVE 02                 TO  CR-SKIP.
  9426     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 183
* ECS010.cbl
  9427         MOVE 03                 TO  CR-SKIP.
  9428     IF PB-I-SKIP-CODE = '4'
  9429         MOVE 04                 TO  CR-SKIP.
  9430     IF PB-I-SKIP-CODE = '5'
  9431         MOVE 05                 TO  CR-SKIP.
  9432     IF PB-I-SKIP-CODE = '6'
  9433         MOVE 06                 TO  CR-SKIP.
  9434     IF PB-I-SKIP-CODE = '7'
  9435         MOVE 07                 TO  CR-SKIP.
  9436     IF PB-I-SKIP-CODE = '8'
  9437         MOVE 08                 TO  CR-SKIP.
  9438     IF PB-I-SKIP-CODE = '9'
  9439         MOVE 09                 TO  CR-SKIP.
  9440     IF PB-I-SKIP-CODE = 'A'
  9441         MOVE 10                 TO  CR-SKIP.
  9442     IF PB-I-SKIP-CODE = 'X'
  9443         MOVE 11                 TO  CR-SKIP.
  9444
  9445     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9446     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9447     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9448
  9449     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9450         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9451                                        REIN-SPEC-A
  9452                                        REIN-SPEC-B
  9453                                        REIN-SPEC-C
  9454         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9455     ELSE
  9456         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9457
  9458     IF DTE-CLIENT = 'DCC'
  9459        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9460        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9461           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9462        END-IF
  9463     END-IF
  9464
  9465     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9466     MOVE ' '                    TO  DC-OPTION-CODE.
  9467     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9468     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9469
  9470     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9471
  9472     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9473         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9474     ELSE
  9475         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9476
  9477     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9478         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9479
  9480     IF PB-BATCH-ENTRY = SPACE  OR
  9481        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9482         MOVE '1'                TO  CR-ENTRY-STATUS
  9483     ELSE
  9484         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 184
* ECS010.cbl
  9485
  9486     IF PB-POLICY-IS-DECLINED
  9487         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9488
  9489     IF PB-POLICY-IS-VOIDED
  9490         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9491
  9492***  IF DTE-CLIENT NOT = 'CRI'
  9493***      IF PB-I-PREM-ACCTNG-ONLY
  9494***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9495
  9496     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9497                                     WS-CR-ENTRY-DATE-N.
  9498
  9499*    IF PB-I-MICROFILM-NO NUMERIC
  9500*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9501
  9502     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9503        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9504        OR 'AHL'
  9505         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9506     END-IF
  9507
  9508*************************************************
  9509***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9510***  WAS CONVERTED TO 1056 BYTES.             ***
  9511*************************************************
  9512     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9513     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9514
  9515     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9516
  9517     MOVE CR-STATE               TO STATE-L.
  9518
  9519     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9520
  9521     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9522
  9523***************************************************
  9524***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9525***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9526***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9527***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9528***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9529***************************************************
  9530     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9531         IF CR-LF-POLICY-IS-RESTORE
  9532             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9533             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9534         ELSE
  9535         IF CR-LF-POLICY-IS-REISSUE
  9536             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9537             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9538         ELSE
  9539         IF CR-LF-IS-REIN-ONLY
  9540             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9541             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9542         ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 185
* ECS010.cbl
  9543         IF CR-LF-IS-DECLINED
  9544             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9545             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9546         ELSE
  9547         IF CR-LF-IS-VOID
  9548             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9549             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9550         ELSE
  9551         IF CR-LF-POLICY-IS-MONTHLY
  9552            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9553            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9554
  9555
  9556 0510-PROCESS-LIFE-ISSUE.
  9557
  9558     IF PB-INVALID-LIFE
  9559         GO TO 0520-PROCESS-A-H-ISSUE.
  9560
  9561     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9562     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9563     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9564
  9565     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9566     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9567     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9568     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9569     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9570     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9571
  9572     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9573     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9574     IF PB-I-LF-POLICY-FEE  NUMERIC
  9575         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9576     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9577     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9578
  9579     IF PB-I-LF-PREM-TAX NUMERIC
  9580        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9581     END-IF
  9582
  9583
  9584     IF PB-I-LF-REI-RATE NOT = ZEROS
  9585        IF DTE-CLIENT = 'DCC'
  9586           CONTINUE
  9587*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9588        ELSE
  9589           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9590           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9591                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9592        END-IF
  9593     END-IF
  9594
  9595     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9596         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9597         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9598         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9599         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9600         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 186
* ECS010.cbl
  9601             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9602                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9603
  9604     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9605     MOVE ' '                    TO  DC-OPTION-CODE.
  9606     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9607     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9608                                     WS-CR-LF-EXPIRE-DATE-N.
  9609
  9610     IF CR-ENTRY-STATUS = 'P'
  9611         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9612     ELSE
  9613         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9614
  9615     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9616     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9617     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9618     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9619     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9620
  9621     IF CR-LF-POLICY-IS-RESTORE
  9622         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9623     IF CR-LF-POLICY-IS-REISSUE
  9624         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9625     IF CR-LF-IS-REIN-ONLY
  9626         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9627
  9628     IF CR-LF-IS-DECLINED
  9629         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9630
  9631     IF CR-LF-IS-VOID
  9632         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9633     IF CR-LF-POLICY-IS-MONTHLY
  9634         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9635
  9636     ADD +1                      TO  W-LF-ISSUES.
  9637
  9638 0520-PROCESS-A-H-ISSUE.
  9639
  9640     IF PB-INVALID-AH
  9641         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9642
  9643     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9644     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9645     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9646
  9647     IF (NOT PB-I-JOINT-COVERAGE)
  9648        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9649        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9650        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9651     END-IF
  9652
  9653     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9654     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9655     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9656     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9657     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9658
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 187
* ECS010.cbl
  9659     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9660     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9661     IF PB-I-AH-POLICY-FEE  NUMERIC
  9662         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9663     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9664     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9665
  9666     IF PB-I-AH-PREM-TAX NUMERIC
  9667        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9668     END-IF
  9669
  9670     IF PB-I-AH-REI-RATE NOT = ZEROS
  9671        IF DTE-CLIENT = 'DCC'
  9672           CONTINUE
  9673        ELSE
  9674           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9675           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9676             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9677        END-IF
  9678     END-IF
  9679
  9680     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9681        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9682           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9683           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9684        END-IF
  9685        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9686     END-IF
  9687     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9688     MOVE ' '                    TO  DC-OPTION-CODE.
  9689     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9690     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9691                                     WS-CR-AH-EXPIRE-DATE-N.
  9692
  9693     IF CR-ENTRY-STATUS = 'P'
  9694         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9695     ELSE
  9696         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9697
  9698     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9699     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9700     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9701     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9702     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9703
  9704     IF CR-AH-POLICY-IS-RESTORE
  9705         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9706     IF CR-AH-POLICY-IS-REISSUE
  9707         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9708     IF CR-AH-IS-REIN-ONLY
  9709         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9710
  9711     IF CR-AH-IS-DECLINED
  9712         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9713
  9714     IF CR-AH-IS-VOID
  9715         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9716     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 188
* ECS010.cbl
  9717         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9718
  9719     ADD +1                      TO  W-AH-ISSUES.
  9720
  9721 0530-PROCESS-ISSUE-CONTINUED.
  9722
  9723     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9724     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9725     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9726     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9727
  9728     IF (DTE-CLIENT = 'DCC')
  9729        AND (CR-AHTYP NOT = '00' AND '  ')
  9730        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9731        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9732           PERFORM 0920-GET-BANK-FEES
  9733                                 THRU 0920-EXIT
  9734           PERFORM 0930-BUILD-CERT-TRLR
  9735                                 THRU 0930-EXIT
  9736           PERFORM 0395-GET-CERT-TRLRS
  9737                                 THRU 0395-EXIT
  9738     END-IF
  9739
  9740     IF DTE-CLIENT = 'DCC'
  9741        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9742           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9743        END-IF
  9744        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9745           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9746              (CR-LFPRM + CR-LFPRM-ALT) -
  9747              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9748        END-IF
  9749     END-IF
  9750
  9751     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9752        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9753        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9754     ELSE
  9755        IF DTE-CLIENT = 'DCC'
  9756           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9757              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9758              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9759           END-IF
  9760           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9761              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9762              (CR-AHPRM * CR-LCOM-AH (1))
  9763           END-IF
  9764        END-IF
  9765     END-IF
  9766
  9767     IF DTE-CLIENT = 'DCC'
  9768         IF PB-I-VIN > SPACES
  9769             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9770         END-IF
  9771     END-IF.
  9772
  9773     IF CR-ENTRY-STATUS = 'P'
  9774         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 189
* ECS010.cbl
  9775
  9776     IF CR-POLICY-IS-REISSUE  OR
  9777        CR-POLICY-IS-REIN-ONLY OR
  9778        CR-POLICY-IS-DECLINED OR
  9779        CR-POLICY-IS-VOID
  9780        OR CR-POLICY-IS-MONTHLY
  9781         GO TO 0590-END-ISSUE-PROCESSING.
  9782
  9783     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9784     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9785        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9786     END-IF
  9787     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9788
  9789     IF NOT PB-INVALID-LIFE
  9790         COMPUTE H-LFCM ROUNDED =
  9791                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9792         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9793         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9794
  9795     IF NOT PB-INVALID-AH
  9796        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9797           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9798              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9799              + CR-ADDL-CLP)
  9800           ELSE
  9801              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9802              - CR-ADDL-CLP
  9803           END-IF
  9804        ELSE
  9805           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9806        END-IF
  9807        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9808        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9809     END-IF
  9810
  9811     ADD +1 TO BC-G-ISS.
  9812     ADD +1 TO BC-COMM.
  9813     ADD CR-LFPRM TO BC-NET-WRIT.
  9814     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9815        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9816     END-IF
  9817     ADD CR-AHPRM TO BC-NET-WRIT.
  9818
  9819     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9820        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9821        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9822     ELSE
  9823        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9824        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9825           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9826        END-IF
  9827     END-IF
  9828
  9829     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9830         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9831     ELSE
  9832         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 190
* ECS010.cbl
  9833
  9834 0590-END-ISSUE-PROCESSING.
  9835
  9836     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9837
  9838     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9839
  9840     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9841        NOT CR-POLICY-IS-DECLINED  AND
  9842        NOT CR-POLICY-IS-VOID
  9843         MOVE 'Y' TO BILLED-SWITCH
  9844         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9845         IF DTE-CLIENT = 'DCC'
  9846            move detail-extract  to new-detail-extract
  9847            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9848               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9849                  cr-addl-clp
  9850            end-if
  9851            write new-detail-extract
  9852         end-if
  9853
  9854     IF NOT CR-POLICY-IS-REISSUE  AND
  9855        NOT CR-POLICY-IS-DECLINED  AND
  9856        NOT CR-POLICY-IS-VOID
  9857        AND NOT CR-POLICY-IS-MONTHLY
  9858         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9859
  9860     MOVE '*'                   TO TRANSACTION-FLAG.
  9861     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 191
* ECS010.cbl
  9863******************************************************************
  9864***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9865******************************************************************
  9866
  9867 0600-PROCESS-CANCELLATIONS.
  9868
  9869*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9870     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9871
  9872     IF AM-RECALC-COMM = ('Y' OR '1')
  9873        PERFORM 1600-RECALC-COMM-EXTR
  9874                                 THRU 1899-RECALC-COMM-EXTR-X
  9875        MOVE ' '                 TO RECALC-TYPE
  9876     END-IF
  9877
  9878     MOVE CR-LFRFND               TO LIFE-REFUND.
  9879     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9880     MOVE CR-AHRFND               TO A-H-REFUND.
  9881     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9882     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9883
  9884     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9885     IF CR-LFRFND NOT = ZEROS
  9886        IF CR-LFRFND-CALC = ZEROS
  9887           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9888                                    LIFE-REFUND-CALC
  9889        ELSE
  9890           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9891        END-IF
  9892     END-IF
  9893
  9894     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9895
  9896     IF CR-AHRFND-CALC = ZEROS
  9897        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9898                                    A-H-REFUND-CALC
  9899     ELSE
  9900        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9901     END-IF
  9902
  9903     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9904        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9905     ELSE
  9906        MOVE SPACES              TO CR-POST-CARD-IND
  9907     END-IF
  9908
  9909*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9910*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9911*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9912*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9913
  9914     IF PB-C-NH-INT-ON-REFS NUMERIC
  9915        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9916        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9917     END-IF
  9918     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9919
  9920     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 192
* ECS010.cbl
  9921        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9922
  9923     IF PB-CI-MUNI-TAX NOT NUMERIC
  9924        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9925
  9926     IF CR-CANCEL-STATE-TAX NUMERIC
  9927         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9928       ELSE
  9929         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9930
  9931     IF CR-CANCEL-MUNI-TAX NUMERIC
  9932         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9933       ELSE
  9934         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9935
  9936     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9937                                    MONTHS-DIFF-AH.
  9938
  9939     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9940
  9941 0630-PROCESS-LIFE-CANCEL.
  9942
  9943     IF CR-LFTYP = ZERO  OR
  9944        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9945         MOVE ZEROS               TO H-LFCM
  9946         GO TO 0650-PROCESS-A-H-CANCEL.
  9947
  9948     IF CR-LFRFND = +0
  9949        AND CR-DTHAMT > ZEROS
  9950        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
  9951        MOVE ZEROS               TO H-LFCM
  9952        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
  9953        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
  9954        GO TO 0650-PROCESS-A-H-CANCEL
  9955     END-IF
  9956
  9957     IF DTE-CLIENT = 'DCC'
  9958        IF PB-C-LF-RFND-CLP NUMERIC
  9959           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
  9960        END-IF
  9961     END-IF
  9962
  9963     IF PB-C-LF-PREM-TAX NUMERIC
  9964        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9965     END-IF
  9966     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9967     MOVE ' '                     TO  DC-OPTION-CODE.
  9968     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9969     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9970                                      WS-CR-LF-CANC-DT-N.
  9971
  9972
  9973     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9974     MOVE ' '                    TO DC-OPTION-CODE
  9975     PERFORM 8000-DATE-CONVERT-ROUTINE
  9976                                 THRU 8099-DATE-CONVERT-X
  9977     IF CR-LF-CNC-ENT-DT NOT NUMERIC
  9978        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 193
* ECS010.cbl
  9979     END-IF
  9980     IF NO-CONVERSION-ERROR
  9981        IF CR-LF-CNC-ENT-DT = ZEROS
  9982           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
  9983        END-IF
  9984     END-IF
  9985
  9986     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9987     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9988     MOVE '1'                     TO  DC-OPTION-CODE.
  9989     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9990     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9991                                      DC-ODD-DAYS-OVER
  9992                                      DC-ELAPSED-DAYS.
  9993     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9994     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9995
  9996     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9997         ADD  +1                  TO  MONTHS-DIFF-LF.
  9998
  9999     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10000
 10001     MOVE  ZEROS                  TO  SUB.
 10002
 10003 0635-LIFE-CHARGEBACK-LOOP.
 10004
 10005     ADD    +1                    TO  SUB.
 10006
 10007     IF  SUB  GREATER THAN  +10
 10008         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10009
 10010*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10011*** WE FULLY EARN THE FEE
 10012     IF CR-CANCEL-REASON = 'R'
 10013        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10014           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10015           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10016           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10017        END-IF
 10018     END-IF
 10019
 10020     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10021         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10022         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10023
 10024     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10025         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10026
 10027     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10028         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10029
 10030     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10031
 10032
 10033 0640-CONTINUE-LIFE-CANCEL.
 10034
 10035     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10036        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 194
* ECS010.cbl
 10037
 10038     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10039
 10040     IF DTE-CLIENT = 'GIC'
 10041         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10042             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10043                                     LIFE-REFUND-CALC.
 10044
 10045*    IF DTE-CLIENT = 'TMS'
 10046     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10047
 10048     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10049         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10050     ELSE
 10051         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10052             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10053             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10054             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10055             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10056                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10057         ELSE
 10058             IF CR-LF-CURRENT-STATUS = '6'
 10059                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10060                 MOVE PB-C-LF-COMM-CHARGEBACK
 10061                                       TO CR-LF-COMM-CHARGEBACK
 10062                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10063                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10064
 10065*************************************************
 10066***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10067***  WAS CONVERTED TO 1056 BYTES.             ***
 10068*************************************************
 10069     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10070
 10071     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10072     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10073     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10074
 10075     COMPUTE H-LFCM ROUNDED =
 10076                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10077     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10078
 10079     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10080     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10081     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10082     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10083
 10084     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10085     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10086
 10087 0650-PROCESS-A-H-CANCEL.
 10088
 10089     IF CR-AHTYP = ZERO  OR
 10090        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10091         MOVE ZEROS               TO H-AHCM
 10092         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10093
 10094*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 195
* ECS010.cbl
 10095*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10096*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10097*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10098
 10099     IF DTE-CLIENT = 'DCC'
 10100        IF PB-C-AH-RFND-CLP NUMERIC
 10101           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10102        END-IF
 10103     END-IF
 10104
 10105     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10106     MOVE ' '                     TO  DC-OPTION-CODE.
 10107     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10108     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10109                                      WS-CR-AH-CANC-DT-N.
 10110
 10111     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10112     MOVE ' '                    TO DC-OPTION-CODE
 10113     PERFORM 8000-DATE-CONVERT-ROUTINE
 10114                                 THRU 8099-DATE-CONVERT-X
 10115     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10116        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10117     END-IF
 10118     IF NO-CONVERSION-ERROR
 10119        IF CR-AH-CNC-ENT-DT = ZEROS
 10120           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10121        END-IF
 10122     END-IF
 10123
 10124     IF PB-C-AH-PREM-TAX NUMERIC
 10125        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10126     END-IF
 10127     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10128     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10129     MOVE '1'                     TO  DC-OPTION-CODE.
 10130     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10131     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10132                                      DC-ODD-DAYS-OVER
 10133                                      DC-ELAPSED-DAYS.
 10134     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10135     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10136
 10137     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10138          ADD  +1                 TO  MONTHS-DIFF-AH.
 10139
 10140     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10141                                      WS-DCC-DDF-CB-LEVELS
 10142     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10143        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10144     END-IF
 10145*    IF DTE-CLIENT = 'DCC'
 10146*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10147*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10148*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10149*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10150*             OR (SUB > +10)
 10151*          END-PERFORM
 10152*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 196
* ECS010.cbl
 10153*             MOVE CR-BANK-NOCHRGB-MONTHS
 10154*                                TO AM-COMM-CHARGEBACK (SUB)
 10155*          END-IF
 10156*       END-IF
 10157*    END-IF
 10158
 10159
 10160     MOVE 'Y'                     TO WS-FIRST-K
 10161     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10162     MOVE  ZEROS                  TO  SUB.
 10163
 10164 0653-A-H-CHARGEBACK-LOOP.
 10165
 10166     ADD    +1                    TO  SUB.
 10167
 10168     IF  SUB  GREATER THAN  +10
 10169         GO TO  0655-CONTINUE-A-H-CANCEL.
 10170
 10171     IF CR-CANCEL-REASON = 'R'
 10172        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10173           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10174              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10175              GO TO  0653-A-H-CHARGEBACK-LOOP
 10176           END-IF
 10177           IF AM-COM-TYP (SUB) = 'J'
 10178              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10179              GO TO  0653-A-H-CHARGEBACK-LOOP
 10180           END-IF
 10181        END-IF
 10182     END-IF
 10183
 10184     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10185         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10186         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10187
 10188     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10189         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10190
 10191     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10192         OR ((DTE-CLIENT = 'DCC')
 10193             AND (CR-AHRFND = ZEROS))
 10194         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10195
 10196     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10197
 10198
 10199 0655-CONTINUE-A-H-CANCEL.
 10200
 10201     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10202        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10203
 10204     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10205
 10206     IF DTE-CLIENT = 'GIC'
 10207         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10208             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10209                                     A-H-REFUND-CALC.
 10210
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 197
* ECS010.cbl
 10211*    IF DTE-CLIENT = 'TMS'
 10212     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10213*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10214
 10215
 10216     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10217         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10218     ELSE
 10219         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10220             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10221             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10222             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10223             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10224                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10225         ELSE
 10226             IF CR-AH-CURRENT-STATUS = '7'
 10227                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10228                 MOVE PB-C-AH-COMM-CHARGEBACK
 10229                                       TO CR-AH-COMM-CHARGEBACK
 10230                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10231                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10232
 10233*************************************************
 10234***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10235***  WAS CONVERTED TO 1056 BYTES.             ***
 10236*************************************************
 10237     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10238
 10239     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10240     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10241     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10242
 10243     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10244        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10245        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10246           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10247           MOVE CNC-FACT TO UECLP-CLP-FACT
 10248        END-IF
 10249        IF CR-CANCEL-REASON = 'R'
 10250           MOVE +1               TO CNC-FACT
 10251        END-IF
 10252        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10253           (CR-AHPRM - (CR-LFPRM-ALT
 10254           + CR-ADDL-CLP)) * -1
 10255     ELSE
 10256        COMPUTE H-AHCM ROUNDED =
 10257          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10258     END-IF
 10259
 10260     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10261
 10262     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10263     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10264     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10265     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10266
 10267     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10268     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 198
* ECS010.cbl
 10269
 10270 0660-PROCESS-CANCEL-CONTINUE.
 10271
 10272     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10273
 10274     IF CR-POLICY-IS-REIN-ONLY
 10275        GO TO 0660-CONT.
 10276
 10277     MOVE 'Y'                    TO BILLED-SWITCH.
 10278     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10279
 10280     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10281     if dte-client = 'DCC'
 10282        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10283     end-if
 10284
 10285     IF CR-POLICY-IS-MONTHLY
 10286        GO TO 0660-CONT
 10287     END-IF
 10288
 10289     ADD +1                      TO BC-G-CNC.
 10290     ADD +1                      TO BC-COMM.
 10291     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10292     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10293     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10294     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10295     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10296     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10297
 10298     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10299         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10300     ELSE
 10301         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10302
 10303     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10304         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10305     ELSE
 10306         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10307
 10308
 10309 0660-CONT.
 10310
 10311     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10312     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10313
 10314     IF CR-LFRFND NEGATIVE
 10315       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10316           MOVE '*'                 TO REIN-VOID-LF-SW.
 10317     IF CR-AHRFND NEGATIVE
 10318       IF CR-AHRFND + A-H-REFUND = ZEROS
 10319           MOVE '*'                 TO REIN-VOID-AH-SW.
 10320
 10321     IF CR-LFRFND NOT = ZEROS
 10322       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10323           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10324     IF CR-AHRFND NOT = ZEROS
 10325       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10326           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 199
* ECS010.cbl
 10327
 10328     IF CR-DT = CR-LF-CANC-DT
 10329       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10330     IF CR-DT = CR-AH-CANC-DT
 10331       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10332
 10333     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10334
 10335     MOVE SPACES                    TO REIN-VOID-LF-SW
 10336                                       REIN-VOID-AH-SW
 10337                                       REIN-ADDL-LF-SW
 10338                                       REIN-ADDL-AH-SW.
 10339
 10340     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10341     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10342
 10343     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10344     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10345
 10346     IF (CR-LFTYP NOT = ZERO  AND
 10347        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10348        (CR-AHTYP NOT = ZERO  AND
 10349        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10350         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10351         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10352
 10353 0670-LIFE-CANCEL-VOID.
 10354
 10355     IF CR-LFTYP NOT = ZERO  AND
 10356        CR-LFRFND = ZERO  AND
 10357        PB-C-LF-CANCEL-AMT NEGATIVE
 10358         NEXT SENTENCE
 10359     ELSE
 10360         GO TO 0680-A-H-CANCEL-VOID.
 10361
 10362     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10363                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10364                                          CR-LF-CANC-DT
 10365                                          WS-CR-LF-CANC-DT-N
 10366                                          CR-LFRFND-CALC.
 10367
 10368     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10369
 10370     IF CR-LF-CANCEL-APPLIED
 10371         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10372         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10373     ELSE
 10374         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10375         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10376
 10377     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10378
 10379     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10380     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10381
 10382     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10383
 10384 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 200
* ECS010.cbl
 10385
 10386     IF CR-AHTYP NOT = ZERO  AND
 10387        CR-AHRFND = ZERO  AND
 10388        PB-C-AH-CANCEL-AMT NEGATIVE
 10389         NEXT SENTENCE
 10390     ELSE
 10391         GO TO 0690-END-CANCEL-PROCESSING.
 10392
 10393     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10394                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10395                                        CR-AH-CANC-DT
 10396                                        WS-CR-AH-CANC-DT-N
 10397                                        CR-AHRFND-CALC.
 10398
 10399     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10400
 10401     IF CR-AH-CANCEL-APPLIED
 10402         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10403         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10404     ELSE
 10405         MOVE CR-AH-STATUS-AT-CANCEL
 10406                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10407         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10408
 10409     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10410
 10411     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10412     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10413
 10414     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10415
 10416 0690-END-CANCEL-PROCESSING.
 10417
 10418     IF CR-LF-CANC-DT = ZEROS  AND
 10419        CR-AH-CANC-DT = ZEROS
 10420         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10421     END-IF
 10422
 10423     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10424         NEXT SENTENCE
 10425     ELSE
 10426         MOVE 'X'               TO REIN-RT-SW
 10427         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10428         MOVE ' '               TO REIN-RT-SW.
 10429
 10430     MOVE '*'                   TO TRANSACTION-FLAG.
 10431     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10432
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 201
* ECS010.cbl
 10434******************************************************************
 10435***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10436******************************************************************
 10437
 10438 0700-PROCESS-CLAIMS.
 10439
 10440     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10441        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10442         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10443             PENDING-MATCH-CONTROL
 10444         MOVE 0301 TO WS-ABEND-CODE
 10445         DISPLAY '******************************'
 10446         DISPLAY '***** ERROR LOCATION 011 *****'
 10447         DISPLAY '******************************'
 10448         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10449         GO TO ABEND-PGM.
 10450
 10451     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10452
 10453     ADD +1                       TO  W-LF-CLAIMS.
 10454
 10455     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10456     MOVE ' '                     TO  DC-OPTION-CODE.
 10457     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10458     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10459
 10460     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10461     MOVE ' '                     TO  DC-OPTION-CODE.
 10462     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10463     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10464
 10465     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10466     MOVE ' '                     TO  DC-OPTION-CODE.
 10467     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10468     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10469
 10470     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10471     MOVE ' '                     TO  DC-OPTION-CODE.
 10472     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10473     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10474
 10475     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10476
 10477**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10478****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10479****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10480****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10481****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10482****     ELSE
 10483****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10484
 10485     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10486         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10487
 10488******************************************************************
 10489***           P R O C E S S   D E A T H   C L A I M            ***
 10490******************************************************************
 10491
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 202
* ECS010.cbl
 10492     IF REIN-IS-RISK-PREMIUM
 10493       IF CR-DTH-DT = ZEROS
 10494           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10495           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10496           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10497
 10498     MOVE INCURRED-DATE            TO CR-DTH-DT
 10499                                      WS-CR-DTH-DT-N.
 10500
 10501     IF PC-CHARGEBLE-EXPENSE  OR
 10502        PC-NON-CHARGEBLE-EXPENSE
 10503         IF CR-LFTYP = '00'
 10504             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10505             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10506                     8399-LIFE-LOOKUP-X.
 10507
 10508     IF PC-CHARGEBLE-EXPENSE  OR
 10509        PC-NON-CHARGEBLE-EXPENSE
 10510         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10511         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10512         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10513         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10514         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10515         GO TO 0780-END-CLAIMS-PROCESSING.
 10516
 10517     ADD +1                       TO  CR-NUM-DTH-CLM.
 10518     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10519     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10520                                      WS-CR-DTH-PAY-DT-N.
 10521
 10522     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10523     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10524     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10525     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10526     IF CR-DTH-PAY-CD NOT = 'F'
 10527         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10528     INSPECT CR-DTH-PAY-CD
 10529         CONVERTING '12349' TO 'PFSXV'.
 10530     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10531
 10532     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10533         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10534       AND
 10535       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10536       OR
 10537        DTE-CLIENT = 'ACC' OR 'FDL')
 10538        NEXT SENTENCE
 10539     ELSE
 10540     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10541         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10542             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10543             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10544             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10545                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10546
 10547     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10548     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10549     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 203
* ECS010.cbl
 10550     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10551         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10552     ELSE
 10553         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10554     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10555
 10556     IF NOT CR-POLICY-IS-REIN-ONLY
 10557         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10558
 10559 0720-CANCEL-AH-COVERAGE.
 10560
 10561     IF CR-AHTYP = ZEROS  OR
 10562        NOT CR-AH-POLICY-IS-ACTIVE
 10563         GO TO 0740-DEATH-CLAIM-VOID.
 10564
 10565     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10566     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10567     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10568                                           WS-CR-AH-CANC-DT-N.
 10569     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10570                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10571
 10572     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10573     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10574     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10575     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10576     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10577     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10578     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10579     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10580
 10581 0740-DEATH-CLAIM-VOID.
 10582
 10583     IF CR-DTHAMT = ZERO  AND
 10584        PC-CLAIM-PAYMENT NEGATIVE
 10585         NEXT SENTENCE
 10586     ELSE
 10587         GO TO 0780-END-CLAIMS-PROCESSING.
 10588
 10589     MOVE '*'                           TO DEATH-VOID-FLAG.
 10590
 10591     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10592                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10593                                           CR-NUM-DTH-CLM
 10594                                           CR-DTH-RPT-DT
 10595                                           CR-DTH-PAY-DT
 10596                                           WS-CR-DTH-PAY-DT-N
 10597*                                          CR-DTHAMT-YTD
 10598*                                          CR-DTHAMT-LAST
 10599                                           CR-DTH-AGE.
 10600     MOVE ' '                           TO CR-DTH-PAY-CD.
 10601
 10602     IF CR-LF-DEATH-CLAIM-APPLIED
 10603         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10604         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10605     ELSE
 10606         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10607         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 204
* ECS010.cbl
 10608
 10609     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10610     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10611
 10612     IF CR-AH-DEATH-CLAIM-APPLIED
 10613         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10614         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10615         MOVE ZEROS                     TO CR-AH-CANC-DT
 10616                                           WS-CR-AH-CANC-DT-N
 10617                                           CR-AH-CANCEL-EXIT-DATE
 10618                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10619         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10620         MOVE CR-AH-TERM                TO TRD-AHTRM
 10621         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10622         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10623
 10624     GO TO 0780-END-CLAIMS-PROCESSING.
 10625
 10626******************************************************************
 10627***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10628******************************************************************
 10629
 10630 0750-PROCESS-DISABILITY-CLAIM.
 10631
 10632     ADD +1                       TO W-AH-CLAIMS.
 10633
 10634     MOVE INCURRED-DATE           TO CR-DIS-DT
 10635                                     WS-CR-DIS-DT-N.
 10636
 10637     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10638
 10639     IF REIN-AH-CLM-MONTHS = +1
 10640         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10641     ELSE
 10642       IF REIN-AH-CLM-MONTHS = +2
 10643           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10644       ELSE
 10645         IF REIN-AH-CLM-MONTHS = +3
 10646             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10647         ELSE
 10648           IF REIN-AH-CLM-MONTHS = +4
 10649               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10650           ELSE
 10651               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10652
 10653     IF PC-CHARGEBLE-EXPENSE  OR
 10654        PC-NON-CHARGEBLE-EXPENSE
 10655         IF CR-AHTYP = '00'
 10656             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10657             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10658                     8499-A-H-LOOKUP-X.
 10659
 10660     IF PC-CHARGEBLE-EXPENSE  OR
 10661        PC-NON-CHARGEBLE-EXPENSE
 10662         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10663         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10664         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10665         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 205
* ECS010.cbl
 10666         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10667         GO TO 0780-END-CLAIMS-PROCESSING.
 10668
 10669     ADD +1                       TO CR-NUM-DIS-CLM.
 10670
 10671     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10672     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10673                                      WS-CR-DIS-PAY-DT-N.
 10674     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10675                                      WS-CR-DIS-PTO-DT-N.
 10676
 10677     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10678     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10679     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10680
 10681     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10682     IF CR-DIS-PAY-CD NOT = 'S'
 10683         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10684     INSPECT CR-DIS-PAY-CD
 10685         CONVERTING '12349' TO 'PFSXV'.
 10686     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10687
 10688     IF PC-LUMP-SUM-PAYMENT
 10689         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10690           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10691           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10692           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10693                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10694
 10695     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10696     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10697     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10698     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10699     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10700
 10701     IF NOT CR-POLICY-IS-REIN-ONLY
 10702         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10703
 10704     IF NOT PC-LUMP-SUM-PAYMENT
 10705         GO TO 0780-END-CLAIMS-PROCESSING.
 10706
 10707 0770-CANCEL-LF-COVERAGE.
 10708
 10709     IF CR-LFTYP = ZEROS  OR
 10710        NOT CR-LF-POLICY-IS-ACTIVE
 10711         GO TO 0780-END-CLAIMS-PROCESSING.
 10712
 10713     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10714     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10715     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10716                                           WS-CR-LF-CANC-DT-N.
 10717     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10718                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10719
 10720     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10721     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10722     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10723     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 206
* ECS010.cbl
 10724     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10725     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10726     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10727     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10728
 10729 0780-END-CLAIMS-PROCESSING.
 10730
 10731     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10732         MOVE DTO-MO               TO TRD-LFACTMO
 10733         MOVE DTO-DA               TO TRD-LFACTDA
 10734         MOVE DTO-YR               TO TRD-LFACTYR
 10735         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10736     ELSE
 10737         MOVE PAY-MO               TO TRD-AHACTMO
 10738         MOVE PAY-DA               TO TRD-AHACTDA
 10739         MOVE PAY-YR               TO TRD-AHACTYR
 10740         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10741
 10742     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10743
 10744     IF NOT CR-POLICY-IS-REIN-ONLY
 10745         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10746         ADD +1                    TO BC-G-CLM.
 10747
 10748     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10749
 10750     IF DEATH-CLAIM-VOIDED
 10751         MOVE ZEROS                TO CR-DTH-DT
 10752                                      WS-CR-DTH-DT-N.
 10753     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10754
 10755     MOVE '*'                      TO TRANSACTION-FLAG.
 10756     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10757
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 207
* ECS010.cbl
 10759 0790-TABLE-DISAB-PERIODS.
 10760
 10761     MOVE +1                       TO SUB14.
 10762     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10763
 10764     MOVE +1                       TO SUB14.
 10765
 10766**************************************************************
 10767**                                                          **
 10768**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10769**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10770**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10771**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10772**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10773**                                                          **
 10774**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10775**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10776**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10777**                                                          **
 10778**************************************************************
 10779
 10780 0791-TABLE-AH-AMOUNT.
 10781
 10782     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10783         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10784
 10785     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10786         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10787                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10788         IF REIN-IS-RISK-PREMIUM
 10789             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10790             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10791             IF SUB14 = +1
 10792               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10793             ELSE
 10794             IF SUB14 = +2
 10795               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10796             ELSE
 10797             IF SUB14 = +3
 10798               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10799             ELSE
 10800             IF SUB14 = +4
 10801               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10802             ELSE
 10803               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10804
 10805
 10806     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10807         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10808         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10809                                        +  CR-INCUR-DISEXP (SUB14)
 10810         IF PC-CHARGEBLE-EXPENSE  OR
 10811            PC-NON-CHARGEBLE-EXPENSE
 10812             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10813             GO TO 0791-TABLE-AH-EXIT
 10814         ELSE
 10815             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10816             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 208
* ECS010.cbl
 10817
 10818     ADD +1                       TO SUB14.
 10819
 10820     GO TO 0791-TABLE-AH-AMOUNT.
 10821
 10822 0791-TABLE-AH-EXIT.
 10823     EXIT.
 10824
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 209
* ECS010.cbl
 10826**************************************************************
 10827**                                                          **
 10828** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10829** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10830**                                                          **
 10831** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10832** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10833** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10834** OCCURRENCE.                                              **
 10835**************************************************************
 10836 0792-MOVE-TABLE.
 10837
 10838     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10839                                  WS-CR-DIS-INCUR-DT-N (1).
 10840     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10841     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10842
 10843     MOVE +2                   TO SUB14.
 10844     MOVE +3                   TO SUB15.
 10845     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10846
 10847     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10848
 10849     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10850                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10851
 10852 0792-MOVE-TABLE-EXIT.
 10853     EXIT.
 10854
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 210
* ECS010.cbl
 10856**************************************************************
 10857**                                                          **
 10858**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10859** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10860** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10861** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10862** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10863**************************************************************
 10864
 10865 0794-REVIEW-TABLE.
 10866
 10867     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10868         GO TO 0794-REVIEW-TABLE-EXIT.
 10869
 10870     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10871         GO TO 0794-REVIEW-TABLE-EXIT.
 10872
 10873     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10874        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10875         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10876         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10877                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10878         MOVE SUB14            TO SUB15
 10879         ADD +1                TO SUB15
 10880         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10881         MOVE +1               TO SUB14
 10882         GO TO 0794-REVIEW-TABLE.
 10883
 10884     ADD +1                    TO SUB14.
 10885
 10886     GO TO 0794-REVIEW-TABLE.
 10887
 10888 0794-REVIEW-TABLE-EXIT.
 10889     EXIT.
 10890
 10891 0794A-BUMP-TBL.
 10892
 10893     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10894         GO TO 0794A-BUMP-TBL-EXIT.
 10895
 10896     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10897                             CR-DISAB-DETAIL-DATA (SUB14).
 10898     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10899                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10900
 10901     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10902                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10903                                  CR-INCUR-DISAMT (SUB15)
 10904                                  CR-INCUR-DISEXP (SUB15).
 10905
 10906     ADD +1                    TO SUB14
 10907                                  SUB15.
 10908     GO TO 0794A-BUMP-TBL.
 10909
 10910 0794A-BUMP-TBL-EXIT.
 10911     EXIT.
 10912
 10913 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 211
* ECS010.cbl
 10914
 10915     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10916     MOVE 'L'                        TO DC-OPTION-CODE.
 10917     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10918     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10919     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10920     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10921     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10922     MOVE CR-APR                     TO CP-LOAN-APR.
 10923     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10924     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10925     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10926     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10927
 10928     MOVE '3'                        TO CP-PROCESS-TYPE.
 10929     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10930     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10931
 10932     IF CR-LFTYP = ZERO
 10933         GO TO 0795-EXIT
 10934     END-IF
 10935
 10936     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10937         GO TO 0795-EXIT
 10938     END-IF
 10939     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10940     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10941     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10942     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10943                                        CP-RATING-BENEFIT-AMT.
 10944     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10945     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10946     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10947     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10948     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10949     MOVE CR-STATE                   TO CP-STATE.
 10950     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10951
 10952     IF CP-STATE-STD-ABBRV = 'OR'
 10953         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10954
 10955     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10956
 10957     IF CP-ERROR-RATE-NOT-FOUND  OR
 10958        CP-ERROR-RATE-IS-ZERO
 10959         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10960                                     TO WS-ABEND-MESSAGE
 10961         MOVE 0302                   TO WS-ABEND-CODE
 10962         DISPLAY '******************************'
 10963         DISPLAY '***** ERROR LOCATION 018 *****'
 10964         DISPLAY '******************************'
 10965         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10966         GO TO ABEND-PGM.
 10967
 10968     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10969
 10970*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10971*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 212
* ECS010.cbl
 10972
 10973     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 10974                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10975
 10976     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10977
 10978 0795-exit.
 10979     exit.
 10980
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 213
* ECS010.cbl
 10982******************************************************************
 10983***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10984******************************************************************
 10985
 10986 0800-PROCESS-RESERVES.
 10987
 10988     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10989       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10990           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10991
 10992     if (dte-client = 'AHL')
 10993        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 10994        and (cr-ahtyp (1:1) = 'M')
 10995        and ((pc-future-reserve-amt > zeros)
 10996            or (pc-ptc-reserve-amt > zeros))
 10997        compute pc-ibnr-reserve-amt =
 10998           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 10999        display ' using 205 of ptc and future ' cr-cert-no
 11000     end-if
 11001
 11002     if (dte-client = 'AHL')
 11003        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11004        and (cr-lftyp (1:1) = 'M')
 11005        and (pc-ptc-reserve-amt > zeros)
 11006        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11007        display ' using 217 of ptc ' cr-cert-no
 11008     end-if
 11009
 11010     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11011
 11012     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11013     MOVE ' '                     TO  DC-OPTION-CODE.
 11014     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11015     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11016
 11017     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11018     MOVE ' '                     TO  DC-OPTION-CODE.
 11019     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11020     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11021
 11022     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11023     MOVE ' '                     TO  DC-OPTION-CODE.
 11024     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11025     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11026
 11027     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11028
 11029     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11030         ADD +1                     TO W-LF-RESERVES
 11031         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11032         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11033         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11034         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11035         MOVE INCURRED-DATE         TO CR-DTH-DT
 11036                                       WS-CR-DTH-DT-N
 11037         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11038
 11039     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 214
* ECS010.cbl
 11040         ADD +1                     TO W-AH-RESERVES
 11041         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11042         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11043         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11044         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11045         MOVE INCURRED-DATE         TO CR-DIS-DT
 11046                                       WS-CR-DIS-DT-N
 11047         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11048
 11049     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11050     MOVE 'IBNR'                    TO TRD-IBNRX.
 11051     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11052     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11053     COMPUTE TRD-FUTRSV EQUAL
 11054            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11055     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11056     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11057
 11058 0820-END-RESERVE-PROCESSING.
 11059
 11060     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11061
 11062     IF NOT CR-POLICY-IS-REIN-ONLY
 11063         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11064                                            2499-BLD-RESERVE-X
 11065         ADD +1 TO BC-G-CRS.
 11066
 11067     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11068
 11069     MOVE '*'                    TO TRANSACTION-FLAG.
 11070     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11071
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 215
* ECS010.cbl
 11073******************************************************************
 11074***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11075******************************************************************
 11076
 11077 0900-PROCESS-CERT-CHANGES.
 11078
 11079     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11080
 11081     IF CC-AGE NOT NUMERIC  OR
 11082        CC-AGE = CR-AGE
 11083         MOVE ZEROS TO CC-AGE.
 11084
 11085     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11086        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11087         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11088
 11089     IF CC-INSURED-SEX NOT = 'M'  AND
 11090        CC-INSURED-SEX NOT = 'F'
 11091         MOVE SPACES TO CC-INSURED-SEX.
 11092
 11093     IF CC-LOAN-APR NOT NUMERIC  OR
 11094        CC-LOAN-APR = CR-APR
 11095         MOVE ZEROS TO CC-LOAN-APR.
 11096
 11097     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11098        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11099         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11100
 11101     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11102        CC-IND-GRP-TYPE NOT = '2'
 11103         MOVE SPACES TO CC-IND-GRP-TYPE.
 11104
 11105     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11106****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11107         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11108
 11109     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11110        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11111         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11112
 11113     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11114        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11115        CR-LFTYP = ZEROS
 11116         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11117
 11118     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11119        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11120        CR-AHTYP = ZEROS
 11121         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11122
 11123     IF CR-BILLED NOT NUMERIC
 11124         MOVE ZEROS TO CR-BILLED.
 11125
 11126     IF CR-LIVES NOT NUMERIC
 11127         MOVE ZEROS TO CR-LIVES.
 11128
 11129     IF CC-LIVES NOT NUMERIC  OR
 11130        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 216
* ECS010.cbl
 11131         MOVE ZEROS TO CC-LIVES.
 11132
 11133     IF CC-BILLED NOT NUMERIC  OR
 11134        CC-BILLED = CR-BILLED
 11135         MOVE ZEROS TO CC-BILLED.
 11136
 11137     IF CC-INSURED-LAST-NAME NOT = SPACES
 11138         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11139     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11140         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11141     IF CC-INSURED-INITIAL2 NOT = SPACES
 11142         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11143     IF CC-JT-LAST-NAME NOT = SPACES
 11144         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11145     IF CC-JT-FIRST-NAME NOT = SPACES
 11146         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11147     IF CC-JT-INITIAL NOT = SPACES
 11148         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11149
 11150     IF CC-AGE NOT = ZEROS
 11151         MOVE CC-AGE                 TO CR-AGE
 11152                                        DET-AGE
 11153     ELSE
 11154         MOVE ZEROS                  TO DET-AGE.
 11155
 11156     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11157         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11158                                        DET-JT-AGE
 11159     ELSE
 11160         MOVE ZEROS                  TO DET-JT-AGE.
 11161
 11162     IF CC-INSURED-SEX NOT = SPACES
 11163         MOVE CC-INSURED-SEX         TO CR-SEX
 11164                                        DET-SEX
 11165     ELSE
 11166         MOVE SPACE                  TO DET-SEX.
 11167
 11168     IF CC-MEMBER-NO NOT = SPACES
 11169         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11170                                        DET-PR-MEM
 11171     ELSE
 11172         MOVE SPACES                 TO DET-PR-MEM.
 11173
 11174     IF CC-SOC-SEC-NO NOT = SPACES
 11175         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11176                                        DET-PR-SS
 11177     ELSE
 11178         MOVE SPACES                 TO DET-PR-SS.
 11179
 11180     IF CC-LOAN-APR NOT = ZEROS
 11181         MOVE CC-LOAN-APR            TO CR-APR
 11182                                        DET-PR-APR
 11183     ELSE
 11184         MOVE ZEROS                  TO DET-PR-APR.
 11185
 11186     IF CC-AGE NOT = ZERO  OR
 11187        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11188        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 217
* ECS010.cbl
 11189        CC-MEMBER-NO NOT = SPACES  OR
 11190        CC-SOC-SEC-NO NOT = SPACES  OR
 11191        CC-LOAN-APR NOT = ZERO
 11192         MOVE DET-PR-UREC            TO TR-DTL2
 11193         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11194         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11195
 11196     IF CC-LF-ORIG-TERM NOT = ZEROS
 11197         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11198         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11199                                        DET-N-LF-TERM
 11200     ELSE
 11201         MOVE ZEROS                  TO DET-O-LF-TERM
 11202                                        DET-N-LF-TERM.
 11203
 11204     IF CC-AH-ORIG-TERM NOT = ZEROS
 11205         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11206         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11207                                        DET-N-AH-TERM
 11208     ELSE
 11209         MOVE ZEROS                  TO DET-O-AH-TERM
 11210                                        DET-N-AH-TERM.
 11211
 11212     IF CC-LIVES NOT = ZEROS
 11213         MOVE CR-LIVES               TO DET-O-LIVES
 11214         MOVE CC-LIVES               TO CR-LIVES
 11215                                        DET-N-LIVES
 11216     ELSE
 11217         MOVE ZEROS                  TO DET-O-LIVES
 11218                                        DET-N-LIVES.
 11219
 11220     IF CC-BILLED NOT  = ZEROES
 11221         MOVE CC-BILLED              TO CR-BILLED.
 11222
 11223     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11224        CC-AH-ORIG-TERM NOT = ZERO  OR
 11225        CC-LIVES NOT = ZERO
 11226         MOVE DET-PR-UREC-2          TO TR-DTL2
 11227         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11228         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11229
 11230     IF CC-IND-GRP-TYPE NOT = SPACES
 11231         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11232                                        DET-IND-GRP
 11233     ELSE
 11234         MOVE SPACE                  TO DET-IND-GRP.
 11235
 11236     IF CC-PAY-FREQUENCY NOT = ZEROS
 11237         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11238                                        DET-PMT-FREQ
 11239     ELSE
 11240         MOVE ZEROS                  TO DET-PMT-FREQ.
 11241
 11242     IF CC-POLICY-FORM-NO NOT = SPACES
 11243         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11244                                        DET-POL-FORM
 11245     ELSE
 11246         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 218
* ECS010.cbl
 11247
 11248     IF CC-LOAN-OFFICER NOT = SPACES
 11249         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11250                                        DET-LOAN-OFFICER
 11251     ELSE
 11252         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11253
 11254     IF CC-USER-FIELD NOT = SPACES
 11255         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11256                                        DET-USER-CODE
 11257     ELSE
 11258         MOVE SPACE                  TO DET-USER-CODE.
 11259
 11260     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11261        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11262        CC-POLICY-FORM-NO NOT = SPACES  OR
 11263        CC-LOAN-OFFICER NOT = SPACES  OR
 11264        CC-USER-FIELD NOT = SPACES
 11265         MOVE DET-PR-UREC-3          TO TR-DTL2
 11266         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11267         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11268
 11269**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11270****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11271****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11272****                                    DET-CLM-DEDUCT
 11273**** ELSE
 11274****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11275
 11276     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11277         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11278                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11279                                        DET-CAN-DEDUCT
 11280     ELSE
 11281         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11282
 11283**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11284     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11285         MOVE DET-PR-UREC-4          TO TR-DTL2
 11286         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11287         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11288
 11289     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11290         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11291
 11292     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11293         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11294
 11295     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11296         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11297
 11298     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11299         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11300
 11301     IF CC-LF-BENEFIT-CD NOT = SPACES
 11302         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11303                                     DET-LF-BEN-CD
 11304     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 219
* ECS010.cbl
 11305         MOVE SPACES             TO DET-LF-BEN-CD.
 11306
 11307     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11308         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11309                                     DET-LF-PREM
 11310     ELSE
 11311         MOVE ZEROS              TO DET-LF-PREM.
 11312
 11313     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11314         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11315                                     DET-LF-BEN
 11316     ELSE
 11317         MOVE ZEROS              TO DET-LF-BEN.
 11318
 11319     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11320        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11321        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11322         MOVE DET-PR-UREC-5          TO TR-DTL2
 11323         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11324         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11325
 11326     IF CC-AH-BENEFIT-CD NOT = SPACES
 11327         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11328                                     DET-AH-BEN-CD
 11329     ELSE
 11330         MOVE SPACES             TO DET-AH-BEN-CD.
 11331
 11332     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11333         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11334                                     DET-AH-PREM
 11335     ELSE
 11336         MOVE ZEROS              TO DET-AH-PREM.
 11337
 11338     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11339         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11340                                     DET-AH-BEN
 11341     ELSE
 11342         MOVE ZEROS              TO DET-AH-BEN.
 11343
 11344     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11345        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11346        CC-AH-BENEFIT-AMT NOT = ZEROS
 11347         MOVE DET-PR-UREC-6          TO TR-DTL2
 11348         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11349         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11350
 11351 0910-END-CHANGE-PROCESSING.
 11352
 11353     IF CR-LNAME = ALL '*'
 11354         MOVE SPACES                 TO CR-LNAME.
 11355     IF CR-FNAME = ALL '*'
 11356         MOVE SPACES                 TO CR-FNAME.
 11357     IF CR-INIT = '*'
 11358         MOVE SPACES                 TO CR-INIT.
 11359     IF CR-SOC-SEC = ALL '*'
 11360         MOVE SPACES                 TO CR-SOC-SEC.
 11361     IF CR-JT-LNAME = ALL '*'
 11362         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 220
* ECS010.cbl
 11363     IF CR-JT-FNAME = ALL '*'
 11364         MOVE SPACES                 TO CR-JT-FNAME.
 11365     IF CR-JT-INIT = '*'
 11366         MOVE SPACES                 TO CR-JT-INIT.
 11367     IF CR-POLICY-FORM-NO = ALL '*'
 11368         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11369     IF CR-MEMBER-NO = ALL '*'
 11370         MOVE SPACES                 TO CR-MEMBER-NO.
 11371     IF CR-LOAN-OFFICER = ALL '*'
 11372         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11373     IF CR-USER-CODE = ALL '*'
 11374         MOVE SPACES                 TO CR-USER-CODE.
 11375
 11376     ADD +1 TO BC-G-CTN.
 11377     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 221
* ECS010.cbl
 11379 0920-GET-BANK-FEES.
 11380
 11381     IF CR-CERT-NO = '0008771354 '
 11382        DISPLAY ' MADE IT TO 0920 '
 11383     END-IF
 11384
 11385     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11386     MOVE CR-CARRIER             TO AG-CARRIER
 11387     MOVE CR-GROUPING            TO AG-GROUPING
 11388     MOVE CR-BANK-NO             TO AG-BANK
 11389     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11390     MOVE 'B'                    TO AG-TYPE
 11391
 11392*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11393*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11394*                                THRU 0925-EXIT
 11395*       GO TO 0920-EXIT
 11396*    END-IF
 11397
 11398     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11399
 11400     IF CR-CERT-NO = '0008771354 '
 11401        DISPLAY ' MADE IT AFTER START '
 11402     END-IF
 11403
 11404     .
 11405 0920-READ-ERAGTC.
 11406
 11407     IF ERAGTC-FILE-STATUS = '00'
 11408        READ ERAGTC NEXT RECORD
 11409     IF CR-CERT-NO = '0008771354 '
 11410        DISPLAY ' MADE ONE READ '
 11411     END-IF
 11412
 11413        IF ERAGTC-FILE-STATUS = '00'
 11414           IF (CR-CARRIER         = AG-CARRIER)
 11415              AND (CR-GROUPING    = AG-GROUPING)
 11416              AND (CR-BANK-NO     = AG-BANK)
 11417              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11418                 GO TO 0920-READ-ERAGTC
 11419              ELSE
 11420                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11421                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11422                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11423                                 THRU 0925-EXIT
 11424                    MOVE AG-CONTROL-PRIMARY
 11425                                 TO WS-PREV-BANK-COMM-KEY
 11426                    GO TO 0920-EXIT
 11427                 END-IF
 11428              END-IF
 11429           END-IF
 11430        END-IF
 11431     END-IF
 11432
 11433     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11434*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11435
 11436     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 222
* ECS010.cbl
 11437        AND (PB-I-BANK-FEE NOT = ZEROS)
 11438        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11439        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11440        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11441        MOVE ' '                 TO WS-BNK-RECALC (1)
 11442        MOVE +2                  TO IB
 11443     END-IF
 11444
 11445     .
 11446 0920-EXIT.
 11447     EXIT.
 11448
 11449 0925-BUILD-WORK-BNK-COMM.
 11450
 11451     IF CR-CERT-NO = '0008771354 '
 11452        DISPLAY ' MADE IT TO 0925 '
 11453     END-IF
 11454
 11455     MOVE +1                     TO IA IB
 11456
 11457*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11458*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11459*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11460*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11461*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11462*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11463*       ADD +1                   TO IB
 11464*    END-IF
 11465*    .
 11466*0925-BUILD-CONTINUE.
 11467
 11468     IF CR-CERT-NO = '00087735841'
 11469        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11470        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11471        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11472     END-IF
 11473
 11474*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11475     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11476        (IA > +10)
 11477        OR (IB > +10)
 11478        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11479           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11480           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11481*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11482           IF AG-SPP-FEES (IA) NOT NUMERIC
 11483              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11484           END-IF
 11485           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11486           MOVE AG-RECALC-LV-INDIC (IA)
 11487                                 TO WS-BNK-RECALC (IB)
 11488        ELSE
 11489           MOVE SPACES           TO WS-BNK-AGT (IB)
 11490                                    WS-BNK-TYPE (IB)
 11491                                    WS-BNK-RECALC (IB)
 11492           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11493        END-IF
 11494        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 223
* ECS010.cbl
 11495     END-PERFORM
 11496
 11497     .
 11498 0925-EXIT.
 11499     EXIT.
 11500
 11501 0930-BUILD-CERT-TRLR.
 11502
 11503     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11504     MOVE 'CS'                   TO CS-RECORD-ID
 11505     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11506     MOVE CR-CARRIER             TO CS-CARRIER
 11507     MOVE CR-GROUPING            TO CS-GROUPING
 11508     MOVE CR-STATE               TO CS-STATE
 11509     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11510     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11511     MOVE CR-CERT-NO             TO CS-CERT-NO
 11512     MOVE 'A'                    TO CS-TRAILER-TYPE
 11513
 11514     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11515
 11516     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11517        WRITE CERTIFICATE-TRAILERS
 11518        IF ELCRTT-FILE-STATUS = '00'
 11519           CONTINUE
 11520        ELSE
 11521           IF ELCRTT-FILE-STATUS = '22'
 11522              READ ELCRTT
 11523              IF ELCRTT-FILE-STATUS = '00'
 11524                 MOVE WS-BANK-COMMISSIONS
 11525                                 TO CS-BANK-COMMISSION-AREA
 11526                 REWRITE CERTIFICATE-TRAILERS
 11527                 IF ELCRTT-FILE-STATUS NOT = '00'
 11528                    DISPLAY ' BAD REWRITE ELCRTT '
 11529                                 ELCRTT-FILE-STATUS
 11530                    PERFORM ABEND-PGM
 11531                 END-IF
 11532              ELSE
 11533                 DISPLAY ' BAD READ    ELCRTT '
 11534                                  ELCRTT-FILE-STATUS
 11535                 PERFORM ABEND-PGM
 11536              END-IF
 11537           ELSE
 11538              DISPLAY ' BAD WRITE ELCRTT '
 11539                                 ELCRTT-FILE-STATUS
 11540              PERFORM ABEND-PGM
 11541           END-IF
 11542        END-IF
 11543     END-IF
 11544
 11545     .
 11546 0930-EXIT.
 11547     EXIT.
 11548
 11549 0950-BUILD-CERT-C-TRLR.
 11550
 11551     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11552     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 224
* ECS010.cbl
 11553     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11554     MOVE CR-CARRIER             TO CS-CARRIER.
 11555     MOVE CR-GROUPING            TO CS-GROUPING.
 11556     MOVE CR-STATE               TO CS-STATE.
 11557     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11558     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11559     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11560     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11561
 11562     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11563
 11564     WRITE CERTIFICATE-TRAILERS.
 11565     IF ELCRTT-FILE-STATUS = '00'
 11566        CONTINUE
 11567     ELSE
 11568        IF ELCRTT-FILE-STATUS = '22'
 11569           READ ELCRTT
 11570           IF ELCRTT-FILE-STATUS = '00'
 11571              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11572              REWRITE CERTIFICATE-TRAILERS
 11573              IF ELCRTT-FILE-STATUS NOT = '00'
 11574                 DISPLAY ' BAD REWRITE ELCRTT '
 11575                              ELCRTT-FILE-STATUS
 11576                 PERFORM ABEND-PGM
 11577              END-IF
 11578           ELSE
 11579              DISPLAY ' BAD READ    ELCRTT '
 11580                               ELCRTT-FILE-STATUS
 11581              PERFORM ABEND-PGM
 11582           END-IF
 11583        ELSE
 11584           DISPLAY ' BAD WRITE ELCRTT '
 11585                              ELCRTT-FILE-STATUS
 11586           PERFORM ABEND-PGM
 11587        END-IF
 11588     END-IF.
 11589
 11590     .
 11591 0950-EXIT.
 11592     EXIT.
 11593
 11594
 11595******************************************************************
 11596***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11597******************************************************************
 11598
 11599 1000-SET-COMMISSION-STRUCTURE.
 11600
 11601     MOVE +1                     TO IA
 11602                                    IB.
 11603
 11604 1100-GET-COMMISSION-LEVEL.
 11605
 11606     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11607
 11608     IF WK-AGT = '0000000000' OR SPACES
 11609         MOVE +0                 TO WK-L-RT
 11610                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 225
* ECS010.cbl
 11611                                    WK-A-RT
 11612         GO TO 1200-SET-COMMISSION-LEVEL.
 11613
 11614 1110-LIFE-COMMISSION.
 11615
 11616     IF CR-LFTYP = ZERO  OR
 11617       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11618         MOVE +0 TO WK-L-RT
 11619                    WK-J-RT
 11620         GO TO 1130-A-H-COMMISSION.
 11621
 11622     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11623         GO TO 1120-JOINT-LIFE-COMMISSION.
 11624
 11625     IF WK-L-RT NUMERIC
 11626        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11627         MOVE WK-L-RT                TO WS-COMMISSION
 11628         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11629         MOVE WS-COMMISSION          TO WK-L-RT
 11630         GO TO 1130-A-H-COMMISSION.
 11631
 11632     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11633     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11634     MOVE ZEROS                      TO WS-SUB1.
 11635     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11636
 11637     IF WS-SUB1 = ZEROS
 11638         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11639     ELSE
 11640         MOVE WK-RATE                TO WK-L-RT
 11641         GO TO 1130-A-H-COMMISSION.
 11642
 11643     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11644
 11645     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11646     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11647     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11648     MOVE WK-RATE                    TO WK-L-RT.
 11649
 11650     GO TO 1130-A-H-COMMISSION.
 11651
 11652 1120-JOINT-LIFE-COMMISSION.
 11653
 11654     IF WK-J-RT NUMERIC
 11655        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11656         MOVE WK-J-RT                TO WS-COMMISSION
 11657         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11658         MOVE WS-COMMISSION          TO WK-J-RT
 11659         GO TO 1130-A-H-COMMISSION.
 11660
 11661     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11662     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11663     MOVE ZEROS                      TO WS-SUB1.
 11664     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11665
 11666     IF WS-SUB1 = ZEROS
 11667         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11668     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 226
* ECS010.cbl
 11669         MOVE WK-RATE                TO WK-J-RT
 11670         GO TO 1130-A-H-COMMISSION.
 11671
 11672     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11673
 11674     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11675     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11676     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11677     MOVE WK-RATE                    TO WK-J-RT.
 11678
 11679 1130-A-H-COMMISSION.
 11680
 11681     IF CR-AHTYP = ZERO  OR
 11682       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11683         MOVE +0 TO WK-A-RT
 11684         GO TO 1200-SET-COMMISSION-LEVEL.
 11685
 11686     IF WK-A-RT NUMERIC
 11687        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11688         MOVE WK-A-RT                TO WS-COMMISSION
 11689         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11690         MOVE WS-COMMISSION          TO WK-A-RT
 11691         GO TO 1200-SET-COMMISSION-LEVEL.
 11692
 11693     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11694     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11695     MOVE ZEROS                      TO WS-SUB1.
 11696     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11697
 11698     IF WS-SUB1 = ZEROS
 11699         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11700     ELSE
 11701         MOVE WK-RATE                TO WK-A-RT
 11702         GO TO 1200-SET-COMMISSION-LEVEL.
 11703
 11704     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11705
 11706     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11707     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11708     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11709     MOVE WK-RATE                    TO WK-A-RT.
 11710
 11711 1200-SET-COMMISSION-LEVEL.
 11712
 11713     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11714     IF WK-AGT = '0000000000' OR SPACES
 11715         MOVE SPACE                   TO WK-N-TYPE (IA)
 11716     ELSE
 11717         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11718
 11719     IF CR-LFTYP = ZERO
 11720         MOVE +0                      TO WK-L-RT1  (IA)
 11721     ELSE
 11722         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11723             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11724         ELSE
 11725             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11726
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 227
* ECS010.cbl
 11727     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11728
 11729     IF RC-COMM-FLG = 'X'
 11730        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11731*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11732*             AND (IA = +5))
 11733            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11734            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11735            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11736            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11737
 11738     IF IA LESS THAN +10
 11739         ADD +1 TO IA
 11740         GO TO 1100-GET-COMMISSION-LEVEL.
 11741
 11742     GO TO 1499-SET-COMM-X.
 11743
 11744 1300-READ-ERCTBL-FILE.
 11745
 11746     IF CTBL-SEARCH = LAST-CTBL
 11747         GO TO 1399-READ-ERCTBL-X.
 11748
 11749     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11750
 11751     IF COMM-OPEN-SW = ' '
 11752         MOVE 'X'                        TO COMM-OPEN-SW
 11753         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11754         OPEN INPUT ERCTBL
 11755         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11756             NEXT SENTENCE
 11757            ELSE
 11758             MOVE '41'                   TO ABEND-CODE-1
 11759             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11760             DISPLAY '******************************'
 11761             DISPLAY '***** ERROR LOCATION 012 *****'
 11762             DISPLAY '******************************'
 11763             DISPLAY '******************************'
 11764             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11765             GO TO ABEND-PGM.
 11766
 11767     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11768                                            LAST-CTBL.
 11769     READ ERCTBL.
 11770
 11771     IF ERCTBL-FILE-STATUS = '23'
 11772         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11773                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11774                 ' CTBL: ' CTBL-SEARCH
 11775         MOVE '*'                TO CTBL-ERROR-SWITCH
 11776         MOVE '44'               TO ABEND-CODE-1
 11777         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11778         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11779         DISPLAY '******************************'
 11780         DISPLAY '***** ERROR LOCATION 013 *****'
 11781         DISPLAY '******************************'
 11782         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11783*        IF DTE-CLIENT NOT = 'NCL'
 11784         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 228
* ECS010.cbl
 11785           AND 'AHL'
 11786             GO TO ABEND-PGM
 11787         ELSE
 11788             NEXT SENTENCE
 11789     ELSE
 11790         IF ERCTBL-FILE-STATUS NOT = '00'
 11791             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11792             MOVE '44'               TO ABEND-CODE-1
 11793             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11794             DISPLAY '******************************'
 11795             DISPLAY '***** ERROR LOCATION 014 *****'
 11796             DISPLAY '******************************'
 11797             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11798             GO TO ABEND-PGM.
 11799
 11800     ADD +1                            TO ERCTBL-READS.
 11801
 11802 1399-READ-ERCTBL-X.
 11803     EXIT.
 11804
 11805 1400-GET-COMM-PERCENT.
 11806
 11807     IF CTBL-ERROR
 11808         MOVE ZEROS                      TO WK-RATE
 11809         GO TO 1489-GET-PERCENT-X.
 11810
 11811     MOVE +1 TO IB.
 11812     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11813        (CT-TBF (1) NOT EQUAL +9999999.99)
 11814         ADD +9 TO IB
 11815         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11816            (CT-TBF (2) NOT EQUAL +9999999.99)
 11817             ADD +9 TO IB.
 11818
 11819     IF CR-AGE GREATER CT-AGE (1)
 11820         ADD +3 TO IB
 11821         IF CR-AGE GREATER CT-AGE (2)
 11822             ADD +3 TO IB.
 11823
 11824     IF WS-COMM-TERM GREATER CT-TRM (1)
 11825         ADD +1 TO IB
 11826         IF WS-COMM-TERM GREATER CT-TRM (2)
 11827             ADD +1 TO IB.
 11828
 11829     IF CT-RT (IB) NOT NUMERIC
 11830         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11831         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11832         GO TO 1300-READ-ERCTBL-FILE.
 11833
 11834     MOVE CT-RT (IB) TO WK-RATE.
 11835
 11836 1489-GET-PERCENT-X.
 11837     EXIT.
 11838
 11839 1499-SET-COMM-X.
 11840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 229
* ECS010.cbl
 11842******************************************************************
 11843***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11844******************************************************************
 11845
 11846 1500-GET-ACCT-LEVEL-LF-COMM.
 11847
 11848     MOVE ZEROS                      TO ACCT-COMM-LF
 11849                                        ACCT-COMM-AH.
 11850
 11851     MOVE +1                         TO IA.
 11852
 11853 1510-ACCT-LEVEL-LOOP.
 11854
 11855     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11856         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11857             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11858             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11859         ELSE
 11860             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11861                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11862
 11863     IF IA LESS THAN +10
 11864         ADD +1 TO IA
 11865         GO TO 1510-ACCT-LEVEL-LOOP.
 11866
 11867 1519-ACCT-LF-COMM-X.
 11868     EXIT.
 11869
 11870
 11871 1550-GET-ACCT-LEVEL-AH-COMM.
 11872
 11873     MOVE ZEROS                      TO ACCT-COMM-AH.
 11874
 11875     MOVE +1                         TO IA.
 11876
 11877 1555-ACCT-LEVEL-LOOP.
 11878
 11879     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11880         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11881             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11882
 11883     IF IA LESS THAN +10
 11884         ADD +1 TO IA
 11885         GO TO 1555-ACCT-LEVEL-LOOP.
 11886
 11887 1599-ACCT-AH-COMM-X.
 11888     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 230
* ECS010.cbl
 11890******************************************************************
 11891***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11892******************************************************************
 11893
 11894 1600-RECALC-COMM-EXTR.
 11895
 11896     IF RC-COMM-FLG = 'X'  OR
 11897        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11898        CR-POLICY-IS-DECLINED  OR
 11899        CR-POLICY-IS-VOID
 11900         GO TO 1899-RECALC-COMM-EXTR-X.
 11901
 11902     MOVE 'X'                           TO RC-COMM-FLG.
 11903
 11904     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11905         GO TO 1899-RECALC-COMM-EXTR-X.
 11906
 11907     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11908
 11909     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11910         GO TO 1899-RECALC-COMM-EXTR-X.
 11911
 11912     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11913
 11914     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11915         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11916             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11917
 11918     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11919         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11920                                           WK-NEW-RATES
 11921         GO TO 1899-RECALC-COMM-EXTR-X.
 11922
 11923     MOVE +1                            TO SUB8.
 11924     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11925
 11926 1610-CK-DUPLICATE-ENTRIES.
 11927     PERFORM 1620-CK-DUPL-ENTR-NEW
 11928         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11929             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11930
 11931 1619-CK-DUPLICATE-ENTRIES-XIT.
 11932     EXIT.
 11933
 11934 1620-CK-DUPL-ENTR-NEW.
 11935     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11936         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11937         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11938         MOVE +0                        TO CR-LCOM-L (SUB11)
 11939                                           CR-LCOM-AH (SUB11)
 11940         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11941         MOVE 11                        TO SUB12.
 11942
 11943 1629-CK-DUPL-ENTR-NEW-XIT.
 11944     EXIT.
 11945
 11946 1700-REVERSE-OLD-COMM-LOOP.
 11947     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 231
* ECS010.cbl
 11948     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11949
 11950     IF SUB8 LESS THAN +10
 11951         ADD +1 TO SUB8
 11952         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11953
 11954     MOVE 'O' TO RECALC-TYPE.
 11955
 11956     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11957
 11958     GO TO 1800-MOVE-NEW-COMM-RATES.
 11959
 11960 1710-DO-R-C-EXTRACTS.
 11961
 11962     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11963
 11964     PERFORM 1720-CHECK-COMM-LEVELS
 11965         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11966             VARYING SUB13 FROM +1 BY +1
 11967                 UNTIL SUB13 GREATER THAN 10.
 11968
 11969     MOVE '8'                           TO DE-TRANS.
 11970     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11971*****PERFORM EXTRACT-DATE-RELOAD.
 11972     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11973     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11974     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11975     PERFORM EXTRACT-DATE-LOAD.
 11976     MOVE 'R'                           TO DE-REIN.
 11977     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11978     MOVE +1                            TO SUB1.
 11979     PERFORM 3110-REINSURE-ISSUE-LOOP
 11980         THRU 3119-REINSURE-ISSUE-LOOP-END.
 11981
 11982     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 11983         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 11984                                       2259-END-CANCEL-BUILD
 11985         PERFORM 1720-CHECK-COMM-LEVELS
 11986             THRU 1729-CHECK-COMM-LEVELS-EXIT
 11987                 VARYING SUB13 FROM +1 BY +1
 11988                     UNTIL SUB13 GREATER THAN 10
 11989         MOVE '7'                       TO DE-TRANS
 11990         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 11991*********PERFORM EXTRACT-DATE-RELOAD
 11992         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11993         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 11994         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 11995         PERFORM EXTRACT-DATE-LOAD
 11996         MOVE 'R'                       TO DE-REIN
 11997         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11998         MOVE +1                        TO SUB1
 11999         PERFORM 3210-REINSURE-CANCEL-LOOP
 12000             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12001
 12002 1719-DO-R-C-EXTRACTS-X.
 12003     EXIT.
 12004
 12005 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 232
* ECS010.cbl
 12006
 12007     IF  DE-AGT (SUB13)       =  SPACES  AND
 12008         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12009         DE-L-PC (SUB13)      =  ZEROS   AND
 12010         DE-A-PC (SUB13)      =  ZEROS
 12011         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12012
 12013 1729-CHECK-COMM-LEVELS-EXIT.
 12014     EXIT.
 12015
 12016 1800-MOVE-NEW-COMM-RATES.
 12017     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12018     MOVE 'N'                           TO RECALC-TYPE.
 12019     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12020     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12021                                           CR-COMPENSATION-LEVELS.
 12022     IF DTE-CLIENT = 'DCC'
 12023        IF CR-LF-NSP-PRM NOT = ZEROS
 12024           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12025              (CR-LFPRM + CR-LFPRM-ALT) -
 12026              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12027        END-IF
 12028        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12029           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12030                                        NOT = 'G' AND 'L')
 12031           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12032           CR-AHPRM -
 12033           (CR-AHPRM * CR-LCOM-AH (1))
 12034        END-IF
 12035     END-IF
 12036     .
 12037
 12038 1899-RECALC-COMM-EXTR-X.
 12039     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 233
* ECS010.cbl
 12041******************************************************************
 12042***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12043******************************************************************
 12044
 12045 2000-INITIALIZE-DETAIL-EXTRACT.
 12046
 12047     MOVE SPACES                   TO DETAIL-EXTRACT.
 12048
 12049     MOVE 'DE'                     TO DE-RECORD-ID.
 12050     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12051     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12052
 12053     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12054     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12055
 12056     MOVE CR-NAME                  TO DE-NAME.
 12057     MOVE CR-AGE                   TO DE-AGE.
 12058     MOVE CR-SEX                   TO DE-SEX.
 12059     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12060
 12061     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12062     MOVE CR-LF-TERM               TO DE-LF-TERM
 12063     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12064     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12065     MOVE ZEROS                    TO DE-LF-CNBEN.
 12066     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12067     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12068     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12069     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12070     MOVE ZEROS                    TO DE-LF-RFND.
 12071
 12072     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12073     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12074                                      DE-LF-CANC-EXIT-DT.
 12075
 12076     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12077     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12078     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12079     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12080     MOVE ZEROS                    TO DE-AH-RFND.
 12081
 12082     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12083     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12084                                      DE-AH-CANC-EXIT-DT.
 12085     IF DTE-CLIENT = 'DCC'
 12086        IF CR-ENTRY-STATUS = 'M'
 12087           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12088        ELSE
 12089           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12090              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12091           END-IF
 12092        END-IF
 12093     END-IF
 12094
 12095     IF DTE-CLIENT = 'DCC'
 12096        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12097        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12098     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 234
* ECS010.cbl
 12099        IF (CR-LFTYP NOT = ZERO   AND
 12100           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12101           (CR-AHTYP NOT = ZERO  AND
 12102           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12103           MOVE CR-LIVES           TO DE-LIVES
 12104           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12105                                      DE-CANCEL-CNT-YTD
 12106        END-IF
 12107     END-IF
 12108
 12109     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12110     IF AM-ZIP-PRIME NUMERIC
 12111        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12112      ELSE
 12113        MOVE ZEROS                 TO DE-ZIP.
 12114     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12115
 12116     MOVE CR-APR                   TO DE-APR.
 12117     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12118     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12119     MOVE CR-IND-GRP               TO DE-IG.
 12120     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12121     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12122
 12123     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12124     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12125     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12126
 12127     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12128*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12129
 12130     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12131                                      DE-REI-AHAMT  DE-REI-AHPRM
 12132                                      DE-REI-LFRFND DE-REI-AHRFND
 12133                                      DE-REI-CNAMT.
 12134
 12135     MOVE +1                       TO SUB1.
 12136
 12137* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12138* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12139* CALC IT IN ECS017.
 12140     IF DTE-CLIENT = 'DCC'
 12141        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12142           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12143           IF CR-ACCOUNT = '05500500DD'
 12144              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12145                ' ' DE-REI-LFRFND
 12146           END-IF
 12147        END-IF
 12148        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12149                      OR
 12150           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12151            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12152           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12153           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12154        END-IF
 12155     END-IF
 12156
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 235
* ECS010.cbl
 12157
 12158     PERFORM EXTRACT-DATE-LOAD.
 12159
 12160     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12161                                      WS-DE-INCUR-N
 12162                                      WS-DE-PAY-N
 12163                                      WS-DE-PAID-TO-N
 12164                                      WS-DE-ACC-EXP-DTE-N
 12165                                      WS-DE-ACC-EFF-DTE-N
 12166                                      WS-DE-RSV-INCUR-N
 12167                                      WS-DE-RSV-PAYTO-N
 12168                                      WS-DE-ACC-EXP-DTE-RSV-N
 12169                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12170
 12171 2090-GL-CODE-LOOP.
 12172
 12173     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12174
 12175     IF SUB1 LESS THAN +10
 12176         ADD +1 TO SUB1
 12177         GO TO 2090-GL-CODE-LOOP.
 12178
 12179     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12180
 12181     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12182
 12183     IF (DTE-CLIENT = 'DCC')
 12184        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12185        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12186        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12187        AND (RECALC-TYPE = SPACES)
 12188        MOVE +1                  TO IA
 12189*       IF CR-ACCOUNT = '05500500DD'
 12190**      IF CR-CERT-NO = '0008773536 '
 12191*          DISPLAY ' MADE IT TO 2000 '
 12192*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12193*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12194*             (IB > +10)
 12195*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12196*                MOVE IB TO DIL-BEN-CODE
 12197*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12198*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12199*                DISPLAY DISPLAY-IBNR-LINE
 12200*             END-IF
 12201*          END-PERFORM
 12202*          DISPLAY ' TRLR AREA  '
 12203*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12204*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12205*             (IB > +10)
 12206*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12207*                MOVE IB TO DIL-BEN-CODE
 12208*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12209*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12210*                DISPLAY DISPLAY-IBNR-LINE
 12211*             END-IF
 12212*          END-PERFORM
 12213*       END-IF
 12214        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 236
* ECS010.cbl
 12215           IB > +10
 12216           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12217              CONTINUE
 12218           ELSE
 12219              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12220                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12221                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12222                 COMPUTE DE-A-PC (IB) =
 12223                        WS-BNK-SPP-FEES (IA) / +1000
 12224                 MOVE +0              TO DE-L-PC (IB)
 12225                 ADD +1               TO IA
 12226              END-IF
 12227*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12228*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12229*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12230*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12231*                MOVE +0              TO DE-L-PC (IB)
 12232*                ADD +1               TO IA
 12233*             END-IF
 12234           END-IF
 12235        END-PERFORM
 12236     END-IF
 12237
 12238
 12239
 12240     .
 12241 2099-INIT-DTL-X.
 12242     EXIT.
 12243
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 237
* ECS010.cbl
 12245******************************************************************
 12246***            B U I L D   I S S U E   E X T R A C T           ***
 12247******************************************************************
 12248
 12249 2100-BUILD-ISSUE-EXTRACT.
 12250
 12251     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12252
 12253     MOVE 'I'                      TO DE-TRANS.
 12254
 12255     IF CHECK-BILLED
 12256         MOVE 'N' TO BILLED-SWITCH
 12257     ELSE
 12258         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12259
 12260     MOVE +1                        TO SUB1.
 12261 2150-GA-BILL-LOOP.
 12262
 12263     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12264         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12265
 12266     IF SUB1 LESS THAN +5
 12267         ADD +1 TO SUB1
 12268         GO TO 2150-GA-BILL-LOOP.
 12269
 12270     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12271     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12272                                       DE-BILLED-LFRFND
 12273                                       DE-BILLED-AHPRM
 12274                                       DE-BILLED-AHRFND.
 12275
 12276     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12277         IF PB-LF-BILLED-AMTS = ZERO  AND
 12278            PB-AH-BILLED-AMTS = ZERO
 12279             MOVE ' '                    TO DE-BILL-STATUS
 12280         ELSE
 12281             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12282                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12283                 MOVE 'B'                TO DE-BILL-STATUS
 12284             ELSE
 12285                 MOVE 'R'                TO DE-BILL-STATUS
 12286                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12287                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12288     ELSE
 12289         MOVE 'B'                        TO DE-BILL-STATUS.
 12290
 12291 2190-WRITE-ISSUE-EXTRACT.
 12292
 12293     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12294
 12295 2199-BLD-ISSUE-X.
 12296     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 238
* ECS010.cbl
 12298******************************************************************
 12299***           B U I L D   C A N C E L   E X T R A C T          ***
 12300******************************************************************
 12301
 12302 2200-BUILD-CANCEL-EXTRACT.
 12303
 12304     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12305
 12306     MOVE 'C'                           TO DE-TRANS.
 12307
 12308     IF CR-LFTYP = ZERO
 12309         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12310
 12311     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12312         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12313             CR-LFRFND = +0
 12314              MOVE +0                   TO TEMP-5
 12315              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12316
 12317     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12318          IF CR-LFRFND = +0
 12319              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12320
 12321     MOVE +1 TO TEMP-5.
 12322     MOVE CR-LF-TERM             TO ORIG-TERM.
 12323     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12324     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12325     MOVE '1'                    TO W-VAL-SOURCE.
 12326     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12327
 12328     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12329         MOVE CR-LFAMT TO DE-LF-CNBEN
 12330         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12331
 12332     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12333         GO TO 2220-BLD-DE-CANCEL-SUM.
 12334
 12335     IF REM-TRM3 = CR-LF-TERM
 12336         MOVE CR-LFAMT TO DE-LF-CNBEN
 12337         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12338
 12339     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12340         GO TO 2210-BLD-DE-CANCEL-TEX.
 12341
 12342     IF DTE-CLIENT = 'NCL'
 12343         IF CR-DT LESS THAN 19910101
 12344             GO TO 2205-BLD-DE-CANCEL-BEN.
 12345
 12346     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12347         GO TO 2230-BLD-DE-CANCEL-NP.
 12348
 12349     IF DTE-CLIENT = 'FUL'
 12350         GO TO 2240-BLD-DE-CANCEL-FUL.
 12351
 12352*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12353     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12354        (CR-RATING-CLASS NOT = 'L ')
 12355         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 239
* ECS010.cbl
 12356            (CR-LF-TERM GREATER THAN 060)  AND
 12357            (CR-DT GREATER THAN 19831031)
 12358              GO TO 2230-BLD-DE-CANCEL-NP.
 12359
 12360     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12361         IF (CR-APR GREATER THAN ZERO)  AND
 12362            (CR-LF-TERM GREATER THAN 061)  AND
 12363            (CR-DT GREATER THAN 19830318)
 12364              GO TO 2230-BLD-DE-CANCEL-NP.
 12365
 12366     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12367         IF (CR-APR GREATER THAN ZERO)  AND
 12368            (CR-LF-TERM GREATER THAN 062)  AND
 12369            (CR-DT GREATER THAN 19810831)  AND
 12370            (CR-DT LESS THAN 19830901)
 12371              GO TO 2230-BLD-DE-CANCEL-NP.
 12372
 12373     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12374         IF (CR-APR GREATER THAN ZERO)  AND
 12375            (CR-LF-TERM GREATER THAN 060)  AND
 12376            (CR-DT GREATER THAN 19831231)
 12377              GO TO 2230-BLD-DE-CANCEL-NP.
 12378
 12379 2205-BLD-DE-CANCEL-BEN.
 12380
 12381     IF CR-LF-TERM EQUAL +0
 12382         MOVE +0          TO TEMP-5
 12383     ELSE
 12384         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12385
 12386     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12387
 12388     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12389
 12390 2210-BLD-DE-CANCEL-TEX.
 12391
 12392     DIVIDE CR-LFAMT BY CR-LF-TERM
 12393         GIVING TEX-FACT-1.
 12394     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12395         GIVING TEX-FACT-2
 12396             REMAINDER TEX-FACT-3.
 12397     IF TEX-FACT-3 NOT = ZERO
 12398         ADD +1 TO TEX-FACT-2.
 12399     COMPUTE DE-LF-CNBEN =
 12400         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12401
 12402     IF CR-LFAMT EQUAL +0
 12403         MOVE +0                  TO TEMP-5
 12404     ELSE
 12405         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12406
 12407     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12408
 12409 2220-BLD-DE-CANCEL-SUM.
 12410
 12411     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12412     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12413
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 240
* ECS010.cbl
 12414     IF CR-LFRFND NOT LESS CR-LFPRM
 12415         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12416          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12417
 12418     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12419     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12420     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12421         MOVE TEMP-7             TO DE-LF-CNBEN
 12422       ELSE
 12423         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12424         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12425
 12426     IF CR-LFAMT EQUAL +0
 12427         MOVE +0                  TO TEMP-5
 12428     ELSE
 12429         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12430
 12431     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12432         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12433
 12434 2230-BLD-DE-CANCEL-NP.
 12435
 12436     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12437     MOVE 'L'                        TO  DC-OPTION-CODE.
 12438     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12439     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12440
 12441     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12442       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12443       MOVE '3'                      TO  DC-OPTION-CODE
 12444       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12445       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12446     ELSE
 12447       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12448       MOVE '6'                      TO  DC-OPTION-CODE
 12449       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12450       MOVE +0                       TO  DC-ELAPSED-DAYS
 12451       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12452       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12453
 12454     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12455     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12456     MOVE CR-APR                     TO  CP-LOAN-APR.
 12457     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12458     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12459     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12460     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12461     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12462     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12463
 12464     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12465     IF (DTE-CLIENT = 'DCC')
 12466        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12467        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12468           ((CR-STATE = DD-STATE (D1))
 12469           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12470           AND ('A'           = DD-BEN-TYPE   (D1))
 12471           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 241
* ECS010.cbl
 12472           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12473                           OR
 12474           D1 > +800
 12475        END-PERFORM
 12476        IF D1 < +801
 12477           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12478              (P1 > +8)
 12479              OR (DD-PROD-CODE (D1 P1) = 'L')
 12480           END-PERFORM
 12481           IF P1 < +9
 12482              MOVE DD-MAX-BEN-AMT (D1 P1)
 12483                                 TO CP-R-MAX-TOT-BEN
 12484           END-IF
 12485        END-IF
 12486     END-IF
 12487
 12488     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12489
 12490     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12491         COMPUTE DE-LF-CNBEN =
 12492                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12493      ELSE
 12494          COMPUTE DE-LF-CNBEN ROUNDED =
 12495                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12496
 12497     IF CR-LFAMT EQUAL +0
 12498         MOVE +0                  TO TEMP-5
 12499     ELSE
 12500         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12501
 12502     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12503
 12504 2240-BLD-DE-CANCEL-FUL.
 12505
 12506     MOVE CR-APR                  TO NP-APR.
 12507     MOVE CR-LF-TERM              TO NP-ORIG.
 12508     MOVE REM-TRM3                TO NP-REM.
 12509     MOVE '2'                     TO NP-OPT.
 12510     MOVE CR-AHPRM                TO NP-AHPRM.
 12511     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12512     MOVE CR-LFAMT                TO NP-BENEFIT.
 12513
 12514*    CALL 'FULNETRM'
 12515*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12516*              NP-ACCOUNT NP-REMAINING.
 12517
 12518     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12519
 12520     IF CR-LFAMT EQUAL +0
 12521         MOVE +0                  TO TEMP-5
 12522     ELSE
 12523         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12524
 12525 2250-CONTINUE-CANCEL-BUILD.
 12526
 12527     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12528     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12529     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 242
* ECS010.cbl
 12530                                         WS-DE-LF-CANC-DTE-N.
 12531     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12532                                         WS-DE-LF-CANC-EXIT-DT-N.
 12533     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12534
 12535
 12536     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12537     IF (DTE-CLIENT = 'DCC')
 12538        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12539        AND (CR-AHTYP NOT = '00' AND '  ')
 12540        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12541        MOVE CR-AH-TERM          TO ORIG-TERM
 12542        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12543        MOVE '1'                 TO W-VAL-SOURCE
 12544        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12545        PERFORM 8500-REMAINING-TERM-ROUTINE
 12546                                 THRU 8599-REM-TERM-X
 12547        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12548        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12549     END-IF
 12550
 12551     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12552
 12553     IF DTE-CLIENT = 'DCC'
 12554        IF DE-AH-RFND = ZEROS
 12555           MOVE ZEROS                 TO DE-ADDL-CLP
 12556        END-IF
 12557     END-IF
 12558
 12559     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12560     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12561                                         WS-DE-AH-CANC-DTE-N.
 12562     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12563                                         WS-DE-AH-CANC-EXIT-DT-N.
 12564     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12565
 12566     IF PB-LAST-MAINT-BY = 'E570'
 12567         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12568
 12569     IF CHECK-BILLED
 12570         MOVE 'N' TO BILLED-SWITCH
 12571     ELSE
 12572         GO TO 2259-END-CANCEL-BUILD.
 12573
 12574     MOVE +1                        TO SUB1.
 12575 2255-GA-BILL-LOOP.
 12576
 12577     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12578         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12579
 12580     IF SUB1 LESS THAN +5
 12581         ADD +1 TO SUB1
 12582         GO TO 2255-GA-BILL-LOOP.
 12583
 12584     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12585     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12586     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12587                                       DE-BILLED-LFRFND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 243
* ECS010.cbl
 12588                                       DE-BILLED-AHPRM
 12589                                       DE-BILLED-AHRFND.
 12590
 12591     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12592         IF PB-LF-BILLED-AMTS = ZERO  AND
 12593            PB-AH-BILLED-AMTS = ZERO
 12594             MOVE ' '                    TO DE-BILL-STATUS
 12595         ELSE
 12596             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12597                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12598                 MOVE 'B'                TO DE-BILL-STATUS
 12599             ELSE
 12600                 MOVE 'R'                TO DE-BILL-STATUS
 12601                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12602                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12603     ELSE
 12604         MOVE 'B'                        TO DE-BILL-STATUS.
 12605
 12606 2259-END-CANCEL-BUILD.
 12607     EXIT.
 12608
 12609 2290-WRITE-CANCEL-EXTRACT.
 12610
 12611     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12612
 12613 2299-BLD-CANCEL-X.
 12614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 244
* ECS010.cbl
 12616******************************************************************
 12617***            B U I L D   C L A I M   E X T R A C T           ***
 12618******************************************************************
 12619
 12620 2300-BUILD-CLAIM-EXTRACT.
 12621
 12622     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12623
 12624     MOVE 'X'                       TO DE-TRANS.
 12625
 12626     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12627
 12628     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12629     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12630
 12631     MOVE INCURRED-DATE             TO DE-INCUR
 12632                                       WS-DE-INCUR-N.
 12633     MOVE REPORTED-DATE             TO DE-REPORTED.
 12634     MOVE PAYMENT-DATE              TO DE-PAY
 12635                                       WS-DE-PAY-N.
 12636     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12637                                       WS-DE-PAID-TO-N.
 12638
 12639     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12640     MOVE PC-CHECK-NO               TO DE-CHECK.
 12641     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12642     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12643     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12644     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12645     INSPECT DE-PAY-CODE
 12646         CONVERTING '1234569' TO 'PFSXEEV'.
 12647
 12648     MOVE AM-NAME                   TO DE-ACC-NAME.
 12649     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12650                                       WS-DE-ACC-EXP-DTE-N.
 12651     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12652                                       WS-DE-ACC-EFF-DTE-N.
 12653     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12654     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12655
 12656     IF DE-DTH  OR  DE-OB-DTH
 12657         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12658     ELSE
 12659         IF CR-AH-LUMP-SUM-DISAB
 12660             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12661                                    TO DE-AH-PREV-STAT.
 12662
 12663     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12664         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12665
 12666 2390-WRITE-CLAIM-EXTRACT.
 12667
 12668     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12669
 12670 2399-BLD-CLAIM-X.
 12671     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 245
* ECS010.cbl
 12673******************************************************************
 12674***          B U I L D   R E S E R V E   E X T R A C T         ***
 12675******************************************************************
 12676
 12677 2400-BUILD-RESERVE-EXTRACT.
 12678
 12679     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12680
 12681     MOVE 'Y'                         TO DE-TRANS.
 12682     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12683
 12684     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12685     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12686     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12687     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12688     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12689     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12690
 12691     IF DTE-CLIENT  =  'NCL'
 12692        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12693            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12694
 12695     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12696
 12697     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12698                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12699
 12700     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12701                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12702
 12703     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12704                                         WS-DE-RSV-INCUR-N.
 12705     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12706     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12707                                         WS-DE-RSV-PAYTO-N.
 12708
 12709     MOVE ZEROS                       TO DE-REI-IBNR
 12710                                         DE-REI-PAYCUR
 12711                                         DE-REI-FUTRSV.
 12712
 12713     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12714
 12715     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12716         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12717
 12718 2490-WRITE-RESERVE-EXTRACT.
 12719
 12720     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12721
 12722 2499-BLD-RESERVE-X.
 12723     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 246
* ECS010.cbl
 12725******************************************************************
 12726***          W R I T E   D E T A I L   E X T R A C T S         ***
 12727******************************************************************
 12728
 12729 2500-WRITE-DETAIL-EXTRACTS.
 12730
 12731
 12732     MOVE  ZEROS            TO  SUB.
 12733
 12734     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12735         GO TO 2520-WRITE-CONTINUE.
 12736
 12737 2510-ZERO-CHARGEBACK-LOOP.
 12738
 12739     ADD  +1                TO  SUB.
 12740
 12741     IF  SUB    GREATER  THAN     +10
 12742         GO TO  2520-WRITE-CONTINUE.
 12743
 12744*    DISPLAY ' CERT NO ' CR-CERT-NO
 12745*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12746*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12747
 12748
 12749     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12750         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12751
 12752     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12753         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12754         OR (WS-DDF-AH-CB (SUB) = 'N')
 12755         MOVE  ZEROS             TO DE-A-PC (SUB)
 12756     END-IF
 12757
 12758     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12759
 12760 2520-WRITE-CONTINUE.
 12761
 12762     IF DTE-CLIENT NOT = 'HER'
 12763         GO TO 2590-WRITE-EXTRACTS.
 12764
 12765     IF DE-REINCO NOT = 'LNL'
 12766         GO TO 2590-WRITE-EXTRACTS.
 12767
 12768     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12769         GO TO 2590-WRITE-EXTRACTS.
 12770
 12771     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12772     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12773     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12774     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12775     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12776     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12777     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12778     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12779     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12780     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12781
 12782     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 247
* ECS010.cbl
 12783     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12784     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12785     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12786     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12787     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12788     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12789     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12790     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12791     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12792
 12793
 12794 2590-WRITE-EXTRACTS.
 12795
 12796     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12797                                     WS-DE-PROC-DT-N.
 12798
 12799     IF DTE-PGM-OPT = '1'
 12800         ADD +1                   TO DE-CNT
 12801*********PERFORM EXTRACT-DATE-RELOAD
 12802         WRITE DETAIL-EXTRACT.
 12803
 12804
 12805 2599-WRT-DETAIL-X.
 12806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 248
* ECS010.cbl
 12808******************************************************************
 12809***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12810******************************************************************
 12811
 12812 3000-REINSURE-ROUTINE.
 12813
 12814     IF (CR-POLICY-IS-DECLINED) OR
 12815        (CR-POLICY-IS-VOID)
 12816        GO TO 3099-REINSURE-ROUTINE-X.
 12817
 12818     IF REIN-FLG = 'X'
 12819         GO TO 3099-REINSURE-ROUTINE-X.
 12820
 12821     MOVE 'X' TO REIN-FLG.
 12822
 12823     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12824
 12825     IF CR-REIN-TABLE = SPACES OR ZEROS
 12826         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12827
 12828******************************************************************
 12829***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12830******************************************************************
 12831
 12832 3010-RR-READ-REIN.
 12833
 12834     IF REIN-OPEN-SW = ' '
 12835         MOVE 'X'                       TO REIN-OPEN-SW
 12836         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12837         MOVE 'A'                       TO REIN-SRCH-CODE
 12838         OPEN INPUT ERRTBL-IN
 12839         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12840             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12841          ELSE
 12842             MOVE '21'                  TO ABEND-CODE-1
 12843             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12844             DISPLAY '******************************'
 12845             DISPLAY '***** ERROR LOCATION 015 *****'
 12846             DISPLAY '******************************'
 12847             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12848             GO TO ABEND-PGM.
 12849
 12850     IF CR-REIN-TABLE = REIN-SRCH
 12851         GO TO 3019-RR-READ-REIN-X.
 12852
 12853     MOVE +0                            TO REIN-SUB-1.
 12854     MOVE 999999                        TO REIN-LOW-TIME.
 12855     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12856
 12857 3011-RR-CHECK-REIN-SAVE-TABLE.
 12858
 12859     ADD +1                             TO REIN-SUB-1.
 12860     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12861        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12862         GO TO 3015-RR-READ-ERRTBL.
 12863
 12864     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12865         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 249
* ECS010.cbl
 12866         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12867         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12868         GO TO 3019-RR-READ-REIN-X.
 12869
 12870     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12871         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12872         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12873
 12874     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12875
 12876 3015-RR-READ-ERRTBL.
 12877
 12878     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12879
 12880     READ ERRTBL-IN.
 12881
 12882     IF ERRTBL-FILE-STATUS  = '23'
 12883         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12884                                           ' ' CR-FULL-CONTROL
 12885         MOVE '24'                      TO ABEND-CODE-1
 12886         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12887         DISPLAY '******************************'
 12888         DISPLAY '***** ERROR LOCATION 016 *****'
 12889         DISPLAY '******************************'
 12890         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12891         GO TO ABEND-PGM.
 12892
 12893     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12894         NEXT SENTENCE
 12895       ELSE
 12896         MOVE '24'                      TO ABEND-CODE-1
 12897         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12898         DISPLAY '******************************'
 12899         DISPLAY '***** ERROR LOCATION 017 *****'
 12900         DISPLAY '******************************'
 12901         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12902         GO TO ABEND-PGM.
 12903
 12904     ADD +1                            TO ERRTBL-READS.
 12905
 12906     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12907         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12908         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12909         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12910     ELSE
 12911         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12912         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12913         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12914         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12915
 12916 3019-RR-READ-REIN-X.
 12917     EXIT.
 12918
 12919 3020-CALCULATE-REINSURANCE.
 12920
 12921*    IF DTE-CLIENT = '???'  AND
 12922*       (CR-REIN-TABLE = 'SE1')
 12923*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 250
* ECS010.cbl
 12924*        IF CR-STATE NOT = STATE-L
 12925*            MOVE CR-STATE             TO STATE-L
 12926*            PERFORM 8200-STATE-CODE-LOOKUP
 12927*                         THRU 8299-STATE-LOOKUP-X.
 12928
 12929
 12930*    IF DTE-CLIENT = 'DCC'
 12931*       IF CR-LF-NSP-PRM NOT = ZEROS
 12932*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12933*             (CR-LFPRM + CR-LFPRM-ALT) -
 12934*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12935*       END-IF
 12936*       IF CR-AH-NSP-PRM NOT = ZEROS
 12937*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12938*          CR-AHPRM -
 12939*          (CR-AHPRM * CR-LCOM-AH (1))
 12940*       END-IF
 12941*    END-IF
 12942
 12943
 12944     IF RE-REMAINING (1) = 'I'
 12945         MOVE '*'                      TO RISK-REIN-FLAG
 12946     ELSE
 12947         GO TO 3029-CONTINUE-REIN-CALC.
 12948
 12949     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12950                                          REIN-CANCEL-AH-SW.
 12951     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12952                                          REIN-LCNC-EARN-TERM
 12953                                          REIN-LF-CLM-MONTHS
 12954                                          REIN-EARN-AH-TERM
 12955                                          REIN-ACNC-EARN-TERM
 12956                                          REIN-AH-PRIOR-CLMS-PAID
 12957                                          REIN-AH-CLM-MONTHS
 12958                                          REIN-AH-CLM-MTH-1
 12959                                          REIN-AH-CLM-MTH-2
 12960                                          REIN-AH-CLM-MTH-3
 12961                                          REIN-AH-CLM-MTH-4
 12962                                          REIN-AH-CLM-MTH-5.
 12963
 12964*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12965*    MOVE 'L'                          TO DC-OPTION-CODE.
 12966*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12967*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12968
 12969     IF CR-LFTYP = ZEROS  OR  SPACES
 12970         GO TO 3023-CONTINUE.
 12971
 12972     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12973
 12974     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12975       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12976           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 12977
 12978     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 12979       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 12980           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 12981
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 251
* ECS010.cbl
 12982     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12983     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12984
 12985     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 12986         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 12987     ELSE
 12988         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 12989
 12990     IF CR-LF-CANC-DT NOT = ZEROS
 12991         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 12992         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12993         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 12994         IF CR-DT = CR-LF-CANC-DT
 12995             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 12996
 12997     IF CR-DTH-DT NOT = ZEROS
 12998         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 12999         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13000         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13001
 13002     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13003
 13004
 13005 3023-CONTINUE.
 13006
 13007     IF CR-AHTYP = ZEROS  OR  SPACES
 13008        GO TO 3029-CONTINUE-REIN-CALC.
 13009
 13010     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13011
 13012     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13013       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13014           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13015
 13016     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13017       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13018           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13019
 13020     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13021     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13022
 13023     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13024         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13025     ELSE
 13026         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13027
 13028     IF CR-AH-CANC-DT NOT = ZEROS
 13029         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13030         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13031         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13032         IF CR-DT = CR-AH-CANC-DT
 13033             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13034
 13035     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13036         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13037         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13038         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13039
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 252
* ECS010.cbl
 13040     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13041         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13042         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13043         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13044
 13045     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13046         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13047         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13048         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13049
 13050     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13051         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13052         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13053         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13054
 13055     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13056         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13057         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13058         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13059
 13060     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13061
 13062
 13063     GO TO 3029-CONTINUE-REIN-CALC.
 13064
 13065
 13066 3025-CALC-ELAPSED-MONTHS.
 13067
 13068     MOVE 'L'                          TO DC-OPTION-CODE.
 13069     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13070     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13071     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13072     MOVE '1'                          TO DC-OPTION-CODE.
 13073     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13074     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13075                                          DC-ODD-DAYS-OVER
 13076                                          DC-ELAPSED-DAYS.
 13077     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13078
 13079 3026-CALC-EXIT.
 13080     EXIT.
 13081
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 253
* ECS010.cbl
 13083 3029-CONTINUE-REIN-CALC.
 13084
*13085                             COPY ECSRTPFM.
 13086******************************************************************07/10/97
 13087*                                                                *ECSRTPFM
 13088*                            ECSRTPFM                            *   LV001
 13089*                            VMOD=2.002                          *ECSRTPFM
 13090*                                                                *ECSRTPFM
 13091******************************************************************ECSRTPFM
 13092                                                                  ECSRTPFM
 13093     IF    CR-LFAMT  NUMERIC                                      00000072
 13094           NEXT SENTENCE                                          00000073
 13095        ELSE                                                      00000074
 13096           MOVE ZEROS TO CR-LFAMT.                                00000075
 13097                                                                  00000076
 13098     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13099           NEXT SENTENCE                                          00000078
 13100        ELSE                                                      00000079
 13101           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13102                                                                  00000081
 13103                                                                  00000082
 13104     IF    CR-LFPRM  NUMERIC                                      00000083
 13105           NEXT SENTENCE                                          00000084
 13106        ELSE                                                      00000085
 13107           MOVE ZEROS TO CR-LFPRM.                                00000086
 13108                                                                  00000087
 13109     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13110           NEXT SENTENCE                                          00000089
 13111        ELSE                                                      00000090
 13112           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13113                                                                  00000092
 13114                                                                  00000093
 13115     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13116           NEXT SENTENCE                                          00000095
 13117        ELSE                                                      00000096
 13118           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13119                                                                  00000098
 13120     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13121           NEXT SENTENCE                                          00000100
 13122        ELSE                                                      00000101
 13123           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13124                                                                  00000103
 13125     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13126           NEXT SENTENCE                                          00000105
 13127        ELSE                                                      00000106
 13128           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13129                                                                  00000108
 13130     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13131     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13132     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13133         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13134     ELSE                                                         ECSRTPFM
 13135         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13136     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13137                                                                  ECSRTPFM
 13138     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13139     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13140     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 254
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13141         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13142     ELSE                                                         ECSRTPFM
 13143         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13144     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13145                                                                  ECSRTPFM
 13146     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13147         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13148             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13149                                                                  ECSRTPFM
 13150
 13151     MOVE 'X'                  TO REIN-RT-SW.
 13152     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13153     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13154     MOVE ' '                  TO REIN-RT-SW.
 13155
 13156 3030-RE-CALCULATE-REINSURANCE.
 13157
 13158     IF AM-RECALC-REIN = 'Y'
 13159         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13160            CR-REIN-SPEC = SPACE  AND
 13161            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13162             PERFORM 3600-RC-REINSURANCE
 13163                 THRU 3799-RC-REINSURANCE-X.
 13164
 13165     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13166         VARYING SUB1 FROM 1 BY 1
 13167             UNTIL REIN-COMP (SUB1) = SPACES.
 13168
 13169     GO TO 3099-REINSURE-ROUTINE-X.
 13170
 13171 3040-REIN-REC-CNT.
 13172
 13173     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13174         GO TO 3049-RRC-XIT.
 13175
 13176     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13177         VARYING B-SUB FROM 1 BY 1
 13178             UNTIL B-SUB GREATER THAN 50.
 13179
 13180 3049-RRC-XIT.
 13181     EXIT.
 13182
 13183 3050-REIN-COMP-ADD.
 13184
 13185     IF RB-COMPANY (B-SUB) = SPACES
 13186         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13187     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13188         MOVE 1   TO RB-COUNT (B-SUB)
 13189         MOVE +50 TO B-SUB.
 13190
 13191 3059-RCA-XIT.
 13192     EXIT.
 13193
 13194 3099-REINSURE-ROUTINE-X.
 13195     EXIT.
 13196
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 255
* ECS010.cbl
 13198******************************************************************
 13199***                R E I N S U R E   I S S U E S               ***
 13200******************************************************************
 13201
 13202 3100-REINSURE-ISSUE.
 13203
 13204     IF  REIN-COMP (1) = SPACES
 13205         GO TO 3199-REINSURE-ISSUE-X.
 13206
 13207     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13208     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13209     MOVE 'I'      TO DE-TRANS.
 13210     MOVE 'R'      TO DE-REIN.
 13211*****PERFORM EXTRACT-DATE-RELOAD.
 13212     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13213     MOVE +1       TO SUB1.
 13214
 13215 3110-REINSURE-ISSUE-LOOP.
 13216
 13217     IF REIN-COMP (SUB1) = SPACES
 13218         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13219
 13220     IF UPDATING-RISK-PREMIUMS
 13221       IF REIN-REM-SW (SUB1) NOT = 'I'
 13222         ADD +1 TO SUB1
 13223         GO TO 3110-REINSURE-ISSUE-LOOP.
 13224
 13225     IF REIN-REM-SW (SUB1) = 'Z'
 13226         ADD +1 TO SUB1
 13227         GO TO 3110-REINSURE-ISSUE-LOOP.
 13228
 13229     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13230     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13231     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13232     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13233     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13234     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13235
 13236     IF REIN-REM-SW (SUB1) NOT = 'I'
 13237         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13238
 13239     IF RWF-LFPRM = ZEROS  AND
 13240        RWF-AHPRM = ZEROS
 13241         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13242
 13243     IF RWF-LFPRM NOT = ZEROS
 13244         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13245         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13246
 13247     IF RWF-AHPRM NOT = ZEROS
 13248         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13249         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13250
 13251 3115-CONTINUE-ISSUE-LOOP.
 13252
 13253     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13254     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13255
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 256
* ECS010.cbl
 13256     IF DE-REI-LFAMT NOT = ZERO
 13257        OR DE-REI-LFPRM NOT = ZERO
 13258        OR DE-REI-AHAMT NOT = ZERO
 13259        OR DE-REI-AHPRM NOT = ZERO
 13260         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13261                 2599-WRT-DETAIL-X
 13262         ADD +1 TO BC-R-ISS.
 13263
 13264     ADD +1 TO SUB1.
 13265     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13266     PERFORM EXTRACT-DATE-LOAD.
 13267
 13268     GO TO 3110-REINSURE-ISSUE-LOOP.
 13269
 13270 3119-REINSURE-ISSUE-LOOP-END.
 13271     EXIT.
 13272
 13273 3190-REINSURE-ISSUE-PRINT.
 13274
 13275     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13276     IF RW-ACCUM-LF NOT = ZERO
 13277         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13278         MOVE CR-LF-TERM               TO TRD-LFTRM
 13279         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13280         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13281     IF RW-ACCUM-AH NOT = ZERO
 13282         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13283         MOVE CR-AH-TERM               TO TRD-AHTRM
 13284         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13285         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13286     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13287         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13288
 13289 3199-REINSURE-ISSUE-X.
 13290     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 257
* ECS010.cbl
 13292******************************************************************
 13293***               R E I N S U R E   C A N C E L S              ***
 13294******************************************************************
 13295
 13296 3200-REINSURE-CANCEL.
 13297
 13298     IF REIN-COMP (1) = SPACES
 13299         GO TO 3299-REINSURE-CANCEL-X.
 13300
 13301     IF CR-LFRFND = ZERO
 13302        AND CR-AHRFND = ZERO
 13303         GO TO 3299-REINSURE-CANCEL-X.
 13304
 13305     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13306             VARYING SUB1 FROM +1 BY +1 UNTIL
 13307                       REIN-COMP (SUB1) = SPACES.
 13308
 13309     IF REIN-RT-SW = 'X'
 13310         GO TO 3299-REINSURE-CANCEL-X.
 13311
 13312     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13313     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13314     MOVE 'R'      TO DE-REIN.
 13315*****PERFORM EXTRACT-DATE-RELOAD.
 13316     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13317     MOVE +1       TO SUB1.
 13318
 13319 3210-REINSURE-CANCEL-LOOP.
 13320
 13321     IF REIN-COMP (SUB1) = SPACES
 13322         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13323
 13324     IF REIN-REM-SW (SUB1) = 'Z'
 13325         ADD +1        TO SUB1
 13326         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13327         PERFORM EXTRACT-DATE-LOAD
 13328         GO TO 3210-REINSURE-CANCEL-LOOP.
 13329
 13330     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13331     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13332
 13333     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13334     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13335     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13336     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13337     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13338     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13339     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13340     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13341     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13342
 13343     IF REIN-REM-SW (SUB1) NOT = 'I'
 13344         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13345
 13346     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13347        VOIDING-LF-CANCEL
 13348         NEXT SENTENCE
 13349     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 258
* ECS010.cbl
 13350         MOVE ZEROS             TO DE-REI-LFRFND.
 13351
 13352     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13353        VOIDING-AH-CANCEL
 13354         NEXT SENTENCE
 13355     ELSE
 13356         MOVE ZEROS             TO DE-REI-AHRFND.
 13357
 13358 3215-CONTINUE-CANCEL-LOOP.
 13359
 13360     IF RWF-LF-RUNOFF-SW = 'N'
 13361         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13362             MOVE ZEROS         TO DE-LF-TYPE
 13363                                   DE-REI-LFAMT
 13364                                   DE-REI-LFPRM
 13365                                   DE-REI-LFRFND
 13366                                   DE-REI-CNAMT.
 13367
 13368     IF RWF-AH-RUNOFF-SW = 'N'
 13369         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13370             MOVE ZEROS         TO DE-AH-TYPE
 13371                                   DE-REI-AHAMT
 13372                                   DE-REI-AHPRM
 13373                                   DE-REI-AHRFND.
 13374
 13375     IF DE-REI-LFAMT NOT = ZERO
 13376        OR DE-REI-LFPRM NOT = ZERO
 13377        OR DE-REI-AHAMT NOT = ZERO
 13378        OR DE-REI-AHPRM NOT = ZERO
 13379        OR DE-REI-LFRFND NOT = ZERO
 13380        OR DE-REI-AHRFND NOT = ZERO
 13381        OR DE-REI-CNAMT NOT = ZERO
 13382         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13383                                            2599-WRT-DETAIL-X
 13384         ADD +1 TO BC-R-CNC.
 13385
 13386     ADD +1 TO SUB1.
 13387     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13388     PERFORM EXTRACT-DATE-LOAD.
 13389     GO TO 3210-REINSURE-CANCEL-LOOP.
 13390
 13391 3219-REINSURE-CANCEL-LOOP-END.
 13392     EXIT.
 13393
 13394 3290-REINSURE-CANCEL-PRINT.
 13395
 13396     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13397     IF RW-ACCUM-LF NOT = ZERO
 13398         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13399         MOVE CR-LF-TERM               TO TRD-LFTRM
 13400         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13401         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13402     IF RW-ACCUM-AH NOT = ZERO
 13403         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13404         MOVE CR-AH-TERM               TO TRD-AHTRM
 13405         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13406         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13407     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 259
* ECS010.cbl
 13408         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13409
 13410 3299-REINSURE-CANCEL-X.
 13411     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 260
* ECS010.cbl
 13413******************************************************************
 13414***                R E I N S U R E   C L A I M S               ***
 13415******************************************************************
 13416
 13417 3300-REINSURE-CLAIM.
 13418
 13419*    IF DTE-CLIENT = '???'
 13420*       IF (REIN-RT-SW NOT = 'X')  AND
 13421*          (PC-PAYMENT-TYPE = '5' OR '6')
 13422*        GO TO 3399-REINSURE-CLAIM-X.
 13423
 13424     IF REIN-COMP (1) = SPACES
 13425         GO TO 3399-REINSURE-CLAIM-X.
 13426
 13427     IF REIN-RT-SW = 'X'
 13428         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13429         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13430         MOVE CR-DISAMT   TO RW-AHCLMWK
 13431         ADD  CR-DISEXP   TO RW-AHCLMWK
 13432     ELSE
 13433         IF PC-CLAIM-TYPE  = 1 OR 3
 13434             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13435             MOVE +0                  TO RW-AHCLMWK
 13436         ELSE
 13437             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13438             MOVE +0                  TO RW-LFCLMWK.
 13439
 13440     MOVE +0                          TO RW-LFCLM
 13441                                         RW-AHCLM.
 13442     IF RW-LFCLMWK = ZERO
 13443        AND RW-AHCLMWK = ZERO
 13444         GO TO 3399-REINSURE-CLAIM-X.
 13445
 13446     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13447         VARYING SUB1 FROM +1 BY +1
 13448             UNTIL REIN-COMP (SUB1) = SPACES.
 13449
 13450     IF REIN-RT-SW = 'X'
 13451         GO TO 3399-REINSURE-CLAIM-X.
 13452
 13453     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13454     MOVE ZEROS                TO RW-ACCUM-CLM.
 13455     MOVE 'R'                  TO DE-REIN.
 13456*****PERFORM EXTRACT-DATE-RELOAD.
 13457     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13458     MOVE +1                   TO SUB1.
 13459
 13460 3310-REINSURE-CLAIM-LOOP.
 13461
 13462     IF REIN-COMP (SUB1) = SPACES
 13463         GO TO 3390-REINSURE-CLAIM-PRINT.
 13464
 13465     IF REIN-REM-SW (SUB1) = 'Z'
 13466         ADD +1        TO SUB1
 13467         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13468         PERFORM EXTRACT-DATE-LOAD
 13469         GO TO 3310-REINSURE-CLAIM-LOOP.
 13470
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 261
* ECS010.cbl
 13471     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13472     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13473
 13474     IF PC-CLAIM-TYPE  = 1 OR 3
 13475         IF RWF-LF-RUNOFF-SW = 'N'
 13476           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13477               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13478
 13479     IF PC-CLAIM-TYPE  = 2 OR 4
 13480         IF RWF-AH-RUNOFF-SW = 'N'
 13481           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13482               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13483
 13484     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13485     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13486     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13487     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13488
 13489     IF PC-CLAIM-TYPE  = 1 OR 3
 13490         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13491         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13492     ELSE
 13493         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13494         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13495
 13496     IF PC-CLAIM-TYPE = 1 OR 3
 13497         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13498            AND DE-REI-CLAIM-AMT
 13499             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13500         ELSE
 13501             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13502     ELSE
 13503         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13504            AND DE-REI-CLAIM-AMT
 13505             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13506         ELSE
 13507             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13508
 13509 3320-REINSURE-CLAIM-LOOP-GO.
 13510
 13511     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13512     ADD +1                     TO BC-R-CLM.
 13513
 13514 3330-REINSURE-CLAIM-LOOP-ADD.
 13515
 13516     ADD +1                     TO SUB1.
 13517     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13518     PERFORM EXTRACT-DATE-LOAD.
 13519     GO TO 3310-REINSURE-CLAIM-LOOP.
 13520
 13521 3390-REINSURE-CLAIM-PRINT.
 13522
 13523     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13524     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13525         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13526         MOVE CR-LF-TERM               TO TRD-LFTRM
 13527         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13528         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 262
* ECS010.cbl
 13529     ELSE
 13530         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13531         MOVE CR-AH-TERM               TO TRD-AHTRM
 13532         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13533         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13534         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13535         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13536         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13537         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13538     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13539
 13540 3399-REINSURE-CLAIM-X.
 13541     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 263
* ECS010.cbl
 13543******************************************************************
 13544***              R E I N S U R E   R E S E R V E S             ***
 13545******************************************************************
 13546
 13547 3400-REINSURE-RESERVE.
 13548
 13549     IF REIN-COMP (1) = SPACES
 13550         GO TO 3499-REINSURE-RESERVE-X.
 13551
 13552     IF PC-CLAIM-TYPE = '1' OR '3'
 13553         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13554         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13555         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13556         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13557         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13558     ELSE
 13559         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13560         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13561         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13562         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13563         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13564
 13565     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13566                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13567     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13568         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13569          GO TO 3499-REINSURE-RESERVE-X.
 13570
 13571     IF DTE-CLIENT NOT = 'MIC'
 13572         GO TO 3405-REINSURE-RESERVE-CONT.
 13573
 13574     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13575         GO TO 3405-REINSURE-RESERVE-CONT.
 13576
 13577     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13578     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13579     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13580     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13581                                        CP-CLAIM-TYPE.
 13582     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13583     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13584     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13585     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13586     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13587     MOVE '3'                        TO CP-CDT-METHOD.
 13588     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13589     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13590                                        CP-RATING-BENEFIT-AMT.
 13591     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13592     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13593
 13594 3405-REINSURE-RESERVE-CONT.
 13595
 13596     PERFORM 3500-REINSURE-CALC-RESERVE
 13597         THRU 3599-REINSURE-CALC-RESERVE-X
 13598             VARYING SUB1 FROM +1 BY +1
 13599                 UNTIL REIN-COMP (SUB1) = SPACES.
 13600
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 264
* ECS010.cbl
 13601     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13602     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13603     MOVE 'R'            TO DE-REIN.
 13604*****PERFORM EXTRACT-DATE-RELOAD.
 13605     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13606     MOVE +1             TO SUB1.
 13607
 13608 3410-REINSURE-RESERVE-LOOP.
 13609
 13610     IF REIN-COMP (SUB1) = SPACES
 13611         GO TO 3490-REINSURE-RESERVE-PRINT.
 13612
 13613     IF REIN-REM-SW (SUB1) = 'Z'
 13614         ADD +1 TO SUB1
 13615         GO TO 3410-REINSURE-RESERVE-LOOP.
 13616
 13617     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13618     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13619
 13620     IF PC-CLAIM-TYPE  = 1 OR 3
 13621         IF RWF-LF-RUNOFF-SW = 'N'
 13622           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13623               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13624
 13625     IF PC-CLAIM-TYPE  = 2 OR 4
 13626         IF RWF-AH-RUNOFF-SW = 'N'
 13627           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13628               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13629
 13630     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13631     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13632     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13633     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13634
 13635     IF PC-CLAIM-TYPE = 1 OR 3
 13636         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13637         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13638         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13639     ELSE
 13640         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13641         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13642         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13643
 13644     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13645     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13646     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13647
 13648     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13649        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13650        OR DE-REI-FUTRSV
 13651         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13652                                            2599-WRT-DETAIL-X
 13653         ADD +1 TO BC-R-CRS.
 13654
 13655 3415-REINSURE-RESERVE-LOOP-ADD.
 13656
 13657     ADD +1 TO SUB1.
 13658     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 265
* ECS010.cbl
 13659     PERFORM EXTRACT-DATE-LOAD.
 13660     GO TO 3410-REINSURE-RESERVE-LOOP.
 13661
 13662 3490-REINSURE-RESERVE-PRINT.
 13663
 13664     IF RW-ACCUM-IBNR   = ZERO  AND
 13665        RW-ACCUM-PAYCUR = ZERO  AND
 13666        RW-ACCUM-FUTRSV = ZERO
 13667         GO TO 3499-REINSURE-RESERVE-X.
 13668
 13669     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13670     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13671     MOVE 'IBNR'                    TO TRD-IBNRX.
 13672     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13673     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13674     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13675     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13676
 13677     IF PC-CLAIM-TYPE = 1
 13678         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13679     ELSE
 13680         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13681     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13682
 13683     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13684
 13685 3499-REINSURE-RESERVE-X.
 13686     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 266
* ECS010.cbl
 13688******************************************************************
 13689***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13690******************************************************************
 13691
 13692 3500-REINSURE-CALC-RESERVE.
 13693
 13694     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13695     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13696                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13697
 13698     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13699        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13700          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13701       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13702
 13703     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13704        MOVE ZERO TO CO-SUB.
 13705
 13706     IF CO-SUB NOT = ZERO
 13707        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13708           IF PC-CLAIM-TYPE = '1' OR '3'
 13709             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13710                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13711
 13712     IF PC-CLAIM-TYPE  = 1 OR 3
 13713         IF RWF-LF-RUNOFF-SW = 'N'
 13714           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13715               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13716
 13717     IF CO-SUB NOT = ZERO
 13718        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13719           IF PC-CLAIM-TYPE = '2' OR '4'
 13720             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13721                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13722
 13723     IF PC-CLAIM-TYPE  = 2 OR 4
 13724         IF RWF-AH-RUNOFF-SW = 'N'
 13725           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13726               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13727
 13728     IF DTE-CLIENT NOT = 'MIC'
 13729         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13730
 13731     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13732         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13733
 13734     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13735
 13736     IF CR-AHTYP = ZERO  OR
 13737        CO-SUB = ZERO
 13738         GO TO 3505-REIN-CALC-RESERVE-CONT
 13739     ELSE
 13740         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13741             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13742
 13743     COMPUTE MAX-REM-TERM ROUNDED =
 13744                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13745
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 267
* ECS010.cbl
 13746     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13747         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13748
 13749     COMPUTE CP-ORIGINAL-TERM =
 13750                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13751
 13752     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13753
 13754     IF  CP-RETURN-CODE = ZERO
 13755         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13756
 13757 3505-REIN-CALC-RESERVE-CONT.
 13758
 13759     IF SUB1 = RE-100-COMP
 13760         GO TO 3520-REIN-REMAINDER-RSRV.
 13761
 13762     IF CR-LFAMT NOT = ZERO  AND
 13763        RWF-LFAMT NOT = ZERO
 13764         IF DTE-CLIENT NOT = 'MIC'
 13765             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13766                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13767             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13768                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13769             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13770                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13771         ELSE
 13772             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13773             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13774             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13775
 13776     IF CR-AHAMT NOT = ZERO  AND
 13777        RWF-AHAMT NOT = ZERO
 13778         IF DTE-CLIENT NOT = 'MIC'
 13779             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13780                         RWF-AHAMT) / CR-AHAMT
 13781             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13782                         RWF-AHAMT) / CR-AHAMT
 13783             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13784                         RWF-AHAMT) / CR-AHAMT
 13785         ELSE
 13786             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13787             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13788             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13789
 13790 3510-REINSURE-CALC-RESERVE-ADD.
 13791
 13792     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13793     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13794     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13795     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13796     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13797     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13798
 13799     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13800         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13801
 13802     IF CO-SUB = ZERO
 13803         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 268
* ECS010.cbl
 13804
 13805 3513-REIN-CHK-LF-RSRV-LIMIT.
 13806     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13807         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13808
 13809     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13810         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13811
 13812     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13813                                      (RWF-LFCLM +
 13814                                       RWF-DTH-PAYCUR +
 13815                                       RWF-DTH-FUTRSV).
 13816
 13817     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13818         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13819
 13820     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13821
 13822     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13823         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13824         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13825     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13826         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13827
 13828     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13829
 13830     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13831         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13832         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13833     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13834         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13835
 13836 3515-REIN-CHK-AH-RSRV-LIMIT.
 13837     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13838         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13839
 13840     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13841         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13842
 13843     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13844                                      (RWF-AHCLM +
 13845                                       RWF-DIS-PAYCUR +
 13846                                       RWF-DIS-FUTRSV).
 13847
 13848     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13849         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13850
 13851     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13852
 13853     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13854         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13855         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13856     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13857         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13858
 13859     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13860
 13861     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 269
* ECS010.cbl
 13862         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13863         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13864     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13865         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13866
 13867 3519-REINSURE-CALC-RESERVE-END.
 13868
 13869     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13870        OR RWF-DTH-FUTRSV
 13871         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13872
 13873     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13874        OR RWF-DIS-FUTRSV
 13875         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13876
 13877     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13878
 13879 3520-REIN-REMAINDER-RSRV.
 13880
 13881     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13882     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13883     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13884     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13885     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13886     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13887
 13888     PERFORM 3530-REIN-SUB-RSRV
 13889         THRU 3539-REIN-SUB-RSRV-X
 13890             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13891
 13892     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13893
 13894 3530-REIN-SUB-RSRV.
 13895
 13896     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13897     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13898     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13899     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13900     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13901     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13902
 13903 3539-REIN-SUB-RSRV-X.
 13904     EXIT.
 13905
 13906 3540-CONT-REIN-CALC-RESERVE.
 13907
 13908     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13909         MOVE 'X' TO REIN-BUS-FLAG.
 13910     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13911
 13912 3599-REINSURE-CALC-RESERVE-X.
 13913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 270
* ECS010.cbl
 13915******************************************************************
 13916***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13917******************************************************************
 13918
 13919*REINSURANCE-CALCULATIONS.
*13920                             COPY ECSRIRTN.
 13921******************************************************************04/30/98
 13922*                                                                *ECSRIRTN
 13923*                            ECSRIRTN                            *   LV012
 13924*                            VMOD=2.025.                         *ECSRIRTN
 13925*                                                                *ECSRIRTN
 13926******************************************************************ECSRIRTN
 13927******************************************************************
 13928*                   C H A N G E   L O G
 13929*
 13930* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13931*-----------------------------------------------------------------
 13932*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13933* EFFECTIVE    NUMBER
 13934*-----------------------------------------------------------------
 13935* 062703                   PEMA  ADD DCC CLIENT ID TO
 13936*                                SPECIAL CEDED CLAIM CALC
 13937* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13938                                                                  ECSRIRTN
 13939 REINSURE-CALC.                                                   ECSRIRTN
 13940                                                                  ECSRIRTN
 13941     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13942     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13943     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13944     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13945                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13946                                                                  ECSRIRTN
 13947     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13948                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13949                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13950                                                                  ECSRIRTN
 13951     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13952                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13953                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13954                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13955                                                                  ECSRIRTN
 13956     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13957        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13958          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13959          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13960          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13961                                                                  ECSRIRTN
 13962     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13963        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13964         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13965                                                                  ECSRIRTN
 13966     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13967                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13968                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13969                                                                  ECSRIRTN
 13970     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13971         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13972                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 271
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13973     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13974         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13975                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 13976                                                                  ECSRIRTN
 13977     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 13978         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 13979                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13980                                                                  ECSRIRTN
 13981 CALC-CONTINUED.                                                  ECSRIRTN
 13982                                                                  ECSRIRTN
 13983     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 13984     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 13985                                                                  ECSRIRTN
 13986     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 13987         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 13988     ELSE                                                         ECSRIRTN
 13989         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 13990     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 13991                                                                  ECSRIRTN
 13992     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 13993     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 13994     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 13995         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 13996     ELSE                                                         ECSRIRTN
 13997         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 13998     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 13999                                                                  ECSRIRTN
 14000     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14001         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14002         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14003         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14004         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14005         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14006         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14007                                                                  ECSRIRTN
 14008     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14009         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14010                                                                  ECSRIRTN
 14011     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14012         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14013                                                                  ECSRIRTN
 14014     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14015         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14016                                                                  ECSRIRTN
 14017     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14018     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14019                                                                  ECSRIRTN
 14020     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14021         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14022                                                                  ECSRIRTN
 14023     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14024       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14025        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14026        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14027           NEXT SENTENCE                                          ECSRIRTN
 14028       ELSE                                                       ECSRIRTN
 14029           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
 14030                       REIN-AH-FLG (SUB1).                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 272
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14031                                                                  ECSRIRTN
 14032     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14033         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14034            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14035             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14036                                                                  ECSRIRTN
 14037     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14038         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14039            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14040             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14041                                                                  ECSRIRTN
 14042     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14043         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14044             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14045                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14046             ELSE                                                 ECSRIRTN
 14047                 NEXT SENTENCE                                    ECSRIRTN
 14048         ELSE                                                     ECSRIRTN
 14049             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14050                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14051                                                                  ECSRIRTN
 14052     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14053         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14054             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14055                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14056             ELSE                                                 ECSRIRTN
 14057                 NEXT SENTENCE                                    ECSRIRTN
 14058         ELSE                                                     ECSRIRTN
 14059             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14060                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14061                                                                  ECSRIRTN
 14062     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14063         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14064                                                                  ECSRIRTN
 14065     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14066         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14067         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14068                                                                  ECSRIRTN
 14069     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14070         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14071                                                                  ECSRIRTN
 14072     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14073         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14074         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14075                                                                  ECSRIRTN
 14076     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14077         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14078                                                                  ECSRIRTN
 14079     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14080         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14081                                                                  ECSRIRTN
 14082     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14083                                                                  ECSRIRTN
 14084 REINSURE-CK-LIFE.                                                ECSRIRTN
 14085                                                                  ECSRIRTN
 14086     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14087         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14088                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 273
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14089     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14090         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14091                                                                  ECSRIRTN
 14092     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14093         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14094             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14095                                                                  ECSRIRTN
 14096     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14097                                                                  ECSRIRTN
 14098     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14099         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14100             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14101         ELSE                                                     ECSRIRTN
 14102             NEXT SENTENCE                                        ECSRIRTN
 14103     ELSE                                                         ECSRIRTN
 14104         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14105             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14106                                                                  ECSRIRTN
 14107     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14108         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14109             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14110         ELSE                                                     ECSRIRTN
 14111             NEXT SENTENCE                                        ECSRIRTN
 14112     ELSE                                                         ECSRIRTN
 14113         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14114             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14115                                                                  ECSRIRTN
 14116     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14117         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14118             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14119                                                                  ECSRIRTN
 14120     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14121         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14122            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14123                                                                  ECSRIRTN
 14124     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14125         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14126             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14127                                                                  ECSRIRTN
 14128     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14129         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14130            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14131                                                                  ECSRIRTN
 14132     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14133         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14134             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14135                                                                  ECSRIRTN
 14136     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14137         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14138            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14139            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14140             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14141                                                                  ECSRIRTN
 14142     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14143         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14144            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14145             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14146                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 274
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14147     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14148         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14149             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14150                                                                  ECSRIRTN
 14151     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14152         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14153             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14154                                                                  ECSRIRTN
 14155     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14156        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14157           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14158            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14159                                                                  ECSRIRTN
 14160     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14161         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14162            CR-IND-GRP = '1'                                      ECSRIRTN
 14163             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14164                                                                  ECSRIRTN
 14165     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14166         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14167            CR-IND-GRP = '1'                                      ECSRIRTN
 14168             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14169                                                                  ECSRIRTN
 14170     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14171         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14172            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14173            CR-IND-GRP = '1'                                      ECSRIRTN
 14174             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14175                                                                  ECSRIRTN
 14176     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14177         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14178            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14179            CR-IND-GRP = '1'                                      ECSRIRTN
 14180             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14181                                                                  ECSRIRTN
 14182     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14183         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14184            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14185                                                                  ECSRIRTN
 14186     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14187        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14188                                                                  ECSRIRTN
 14189     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14190         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14191                                                                  ECSRIRTN
 14192     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14193         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14194                                                                  ECSRIRTN
 14195     IF CR-LF-TERM  NUMERIC                                       00002331
 14196        NEXT SENTENCE                                             00002332
 14197     ELSE                                                         00002333
 14198        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14199     END-IF
 14200                                                                  00002335
 14201     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14202         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14203                                                                  ECSRIRTN
 14204     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 275
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14205         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14206                                                                  ECSRIRTN
 14207     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14208                                                                  ECSRIRTN
 14209     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14210         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14211                                                                  ECSRIRTN
 14212     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14213         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14214                                                                  ECSRIRTN
 14215     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14216                                                                  ECSRIRTN
 14217 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14218     EXIT.                                                        ECSRIRTN
 14219                                                                  ECSRIRTN
 14220 REINSURE-CK-AH.                                                  ECSRIRTN
 14221                                                                  ECSRIRTN
 14222     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14223         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14224                                                                  ECSRIRTN
 14225     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14226         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14227                                                                  ECSRIRTN
 14228     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14229         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14230             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14231                                                                  ECSRIRTN
 14232     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14233                                                                  ECSRIRTN
 14234     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14235         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14236             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14237         ELSE                                                     ECSRIRTN
 14238             NEXT SENTENCE                                        ECSRIRTN
 14239     ELSE                                                         ECSRIRTN
 14240         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14241             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14242                                                                  ECSRIRTN
 14243     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14244         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14245             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14246                                                                  ECSRIRTN
 14247     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14248         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14249             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14250                                                                  ECSRIRTN
 14251     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14252         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14253             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14254                                                                  ECSRIRTN
 14255     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14256         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14257             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14258                                                                  ECSRIRTN
 14259     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14260         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14261            CR-IND-GRP = '1'                                      ECSRIRTN
 14262             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 276
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14263                                                                  ECSRIRTN
 14264     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14265         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14266             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14267                                                                  ECSRIRTN
 14268     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14269         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14270            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14273         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14274            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14275                                                                  ECSRIRTN
 14276     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14277         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14278             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14279                                                                  ECSRIRTN
 14280     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14281        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14282                                                                  ECSRIRTN
 14283     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14284         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14285                                                                  ECSRIRTN
 14286     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14287         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14288                                                                  ECSRIRTN
 14289     IF CR-AH-TERM  NUMERIC                                       00002331
 14290        NEXT SENTENCE                                             00002332
 14291     ELSE                                                         00002333
 14292        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14293     END-IF
 14294                                                                  00002335
 14295     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14296         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14297                                                                  ECSRIRTN
 14298     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14299         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14300                                                                  ECSRIRTN
 14301     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14302                                                                  ECSRIRTN
 14303     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14304         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14305             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14306                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14307                                                                  ECSRIRTN
 14308     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14309         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14310             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14311                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14312                                                                  ECSRIRTN
 14313     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14314     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14315                                                                  ECSRIRTN
 14316     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14317         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14318                                                                  ECSRIRTN
 14319     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
 14320         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 277
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14321                                                                  ECSRIRTN
 14322     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14323                                                                  ECSRIRTN
 14324     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14325                                                                  ECSRIRTN
 14326     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14327         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14328                                                                  ECSRIRTN
 14329     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14330         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14331                                                                  ECSRIRTN
 14332     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14333                                                                  ECSRIRTN
 14334 REINSURE-CK-AH-X.                                                ECSRIRTN
 14335     EXIT.                                                        ECSRIRTN
 14336                                                                  ECSRIRTN
 14337 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14338                                                                  ECSRIRTN
 14339     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14340        RS-AH-BEN = ZERO                                          ECSRIRTN
 14341         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14342                                                                  ECSRIRTN
 14343     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14344        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14345         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14346                                                                  ECSRIRTN
 14347     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14348                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14349                                                                  ECSRIRTN
 14350     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14351         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14352             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14353                                     WT-AHBEN-HI.                 ECSRIRTN
 14354     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14355         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14356             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14357                                     WT-AHMOA-HI.                 ECSRIRTN
 14358                                                                  ECSRIRTN
 14359     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14360     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14361                                                                  ECSRIRTN
 14362     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14363         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14364                                                                  ECSRIRTN
 14365     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14366         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14367                                                                  ECSRIRTN
 14368     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14369                                                                  ECSRIRTN
 14370     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14371         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14372                                                                  ECSRIRTN
 14373     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14374         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14375                                       / RW-AHWRK                 ECSRIRTN
 14376       ELSE                                                       ECSRIRTN
 14377         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
 14378                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 278
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14379     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14380         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14381                                       / RS-LIFE-BEN              ECSRIRTN
 14382       ELSE                                                       ECSRIRTN
 14383         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14384                                                                  ECSRIRTN
 14385     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14386        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14387          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14388          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14389                                      / CR-AH-TERM.               ECSRIRTN
 14390                                                                  ECSRIRTN
 14391     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14392        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14393          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14394          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14395               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14396            ELSE                                                  ECSRIRTN
 14397                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14398                                                                  ECSRIRTN
 14399     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14400        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14401        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14402          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14403          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14404                                      / CR-AH-TERM                ECSRIRTN
 14405         ELSE                                                     ECSRIRTN
 14406          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14407          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14408               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14409            ELSE                                                  ECSRIRTN
 14410                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14411                                                                  ECSRIRTN
 14412 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14413     EXIT.                                                        ECSRIRTN
 14414                                                                  ECSRIRTN
 14415                                                                  ECSRIRTN
 14416 REIN-CALC-LIFE.                                                  ECSRIRTN
 14417                                                                  ECSRIRTN
 14418     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14419         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14420     ELSE                                                         ECSRIRTN
 14421         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14422                                                                  ECSRIRTN
 14423     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14424         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14425     ELSE                                                         ECSRIRTN
 14426         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14427           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14428               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14429           ELSE                                                   ECSRIRTN
 14430               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14431                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14432                                                                  ECSRIRTN
 14433 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14434                                                                  ECSRIRTN
 14435     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 14436                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 279
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14437     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14438         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14439                                                                  ECSRIRTN
 14440     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14441         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14442         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14443                                                                  ECSRIRTN
 14444     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14445         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14446                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14447         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14448                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14449     ELSE                                                         ECSRIRTN
 14450         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14451             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14452             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14453                                                                  ECSRIRTN
 14454     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14455         (WT-LF-QC = '2' AND                                         CL**8
 14456          PGM-SUB = +50  AND                                         CL**8
 14457          DTE-CLIENT = 'LAP'))                                       CL**8
 14458          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14459     ELSE                                                         ECSRIRTN
 14460         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14461                                                                  ECSRIRTN
 14462     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14463         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14464         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14465         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14466                                                                  ECSRIRTN
 14467     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14468                                                                  ECSRIRTN
 14469 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14470                                                                  ECSRIRTN
 14471     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14472         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14473         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14474                                                                  ECSRIRTN
 14475     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14476     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14477     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14478                                       RW-LFPRM.                  ECSRIRTN
 14479                                                                  ECSRIRTN
 14480 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14481                                                                  ECSRIRTN
 14482     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14483                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14484                                                                  ECSRIRTN
 14485     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14486        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14487                                                                  ECSRIRTN
 14488     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14489        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14490         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14491     ELSE                                                         ECSRIRTN
 14492         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14493         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 14494                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 280
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14495                                                                  ECSRIRTN
 14496 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14497     EXIT.                                                        ECSRIRTN
 14498                                                                  ECSRIRTN
 14499 REIN-CALC-AH.                                                    ECSRIRTN
 14500                                                                  ECSRIRTN
 14501     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14502         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14503             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14504                                 WT-AHBEN-HI.                     ECSRIRTN
 14505                                                                  ECSRIRTN
 14506     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14507         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14508             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14509                                 WT-AHMOA-HI.                     ECSRIRTN
 14510                                                                  ECSRIRTN
 14511     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14512     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14513                                                                  ECSRIRTN
 14514     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14515         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14516                                                                  ECSRIRTN
 14517     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14518         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14519                                                                  ECSRIRTN
 14520     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14521         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14522                                                                  ECSRIRTN
 14523     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14524         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14525     ELSE                                                         ECSRIRTN
 14526         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14527             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14528         ELSE                                                     ECSRIRTN
 14529             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14530             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14531                                                                  ECSRIRTN
 14532 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14533                                                                  ECSRIRTN
 14534     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14535         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14536                                                                  ECSRIRTN
 14537     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14538         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14539         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14540                                                                  ECSRIRTN
 14541     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14542         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14543                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14544         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14545                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14546     ELSE                                                         ECSRIRTN
 14547         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14548             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14549             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14550                                                                  ECSRIRTN
 14551     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 14552         (WT-AH-QC = '2' AND                                         CL**8
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 281
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14553          PGM-SUB = +50  AND                                         CL**8
 14554          DTE-CLIENT = 'LAP'))                                       CL**8
 14555         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14556     ELSE                                                         ECSRIRTN
 14557         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14558                                                                  ECSRIRTN
 14559     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14560         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14561            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14562                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14563                                                                  ECSRIRTN
 14564     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14565         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14566         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14567         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14568                                                                  ECSRIRTN
 14569     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14570                                                                  ECSRIRTN
 14571 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14572                                                                  ECSRIRTN
 14573     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14574         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14575         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14576                                                                  ECSRIRTN
 14577     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14578     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14579     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14580                                    RW-AHPRM.                     ECSRIRTN
 14581                                                                  ECSRIRTN
 14582 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14583                                                                  ECSRIRTN
 14584     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14585                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14586                                                                  ECSRIRTN
 14587     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14588                                                                  ECSRIRTN
 14589     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14590        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14591         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14592     ELSE                                                         ECSRIRTN
 14593         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14594         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14595                                                                  ECSRIRTN
 14596                                                                  ECSRIRTN
 14597 REIN-CALC-AH-X.                                                  ECSRIRTN
 14598     EXIT.                                                        ECSRIRTN
 14599                                                                  ECSRIRTN
 14600 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14601                                                                  ECSRIRTN
 14602     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14603     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14604     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14605     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14606                                                                  ECSRIRTN
 14607     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14608         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14609                                                                  ECSRIRTN
 14610     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 282
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14611        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14612           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14613                                                                  ECSRIRTN
 14614     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14615        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14616           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14617                                                                  ECSRIRTN
 14618 REINSURE-CALC-X.                                                 ECSRIRTN
 14619                                                                  ECSRIRTN
 14620     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14621         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14622                                                                  ECSRIRTN
 14623     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14624                                                                  ECSRIRTN
 14625 REINSURE-SUBTRACT.                                               ECSRIRTN
 14626                                                                  ECSRIRTN
 14627     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14628     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14629     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14630     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14631                                                                  ECSRIRTN
 14632 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14633     EXIT.                                                        ECSRIRTN
 14634                                                                  ECSRIRTN
 14635 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14636                                                                  ECSRIRTN
 14637     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14638     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14639                                                                  ECSRIRTN
 14640     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14641         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14642                                                                  ECSRIRTN
 14643     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14644         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14645                                                                  ECSRIRTN
 14646     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14647         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14648             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14649                                                                  ECSRIRTN
 14650     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14651         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14652                                                                  ECSRIRTN
 14653     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14654         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14655         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14656                                                                  ECSRIRTN
 14657     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14658        MOVE ZERO                TO REIN-FACTOR
 14659     ELSE                                                         ECSRIRTN
 14660        IF DTE-CLIENT = 'GIC'  AND
 14661           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14662           MOVE +1.0             TO REIN-FACTOR
 14663        ELSE
 14664           IF DTE-CLIENT = 'DCC'
 14665              COMPUTE REIN-FACTOR = CR-LFRFND /
 14666                 (CR-LFPRM + CR-LFPRM-ALT)
 14667           ELSE
 14668              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 283
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14669                 (CR-LFPRM + CR-LFPRM-ALT)
 14670            END-IF
 14671         END-IF
 14672     END-IF
 14673                                                                  ECSRIRTN
 14674     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14675         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14676             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14677                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14678                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14679             ELSE                                                 ECSRIRTN
 14680                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14681                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14682                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14683                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14684         ELSE                                                     ECSRIRTN
 14685             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14686                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
 14687                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
 14688             ELSE                                                 ECSRIRTN
 14689*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14690*                   * REIN-CALCED-LIFE *
 14691*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14692                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14693                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14694                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14695                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14696                                                                  ECSRIRTN
 14697     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14698         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14699             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14700                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14701                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14702             ELSE                                                 ECSRIRTN
 14703                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14704                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14705                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14706                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14707                                                                  ECSRIRTN
 14708     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14709                                                                  ECSRIRTN
 14710                                                                  ECSRIRTN
 14711 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14712                                                                  ECSRIRTN
 14713     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14714       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14715         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14716         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14717                                                                  ECSRIRTN
 14718     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14719       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14720           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14721           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14722       ELSE                                                       ECSRIRTN
 14723           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 14724               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14725                                                                  ECSRIRTN
 14726     IF FLAT-CANCEL-LF                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 284
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14727         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14728         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14729                                                                  ECSRIRTN
 14730     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14731         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14732         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14733                                                                  ECSRIRTN
 14734     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14735     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14736     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14737                                         RW-LFRFND.               ECSRIRTN
 14738                                                                  ECSRIRTN
 14739 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14740                                                                  ECSRIRTN
 14741     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14742                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14743                                                                  ECSRIRTN
 14744     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14745        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14746                                                                  ECSRIRTN
 14747     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14748        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14749         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14750     ELSE                                                         ECSRIRTN
 14751         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14752         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14753                                                                  ECSRIRTN
 14754                                                                  ECSRIRTN
 14755 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14756                                                                  ECSRIRTN
 14757     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14758         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14759                                                                  ECSRIRTN
 14760     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14761         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14762             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14763                                                                  ECSRIRTN
 14764     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14765         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14766         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14767             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14768                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14769         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14770                                                                  ECSRIRTN
 14771     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14772         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14773                                                                  ECSRIRTN
 14774     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14775         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14776         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14777                                                                  ECSRIRTN
 14778     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14779        MOVE ZERO                TO REIN-FACTOR
 14780     ELSE
 14781        IF DTE-CLIENT = 'GIC'  AND
 14782           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14783            MOVE +1.0            TO REIN-FACTOR
 14784        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 285
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14785           IF DTE-CLIENT = 'DCC'
 14786              COMPUTE REIN-FACTOR =
 14787                 CR-AHRFND / CR-AHPRM
 14788           ELSE
 14789              COMPUTE REIN-FACTOR ROUNDED =
 14790                                CR-AHRFND-CALC / CR-AHPRM
 14791           END-IF
 14792        END-IF
 14793     END-IF
 14794
 14795     IF CR-AHAMT NOT = ZERO
 14796        IF (DTE-CLIENT = 'DCC')
 14797           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14798           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14799        ELSE
 14800           IF WT-AH-QC = ('1' OR '4')
 14801              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 14802                       RWF-AHAMT) / CR-AHAMT
 14803           ELSE
 14804              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14805              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14806                       RWF-AHAMT) / CR-AHAMT
 14807           END-IF
 14808        END-IF
 14809     ELSE
 14810        IF RWF-AH-LIMIT = ZERO
 14811           IF WT-AH-QC = ('1' OR '4')
 14812              COMPUTE RWF-AHRFND ROUNDED =
 14813                       CR-AHRFND * WT-AH-PCT
 14814           ELSE
 14815              COMPUTE RWF-AHRFND =
 14816                            REIN-FACTOR * REIN-CALCED-AH
 14817              COMPUTE RWF-AHRFND ROUNDED =
 14818                       RWF-AHRFND * WT-AH-PCT
 14819           END-IF
 14820        END-IF
 14821     END-IF
 14822
 14823     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14824                                                                  ECSRIRTN
 14825                                                                  ECSRIRTN
 14826 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14827                                                                  ECSRIRTN
 14828     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14829       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14830         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14831         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14832                                                                  ECSRIRTN
 14833     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14834       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14835           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14836           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14837       ELSE                                                       ECSRIRTN
 14838           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 14839               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14840                                                                  ECSRIRTN
 14841     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14842         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 286
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14843         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14844                                                                  ECSRIRTN
 14845     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14846         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14847         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14848                                                                  ECSRIRTN
 14849     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14850     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14851     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14852                                    RW-AHRFND.                    ECSRIRTN
 14853                                                                  ECSRIRTN
 14854 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14855                                                                  ECSRIRTN
 14856     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14857                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14858                                                                  ECSRIRTN
 14859     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14860                                                                  ECSRIRTN
 14861     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14862        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14863         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14864     ELSE                                                         ECSRIRTN
 14865         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14866         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14867                                                                  ECSRIRTN
 14868                                                                  ECSRIRTN
 14869 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14870                                                                  ECSRIRTN
 14871     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14872         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14873                                                                  ECSRIRTN
 14874     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14875         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14876                                                                  ECSRIRTN
 14877     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14878                                                                  ECSRIRTN
 14879 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14880                                                                  ECSRIRTN
 14881     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14882     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14883                                                                  ECSRIRTN
 14884     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14885         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14886             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14887                                                                  ECSRIRTN
 14888     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14889         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14890                                                                  ECSRIRTN
 14891     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14892         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14893                                                                  ECSRIRTN
 14894 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14895                                                                  ECSRIRTN
 14896     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14897         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14898                                                                  ECSRIRTN
 14899     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14900                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 287
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14901 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14902                                                                  ECSRIRTN
 14903     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14904     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14905                                                                  ECSRIRTN
 14906 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14907     EXIT.                                                        ECSRIRTN
 14908                                                                  ECSRIRTN
 14909 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14910                                                                  ECSRIRTN
 14911     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14912         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14913                                                                  ECSRIRTN
 14914 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14915     EXIT.                                                        ECSRIRTN
 14916                                                                  ECSRIRTN
 14917 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14918                                                                  ECSRIRTN
 14919     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14920     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14921                                                                  ECSRIRTN
 14922     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14923         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14924                                                                  ECSRIRTN
 14925     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14926        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14927          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14928          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14929          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14930                                                                  ECSRIRTN
 14931     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14932        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14933          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14934                                                                  ECSRIRTN
 14935     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14936                                  RWF-AHCLML.                     ECSRIRTN
 14937                                                                  ECSRIRTN
 14938     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14939         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14940                                                                  ECSRIRTN
 14941     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14942         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14943                                                                  ECSRIRTN
 14944     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14945         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14946             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14947                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14948                                                                  ECSRIRTN
 14949     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14950         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14951                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14952                                                                  ECSRIRTN
 14953     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14954         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 14955                                                                  ECSRIRTN
 14956     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14957         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14958             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 288
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14959                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14960             ELSE                                                 ECSRIRTN
 14961                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14962         ELSE                                                     ECSRIRTN
 14963             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14964                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14965                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14966             ELSE                                                 ECSRIRTN
 14967                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14968                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14969                                                                  ECSRIRTN
 14970     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14971         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14972                                                                  ECSRIRTN
 14973     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14974         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14975            OR 'DCC'
 14976             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 14977                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14978         ELSE                                                     ECSRIRTN
 14979             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 14980                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 14981                                                                  ECSRIRTN
 14982     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14983         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14984             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14985                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 14986                                                                  ECSRIRTN
 14987     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14988         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14989             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14990                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 14991                                                                  ECSRIRTN
 14992     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14993         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14994             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14995               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 14996                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14997                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14998                  ELSE                                            ECSRIRTN
 14999                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15000                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15001              ELSE                                                ECSRIRTN
 15002                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15003                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15004                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15005                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15006                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15007                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15008                                                                  ECSRIRTN
 15009     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15010                                                                  ECSRIRTN
 15011     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15012                                                                  ECSRIRTN
 15013                                                                  ECSRIRTN
 15014 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15015                                                                  ECSRIRTN
 15016     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 289
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15017         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15018                                                                  ECSRIRTN
 15019     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15020         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15021     ELSE                                                         ECSRIRTN
 15022         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15023                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15024                                                                  ECSRIRTN
 15025     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15026         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15027                                                                  ECSRIRTN
 15028     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15029         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15030             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15031         ELSE                                                     ECSRIRTN
 15032             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15033     ELSE                                                         ECSRIRTN
 15034         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15035             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15036             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15037         ELSE                                                     ECSRIRTN
 15038             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15039             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15040                                                                  ECSRIRTN
 15041                                                                  ECSRIRTN
 15042 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15043                                                                  ECSRIRTN
 15044     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15045         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15046                                                                  ECSRIRTN
 15047     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15048         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15049                                                                  ECSRIRTN
 15050     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15051         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15052                                                                  ECSRIRTN
 15053     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15054     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15055                                                                  ECSRIRTN
 15056     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15057             VARYING                                              ECSRIRTN
 15058         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15059             UNTIL                                                ECSRIRTN
 15060         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15061                                                                  ECSRIRTN
 15062     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15063         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15064     ELSE                                                         ECSRIRTN
 15065         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15066                                                                  ECSRIRTN
 15067 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15068                                                                  ECSRIRTN
 15069     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15070         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15071                                                                  ECSRIRTN
 15072     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15073       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15074           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 290
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15075                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15076               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15077                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15078               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15079                                                                  ECSRIRTN
 15080     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15081       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15082           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15083                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15084           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15085                                                                  ECSRIRTN
 15086     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15087         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15088                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15089                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15090         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15091                                                                  ECSRIRTN
 15092     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15093         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15094                                                                  ECSRIRTN
 15095     IF INC-SUB = +1                                              ECSRIRTN
 15096         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15097     IF INC-SUB = +2                                              ECSRIRTN
 15098         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15099     IF INC-SUB = +3                                              ECSRIRTN
 15100         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15101     IF INC-SUB = +4                                              ECSRIRTN
 15102         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15103     IF INC-SUB = +5                                              ECSRIRTN
 15104         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15105                                                                  ECSRIRTN
 15106     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15107                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15108                                                                  ECSRIRTN
 15109     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15110         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15111                                                                  ECSRIRTN
 15112     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15113              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15114         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15115     ELSE                                                         ECSRIRTN
 15116         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15117                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15118                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15119                                                                  ECSRIRTN
 15120 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15121      EXIT.                                                       ECSRIRTN
 15122                                                                  ECSRIRTN
 15123 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15124                                                                  ECSRIRTN
 15125     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15126         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15127                                                                  ECSRIRTN
 15128     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15129         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15130             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15131                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15132                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 291
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15133     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15134         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15135             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15136                                                                  ECSRIRTN
 15137 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15138                                                                  ECSRIRTN
 15139     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15140         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15141         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15142             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15143                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15144         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15145         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15146                                                                  ECSRIRTN
 15147     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15148         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15149                                                                  ECSRIRTN
 15150     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15151         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15152             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15153                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15154             ELSE                                                 ECSRIRTN
 15155                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15156         ELSE                                                     ECSRIRTN
 15157             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15158                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15159                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15160             ELSE                                                 ECSRIRTN
 15161                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15162                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15163                                                                  ECSRIRTN
 15164     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15165         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15166                                                                  ECSRIRTN
 15167     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15168         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15169                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15170     ELSE                                                         ECSRIRTN
 15171         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15172             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15173                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15174                                                                  ECSRIRTN
 15175     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15176         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15177             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15178                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15179                                                                  ECSRIRTN
 15180     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15181         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15182             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15183               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15184                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15185                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15186                  ELSE                                            ECSRIRTN
 15187                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15188                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15189              ELSE                                                ECSRIRTN
 15190                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 292
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15191                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15192                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15193                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15194                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15195                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15196                                                                  ECSRIRTN
 15197                                                                  ECSRIRTN
 15198     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15199        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15200                               '220000' OR '230000')              ECSRIRTN
 15201           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15202               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15203                                                                  ECSRIRTN
 15204     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15205                                                                  ECSRIRTN
 15206     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15207                                                                  ECSRIRTN
 15208                                                                  ECSRIRTN
 15209 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15210                                                                  ECSRIRTN
 15211     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15212         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15213                                                                  ECSRIRTN
 15214     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15215         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15216         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15217                                                                  ECSRIRTN
 15218     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15219                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15220                                                                  ECSRIRTN
 15221     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15222         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15223                                                                  ECSRIRTN
 15224     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15225         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15226                                                                  ECSRIRTN
 15227     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15228                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15229         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15230                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15231         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15232     ELSE                                                         ECSRIRTN
 15233         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15234         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15235                                                                  ECSRIRTN
 15236                                                                  ECSRIRTN
 15237 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15238                                                                  ECSRIRTN
 15239     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15240         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15241                                                                  ECSRIRTN
 15242     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15243         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15244                                                                  ECSRIRTN
 15245     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15246                                                                  ECSRIRTN
 15247 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15248                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 293
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15249     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15250     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15251                                                                  ECSRIRTN
 15252     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15253         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15254             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15255                                                                  ECSRIRTN
 15256     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15257     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15258                                                                  ECSRIRTN
 15259     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15260         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15261                                                                  ECSRIRTN
 15262     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15263         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15264                                                                  ECSRIRTN
 15265 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15266                                                                  ECSRIRTN
 15267     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15268         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15269                                                                  ECSRIRTN
 15270     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15271                                                                  ECSRIRTN
 15272 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15273                                                                  ECSRIRTN
 15274     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15275     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15276                                                                  ECSRIRTN
 15277 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15278     EXIT.                                                        ECSRIRTN
 15279                                                                  ECSRIRTN
 15280 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15281                                                                  ECSRIRTN
 15282     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15283         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15284                                                                  ECSRIRTN
 15285 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15286     EXIT.                                                        ECSRIRTN
 15287                                                                  ECSRIRTN
 15288                                                                  ECSRIRTN
 15289 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15290                                                                  ECSRIRTN
 15291     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15292     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15293     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15294     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15295                                                                  ECSRIRTN
 15296     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15297         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15298         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15299         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15300         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15301         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15302         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 15303         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15304         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15305         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15306                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 294
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15307     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15308         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15309                                                                  ECSRIRTN
 15310     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15311                                                                  ECSRIRTN
 15312 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15313                                                                  ECSRIRTN
 15314     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15315                                                                  ECSRIRTN
 15316 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15317     EXIT.                                                        ECSRIRTN
 15318                                                                  ECSRIRTN
 15319 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15320                                                                  ECSRIRTN
 15321     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15322                                                                  ECSRIRTN
 15323     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15324         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15325                                                                  ECSRIRTN
 15326     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15327         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15328             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15329                                                                  ECSRIRTN
 15330     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15331         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15332         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15333         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15334     ELSE                                                         ECSRIRTN
 15335         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15336         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15337         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15338                                                                  ECSRIRTN
 15339     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15340                                                                  ECSRIRTN
 15341     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15342        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15343         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15344                                                                  ECSRIRTN
 15345     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15346         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15347                                                                  ECSRIRTN
 15348 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15349     EXIT.                                                        ECSRIRTN
 15350                                                                  ECSRIRTN
 15351 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15352                                                                  ECSRIRTN
 15353     CONTINUE.                                                    ECSRIRTN
 15354*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15355 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15356     EXIT.                                                        ECSRIRTN
 15357                                                                  ECSRIRTN
 15358 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15359                                                                  ECSRIRTN
 15360     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 15361         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15362                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15363                                                                  ECSRIRTN
 15364     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 295
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15365         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15366                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15367                                                                  ECSRIRTN
 15368     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15369                                                                  ECSRIRTN
 15370     START ERRTBL-IN                                              ECSRIRTN
 15371           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15372             INVALID KEY                                          ECSRIRTN
 15373               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15374                                                                  ECSRIRTN
 15375     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15376     MOVE 0 TO SUB1.                                              ECSRIRTN
 15377 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15378                                                                  ECSRIRTN
 15379     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15380                                                                  ECSRIRTN
 15381     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15382        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15383                                                                  ECSRIRTN
 15384     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15385        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15386        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15387                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15388        GO TO ABEND-PGM.                                          ECSRIRTN
 15389                                                                  ECSRIRTN
 15390     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15391        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15392                                                                  ECSRIRTN
 15393     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15394        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15395                                                                  ECSRIRTN
 15396     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15397        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15398                                                                  ECSRIRTN
 15399     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15400        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15401                                                                  ECSRIRTN
 15402     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15403        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15404                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15405        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15406                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15407        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15408                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15409     END-PERFORM.                                                 ECSRIRTN
 15410     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15411                                                                  ECSRIRTN
 15412     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15413        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15414                                                                  ECSRIRTN
 15415     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15416        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 296
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15417                                                                  ECSRIRTN
 15418     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15419        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15420                                                                  ECSRIRTN
 15421     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15422        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15423                                                                  ECSRIRTN
 15424     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15425        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15426        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15427        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15428        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15429        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15430        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15431          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15432                                                                  ECSRIRTN
 15433     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15434                                                                  ECSRIRTN
 15435     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15436        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15437        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15438        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15439        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15440                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15441        GO TO ABEND-PGM.                                          ECSRIRTN
 15442                                                                  ECSRIRTN
 15443     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15444                                                                  ECSRIRTN
 15445     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15446                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15447     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15448                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15449     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15450                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15451                                                                  ECSRIRTN
 15452     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15453         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15454     ELSE                                                         ECSRIRTN
 15455         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15456                                                                  ECSRIRTN
 15457     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15458     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15459     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15460     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15461                                                                  ECSRIRTN
 15462 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15463                                                                  ECSRIRTN
 15464     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15465        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15466                                                                  ECSRIRTN
 15467     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15468        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15469                                                                  ECSRIRTN
 15470     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15471        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15472                                                                  ECSRIRTN
 15473     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15474        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 297
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15475                                                                  ECSRIRTN
 15476     ADD +1 TO SUB1.                                              ECSRIRTN
 15477                                                                  ECSRIRTN
 15478     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15479        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15480        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15481                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15482        GO TO ABEND-PGM.                                          ECSRIRTN
 15483                                                                  ECSRIRTN
 15484     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15485     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15486     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15487     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15488     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15489     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15490     if re-state-exhibit-opt-f = 'Y'
 15491        move 'Y'         to rc2-ecs152-rpt (sub1)
 15492     else
 15493        move 'N'         to rc2-ecs152-rpt (sub1)
 15494     end-if
 15495                                                                  ECSRIRTN
 15496     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15497                                                                  ECSRIRTN
 15498 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15499     EXIT.                                                        ECSRIRTN
 15500                                                                  ECSRIRTN
 15501 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15502                                                                  ECSRIRTN
 15503     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15504                                                                  ECSRIRTN
 15505     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15506                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15507                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15508                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15509                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15510                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15511                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15512                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15513                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15514                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15515                                                                  ECSRIRTN
 15516 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15517     EXIT.                                                        ECSRIRTN
 15518                                                                  ECSRIRTN
 15519 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15520                                                                  ECSRIRTN
 15521     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15522                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15523     move spaces      to rc2-ecs152-rpt (co-sub)
 15524                                                                  ECSRIRTN
 15525     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15526                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15527                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15528                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 15529                                                                  ECSRIRTN
 15530 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15531     EXIT.                                                        ECSRIRTN
 15532******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 298
* ECS010.cbl
 15534******************************************************************
 15535***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15536******************************************************************
 15537
 15538 3600-RC-REINSURANCE.
 15539
 15540     IF DTE-PGM-OPT NOT = '1'
 15541         GO TO 3799-RC-REINSURANCE-X.
 15542
 15543     IF DTE-CLIENT = 'WSL'
 15544         IF CR-REIN-TABLE = '00A'
 15545             GO TO 3799-RC-REINSURANCE-X.
 15546
 15547     IF CR-REIN-TABLE = SPACES OR ZEROS
 15548         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15549
 15550 3610-CLEAR-RC-REIN.
 15551
 15552     MOVE SPACES TO RC-REIN-LEVELS (1).
 15553     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15554                    RC-REIN-LFPRM (1)
 15555                    RC-REIN-AHAMT (1)
 15556                    RC-REIN-AHPRM (1)
 15557                    RC-REIN-LFRFND (1)
 15558                    RC-REIN-AHRFND (1)
 15559                    RC-REIN-LFCLM (1)
 15560                    RC-REIN-AHCLM (1).
 15561
 15562     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15563         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15564
 15565     MOVE +1 TO SUB1.
 15566     MOVE +0 TO SUB2.
 15567
 15568     GO TO 3630-RC-REIN-LOOP-1.
 15569
 15570 3620-CLEAR-RC-LEVELS.
 15571
 15572     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15573
 15574
 15575 3630-RC-REIN-LOOP-1.
 15576
 15577     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15578         ADD +1 TO SUB2
 15579         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15580         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15581         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15582         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15583         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15584         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15585         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15586         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15587         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15588         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15589
 15590     ADD +1 TO SUB1.
 15591     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 299
* ECS010.cbl
 15592         GO TO 3630-RC-REIN-LOOP-1.
 15593
 15594     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15595
 15596     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15597     IF CR-REIN-TABLE = SPACES OR ZEROS
 15598         MOVE +1                     TO SUB1
 15599         GO TO 3710-RC-REIN-LOOP-2.
 15600
 15601     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15602
 15603 3640-NSP-REIN-RATING-ROUTINE.
 15604
 15605     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15606     MOVE 'L'                        TO DC-OPTION-CODE.
 15607     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15608     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15609     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15610     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15611     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15612     MOVE CR-APR                     TO CP-LOAN-APR.
 15613     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15614     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15615     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15616     MOVE ZEROS                      TO CP-CLASS-CODE.
 15617
 15618     IF DTE-CLIENT = 'TIC'
 15619        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15620            MOVE ZERO                TO CP-CLASS-CODE
 15621        ELSE
 15622            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15623
 15624     MOVE '3'                        TO CP-PROCESS-TYPE.
 15625     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15626     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15627
 15628 3650-NSP-REIN-LIFE.
 15629
 15630     IF CR-LFTYP = ZERO
 15631         GO TO 3660-NSP-REIN-AH.
 15632     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15633        OR (DTE-CLIENT = 'DCC')
 15634         GO TO 3660-NSP-REIN-AH.
 15635     IF DTE-CLIENT NOT = 'LBL'
 15636         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15637             GO TO 3660-NSP-REIN-AH.
 15638
 15639     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15640         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15641         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15642
 15643     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15644     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15645     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15646                                        CP-RATING-BENEFIT-AMT.
 15647     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15648     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15649     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 300
* ECS010.cbl
 15650     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15651     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15652     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15653     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15654
 15655     IF CP-STATE-STD-ABBRV = 'OR'
 15656         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15657
 15658     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15659
 15660     IF CP-ERROR-RATE-NOT-FOUND  OR
 15661        CP-ERROR-RATE-IS-ZERO
 15662         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15663                                     TO WS-ABEND-MESSAGE
 15664         MOVE 0302                   TO WS-ABEND-CODE
 15665         DISPLAY '******************************'
 15666         DISPLAY '***** ERROR LOCATION 018 *****'
 15667         DISPLAY '******************************'
 15668         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15669         GO TO ABEND-PGM.
 15670
 15671     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15672
 15673*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15674*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15675
 15676     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15677                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15678
 15679     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15680
 15681 3660-NSP-REIN-AH.
 15682
 15683     IF CR-AHTYP = ZERO
 15684         GO TO 3669-NSP-REIN-X.
 15685     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15686        OR (DTE-CLIENT = 'DCC')
 15687         GO TO 3669-NSP-REIN-X.
 15688     IF DTE-CLIENT NOT = 'LBL'
 15689         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15690             GO TO 3669-NSP-REIN-X.
 15691
 15692     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15693         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15694         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15695
 15696     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15697     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15698     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15699                                        CP-RATING-BENEFIT-AMT.
 15700     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15701     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15702     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15703     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15704     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15705     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15706     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15707
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 301
* ECS010.cbl
 15708     IF CP-STATE-STD-ABBRV = 'OR'
 15709         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15710
 15711     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15712
 15713     IF CP-ERROR-RATE-NOT-FOUND  OR
 15714        CP-ERROR-RATE-IS-ZERO
 15715         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15716                                     TO WS-ABEND-MESSAGE
 15717         MOVE 0302                   TO WS-ABEND-CODE
 15718         DISPLAY '******************************'
 15719         DISPLAY '***** ERROR LOCATION 019 *****'
 15720         DISPLAY '******************************'
 15721         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15722         GO TO ABEND-PGM.
 15723
 15724     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15725             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15726
 15727     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15728
 15729 3669-NSP-REIN-X.
 15730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 302
* ECS010.cbl
 15732******************************************************************
 15733***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15734******************************************************************
 15735
 15736 3700-RC-REIN-PERF-CALC.
 15737
*15738                             COPY ECSRTPFM.
 15739******************************************************************07/10/97
 15740*                                                                *ECSRTPFM
 15741*                            ECSRTPFM                            *   LV001
 15742*                            VMOD=2.002                          *ECSRTPFM
 15743*                                                                *ECSRTPFM
 15744******************************************************************ECSRTPFM
 15745                                                                  ECSRTPFM
 15746     IF    CR-LFAMT  NUMERIC                                      00000072
 15747           NEXT SENTENCE                                          00000073
 15748        ELSE                                                      00000074
 15749           MOVE ZEROS TO CR-LFAMT.                                00000075
 15750                                                                  00000076
 15751     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15752           NEXT SENTENCE                                          00000078
 15753        ELSE                                                      00000079
 15754           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15755                                                                  00000081
 15756                                                                  00000082
 15757     IF    CR-LFPRM  NUMERIC                                      00000083
 15758           NEXT SENTENCE                                          00000084
 15759        ELSE                                                      00000085
 15760           MOVE ZEROS TO CR-LFPRM.                                00000086
 15761                                                                  00000087
 15762     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15763           NEXT SENTENCE                                          00000089
 15764        ELSE                                                      00000090
 15765           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15766                                                                  00000092
 15767                                                                  00000093
 15768     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15769           NEXT SENTENCE                                          00000095
 15770        ELSE                                                      00000096
 15771           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15772                                                                  00000098
 15773     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15774           NEXT SENTENCE                                          00000100
 15775        ELSE                                                      00000101
 15776           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15777                                                                  00000103
 15778     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15779           NEXT SENTENCE                                          00000105
 15780        ELSE                                                      00000106
 15781           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15782                                                                  00000108
 15783     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15784     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15785     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15786         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15787     ELSE                                                         ECSRTPFM
 15788         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15789     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 303
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15790                                                                  ECSRTPFM
 15791     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15792     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15793     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15794         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15795     ELSE                                                         ECSRTPFM
 15796         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15797     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15798                                                                  ECSRTPFM
 15799     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15800         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15801             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15802                                                                  ECSRTPFM
 15803
 15804     IF CR-STATE NOT = STATE-L
 15805         MOVE CR-STATE               TO STATE-L
 15806         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15807
 15808     MOVE 'X'                     TO REIN-RT-SW.
 15809     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15810     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15811     MOVE ' '                     TO REIN-RT-SW.
 15812
 15813 3710-RC-REIN-LOOP-2.
 15814
 15815     IF REIN-COMP (SUB1) = SPACES
 15816         GO TO 3730-RC-REIN-EXTRACTS.
 15817
 15818     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15819        ADD +1 TO SUB1
 15820         GO TO 3710-RC-REIN-LOOP-2.
 15821
 15822     MOVE +1 TO SUB2.
 15823
 15824 3720-RC-REIN-LOOP-3.
 15825
 15826     IF RC-REIN-COMP (SUB2) = SPACES
 15827         ADD +1 TO SUB1
 15828         GO TO 3710-RC-REIN-LOOP-2.
 15829
 15830     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15831         ADD +1 TO SUB2
 15832         GO TO 3720-RC-REIN-LOOP-3.
 15833
 15834     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15835        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15836        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15837        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15838         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15839         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15840
 15841     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15842        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15843         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15844         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15845
 15846     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15847         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 304
* ECS010.cbl
 15848         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15849
 15850     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15851         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15852         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15853
 15854     ADD +1 TO SUB2.
 15855     GO TO 3720-RC-REIN-LOOP-3.
 15856
 15857 3730-RC-REIN-EXTRACTS.
 15858
 15859     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15860     MOVE 'R' TO DE-REIN.
 15861     MOVE 'J' TO DE-TRANS.
 15862*****PERFORM EXTRACT-DATE-RELOAD.
 15863     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15864     MOVE +1 TO SUB1.
 15865
 15866 3740-RC-REIN-OLD-ISSUE.
 15867
 15868     IF RC-REIN-COMP (SUB1) = SPACES
 15869         MOVE +1 TO SUB1
 15870         GO TO 3745-RC-REIN-NEW-ISSUE.
 15871
 15872     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15873         ADD +1 TO SUB1
 15874         GO TO 3740-RC-REIN-OLD-ISSUE.
 15875
 15876     IF RC-OLD-ISS (SUB1) = 'X'
 15877         ADD +1 TO SUB1
 15878         GO TO 3740-RC-REIN-OLD-ISSUE.
 15879
 15880     IF RC-REIN-LFAMT (SUB1) = ZERO
 15881        AND RC-REIN-LFPRM (SUB1) = ZERO
 15882        AND RC-REIN-AHAMT (SUB1) = ZERO
 15883        AND RC-REIN-AHPRM (SUB1) = ZERO
 15884         ADD +1 TO SUB1
 15885         GO TO 3740-RC-REIN-OLD-ISSUE.
 15886
 15887     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15888     PERFORM EXTRACT-DATE-LOAD.
 15889     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15890     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15891     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15892     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15893     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15894     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15895
 15896     ADD +1 TO BC-R-ISS.
 15897     ADD +1 TO SUB1.
 15898     GO TO 3740-RC-REIN-OLD-ISSUE.
 15899
 15900 3745-RC-REIN-NEW-ISSUE.
 15901
 15902     IF REIN-COMP (SUB1) = SPACES
 15903         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15904                                         2259-END-CANCEL-BUILD
 15905         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 305
* ECS010.cbl
 15906         MOVE 'K'      TO DE-TRANS
 15907*********PERFORM EXTRACT-DATE-RELOAD
 15908         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15909         MOVE +1       TO SUB1
 15910         GO TO 3750-RC-REIN-OLD-CANCEL.
 15911
 15912     IF REIN-REM-SW (SUB1) = 'Z'
 15913         ADD +1 TO SUB1
 15914         GO TO 3745-RC-REIN-NEW-ISSUE.
 15915
 15916     IF RC-NEW-ISS (SUB1) = 'X'
 15917         ADD +1 TO SUB1
 15918         GO TO 3745-RC-REIN-NEW-ISSUE.
 15919
 15920     IF REIN-LFAMT (SUB1) = ZERO
 15921        AND REIN-LFPRM (SUB1) = ZERO
 15922        AND REIN-AHAMT (SUB1) = ZERO
 15923        AND REIN-AHPRM (SUB1) = ZERO
 15924         ADD +1 TO SUB1
 15925         GO TO 3745-RC-REIN-NEW-ISSUE.
 15926
 15927     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15928     PERFORM EXTRACT-DATE-LOAD.
 15929     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15930     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15931     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15932     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15933     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15934     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15935
 15936     ADD +1 TO BC-R-ISS.
 15937     ADD +1 TO SUB1.
 15938     GO TO 3745-RC-REIN-NEW-ISSUE.
 15939
 15940 3750-RC-REIN-OLD-CANCEL.
 15941
 15942     IF RC-REIN-COMP (SUB1) = SPACES
 15943         MOVE +1 TO SUB1
 15944         GO TO 3755-RC-REIN-NEW-CANCEL.
 15945
 15946     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15947         ADD +1 TO SUB1
 15948         GO TO 3750-RC-REIN-OLD-CANCEL.
 15949
 15950     IF RC-OLD-CNC (SUB1) = 'X'
 15951         ADD +1 TO SUB1
 15952         GO TO 3750-RC-REIN-OLD-CANCEL.
 15953
 15954     IF RC-REIN-LFRFND (SUB1) = ZERO
 15955        AND RC-REIN-AHRFND (SUB1) = ZERO
 15956         ADD +1 TO SUB1
 15957         GO TO 3750-RC-REIN-OLD-CANCEL.
 15958
 15959     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15960     PERFORM EXTRACT-DATE-LOAD.
 15961     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15962     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15963     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 306
* ECS010.cbl
 15964     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15965
 15966     ADD +1 TO BC-R-CNC.
 15967     ADD +1 TO SUB1.
 15968     GO TO 3750-RC-REIN-OLD-CANCEL.
 15969
 15970 3755-RC-REIN-NEW-CANCEL.
 15971
 15972     IF REIN-COMP (SUB1) = SPACES
 15973         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15974         MOVE 'R' TO DE-REIN
 15975         MOVE 'L' TO DE-TRANS
 15976*********PERFORM EXTRACT-DATE-RELOAD
 15977         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15978         MOVE +1 TO SUB1
 15979         GO TO 3760-RC-REIN-OLD-CLAIM.
 15980
 15981     IF REIN-REM-SW (SUB1) = 'Z'
 15982         ADD +1 TO SUB1
 15983         GO TO 3755-RC-REIN-NEW-CANCEL.
 15984
 15985     IF RC-NEW-CNC (SUB1) = 'X'
 15986         ADD +1 TO SUB1
 15987         GO TO 3755-RC-REIN-NEW-CANCEL.
 15988
 15989     IF REIN-LFRFND (SUB1) = ZERO
 15990        AND REIN-AHRFND (SUB1) = ZERO
 15991         ADD +1 TO SUB1
 15992         GO TO 3755-RC-REIN-NEW-CANCEL.
 15993
 15994     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 15995     PERFORM EXTRACT-DATE-LOAD.
 15996     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 15997     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 15998     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 15999     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16000
 16001     ADD +1 TO BC-R-CNC.
 16002     ADD +1 TO SUB1.
 16003     GO TO 3755-RC-REIN-NEW-CANCEL.
 16004
 16005 3760-RC-REIN-OLD-CLAIM.
 16006
 16007     IF RC-REIN-COMP (SUB1) = SPACES
 16008         MOVE +1 TO SUB1
 16009         GO TO 3780-RC-REIN-NEW-CLAIM.
 16010
 16011     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16012         ADD +1 TO SUB1
 16013         GO TO 3760-RC-REIN-OLD-CLAIM.
 16014
 16015     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16016         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16017
 16018     IF RC-REIN-LFCLM (SUB1) = ZERO
 16019         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16020
 16021     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 307
* ECS010.cbl
 16022     PERFORM EXTRACT-DATE-LOAD.
 16023     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16024     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16025     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16026     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16027     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16028     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16029     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16030     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16031     MOVE CR-DTH-PAY-DT TO DE-PAY
 16032                           WS-DE-PAY-N.
 16033
 16034     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16035         MOVE '3' TO DE-TYPE
 16036     ELSE
 16037         MOVE '1' TO DE-TYPE.
 16038
 16039     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16040
 16041     ADD +1 TO BC-R-CLM.
 16042
 16043 3770-RC-REIN-OLD-AH-CLM.
 16044
 16045     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16046         ADD +1 TO SUB1
 16047         GO TO 3760-RC-REIN-OLD-CLAIM.
 16048
 16049     IF RC-REIN-AHCLM (SUB1) = ZERO
 16050         ADD +1 TO SUB1
 16051         GO TO 3760-RC-REIN-OLD-CLAIM.
 16052
 16053     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16054     PERFORM EXTRACT-DATE-LOAD.
 16055     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16056     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16057     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16058     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16059     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16060     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16061     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16062     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16063     MOVE CR-DIS-PAY-DT TO DE-PAY
 16064                           WS-DE-PAY-N.
 16065
 16066     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16067         MOVE '4' TO DE-TYPE
 16068     ELSE
 16069         MOVE '2' TO DE-TYPE.
 16070
 16071     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16072
 16073     ADD +1 TO BC-R-CLM.
 16074     ADD +1 TO SUB1.
 16075
 16076     GO TO 3760-RC-REIN-OLD-CLAIM.
 16077
 16078 3780-RC-REIN-NEW-CLAIM.
 16079
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 308
* ECS010.cbl
 16080     IF REIN-COMP (SUB1) = SPACES
 16081         GO TO 3799-RC-REINSURANCE-X.
 16082
 16083     IF REIN-REM-SW (SUB1) = 'Z'
 16084         ADD +1 TO SUB1
 16085         GO TO 3780-RC-REIN-NEW-CLAIM.
 16086
 16087     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16088         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16089
 16090     IF REIN-LFCLM (SUB1) = ZERO
 16091         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16092
 16093     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16094     PERFORM EXTRACT-DATE-LOAD.
 16095     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16096     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16097     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16098     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16099     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16100     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16101     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16102     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16103     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16104                               WS-DE-PAY-N.
 16105
 16106     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16107         MOVE '3' TO DE-TYPE
 16108     ELSE
 16109         MOVE '1' TO DE-TYPE.
 16110
 16111     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16112
 16113     ADD +1 TO BC-R-CLM.
 16114
 16115 3790-RC-REIN-NEW-AH-CLM.
 16116
 16117     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16118         ADD +1 TO SUB1
 16119         GO TO 3780-RC-REIN-NEW-CLAIM.
 16120
 16121     IF REIN-AHCLM (SUB1) = ZERO
 16122         ADD +1 TO SUB1
 16123         GO TO 3780-RC-REIN-NEW-CLAIM.
 16124
 16125     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16126     PERFORM EXTRACT-DATE-LOAD.
 16127     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16128     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16129     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16130     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16131     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16132     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16133     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16134     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16135     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16136                               WS-DE-PAY-N.
 16137
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 309
* ECS010.cbl
 16138     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16139         MOVE '4' TO DE-TYPE
 16140     ELSE
 16141         MOVE '2' TO DE-TYPE.
 16142
 16143     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16144
 16145     ADD +1 TO BC-R-CLM.
 16146     ADD +1 TO SUB1.
 16147
 16148     GO TO 3780-RC-REIN-NEW-CLAIM.
 16149
 16150 3799-RC-REINSURANCE-X.
 16151     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 310
* ECS010.cbl
 16153******************************************************************
 16154***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16155******************************************************************
 16156
 16157 4000-EP-BUMP-RTN.
 16158
 16159     IF AM-RECALC-COMM = ('Y' OR '1')
 16160        PERFORM 1600-RECALC-COMM-EXTR
 16161                                 THRU 1899-RECALC-COMM-EXTR-X
 16162        MOVE ' '                 TO RECALC-TYPE
 16163     END-IF
 16164
 16165     MOVE '1'    TO EP-FLG.
 16166     ADD +1      TO BC-G-CERTS.
 16167
 16168     MOVE CR-DT               TO HIGH-CERT.
 16169     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16170         MOVE CR-DT           TO LOW-CERT
 16171         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16172
 16173     IF CR-POLICY-IS-REIN-ONLY
 16174         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16175                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16176                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16177                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16178                              DTH-IBNR           DIS-IBNR
 16179                              DTH-PAYCUR         DIS-PAYCUR
 16180                              DTH-FUTRSV         DIS-FUTRSV
 16181         GO TO 4050-EP-DO-REINSURE.
 16182
 16183     MOVE CR-LFAMT       TO WE-LFAMT.
 16184     MOVE CR-LFPRM       TO WE-LFPRM.
 16185     IF CR-LFTYP NOT = ZEROS
 16186         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16187             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16188             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16189         ELSE
 16190             MOVE ZEROS               TO WE-LFAMT-ALT
 16191                                         WE-LFPRM-ALT.
 16192
 16193     MOVE SPACES         TO REIN-EP-FLG
 16194                            WE-REIN-CO.
 16195     MOVE CR-LFRFND      TO WE-LFRFND.
 16196     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16197     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16198     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16199     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16200     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16201     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16202     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16203
 16204     MOVE CR-AHPRM       TO WE-AHPRM.
 16205     MOVE CR-AHAMT       TO WE-AHAMT.
 16206     MOVE CR-AHRFND      TO WE-AHRFND.
 16207     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16208     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16209     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16210     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 311
* ECS010.cbl
 16211     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16212     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16213     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16214
 16215     IF CR-POLICY-IS-RESTORE  OR
 16216        CR-POLICY-IS-REISSUE
 16217        OR CR-POLICY-IS-MONTHLY
 16218         MOVE ZEROS      TO WE-LFPRM
 16219                            WE-LFPRM-ALT
 16220                            WE-AHPRM.
 16221
 16222     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16223                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16224                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16225                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16226                              DTH-IBNR           DIS-IBNR
 16227                              DTH-PAYCUR         DIS-PAYCUR
 16228                              DTH-FUTRSV         DIS-FUTRSV.
 16229
 16230*     DISPLAY ' B4 4100 '
 16231     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16232*     DISPLAY ' AFTER 4100 '
 16233
 16234     IF CR-POLICY-IS-DECLINED  OR
 16235        CR-POLICY-IS-VOID
 16236         GO TO 4099-EP-BUMP-RTN-X.
 16237
 16238 4050-EP-DO-REINSURE.
 16239
 16240     MOVE 'R' TO REIN-EP-FLG.
 16241     MOVE +1  TO SUB5.
 16242
 16243 4090-EP-DO-REINSURE-LOOP.
 16244
 16245*     DISPLAY ' 4090 '
 16246     IF REIN-COMP (SUB5) = SPACES
 16247         MOVE SPACE TO REIN-EP-FLG
 16248         GO TO 4099-EP-BUMP-RTN-X.
 16249
 16250     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16251        REIN-LF-AH-FLGS (SUB5) = SPACES
 16252         ADD +1 TO SUB5
 16253         GO TO 4090-EP-DO-REINSURE-LOOP.
 16254
 16255     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16256        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16257          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16258          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16259          (RCT-REIN-CO (CO-SUB) = SPACES).
 16260
 16261     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16262        (RCT-REIN-CO (CO-SUB) = SPACES)
 16263        MOVE ZERO TO CO-SUB.
 16264
 16265*     DISPLAY ' 4090 A '
 16266*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16267     ADD +1 TO BC-R-CERTS.
 16268     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 312
* ECS010.cbl
 16269     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16270     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16271
 16272     IF (DTE-CLIENT = 'DCC')
 16273        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16274*        DISPLAY ' B4 CEDE FACT '
 16275*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16276*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16277*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16278        COMPUTE WS-CEDE-FACT =
 16279           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16280*        DISPLAY ' AFTER CEDE FACT '
 16281        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16282           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16283                                     NOT = 'G' AND 'L')
 16284           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16285*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16286*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16287           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16288           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16289        END-IF
 16290     END-IF
 16291
 16292     MOVE RWF-LFPRM      TO WE-LFPRM.
 16293     MOVE RWF-LFAMT      TO WE-LFAMT.
 16294     MOVE RWF-LFRFND     TO WE-LFRFND.
 16295     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16296     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16297     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16298     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16299     MOVE +0             TO WE-LFAMT-ALT
 16300                            WE-LFPRM-ALT
 16301                            WE-DTHEXP
 16302                            WE-NUM-DTH-CLM.
 16303
 16304*     DISPLAY ' 4090 B '
 16305     IF (DTE-CLIENT EQUAL 'NSL') AND
 16306        (CR-REIN-TABLE EQUAL 'NAR')
 16307        CONTINUE
 16308     ELSE
 16309      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16310       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16311        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16312            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16313        COMPUTE WE-LFAMT ROUNDED EQUAL
 16314                           CR-LFAMT * WS-CEDE-FACT
 16315        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16316                           CR-LFAMT-ALT * WS-CEDE-FACT
 16317        IF (DTE-CLIENT = 'CID')
 16318           AND (CR-LF-NSP-PRM > +0)
 16319           AND (CR-ENTRY-DATE > 20031130)
 16320           AND (WT-LF-QC NOT = '1' AND '3')
 16321           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16322              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16323           MOVE +0            TO WE-LFPRM-ALT
 16324        ELSE
 16325          IF (DTE-CLIENT = 'CID')
 16326             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 313
* ECS010.cbl
 16327             AND (CR-ENTRY-DATE > 20030430)
 16328             AND (WT-LF-QC NOT = '1' AND '3')
 16329             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16330             MOVE +0            TO WE-LFPRM-ALT
 16331          ELSE
 16332             COMPUTE WE-LFPRM ROUNDED EQUAL
 16333                           CR-LFPRM * WS-CEDE-FACT
 16334             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16335                           CR-LFPRM-ALT * WS-CEDE-FACT
 16336          END-IF
 16337        END-IF
 16338        IF (DTE-CLIENT = 'CID')
 16339           AND (CR-LF-NSP-PRM > +0)
 16340           AND (CR-LFRFND-CALC > +0)
 16341           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16342           AND (WT-LF-QC NOT = '1' AND '4')
 16343           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16344              (CR-LFPRM + CR-LFPRM-ALT)
 16345           COMPUTE WE-LFRFND =
 16346              REIN-FACTOR * REIN-CALCED-LIFE
 16347           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16348              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16349*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16350*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16351*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16352        ELSE
 16353
 16354          IF (DTE-CLIENT = 'CID')
 16355           AND (CR-LF-NSP-PRM > +0)
 16356           AND (CR-LFRFND-CALC > +0)
 16357           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16358           AND (WT-LF-QC NOT = '1' AND '4')
 16359           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16360           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16361              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16362
 16363          END-IF
 16364        END-IF
 16365       ELSE
 16366         MOVE +0 TO WS-CEDE-FACT
 16367       END-IF
 16368      END-IF
 16369     END-IF
 16370
 16371*     DISPLAY ' 4090 C '
 16372     IF DTE-CLIENT = 'DCC'
 16373        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16374           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16375                                   NOT = 'G' AND 'L')
 16376           AND (CR-AHAMT NOT = ZEROS)
 16377*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16378           COMPUTE WS-CEDE-FACT =
 16379               RWF-AHAMT / CR-AHAMT
 16380           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16381*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16382*          / CR-AHPRM * CR-AHRFND
 16383           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16384           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 314
* ECS010.cbl
 16385        END-IF
 16386     END-IF
 16387
 16388     MOVE RWF-AHPRM      TO WE-AHPRM.
 16389
 16390     MOVE RWF-AHAMT      TO WE-AHAMT
 16391     MOVE RWF-AHRFND     TO WE-AHRFND.
 16392     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16393     MOVE +0             TO WE-DSPY-EXP
 16394                            WE-NUM-DIS-CLM.
 16395     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16396     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16397     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16398
 16399     IF  RWF-LF-RUNOFF-SW = 'N'
 16400             OR
 16401         RWF-AH-RUNOFF-SW = 'N'
 16402         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16403
 16404     IF  RWF-LF-RUNOFF-SW = 'N'
 16405         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16406     ELSE
 16407         MOVE 99999999             TO STOP-LF-DATE.
 16408
 16409     IF  RWF-AH-RUNOFF-SW = 'N'
 16410         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16411     ELSE
 16412         MOVE 99999999             TO STOP-AH-DATE.
 16413
 16414     IF CR-POLICY-IS-RESTORE  OR
 16415        CR-POLICY-IS-REISSUE
 16416        OR CR-POLICY-IS-MONTHLY
 16417         MOVE ZEROS      TO WE-LFPRM
 16418                            WE-LFPRM-ALT
 16419                            WE-AHPRM.
 16420
 16421*     DISPLAY ' B4 4100-EP-DO-LF '
 16422     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16423*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16424
 16425     IF CO-SUB NOT = ZERO
 16426       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16427         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16428             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16429
 16430     ADD +1 TO SUB5.
 16431     GO TO 4090-EP-DO-REINSURE-LOOP.
 16432
 16433 4099-EP-BUMP-RTN-X.
 16434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 315
* ECS010.cbl
 16436******************************************************************
 16437***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16438******************************************************************
 16439
 16440 4100-EP-DO-LF.
 16441
 16442     MOVE +0                         TO ISS-BEN  EPR-R78
 16443                                        CNC-BEN  EPR-PRO
 16444                                        ISS-PRM  EPR-ST
 16445                                        ISS-PRMTAX
 16446                                        CNC-PRM  ACTIVE-COUNT.
 16447     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16448
 16449     IF CR-LFTYP = ZERO
 16450         GO TO 4200-EP-DO-AH.
 16451
 16452     IF REIN-EP-FLG = 'R'
 16453         IF REIN-LF-FLG (SUB5) = SPACE
 16454             GO TO 4200-EP-DO-AH.
 16455
 16456     IF CR-APR NOT NUMERIC
 16457         MOVE ZERO TO CR-APR.
 16458
 16459     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16460     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16461     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16462
 16463     IF CR-POLICY-IS-DECLINED  OR
 16464        CR-POLICY-IS-VOID
 16465         GO TO 4191-CONTINUE.
 16466
 16467     MOVE CR-LF-TERM             TO ORIG-TERM.
 16468     MOVE CLAS-INDEXL            TO W-NDX.
 16469
 16470     IF CR-DT GREATER EW-COV-DTE
 16471         MOVE CR-DT              TO EW-COV-DTE.
 16472
 16473     IF (NOT CR-POLICY-IS-RESTORE) AND
 16474        (NOT CR-POLICY-IS-REISSUE)
 16475        AND (NOT CR-POLICY-IS-MONTHLY)
 16476         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16477         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16478             ADD CR-LIVES TO EW-ISS-CNT
 16479             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16480                                    (ORIG-TERM * CR-LIVES)
 16481             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16482             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16483             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16484                                   (ORIG-TERM * ISS-BEN)
 16485         ELSE
 16486             IF (DTE-CLIENT = 'DCC')
 16487                AND (CR-LFTYP = 'DD')
 16488                CONTINUE
 16489             ELSE
 16490                ADD +1 TO EW-ISS-CNT
 16491             END-IF
 16492             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16493             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 316
* ECS010.cbl
 16494             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16495             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16496                                   (ORIG-TERM * ISS-BEN).
 16497
 16498     MOVE RUN-DATE        TO VALUATION-DT.
 16499     MOVE '2'             TO W-VAL-SOURCE.
 16500
 16501     IF REIN-EP-FLG = 'R'
 16502         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16503            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16504             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16505             MOVE '10'              TO W-VAL-SOURCE.
 16506
 16507     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16508
 16509     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16510        (REM-TRM3 GREATER ZERO)
 16511        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16512            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16513                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16514            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16515                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16516          ELSE
 16517            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16518            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16519
 16520     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16521
 16522     IF DTE-CLIENT = 'GIC'
 16523         IF REIN-EP-FLG NOT = 'R'  AND
 16524            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16525            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16526            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16527
 16528     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16529         GO TO 4105-EP-DO-LF-REIN-CHK.
 16530
 16531     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16532             AND
 16533         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16534             AND
 16535         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16536                 OR
 16537             CR-LF-CANC-DT EQUAL ZEROS)
 16538             AND
 16539         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16540                 OR
 16541             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16542         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16543         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16544                 VARYING
 16545             SUBM FROM +1 BY +1
 16546                 UNTIL
 16547             SUBM GREATER THAN +13.
 16548
 16549     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16550     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16551
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 317
* ECS010.cbl
 16552 4105-EP-DO-LF-REIN-CHK.
 16553
 16554     IF REIN-EP-FLG = 'R'  AND
 16555        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16556         NEXT SENTENCE
 16557     ELSE
 16558         GO TO 4110-EP-DO-LF-CLM.
 16559
 16560     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16561         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16562             GO TO 4130-EP-DO-LF-EP.
 16563
 16564     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16565         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16566             GO TO 4130-EP-DO-LF-EP.
 16567
 16568 4110-EP-DO-LF-CLM.
 16569
 16570     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16571         NEXT  SENTENCE
 16572       ELSE
 16573         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16574
 16575     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16576     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16577
 16578     IF CR-LF-STATUS-AT-DEATH = ' '
 16579         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16580             GO TO 4115-EP-DO-LF-CLM-EPR.
 16581
 16582     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16583     ADD +1             TO EW-CLM-CRT.
 16584
 16585 4115-EP-DO-LF-CLM-EPR.
 16586
 16587     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16588         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16589         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16590     END-IF
 16591     .
 16592 4120-EP-DO-LF-CNCL.
 16593
 16594     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16595        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16596         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16597             GO TO 4190-EP-DO-LF-COMM
 16598         ELSE
 16599             GO TO 4130-EP-DO-LF-EP.
 16600
 16601     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16602         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16603         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16604
 16605     IF CR-LFTYP NOT = 'DD'
 16606        ADD +1                    TO EW-CNC-CNT
 16607     END-IF
 16608
 16609     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 318
* ECS010.cbl
 16610
 16611     IF DTE-CLIENT = 'GIC'
 16612         IF REIN-EP-FLG NOT = 'R'  AND
 16613            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16614             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16615
 16616*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16617*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16618*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16619*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16620
 16621     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16622     MOVE 'L'                   TO  DC-OPTION-CODE.
 16623     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16624     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16625
 16626     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16627     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16628     MOVE '1'                     TO  DC-OPTION-CODE.
 16629     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16630     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16631     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16632                                      DC-ODD-DAYS-OVER
 16633                                      DC-ELAPSED-DAYS.
 16634     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16635     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16636
 16637     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16638         ADD  +1                  TO  MONTHS-DIFF-LF.
 16639
 16640     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16641
 16642     if (dte-client = 'AHL')
 16643        and (cr-lf-cancel-exit-date < 20120401)
 16644        go to 4120-continue-life-cancel
 16645     end-if
 16646
 16647     IF DTE-CLIENT = 'ACE'
 16648         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16649
 16650     MOVE  ZEROS                  TO  SUB.
 16651
 16652 4120-LIFE-CHARGEBACK-LOOP.
 16653
 16654     ADD    +1                    TO  SUB.
 16655
 16656     IF  SUB  GREATER THAN  +10
 16657         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16658
 16659     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16660         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16661         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16662
 16663     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16664         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16665
 16666     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16667         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 319
* ECS010.cbl
 16668
 16669     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16670
 16671
 16672 4120-CONTINUE-LIFE-CANCEL.
 16673
 16674     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16675     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16676
 16677     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16678         GO TO 4190-EP-DO-LF-COMM.
 16679
 16680     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16681         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16682         GO TO 4190-EP-DO-LF-COMM.
 16683
 16684     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16685     MOVE '3'           TO W-VAL-SOURCE.
 16686     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16687
 16688     IF REM-TRM3 = CR-LF-TERM
 16689         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16690         GO TO 4190-EP-DO-LF-COMM.
 16691
 16692     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16693         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16694
 16695     IF DTE-CLIENT = 'NCL'
 16696         IF CR-DT LESS THAN 19910101
 16697             GO TO 4121-EP-DO-LF-CNC-BEN.
 16698
 16699     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16700         GO TO 4126-EP-DO-LF-CNCL-NP.
 16701
 16702     IF DTE-CLIENT = 'FUL'
 16703         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16704
 16705*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16706     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16707        (CR-RATING-CLASS NOT = 'L ')
 16708         IF (CR-APR GREATER THAN ZERO)  AND
 16709            (CR-LF-TERM GREATER THAN 060)  AND
 16710            (CR-DT GREATER THAN 19831031)
 16711              GO TO 4126-EP-DO-LF-CNCL-NP.
 16712
 16713     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16714         IF (CR-APR GREATER THAN ZERO)  AND
 16715            (CR-LF-TERM GREATER THAN 061)  AND
 16716            (CR-DT GREATER THAN 19830318)
 16717              GO TO 4126-EP-DO-LF-CNCL-NP.
 16718
 16719     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16720         IF (CR-APR GREATER THAN ZERO)  AND
 16721            (CR-LF-TERM GREATER THAN 062)  AND
 16722            (CR-DT GREATER THAN 19810831)  AND
 16723            (CR-DT LESS THAN 19830901)
 16724              GO TO 4126-EP-DO-LF-CNCL-NP.
 16725
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 320
* ECS010.cbl
 16726     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16727         IF (CR-APR GREATER THAN ZERO)  AND
 16728            (CR-LF-TERM GREATER THAN 060)  AND
 16729            (CR-DT GREATER THAN 19831231)
 16730              GO TO 4126-EP-DO-LF-CNCL-NP.
 16731
 16732 4121-EP-DO-LF-CNC-BEN.
 16733
 16734     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16735
 16736     COMPUTE TEMP-3 ROUNDED EQUAL
 16737         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16738
 16739     MOVE TEMP-3                 TO CNC-BEN.
 16740
 16741     GO TO 4190-EP-DO-LF-COMM.
 16742
 16743 4122-EP-DO-LF-CNCL-TEX.
 16744
 16745     DIVIDE WE-LFAMT BY CR-LF-TERM
 16746         GIVING TEX-FACT-1.
 16747     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16748         GIVING TEX-FACT-2
 16749             REMAINDER TEX-FACT-3.
 16750     IF TEX-FACT-3 NOT = ZERO
 16751         ADD +1 TO TEX-FACT-2.
 16752
 16753     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16754
 16755     GO TO 4190-EP-DO-LF-COMM.
 16756
 16757 4124-EP-DO-LF-CNCL-SUM.
 16758
 16759     IF WE-LFRFND = ZERO
 16760         GO TO 4130-EP-DO-LF-EP.
 16761
 16762     MOVE WE-LFRFND TO CNC-PRM.
 16763
 16764     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16765
 16766     IF WE-LFRFND NOT LESS WE-LFPRM
 16767         MOVE WE-LFAMT TO CNC-BEN
 16768          GO TO 4130-EP-DO-LF-EP.
 16769
 16770
 16771     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16772
 16773     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16774         MOVE TEMP-7 TO CNC-BEN
 16775          GO TO 4130-EP-DO-LF-EP.
 16776
 16777     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16778     MOVE '4'           TO W-VAL-SOURCE.
 16779     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16780
 16781     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16782         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16783         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 321
* ECS010.cbl
 16784
 16785 4126-EP-DO-LF-CNCL-NP.
 16786
 16787     IF WE-LFAMT = ZERO
 16788        GO TO 4190-EP-DO-LF-COMM.
 16789
 16790     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16791     MOVE 'L'                        TO  DC-OPTION-CODE.
 16792     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16793     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16794
 16795     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16796       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16797       MOVE '3'                      TO  DC-OPTION-CODE
 16798       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16799       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16800     ELSE
 16801       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16802       MOVE '6'                      TO  DC-OPTION-CODE
 16803       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16804       MOVE +0                       TO  DC-ELAPSED-DAYS
 16805       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16806       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16807
 16808     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16809     MOVE CR-APR                     TO  CP-LOAN-APR.
 16810     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16811     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16812     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16813     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16814     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16815     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16816
 16817
 16818     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16819     IF (DTE-CLIENT = 'DCC')
 16820        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16821        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16822           ((CR-STATE = DD-STATE (D1))
 16823           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16824           AND ('A'           = DD-BEN-TYPE   (D1))
 16825           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 16826           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16827                           OR
 16828           D1 > +800
 16829        END-PERFORM
 16830        IF D1 < +801
 16831           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 16832              (P1 > +8)
 16833              OR (DD-PROD-CODE (D1 P1) = 'L')
 16834           END-PERFORM
 16835           IF P1 < +9
 16836              MOVE DD-MAX-BEN-AMT (D1 P1)
 16837                                 TO CP-R-MAX-TOT-BEN
 16838           END-IF
 16839        END-IF
 16840     END-IF
 16841
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 322
* ECS010.cbl
 16842     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16843
 16844     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16845       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16846       GO TO 4130-EP-DO-LF-EP
 16847     ELSE
 16848       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16849
 16850     GO TO 4190-EP-DO-LF-COMM.
 16851
 16852 4128-EP-DO-LF-CNCL-FUL.
 16853
 16854     IF WE-LFAMT = ZERO
 16855        GO TO 4190-EP-DO-LF-COMM.
 16856
 16857     MOVE CR-APR              TO NP-APR.
 16858     MOVE CR-LF-TERM          TO NP-ORIG.
 16859     MOVE REM-TRM3            TO NP-REM.
 16860     MOVE '2'                 TO NP-OPT.
 16861     MOVE CR-AHPRM            TO NP-AHPRM.
 16862     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16863     MOVE CR-LFAMT            TO NP-BENEFIT.
 16864
 16865*    CALL 'FULNETRM'
 16866*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16867*              NP-ACCOUNT NP-REMAINING.
 16868
 16869     MOVE NP-REMAINING TO CNC-BEN.
 16870
 16871     GO TO 4190-EP-DO-LF-COMM.
 16872
 16873 4130-EP-DO-LF-EP.
 16874
 16875     MOVE SPACE                  TO STATUTORY-SWITCH.
 16876
 16877     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16878     MOVE '5'           TO W-VAL-SOURCE.
 16879
 16880     IF REIN-EP-FLG = 'R'
 16881       IF REIN-REM-SW (SUB5) = 'I'
 16882           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16883           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16884           GO TO 4190-EP-DO-LF-COMM.
 16885
 16886     IF REIN-EP-FLG = 'R'
 16887         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16888            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16889             MOVE '*'               TO LIFE-EARNED-SWITCH
 16890             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16891             MOVE '10'              TO W-VAL-SOURCE.
 16892
 16893     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16894
 16895     IF REM-TRM2 GREATER CR-LF-TERM
 16896         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16897         GO TO 4190-EP-DO-LF-COMM.
 16898
 16899     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 323
* ECS010.cbl
 16900         GO TO 4180-EP-DO-LF-EP-SUM.
 16901
 16902     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16903         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16904             IF REM-TRM2 NOT GREATER THAN +0
 16905                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16906                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16907                 GO TO 4190-EP-DO-LF-COMM
 16908             ELSE
 16909                 NEXT SENTENCE
 16910         ELSE
 16911             IF W-BAL-REMTRM NOT GREATER +0
 16912                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16913                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16914                 GO TO 4190-EP-DO-LF-COMM
 16915             ELSE
 16916                 NEXT SENTENCE
 16917     ELSE
 16918        IF DTE-CLIENT = 'NCL'  AND
 16919           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16920            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16921        ELSE
 16922         IF REM-TRM2 NOT GREATER +0  OR
 16923            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16924             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16925             GO TO 4190-EP-DO-LF-COMM.
 16926
 16927     MOVE +1 TO ACTIVE-COUNT.
 16928
 16929     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16930         GO TO 4140-EP-DO-LF-EP-TEX.
 16931
 16932     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16933         GO TO 4150-EP-DO-LF-EP-NP.
 16934
 16935*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16936     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16937        (CR-RATING-CLASS NOT = 'L ')
 16938         IF (CR-APR GREATER THAN ZERO)  AND
 16939            (CR-LF-TERM GREATER THAN 060)  AND
 16940            (CR-DT GREATER THAN 19831031)
 16941             MOVE '*'             TO STATUTORY-SWITCH
 16942              GO TO 4150-EP-DO-LF-EP-NP.
 16943
 16944     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16945         IF (CR-APR GREATER THAN ZERO)  AND
 16946            (CR-LF-TERM GREATER THAN 061)  AND
 16947            (CR-DT GREATER THAN 19830318)
 16948             MOVE '*'             TO STATUTORY-SWITCH
 16949              GO TO 4150-EP-DO-LF-EP-NP.
 16950
 16951     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16952         IF (CR-APR GREATER THAN ZERO)  AND
 16953            (CR-LF-TERM GREATER THAN 062)  AND
 16954            (CR-DT GREATER THAN 19810831)  AND
 16955            (CR-DT LESS THAN 19830901)
 16956             MOVE '*'             TO STATUTORY-SWITCH
 16957              GO TO 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 324
* ECS010.cbl
 16958
 16959     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16960         IF (CR-APR GREATER THAN ZERO)  AND
 16961            (CR-LF-TERM GREATER THAN 060)  AND
 16962            (CR-DT GREATER THAN 19831231)
 16963             MOVE '*'             TO STATUTORY-SWITCH
 16964              GO TO 4150-EP-DO-LF-EP-NP.
 16965
 16966     GO TO 4160-EP-DO-LF-EP-R78.
 16967
 16968 4140-EP-DO-LF-EP-TEX.
 16969
 16970     IF CR-PMT-FREQ = 0
 16971       DISPLAY '*************************************'
 16972       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16973       DISPLAY '*************************************'
 16974       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16975       DISPLAY '*************************************'
 16976       COMPUTE TEX-FACT-4 =
 16977          (CR-LF-TERM * CR-LF-TERM) +
 16978                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 16979     ELSE
 16980        COMPUTE TEX-FACT-4 =
 16981         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16982
 16983     IF CR-PMT-FREQ = 0
 16984       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 16985           GIVING TEX-FACT-5
 16986               REMAINDER TEX-FACT-6
 16987     ELSE
 16988        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16989            GIVING TEX-FACT-5
 16990                REMAINDER TEX-FACT-6.
 16991
 16992     IF CR-PMT-FREQ > 0
 16993        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 16994
 16995     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16996     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16997         (TEX-FACT-5 * CR-PMT-FREQ) +
 16998         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16999     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17000
 17001     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17002
 17003     GO TO 4170-EP-DO-LF-EP-PRO.
 17004
 17005 4150-EP-DO-LF-EP-NP.
 17006
 17007     IF WE-LFPRM = ZERO
 17008         GO TO 4160-EP-DO-LF-EP-R78.
 17009
 17010     IF DTE-CLIENT = 'CRI'
 17011       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17012             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17013           GO TO 4160-EP-DO-LF-EP-R78.
 17014
 17015     IF DTE-CLIENT = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 325
* ECS010.cbl
 17016        GO TO 4160-EP-DO-LF-EP-R78
 17017     END-IF
 17018
 17019     IF DTE-CLIENT = 'NCL'
 17020       IF CR-DT LESS THAN 19910101
 17021           GO TO 4160-EP-DO-LF-EP-R78.
 17022
 17023     IF REM-TRM1 = CR-LF-TERM
 17024         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17025         GO TO 4190-EP-DO-LF-COMM.
 17026
 17027     MOVE CR-APR TO NP-APR.
 17028     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17029     MOVE REM-TRM1 TO NP-REM.
 17030     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17031     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17032         MOVE CR-LOAN-TERM TO NP-ORIG.
 17033
 17034     MOVE 'R' TO NP-OPT.
 17035     CALL 'ECSNETRM'
 17036         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17037
 17038     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17039
 17040     IF STATUTORY-REQUIREMENT
 17041         MOVE EPR-R78                TO EPR-ST.
 17042
 17043 4160-EP-DO-LF-EP-R78.
 17044
 17045     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17046        (DTE-CLIENT EQUAL 'NCL')
 17047        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17048           (CR-MO EQUAL EOM-MO)
 17049           MOVE '*'            TO OB-DATE-1-SWITCH
 17050           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17051           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17052           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17053           COMPUTE WS-EPR-R78 (SUB3 1) =
 17054                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17055           GO TO 4190-EP-DO-LF-COMM
 17056        ELSE
 17057        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17058           (CR-MO EQUAL OB-MO (1))
 17059           MOVE '*'            TO OB-DATE-2-SWITCH
 17060           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17061           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17062           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17063           COMPUTE WS-EPR-R78 (SUB3 2) =
 17064                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17065           GO TO 4190-EP-DO-LF-COMM
 17066        ELSE
 17067        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17068           (CR-MO EQUAL OB-MO (2))
 17069           MOVE '*'            TO OB-DATE-3-SWITCH
 17070           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17071           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17072           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17073           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 326
* ECS010.cbl
 17074                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17075           GO TO 4190-EP-DO-LF-COMM
 17076        ELSE
 17077           GO TO 4190-EP-DO-LF-COMM.
 17078
 17079     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17080
 17081     IF DTE-R78 = '1'
 17082         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17083     ELSE
 17084         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17085
 17086     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17087
 17088     IF REM-TRM1 GREATER THAN +0
 17089         COMPUTE TEMP-7 ROUNDED EQUAL
 17090             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17091     ELSE
 17092         MOVE WE-LFPRM                TO TEMP-7.
 17093
 17094     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17095         MOVE TEMP-7                 TO EPR-ST.
 17096
 17097     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17098         MOVE ZEROS                  TO TEMP-8
 17099         GO TO 4165-END-LF-EP-R78.
 17100
 17101     IF EPR-ST = ZEROS
 17102         MOVE TEMP-7                 TO EPR-ST.
 17103
 17104     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17105         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17106         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17107         IF DTE-R78 = '1'
 17108             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17109
 17110     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17111
 17112     COMPUTE TEMP-8 ROUNDED =
 17113               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17114
 17115 4165-END-LF-EP-R78.
 17116
 17117     IF EPR-R78 = ZEROS
 17118         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17119     ELSE
 17120         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17121
 17122 4170-EP-DO-LF-EP-PRO.
 17123
 17124     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17125         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17126     ELSE
 17127         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17128
 17129     IF REM-TRM1 GREATER THAN +0
 17130         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17131     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 327
* ECS010.cbl
 17132         MOVE WE-LFPRM                  TO TEMP-7.
 17133
 17134     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17135         MOVE ZEROS                     TO TEMP-8
 17136         GO TO 4175-END-LF-EP-PRO.
 17137
 17138     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17139         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17140             COMPUTE TEMP-5 ROUNDED =
 17141                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17142         ELSE
 17143             COMPUTE TEMP-5 ROUNDED =
 17144                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17145
 17146     COMPUTE TEMP-8 ROUNDED =
 17147                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17148
 17149     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17150
 17151 4175-END-LF-EP-PRO.
 17152
 17153     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17154
 17155     GO TO 4185-EP-DO-LF-STATUTORY.
 17156
 17157 4180-EP-DO-LF-EP-SUM.
 17158
 17159     IF REM-TRM1 NOT GREATER +0
 17160         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17161         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17162         GO TO 4190-EP-DO-LF-COMM.
 17163
 17164     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17165
 17166     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17167         MOVE ZEROS                 TO TEMP-7
 17168     ELSE
 17169         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17170                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17171
 17172     IF TEMP-7 NOT GREATER ZERO
 17173         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17174             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17175             GO TO 4190-EP-DO-LF-COMM
 17176         ELSE
 17177             MOVE ZEROS             TO TEMP-7.
 17178
 17179     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17180     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17181     IF DTE-R78 = '1'
 17182         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17183
 17184     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17185     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17186
 17187     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17188
 17189     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 328
* ECS010.cbl
 17190
 17191     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17192         GO TO 4185-EP-DO-LF-STATUTORY.
 17193
 17194     MOVE EPR-R78                  TO EPR-ST.
 17195
 17196     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17197         MOVE ZEROS                 TO TEMP-8
 17198     ELSE
 17199         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17200                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17201
 17202     IF TEMP-8 NOT GREATER ZERO
 17203         GO TO 4185-EP-DO-LF-STATUTORY.
 17204
 17205     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17206                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17207
 17208     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17209                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17210
 17211     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17212                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17213
 17214 4185-EP-DO-LF-STATUTORY.
 17215
 17216*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17217*07636          MOVE EPR-R78                TO EPR-ST.
 17218     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17219         MOVE EPR-PRO                TO EPR-ST.
 17220
 17221     IF DTE-CLIENT = 'AHL'
 17222        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17223           MOVE EPR-R78          TO EPR-ST
 17224        ELSE
 17225           MOVE EPR-PRO          TO EPR-ST
 17226        END-IF
 17227     END-IF
 17228
 17229     IF (DTE-CLIENT = 'CID')
 17230        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17231                   OR
 17232            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17233            AND (CR-DT > 20091231)))
 17234        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17235        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17236           GO TO 4187-EP-DO-LF-STAT-ROA
 17237     END-IF.
 17238
 17239     IF EPR-ST NOT = ZEROS
 17240         GO TO 4190-EP-DO-LF-COMM.
 17241
 17242     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17243         MOVE EPR-R78                TO EPR-ST
 17244     ELSE
 17245         MOVE EPR-PRO                TO EPR-ST.
 17246
 17247     GO TO 4190-EP-DO-LF-COMM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 329
* ECS010.cbl
 17248
 17249 4187-EP-DO-LF-STAT-ROA.
 17250     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17251     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17252     MOVE 'L'                        TO DC-OPTION-CODE.
 17253     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17254     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17255     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17256        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17257        MOVE '3'                     TO  DC-OPTION-CODE
 17258        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17259                              8099-DATE-CONVERT-X
 17260        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17261     ELSE
 17262        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17263        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17264        MOVE +0                      TO  DC-ELAPSED-DAYS
 17265        MOVE '6'                     TO  DC-OPTION-CODE
 17266        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17267                              8099-DATE-CONVERT-X
 17268        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17269     END-IF.
 17270     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17271     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17272     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17273     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17274     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17275     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17276     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17277     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17278     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17279     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17280                                        CP-LOAN-TERM.
 17281     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17282                                        CP-RATING-BENEFIT-AMT.
 17283     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17284     MOVE CR-APR                     TO CP-LOAN-APR.
 17285     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17286     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17287     MOVE '6'                        TO CP-EARNING-METHOD.
 17288     MOVE '3'                        TO CP-PROCESS-TYPE.
 17289     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17290     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17291         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17292     ELSE
 17293         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17294     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17295     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17296     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17297     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17298     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17299     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17300
 17301     IF CP-STATE-STD-ABBRV = 'OR'
 17302        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17303     END-IF
 17304
 17305     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 330
* ECS010.cbl
 17306        COMPUTE CP-ORIGINAL-BENEFIT =
 17307         (CR-LFAMT - CR-LFPRM)
 17308     END-IF
 17309
 17310     IF CP-TRUNCATED-LIFE
 17311        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17312     END-IF
 17313
 17314     IF CP-TERM-IS-DAYS
 17315        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17316     ELSE
 17317        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17318     END-IF
 17319
 17320     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17321
 17322     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17323
 17324 4190-EP-DO-LF-COMM.
 17325
 17326     MOVE +0 TO SUB1.
 17327     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17328         10 TIMES.
 17329
 17330     IF REIN-EP-FLG NOT = 'R'  OR
 17331        CR-POLICY-IS-REIN-ONLY
 17332         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17333         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17334         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17335         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17336
 17337     ADD ISS-BEN TO EW-ISS-BEN.
 17338     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17339     ADD CNC-BEN TO EW-CNC-BEN.
 17340     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17341     ADD ISS-PRM TO EW-ISS-PRM.
 17342     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17343     ADD CNC-PRM TO EW-CNC-PRM.
 17344     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17345
 17346     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17347     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17348     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17349
 17350     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17351        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17352     END-IF
 17353     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17354        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17355     END-IF
 17356
 17357     COMPUTE ISS-PRMTAX =
 17358        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17359        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17360
 17361     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17362
 17363     IF LIFE-FULLY-EARNED
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 331
* ECS010.cbl
 17364         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17365                                            (ISS-PRM - EPR-R78)
 17366         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17367                                            (ISS-PRM - EPR-PRO)
 17368         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17369                                            (ISS-PRM - EPR-ST).
 17370
 17371     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17372         IF  REIN-EP-FLG NOT = 'R'
 17373                 OR
 17374             CR-POLICY-IS-REIN-ONLY
 17375             MOVE 'L'      TO W-CLAIM-TYPE
 17376             MOVE EPR-R78  TO W-OPT-R78
 17377             MOVE EPR-PRO  TO W-OPT-PRO
 17378             MOVE EPR-ST   TO W-OPT-ST
 17379             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17380             MOVE ZEROS    TO EW-CLM-IBNR
 17381         ELSE
 17382             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17383                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17384                 MOVE ZEROS      TO EW-CLM-IBNR
 17385             ELSE
 17386                 MOVE ZEROS      TO EW-CLM-IBNR
 17387     ELSE
 17388         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17389             ADD WE-DTH-IBNR
 17390                       TO EW-CLM-IBNR
 17391         ELSE
 17392             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17393                     AND
 17394                 CR-DT GREATER THAN LAST-YRS-DATE
 17395                 COMPUTE  EW-CLM-IBNR
 17396                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17397
 17398     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17399     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17400
 17401 4191-CONTINUE.
 17402
 17403     MOVE 'Y'          TO EW-LEVEL-USED.
 17404
 17405     IF CR-POLICY-UNDERWRITTEN
 17406         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17407         MOVE EPEC-OPT-WORK-TABLE
 17408                              TO EPEC-UNDW-OPT-DATA-TABLE
 17409     ELSE
 17410         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17411         MOVE EPEC-OPT-WORK-TABLE
 17412                              TO EPEC-OPT-DATA-TABLE.
 17413
 17414     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 332
* ECS010.cbl
 17416 4194-SLOT-INTO-EFFECTED-MONTHS.
 17417
 17418     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17419             AND
 17420         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17421             AND
 17422         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17423                 OR
 17424          CR-LF-CANC-DT EQUAL ZEROS)
 17425             AND
 17426         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17427                 OR
 17428          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17429         MOVE 'Y'                 TO W-TABLE-USED-SW
 17430         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17431             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17432                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17433                 + CR-LIVES
 17434         ELSE
 17435             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17436                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17437
 17438 4194-EXIT.
 17439     EXIT.
 17440
 17441 4196-CALC-REM-AMT.
 17442
 17443     IF CR-LFTYP = 'QD'
 17444        MOVE +15.0               TO CR-APR
 17445     END-IF
 17446
 17447     MOVE +0                     TO WS-REM-AMT
 17448     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17449        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17450           COMPUTE WS-REM-AMT =
 17451             CR-LFAMT + CR-LFAMT-ALT
 17452        ELSE
 17453           MOVE CR-LFAMT         TO WS-REM-AMT
 17454        END-IF
 17455        GO TO 4199-EXIT
 17456     END-IF
 17457
 17458     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17459
 17460     IF REM-TRM1 = CR-LF-TERM
 17461        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17462           COMPUTE WS-REM-AMT =
 17463             CR-LFAMT + CR-LFAMT-ALT
 17464        ELSE
 17465           MOVE CR-LFAMT         TO WS-REM-AMT
 17466        END-IF
 17467        GO TO 4199-EXIT
 17468     END-IF
 17469
 17470     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17471        GO TO 4198-ORDINARY-REM
 17472     END-IF
 17473
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 333
* ECS010.cbl
 17474     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17475        GO TO 4198-CALC-TEXAS-REM
 17476     END-IF
 17477
 17478     IF CR-LFTYP = 'QD'
 17479        MOVE +15.0               TO CR-APR
 17480        MOVE 'N'                 TO
 17481                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17482        GO TO 4198-CALC-NET-PAY-REM
 17483     END-IF
 17484
 17485     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17486        GO TO 4198-CALC-NET-PAY-REM
 17487     END-IF
 17488
 17489     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17490        (CR-RATING-CLASS NOT = 'L ')
 17491         IF (CR-LF-TERM GREATER THAN +60) AND
 17492            (CR-DT GREATER THAN 19831031) AND
 17493            (CR-APR GREATER THAN ZERO)
 17494             GO TO 4198-CALC-NET-PAY-REM
 17495        END-IF
 17496     END-IF
 17497
 17498     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17499         IF (CR-LF-TERM GREATER THAN +61) AND
 17500            (CR-DT  GREATER THAN 19830318) AND
 17501            (CR-APR GREATER THAN ZERO)
 17502             GO TO 4198-CALC-NET-PAY-REM
 17503        END-IF
 17504     END-IF
 17505
 17506     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17507         IF (CR-LF-TERM GREATER THAN +62) AND
 17508            (CR-DT  GREATER THAN 19810831) AND
 17509            (CR-DT  LESS THAN 19830901) AND
 17510            (CR-APR GREATER THAN ZERO)
 17511             GO TO 4198-CALC-NET-PAY-REM
 17512        END-IF
 17513     END-IF
 17514
 17515     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17516         IF (CR-LF-TERM GREATER THAN +60) AND
 17517            (CR-DT  GREATER THAN 19831231) AND
 17518            (CR-APR GREATER THAN ZERO)
 17519             GO TO 4198-CALC-NET-PAY-REM
 17520        END-IF
 17521     END-IF
 17522
 17523     .
 17524 4198-ORDINARY-REM.
 17525
 17526     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17527         COMPUTE WS-REM-AMT ROUNDED =
 17528                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17529     ELSE
 17530         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17531     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 334
* ECS010.cbl
 17532
 17533     GO TO 4199-EXIT
 17534
 17535     .
 17536 4198-CALC-TEXAS-REM.
 17537
 17538     DIVIDE CR-LFAMT BY CR-LF-TERM
 17539         GIVING TEX-FACT-1.
 17540     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17541         GIVING TEX-FACT-2
 17542         REMAINDER TEX-FACT-3.
 17543
 17544     IF TEX-FACT-3 NOT = ZERO
 17545         ADD +1                  TO TEX-FACT-2
 17546     END-IF
 17547
 17548     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17549         MOVE CR-LFAMT           TO WS-REM-AMT
 17550     ELSE
 17551         COMPUTE WS-REM-AMT ROUNDED =
 17552             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17553     END-IF
 17554
 17555     GO TO 4199-EXIT
 17556
 17557     .
 17558 4198-CALC-NET-PAY-REM.
 17559
 17560     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17561     MOVE 'L'                        TO DC-OPTION-CODE.
 17562     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17563     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17564
 17565     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17566        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17567        MOVE '3'                 TO  DC-OPTION-CODE
 17568        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17569                                  8099-DATE-CONVERT-X
 17570        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17571     ELSE
 17572        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17573        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17574        MOVE +0                  TO  DC-ELAPSED-DAYS
 17575        MOVE '6'                 TO  DC-OPTION-CODE
 17576        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17577                                  8099-DATE-CONVERT-X
 17578        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17579     END-IF
 17580
 17581     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17582        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17583     ELSE
 17584        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17585     END-IF
 17586     MOVE CR-APR                 TO  CP-LOAN-APR
 17587     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17588     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17589     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 335
* ECS010.cbl
 17590     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17591                                 TO CP-SPECIAL-CALC-CD
 17592     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17593                                 TO  CP-BENEFIT-TYPE
 17594     MOVE CLAS-I-EP (CLAS-INDEXL)
 17595                                 TO  CP-EARNING-METHOD
 17596
 17597     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17598     IF (DTE-CLIENT = 'DCC')
 17599        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17600        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17601           ((CR-STATE = DD-STATE (D1))
 17602           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17603           AND ('A'           = DD-BEN-TYPE   (D1))
 17604           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 17605           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17606                           OR
 17607           D1 > +800
 17608        END-PERFORM
 17609        IF D1 < +801
 17610           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17611              (P1 > +8)
 17612              OR (DD-PROD-CODE (D1 P1) = 'L')
 17613           END-PERFORM
 17614           IF P1 < +9
 17615              MOVE DD-MAX-BEN-AMT (D1 P1)
 17616                                 TO CP-R-MAX-TOT-BEN
 17617           END-IF
 17618        END-IF
 17619     END-IF
 17620
 17621     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17622
 17623     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17624
 17625     .
 17626 4199-EXIT.
 17627     EXIT.
 17628
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 336
* ECS010.cbl
 17630******************************************************************
 17631***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17632******************************************************************
 17633
 17634 4200-EP-DO-AH.
 17635
 17636     MOVE +0                         TO ISS-BEN  EPR-R78
 17637                                        CNC-BEN  EPR-PRO
 17638                                        ISS-PRM  EPR-ST
 17639                                        CNC-PRM
 17640                                        WX-CLM-AMT
 17641                                        WX-CLM-EXP
 17642                                        WX-CLM-CNT
 17643                                        WX-CLM-CRT
 17644                                        WX-ACTIVE-COUNT
 17645                                        ISS-PRMTAX
 17646                                        WX-CNC-CNT.
 17647     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17648
 17649     IF CR-AHTYP = ZERO
 17650         GO TO 4295-EP-DO-COUNT.
 17651
 17652     IF REIN-EP-FLG = 'R'
 17653         IF REIN-AH-FLG (SUB5) = SPACE
 17654             GO TO 4295-EP-DO-COUNT.
 17655
 17656     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17657     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17658     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17659
 17660     IF CR-POLICY-IS-DECLINED  OR
 17661        CR-POLICY-IS-VOID
 17662         GO TO 4290-CONTINUE.
 17663
 17664     MOVE CR-AH-TERM           TO ORIG-TERM.
 17665
 17666     IF CR-DT GREATER EW-COV-DTE
 17667         MOVE CR-DT            TO EW-COV-DTE.
 17668
 17669     IF NOT CR-POLICY-IS-RESTORE  AND
 17670        NOT CR-POLICY-IS-REISSUE
 17671        AND NOT CR-POLICY-IS-MONTHLY
 17672         MOVE WE-AHAMT         TO ISS-BEN
 17673         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17674         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17675         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17676         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17677                                   (ORIG-TERM * ISS-BEN).
 17678
 17679     MOVE CLAS-INDEXA     TO W-NDX.
 17680     MOVE RUN-DATE        TO VALUATION-DT
 17681     MOVE '6'             TO W-VAL-SOURCE.
 17682
 17683     IF REIN-EP-FLG = 'R'
 17684         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17685            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17686             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17687             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 337
* ECS010.cbl
 17688
 17689     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17690
 17691     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17692        (REM-TRM3 GREATER ZERO)
 17693        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17694            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17695                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17696            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17697                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17698          ELSE
 17699            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17700            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17701
 17702     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17703         GO TO 4210-BY-OPT-LOGIC.
 17704
 17705     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17706             AND
 17707         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17708             AND
 17709         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17710                 OR
 17711          CR-AH-CANC-DT EQUAL ZEROS)
 17712         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17713         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17714                 VARYING
 17715             SUBM FROM +1 BY +1
 17716                 UNTIL
 17717             SUBM GREATER THAN +13.
 17718
 17719     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17720     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17721
 17722 4210-BY-OPT-LOGIC.
 17723
 17724     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17725         ADD CR-LIVES TO EW-ISS-CNT
 17726         MOVE WE-AHPRM TO ISS-PRM
 17727         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17728                                (ORIG-TERM * CR-LIVES)
 17729         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17730         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17731         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17732                                   (ORIG-TERM * ISS-BEN)
 17733         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17734         GO TO 4225-CONTINUE.
 17735
 17736     IF (NOT CR-POLICY-IS-RESTORE) AND
 17737        (NOT CR-POLICY-IS-REISSUE)
 17738        AND (NOT CR-POLICY-IS-MONTHLY)
 17739        ADD +1 TO EW-ISS-CNT.
 17740
 17741     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17742
 17743     .
 17744 4225-CONTINUE.
 17745
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 338
* ECS010.cbl
 17746     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17747         NEXT  SENTENCE
 17748       ELSE
 17749         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17750
 17751     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17752     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17753     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17754     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17755     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17756     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17757
 17758     MOVE +0           TO SUB1.
 17759
 17760     IF DTE-CLIENT = 'DCC'
 17761        IF CR-AH-CANC-DT NOT = ZEROS
 17762           MOVE CR-AH-TERM       TO ORIG-TERM
 17763           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17764           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17765           MOVE '1'              TO W-VAL-SOURCE
 17766           PERFORM 8500-REMAINING-TERM-ROUTINE
 17767                                 THRU 8599-REM-TERM-X
 17768           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17769        END-IF
 17770     END-IF
 17771
 17772     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17773         10 TIMES.
 17774     MOVE +0                     TO SUB16
 17775     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17776        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17777
 17778     IF REIN-EP-FLG NOT = 'R'  OR
 17779        CR-POLICY-IS-REIN-ONLY
 17780         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17781         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17782         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17783         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17784
 17785     ADD ISS-BEN TO EW-ISS-BEN.
 17786     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17787     ADD CNC-BEN TO EW-CNC-BEN.
 17788     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17789     ADD ISS-PRM TO EW-ISS-PRM.
 17790     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17791     ADD CNC-PRM TO EW-CNC-PRM.
 17792     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17793
 17794     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17795     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17796     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17797
 17798     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17799        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17800     END-IF
 17801     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17802        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17803     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 339
* ECS010.cbl
 17804     COMPUTE ISS-PRMTAX =
 17805        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17806        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17807     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17808
 17809     IF A-H-FULLY-EARNED
 17810         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17811                                            (ISS-PRM - EPR-R78)
 17812         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17813                                            (ISS-PRM - EPR-PRO)
 17814         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17815                                            (ISS-PRM - EPR-ST).
 17816
 17817     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17818         IF  REIN-EP-FLG NOT = 'R'
 17819                 OR
 17820             CR-POLICY-IS-REIN-ONLY
 17821             MOVE 'A'      TO W-CLAIM-TYPE
 17822             MOVE EPR-R78  TO W-OPT-R78
 17823             MOVE EPR-PRO  TO W-OPT-PRO
 17824             MOVE EPR-ST   TO W-OPT-ST
 17825             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17826             MOVE ZEROS    TO EW-CLM-IBNR
 17827         ELSE
 17828             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17829                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17830                 MOVE ZEROS TO EW-CLM-IBNR
 17831             ELSE
 17832                 MOVE ZEROS TO EW-CLM-IBNR
 17833     ELSE
 17834         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17835             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17836         ELSE
 17837             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17838                 IF  CR-AH-POLICY-IS-ACTIVE
 17839                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17840                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17841                 ELSE
 17842                     NEXT SENTENCE
 17843             ELSE
 17844                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17845                     COMPUTE  EW-CLM-IBNR
 17846                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17847
 17848     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17849     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17850
 17851 4290-CONTINUE.
 17852*     DISPLAY ' 4290 '
 17853
 17854     MOVE 'Y'          TO EW-LEVEL-USED.
 17855
 17856     IF CR-POLICY-UNDERWRITTEN
 17857         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17858         MOVE EPEC-OPT-WORK-TABLE
 17859                              TO EPEC-UNDW-OPT-DATA-TABLE
 17860     ELSE
 17861         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 340
* ECS010.cbl
 17862         MOVE EPEC-OPT-WORK-TABLE
 17863                              TO EPEC-OPT-DATA-TABLE.
 17864
 17865
 17866 4295-EP-DO-COUNT.
 17867
 17868     IF REIN-EP-FLG = 'R'
 17869         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17870     ELSE
 17871         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17872
 17873     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 341
* ECS010.cbl
 17875 4296-SLOT-INTO-EFFECTED-MONTHS.
 17876
 17877     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17878             AND
 17879         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17880             AND
 17881         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17882                 OR
 17883          CR-AH-CANC-DT EQUAL ZEROS)
 17884         MOVE 'Y'                 TO W-TABLE-USED-SW
 17885         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17886             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17887                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17888                 + CR-LIVES
 17889         ELSE
 17890             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17891                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17892
 17893 4296-EXIT.
 17894     EXIT.
 17895
 17896 4299-EPBX.
 17897     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 342
* ECS010.cbl
 17899******************************************************************
 17900***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17901******************************************************************
 17902
 17903 4300-EP-COMM-LOOP.
 17904
 17905     IF DTE-CLIENT = 'DMD'
 17906         GO TO 4350-EP-COMM-LOOP-X.
 17907
 17908     ADD +1                         TO SUB1.
 17909     MOVE ZEROS                     TO SUB16.
 17910
 17911     IF CR-ADDL-CLP NOT NUMERIC
 17912        MOVE ZEROS               TO CR-ADDL-CLP
 17913     END-IF
 17914     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17915         GO TO 4350-EP-COMM-LOOP-X.
 17916
 17917 4300-AGENT-LOOP.
 17918
 17919     ADD +1                         TO SUB16.
 17920
 17921     IF SUB16 GREATER THAN WS-LOOP-MAX
 17922         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17923         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17924         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17925                                     TO WS-ABEND-MESSAGE
 17926         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17927         MOVE 4001                   TO WS-ABEND-CODE
 17928         GO TO ABEND-PGM.
 17929
 17930     IF EW-AGT-NO (SUB16) = SPACES
 17931         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 17932         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 17933     ELSE
 17934         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 17935            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 17936             NEXT SENTENCE
 17937         ELSE
 17938             GO TO 4300-AGENT-LOOP.
 17939
 17940     IF EW-LF-AH = AH-OVERRIDE-L1
 17941         GO TO 4350-EP-COMM-LOOP-A.
 17942
 17943     IF (DTE-CLIENT = 'DCC')
 17944        AND (REIN-EP-FLG = 'R')
 17945        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17946        AND (WE-LFPRM NOT = ZEROS)
 17947        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17948           COMPUTE ISS-WK ROUNDED =
 17949              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 17950        ELSE
 17951           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 17952               (CR-LFAMT + CR-LFAMT-ALT)
 17953           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 17954              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 17955        END-IF
 17956     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 343
* ECS010.cbl
 17957        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 17958                             OR 'J' OR 'N'
 17959           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 17960        ELSE
 17961           IF CR-AGT-TYPE (SUB1) = 'A'
 17962              COMPUTE ISS-WK ROUNDED =
 17963                   CR-LF-CLP * CR-LCOM-L (SUB1)
 17964           ELSE
 17965              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17966                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 17967                 COMPUTE ISS-WK ROUNDED =
 17968                      CR-LF-CLP * CR-LCOM-L (SUB1)
 17969              ELSE
 17970                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 17971                    * CR-LCOM-L (SUB1)
 17972              END-IF
 17973           END-IF
 17974        END-IF
 17975     END-IF
 17976
 17977     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17978
 17979     MOVE ZEROS                  TO CNC-WK
 17980                                    CNC-FACT
 17981     IF DTE-CLIENT EQUAL 'XXX'
 17982         IF NOT CR-NO-LF-CHARGEBACK
 17983            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 17984            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 17985                                + CNC-WK
 17986            GO TO 4300-CONTINUE-LOOP.
 17987
 17988     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 17989        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 17990
 17991      IF (DTE-CLIENT = 'DCC')
 17992         AND (REIN-EP-FLG = 'R')
 17993         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17994         AND (WE-LFRFND NOT = ZEROS)
 17995         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17996            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17997            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 17998               CR-LCOM-L (SUB1)
 17999            IF CR-ACCOUNT = '05500500DD'
 18000               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18001            END-IF
 18002         ELSE
 18003            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18004            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18005               * CR-LCOM-L (SUB1)
 18006         END-IF
 18007      ELSE
 18008        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18009                              OR 'L' OR 'J' OR 'K')
 18010           AND (CNC-PRM > +0)
 18011           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18012           IF CR-CANCEL-REASON = 'R'
 18013              MOVE 1             TO CNC-FACT
 18014           END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 344
* ECS010.cbl
 18015           COMPUTE CNC-WK = CNC-FACT *
 18016              (CR-LCOM-L (SUB1) * +1000)
 18017*       ELSE
 18018*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18019*          AND (CNC-PRM > +0)
 18020*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18021*                                THRU 4380-EXIT
 18022*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18023*          COMPUTE CNC-WK = CNC-FACT *
 18024*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18025*       ELSE
 18026*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18027*              AND (CR-AHTYP NOT = '00' AND '  ')
 18028*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18029*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18030*             COMPUTE CNC-WK = CNC-FACT *
 18031*                (CR-AHPRM - (CR-LFPRM-ALT
 18032*                + CR-ADDL-CLP))
 18033         ELSE
 18034            IF (CR-AGT-TYPE (SUB1) = 'A')
 18035                      OR
 18036              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18037                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18038              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18039              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18040                CR-LCOM-L (SUB1)
 18041            ELSE
 18042               COMPUTE CNC-WK  ROUNDED =
 18043                 CNC-PRM * CR-LCOM-L (SUB1)
 18044            END-IF
 18045         END-IF
 18046*       END-IF
 18047      END-IF
 18048        COMPUTE EW-CNC-COM (SUB16) =
 18049                                  EW-CNC-COM (SUB16) + CNC-WK
 18050     END-IF
 18051
 18052     if (ws-dcc-cnc-flag = 'Y')
 18053        and (rein-ep-flg not = 'R')
 18054        move cnc-wk              to dx-l-pc (sub1)
 18055     end-if
 18056
 18057     .
 18058 4300-CONTINUE-LOOP.
 18059
 18060*     DISPLAY ' 4300 CONTINUE '
 18061     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18062               OR
 18063        ((ISS-WK - CNC-WK) = ZEROS)
 18064        MOVE ZEROS              TO COMM-WK
 18065     ELSE
 18066        COMPUTE EC-FACT ROUNDED =
 18067           EPR-R78 / (ISS-PRM - CNC-PRM)
 18068        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18069     END-IF
 18070
 18071     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18072
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 345
* ECS010.cbl
 18073     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18074               OR
 18075        ((ISS-WK - CNC-WK) = ZEROS)
 18076        MOVE ZEROS              TO COMM-WK
 18077     ELSE
 18078        COMPUTE EC-FACT ROUNDED =
 18079           EPR-PRO / (ISS-PRM - CNC-PRM)
 18080        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18081     END-IF
 18082     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18083
 18084     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18085               OR
 18086        ((ISS-WK - CNC-WK) = ZEROS)
 18087        MOVE ZEROS              TO COMM-WK
 18088     ELSE
 18089        COMPUTE EC-FACT ROUNDED =
 18090           EPR-ST / (ISS-PRM - CNC-PRM)
 18091        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18092     END-IF
 18093
 18094     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18095
 18096     IF LIFE-FULLY-EARNED
 18097         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18098                                                CR-LCOM-L (SUB1)
 18099         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18100                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18101         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18102                                                CR-LCOM-L (SUB1)
 18103         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18104                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18105
 18106     GO TO 4350-EP-COMM-LOOP-X.
 18107
 18108 4350-EP-COMM-LOOP-A.
 18109
 18110     IF (DTE-CLIENT = 'DCC')
 18111        AND (REIN-EP-FLG = 'R')
 18112        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18113        AND (WE-AHPRM NOT = ZEROS)
 18114
 18115        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18116           COMPUTE ISS-WK ROUNDED =
 18117              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18118        ELSE
 18119           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18120           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18121              * CR-LCOM-AH (SUB1)
 18122        END-IF
 18123     ELSE
 18124        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18125                                    OR 'J' OR 'N'
 18126           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18127        ELSE
 18128           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18129             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18130              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 346
* ECS010.cbl
 18131              + CR-ADDL-CLP)
 18132           ELSE
 18133              IF (CR-AGT-TYPE (SUB1) = 'M')
 18134                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18135                              = 'G' OR 'L')
 18136                 COMPUTE ISS-WK ROUNDED =
 18137                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18138              ELSE
 18139                 IF CR-AGT-TYPE (SUB1) = 'A'
 18140                    COMPUTE ISS-WK ROUNDED =
 18141                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18142                 ELSE
 18143                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18144                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18145                                     'D')
 18146                       COMPUTE ISS-WK ROUNDED =
 18147                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18148                    ELSE
 18149                       COMPUTE ISS-WK  ROUNDED =
 18150                         ISS-PRM * CR-LCOM-AH (SUB1)
 18151                    END-IF
 18152                 END-IF
 18153              END-IF
 18154           END-IF
 18155        END-IF
 18156     END-IF
 18157
 18158     COMPUTE EW-ISS-COM (SUB16) =
 18159             EW-ISS-COM (SUB16) + ISS-WK.
 18160
 18161     MOVE ZEROS                  TO CNC-WK
 18162     IF DTE-CLIENT EQUAL 'XXX'
 18163         IF NOT CR-NO-LF-CHARGEBACK
 18164           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18165           COMPUTE EW-CNC-COM (SUB16) =
 18166                   EW-CNC-COM (SUB16) + CNC-WK
 18167           GO TO 4300-CONTINUE-LOOP-AH.
 18168
 18169     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18170        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18171        EVALUATE TRUE
 18172           WHEN DTE-CLIENT = 'DCC'
 18173             AND (REIN-EP-FLG = 'R')
 18174             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18175             AND (WE-AHRFND NOT = ZEROS)
 18176             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18177                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18178                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18179                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18180             ELSE
 18181                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18182                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18183                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18184             END-IF
 18185           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18186             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18187             AND (CNC-PRM > +0)
 18188             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 347
* ECS010.cbl
 18189           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18190             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18191             AND (CNC-PRM > +0)
 18192             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18193           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18194                              OR 'L' OR 'J' OR 'K')
 18195             AND (CNC-PRM > +0)
 18196             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18197             IF CR-CANCEL-REASON = 'R'
 18198                MOVE 1             TO CNC-FACT
 18199             END-IF
 18200             COMPUTE CNC-WK = CNC-FACT *
 18201                (CR-LCOM-AH (SUB1) * +1000)
 18202
 18203           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18204             AND (CNC-PRM > +0)
 18205             AND (CNC-PRM = ISS-PRM)
 18206             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18207
 18208           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18209             AND (CNC-PRM > +0)
 18210             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18211           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18212              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18213                              = 'G' OR 'L')
 18214              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18215              COMPUTE CNC-WK = CNC-FACT *
 18216                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18217           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18218              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18219              IF (CR-CANCEL-REASON = 'R')
 18220                 AND (CNC-PRM > +0)
 18221                 MOVE +1      TO CNC-FACT
 18222              END-IF
 18223              COMPUTE CNC-WK = CNC-FACT *
 18224              (CR-AHPRM - (CR-LFPRM-ALT
 18225                 + CR-ADDL-CLP))
 18226           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18227                      OR
 18228              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18229               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18230               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18231               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18232                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18233            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18234                      CNC-PRM * CR-LCOM-AH (SUB1)
 18235        END-EVALUATE
 18236        COMPUTE EW-CNC-COM (SUB16) =
 18237           EW-CNC-COM (SUB16) + CNC-WK
 18238     END-IF
 18239
 18240     if (ws-dcc-cnc-flag = 'Y')
 18241        and (rein-ep-flg not = 'R')
 18242        move cnc-wk              to dx-a-pc (sub1)
 18243     end-if
 18244
 18245*      IF (DTE-CLIENT = 'DCC')
 18246*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 348
* ECS010.cbl
 18247*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18248*         AND (WE-AHRFND NOT = ZEROS)
 18249*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18250*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18251*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18252*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18253*         ELSE
 18254*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18255*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18256*            * CR-LCOM-AH (SUB1)
 18257*         END-IF
 18258*      ELSE
 18259*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18260*                              OR 'L' OR 'J' OR 'K')
 18261*           AND (CNC-PRM > +0)
 18262*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18263*           IF CR-CANCEL-REASON = 'R'
 18264*              MOVE 1             TO CNC-FACT
 18265*           END-IF
 18266*           COMPUTE CNC-WK = CNC-FACT *
 18267*              (CR-LCOM-AH (SUB1) * +1000)
 18268*        ELSE
 18269*          IF CR-AGT-TYPE (SUB1) = 'N'
 18270*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18271*                                 THRU 4380-EXIT
 18272**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18273**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18274**            IF CNC-PRM NOT = ISS-PRM
 18275**               COMPUTE CNC-WK = CNC-FACT *
 18276**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18277**            ELSE
 18278**               COMPUTE CNC-WK = CNC-FACT *
 18279**               (CR-LCOM-AH (SUB1) * +1000)
 18280**            END-IF
 18281*          ELSE
 18282*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18283*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18284*                              = 'G' OR 'L')
 18285*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18286*              COMPUTE CNC-WK = CNC-FACT *
 18287*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18288*           ELSE
 18289*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18290*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18291*                 IF CR-CANCEL-REASON = 'R'
 18292*                    MOVE +1      TO CNC-FACT
 18293*                 END-IF
 18294*                 COMPUTE CNC-WK = CNC-FACT *
 18295*                 (CR-AHPRM - (CR-LFPRM-ALT
 18296*                    + CR-ADDL-CLP))
 18297*              ELSE
 18298*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18299*                           OR
 18300*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18301*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18302*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18303*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18304*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 349
* ECS010.cbl
 18305*                 ELSE
 18306*                    COMPUTE CNC-WK  ROUNDED =
 18307*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18308*                 END-IF
 18309*              END-IF
 18310*           END-IF
 18311*          END-IF
 18312*        END-IF
 18313**       END-IF
 18314*      END-IF
 18315*        COMPUTE EW-CNC-COM (SUB16) =
 18316*           EW-CNC-COM (SUB16) + CNC-WK
 18317*     END-IF
 18318
 18319     .
 18320 4300-CONTINUE-LOOP-AH.
 18321
 18322     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18323        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18324        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18325        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18326        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18327           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18328        END-IF
 18329     END-IF
 18330
 18331*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18332     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18333                OR
 18334        ((ISS-WK - CNC-WK) = ZEROS)
 18335        MOVE ZEROS          TO COMM-WK
 18336     ELSE
 18337        COMPUTE EC-FACT ROUNDED =
 18338           EPR-R78 / (ISS-PRM - CNC-PRM)
 18339        IF WS-DDF-AH-CB (SUB1) = 'N'
 18340           MOVE ISS-WK           TO COMM-WK
 18341        ELSE
 18342           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18343        END-IF
 18344     END-IF
 18345
 18346     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18347
 18348     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18349                OR
 18350        ((ISS-WK - CNC-WK) = ZEROS)
 18351        MOVE ZEROS          TO COMM-WK
 18352     ELSE
 18353        COMPUTE EC-FACT ROUNDED =
 18354           EPR-PRO / (ISS-PRM - CNC-PRM)
 18355        IF WS-DDF-AH-CB (SUB1) = 'N'
 18356           MOVE ISS-WK           TO COMM-WK
 18357        ELSE
 18358           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18359        END-IF
 18360     END-IF
 18361
 18362     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 350
* ECS010.cbl
 18363
 18364     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18365                OR
 18366        ((ISS-WK - CNC-WK) = ZEROS)
 18367        MOVE ZEROS          TO COMM-WK
 18368     ELSE
 18369        EVALUATE TRUE
 18370           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18371              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18372                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18373                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18374           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18375             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18376              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18377           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18378              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18379              MOVE ISS-WK TO COMM-WK
 18380           WHEN OTHER
 18381              COMPUTE EC-FACT ROUNDED =
 18382                EPR-ST / (ISS-PRM - CNC-PRM)
 18383              COMPUTE COMM-WK ROUNDED = EC-FACT
 18384                 * (ISS-WK - CNC-WK)
 18385        END-EVALUATE
 18386     END-IF
 18387
 18388     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18389
 18390     IF A-H-FULLY-EARNED
 18391         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18392                                                CR-LCOM-AH (SUB1)
 18393         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18394                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18395         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18396                                                CR-LCOM-AH (SUB1)
 18397         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18398                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18399
 18400 4350-EP-COMM-LOOP-X.
 18401     EXIT.
 18402
 18403******************************************************************
 18404***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18405******************************************************************
 18406
 18407 4375-EP-BANK-COMM.
 18408*     DISPLAY ' 4375 '
 18409
 18410     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18411        GO TO 4375-EXIT
 18412     END-IF
 18413     .
 18414 4375-BANK-LOOP.
 18415
 18416     ADD +1                      TO SUB16
 18417
 18418     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18419        GO TO 4375-EXIT
 18420     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 351
* ECS010.cbl
 18421
 18422     IF SUB16 GREATER THAN WS-LOOP-MAX
 18423         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18424         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18425         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18426                                     TO WS-ABEND-MESSAGE
 18427         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18428         MOVE 4001                   TO WS-ABEND-CODE
 18429         PERFORM ABEND-PGM
 18430     END-IF
 18431
 18432     IF EW-AGT-NO (SUB16) = SPACES
 18433        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18434        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18435     ELSE
 18436        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18437           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18438           CONTINUE
 18439        ELSE
 18440           GO TO 4375-BANK-LOOP
 18441        END-IF
 18442     END-IF
 18443
 18444     IF CS-COM-TYP  (SUB1) = 'B'
 18445        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18446     END-IF
 18447
 18448     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18449
 18450     MOVE ZEROS                  TO CNC-WK
 18451                                    CNC-FACT
 18452
 18453     IF (CS-COM-TYP (SUB1) = 'B')
 18454        AND (CNC-PRM > +0)
 18455        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18456        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18457     END-IF
 18458
 18459     COMPUTE EW-CNC-COM (SUB16) =
 18460                  EW-CNC-COM (SUB16) + CNC-WK
 18461
 18462     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18463                OR
 18464        ((ISS-WK - CNC-WK) = ZEROS)
 18465        MOVE ZEROS          TO COMM-WK
 18466     ELSE
 18467        COMPUTE EC-FACT ROUNDED =
 18468           EPR-R78 / (ISS-PRM - CNC-PRM)
 18469        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18470     END-IF
 18471
 18472     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18473
 18474     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18475                OR
 18476        ((ISS-WK - CNC-WK) = ZEROS)
 18477        MOVE ZEROS          TO COMM-WK
 18478     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 352
* ECS010.cbl
 18479        COMPUTE EC-FACT ROUNDED =
 18480           EPR-PRO / (ISS-PRM - CNC-PRM)
 18481        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18482     END-IF
 18483
 18484     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18485
 18486     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18487                OR
 18488        ((ISS-WK - CNC-WK) = ZEROS)
 18489        MOVE ZEROS          TO COMM-WK
 18490     ELSE
 18491        COMPUTE EC-FACT ROUNDED =
 18492           EPR-ST / (ISS-PRM - CNC-PRM)
 18493        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18494     END-IF
 18495
 18496     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18497
 18498     IF A-H-FULLY-EARNED
 18499        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18500        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18501                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18502        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18503                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18504     END-IF
 18505
 18506     .
 18507 4375-EXIT.
 18508     EXIT.
 18509
 18510
 18511 4376-DCC-DDF-SPEC.
 18512
 18513     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18514                                 THRU 4910-EXIT
 18515
 18516     display ' acct - cert ' cr-account ' ' cr-cert-no
 18517     display ' orig term rem term ' orig-term ' ' rem-trm1
 18518     display ' agt type ' cr-agt-type (sub1)
 18519     COMPUTE CP-MONTH =
 18520        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18521     IF CP-MONTH = 0
 18522        MOVE 12 TO CP-MONTH
 18523     END-IF
 18524
 18525     EVALUATE TRUE
 18526        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18527           PERFORM 4380-REF-CSO-ADMIN-FEE
 18528                                 THRU 4380-EXIT
 18529        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18530           AND (CR-CANCEL-REASON = 'R')
 18531              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18532        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18533           EVALUATE TRUE
 18534              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18535                 OR (NOT DD-IU-PRESENT)
 18536                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 353
* ECS010.cbl
 18537                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18538                       / CR-AH-CLP
 18539                 end-if
 18540                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18541                    (CR-LCOM-AH (SUB1) * +1000)
 18542               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18543                  AND (DD-IU-PRESENT)
 18544                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18545                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18546                     WS-LO-UEF) * 3/12
 18547                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18548                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18549                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18550                    (CR-LCOM-AH (SUB1) * +1000)
 18551                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18552                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18553                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18554                     * (CP-MONTH - 3) / 9
 18555              WHEN (ORIG-TERM - REM-TRM1) > 12
 18556                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18557                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18558                    CP-MONTH / 12)
 18559           END-EVALUATE
 18560        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18561           EVALUATE TRUE
 18562              WHEN CR-CANCEL-REASON = 'R'
 18563                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18564                    + CR-ADDL-CLP))
 18565              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18566                 OR (NOT DD-IU-PRESENT)
 18567                   if ueclp-clp-fact = zeros
 18568                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18569                       / CR-AH-CLP
 18570                   end-if
 18571                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18572                       (CR-AHPRM - (CR-AH-CLP
 18573                       + CR-ADDL-CLP))
 18574              WHEN (ORIG-TERM - REM-TRM1) < 13
 18575                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18576                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18577                     WS-LO-UEF) * 3/12
 18578                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18579                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18580                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18581                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18582                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18583                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18584                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18585                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18586              WHEN (ORIG-TERM - REM-TRM1) > 12
 18587                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18588                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18589                    WS-LO-UEF) * CP-MONTH / 12)
 18590           END-EVALUATE
 18591     END-EVALUATE
 18592
 18593     .
 18594 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 354
* ECS010.cbl
 18595     EXIT.
 18596
 18597
 18598
 18599 4380-REF-CSO-ADMIN-FEE.
 18600
 18601*    IF CR-AH-CANC-DT NOT = ZEROS
 18602*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18603*       MOVE CR-AH-TERM          TO ORIG-TERM
 18604*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18605*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18606*       MOVE '1'                 TO W-VAL-SOURCE
 18607*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18608*                                THRU 8599-REM-TERM-X
 18609*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18610*    END-IF
 18611
 18612     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18613                                 THRU 4910-EXIT
 18614
 18615     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18616        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18617
 18618     MOVE ZEROS                  TO CNC-WK
 18619
 18620     EVALUATE TRUE
 18621        WHEN (REM-TRM1 = 0)
 18622           OR (CR-CANCEL-REASON = 'R')
 18623           DISPLAY ' REM TERM = 0 OR REPO'
 18624           MOVE 0                TO CNC-WK
 18625
 18626        WHEN REM-TRM1 = ORIG-TERM
 18627           DISPLAY ' REM TERM  = ORIG TERM '
 18628           MOVE ISS-WK           TO CNC-WK
 18629
 18630        WHEN (ORIG-TERM - REM-TRM1) < 4
 18631           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18632           COMPUTE CP-MONTH =
 18633              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18634           IF CP-MONTH = 0
 18635              MOVE 12 TO CP-MONTH
 18636           END-IF
 18637           DISPLAY ' CP MONTH ' CP-MONTH
 18638           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18639              (DD-1ST-YR-ALLOW (D1)
 18640              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18641              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18642           COMPUTE CNC-WK = W-FACTOR * 1
 18643
 18644**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18645
 18646        WHEN (ORIG-TERM - REM-TRM1) < 13
 18647           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18648           COMPUTE CP-MONTH =
 18649              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18650           IF CP-MONTH = 0
 18651              MOVE 12 TO CP-MONTH
 18652           END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 355
* ECS010.cbl
 18653           DISPLAY ' CP MONTH ' CP-MONTH
 18654           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18655              DD-1ST-YR-ALLOW (D1))
 18656              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18657              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18658           COMPUTE CNC-WK = W-FACTOR * 1
 18659
 18660****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18661
 18662        WHEN OTHER
 18663           DISPLAY ' OTHER '
 18664           COMPUTE CP-MONTH =
 18665              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18666           IF CP-MONTH = 0
 18667              MOVE 12 TO CP-MONTH
 18668           END-IF
 18669           DISPLAY ' CP MONTH ' CP-MONTH
 18670           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18671              DD-1ST-YR-ALLOW (D1))
 18672              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18673              * CP-MONTH / 12)
 18674           COMPUTE CNC-WK = W-FACTOR * 1
 18675     END-EVALUATE
 18676
 18677     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18678        ' ' CNC-WK
 18679
 18680     .
 18681 4380-EXIT.
 18682     EXIT.
 18683
 18684******************************************************************
 18685******************************************************************
 18686******************************************************************
 18687******************************************************************
 18688******************************************************************
 18689******************************************************************
 18690******************************************************************
 18691******************************************************************
 18692******************************************************************
 18693******************************************************************
 18694***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18695******************************************************************
 18696
 18697 S-4100-EP-DO-LF.
 18698
 18699     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18700                                        EPR-PRO
 18701                                        EPR-ST.
 18702
 18703     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18704     MOVE 'L'                    TO DC-OPTION-CODE.
 18705     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18706
 18707     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18708     MOVE -1                     TO DC-ELAPSED-DAYS.
 18709     MOVE '6'                    TO DC-OPTION-CODE.
 18710     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 356
* ECS010.cbl
 18711
 18712     MOVE +0                     TO DC-ELAPSED-MONTHS
 18713                                    DC-ELAPSED-DAYS.
 18714
 18715     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18716     MOVE ' '                    TO DC-OPTION-CODE.
 18717     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18718
 18719     IF NO-CONVERSION-ERROR
 18720        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18721     ELSE
 18722         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18723                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18724                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18725         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18726                                     TO WS-ABEND-MESSAGE
 18727         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18728         MOVE 4001                   TO WS-ABEND-CODE
 18729         GO TO ABEND-PGM.
 18730
 18731     IF CR-LFTYP = ZERO
 18732         GO TO S-4200-EP-DO-AH.
 18733
 18734     IF REIN-LF-FLG (SUB5) = SPACE
 18735         GO TO S-4200-EP-DO-AH.
 18736
 18737     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18738     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18739     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18740
 18741     MOVE CR-LF-TERM             TO ORIG-TERM.
 18742     MOVE CLAS-INDEXL            TO W-NDX.
 18743
 18744 S-4120-EP-DO-LF-CNCL.
 18745
 18746     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18747        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18748         GO TO S-4130-EP-DO-LF-EP.
 18749
 18750     COMPUTE EARNED-BY-CANCEL =
 18751                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18752
 18753 S-4130-EP-DO-LF-EP.
 18754
 18755     MOVE SPACE                  TO STATUTORY-SWITCH.
 18756
 18757     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18758     MOVE '9'                    TO W-VAL-SOURCE.
 18759     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18760
 18761     IF REM-TRM2 GREATER CR-LF-TERM
 18762         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18763         GO TO S-4190-EP-DO-LF-COMM.
 18764
 18765     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18766         GO TO S-4180-EP-DO-LF-EP-SUM.
 18767
 18768     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 357
* ECS010.cbl
 18769         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18770             IF REM-TRM2 NOT GREATER THAN +0
 18771                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18772                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18773                 GO TO S-4190-EP-DO-LF-COMM
 18774             ELSE
 18775                 NEXT SENTENCE
 18776         ELSE
 18777             IF W-BAL-REMTRM NOT GREATER +0
 18778                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18779                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18780                 GO TO S-4190-EP-DO-LF-COMM
 18781             ELSE
 18782                 NEXT SENTENCE
 18783     ELSE
 18784        IF (DTE-CLIENT EQUAL 'NCL') AND
 18785           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18786             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18787        ELSE
 18788         IF REM-TRM2 NOT GREATER +0  OR
 18789            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18790             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18791             GO TO S-4190-EP-DO-LF-COMM.
 18792
 18793     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18794         GO TO S-4140-EP-DO-LF-EP-TEX.
 18795
 18796     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18797         GO TO S-4150-EP-DO-LF-EP-NP.
 18798
 18799*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18800     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18801        (CR-RATING-CLASS NOT = 'L ')
 18802         IF (CR-APR GREATER THAN ZERO)  AND
 18803            (CR-LF-TERM GREATER THAN 060)  AND
 18804            (CR-DT GREATER THAN 19831031)
 18805             MOVE '*'             TO STATUTORY-SWITCH
 18806              GO TO S-4150-EP-DO-LF-EP-NP.
 18807
 18808     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18809         IF (CR-APR GREATER THAN ZERO)  AND
 18810            (CR-LF-TERM GREATER THAN 061)  AND
 18811            (CR-DT GREATER THAN 19830318)
 18812             MOVE '*'             TO STATUTORY-SWITCH
 18813              GO TO S-4150-EP-DO-LF-EP-NP.
 18814
 18815     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18816         IF (CR-APR GREATER THAN ZERO)  AND
 18817            (CR-LF-TERM GREATER THAN 062)  AND
 18818            (CR-DT GREATER THAN 19810831)  AND
 18819            (CR-DT LESS THAN 19830901)
 18820             MOVE '*'             TO STATUTORY-SWITCH
 18821              GO TO S-4150-EP-DO-LF-EP-NP.
 18822
 18823     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18824         IF (CR-APR GREATER THAN ZERO)  AND
 18825            (CR-LF-TERM GREATER THAN 060)  AND
 18826            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 358
* ECS010.cbl
 18827             MOVE '*'             TO STATUTORY-SWITCH
 18828              GO TO S-4150-EP-DO-LF-EP-NP.
 18829
 18830     GO TO S-4160-EP-DO-LF-EP-R78.
 18831
 18832 S-4140-EP-DO-LF-EP-TEX.
 18833
 18834     COMPUTE TEX-FACT-4 =
 18835         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18836     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18837         GIVING TEX-FACT-5
 18838             REMAINDER TEX-FACT-6.
 18839     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18840     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18841         (TEX-FACT-5 * CR-PMT-FREQ) +
 18842         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18843     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18844
 18845     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18846
 18847     GO TO S-4170-EP-DO-LF-EP-PRO.
 18848
 18849 S-4150-EP-DO-LF-EP-NP.
 18850
 18851     IF WE-LFPRM = ZERO
 18852         GO TO S-4160-EP-DO-LF-EP-R78.
 18853
 18854     IF DTE-CLIENT = 'CRI'
 18855       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18856             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18857           GO TO S-4160-EP-DO-LF-EP-R78.
 18858
 18859     IF DTE-CLIENT = 'NCL'
 18860       IF CR-DT LESS THAN 19910101
 18861           GO TO S-4160-EP-DO-LF-EP-R78.
 18862
 18863     IF REM-TRM1 = CR-LF-TERM
 18864         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18865         GO TO S-4190-EP-DO-LF-COMM.
 18866
 18867     MOVE CR-APR TO NP-APR.
 18868     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18869     MOVE REM-TRM1 TO NP-REM.
 18870     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18871     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18872         MOVE CR-LOAN-TERM TO NP-ORIG.
 18873     MOVE 'R' TO NP-OPT.
 18874     CALL 'ECSNETRM'
 18875         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18876
 18877     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18878
 18879     IF STATUTORY-REQUIREMENT
 18880         MOVE EPR-R78                TO EPR-ST.
 18881
 18882 S-4160-EP-DO-LF-EP-R78.
 18883
 18884     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 359
* ECS010.cbl
 18885        (DTE-CLIENT EQUAL 'NCL')
 18886        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18887           (CR-MO EQUAL EOM-MO)
 18888           MOVE '*'            TO OB-DATE-1-SWITCH
 18889           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18890           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18891           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18892           COMPUTE WS-EPR-R78 (SUB3 1) =
 18893                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18894           GO TO S-4190-EP-DO-LF-COMM
 18895        ELSE
 18896        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18897           (CR-MO EQUAL OB-MO (1))
 18898           MOVE '*'            TO OB-DATE-2-SWITCH
 18899           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18900           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18901           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18902           COMPUTE WS-EPR-R78 (SUB3 2) =
 18903                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18904           GO TO S-4190-EP-DO-LF-COMM
 18905        ELSE
 18906        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18907           (CR-MO EQUAL OB-MO (2))
 18908           MOVE '*'            TO OB-DATE-3-SWITCH
 18909           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18910           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18911           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18912           COMPUTE WS-EPR-R78 (SUB3 3) =
 18913                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 18914           GO TO S-4190-EP-DO-LF-COMM
 18915        ELSE
 18916           GO TO S-4190-EP-DO-LF-COMM.
 18917
 18918     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18919
 18920     IF DTE-R78 = '1'
 18921         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 18922     ELSE
 18923         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18924
 18925     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18926
 18927     IF REM-TRM1 GREATER THAN +0
 18928         COMPUTE TEMP-7 ROUNDED EQUAL
 18929             WE-LFPRM - (WE-LFPRM * TEMP-4)
 18930     ELSE
 18931         MOVE WE-LFPRM                TO TEMP-7.
 18932
 18933     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 18934         MOVE TEMP-7                 TO EPR-ST.
 18935
 18936     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18937         MOVE ZEROS                  TO TEMP-8
 18938         GO TO S-4165-END-LF-EP-R78.
 18939
 18940     IF EPR-ST NOT = ZEROS
 18941         MOVE TEMP-7                 TO EPR-ST.
 18942
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 360
* ECS010.cbl
 18943     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18944         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 18945         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 18946         IF DTE-R78 = '1'
 18947             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 18948
 18949     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18950
 18951     COMPUTE TEMP-8 ROUNDED =
 18952               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 18953
 18954 S-4165-END-LF-EP-R78.
 18955
 18956     IF EPR-R78 = ZEROS
 18957         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 18958     ELSE
 18959         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 18960
 18961 S-4170-EP-DO-LF-EP-PRO.
 18962
 18963     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18964         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 18965     ELSE
 18966         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 18967
 18968     IF REM-TRM1 GREATER THAN +0
 18969         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 18970     ELSE
 18971         MOVE WE-LFPRM                  TO TEMP-7.
 18972
 18973     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18974         MOVE ZEROS                     TO TEMP-8
 18975         GO TO S-4175-END-LF-EP-PRO.
 18976
 18977     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18978         IF DTE-CLIENT = 'MIC' OR 'MCC'
 18979             COMPUTE TEMP-5 ROUNDED =
 18980                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 18981         ELSE
 18982             COMPUTE TEMP-5 ROUNDED =
 18983                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 18984
 18985     COMPUTE TEMP-8 ROUNDED =
 18986                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 18987
 18988     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 18989
 18990 S-4175-END-LF-EP-PRO.
 18991
 18992     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 18993
 18994     GO TO S-4185-EP-DO-LF-STATUTORY.
 18995
 18996 S-4180-EP-DO-LF-EP-SUM.
 18997
 18998     IF REM-TRM1 NOT GREATER +0
 18999         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19000         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 361
* ECS010.cbl
 19001         GO TO S-4190-EP-DO-LF-COMM.
 19002
 19003     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19004         MOVE ZEROS                 TO TEMP-7
 19005     ELSE
 19006         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19007                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19008
 19009     IF TEMP-7 NOT GREATER ZERO
 19010         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19011             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19012             GO TO S-4190-EP-DO-LF-COMM
 19013         ELSE
 19014             MOVE ZEROS             TO TEMP-7.
 19015
 19016     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19017     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19018     IF DTE-R78 = '1'
 19019         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19020
 19021     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19022     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19023
 19024     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19025
 19026     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19027
 19028     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19029         GO TO S-4185-EP-DO-LF-STATUTORY.
 19030
 19031     MOVE EPR-R78                  TO EPR-ST.
 19032
 19033     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19034         MOVE ZEROS                 TO TEMP-8
 19035     ELSE
 19036         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19037                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19038
 19039     IF TEMP-8 NOT GREATER ZERO
 19040         GO TO S-4185-EP-DO-LF-STATUTORY.
 19041
 19042     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19043                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19044
 19045     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19046                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19047
 19048     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19049                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19050
 19051 S-4185-EP-DO-LF-STATUTORY.
 19052
 19053*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19054*08473          MOVE EPR-R78                TO EPR-ST.
 19055
 19056     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19057         MOVE EPR-PRO                TO EPR-ST.
 19058
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 362
* ECS010.cbl
 19059     IF (DTE-CLIENT = 'CID') AND
 19060        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19061        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19062        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19063           GO TO S-4187-EP-DO-LF-STAT-ROA
 19064     END-IF.
 19065
 19066     IF EPR-ST NOT = ZEROS
 19067         GO TO S-4190-EP-DO-LF-COMM.
 19068
 19069     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19070         MOVE EPR-R78                TO EPR-ST
 19071     ELSE
 19072         MOVE EPR-PRO                TO EPR-ST.
 19073
 19074     GO TO S-4190-EP-DO-LF-COMM.
 19075
 19076 S-4187-EP-DO-LF-STAT-ROA.
 19077     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19078     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19079     MOVE 'L'                        TO DC-OPTION-CODE.
 19080     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19081     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19082     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19083        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19084        MOVE '3'                 TO  DC-OPTION-CODE
 19085        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19086                              8099-DATE-CONVERT-X
 19087        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19088     ELSE
 19089        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19090        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19091        MOVE +0                  TO  DC-ELAPSED-DAYS
 19092        MOVE '6'                 TO  DC-OPTION-CODE
 19093        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19094                              8099-DATE-CONVERT-X
 19095        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19096     END-IF
 19097     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19098     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19099     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19100     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19101     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19102     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19103     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19104     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19105     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19106     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19107                                        CP-LOAN-TERM.
 19108     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19109                                        CP-RATING-BENEFIT-AMT.
 19110     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19111         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19112     ELSE
 19113         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19114     END-IF.
 19115     MOVE CR-APR                     TO CP-LOAN-APR.
 19116     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 363
* ECS010.cbl
 19117     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19118     MOVE '6'                        TO CP-EARNING-METHOD.
 19119     MOVE '3'                        TO CP-PROCESS-TYPE.
 19120     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19121     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19122         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19123     ELSE
 19124         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19125     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19126     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19127     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19128     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19129     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19130     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19131
 19132
 19133     IF CP-STATE-STD-ABBRV = 'OR'
 19134        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19135     END-IF
 19136
 19137     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19138        COMPUTE CP-ORIGINAL-BENEFIT =
 19139         (CR-LFAMT - CR-LFPRM)
 19140     END-IF
 19141
 19142     IF CP-TRUNCATED-LIFE
 19143        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19144     END-IF
 19145
 19146     IF CP-TERM-IS-DAYS
 19147        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19148     ELSE
 19149        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19150     END-IF
 19151
 19152     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19153
 19154     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19155
 19156 S-4190-EP-DO-LF-COMM.
 19157
 19158     IF EARNED-BY-CANCEL = ZEROS
 19159         GO TO S-4195-LF-COMM-CONTINUE.
 19160
 19161     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19162         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19163
 19164     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19165         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19166
 19167     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19168         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19169
 19170 S-4195-LF-COMM-CONTINUE.
 19171
 19172     MOVE +0 TO SUB1.
 19173     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19174         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 364
* ECS010.cbl
 19175
 19176     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19177     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19178     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19179
 19180     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19181     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19182     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19183
 19184     MOVE 'Y'          TO EW-LEVEL-USED.
 19185
 19186     IF CR-POLICY-UNDERWRITTEN
 19187         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19188
 19189     ELSE
 19190         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19191
 19192     GO TO S-4200-EP-DO-AH.
 19193
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 365
* ECS010.cbl
 19195******************************************************************
 19196***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19197******************************************************************
 19198
 19199 S-4200-EP-DO-AH.
 19200
 19201     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19202                                        EPR-PRO
 19203                                        EPR-ST.
 19204
 19205     IF CR-AHTYP = ZERO
 19206         GO TO S-4299-EPBX.
 19207
 19208     IF REIN-AH-FLG (SUB5) = SPACE
 19209         GO TO S-4299-EPBX.
 19210
 19211     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19212     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19213     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19214
 19215     MOVE CR-AH-TERM           TO ORIG-TERM.
 19216     MOVE CLAS-INDEXA          TO W-NDX.
 19217
 19218     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19219     MOVE '9'                    TO W-VAL-SOURCE.
 19220     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19221
 19222 S-4220-EP-DO-AH-CNCL.
 19223
 19224     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19225         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19226
 19227 S-4230-EP-DO-AH-EP.
 19228
 19229     IF REM-TRM2 GREATER CR-AH-TERM
 19230         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19231         GO TO S-4290-EP-DO-AH-COMM.
 19232
 19233     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19234         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19235
 19236 S-4235-CHECK-OB-AH-NCL.
 19237
 19238     IF (DTE-CLIENT EQUAL 'NCL') AND
 19239        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19240           MOVE WE-AHPRM         TO EPR-R78
 19241                                    EPR-PRO
 19242                                    EPR-ST
 19243        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19244           (CR-MO EQUAL EOM-MO)
 19245           MOVE '*'            TO OB-DATE-1-SWITCH
 19246           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19247           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19248           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19249           COMPUTE WS-EPR-R78 (SUB3 1) =
 19250                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19251            GO TO S-4290-EP-DO-AH-COMM
 19252        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 366
* ECS010.cbl
 19253        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19254           (CR-MO EQUAL OB-MO (1))
 19255           MOVE '*'            TO OB-DATE-2-SWITCH
 19256           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19257           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19258           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19259           COMPUTE WS-EPR-R78 (SUB3 2) =
 19260                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19261            GO TO S-4290-EP-DO-AH-COMM
 19262        ELSE
 19263        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19264           (CR-MO EQUAL OB-MO (2))
 19265           MOVE '*'            TO OB-DATE-3-SWITCH
 19266           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19267           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19268           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19269           COMPUTE WS-EPR-R78 (SUB3 3) =
 19270                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19271            GO TO S-4290-EP-DO-AH-COMM
 19272        ELSE
 19273            GO TO S-4290-EP-DO-AH-COMM.
 19274
 19275     IF REM-TRM2 NOT GREATER +0
 19276         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19277         GO TO S-4290-EP-DO-AH-COMM.
 19278
 19279     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19280         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19281         GO TO S-4290-EP-DO-AH-COMM.
 19282
 19283     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19284     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19285     IF DTE-R78 = '1'
 19286         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19287     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19288
 19289     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19290         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19291     ELSE
 19292         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19293
 19294     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19295     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19296
 19297     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19298     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19299
 19300     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19301
 19302*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19303*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19304
 19305     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19306
 19307     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19308        (CR-DT GREATER THAN  19921231)
 19309         IF CR-AH-TERM GREATER THAN  +61
 19310             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 367
* ECS010.cbl
 19311             MOVE '*' TO STATUTORY-SWITCH-AH
 19312             GO TO S-4245-EP-DO-AH-EP-AN
 19313         ELSE
 19314             GO TO S-4250-EP-DO-AH-STATUTORY.
 19315
 19316     IF AH-EARN-METHOD EQUAL 'N'
 19317         GO TO S-4240-EP-DO-AH-EP-NP.
 19318
 19319     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19320         MOVE 'A' TO AH-EARN-METHOD
 19321         GO TO S-4245-EP-DO-AH-EP-AN.
 19322
 19323     GO TO S-4250-EP-DO-AH-STATUTORY.
 19324
 19325 S-4240-EP-DO-AH-EP-NP.
 19326
 19327     IF WE-AHPRM = ZERO
 19328         GO TO S-4250-EP-DO-AH-STATUTORY.
 19329
 19330     IF CR-APR GREATER THAN +0
 19331         NEXT SENTENCE
 19332     ELSE
 19333         GO TO S-4250-EP-DO-AH-STATUTORY.
 19334
 19335     IF DTE-CLIENT = 'NCL'
 19336       IF CR-DT LESS THAN 19910101
 19337           GO TO S-4250-EP-DO-AH-STATUTORY.
 19338
 19339     IF REM-TRM1 = CR-AH-TERM
 19340         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19341         GO TO S-4290-EP-DO-AH-COMM.
 19342
 19343     MOVE CR-APR TO NP-APR.
 19344     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19345     MOVE REM-TRM1 TO NP-REM.
 19346     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19347     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19348         MOVE CR-LOAN-TERM TO NP-ORIG.
 19349     MOVE 'R' TO NP-OPT.
 19350     CALL 'ECSNETRM'
 19351         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19352
 19353     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19354
 19355     GO TO S-4250-EP-DO-AH-STATUTORY.
 19356
 19357 S-4245-EP-DO-AH-EP-AN.
 19358     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19359     MOVE 'L'                        TO DC-OPTION-CODE.
 19360     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19361     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19362     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19363     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19364     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19365     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19366     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19367     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19368     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 368
* ECS010.cbl
 19369     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19370                                        CP-RATING-BENEFIT-AMT.
 19371     IF CP-STATE-STD-ABBRV = 'OR'
 19372         COMPUTE CP-RATING-BENEFIT-AMT =
 19373                                  CR-AHAMT * REM-TRM1.
 19374     MOVE CR-APR                     TO CP-LOAN-APR.
 19375     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19376     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19377     MOVE '3'                        TO CP-PROCESS-TYPE.
 19378     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19379     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19380
 19381     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19382         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19383     ELSE
 19384         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19385
 19386     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19387     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19388     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19389     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19390     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19391     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19392
 19393     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19394
 19395     IF CP-ERROR-RATE-NOT-FOUND  OR
 19396        CP-ERROR-RATE-IS-ZERO  OR
 19397        CP-ERROR-IN-DATES
 19398         GO TO S-4250-EP-DO-AH-STATUTORY.
 19399
 19400     COMPUTE EPR-R78 ROUNDED =
 19401             (REM-TRM1 * WE-AHAMT / +100 *
 19402               CP-PREMIUM-RATE)
 19403              / CR-AHPRM-CALC * CR-AHPRM
 19404
 19405     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19406
 19407     IF STATUTORY-REQUIREMENT-AH
 19408         MOVE EPR-R78                TO EPR-ST
 19409         GO TO S-4290-EP-DO-AH-COMM.
 19410
 19411 S-4250-EP-DO-AH-STATUTORY.
 19412     IF (DTE-CLIENT EQUAL 'CID') AND
 19413        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19414         GO TO S-4267-EP-DO-AH-STAT-ROA
 19415     END-IF.
 19416
 19417 S-4250-EP-DO-AH-STATUTORY-VA.
 19418
 19419     MOVE EPR-R78                    TO EPR-ST.
 19420
 19421     MOVE +0                         TO SUB1.
 19422
 19423 S-4255-EP-AH-STAT-LOOP.
 19424     ADD +1 TO SUB1.
 19425
 19426     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 369
* ECS010.cbl
 19427         MOVE EPR-PRO                TO EPR-ST
 19428     ELSE
 19429         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19430             GO TO S-4255-EP-AH-STAT-LOOP.
 19431
 19432     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19433         CR-DT GREATER THAN 19831031)
 19434                    OR
 19435        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19436         CR-DT GREATER THAN 19820629)
 19437                    OR
 19438        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19439         CR-DT GREATER THAN 19830831)
 19440             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19441
 19442     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19443       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19444         IF CR-DT LESS THAN 19970101
 19445             MOVE EPR-R78            TO EPR-ST
 19446         ELSE
 19447             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19448
 19449     GO TO S-4290-EP-DO-AH-COMM.
 19450
 19451 S-4267-EP-DO-AH-STAT-ROA.
 19452     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19453     MOVE 'L'                        TO DC-OPTION-CODE.
 19454     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19455     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19456     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19457     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19458     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19459     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19460     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19461     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19462     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19463     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19464                                        CP-RATING-BENEFIT-AMT.
 19465     IF CP-STATE-STD-ABBRV = 'OR'
 19466         COMPUTE CP-RATING-BENEFIT-AMT =
 19467                                  CR-AHAMT * REM-TRM1.
 19468     MOVE CR-APR                     TO CP-LOAN-APR.
 19469     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19470     MOVE 'A'                        TO CP-EARNING-METHOD.
 19471     MOVE '3'                        TO CP-PROCESS-TYPE.
 19472     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19473     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19474     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19475         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19476     ELSE
 19477         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19478     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19479     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19480     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19481     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19482     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19483     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19484
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 370
* ECS010.cbl
 19485     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19486
 19487     IF CP-ERROR-RATE-NOT-FOUND  OR
 19488        CP-ERROR-RATE-IS-ZERO  OR
 19489        CP-ERROR-IN-DATES
 19490         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19491
 19492     COMPUTE EPR-ST ROUNDED =
 19493             (REM-TRM1 * WE-AHAMT / +100 *
 19494               CP-PREMIUM-RATE)
 19495              / CR-AHPRM-CALC * CR-AHPRM
 19496
 19497     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19498
 19499     GO TO S-4290-EP-DO-AH-COMM.
 19500
 19501 S-4290-EP-DO-AH-COMM.
 19502
 19503     IF EARNED-BY-CANCEL = ZEROS
 19504         GO TO S-4295-AH-COMM-CONTINUE.
 19505
 19506     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19507         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19508
 19509     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19510         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19511
 19512     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19513         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19514
 19515 S-4295-AH-COMM-CONTINUE.
 19516
 19517     MOVE +0           TO SUB1.
 19518     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19519         10 TIMES.
 19520
 19521     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19522     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19523     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19524
 19525     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19526     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19527     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19528
 19529     MOVE 'Y'          TO EW-LEVEL-USED.
 19530
 19531     IF CR-POLICY-UNDERWRITTEN
 19532         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19533     ELSE
 19534         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19535
 19536
 19537 S-4299-EPBX.
 19538     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 371
* ECS010.cbl
 19540******************************************************************
 19541***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19542******************************************************************
 19543
 19544 S-4300-EP-COMM-LOOP.
 19545
 19546     ADD +1 TO SUB1.
 19547     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19548         GO TO S-4399-EP-COMM-LOOP-X.
 19549
 19550     IF EW-LF-AH = AH-OVERRIDE-L1
 19551         GO TO S-4350-EP-COMM-LOOP-A.
 19552
 19553*    IF CR-AGT-TYPE (SUB1) = 'K'
 19554*       COMPUTE COMM-WK =
 19555     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19556     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19557     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19558                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19559
 19560     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19561     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19562     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19563                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19564
 19565     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19566     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19567
 19568     GO TO S-4399-EP-COMM-LOOP-X.
 19569
 19570 S-4350-EP-COMM-LOOP-A.
 19571
 19572     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19573     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19574     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19575                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19576
 19577     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19578     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19579     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19580                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19581
 19582     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19583     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19584
 19585 S-4399-EP-COMM-LOOP-X.
 19586     EXIT.
 19587
 19588******************************************************************
 19589******************************************************************
 19590******************************************************************
 19591******************************************************************
 19592******************************************************************
 19593******************************************************************
 19594******************************************************************
 19595******************************************************************
 19596******************************************************************
 19597******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 372
* ECS010.cbl
 19599******************************************************************
 19600***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19601******************************************************************
 19602
 19603 4400-EP-FIND-TAB-ENT.
 19604
 19605     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19606         GO TO 4490-EP-FIND-TAB-SUB.
 19607     MOVE +1 TO SUB9.
 19608
 19609 4450-EP-FIND-TAB-LOOP.
 19610
 19611     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19612         GO TO 4490-EP-FIND-TAB-SUB.
 19613     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19614         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19615         GO TO 4490-EP-FIND-TAB-SUB.
 19616
 19617     ADD +1 TO SUB9.
 19618     IF SUB9 GREATER THAN +31
 19619         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19620         MOVE 0201 TO WS-ABEND-CODE
 19621         DISPLAY '******************************'
 19622         DISPLAY '***** ERROR LOCATION 020 *****'
 19623         DISPLAY '******************************'
 19624         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19625         GO TO ABEND-PGM.
 19626
 19627     GO TO 4450-EP-FIND-TAB-LOOP.
 19628
 19629 4490-EP-FIND-TAB-SUB.
 19630
 19631     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19632         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19633             ADD +1 TO SUB10
 19634             MOVE SUB10 TO SUB3
 19635             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19636         ELSE
 19637             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19638
 19639     IF WE-LF-AH = AH-OVERRIDE-L1
 19640         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19641             ADD +1 TO SUB10
 19642             MOVE SUB10 TO SUB3
 19643             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19644         ELSE
 19645             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19646
 19647*    IF SUB3 GREATER THAN +220
 19648*    IF SUB3 GREATER THAN +300
 19649     IF SUB3 GREATER THAN +900
 19650         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19651         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19652         MOVE 0202 TO WS-ABEND-CODE
 19653         DISPLAY '******************************'
 19654         DISPLAY '***** ERROR LOCATION 021 *****'
 19655         DISPLAY '******************************'
 19656         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 373
* ECS010.cbl
 19657         GO TO ABEND-PGM.
 19658
 19659     IF CR-POLICY-UNDERWRITTEN
 19660         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19661         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19662                                     TO EPEC-OPT-WORK-TABLE
 19663     ELSE
 19664         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19665         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19666
 19667     MOVE WE-REIN-CO         TO EW-REIN-CO
 19668                                EPEC-REIN-CO (SUB3)
 19669                                EPEC-REIN-CO-II (SUB3).
 19670     MOVE WE-LF-AH           TO EW-LF-AH
 19671                                EPEC-LF-AH (SUB3)
 19672                                EPEC-LF-AH-II (SUB3).
 19673     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19674                                EPEC-BEN-TYPE (SUB3)
 19675                                EPEC-BEN-TYPE-II (SUB3).
 19676
 19677 4499-EP-FIND-TAB-ENT-X.
 19678     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 374
* ECS010.cbl
 19680******************************************************************
 19681***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19682******************************************************************
 19683
 19684 4500-BUILD-EPEC-EXTRACT.
 19685
 19686     IF (DTE-CLIENT = 'DCC')
 19687*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19688        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19689     END-IF
 19690
 19691     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19692         VARYING SUB2 FROM +1 BY +1
 19693             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19694
 19695     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19696
 19697     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19698
 19699
 19700 4510-BUILD-EPEC-EXT.
 19701
 19702     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19703     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19704     IF EW-LEVEL-USED = 'Y'
 19705         MOVE SPACE                     TO W-UNDERWRITING-SW
 19706         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19707                 4518-BUILD-EPEC-RCD-X.
 19708
 19709     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19710     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19711     IF EW-LEVEL-USED = 'Y'
 19712         MOVE '*'                       TO W-UNDERWRITING-SW
 19713         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19714                 4518-BUILD-EPEC-RCD-X.
 19715
 19716     GO TO 4519-BUILD-EPEC-EXT-X.
 19717
 19718 4511-BUILD-EPEC-RECORD.
 19719
 19720     MOVE SPACES                        TO EP-RECORD.
 19721     MOVE 'EP'                          TO EP-RECORD-ID.
 19722     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19723     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19724     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19725     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19726                                           WS-EP-EFF-DTE-N.
 19727     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19728     IF EP-REI-CO NOT = SPACES
 19729         MOVE 'R'                       TO EP-REIN.
 19730     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19731     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19732
 19733     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19734     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19735     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19736
 19737     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 375
* ECS010.cbl
 19738     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19739     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19740
 19741     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19742     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19743     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19744     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19745
 19746     IF DTE-CLIENT NOT = 'NCL'
 19747         GO TO 4512-BUILD-EPEC-CONTINUE.
 19748
 19749     IF W-UNDERWRITTEN-DATA
 19750         GO TO 4512-BUILD-EPEC-CONTINUE.
 19751
 19752     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19753         GO TO 4512-BUILD-EPEC-CONTINUE.
 19754
 19755     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19756        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19757        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19758         NEXT SENTENCE
 19759     ELSE
 19760         GO TO 4512-BUILD-EPEC-CONTINUE.
 19761
 19762     IF OB-DATE-1-USED  OR
 19763        OB-DATE-2-USED  OR
 19764        OB-DATE-3-USED
 19765         NEXT SENTENCE
 19766     ELSE
 19767         GO TO 4512-BUILD-EPEC-CONTINUE.
 19768
 19769     IF OB-DATE-1-USED
 19770         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19771             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19772                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19773             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19774                                   EW-EPR-ST
 19775             GO TO 4512-BUILD-EPEC-CONTINUE
 19776         ELSE
 19777             GO TO 4512-BUILD-EPEC-CONTINUE.
 19778
 19779     IF OB-DATE-2-USED
 19780         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19781             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19782                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19783             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19784                                   EW-EPR-ST
 19785             GO TO 4512-BUILD-EPEC-CONTINUE
 19786         ELSE
 19787             GO TO 4512-BUILD-EPEC-CONTINUE.
 19788
 19789     IF OB-DATE-3-USED
 19790         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19791             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19792                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19793             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19794                                   EW-EPR-ST
 19795             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 376
* ECS010.cbl
 19796         ELSE
 19797             GO TO 4512-BUILD-EPEC-CONTINUE.
 19798
 19799 4512-BUILD-EPEC-CONTINUE.
 19800
 19801     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19802     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19803     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19804
 19805     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19806     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19807     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19808
 19809     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19810
 19811     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19812     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19813     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19814
 19815     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19816     MOVE ZEROS                         TO EP-CLM-PV.
 19817
 19818     if (dte-client = 'AHL')
 19819        and (ep-rcd-type = 'A')
 19820        and (ep-ben-code (1:1) = 'M')
 19821*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19822        continue
 19823     else
 19824        IF EP-RCD-TYPE = 'A' OR 'U'
 19825           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19826              PERFORM 4599A-CALC-IBNR
 19827                                 THRU 4599A-CALC-EXIT
 19828           end-if
 19829        end-if
 19830     end-if
 19831
 19832     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19833
 19834     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19835     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19836
 19837     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19838
 19839     IF EW-ISS-CNT = ZERO
 19840         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19841                                           EP-AVG-AGE
 19842       ELSE
 19843         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19844                                EW-ORIG-TERM / EW-ISS-CNT
 19845         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19846
 19847     IF EW-INFORCE-CNT = ZERO
 19848         MOVE ZERO                      TO EP-AVG-REM-TERM
 19849       ELSE
 19850         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19851                             EW-REM-TERM / EW-INFORCE-CNT.
 19852
 19853     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 377
* ECS010.cbl
 19854         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19855                                           EP-WEIGHTED-AGE
 19856       ELSE
 19857         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19858                                  EW-TERM-BEN / EW-ISS-BEN
 19859         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19860                                   EW-AGE-BEN / EW-ISS-BEN.
 19861
 19862     MOVE ZEROS                         TO
 19863         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19864         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19865
 19866     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19867                                           WS-EP-HI-COV-DT-N.
 19868     MOVE HIGH-CERT                     TO EP-HI-CERT
 19869                                           WS-EP-HI-CERT-N.
 19870     MOVE LOW-CERT                      TO EP-LO-CERT
 19871                                           WS-EP-LO-CERT-N.
 19872     IF DTE-PGM-OPT = '3'
 19873         MOVE 'P'                       TO EP-PURGE.
 19874
 19875     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19876         GO TO 4514-CONTINUE.
 19877
 19878     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19879
 19880     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19881         MOVE +1                 TO EP-LIFE-YEARS
 19882     ELSE
 19883         MOVE ZEROS              TO W-LIFE-YEARS
 19884         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19885                 VARYING
 19886             SUBM FROM +1 BY +1
 19887                 UNTIL
 19888             SUBM GREATER THAN +13
 19889         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19890             = W-LIFE-YEARS / 12
 19891             - (EPEC-LIFE-CTR (SUB2 1)
 19892             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19893         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19894         IF  EP-LIFE-YEARS LESS THAN +1
 19895             MOVE +1             TO EP-LIFE-YEARS.
 19896
 19897 4514-CONTINUE.
 19898
 19899     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19900
 19901     MOVE SPACES                        TO EC-RECORD.
 19902     MOVE '1'                           TO WS-SEQ-NBR.
 19903     MOVE +0                            TO SUB3.
 19904     MOVE +0                            TO SUB4.
 19905     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19906         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19907         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19908
 19909     GO TO 4518-BUILD-EPEC-RCD-X.
 19910
 19911 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 378
* ECS010.cbl
 19912
 19913     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 19914
 19915 4515-EXIT.
 19916     EXIT.
 19917
 19918 4518-BUILD-EPEC-RCD-X.
 19919     EXIT.
 19920
 19921 4519-BUILD-EPEC-EXT-X.
 19922     EXIT.
 19923
 19924 4520-BUILD-EPEC-LOAD-COMM.
 19925
 19926     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 19927
 19928     ADD +1 TO SUB3  SUB4.
 19929     MOVE ZEROS                  TO LEVELS-BUILT.
 19930
 19931 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19932
 19933     IF SUB4 GREATER THAN WS-LOOP-MAX
 19934         IF AGT-SW = 'X'
 19935             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19936                 THRU 4900-WRT-SUMMARY-X
 19937             MOVE ' '            TO AGT-SW
 19938             MOVE WS-LOOP-MAX    TO  SUB4
 19939             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19940         ELSE
 19941             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 19942
 19943     IF LEVELS-BUILT EQUAL +5
 19944         IF AGT-SW = 'X'
 19945             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19946                 THRU 4900-WRT-SUMMARY-X
 19947             MOVE ' '            TO AGT-SW
 19948             MOVE ZEROS          TO LEVELS-BUILT
 19949             ADD 1 TO WS-SEQ-NBR
 19950             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 19951             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 19952                     4540-BUILD-CLEAR-X
 19953                 VARYING SUB3 FROM +1 BY +1
 19954                 UNTIL SUB3 GREATER THAN +5
 19955             MOVE +1             TO SUB3
 19956             GO TO 4531-BUILD-EPEC-LOAD-COMM
 19957         ELSE
 19958             MOVE +1             TO SUB3
 19959             MOVE ZEROS          TO LEVELS-BUILT
 19960             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 19961
 19962     IF SUB4 GREATER THAN WS-LOOP-MAX
 19963         IF AGT-SW = 'X'
 19964             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19965                 THRU 4900-WRT-SUMMARY-X
 19966             MOVE ' '                   TO AGT-SW
 19967             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19968         ELSE
 19969             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 379
* ECS010.cbl
 19970
 19971 4531-BUILD-EPEC-LOAD-COMM.
 19972
 19973     IF (EW-AGT-NO (SUB4) = SPACES)
 19974                  OR
 19975        ((EW-ISS-COM (SUB4) = ZEROS) AND
 19976         (EW-CNC-COM (SUB4) = ZEROS) AND
 19977         (EW-ECR-R78 (SUB4) = ZEROS) AND
 19978         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 19979         (EW-ECR-PRO (SUB4) = ZEROS) AND
 19980         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 19981         (EW-ECR-ST (SUB4) = ZEROS))
 19982         PERFORM 4540-BUILD-EPEC-CLEAR
 19983             THRU 4540-BUILD-CLEAR-X
 19984         ADD +1 TO SUB4
 19985         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19986
 19987     MOVE 'X'                           TO AGT-SW.
 19988     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 19989     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 19990     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 19991     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 19992     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 19993     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 19994     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 19995     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 19996     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 19997
 19998     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 19999
 20000     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20001
 20002 4539-BUILD-EPEC-LOAD-COMM-X.
 20003     EXIT.
 20004
 20005 4540-BUILD-EPEC-CLEAR.
 20006
 20007     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20008     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20009     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20010                                           EC-CNC-COMM (SUB3)
 20011                                           EC-COMM-78 (SUB3)
 20012                                           EC-COMM-PR (SUB3)
 20013                                           EC-COMM-ST (SUB3)
 20014                                           EC-COMM-78-ADJ (SUB3)
 20015                                           EC-COMM-PR-ADJ (SUB3).
 20016
 20017 4540-BUILD-CLEAR-X.
 20018     EXIT.
 20019
 20020 4541-CALC-IBNR.
 20021
 20022     MOVE +0                    TO TOT-AH-IBNR
 20023                                   TOT-AH-PRM
 20024                                   TOT-AH-PD-CLMS
 20025                                   TOT-AH-CLMRSV
 20026                                   TOT-LF-IBNR
 20027                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 380
* ECS010.cbl
 20028                                   TOT-LF-PD-CLMS
 20029                                   TOT-LF-CLMRSV
 20030
 20031     MOVE +0                    TO RTOT-AH-IBNR
 20032                                   RTOT-AH-PRM
 20033                                   RTOT-AH-PRMB
 20034                                   RTOT-AH-PD-CLMS
 20035                                   RTOT-AH-CLMRSV
 20036                                   RTOT-LF-IBNR
 20037                                   RTOT-LF-PRM
 20038                                   RTOT-LF-PD-CLMS
 20039                                   RTOT-LF-CLMRSV
 20040
 20041     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20042        (SUB2 > +900)
 20043        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20044*       IF W-UNDERWRITTEN-DATA
 20045*          MOVE EPEC-LEVELS-II (SUB2)
 20046*                                TO EPEC-WORK
 20047*       ELSE
 20048           MOVE EPEC-LEVELS (SUB2)
 20049                                 TO EPEC-WORK
 20050*       END-IF
 20051*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20052           IF EW-REIN-CO = SPACES
 20053              CONTINUE
 20054*             IF EW-LF-AH = 'L'
 20055*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20056*                   + EW-EPR-ST
 20057*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20058*                   + EW-CLM-AMT
 20059*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20060*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20061*             ELSE
 20062*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20063*                   + EW-EPR-ST
 20064*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20065*                   + EW-CLM-AMT
 20066*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20067*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20068           ELSE
 20069              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20070                 EW-LF-AH ' ' EW-BEN-TYPE
 20071              IF EW-LF-AH = 'L'
 20072                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20073                    + EW-EPR-ST
 20074                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20075                    + EW-CLM-AMT
 20076                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20077                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20078              ELSE
 20079                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20080                    + EW-EPR-ST
 20081                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20082                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20083                       + EW-EPR-ST
 20084                 END-IF
 20085                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 381
* ECS010.cbl
 20086                    + EW-CLM-AMT
 20087                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20088                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20089              END-IF
 20090           END-IF
 20091*       END-IF
 20092     END-PERFORM
 20093
 20094*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20095*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20096*    IF TOT-AH-IBNR < ZEROS
 20097*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20098*    END-IF
 20099*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20100*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20101*    IF TOT-LF-IBNR < ZEROS
 20102*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20103*    END-IF
 20104
 20105     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20106        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20107     IF RTOT-AH-IBNR < ZEROS
 20108        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20109     END-IF
 20110     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20111        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20112     IF RTOT-LF-IBNR < ZEROS
 20113        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20114     END-IF
 20115
 20116     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20117        (SUB2 > +900)
 20118        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20119*       IF W-UNDERWRITTEN-DATA
 20120*          MOVE EPEC-LEVELS-II (SUB2)
 20121*                                TO EPEC-WORK
 20122*       ELSE
 20123           MOVE EPEC-LEVELS (SUB2)
 20124                                 TO EPEC-WORK
 20125*       END-IF
 20126*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20127           IF EW-REIN-CO = SPACES
 20128              CONTINUE
 20129*             IF EW-LF-AH = 'L'
 20130*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20131*                   / TOT-LF-PRM
 20132*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20133*                   * RTOT-LF-IBNR
 20134**                  * TOT-LF-IBNR
 20135*             ELSE
 20136*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20137*                   / TOT-AH-PRM
 20138*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20139*                   * RTOT-AH-IBNR
 20140**                  * TOT-AH-IBNR
 20141*             END-IF
 20142           ELSE
 20143              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 382
* ECS010.cbl
 20144                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20145                    EW-EPR-ST ' ' RTOT-AH-PRM
 20146              IF EW-LF-AH = 'L'
 20147                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20148                    / RTOT-LF-PRM
 20149                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20150                    * RTOT-LF-IBNR
 20151              ELSE
 20152                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20153                    / RTOT-AH-PRMB
 20154                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20155                    * RTOT-AH-IBNR
 20156              END-IF
 20157              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20158                 move zeros to ew-clm-ibnr
 20159              end-if
 20160           END-IF
 20161*       END-IF
 20162*       IF W-UNDERWRITTEN-DATA
 20163*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20164*       ELSE
 20165           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20166*       END-IF
 20167     END-PERFORM
 20168
 20169     .
 20170 4541-EXIT.
 20171     EXIT.
 20172
 20173 4545-BUILD-BASE.
 20174
 20175     MOVE 'EC'                   TO EC-RECORD-ID.
 20176     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20177     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20178     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20179     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20180                                    WS-EC-EFF-DTE.
 20181     MOVE EW-REIN-CO             TO EC-REI-CO.
 20182     IF EC-REI-CO NOT = SPACES
 20183         MOVE 'R'                TO EC-REIN.
 20184     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20185     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20186     IF DTE-PGM-OPT = '3'
 20187         MOVE 'P'                TO EC-PURGE.
 20188     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20189
 20190 4545-BUILD-BASE-X.
 20191     EXIT.
 20192
 20193******************************************************************
 20194***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20195******************************************************************
 20196
 20197 4550-CLEAR-EPEC-TOTALS.
 20198
 20199     MOVE LOW-CERT             TO SV-LO-CERT.
 20200     MOVE HIGH-CERT            TO SV-HI-CERT.
 20201     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 383
* ECS010.cbl
 20202     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20203
 20204     MOVE +1                   TO SUB9.
 20205     MOVE +0                   TO SUB10.
 20206     MOVE ZERO                 TO EW-REIN-CO
 20207                                  EW-BEN-TYPE.
 20208     MOVE SPACE                TO EP-FLG
 20209                                  EW-LF-AH
 20210                                  EW-LEVEL-USED
 20211                                  W-TABLE-USED-SW.
 20212
 20213     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20214                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20215                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20216                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20217                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20218                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20219                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20220                                  EW-CLM-AMT     EW-COV-DTE
 20221                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20222                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20223                                  EW-CLM-CRT     EW-ISS-CNT
 20224                                  EW-CNC-CNT     EW-AGE
 20225                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20226                                  EW-AGE-BEN     EW-TERM-BEN
 20227                                  EW-ISS-PRM-TAX
 20228                                  EW-REM-TERM.
 20229
 20230     MOVE +1 TO SUB1.
 20231     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20232     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20233         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20234     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20235                                    EPEC-UNDW-OPT-DATA-TABLE.
 20236     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20237         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20238
 20239     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20240         VARYING SUB3 FROM +1 BY +1
 20241*        UNTIL SUB3 GREATER THAN +300.
 20242*        UNTIL SUB3 GREATER THAN +220.
 20243         UNTIL SUB3 GREATER THAN +900.
 20244
 20245     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20246
 20247 4555-CLEAR-EPEC-COMM.
 20248
 20249     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20250                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20251                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20252                EW-ECR-ST  (SUB1).
 20253     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20254                                    EW-AGT-TYPE (SUB1).
 20255
 20256     ADD +1 TO SUB1.
 20257
 20258 4560-CLEAR-EPEC-ALL.
 20259
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 384
* ECS010.cbl
 20260     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20261                                    EPEC-LEVELS-II (SUB1).
 20262     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20263
 20264 4570-CLEAR-EPEC-SUB-A.
 20265
 20266     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20267     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20268*        UNTIL SUB2 GREATER +300.
 20269         UNTIL SUB2 GREATER +900.
 20270
 20271 4580-CLEAR-EPEC-SUB-B.
 20272
 20273     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20274     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20275
 20276 4589-CLEAR-EPEC-TOTALS-X.
 20277     EXIT.
 20278
 20279 4590-INIT-OB.
 20280
 20281     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20282     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20283     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20284
 20285 4590-EXIT.
 20286     EXIT.
 20287
 20288 4599-BUILD-EPEC-EXTRACT-X.
 20289     EXIT.
 20290
 20291*********************************************************
 20292*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20293*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20294*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20295*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20296*  IN THE DATE CARD.                                    *
 20297*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20298*********************************************************
 20299
 20300 4599A-CALC-IBNR.
 20301
 20302     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20303        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20304                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20305         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20306                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20307                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20308
 20309     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20310         MOVE ZEROS                 TO EW-CLM-IBNR
 20311         GO TO 4599A-CALC-EXIT.
 20312
 20313     IF EP-REIN = 'R'
 20314         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20315
 20316     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20317
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 385
* ECS010.cbl
 20318 4599A-CALC-EXIT.
 20319      EXIT.
 20320 4599B-SEARCH.
 20321      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 386
* ECS010.cbl
 20323******************************************************************
 20324***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20325******************************************************************
 20326
 20327 4600-GET-OPT-IBNR.
 20328
 20329     IF  CR-POLICY-IS-ACTIVE
 20330         IF  CR-POLICY-IS-REISSUE
 20331             OR CR-POLICY-IS-MONTHLY
 20332             IF  W-LIFE
 20333                 GO TO 4600-EXIT
 20334             ELSE
 20335                 NEXT SENTENCE
 20336         ELSE
 20337             NEXT SENTENCE
 20338     ELSE
 20339         IF  W-LIFE
 20340             GO TO 4600-EXIT.
 20341
 20342     IF  W-LIFE
 20343         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20344     ELSE
 20345         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20346
 20347 4600-EXIT.
 20348     EXIT.
 20349
 20350 4620-DETERMINE-LIFE-IBNR.
 20351
 20352     IF  CR-LF-POLICY-IS-ACTIVE
 20353         ADD +1                  TO W-LF-ACTIVE
 20354         IF  CR-LF-POLICY-IS-REISSUE
 20355             OR CR-LF-POLICY-IS-MONTHLY
 20356             MOVE ZEROS          TO W-WK-IBNR
 20357             ADD +1              TO W-LF-REISSUE
 20358             GO TO 4620-EXIT
 20359         ELSE
 20360             NEXT SENTENCE
 20361     ELSE
 20362         ADD +1                  TO W-LF-INACTIVE
 20363         MOVE ZEROS              TO W-WK-IBNR
 20364         GO TO 4620-EXIT.
 20365
 20366     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20367         MOVE ZEROS              TO W-WK-IBNR
 20368         ADD +1                  TO W-LF-CALC-B
 20369         GO TO 4620-EXIT.
 20370
 20371     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20372                 AND
 20373             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20374                 AND
 20375             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20376             OR
 20377         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20378                 AND
 20379             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20380                 AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 387
* ECS010.cbl
 20381             REM-TRM2 NOT GREATER THAN ZERO)
 20382         MOVE ZEROS              TO W-WK-IBNR
 20383         ADD +1                  TO W-LF-BALLOON
 20384         GO TO 4620-EXIT
 20385     ELSE
 20386         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20387                 AND
 20388             REM-TRM2 NOT GREATER THAN ZERO)
 20389             ADD +1              TO W-LF-REMTERM-0
 20390             MOVE ZEROS          TO W-WK-IBNR
 20391             GO TO 4620-EXIT.
 20392
 20393     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20394
 20395     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20396         ADD +1                  TO W-LF-REMAMT-0
 20397         MOVE ZEROS              TO W-WK-IBNR
 20398         GO TO 4620-EXIT.
 20399
 20400     IF  AM-LIFE-IBNR-PCT NUMERIC
 20401             AND
 20402         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20403         COMPUTE W-WK-IBNR ROUNDED
 20404             = CP-REMAINING-AMT
 20405             / 1000
 20406             * AM-LIFE-IBNR-PCT
 20407     ELSE
 20408         COMPUTE W-WK-IBNR ROUNDED
 20409             = CP-REMAINING-AMT
 20410             / 1000
 20411             * COMPANY-IBNR-LIFE-FACTOR.
 20412
 20413     IF  CR-LF-IS-REIN-ONLY
 20414         ADD +1                  TO W-LF-REIN
 20415     ELSE
 20416         ADD +1                  TO W-LF-DATA-USED
 20417         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20418         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20419         IF  CR-LFTYP = '01'
 20420             ADD CP-REMAINING-AMT
 20421                                 TO W-01-REMAMT
 20422             ADD +1              TO W-01-DATA-USED
 20423         ELSE
 20424         IF  CR-LFTYP = '02'
 20425             ADD CP-REMAINING-AMT
 20426                                 TO W-02-REMAMT
 20427             ADD +1              TO W-02-DATA-USED
 20428         ELSE
 20429         IF  CR-LFTYP = '03'
 20430             ADD CP-REMAINING-AMT
 20431                                 TO W-03-REMAMT
 20432             ADD +1              TO W-03-DATA-USED
 20433         ELSE
 20434         IF  CR-LFTYP = '04'
 20435             ADD CP-REMAINING-AMT
 20436                                 TO W-04-REMAMT
 20437             ADD +1              TO W-04-DATA-USED
 20438         ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 388
* ECS010.cbl
 20439         IF  CR-LFTYP = '05'
 20440             ADD CP-REMAINING-AMT
 20441                                 TO W-05-REMAMT
 20442             ADD +1              TO W-05-DATA-USED
 20443         ELSE
 20444         IF  CR-LFTYP = '06'
 20445             ADD CP-REMAINING-AMT
 20446                                 TO W-06-REMAMT
 20447             ADD +1              TO W-06-DATA-USED
 20448         ELSE
 20449         IF  CR-LFTYP = '30'
 20450             ADD CP-REMAINING-AMT
 20451                                 TO W-30-REMAMT
 20452             ADD +1              TO W-30-DATA-USED
 20453         ELSE
 20454         IF  CR-LFTYP = '31'
 20455             ADD CP-REMAINING-AMT
 20456                                 TO W-31-REMAMT
 20457             ADD +1              TO W-31-DATA-USED
 20458         ELSE
 20459             ADD CP-REMAINING-AMT
 20460                                 TO W-XX-REMAMT
 20461             ADD +1              TO W-XX-DATA-USED.
 20462
 20463     IF  CR-POLICY-IS-REIN-ONLY
 20464             OR
 20465         CR-LF-IS-REIN-ONLY
 20466         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20467         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20468         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20469     ELSE
 20470         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20471
 20472 4620-EXIT.
 20473     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 389
* ECS010.cbl
 20475 4640-GET-A-H-EARNED-PREMIUM.
 20476
 20477     IF  CR-AH-POLICY-IS-ACTIVE
 20478         ADD +1                  TO W-AH-ACTIVE
 20479         IF  CR-AH-POLICY-IS-REISSUE
 20480             OR CR-AH-POLICY-IS-MONTHLY
 20481             ADD +1              TO W-AH-REISSUE
 20482         ELSE
 20483             NEXT SENTENCE
 20484     ELSE
 20485         ADD +1                  TO W-AH-INACTIVE.
 20486
 20487     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20488         ADD +1                  TO W-AH-CALC-B
 20489         GO TO 4640-EXIT.
 20490
 20491     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20492         MOVE 'Y'                TO W-RTRM-0-SW
 20493     ELSE
 20494         MOVE SPACES             TO W-RTRM-0-SW.
 20495
 20496     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20497
 20498****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20499******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20500******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20501******        THAT CLAIM.
 20502
 20503     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20504
 20505     IF  CR-POLICY-IS-REIN-ONLY
 20506              OR
 20507         CR-AH-IS-REIN-ONLY
 20508         ADD +1                  TO W-AH-REIN
 20509         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20510         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20511         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20512         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20513         GO TO 4640-EXIT.
 20514
 20515     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20516                                    W-EPEC-EP-IN.
 20517     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20518                                    W-CLAIMS-MADE-PAID-IN.
 20519     ADD +1                      TO W-AH-DATA-USED.
 20520     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20521     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20522
 20523     IF  W-CLMAMT GREATER THAN ZEROS
 20524         ADD +1                  TO W-AH-CLAIM-CTR
 20525         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20526
 20527     IF  W-RTRM-0
 20528             AND
 20529         NOT CR-POLICY-IS-REIN-ONLY
 20530             AND
 20531         NOT CR-AH-IS-REIN-ONLY
 20532         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 390
* ECS010.cbl
 20533         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20534         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20535         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20536         ADD +1                  TO W-AH-REMTERM-0.
 20537
 20538 4640-EXIT.
 20539     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 391
* ECS010.cbl
 20541 4650-DETERMINE-CLM-AMT-AH.
 20542
 20543     MOVE ZEROS                  TO W-CLMAMT.
 20544
 20545     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20546             OR
 20547         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20548         GO TO 4650-EXIT.
 20549
 20550     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20551             AND
 20552         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20553         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20554         MOVE 'L'                    TO DC-OPTION-CODE
 20555         PERFORM 8000-DATE-CONVERT-ROUTINE
 20556             THRU 8099-DATE-CONVERT-X
 20557         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20558         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20559         MOVE 'L'                    TO DC-OPTION-CODE
 20560         PERFORM 8000-DATE-CONVERT-ROUTINE
 20561             THRU 8099-DATE-CONVERT-X
 20562         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20563         IF  DATE-CONVERSION-ERROR
 20564             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20565             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20566             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20567             MOVE 0303               TO WS-ABEND-CODE
 20568             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20569             GO TO ABEND-PGM
 20570         ELSE
 20571             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20572             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20573             MOVE '1'                TO DC-OPTION-CODE
 20574             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20575                                        DC-ELAPSED-DAYS
 20576             PERFORM 8000-DATE-CONVERT-ROUTINE
 20577                 THRU 8099-DATE-CONVERT-X
 20578             IF  DATE-CONVERSION-ERROR
 20579                 DISPLAY 'DIS TO PTO DATE ERROR '
 20580                     CR-FULL-CONTROL
 20581                 MOVE 'DIS TO PTO DATE ERROR '
 20582                                     TO WS-ABEND-MESSAGE
 20583                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20584                 MOVE 0303           TO WS-ABEND-CODE
 20585                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20586                 GO TO ABEND-PGM
 20587             ELSE
 20588                 COMPUTE W-CLMAMT ROUNDED
 20589                     = CR-AHAMT
 20590                     * (DC-ELAPSED-DAYS / 30)
 20591                 GO TO 4650-EXIT.
 20592
 20593     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20594             OR
 20595         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20596         GO TO 4650-EXIT.
 20597
 20598     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 392
* ECS010.cbl
 20599         = CR-AHAMT * 3.
 20600
 20601     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20602         MOVE CR-DISAMT          TO W-CLMAMT
 20603     ELSE
 20604         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20605
 20606     IF  NOT CR-POLICY-IS-REIN-ONLY
 20607              AND
 20608         NOT CR-AH-IS-REIN-ONLY
 20609         ADD +1          TO W-CLM-EXCEPT-CNT
 20610         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20611
 20612 4650-EXIT.
 20613     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 393
* ECS010.cbl
 20615 4660-DETERMINE-EARNED-PREMIUM.
 20616
 20617     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20618
 20619     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20620
 20621     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20622
 20623     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20624         MOVE ZEROS              TO W-EARNED-PREMIUM
 20625         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20626         MOVE '7'                TO W-VAL-SOURCE
 20627         PERFORM 8500-REMAINING-TERM-ROUTINE
 20628             THRU 8599-REM-TERM-X
 20629         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20630         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20631         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20632         MOVE EPR-R78            TO W-OPT-R78
 20633         MOVE EPR-PRO            TO W-OPT-PRO
 20634         MOVE EPR-ST             TO W-OPT-ST
 20635         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20636         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20637     ELSE
 20638         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20639
 20640     COMPUTE W-EARNED-PREMIUM ROUNDED
 20641         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20642
 20643     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20644         ADD +1                  TO W-EP-LESS-THAN-0
 20645         MOVE ZERO               TO W-EARNED-PREMIUM.
 20646
 20647 4660-EXIT.
 20648     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 394
* ECS010.cbl
 20650 4666-SAVE-AHCR-DATA.
 20651
 20652     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20653                                    WX-STATUS-AT-SETTLEMENT.
 20654
 20655     MOVE ZEROS                  TO WX-CANC-DT
 20656                                    WX-EOM-RUN-DATE
 20657                                    WX-SETTLEMENT-EXIT-DATE.
 20658
 20659     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20660         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20661         MOVE CR-AH-STATUS-AT-CANCEL
 20662                                 TO WX-STATUS-AT-CANCEL
 20663         MOVE ZEROS              TO CR-AH-CANC-DT
 20664                                    WS-CR-AH-CANC-DT-N
 20665         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20666
 20667     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20668         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20669                                 TO WX-SETTLEMENT-EXIT-DATE
 20670         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20671                                 TO WX-STATUS-AT-SETTLEMENT
 20672         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20673                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20674         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20675
 20676     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20677     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20678
 20679 4666-EXIT.
 20680     EXIT.
 20681
 20682 4668-RESTORE-AHCR-DATA.
 20683
 20684     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20685         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20686                                    WS-CR-AH-CANC-DT-N
 20687         MOVE WX-STATUS-AT-CANCEL
 20688                                 TO CR-AH-STATUS-AT-CANCEL.
 20689
 20690     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20691         MOVE WX-SETTLEMENT-EXIT-DATE
 20692                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20693                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20694         MOVE WX-STATUS-AT-SETTLEMENT
 20695                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20696
 20697     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20698
 20699 4668-EXIT.
 20700     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 395
* ECS010.cbl
 20702 4670-CALC-EP.
 20703
 20704     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20705         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20706         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20707         GO TO 4670-EXIT.
 20708
 20709     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20710         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20711         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20712         GO TO 4670-EXIT.
 20713
 20714***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20715
 20716     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20717         COMPUTE W-EARNED-PREMIUM
 20718             = (W-OPT-PRO + W-OPT-R78) / +2
 20719         ADD W-EARNED-PREMIUM    TO W-M-EP
 20720     ELSE
 20721         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20722             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20723             ADD W-EARNED-PREMIUM
 20724                                 TO W-R-EP
 20725         ELSE
 20726             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20727                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20728                 ADD W-EARNED-PREMIUM
 20729                                 TO W-P-EP
 20730             ELSE
 20731                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20732                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20733                         = (W-OPT-PRO * +.6667)
 20734                         + (W-OPT-R78 * +.3333)
 20735                     ADD W-EARNED-PREMIUM
 20736                                 TO W-1-EP
 20737                 ELSE
 20738                     ADD +1      TO W-OTHERS-COUNT
 20739                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20740
 20741 4670-EXIT.
 20742     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 396
* ECS010.cbl
 20744 4680-CALC-REMAINING-AMT-LF.
 20745
 20746     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20747     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20748     MOVE CR-APR                 TO CP-LOAN-APR.
 20749     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20750
 20751     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20752         MOVE +1                 TO CR-PMT-FREQ.
 20753
 20754     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20755
 20756     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20757     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20758                                    CP-RATING-BENEFIT-AMT.
 20759     IF CP-STATE-STD-ABBRV = 'OR'
 20760         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20761     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20762     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20763     MOVE ZEROS                  TO CP-REMAINING-AMT
 20764                                    CP-REMAINING-AMT-PRV
 20765                                    CP-RETURN-CODE
 20766                                    CP-RETURN-CODE-2.
 20767
 20768     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20769     IF (DTE-CLIENT = 'DCC')
 20770        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 20771        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20772           ((CR-STATE = DD-STATE (D1))
 20773           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20774           AND ('A'           = DD-BEN-TYPE   (D1))
 20775           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 20776           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20777                           OR
 20778           D1 > +800
 20779        END-PERFORM
 20780        IF D1 < +801
 20781           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20782              (P1 > +8)
 20783              OR (DD-PROD-CODE (D1 P1) = 'L')
 20784           END-PERFORM
 20785           IF P1 < +9
 20786              MOVE DD-MAX-BEN-AMT (D1 P1)
 20787                                 TO CP-R-MAX-TOT-BEN
 20788           END-IF
 20789        END-IF
 20790     END-IF
 20791
 20792     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20793
 20794     IF  CP-RETURN-CODE NOT = ZERO
 20795         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20796                             TO WS-ABEND-MESSAGE
 20797         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20798         MOVE 2001           TO WS-ABEND-CODE
 20799         GO TO ABEND-PGM.
 20800
 20801 4680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 397
* ECS010.cbl
 20802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 398
* ECS010.cbl
 20804******************************************************************
 20805***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20806******************************************************************
 20807
 20808 4700-CALC-OPT-IBNR.
 20809
 20810     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20811     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20812
 20813     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20814             VARYING
 20815         SUB2 FROM +1 BY +1
 20816             UNTIL
 20817*        SUB2 GREATER THAN 300.
 20818*        SUB2 GREATER THAN 220.
 20819         SUB2 GREATER THAN 900.
 20820
 20821     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20822                                 TO EPEC-OPT-WORK-TABLE.
 20823     MOVE '*'                    TO W-UNDERWRITING-SW.
 20824
 20825     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20826             VARYING
 20827         SUB2 FROM +1 BY +1
 20828             UNTIL
 20829*        SUB2 GREATER THAN 300.
 20830*        SUB2 GREATER THAN 220.
 20831         SUB2 GREATER THAN 900.
 20832
 20833 4700-EXIT.
 20834     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 399
* ECS010.cbl
 20836 4710-PROCESS-THRU-EPEC-TABLE.
 20837
 20838     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20839         GO TO 4710-EXIT.
 20840
 20841     IF  W-UNDERWRITTEN-DATA
 20842         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20843     ELSE
 20844         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20845
 20846     IF EW-LEVEL-USED NOT = 'Y'
 20847         GO TO 4710-EXIT.
 20848
 20849     IF  EW-REIN-CO GREATER THAN SPACES
 20850         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20851         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20852             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20853             IF  W-WK-IBNR GREATER THAN ZEROS
 20854                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20855                 GO TO 4710-EXIT
 20856             ELSE
 20857                 GO TO 4710-EXIT
 20858         ELSE
 20859             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20860                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20861                 GO TO 4710-EXIT
 20862             ELSE
 20863                 GO TO 4710-EXIT.
 20864
 20865     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20866
 20867     IF  EW-LF-AH EQUAL 'L'
 20868         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20869             GO TO 4710-EXIT
 20870         ELSE
 20871             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20872             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20873     ELSE
 20874         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20875                 GREATER THAN ZEROS
 20876             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20877             ADD W-WK-IBNR       TO W-AH-IBNR
 20878         ELSE
 20879             GO TO 4710-EXIT.
 20880
 20881     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20882     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20883     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20884
 20885     IF  W-UNDERWRITTEN-DATA
 20886         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20887     ELSE
 20888         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20889
 20890
 20891     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20892     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20893
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 400
* ECS010.cbl
 20894 4710-EXIT.
 20895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 401
* ECS010.cbl
 20897 4720-PROCESS-LIFE.
 20898
 20899     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20900
 20901 4720-EXIT.
 20902     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 402
* ECS010.cbl
 20904 4730-PROCESS-A-H.
 20905
 20906     IF  AM-TARGET-LOSS-RATIO NUMERIC
 20907             AND
 20908         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 20909         MOVE AM-TARGET-LOSS-RATIO
 20910                                 TO W-TARGET-LOSS-RATIO
 20911     ELSE
 20912         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 20913             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 20914                                 TO W-TARGET-LOSS-RATIO
 20915             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 20916
 20917     IF  W-NOT-REIN-PROCESS
 20918         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 20919         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 20920
 20921     COMPUTE W-IBNR-1 ROUNDED
 20922         = EPEC-EARNED-PREMIUM-AH (SUB2)
 20923         * COMPANY-IBNR-AH-FACTOR
 20924         * W-TARGET-LOSS-RATIO.
 20925
 20926     COMPUTE W-IBNR-2 ROUNDED
 20927         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 20928         * W-TARGET-LOSS-RATIO)
 20929         - EPEC-CLAIMS-MADE-PAID (SUB2).
 20930
 20931     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 20932         MOVE W-IBNR-1           TO W-WK-IBNR
 20933         IF  W-NOT-REIN-PROCESS
 20934             ADD +1              TO W-AH-IBNR-1-CNT
 20935             ADD W-IBNR-1        TO W-AH-IBNR-1
 20936         ELSE
 20937             NEXT SENTENCE
 20938     ELSE
 20939         MOVE W-IBNR-2           TO W-WK-IBNR
 20940         IF  W-NOT-REIN-PROCESS
 20941             ADD +1              TO W-AH-IBNR-2-CNT
 20942             ADD W-IBNR-2        TO W-AH-IBNR-2.
 20943
 20944 4730-EXIT.
 20945     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 403
* ECS010.cbl
 20947 4735-GET-BUSINESS-ADJUSTMENT.
 20948
 20949     IF  CR-GRPTYP NOT NUMERIC
 20950         MOVE '99'               TO INDEXBS
 20951     ELSE
 20952         MOVE CR-GRPTYP          TO INDEXBS.
 20953
 20954     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 20955             AND
 20956         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20957             NOT EQUAL ZEROS
 20958             AND
 20959         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20960             NOT EQUAL +1.0000
 20961         MOVE INDEXBS           TO W-EDIT-7
 20962         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 20963             = W-TARGET-LOSS-RATIO
 20964             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 20965
 20966 4735-EXIT.
 20967     EXIT.
 20968
 20969 4740-CREATE-DETAIL-EXTR.
 20970
 20971     IF DTE-PGM-OPT NOT = '1'
 20972         GO TO 4740-EXIT.
 20973
 20974     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 20975         GO TO 4740-EXIT.
 20976
 20977     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 20978     MOVE ZEROS                  TO REPORTED-DATE
 20979                                    PAY-TO-DATE.
 20980
 20981     MOVE SPACES                 TO TR-DTL2.
 20982     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 20983
 20984     MOVE EOM-YR                 TO TRD-ISYR.
 20985     MOVE EOM-MO                 TO TRD-ISMO.
 20986     MOVE EOM-DA                 TO TRD-ISDA.
 20987     MOVE ZERO                   TO TRD-AGE.
 20988
 20989     IF  EW-LF-AH EQUAL 'L'
 20990         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 20991     ELSE
 20992         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 20993
 20994     MOVE SPACES                 TO TRD-PAYCURX
 20995                                    TRD-PAYCUR-SPACE
 20996                                    TRD-FUTRSV-SPACE
 20997                                    TRD-FUTRSVX.
 20998
 20999     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21000     MOVE 'IBNR'                 TO TRD-IBNRX.
 21001     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21002     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21003
 21004     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 404
* ECS010.cbl
 21005         IF  W-REIN-IN-PROCESS
 21006             MOVE ' ACCT/BEN REIN RSV UW'
 21007                                 TO TRD-RSV-ACTION
 21008         ELSE
 21009             MOVE ' ACCT/BEN RESERVES UW'
 21010                                 TO TRD-RSV-ACTION
 21011     ELSE
 21012         IF  W-REIN-IN-PROCESS
 21013             MOVE ' ACCT/BEN REIN RSV'
 21014                                 TO TRD-RSV-ACTION
 21015         ELSE
 21016             MOVE ' ACCT/BEN RESERVES'
 21017                                 TO TRD-RSV-ACTION.
 21018
 21019     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21020
 21021     MOVE SPACES                 TO DETAIL-EXTRACT.
 21022
 21023     IF  W-REIN-IN-PROCESS
 21024         MOVE EW-REIN-CO         TO DE-REI-COMP
 21025         MOVE 'R'                TO DE-REIN
 21026         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21027         MOVE ZEROS              TO DE-IBNR
 21028     ELSE
 21029         MOVE EW-CLM-IBNR        TO DE-IBNR
 21030         MOVE ZEROS              TO DE-REI-IBNR.
 21031
 21032     MOVE 'DE'                   TO DE-RECORD-ID.
 21033     MOVE 'Y'                    TO DE-TRANS.
 21034     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21035     MOVE '1'                    TO DE-ENTRY-STATUS.
 21036     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21037
 21038     MOVE EOM-RUN-DATE           TO DE-EFF
 21039                                    WS-DE-EFF-N
 21040                                    DE-ENTRY-DTE
 21041                                    WS-DE-ENTRY-DTE-N.
 21042     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21043                                    WS-DE-RSV-INCUR-N.
 21044
 21045     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21046     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21047     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21048                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21049     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21050                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21051
 21052     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21053     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21054     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21055     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21056     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21057*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21058     MOVE AM-IG                  TO DE-IG.
 21059
 21060     IF W-UNDERWRITTEN-DATA
 21061         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21062     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 405
* ECS010.cbl
 21063         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21064
 21065     IF  EW-LF-AH EQUAL 'L'
 21066         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21067         MOVE '1'                TO DE-RESERVE-TYPE
 21068         MOVE ZEROS              TO DE-AH-TYPE
 21069     ELSE
 21070         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21071         MOVE '2'                TO DE-RESERVE-TYPE
 21072         MOVE ZEROS              TO DE-LF-TYPE.
 21073
 21074     MOVE SPACES                 TO DE-NAME
 21075                                    DE-ACC-GPCD
 21076                                    DE-AH-STAT-CDE
 21077                                    DE-LF-STAT-CDE
 21078                                    DE-MEMBER-NO
 21079                                    DE-NAME
 21080                                    DE-SEX.
 21081     MOVE ZEROS                  TO DE-AGE
 21082                                    DE-AH-BEN
 21083                                    DE-AH-CANC-DTE
 21084                                    WS-DE-AH-CANC-DTE-N
 21085                                    DE-AH-CANC-EXIT-DT
 21086                                    WS-DE-AH-CANC-EXIT-DT-N
 21087                                    DE-AH-PRM
 21088                                    DE-AH-RFND
 21089                                    DE-AH-TERM
 21090                                    DE-APR
 21091                                    DE-CANCEL-CNT-ITD
 21092                                    DE-CANCEL-CNT-YTD
 21093                                    DE-FUTRSV
 21094                                    DE-LF-BEN
 21095                                    DE-LF-BEN-ALT
 21096                                    DE-LF-CANC-DTE
 21097                                    WS-DE-LF-CANC-DTE-N
 21098                                    DE-LF-CANC-EXIT-DT
 21099                                    WS-DE-LF-CANC-EXIT-DT-N
 21100                                    DE-LF-CNBEN
 21101                                    DE-LF-CNBEN-ALT
 21102                                    DE-LF-PRM
 21103                                    DE-LF-PRM-ALT
 21104                                    DE-LF-RFND
 21105                                    DE-LF-TERM
 21106                                    DE-LOAN-TERM
 21107                                    DE-LIVES
 21108                                    DE-PAYCUR
 21109                                    DE-PMT-FREQ
 21110                                    DE-REI-AHAMT
 21111                                    DE-REI-AHPRM
 21112                                    DE-REI-AHRFND
 21113                                    DE-REI-CNAMT
 21114                                    DE-REI-FUTRSV
 21115                                    DE-REI-LFAMT
 21116                                    DE-REI-LFPRM
 21117                                    DE-REI-LFRFND
 21118                                    DE-REI-PAYCUR
 21119                                    DE-RSV-REPORTED
 21120                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 406
* ECS010.cbl
 21121                                    WS-DE-RSV-PAYTO-N
 21122                                    DE-MOB-NET-TOT-FEES
 21123                                    DE-SOC-SEC-NO.
 21124
 21125     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21126
 21127     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21128         THRU 2599-WRT-DETAIL-X.
 21129     ADD +1                      TO BC-G-CRS.
 21130
 21131 4740-EXIT.
 21132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 407
* ECS010.cbl
 21134 4750-UPDATE-REIN.
 21135
 21136     COMPUTE SUB3 = SUB2 + 1.
 21137
 21138     IF  W-UNDERWRITTEN-DATA
 21139         MOVE EPEC-SUB-KEY-II (SUB2)
 21140                                 TO W-SUB-KEY
 21141     ELSE
 21142         MOVE EPEC-SUB-KEY (SUB2)
 21143                                 TO W-SUB-KEY.
 21144
 21145     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21146             VARYING
 21147         SUB3 FROM SUB3 BY +1
 21148             UNTIL
 21149         SUB3 GREATER THAN +900
 21150*        SUB3 GREATER THAN +220
 21151*        SUB3 GREATER THAN +300
 21152             OR
 21153         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21154
 21155 4750-EXIT.
 21156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 408
* ECS010.cbl
 21158 4755-MATCH-REIN-EPEC.
 21159
 21160     IF  W-UNDERWRITTEN-DATA
 21161         MOVE EPEC-LEVELS-II (SUB3)
 21162                                 TO EPEC-WORK
 21163     ELSE
 21164         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21165
 21166     IF  EPEC-LINE-NOT-USED (SUB3)
 21167         GO TO 4755-EXIT.
 21168
 21169     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21170             OR
 21171         EW-REIN-CO EQUAL SPACES
 21172         GO TO 4755-EXIT.
 21173
 21174     IF  W-ISS-BEN GREATER THAN ZEROS
 21175         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21176             COMPUTE W-FACTOR ROUNDED
 21177                 = (EW-ISS-BEN
 21178                 - EPEC-REIN-ISS-BEN (SUB3))
 21179                 / W-ISS-BEN
 21180         ELSE
 21181             COMPUTE W-FACTOR ROUNDED
 21182                 = EW-ISS-BEN
 21183                 / W-ISS-BEN.
 21184
 21185     COMPUTE EW-CLM-IBNR ROUNDED
 21186         = EW-CLM-IBNR
 21187         + (W-WK-IBNR * W-FACTOR).
 21188
 21189     IF  W-UNDERWRITTEN-DATA
 21190         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21191     ELSE
 21192         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21193
 21194 4755-EXIT.
 21195     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 409
* ECS010.cbl
 21197 4760-PROCESS-REIN-ONLY.
 21198
 21199     MOVE ZEROS                  TO W-WK-IBNR.
 21200
 21201     IF  EPEC-LINE-NOT-USED (SUB2)
 21202         GO TO 4760-EXIT.
 21203
 21204     IF  EW-LF-AH EQUAL 'L'
 21205         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21206             GO TO 4760-EXIT
 21207         ELSE
 21208             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21209             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21210     ELSE
 21211         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21212             GO TO 4760-EXIT
 21213         ELSE
 21214             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21215             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21216
 21217 4760-EXIT.
 21218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 410
* ECS010.cbl
 21220 4770-CREATE-REIN-DETAIL.
 21221
 21222     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21223     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21224
 21225 4770-EXIT.
 21226     EXIT.
 21227
 21228 4799-EXIT.
 21229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 411
* ECS010.cbl
 21231 4800-CALC-EARNED-PREMIUM-AH.
 21232
 21233     MOVE +0                         TO CNC-BEN  EPR-R78
 21234                                        ISS-PRM  EPR-PRO
 21235                                        CNC-PRM  EPR-ST
 21236                                        WX-CLM-AMT
 21237                                        WX-CLM-EXP
 21238                                        WX-CLM-CNT
 21239                                        WX-CLM-CRT
 21240                                        WX-CNC-CNT
 21241                                        ISS-PRMTAX
 21242                                        WX-ACTIVE-COUNT.
 21243     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21244
 21245     MOVE WE-AHPRM TO ISS-PRM.
 21246
 21247     IF DTE-CLIENT = 'GIC'
 21248         IF REIN-EP-FLG NOT = 'R'  AND
 21249            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21250            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21251            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21252
 21253     IF REIN-EP-FLG = 'R'  AND
 21254        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21255         NEXT SENTENCE
 21256     ELSE
 21257         GO TO 4810-EP-DO-AH-CLM.
 21258
 21259     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21260         IF WE-DSPY-AMT NOT = +0
 21261             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21262             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21263             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21264             ADD +1             TO WX-CLM-CNT.
 21265
 21266     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21267         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21268             GO TO 4830-EP-DO-AH-EP.
 21269
 21270     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21271         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21272             GO TO 4830-EP-DO-AH-EP.
 21273
 21274     GO TO 4815-EP-DO-AH-CLM-EPR.
 21275
 21276 4810-EP-DO-AH-CLM.
 21277
 21278     IF WE-DSPY-AMT NOT = +0
 21279         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21280         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21281         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21282         ADD +1             TO WX-CLM-CNT.
 21283
 21284 4815-EP-DO-AH-CLM-EPR.
 21285
 21286     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21287         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21288
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 412
* ECS010.cbl
 21289 4820-EP-DO-AH-CNCL.
 21290
 21291     IF CR-AH-STATUS-AT-CANCEL = ' '
 21292         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21293            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21294             GO TO 4899-EXIT
 21295         ELSE
 21296             GO TO 4830-EP-DO-AH-EP.
 21297
 21298     IF (DTE-CLIENT = 'DCC')
 21299        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21300        IF CR-AHRFND NOT = ZEROS
 21301           ADD +1                TO WX-CNC-CNT
 21302        END-IF
 21303     ELSE
 21304        ADD +1                   TO WX-CNC-CNT
 21305     END-IF
 21306
 21307     MOVE WE-AHRFND TO CNC-PRM.
 21308
 21309*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21310*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21311*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21312*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21313
 21314     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21315     MOVE 'L'                   TO  DC-OPTION-CODE.
 21316     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21317     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21318
 21319     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21320     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21321     MOVE '1'                     TO  DC-OPTION-CODE.
 21322     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21323     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21324                                      DC-ODD-DAYS-OVER
 21325                                      DC-ELAPSED-DAYS.
 21326     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21327     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21328
 21329     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21330         ADD  +1                  TO  MONTHS-DIFF-AH.
 21331
 21332     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21333                                      WS-DCC-DDF-CB-LEVELS
 21334
 21335     if (dte-client = 'AHL')
 21336        and (cr-ah-cancel-exit-date < 20120401)
 21337        go to 4820-continue-ah-cancel
 21338     end-if
 21339
 21340     IF DTE-CLIENT = 'ACE'
 21341         GO TO 4820-CONTINUE-AH-CANCEL.
 21342
 21343     MOVE  ZEROS                  TO  SUB.
 21344
 21345 4820-AH-CHARGEBACK-LOOP.
 21346
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 413
* ECS010.cbl
 21347     ADD    +1                    TO  SUB.
 21348
 21349     IF  SUB  GREATER THAN  +10
 21350         GO TO  4820-CONTINUE-AH-CANCEL.
 21351
 21352     IF CR-CANCEL-REASON = 'R'
 21353        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21354           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21355              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21356              GO TO  4820-AH-CHARGEBACK-LOOP
 21357           END-IF
 21358           IF AM-COM-TYP (SUB) = 'J'
 21359              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21360              GO TO  4820-AH-CHARGEBACK-LOOP
 21361           END-IF
 21362        END-IF
 21363     END-IF
 21364
 21365     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21366         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21367         GO TO  4820-AH-CHARGEBACK-LOOP.
 21368
 21369     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21370         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21371
 21372     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21373         OR (CR-AHRFND = ZEROS)
 21374         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21375     END-IF
 21376
 21377     GO TO  4820-AH-CHARGEBACK-LOOP.
 21378
 21379
 21380 4820-CONTINUE-AH-CANCEL.
 21381
 21382     IF DTE-CLIENT = 'GIC'
 21383         IF REIN-EP-FLG NOT = 'R'  AND
 21384            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21385            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21386
 21387     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21388     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21389
 21390     IF CR-AH-LUMP-SUM-DISAB
 21391         GO TO 4899-EXIT.
 21392
 21393     MOVE WE-AHAMT TO CNC-BEN.
 21394
 21395     GO TO 4899-EXIT.
 21396
 21397 4825-EP-DO-AH-CNCL-SUM.
 21398
 21399     IF WE-DSPY-AMT NOT = +0
 21400         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21401         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21402         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21403         ADD +1             TO WX-CLM-CNT.
 21404
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 414
* ECS010.cbl
 21405     IF WE-AHRFND = ZERO
 21406        GO TO 4830-EP-DO-AH-EP.
 21407
 21408     MOVE WE-AHRFND TO CNC-PRM.
 21409
 21410     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21411
 21412     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21413                                      WS-DCC-DDF-CB-LEVELS
 21414
 21415     IF WE-AHRFND NOT LESS WE-AHPRM
 21416         MOVE WE-AHAMT TO CNC-BEN
 21417          GO TO 4830-EP-DO-AH-EP.
 21418
 21419     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21420     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21421     MOVE TEMP-7 TO CNC-BEN.
 21422
 21423 4830-EP-DO-AH-EP.
 21424
 21425     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21426     MOVE '8'           TO W-VAL-SOURCE.
 21427
 21428     IF REIN-EP-FLG = 'R'
 21429       IF REIN-REM-SW (SUB5) = 'I'
 21430           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21431           GO TO 4899-EXIT.
 21432
 21433     IF REIN-EP-FLG = 'R'
 21434         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21435            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21436             MOVE '*'               TO A-H-EARNED-SWITCH
 21437             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21438             MOVE '10'              TO W-VAL-SOURCE.
 21439
 21440     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21441
 21442     IF REM-TRM2 GREATER CR-AH-TERM
 21443         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21444         GO TO 4899-EXIT.
 21445
 21446     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21447         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21448*
 21449 4835-CHECK-OB-AH-NCL.
 21450
 21451     IF (DTE-CLIENT EQUAL 'NCL') AND
 21452        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21453           MOVE WE-AHPRM         TO EPR-R78
 21454                                    EPR-PRO
 21455                                    EPR-ST
 21456        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21457           (CR-MO EQUAL EOM-MO)
 21458           MOVE '*'            TO OB-DATE-1-SWITCH
 21459           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21460           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21461           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21462           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 415
* ECS010.cbl
 21463                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21464           GO TO 4899-EXIT
 21465        ELSE
 21466        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21467           (CR-MO EQUAL OB-MO (1))
 21468           MOVE '*'            TO OB-DATE-2-SWITCH
 21469           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21470           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21471           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21472           COMPUTE WS-EPR-R78 (SUB3 2) =
 21473                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21474           GO TO 4899-EXIT
 21475        ELSE
 21476        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21477           (CR-MO EQUAL OB-MO (2))
 21478           MOVE '*'            TO OB-DATE-3-SWITCH
 21479           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21480           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21481           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21482           COMPUTE WS-EPR-R78 (SUB3 3) =
 21483                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21484           GO TO 4899-EXIT
 21485        ELSE
 21486           GO TO 4899-EXIT.
 21487
 21488     IF REM-TRM2 NOT GREATER +0
 21489         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21490         GO TO 4899-EXIT.
 21491
 21492     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21493         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21494         GO TO 4899-EXIT.
 21495
 21496     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21497         MOVE +1 TO WX-ACTIVE-COUNT
 21498     ELSE
 21499         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21500
 21501     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21502     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21503     IF DTE-R78 = '1'
 21504         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21505     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21506
 21507     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21508         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21509     ELSE
 21510         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21511
 21512     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21513     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21514
 21515     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21516     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21517
 21518     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21519
 21520*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 416
* ECS010.cbl
 21521*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21522
 21523     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21524
 21525     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21526        (CR-DT GREATER THAN  19921231)
 21527        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21528         IF CR-AH-TERM GREATER THAN  +61
 21529             MOVE 'A' TO AH-EARN-METHOD
 21530             MOVE '*' TO STATUTORY-SWITCH-AH
 21531             GO TO 4845-EP-DO-AH-EP-AN
 21532         ELSE
 21533             GO TO 4860-EP-DO-AH-STATUTORY.
 21534
 21535     IF (AH-EARN-METHOD EQUAL 'N')
 21536                  OR
 21537        ((DTE-CLIENT = 'DCC')
 21538         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21539         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21540                                    NOT = 'G' AND 'D'))
 21541         GO TO 4840-EP-DO-AH-EP-NP
 21542     END-IF
 21543
 21544     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21545         MOVE 'A' TO AH-EARN-METHOD
 21546         GO TO 4845-EP-DO-AH-EP-AN.
 21547
 21548     GO TO 4860-EP-DO-AH-STATUTORY.
 21549
 21550 4840-EP-DO-AH-EP-NP.
 21551
 21552     IF WE-AHPRM = ZERO
 21553         GO TO 4860-EP-DO-AH-STATUTORY.
 21554
 21555     IF CR-APR GREATER THAN +0
 21556         NEXT SENTENCE
 21557     ELSE
 21558         GO TO 4860-EP-DO-AH-STATUTORY.
 21559
 21560     IF DTE-CLIENT = 'NCL'
 21561       IF CR-DT LESS THAN 19910101
 21562           GO TO 4860-EP-DO-AH-STATUTORY.
 21563
 21564     IF REM-TRM1 = CR-AH-TERM
 21565         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21566         GO TO 4899-EXIT.
 21567
 21568     MOVE CR-APR TO NP-APR.
 21569     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21570     MOVE REM-TRM1 TO NP-REM.
 21571     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21572     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21573         MOVE CR-LOAN-TERM TO NP-ORIG.
 21574
 21575     IF (DTE-CLIENT = 'DCC')
 21576        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21577        MOVE 'S'                 TO NP-OPT
 21578     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 417
* ECS010.cbl
 21579        MOVE 'R'                 TO NP-OPT
 21580     END-IF
 21581
 21582
 21583*    MOVE 'R' TO NP-OPT.
 21584     CALL 'ECSNETRM'
 21585         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21586
 21587     IF (DTE-CLIENT = 'DCC')
 21588        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21589        COMPUTE EPR-ST ROUNDED =
 21590           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21591        GO TO 4899-EXIT
 21592     ELSE
 21593        COMPUTE EPR-R78 ROUNDED =
 21594           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21595     END-IF
 21596
 21597     GO TO 4860-EP-DO-AH-STATUTORY.
 21598
 21599 4845-EP-DO-AH-EP-AN.
 21600     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21601     MOVE 'L'                        TO DC-OPTION-CODE.
 21602     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21603     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21604     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21605     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21606     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21607     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21608     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21609     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21610     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21611     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21612                                        CP-RATING-BENEFIT-AMT.
 21613     IF CP-STATE-STD-ABBRV = 'OR'
 21614         COMPUTE CP-RATING-BENEFIT-AMT =
 21615                                  CR-AHAMT * REM-TRM1.
 21616     MOVE CR-APR                     TO CP-LOAN-APR.
 21617     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21618     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21619     MOVE '3'                        TO CP-PROCESS-TYPE.
 21620     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21621     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21622     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21623         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21624     ELSE
 21625         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21626     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21627     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21628     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21629     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21630     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21631     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21632
 21633     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21634
 21635     IF CP-ERROR-RATE-NOT-FOUND  OR
 21636        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 418
* ECS010.cbl
 21637        CP-ERROR-IN-DATES
 21638         GO TO 4860-EP-DO-AH-STATUTORY.
 21639
 21640     COMPUTE EPR-R78 ROUNDED =
 21641             (REM-TRM1 * WE-AHAMT / +100 *
 21642               CP-PREMIUM-RATE)
 21643              / CR-AHPRM-CALC * CR-AHPRM
 21644
 21645     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21646
 21647     IF STATUTORY-REQUIREMENT-AH
 21648         MOVE EPR-R78                TO EPR-ST
 21649         GO TO 4899-EXIT.
 21650
 21651 4860-EP-DO-AH-STATUTORY.
 21652     IF (DTE-CLIENT EQUAL 'CID') AND
 21653        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21654         GO TO 4867-EP-DO-AH-STAT-ROA
 21655     END-IF.
 21656
 21657 4860-EP-DO-AH-STATUTORY-VA.
 21658
 21659     IF (DTE-CLIENT = 'DCC')
 21660        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21661        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21662        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21663        MOVE EPR-R78             TO EPR-ST
 21664        GO TO 4899-EXIT
 21665     END-IF
 21666
 21667     IF (DTE-CLIENT = 'DCC')
 21668        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21669        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21670        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21671        MOVE +1.0000                TO TEMP-6
 21672        IF REM-TRM1 < +9
 21673           COMPUTE TEMP-6 =
 21674              ((9 - (9 - REM-TRM1)) - 1)
 21675              * +.125
 21676        END-IF
 21677        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21678        MOVE EPR-ST              TO EPR-R78
 21679                                    EPR-PRO
 21680        GO TO 4899-EXIT
 21681     END-IF
 21682
 21683     MOVE EPR-R78                    TO EPR-ST.
 21684
 21685***  WE WANT R78 IN AH STAT FOR AHL
 21686
 21687     IF DTE-CLIENT = 'AHL'
 21688        GO TO 4899-EXIT
 21689     END-IF
 21690
 21691     MOVE +0                         TO SUB1.
 21692
 21693 4865-EP-AH-STAT-LOOP.
 21694     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 419
* ECS010.cbl
 21695
 21696     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21697         MOVE EPR-PRO                TO EPR-ST
 21698     ELSE
 21699         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21700             GO TO 4865-EP-AH-STAT-LOOP.
 21701
 21702     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21703         CR-DT GREATER THAN 19831031)  OR
 21704
 21705        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21706         CR-DT GREATER THAN 19820629)  OR
 21707
 21708        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21709         CR-DT GREATER THAN 19830831)  OR
 21710
 21711        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21712         CR-DT GREATER THAN 20091231)
 21713
 21714         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21715
 21716     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21717       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21718         IF CR-DT LESS THAN 19970101
 21719             MOVE EPR-R78            TO EPR-ST
 21720         ELSE
 21721             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21722
 21723     IF DTE-CLIENT = 'DCC'
 21724        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21725           MOVE EPR-PRO          TO EPR-ST
 21726        ELSE
 21727           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21728        END-IF
 21729     END-IF
 21730
 21731     IF (DTE-CLIENT = 'DCC')
 21732        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21733        CONTINUE
 21734     ELSE
 21735        GO TO 4899-EXIT
 21736     END-IF
 21737
 21738*    MOVE ' '                    TO DD-IU-SW
 21739
 21740     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21741                                    WS-DDF-CSO-ADMIN-FEE
 21742                                    WS-DDF-1ST-YR-TOT-EXP
 21743                                    WS-COMM-AND-MFEE
 21744
 21745     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21746        D1 > +10
 21747        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21748           AND (CR-LCOM-AH (D1) NUMERIC)
 21749           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21750              + (CR-LCOM-AH (D1) * +1000)
 21751        END-IF
 21752        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 420
* ECS010.cbl
 21753           AND (CR-LCOM-AH (D1) NUMERIC)
 21754           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21755              + (CR-LCOM-AH (D1) * +1000)
 21756        END-IF
 21757        IF (CR-AGT-TYPE (D1) = 'I' )
 21758           AND (CR-LCOM-AH (D1) NUMERIC)
 21759           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21760              + (CR-LCOM-AH (D1) * +1000)
 21761        END-IF
 21762        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21763           AND (CR-LCOM-AH (D1) NUMERIC)
 21764           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21765              + (CR-LCOM-AH (D1) * +1000)
 21766        END-IF
 21767     END-PERFORM
 21768
 21769     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21770     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21771
 21772     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21773                                 THRU 4910-EXIT
 21774
 21775     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21776        + WS-DDF-1ST-YR-TOT-EXP
 21777
 21778     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21779        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21780     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21781     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21782
 21783     MOVE 'D'                    TO CP-EARNING-METHOD
 21784     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21785     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21786     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21787     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21788     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21789
 21790     IF REIN-EP-FLG = 'R'
 21791        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21792        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21793        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21794     END-IF
 21795
 21796     IF DD-IU-PRESENT
 21797        MOVE 'I'              TO CP-EARNING-METHOD
 21798     END-IF
 21799
 21800     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21801                                 CP-CLP-RATE-UP
 21802
 21803
 21804     display ' cert no ' cr-cert-no
 21805     display ' rate up ' cp-iu-rate-up
 21806     display ' addl clp ' cr-addl-clp
 21807     display ' ah clp  ' cr-ah-clp
 21808     display ' orig prem ' cp-original-premium
 21809
 21810     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 421
* ECS010.cbl
 21811        AND (CP-IU-RATE-UP NOT = ZEROS)
 21812        COMPUTE CP-IU-RATE-UP =
 21813           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21814           / CP-ORIGINAL-PREMIUM))
 21815     END-IF
 21816
 21817     display ' here 4 '
 21818     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21819     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21820
 21821     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21822        + WS-DDF-1ST-YR-TOT-EXP
 21823
 21824     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21825
 21826     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21827
 21828     IF CP-DDF-SPEC-CALC = 'C'
 21829        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21830     ELSE
 21831        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21832        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21833        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21834        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21835        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21836        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21837     END-IF
 21838
 21839     display ' here 6 '
 21840     GO TO 4899-EXIT
 21841
 21842     .
 21843 4867-EP-DO-AH-STAT-ROA.
 21844     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21845     MOVE 'L'                        TO DC-OPTION-CODE.
 21846     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21847     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21848     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21849     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21850     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21851     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21852     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21853     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21854     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21855     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21856                                        CP-RATING-BENEFIT-AMT.
 21857     IF CP-STATE-STD-ABBRV = 'OR'
 21858         COMPUTE CP-RATING-BENEFIT-AMT =
 21859                                  CR-AHAMT * REM-TRM1.
 21860     MOVE CR-APR                     TO CP-LOAN-APR.
 21861     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21862     MOVE 'A'                        TO CP-EARNING-METHOD.
 21863     MOVE '3'                        TO CP-PROCESS-TYPE.
 21864     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21865     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21866     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21867         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21868     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 422
* ECS010.cbl
 21869         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21870     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21871     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21872     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21873     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21874     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21875     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21876
 21877     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21878
 21879     IF CP-ERROR-RATE-NOT-FOUND  OR
 21880        CP-ERROR-RATE-IS-ZERO  OR
 21881        CP-ERROR-IN-DATES
 21882         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21883
 21884     COMPUTE EPR-ST ROUNDED =
 21885             (REM-TRM1 * WE-AHAMT / +100 *
 21886               CP-PREMIUM-RATE)
 21887              / CR-AHPRM-CALC * CR-AHPRM
 21888
 21889     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21890
 21891     GO TO 4899-EXIT.
 21892
 21893 4899-EXIT.
 21894     EXIT.
 21895******************************************************************
 21896***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21897******************************************************************
 21898
 21899 4900-WRITE-SUMMARY-EXTRACTS.
 21900
 21901     IF DTE-CLIENT = 'HER'
 21902         IF EP-RECORD-ID = 'EC'  AND
 21903            EP-REINCO = 'LNL'
 21904             GO TO 4900-WRT-SUMMARY-X.
 21905
 21906     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 21907                                     WS-EP-RUN-DTE-N.
 21908
 21909     IF W-UNDERWRITTEN-DATA
 21910         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 21911     ELSE
 21912         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 21913
 21914     IF  DTE-OPT-RESERVE-METHOD-AUTH
 21915         IF VALID-EP-ID
 21916             MOVE 'Y'             TO EP-NEW-DATA-IND.
 21917
 21918     WRITE EP-RECORD.
 21919
 21920     ADD +1                       TO EP-CNT.
 21921
 21922 4900-WRT-SUMMARY-X.
 21923     EXIT.
 21924
 21925 4910-DCC-DFF-FACT-LOOKUP.
 21926
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 423
* ECS010.cbl
 21927     IF CR-CERT-NO = WS-FACT-CERT
 21928        go to 4910-exit
 21929     end-if
 21930
 21931     MOVE ' ' TO DD-IU-SW
 21932     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 21933        ((CR-STATE = DD-STATE (D1))
 21934        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 21935        AND ('A'           = DD-BEN-TYPE   (D1))
 21936        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 21937        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 21938                        OR
 21939        D1 > +800
 21940     END-PERFORM
 21941     IF D1 > +800
 21942        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 21943           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 21944        GO TO 4910-EXIT
 21945     END-IF
 21946
 21947     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 21948        (P1 > +8)
 21949        OR (DD-PROD-CODE (D1 P1) = 'I')
 21950     END-PERFORM
 21951     IF P1 < +9
 21952        display ' setting iu present to true '
 21953        SET DD-IU-PRESENT        TO TRUE
 21954     END-IF
 21955
 21956     MOVE CR-AH-TERM             TO WS-DDF-TERM
 21957     IF (CR-LOAN-TERM > WS-DDF-TERM)
 21958        AND (DD-TRUNCATED (D1) = 'Y')
 21959        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 21960        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 21961     END-IF
 21962
 21963     EVALUATE TRUE
 21964        WHEN WS-DDF-TERM > +168
 21965           MOVE 15               TO P1
 21966        WHEN WS-DDF-TERM > +156
 21967           MOVE 14               TO P1
 21968        WHEN WS-DDF-TERM > +144
 21969           MOVE 13               TO P1
 21970        WHEN WS-DDF-TERM > +132
 21971           MOVE 12               TO P1
 21972        WHEN WS-DDF-TERM > +120
 21973           MOVE 11               TO P1
 21974        WHEN WS-DDF-TERM > +108
 21975           MOVE 10               TO P1
 21976        WHEN WS-DDF-TERM > +96
 21977           MOVE 9                TO P1
 21978        WHEN WS-DDF-TERM > +84
 21979           MOVE 8                TO P1
 21980        WHEN WS-DDF-TERM > +72
 21981           MOVE 7                TO P1
 21982        WHEN WS-DDF-TERM > +60
 21983           MOVE 6                TO P1
 21984        WHEN WS-DDF-TERM > +48
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 424
* ECS010.cbl
 21985           MOVE 5                TO P1
 21986        WHEN WS-DDF-TERM > +36
 21987           MOVE 4                TO P1
 21988        WHEN WS-DDF-TERM > +24
 21989           MOVE 3                TO P1
 21990        WHEN WS-DDF-TERM > +12
 21991           MOVE 2                TO P1
 21992        WHEN OTHER
 21993           MOVE 1                TO P1
 21994     END-EVALUATE
 21995
 21996     EVALUATE TRUE
 21997*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 21998*          AND (DD-IU-PRESENT)
 21999*          MOVE 2                TO P2
 22000*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22001*          MOVE 1                TO P2
 22002        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22003           MOVE 2                TO P2
 22004        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22005           MOVE 3                TO P2
 22006        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22007           MOVE 4                TO P2
 22008        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22009           MOVE 5                TO P2
 22010        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22011           MOVE 6                TO P2
 22012        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22013           MOVE 7                TO P2
 22014        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22015           MOVE 8                TO P2
 22016        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22017           MOVE 9                TO P2
 22018        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22019           MOVE 10               TO P2
 22020        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22021           MOVE 11               TO P2
 22022        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22023           MOVE 12               TO P2
 22024        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22025           MOVE 13               TO P2
 22026        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22027           MOVE 14               TO P2
 22028        WHEN OTHER
 22029           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22030           MOVE 15               TO P2
 22031     END-EVALUATE
 22032
 22033     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22034     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22035                                 TO WS-LO-UEF
 22036     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22037                                 TO WS-HI-UEF
 22038
 22039     .
 22040 4910-EXIT.
 22041     EXIT.
 22042
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 425
* ECS010.cbl
 22043******************************************************************
 22044***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22045******************************************************************
 22046
 22047 5000-DATE-RANGE-BREAK.
 22048
 22049     IF NO-TRANSACTION-WAS-PROCESSED
 22050         GO TO 5099-DATE-RANGE-BREAK-X.
 22051
 22052     ADD +1  TO RANGE-CNT.
 22053     MOVE +1 TO SUB6.
 22054     MOVE +2 TO SUB7.
 22055     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22056     IF LN-CNT GREATER +50
 22057         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22058                 8750-PRT-RANGE-HEADING.
 22059
 22060     MOVE SPACES                     TO PRT.
 22061     PERFORM 8800-PRINT-ROUTINE.
 22062     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22063     MOVE '  TOTALS'                 TO TPH3-DESC.
 22064     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22065     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22066     PERFORM 5900-CLEAR-TOTAL-PAGES
 22067         THRU 5999-CLEAR-TOTAL-PAGES-X
 22068             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22069
 22070 5099-DATE-RANGE-BREAK-X.
 22071     EXIT.
 22072
 22073 5100-ACCOUNT-BREAK.
 22074
 22075     IF RANGE-CNT NOT = +0
 22076         PERFORM 5000-DATE-RANGE-BREAK
 22077             THRU 5099-DATE-RANGE-BREAK-X
 22078     ELSE
 22079         MOVE +1 TO SUB6
 22080         MOVE +2 TO SUB7
 22081         PERFORM 5800-ADD-PAGES-LEVELS
 22082             THRU 5899-ADD-PAGES-LEVELS-X
 22083         PERFORM 5900-CLEAR-TOTAL-PAGES
 22084             THRU 5999-CLEAR-TOTAL-PAGES-X
 22085                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22086
 22087     MOVE +0 TO RANGE-CNT.
 22088     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22089         VARYING B-SUB FROM 1 BY 1
 22090             UNTIL B-SUB GREATER THAN 50  OR
 22091                   RB-COMPANY (B-SUB) = SPACES.
 22092     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22093         VARYING B-SUB FROM 1 BY 1
 22094             UNTIL B-SUB GREATER THAN 50.
 22095
 22096     IF ACCT-FLG = SPACE
 22097         GO TO 5199-ACCOUNT-BREAK-X.
 22098
 22099     MOVE SPACE TO ACCT-FLG.
 22100     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 426
* ECS010.cbl
 22101     MOVE +3 TO SUB7.
 22102     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22103     IF LN-CNT GREATER +50
 22104         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22105                 8725-PRT-ACCT-HEADING.
 22106
 22107     MOVE SPACES                     TO PRT.
 22108     PERFORM 8800-PRINT-ROUTINE.
 22109     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22110     MOVE ' TOTALS'                  TO TPH3-DESC.
 22111     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22112     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22113     PERFORM 5900-CLEAR-TOTAL-PAGES
 22114         THRU 5999-CLEAR-TOTAL-PAGES-X
 22115             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22116
 22117 5199-ACCOUNT-BREAK-X.
 22118     EXIT.
 22119
 22120 5200-STATE-BREAK.
 22121
 22122     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22123     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22124     MOVE +3 TO SUB6.
 22125     MOVE +4 TO SUB7.
 22126     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22127
 22128     IF STATE-FLG = SPACE
 22129         GO TO 5299-STATE-BREAK-X.
 22130
 22131     MOVE SPACE         TO STATE-FLG.
 22132     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22133     MOVE 'STATE'       TO TPH1-TYPE.
 22134     MOVE HLD-STATE     TO STATE-L.
 22135
 22136     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22137
 22138     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22139         MOVE SPACES          TO TPH1-DESC
 22140         MOVE HLD-STATE       TO TPH1-ST-CODE
 22141         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22142     ELSE
 22143         MOVE SPACES TO TPH1-DESC
 22144         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22145         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22146
 22147     MOVE 'STATE'  TO TPH2-DESC.
 22148     MOVE 'TOTALS' TO TPH3-DESC.
 22149     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22150     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22151     PERFORM 5900-CLEAR-TOTAL-PAGES
 22152         THRU 5999-CLEAR-TOTAL-PAGES-X
 22153             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22154
 22155 5299-STATE-BREAK-X.
 22156     EXIT.
 22157
 22158 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 427
* ECS010.cbl
 22159
 22160     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22161     MOVE +4 TO SUB6.
 22162     MOVE +5 TO SUB7.
 22163     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22164
 22165     IF COMP-FLG = SPACE
 22166         GO TO 5399-COMP-BREAK-X.
 22167
 22168     MOVE ' ' TO COMP-FLG.
 22169     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22170     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22171     MOVE HLD-GROUPING                TO TPH1-DESC.
 22172     MOVE 'COMPANY'                   TO TPH2-DESC.
 22173     MOVE ' TOTALS'                   TO TPH3-DESC.
 22174     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22175     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22176     PERFORM 5900-CLEAR-TOTAL-PAGES
 22177         THRU 5999-CLEAR-TOTAL-PAGES-X
 22178             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22179
 22180 5399-COMP-BREAK-X.
 22181     EXIT.
 22182
 22183 5400-CARR-BREAK.
 22184
 22185     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22186     MOVE +5 TO SUB6.
 22187     MOVE +6 TO SUB7.
 22188     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22189
 22190     IF CARR-FLG = SPACE
 22191         GO TO 5499-CARR-BREAK-X.
 22192
 22193     MOVE ' ' TO CARR-FLG.
 22194     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22195     MOVE 'CARRIER'               TO TPH1-TYPE.
 22196     MOVE HLD-CARRIER             TO TPH1-DESC.
 22197     MOVE 'CARRIER'               TO TPH2-DESC.
 22198     MOVE ' TOTALS'               TO TPH3-DESC.
 22199     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22200     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22201     PERFORM 5900-CLEAR-TOTAL-PAGES
 22202         THRU 5999-CLEAR-TOTAL-PAGES-X
 22203             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22204
 22205 5499-CARR-BREAK-X.
 22206     EXIT.
 22207
 22208 5500-FINAL-BREAK.
 22209
 22210     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22211
 22212     IF FINAL-FLG = SPACE
 22213         GO TO 5599-FINAL-BREAK-X.
 22214
 22215     IF DTE-FICH = '1'
 22216         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 428
* ECS010.cbl
 22217     MOVE +6 TO SUB6.
 22218     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22219     MOVE SPACES   TO TPH1-TYPE.
 22220     MOVE SPACES   TO TPH1-DESC.
 22221     MOVE 'FINAL'  TO TPH2-DESC.
 22222     MOVE 'TOTALS' TO TPH3-DESC.
 22223     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22224     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22225
 22226 5599-FINAL-BREAK-X.
 22227     EXIT.
 22228
 22229 5800-ADD-PAGES-LEVELS.
 22230
 22231     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22232     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22233     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22234     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22235     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22236     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22237     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22238     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22239
 22240 5899-ADD-PAGES-LEVELS-X.
 22241     EXIT.
 22242
 22243 5900-CLEAR-TOTAL-PAGES.
 22244
 22245     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22246             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22247             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22248             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22249
 22250 5999-CLEAR-TOTAL-PAGES-X.
 22251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 429
* ECS010.cbl
 22253******************************************************************
 22254***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22255******************************************************************
 22256
 22257 6000-TOTAL-PAGE-HEADINGS.
 22258
 22259     MOVE TOTAL-PAGE-HD1 TO PRT.
 22260     PERFORM 8800-PRINT-ROUTINE.
 22261
 22262 6100-ACCT-TOTAL-HEADINGS.
 22263
 22264     MOVE TOTAL-PAGE-HD2 TO PRT.
 22265     MOVE '0' TO P-CTL.
 22266     PERFORM 8800-PRINT-ROUTINE.
 22267     MOVE TOTAL-PAGE-HD3 TO PRT.
 22268     MOVE ' ' TO P-CTL.
 22269     PERFORM 8800-PRINT-ROUTINE.
 22270     PERFORM 8800-PRINT-ROUTINE.
 22271     MOVE +81 TO LN-CNT.
 22272
 22273 6199-PAGE-HEADINGS-X.
 22274     EXIT.
 22275
 22276 6500-PRINT-TOTAL-PAGE.
 22277
 22278     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22279     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22280     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22281
 22282     IF SUB6 = 6 AND ME-DO-UPDATE
 22283         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22284
 22285     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22286
 22287     IF SUB6 = 6 AND ME-DO-UPDATE
 22288         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22289
 22290     COMPUTE TPD-NET-PRM =
 22291         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22292
 22293     IF SUB6 = 6 AND ME-DO-UPDATE
 22294         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22295         GIVING ME-010-NET-L.
 22296
 22297     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22298
 22299     IF SUB6 = 6 AND ME-DO-UPDATE
 22300         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22301
 22302     COMPUTE TPD-PREM-COMP =
 22303         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22304                            - TPL-ACCT-COM (SUB6).
 22305     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22306
 22307     IF SUB6 = 6 AND ME-DO-UPDATE
 22308         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22309
 22310     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 430
* ECS010.cbl
 22311         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22312         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22313         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22314     END-IF.
 22315
 22316     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22317     PERFORM 8800-PRINT-ROUTINE.
 22318     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22319     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22320     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22321     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22322
 22323     IF SUB6 = 6 AND ME-DO-UPDATE
 22324         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22325         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22326
 22327     COMPUTE TPD-NET-PRM =
 22328         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22329
 22330     IF SUB6 = 6 AND ME-DO-UPDATE
 22331         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22332         GIVING ME-010-NET-AH.
 22333
 22334     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22335
 22336     IF SUB6 = 6 AND ME-DO-UPDATE
 22337         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22338
 22339     COMPUTE TPD-PREM-COMP =
 22340         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22341                            - TPA-ACCT-COM (SUB6).
 22342     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22343
 22344     IF SUB6 = 6 AND ME-DO-UPDATE
 22345         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22346
 22347     IF SUB6 = 6
 22348         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22349         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22350         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22351     END-IF.
 22352
 22353     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22354     PERFORM 8800-PRINT-ROUTINE.
 22355
 22356     MOVE 'TOTAL' TO TPD-DESC.
 22357
 22358     COMPUTE TPD-ISS-PRM =
 22359         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22360
 22361     COMPUTE TPD-CNC-PRM =
 22362         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22363
 22364     COMPUTE TPD-NET-PRM =
 22365         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22366         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22367
 22368     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 431
* ECS010.cbl
 22369         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22370
 22371     COMPUTE TPD-PREM-COMP =
 22372         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22373         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22374         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22375
 22376     COMPUTE TPD-CLAIMS =
 22377         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22378
 22379     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22380         NEXT SENTENCE
 22381     ELSE
 22382         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22383         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22384         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22385*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22386*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22387*        MOVE ZEROS               TO SV-LO-CERT
 22388*                                    SV-HI-CERT.
 22389
 22390     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22391     MOVE '0'                     TO P-CTL.
 22392     PERFORM 8800-PRINT-ROUTINE.
 22393     PERFORM 8800-PRINT-ROUTINE.
 22394
 22395 6599-TOTAL-PAGE-PRINT-X.
 22396     EXIT.
 22397*
 22398*
 22399*
 22400**START***********************************************************
 22401*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22402*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22403******************************************************************
 22404*
 22405 6650-GET-RES-STATE-COMM.
 22406*6650-BROWSE-FORWARD.
 22407
 22408     IF DTE-CLIENT NOT = 'DMD'
 22409         GO TO 6700-COMM-EXIT.
 22410
 22411     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22412     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22413     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22414     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22415     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22416     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22417     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22418     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22419
 22420     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22421
 22422*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22423*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22424*VALUE OF PB-CERT-EFF-DT
 22425*
 22426     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 432
* ECS010.cbl
 22427
 22428     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22429
 22430     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22431         GO TO 6700-COMM-EXIT.
 22432
 22433*GET RECORD WHERE POSITIONED
 22434
 22435 6650-READ-ERRESC-NEXT.
 22436     READ ERRESC-IN NEXT RECORD.
 22437
 22438     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22439         GO TO 6700-COMM-EXIT.
 22440
 22441*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22442
 22443     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22444        NEXT SENTENCE
 22445     ELSE
 22446         GO TO 6700-COMM-EXIT.
 22447
 22448     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22449         NEXT SENTENCE
 22450     ELSE
 22451         GO TO 6650-READ-ERRESC-NEXT.
 22452
 22453*  CR-DT  = WS-YYYYMMDD-DT
 22454*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22455*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22456
 22457     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22458         GO TO 6700-COMM-EXIT.
 22459
 22460* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22461
 22462     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22463
 22464     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22465
 22466     IF WS-SUB1 IS GREATER THAN ZERO
 22467         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22468             PERFORM 6680-SET-TABLE-CODE
 22469         ELSE
 22470             PERFORM 6680-SET-COMMISSION.
 22471
 22472     GO TO 6700-COMM-EXIT.
 22473
 22474 6680-SET-TABLE-CODE.
 22475     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22476        MOVE ZEROS             TO WS-SUB1
 22477     ELSE
 22478* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22479* TO COMPUTE AH COMMISSION.
 22480        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22481        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22482        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22483        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22484                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 433
* ECS010.cbl
 22485        PERFORM 6680-READ-CTBL-TABLE
 22486        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22487           MOVE ZEROS          TO WS-SUB1.
 22488
 22489 6680-READ-CTBL-TABLE.
 22490*
 22491* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22492* TO COMPUTE LIFE COMMISSION
 22493
 22494     IF CR-AHTYP = ZERO
 22495        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22496        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22497        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22498
 22499     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22500
 22501     IF ERCTBL-FILE-STATUS EQUAL '00'
 22502* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22503        IF CR-AHTYP NOT = ZERO
 22504             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22505             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22506             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22507             MOVE WK-RATE           TO WS-COMMISSION
 22508                                       PB-I-AH-COMMISSION
 22509        ELSE
 22510* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22511             MOVE CR-LFAMT    TO COMM-CK-AMT
 22512             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22513             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22514             MOVE WK-RATE     TO WS-COMMISSION
 22515                                 PB-I-LIFE-COMMISSION.
 22516
 22517 6680-SET-COMMISSION.
 22518     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22519           MOVE ZEROS         TO WS-SUB1
 22520       ELSE
 22521           MOVE RESC-COMMISSION-PER (WS-SUB)
 22522                              TO WS-COMMISSION WK-RATE
 22523           IF CR-AHTYP NOT = ZERO
 22524                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22525           ELSE
 22526                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22527
 22528 6680-SEARCH-CATEGORY.
 22529     ADD +1 TO WS-SUB.
 22530
 22531     IF WS-SUB IS GREATER THAN +12
 22532         GO TO 6680-EXIT.
 22533
 22534     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22535          MOVE WS-SUB         TO WS-SUB1
 22536          GO TO 6680-EXIT.
 22537
 22538     GO TO 6680-SEARCH-CATEGORY.
 22539
 22540 6680-EXIT.
 22541     EXIT.
 22542
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 434
* ECS010.cbl
 22543 6700-COMM-EXIT.
 22544     EXIT.
 22545*
 22546*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22547
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 435
* ECS010.cbl
 22549******************************************************************
 22550***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22551******************************************************************
 22552
 22553 7000-CLIENT-BILLING-ROUTINE.
 22554*
 22555*
 22556* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22557
 22558     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22559                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22560                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22561                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22562                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22563                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22564                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22565
 22566 7099-BILL-X.
 22567     EXIT.
 22568
 22569
 22570 7500-ADD-UP-REIN-CO.
 22571
 22572     IF RB-COMPANY (B-SUB) NOT = SPACES
 22573         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22574
 22575 7599-ADD-UP-REIN-X.
 22576     EXIT.
 22577
 22578 7900-CLEAR-BILLING-TABLE.
 22579
 22580     MOVE SPACES TO RB-COMPANY (B-SUB).
 22581     MOVE 0      TO RB-COUNT (B-SUB).
 22582
 22583 7999-CLEAR-BILLING-X.
 22584     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 436
* ECS010.cbl
 22586******************************************************************
 22587***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22588******************************************************************
 22589
 22590 8000-DATE-CONVERT-ROUTINE.
 22591
 22592     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22593
 22594 8099-DATE-CONVERT-X.
 22595     EXIT.
 22596
 22597 8000R-CONVERT-STOP-DATE.
 22598
 22599     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22600     MOVE 'L'                     TO DC-OPTION-CODE.
 22601     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22602     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22603     MOVE -1                      TO DC-ELAPSED-DAYS.
 22604     MOVE '6'                     TO DC-OPTION-CODE.
 22605     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22606     MOVE +0                      TO DC-ELAPSED-MONTHS
 22607                                     DC-ELAPSED-DAYS.
 22608     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22609     MOVE ' '                     TO DC-OPTION-CODE.
 22610     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22611
 22612     IF NO-CONVERSION-ERROR
 22613         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22614     ELSE
 22615         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22616                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22617                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22618         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22619                                  TO WS-ABEND-MESSAGE
 22620         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22621         MOVE 4002                TO WS-ABEND-CODE
 22622         GO TO ABEND-PGM.
 22623
 22624 8099R-STOP-DATE-X.
 22625     EXIT.
 22626
 22627
 22628 8100-GET-RATE.
 22629
 22630     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22631
 22632 8199-GET-RATE-X.
 22633     EXIT.
 22634
 22635
 22636 8200-STATE-CODE-LOOKUP.
 22637
 22638     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22639        CLAS-INDEXS NOT = ZERO
 22640         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22641             GO TO 8299-STATE-LOOKUP-X.
 22642
 22643     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 437
* ECS010.cbl
 22644
 22645 8250-STATE-LOOKUP-LOOP.
 22646
 22647     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22648         MOVE 0302 TO WS-ABEND-CODE
 22649         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22650         DISPLAY '******************************'
 22651         DISPLAY '***** ERROR LOCATION 022 *****'
 22652         DISPLAY '******************************'
 22653         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22654         GO TO ABEND-PGM.
 22655
 22656     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22657         ADD +1 TO CLAS-INDEXS
 22658         GO TO 8250-STATE-LOOKUP-LOOP.
 22659
 22660 8299-STATE-LOOKUP-X.
 22661     EXIT.
 22662
 22663
 22664 8300-LIFE-TYPE-LOOKUP.
 22665
 22666     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22667        CLAS-INDEXL NOT = ZERO
 22668         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22669             GO TO 8399-LIFE-LOOKUP-X.
 22670
 22671     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22672
 22673 8350-LIFE-LOOKUP-LOOP.
 22674
 22675     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22676         MOVE 0401 TO WS-ABEND-CODE
 22677         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22678         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22679         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22680         DISPLAY '******************************'
 22681         DISPLAY '***** ERROR LOCATION 023 *****'
 22682         DISPLAY '******************************'
 22683         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22684         IF DTE-CLIENT = 'NCL'
 22685                      OR 'CID' OR 'AHL'
 22686             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22687             MOVE '05'             TO CLAS-LOOK
 22688             GO TO 8350-LIFE-LOOKUP-LOOP
 22689         ELSE
 22690             GO TO ABEND-PGM.
 22691
 22692     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22693         ADD +1 TO CLAS-INDEXL
 22694         GO TO 8350-LIFE-LOOKUP-LOOP.
 22695
 22696     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22697         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22698
 22699 8399-LIFE-LOOKUP-X.
 22700     EXIT.
 22701
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 438
* ECS010.cbl
 22702
 22703 8400-A-H-TYPE-LOOKUP.
 22704
 22705     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22706        CLAS-INDEXA NOT = ZERO
 22707         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22708             GO TO 8499-A-H-LOOKUP-X.
 22709
 22710     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22711
 22712 8450-A-H-LOOKUP-LOOP.
 22713
 22714     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22715         MOVE 0402 TO WS-ABEND-CODE
 22716         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22717         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22718         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22719         DISPLAY '******************************'
 22720         DISPLAY '***** ERROR LOCATION 024 *****'
 22721         DISPLAY '******************************'
 22722         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22723         IF DTE-CLIENT = 'NCL'
 22724             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22725             MOVE '05'             TO CLAS-LOOK
 22726             GO TO 8450-A-H-LOOKUP-LOOP
 22727         ELSE
 22728             GO TO ABEND-PGM.
 22729
 22730     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22731         ADD +1 TO CLAS-INDEXA
 22732         GO TO 8450-A-H-LOOKUP-LOOP.
 22733
 22734 8499-A-H-LOOKUP-X.
 22735     EXIT.
 22736
 22737 8500-REMAINING-TERM-ROUTINE.
 22738
 22739     MOVE ZEROS                      TO CP-REMAINING-TERM
 22740                                        CP-REMAINING-TERM-1
 22741                                        CP-REMAINING-TERM-2
 22742                                        CP-REMAINING-TERM-3
 22743                                        CP-RETURN-CODE
 22744                                        CP-RETURN-CODE-2
 22745                                        REM-TRM1
 22746                                        REM-TRM2
 22747                                        REM-TRM3
 22748                                        TEM-TRM1.
 22749     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22750
 22751     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22752     MOVE 'L'                        TO DC-OPTION-CODE.
 22753     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22754
 22755     IF  NO-CONVERSION-ERROR
 22756         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22757     ELSE
 22758         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22759                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 439
* ECS010.cbl
 22760         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22761         MOVE 3001                   TO WS-ABEND-CODE
 22762         GO TO ABEND-PGM.
 22763
 22764     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22765
 22766     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22767         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22768
 22769     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22770         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22771         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22772                                        DC-ELAPSED-DAYS
 22773         MOVE '3'                    TO DC-OPTION-CODE
 22774         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22775                 8099-DATE-CONVERT-X
 22776         IF  NO-CONVERSION-ERROR
 22777             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22778         ELSE
 22779             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22780
 22781     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22782         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22783
 22784     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22785         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22786         MOVE +1                     TO DC-ELAPSED-MONTHS
 22787         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22788         MOVE '6'                    TO DC-OPTION-CODE
 22789         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22790                 8099-DATE-CONVERT-X
 22791         IF  NO-CONVERSION-ERROR
 22792             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22793             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22794         ELSE
 22795             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22796                                     TO WS-ABEND-MESSAGE
 22797             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22798             MOVE 3002               TO WS-ABEND-CODE
 22799             GO TO ABEND-PGM.
 22800
 22801     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22802     MOVE 'L'                        TO DC-OPTION-CODE.
 22803     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22804
 22805     IF  NO-CONVERSION-ERROR
 22806         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22807     ELSE
 22808         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22809             W-VAL-ERROR (W-VAL-SOURCE)
 22810         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22811             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22812             DC-ERROR-CODE
 22813         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22814         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22815             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22816             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22817             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 440
* ECS010.cbl
 22818*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22819*                                    TO WS-ABEND-MESSAGE
 22820*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22821*        MOVE 3003                   TO WS-ABEND-CODE
 22822*        GO TO ABEND-PGM.
 22823
 22824     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22825     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22826     MOVE '3'                        TO CP-PROCESS-TYPE.
 22827     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22828     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22829     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22830
 22831*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22832*                                    TO CP-REM-TERM-METHOD.
 22833
 22834     IF  DTE-CLIENT = 'FIM'
 22835         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22836
 22837     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22838         IF WE-LF-AH = AH-OVERRIDE-L1
 22839             MOVE '2'                TO CP-REM-TERM-METHOD
 22840         ELSE
 22841             IF CR-LFTYP = '01' OR '03'
 22842                 MOVE '4'            TO CP-REM-TERM-METHOD
 22843             ELSE
 22844                 IF CR-LFTYP = '02' OR '04'
 22845                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22846
 22847     IF  DTE-CLIENT = 'CSL'
 22848         IF  CR-CARRIER = '2'
 22849             IF  CR-LFTYP = '07' OR  '08'
 22850                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22851
 22852     IF  DTE-CLIENT = 'POS'
 22853         IF  CR-CARRIER = '1'
 22854             MOVE '1'                TO CP-REM-TERM-METHOD
 22855         ELSE
 22856             MOVE '2'                TO CP-REM-TERM-METHOD.
 22857
 22858     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22859         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22860
 22861     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22862         GO TO 8540-CALC-REM-TERM-AH.
 22863
 22864 8520-CALC-REM-TERM-LIFE.
 22865
 22866     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22867     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22868     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22869*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22870     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22871                                        CP-LOAN-TERM.
 22872
 22873     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22874             AND
 22875         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 441
* ECS010.cbl
 22876         ADD +1                      TO CP-ORIGINAL-TERM
 22877                                        CP-LOAN-TERM.
 22878
 22879     IF  CP-TERM-IS-DAYS
 22880         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22881     ELSE
 22882         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22883
 22884     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22885
 22886     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22887         ADD +1                      TO W-ORGTRM-0-LF
 22888         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22889             CR-FULL-CONTROL
 22890         GO TO 8599-REM-TERM-X.
 22891
 22892     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22893
 22894     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22895         ADD +1                      TO W-RET-CODE-LF
 22896         GO TO 8599-REM-TERM-X.
 22897*
 22898*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22899*                                    TO WS-ABEND-MESSAGE
 22900*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22901*        MOVE 2002                   TO WS-ABEND-CODE
 22902*        GO TO ABEND-PGM.
 22903
 22904     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22905             AND
 22906         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 22907         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 22908         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 22909         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 22910
 22911     IF  CP-REMAINING-TERM-1 NEGATIVE
 22912         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 22913
 22914     IF  CP-REMAINING-TERM-2 NEGATIVE
 22915         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 22916
 22917     IF DTE-CLIENT = 'NCL'
 22918         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22919                                        CP-REMAINING-TERM-3.
 22920
 22921     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22922     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22923     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22924     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22925
 22926     GO TO 8599-REM-TERM-X.
 22927
 22928 8520-EXIT.
 22929     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 442
* ECS010.cbl
 22931 8540-CALC-REM-TERM-AH.
 22932
 22933     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 22934     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 22935     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 22936     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 22937                                        CP-LOAN-TERM.
 22938     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 22939
 22940     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22941
 22942     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22943         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 22944             CR-FULL-CONTROL
 22945         ADD +1                      TO W-ORGTRM-0-AH
 22946         GO TO 8599-REM-TERM-X.
 22947
 22948     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22949
 22950     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22951         ADD +1                      TO W-RET-CODE-AH
 22952         GO TO 8599-REM-TERM-X.
 22953*
 22954*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 22955*                                    TO WS-ABEND-MESSAGE
 22956*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22957*        MOVE 2001                   TO WS-ABEND-CODE
 22958*        GO TO ABEND-PGM.
 22959
 22960     IF DTE-CLIENT = 'NCL'
 22961         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22962                                        CP-REMAINING-TERM-3.
 22963
 22964     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22965     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22966     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22967     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22968
 22969 8599-REM-TERM-X.
 22970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 443
* ECS010.cbl
 22972
 22973******************************************************************
 22974***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 22975******************************************************************
 22976
 22977 8600-DISPLAY-PRT.
 22978
 22979     IF  DIS-LINE-CNT GREATER THAN 59
 22980         PERFORM 8600-DISPLAY-HD THRU
 22981             8600-HD-EXIT.
 22982
 22983     ADD  1  TO DIS-LINE-CNT.
 22984     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 22985     MOVE  SPACES TO DISPLAY-REC
 22986                     DISPLAY-LINE.
 22987
 22988 8600-DISPLAY-EXIT.
 22989     EXIT.
 22990
 22991
 22992 8600-DISPLAY-HD.
 22993
 22994     MOVE '1'  TO  DISPLAY-CC.
 22995     MOVE ZEROS TO DIS-LINE-CNT.
 22996     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 22997     ADD +1 TO DIS-LINE-CNT.
 22998     MOVE ' '  TO  DISPLAY-CC.
 22999     MOVE SPACES TO DISPLAY-REC.
 23000     WRITE DISPLAY-REC.
 23001     ADD +1 TO DIS-LINE-CNT.
 23002     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23003     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23004     ADD +1 TO DIS-LINE-CNT.
 23005     MOVE SPACES TO DISPLAY-REC.
 23006     ADD +1 TO DIS-LINE-CNT.
 23007     WRITE DISPLAY-REC.
 23008
 23009 8600-HD-EXIT.
 23010     EXIT.
 23011
 23012******************************************************************
 23013***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23014******************************************************************
 23015
 23016 8600-SETUP-DETAIL-LINE.
 23017
 23018     MOVE SPACES                TO TR-DTL2.
 23019
 23020     MOVE CR-CERT-NO            TO TRD-CERT.
 23021     MOVE CR-YR                 TO TRD-ISYR.
 23022     MOVE CR-MO                 TO TRD-ISMO.
 23023     MOVE CR-DA                 TO TRD-ISDA.
 23024     MOVE CR-AGE                TO TRD-AGE.
 23025
 23026 8689-SETUP-DETAIL-X.
 23027     EXIT.
 23028
 23029 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 444
* ECS010.cbl
 23030
 23031     IF LN-CNT GREATER THAN LN-MX
 23032         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23033                 8799-PRT-HEADINGS-X.
 23034     MOVE TRD-CERT TO SV-TRD-CERT.
 23035     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23036
 23037     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23038         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23039
 23040     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23041     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23042     MOVE TR-DTL TO PRT.
 23043
 23044     IF NOT WS-CHANGE-REC
 23045         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23046     ELSE
 23047         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23048
 23049     PERFORM 8800-PRINT-ROUTINE.
 23050
 23051 8699-PRT-DETAIL-X.
 23052     EXIT.
 23053
 23054 8700-PRINT-REPORT-HEADINGS.
 23055     ADD +1 TO PG-CNT.
 23056     MOVE PG-CNT TO TR-PG.
 23057     MOVE +0 TO LN-CNT.
 23058     MOVE TR-HD-1 TO PRT.
 23059     PERFORM 8800-PRINT-ROUTINE.
 23060     MOVE TR-HD-2 TO PRT.
 23061     PERFORM 8800-PRINT-ROUTINE.
 23062     MOVE TR-HD-3 TO PRT.
 23063     PERFORM 8800-PRINT-ROUTINE.
 23064     ADD +1 TO LN-CNT.
 23065
 23066 8725-PRT-ACCT-HEADING.
 23067     MOVE TR-HD-4 TO PRT.
 23068     PERFORM 8800-PRINT-ROUTINE.
 23069     MOVE TR-HD-5 TO PRT.
 23070     PERFORM 8800-PRINT-ROUTINE.
 23071
 23072 8750-PRT-RANGE-HEADING.
 23073     MOVE TR-HD-6 TO PRT.
 23074     PERFORM 8800-PRINT-ROUTINE.
 23075
 23076 8775-PRT-COLUMN-HEADINGS.
 23077     MOVE TR-HD-7 TO PRT.
 23078     PERFORM 8800-PRINT-ROUTINE.
 23079     MOVE TR-HD-8 TO PRT.
 23080     PERFORM 8800-PRINT-ROUTINE.
 23081     MOVE TR-HD-9 TO PRT.
 23082     PERFORM 8800-PRINT-ROUTINE.
 23083     PERFORM 8800-PRINT-ROUTINE.
 23084
 23085 8799-PRT-HEADINGS-X.
 23086     EXIT.
 23087
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 445
* ECS010.cbl
 23088 8800-PRINT-ROUTINE.
 23089     MOVE P-CTL TO X.
 23090     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23091     ADD +1 TO LN-CNT.
 23092     MOVE SPACES TO PRT.
 23093
 23094 8900-PRINT-A-LINE.
*23095                             COPY ELCPRT2.
 23096******************************************************************04/15/98
 23097*                                                                *ELCPRT2
 23098*                                                                *ELCPRT2
 23099*                            ELCPRT2                             *   LV005
 23100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23101*                            VMOD=2.002                          *   CL**5
 23102*                                                                *   CL**4
 23103******************************************************************   CL**4
 23104                                                                     CL**4
 23105     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23106        FICH-OPEN    = SPACE                                         CL**4
 23107         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23108         OPEN OUTPUT FICH.                                           CL**4
 23109                                                                     CL**4
 23110     IF DTE-FICH NOT = SPACE                                         CL**4
 23111         MOVE X                  TO  P-CTL                           CL**4
 23112         WRITE FICH-REC FROM PRT.                                    CL**4
 23113                                                                     CL**4
 23114     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23115       MOVE X                    TO  P-CTL                           CL**4
 23116       IF P-CTL = ' '                                                CL**4
 23117         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23118       ELSE                                                          CL**4
 23119         IF P-CTL = '0'                                              CL**4
 23120           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23121         ELSE                                                        CL**4
 23122           IF P-CTL = '-'                                            CL**4
 23123             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23124           ELSE                                                      CL**4
 23125             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23126                                                                     CL**4
 23127******************************************************************   CL**4
 23128
 23129 8999-PRT-LINE-X.
 23130     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 446
* ECS010.cbl
 23132******************************************************************
 23133***          E N D   O F   J O B   P R O C E S S I N G         ***
 23134******************************************************************
 23135
 23136 9910-EOJ-1.
 23137     IF TR-CNT = ZERO
 23138         IF (DTE-PGM-OPT = '2' OR '3') OR
 23139            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23140                          'ITY' OR 'DAC' OR 'FLC')
 23141             NEXT SENTENCE
 23142         ELSE
 23143             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23144             MOVE 0703                    TO WS-ABEND-CODE
 23145             DISPLAY '******************************'
 23146             DISPLAY '***** ERROR LOCATION 025 *****'
 23147             DISPLAY '******************************'
 23148             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23149             GO TO ABEND-PGM.
 23150
 23151     MOVE '*'         TO TRANS-EOF-FLAG.
 23152     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23153
 23154     IF EOF-ON-CERT
 23155         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23156         GO TO 9940-EOJ-FIN.
 23157
 23158     GO TO 0330-MATCH-PENDING-TO-CERT.
 23159
 23160 9920-EOJ-2.
 23161     MOVE '*'         TO CERT-EOF-FLAG.
 23162     MOVE HIGH-VALUES TO CIR-CONTROL.
 23163
 23164     IF EOF-ON-TRANS
 23165         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23166         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23167         GO TO 9940-EOJ-FIN.
 23168
 23169     GO TO 0299-READ-CERT-X.
 23170
 23171 9930-EOJ-3.
 23172     IF PROCESSING-COMPLETED
 23173         GO TO 9950-EOJ-FIN-GO.
 23174
 23175     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23176     MOVE 'MISSING ACCOUNT MASTER'
 23177                               TO WS-ABEND-MESSAGE.
 23178     MOVE 0302                 TO WS-ABEND-CODE.
 23179     DISPLAY '******************************'
 23180     DISPLAY '***** ERROR LOCATION 026 *****'
 23181     DISPLAY '******************************'
 23182     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23183     GO TO ABEND-PGM.
 23184
 23185 9940-EOJ-FIN.
 23186     MOVE '*'        TO PROCESSING-FLAG.
 23187     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23188
 23189     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 447
* ECS010.cbl
 23190             0199-READ-ACCOUNT-X.
 23191     GO TO 9940-EOJ-FIN.
 23192
 23193 9950-EOJ-FIN-GO.
 23194     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23195     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23196*
 23197*
 23198* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23199     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23200
 23201 9960-NO-TOTS.
 23202
 23203     MOVE +15                    TO LN-CNT.
 23204     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23205     IF ME-DO-UPDATE
 23206         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23207
 23208     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23209     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23210     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23211
 23212
 23213     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23214     MOVE TR-TTL-HD              TO PRT.
 23215     PERFORM 8800-PRINT-ROUTINE.
 23216     ADD +1 TO LN-CNT.
 23217     MOVE TR-CNT                TO TTL-PT-CNT.
 23218     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23219     MOVE TR-TTL-HD             TO PRT.
 23220     PERFORM 8800-PRINT-ROUTINE.
 23221     ADD +1 TO LN-CNT.
 23222
 23223     IF DUP-CNT = ZERO
 23224         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23225
 23226     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23227
 23228     IF ME-DO-UPDATE
 23229         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23230
 23231     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23232     MOVE TR-TTL-HD               TO PRT.
 23233     PERFORM 8800-PRINT-ROUTINE.
 23234     PERFORM 8800-PRINT-ROUTINE.
 23235     ADD +1 TO LN-CNT.
 23236
 23237     MOVE '1'                           TO  DTL-REC-TYPE.
 23238     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23239     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23240     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23241                                        TO  DTL-CERT-OUT-CONTROL.
 23242     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23243     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23244     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23245
 23246     MOVE +1 TO SUB3.
 23247 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 448
* ECS010.cbl
 23248
 23249     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23250         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23251         MOVE MISMATCH-PAGE-NUMBER
 23252                                 TO  TR-PG
 23253         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23254         MOVE MR-CTL             TO  X
 23255         MOVE X TO LCP-ASA
 23256         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23257             THRU LCP-WRITE-END-MISMATCH-RPT
 23258         MOVE TR-HD-2            TO  MISMATCH-RPT
 23259         MOVE MR-CTL             TO  X
 23260         MOVE X TO LCP-ASA
 23261         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23262             THRU LCP-WRITE-END-MISMATCH-RPT
 23263         MOVE TR-HD-3            TO  MISMATCH-RPT
 23264         MOVE MR-CTL             TO  X
 23265         MOVE X TO LCP-ASA
 23266         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23267             THRU LCP-WRITE-END-MISMATCH-RPT
 23268         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23269         MOVE MR-CTL             TO  X
 23270         MOVE X TO LCP-ASA
 23271         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23272             THRU LCP-WRITE-END-MISMATCH-RPT
 23273         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23274
 23275     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23276
 23277     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23278     MOVE MR-CTL                        TO  X.
 23279     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23280
 23281     MOVE X TO LCP-ASA
 23282     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23283         THRU LCP-WRITE-END-MISMATCH-RPT.
 23284
 23285     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23286     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23287
 23288     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23289     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23290
 23291     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23292     IF  DUPE-STATUS (SUB3)  =  '2'
 23293         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23294     IF  DUPE-STATUS (SUB3)  =  '5'
 23295         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23296     IF  DUPE-STATUS (SUB3)  =  'M'
 23297         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23298     IF  DUPE-STATUS (SUB3)  =  '9'
 23299         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23300     IF  DUPE-STATUS (SUB3)  =  'D'
 23301         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23302     IF  DUPE-STATUS (SUB3)  =  'V'
 23303         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23304     IF  DUPE-STATUS (SUB3)  =  'P'
 23305         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 449
* ECS010.cbl
 23306
 23307     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23308     MOVE MR-CTL                        TO  X.
 23309     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23310
 23311     MOVE X TO LCP-ASA
 23312     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23313         THRU LCP-WRITE-END-MISMATCH-RPT.
 23314
 23315     IF SUB3 LESS THAN DUP-CNT
 23316         ADD +1 TO SUB3
 23317         GO TO 9965-PRT-DUPES.
 23318
 23319 9969-CHECK-MISMATCHED-TOTS.
 23320
 23321     IF W-MM-LF-PRM = ZEROS  AND
 23322        W-MM-AH-PRM = ZEROS  AND
 23323        W-MM-LF-RFD = ZEROS  AND
 23324        W-MM-AH-RFD = ZEROS  AND
 23325        W-MM-LF-CLM = ZEROS  AND
 23326        W-MM-AH-CLM = ZEROS
 23327         GO TO 9970-FIN-TOTS.
 23328
 23329     MOVE SPACES                        TO  MISMATCH-RPT.
 23330     MOVE '0'                           TO  MR-CTL  X.
 23331     MOVE X TO LCP-ASA
 23332     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23333         THRU LCP-WRITE-END-MISMATCH-RPT.
 23334
 23335     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23336     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23337     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23338
 23339     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23340     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23341     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23342
 23343     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23344     MOVE '0'                           TO  MR-CTL  X.
 23345     MOVE X TO LCP-ASA
 23346     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23347         THRU LCP-WRITE-END-MISMATCH-RPT.
 23348
 23349     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23350     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23351     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23352
 23353     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23354     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23355     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23356
 23357     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23358     MOVE '0'                           TO  MR-CTL  X.
 23359     MOVE X TO LCP-ASA
 23360     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23361         THRU LCP-WRITE-END-MISMATCH-RPT.
 23362
 23363     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 450
* ECS010.cbl
 23364     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23365     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23366
 23367     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23368     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23369     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23370
 23371     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23372     MOVE '0'                           TO  MR-CTL  X.
 23373     MOVE X TO LCP-ASA
 23374     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23375         THRU LCP-WRITE-END-MISMATCH-RPT.
 23376
 23377 9970-FIN-TOTS.
 23378
 23379     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23380
 23381     IF ME-DO-UPDATE
 23382         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23383
 23384     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23385     MOVE TR-TTL-HD               TO PRT.
 23386     PERFORM 8800-PRINT-ROUTINE.
 23387
 23388     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23389     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23390     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23391     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23392
 23393     MOVE DE-CNT                  TO TTL-PT-CNT.
 23394     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23395     MOVE TR-TTL-HD               TO PRT.
 23396     PERFORM 8800-PRINT-ROUTINE.
 23397
 23398     MOVE EP-CNT                  TO TTL-PT-CNT.
 23399     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23400     MOVE TR-TTL-HD               TO PRT.
 23401     PERFORM 8800-PRINT-ROUTINE.
 23402     PERFORM 8800-PRINT-ROUTINE.
 23403
 23404     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23405     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23406     MOVE TR-TTL-HD               TO PRT.
 23407     PERFORM 8800-PRINT-ROUTINE.
 23408
 23409     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23410     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23411     MOVE TR-TTL-HD               TO PRT.
 23412     PERFORM 8800-PRINT-ROUTINE.
 23413
 23414     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23415     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23416     MOVE TR-TTL-HD               TO PRT.
 23417     PERFORM 8800-PRINT-ROUTINE.
 23418
 23419     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23420         GO TO 9990-FINAL-CLOSE.
 23421
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 451
* ECS010.cbl
 23422**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23423**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23424**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23425**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23426
 23427     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23428     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23429     MOVE TR-TTL-HD               TO PRT.
 23430     PERFORM 8800-PRINT-ROUTINE.
 23431
 23432     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23433     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23434     MOVE TR-TTL-HD               TO PRT.
 23435     PERFORM 8800-PRINT-ROUTINE.
 23436
 23437     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23438     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23439     MOVE TR-TTL-HD               TO PRT.
 23440     PERFORM 8800-PRINT-ROUTINE.
 23441
 23442     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23443     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23444     MOVE TR-TTL-HD               TO PRT.
 23445     PERFORM 8800-PRINT-ROUTINE.
 23446
 23447     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23448     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23449     MOVE TR-TTL-HD               TO PRT.
 23450     PERFORM 8800-PRINT-ROUTINE.
 23451
 23452     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23453     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23454     MOVE TR-TTL-HD               TO PRT.
 23455     PERFORM 8800-PRINT-ROUTINE.
 23456
 23457     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23458     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23459     MOVE TR-TTL-HD               TO PRT.
 23460     PERFORM 8800-PRINT-ROUTINE.
 23461
 23462     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23463     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23464     MOVE TR-TTL-HD               TO PRT.
 23465     PERFORM 8800-PRINT-ROUTINE.
 23466
 23467     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23468     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23469     MOVE TR-TTL-HD               TO PRT.
 23470     PERFORM 8800-PRINT-ROUTINE.
 23471
 23472     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23473     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23474     MOVE TR-TTL-HD               TO PRT.
 23475     PERFORM 8800-PRINT-ROUTINE.
 23476
 23477     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23478     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23479     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 452
* ECS010.cbl
 23480     PERFORM 8800-PRINT-ROUTINE.
 23481
 23482     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23483     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23484     MOVE TR-TTL-HD               TO PRT.
 23485     PERFORM 8800-PRINT-ROUTINE.
 23486
 23487     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23488     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23489     MOVE TR-TTL-HD               TO PRT.
 23490     PERFORM 8800-PRINT-ROUTINE.
 23491
 23492     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23493     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23494     MOVE TR-TTL-HD               TO PRT.
 23495     PERFORM 8800-PRINT-ROUTINE.
 23496
 23497     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23498     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23499     MOVE TR-TTL-HD               TO PRT.
 23500     PERFORM 8800-PRINT-ROUTINE.
 23501
 23502     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23503     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23504     MOVE TR-TTL-HD               TO PRT.
 23505     PERFORM 8800-PRINT-ROUTINE.
 23506
 23507     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23508     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23509     MOVE TR-TTL-HD               TO PRT.
 23510     PERFORM 8800-PRINT-ROUTINE.
 23511
 23512     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23513     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23514     MOVE TR-TTL-HD               TO PRT.
 23515     PERFORM 8800-PRINT-ROUTINE.
 23516
 23517     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23518     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23519     MOVE TR-TTL-HD               TO PRT.
 23520     PERFORM 8800-PRINT-ROUTINE.
 23521
 23522     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23523     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23524     MOVE TR-TTL-HD               TO PRT.
 23525     PERFORM 8800-PRINT-ROUTINE.
 23526
 23527     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23528     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23529     MOVE TR-TTL-HD               TO PRT.
 23530     PERFORM 8800-PRINT-ROUTINE.
 23531
 23532     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23533     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23534     MOVE TR-TTL-HD               TO PRT.
 23535     PERFORM 8800-PRINT-ROUTINE.
 23536
 23537     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 453
* ECS010.cbl
 23538     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23539     MOVE TR-TTL-HD               TO PRT.
 23540     PERFORM 8800-PRINT-ROUTINE.
 23541
 23542     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23543     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23544     MOVE TR-TTL-HD               TO PRT.
 23545     PERFORM 8800-PRINT-ROUTINE.
 23546
 23547     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23548     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23549     MOVE TR-TTL-HD               TO PRT.
 23550     PERFORM 8800-PRINT-ROUTINE.
 23551
 23552     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23553     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23554     MOVE TR-TTL-HD               TO PRT.
 23555     PERFORM 8800-PRINT-ROUTINE.
 23556
 23557     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23558     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23559     MOVE TR-TTL-HD               TO PRT.
 23560     PERFORM 8800-PRINT-ROUTINE.
 23561
 23562     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23563     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23564     MOVE TR-TTL-HD               TO PRT.
 23565     PERFORM 8800-PRINT-ROUTINE.
 23566
 23567     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23568     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23569     MOVE TR-TTL-HD               TO PRT.
 23570     PERFORM 8800-PRINT-ROUTINE.
 23571
 23572     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23573     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23574     MOVE TR-TTL-HD               TO PRT.
 23575     PERFORM 8800-PRINT-ROUTINE.
 23576
 23577     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23578     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23579     MOVE TR-TTL-HD               TO PRT.
 23580     PERFORM 8800-PRINT-ROUTINE.
 23581
 23582     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23583     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23584     MOVE TR-TTL-HD               TO PRT.
 23585     PERFORM 8800-PRINT-ROUTINE.
 23586
 23587     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23588     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23589     MOVE TR-TTL-HD               TO PRT.
 23590     PERFORM 8800-PRINT-ROUTINE.
 23591
 23592     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23593     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23594     MOVE TR-TTL-HD               TO PRT.
 23595     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 454
* ECS010.cbl
 23596
 23597     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23598     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23599     MOVE TR-TTL-HD               TO PRT.
 23600     PERFORM 8800-PRINT-ROUTINE.
 23601
 23602     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23603     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23604     MOVE TR-TTL-HD               TO PRT.
 23605     PERFORM 8800-PRINT-ROUTINE.
 23606
 23607     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23608     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23609     MOVE TR-TTL-HD               TO PRT.
 23610     PERFORM 8800-PRINT-ROUTINE.
 23611
 23612     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23613     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23614     MOVE TR-TTL-HD               TO PRT.
 23615     PERFORM 8800-PRINT-ROUTINE.
 23616
 23617     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23618     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23619     MOVE TR-TTL-HD               TO PRT.
 23620     PERFORM 8800-PRINT-ROUTINE.
 23621
 23622     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23623     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23624                                  TO TTL-HD-DS.
 23625     MOVE TR-TTL-HD               TO PRT.
 23626     PERFORM 8800-PRINT-ROUTINE.
 23627
 23628     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23629     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23630                                  TO TTL-HD-DS.
 23631     MOVE TR-TTL-HD               TO PRT.
 23632     PERFORM 8800-PRINT-ROUTINE.
 23633
 23634     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23635     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23636                                  TO TTL-HD-DS.
 23637     MOVE TR-TTL-HD               TO PRT.
 23638     PERFORM 8800-PRINT-ROUTINE.
 23639
 23640     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23641     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23642                                  TO TTL-HD-DS.
 23643     MOVE TR-TTL-HD               TO PRT.
 23644     PERFORM 8800-PRINT-ROUTINE.
 23645
 23646     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23647     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23648                                  TO TTL-HD-DS.
 23649     MOVE TR-TTL-HD               TO PRT.
 23650     PERFORM 8800-PRINT-ROUTINE.
 23651
 23652     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23653     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 455
* ECS010.cbl
 23654                                  TO TTL-HD-DS.
 23655     MOVE TR-TTL-HD               TO PRT.
 23656     PERFORM 8800-PRINT-ROUTINE.
 23657
 23658     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23659     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23660     MOVE TR-TTL-HD               TO PRT.
 23661     PERFORM 8800-PRINT-ROUTINE.
 23662
 23663     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23664     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23665     MOVE TR-TTL-HD               TO PRT.
 23666     PERFORM 8800-PRINT-ROUTINE.
 23667
 23668     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23669     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23670     MOVE TR-TTL-HD               TO PRT.
 23671     PERFORM 8800-PRINT-ROUTINE.
 23672
 23673     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23674     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23675     MOVE TR-TTL-HD               TO PRT.
 23676     PERFORM 8800-PRINT-ROUTINE.
 23677
 23678     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23679     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23680     MOVE TR-TTL-HD               TO PRT.
 23681     PERFORM 8800-PRINT-ROUTINE.
 23682
 23683     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23684     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23685     MOVE TR-TTL-HD               TO PRT.
 23686     PERFORM 8800-PRINT-ROUTINE.
 23687
 23688     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23689     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23690     MOVE TR-TTL-HD               TO PRT.
 23691     PERFORM 8800-PRINT-ROUTINE.
 23692
 23693     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23694     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23695     MOVE TR-TTL-HD               TO PRT.
 23696     PERFORM 8800-PRINT-ROUTINE.
 23697
 23698     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23699     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23700     MOVE TR-TTL-HD               TO PRT.
 23701     PERFORM 8800-PRINT-ROUTINE.
 23702
 23703     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23704     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23705     MOVE TR-TTL-HD               TO PRT.
 23706     PERFORM 8800-PRINT-ROUTINE.
 23707
 23708     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23709     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23710     MOVE TR-TTL-HD               TO PRT.
 23711     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 456
* ECS010.cbl
 23712
 23713     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23714     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23715     MOVE TR-TTL-HD               TO PRT.
 23716     PERFORM 8800-PRINT-ROUTINE.
 23717
 23718     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23719     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23720     MOVE TR-TTL-HD               TO PRT.
 23721     PERFORM 8800-PRINT-ROUTINE.
 23722
 23723     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23724     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23725     MOVE TR-TTL-HD               TO PRT.
 23726     PERFORM 8800-PRINT-ROUTINE.
 23727
 23728     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23729     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23730     MOVE TR-TTL-HD               TO PRT.
 23731     PERFORM 8800-PRINT-ROUTINE.
 23732
 23733     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23734     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23735     MOVE TR-TTL-HD               TO PRT.
 23736     PERFORM 8800-PRINT-ROUTINE.
 23737
 23738     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23739     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23740     MOVE TR-TTL-HD               TO PRT.
 23741     PERFORM 8800-PRINT-ROUTINE.
 23742
 23743     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23744     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23745     MOVE TR-TTL-HD               TO PRT.
 23746     PERFORM 8800-PRINT-ROUTINE.
 23747
 23748     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23749     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23750     MOVE TR-TTL-HD               TO PRT.
 23751     PERFORM 8800-PRINT-ROUTINE.
 23752
 23753     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23754     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23755     MOVE TR-TTL-HD               TO PRT.
 23756     PERFORM 8800-PRINT-ROUTINE.
 23757
 23758     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23759     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23760     MOVE TR-TTL-HD               TO PRT.
 23761     PERFORM 8800-PRINT-ROUTINE.
 23762
 23763     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23764     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23765     MOVE TR-TTL-HD               TO PRT.
 23766     PERFORM 8800-PRINT-ROUTINE.
 23767
 23768     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23769     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 457
* ECS010.cbl
 23770     MOVE TR-TTL-HD               TO PRT.
 23771     PERFORM 8800-PRINT-ROUTINE.
 23772
 23773     MOVE W-1-EP                  TO TTL-PT-CNT.
 23774     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23775     MOVE TR-TTL-HD               TO PRT.
 23776     PERFORM 8800-PRINT-ROUTINE.
 23777
 23778     MOVE W-P-EP                  TO TTL-PT-CNT.
 23779     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23780     MOVE TR-TTL-HD               TO PRT.
 23781     PERFORM 8800-PRINT-ROUTINE.
 23782
 23783     MOVE W-M-EP                  TO TTL-PT-CNT.
 23784     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23785     MOVE TR-TTL-HD               TO PRT.
 23786     PERFORM 8800-PRINT-ROUTINE.
 23787
 23788     MOVE W-R-EP                  TO TTL-PT-CNT.
 23789     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23790     MOVE TR-TTL-HD               TO PRT.
 23791     PERFORM 8800-PRINT-ROUTINE.
 23792
 23793     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23794     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23795     MOVE TR-TTL-HD               TO PRT.
 23796     PERFORM 8800-PRINT-ROUTINE.
 23797
 23798     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23799     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23800     MOVE TR-TTL-HD               TO PRT.
 23801     PERFORM 8800-PRINT-ROUTINE.
 23802
 23803     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23804     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23805     MOVE TR-TTL-HD               TO PRT.
 23806     PERFORM 8800-PRINT-ROUTINE.
 23807
 23808     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23809     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23810     MOVE TR-TTL-HD               TO PRT.
 23811     PERFORM 8800-PRINT-ROUTINE.
 23812
 23813     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23814     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23815     MOVE TR-TTL-HD               TO PRT.
 23816     PERFORM 8800-PRINT-ROUTINE.
 23817
 23818     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23819     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23820     MOVE TR-TTL-HD               TO PRT.
 23821     PERFORM 8800-PRINT-ROUTINE.
 23822
 23823     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23824     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23825     MOVE TR-TTL-HD               TO PRT.
 23826     PERFORM 8800-PRINT-ROUTINE.
 23827
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 458
* ECS010.cbl
 23828     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23829     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23830     MOVE TR-TTL-HD               TO PRT.
 23831     PERFORM 8800-PRINT-ROUTINE.
 23832
 23833     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23834     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23835     MOVE TR-TTL-HD               TO PRT.
 23836     PERFORM 8800-PRINT-ROUTINE.
 23837
 23838     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23839     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23840     MOVE TR-TTL-HD               TO PRT.
 23841     PERFORM 8800-PRINT-ROUTINE.
 23842
 23843     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23844     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23845     MOVE TR-TTL-HD               TO PRT.
 23846     PERFORM 8800-PRINT-ROUTINE.
 23847
 23848 9990-FINAL-CLOSE.
*23849                             COPY ELCPRTC.
 23850******************************************************************04/15/98
 23851*                                                                *ELCPRTC
 23852*                                                                *ELCPRTC
 23853*                            ELCPRTC.                            *   LV003
 23854*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23855*                            VMOD=2.002                          *   CL**2
 23856*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23857*                                                                *ELCPRTC
 23858* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23859******************************************************************ELCPRTC
 23860                                                                  ELCPRTC
 23861      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23862          CLOSE FICH.                                             ELCPRTC
 23863                                                                  ELCPRTC
 23864******************************************************************ELCPRTC
 23865
 23866     IF DTE-CLIENT = 'DMD'
 23867         CLOSE ERRESC-IN.
 23868
 23869     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23870
 23871     DISPLAY ' '.
 23872     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23873     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23874     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23875     DISPLAY ' '.
 23876
 23877     MOVE    ' DISPLAY ERROR COUNT = '
 23878       TO  DIS-LINE-REASON.
 23879     MOVE  ERROR-COUNT
 23880       TO  DIS-LINE-REC.
 23881         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23882
 23883     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23884           DISPLAY-PRT
 23885           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 459
* ECS010.cbl
 23886           ME50-ECS010-BALANCE
 23887           PENDING-EXTRACT  SUMMARY-EXTR.
 23888
 23889     if (dte-client = 'DCC')
 23890        and (dte-pgm-opt = '1')
 23891        close new-detail-extr
 23892     end-if
 23893
 23894     IF DTE-PGM-OPT = '1'
 23895         CLOSE CERT-MASTER-OUT
 23896               DETAIL-EXTR
 23897     end-if
 23898
 23899     IF ERACCTT-FILE-STATUS NOT = '00'
 23900         MOVE '12'                TO ABEND-CODE-1
 23901         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 23902         DISPLAY '******************************'
 23903         DISPLAY '***** ERROR LOCATION 027 *****'
 23904         DISPLAY '******************************'
 23905         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23906           GO TO ABEND-PGM.
 23907
 23908     IF COMM-OPEN-SW = 'X'
 23909         CLOSE ERCTBL
 23910         IF ERCTBL-FILE-STATUS NOT = '00'
 23911             MOVE '42'               TO ABEND-CODE-1
 23912             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 23913             DISPLAY '******************************'
 23914             DISPLAY '***** ERROR LOCATION 028 *****'
 23915             DISPLAY '******************************'
 23916             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23917             GO TO ABEND-PGM.
 23918
 23919     IF REIN-OPEN-SW = 'X'
 23920         CLOSE ERRTBL-IN
 23921         IF ERRTBL-FILE-STATUS NOT = '00'
 23922             MOVE '22'               TO ABEND-CODE-1
 23923             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 23924             DISPLAY '******************************'
 23925             DISPLAY '***** ERROR LOCATION 029 *****'
 23926             DISPLAY '******************************'
 23927             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23928             GO TO ABEND-PGM.
 23929
 23930     MOVE 'C'                         TO CP-IO-FUNCTION.
 23931     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 23932     IF IO-ERROR
 23933         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 23934                                      TO WS-ABEND-MESSAGE
 23935         MOVE 0302                    TO WS-RETURN-CODE
 23936         DISPLAY '******************************'
 23937         DISPLAY '***** ERROR LOCATION 030 *****'
 23938         DISPLAY '******************************'
 23939         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23940         GO TO ABEND-PGM.
 23941
 23942     IF ME-DO-UPDATE
 23943           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 460
* ECS010.cbl
 23944           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 23945           ACCEPT WS-TIME-OF-DAY   FROM TIME
 23946           MOVE WS-TIME              TO ME-010-END
 23947           ADD 1 TO ME-010-RUN-CT
 23948           REWRITE MONTH-END-BALANCES
 23949           DISPLAY 'MONTH-END BALANCES POSTED'
 23950           CLOSE ERMEBL-INOUT
 23951     ELSE
 23952         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 23953
 23954     GO TO 9999-END-THE-JOB.
 23955
 23956 CERT-DATE-LOAD.
*23957     COPY ELCCRTM1.
 23958******************************************************************04/15/98
 23959*                                                                *ELCCRTM1
 23960*                                                                *ELCCRTM1
 23961*                            ELCCRTM1                            *   LV003
 23962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23963*                            VMOD=2.001                          *ELCCRTM1
 23964*                                                                *ELCCRTM1
 23965*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 23966*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 23967*                                                                *ELCCRTM1
 23968******************************************************************ELCCRTM1
 23969     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 23970     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 23971     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 23972     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 23973     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 23974     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 23975     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 23976     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 23977     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 23978                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 23979     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 23980                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 23981     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 23982     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 23983     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 23984     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 23985     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 23986     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 23987           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 23988                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 23989     END-PERFORM.                                                 ELCCRTM1
 23990                                                                  ELCCRTM1
 23991
 23992 EXTRACT-DATE-LOAD.
*23993     COPY ELCEXTM1.
 23994******************************************************************04/15/98
 23995*                                                                *ELCEXTM1
 23996*                                                                *ELCEXTM1
 23997*                            ELCEXTM1                            *   LV010
 23998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 23999*                            VMOD=2.001                          *ELCEXTM1
 24000*                                                                *ELCEXTM1
 24001*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 461
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24002*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24003*                                                                *ELCEXTM1
 24004******************************************************************ELCEXTM1
 24005                                                                  ELCEXTM1
 24006     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24007     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24008     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24009     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24010     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24011     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24012                                                                     CL**9
 24013     EVALUATE TRUE                                                   CL**5
 24014        WHEN DE-ISSUE      OR                                        CL**8
 24015             DE-RC-ISSUE   OR                                        CL**8
 24016             DE-RR-RC-ISS  OR                                        CL**8
 24017             DE-CANCEL     OR                                        CL**8
 24018             DE-RC-CANCEL  OR                                        CL**8
 24019             DE-RR-RC-CNC                                            CL**8
 24020           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24021                                                                     CL**9
 24022        WHEN DE-CLAIM      OR                                        CL**8
 24023             DE-RR-RC-CLM                                            CL**6
 24024           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24025           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24026           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24027           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24028           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24029           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24030                                                                     CL**9
 24031        WHEN DE-RESERVE                                              CL**9
 24032           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24033           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24034           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24035                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24036           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24037                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24038           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24039     END-EVALUATE.                                                   CL**9
 24040                                                                     CL**9
 24041
 24042 EXTRACT-DATE-RELOAD.
*24043     COPY ELCEXTM2.
 24044******************************************************************04/15/98
 24045*                                                                *ELCEXTM2
 24046*                                                                *ELCEXTM2
 24047*                            ELCEXTM2                            *   LV011
 24048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24049*                            VMOD=2.001                          *ELCEXTM2
 24050*                                                                *ELCEXTM2
 24051*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24052*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24053*                                                                *   CL**9
 24054******************************************************************ELCEXTM2
 24055                                                                  ELCEXTM2
 24056     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24057     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24058     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24059     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 462
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24060     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24061     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24062                                                                     CL*10
 24063     EVALUATE TRUE                                                   CL*10
 24064        WHEN DE-ISSUE      OR                                        CL*10
 24065             DE-RC-ISSUE   OR                                        CL*10
 24066             DE-RR-RC-ISS  OR                                        CL*10
 24067             DE-CANCEL     OR                                        CL*10
 24068             DE-RC-CANCEL  OR                                        CL*10
 24069             DE-RR-RC-CNC                                            CL*10
 24070           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24071                                                                     CL*10
 24072        WHEN DE-CLAIM      OR                                        CL*10
 24073             DE-RR-RC-CLM                                            CL**7
 24074           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24075           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24076           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24077           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24078           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24079           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24080                                                                     CL*10
 24081        WHEN DE-RESERVE                                              CL**7
 24082            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24083            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24084            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24085                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24086            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24087                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24088            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24089     END-EVALUATE.                                                   CL**5
 24090                                                                  ELCEXTM2
 24091
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 463
* ECS010.cbl
 24093 ABEND-PGM.
 24094     DISPLAY '******************************'
 24095     DISPLAY '***** ABEND PGM **************'
 24096     DISPLAY '******************************'
*24097                             COPY ELCABEND.
 24098***************************************************************** 04/14/98
 24099*                                                               * ELCABEND
 24100*                            ELCABEND.                          *    LV003
 24101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24102*                            VMOD 2.002                              CL**2
 24103*                                                               * ELCABEND
 24104*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24105*            AND THEN ABENDS.                                   * ELCABEND
 24106*                                                               * ELCABEND
 24107*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24108*                                                               * ELCABEND
 24109***************************************************************** ELCABEND
 24110*APS-010.                                                         ELCABEND
 24111     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24112     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24113                                                                  ELCABEND
 24114     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24115         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24116         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24117                                 UPON CONSOLE.                    ELCABEND
 24118                                                                  ELCABEND
 24119     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24120         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24121         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24122                                 UPON CONSOLE.                    ELCABEND
 24123                                                                  ELCABEND
 24124     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24125     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24126                                 UPON CONSOLE.                    ELCABEND
 24127                                                                  ELCABEND
 24128     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24129     CALL 'ABORTME'.
 24130                                                                  ELCABEND
 24131 APS-EXIT.                                                        ELCABEND
 24132     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 464
* ECS010.cbl
 24134 9999-END-THE-JOB.
 24135
 24136     DISPLAY ' '.
 24137     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24138         'ECS010 ******'
 24139     DISPLAY ' '.
 24140     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 465
* ECS010.cbl
 24141/
 24142 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24143     IF LCP-ASA = '+'
 24144         WRITE MISMATCH-RPT AFTER 0 LINE
 24145     ELSE
 24146     IF LCP-ASA = ' '
 24147         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24148     ELSE
 24149     IF LCP-ASA = '0'
 24150         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24151     ELSE
 24152     IF LCP-ASA = '-'
 24153         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24154     ELSE
 24155     IF LCP-ASA = '1'
 24156         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24157     ELSE
 24158     IF LCP-ASA = '2'
 24159         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24160     ELSE
 24161     IF LCP-ASA = '3'
 24162         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24163     ELSE
 24164     IF LCP-ASA = '4'
 24165         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24166     ELSE
 24167     IF LCP-ASA = '5'
 24168         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24169     ELSE
 24170     IF LCP-ASA = '6'
 24171         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24172     ELSE
 24173     IF LCP-ASA = '7'
 24174         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24175     ELSE
 24176     IF LCP-ASA = '8'
 24177         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24178     ELSE
 24179     IF LCP-ASA = '9'
 24180         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24181     ELSE
 24182     IF LCP-ASA = 'A'
 24183         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24184     ELSE
 24185     IF LCP-ASA = 'B'
 24186         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24187     ELSE
 24188     IF LCP-ASA = 'C'
 24189         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24190     ELSE
 24191     IF LCP-ASA = 'V'
 24192         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24193     ELSE
 24194     IF LCP-ASA = 'W'
 24195         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24196     ELSE
 24197     DISPLAY 'ASA CODE ERROR'.
 24198 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-13 10:07 Page 466
* ECS010.cbl
 24199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  295
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2769132     Code:      138409
