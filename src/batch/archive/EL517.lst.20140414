* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL517 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/08/94 08:12:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.040.
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   2
* EL517.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    27*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    38* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    39*                                IS OPEN OR CNC DT < PD THRU
    40*                                ALSO ADD ALTERNATE KEY CLAUSE
    41* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    42* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    43* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    44* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    45* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    46* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    47* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    48* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    49* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    50* 061412  CR2011022800001  AJRA  NAPERSOFT
    51* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    54* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    55* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    56* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    57* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    58******************************************************************
    59
    60 ENVIRONMENT DIVISION.
    61
    62 INPUT-OUTPUT SECTION.
    63
    64 FILE-CONTROL.
    65
    66     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    67
    68     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    69                             ORGANIZATION IS INDEXED
    70                             ACCESS IS DYNAMIC
    71                             RECORD KEY IS CF-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   3
* EL517.cbl
    72                             FILE STATUS IS ELCNTL-FILE-STATUS.
    73
    74     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    75                             ORGANIZATION IS INDEXED
    76                             ACCESS IS SEQUENTIAL
    77                             RECORD KEY IS PB-CONTROL-PRIMARY
    78                             ALTERNATE RECORD KEY IS
    79                                 PB-CONTROL-BY-ACCOUNT
    80                             FILE STATUS IS ERPNDB-FILE-STATUS.
    81
    82     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    83                             ORGANIZATION IS INDEXED
    84                             ACCESS IS DYNAMIC
    85                             RECORD KEY IS RE-CONTROL-PRIMARY
    86                             FILE STATUS IS ERREIN-FILE-STATUS.
    87
    88     SELECT ELCERT
*                                  COPY ELCCERTS.
    89******************************************************************04/15/98
    90*                                                                *ELCCERTS
    91*                            ELCCERTS.                           *   LV002
    92*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    93*                            VMOD=2.001                          *ELCCERTS
    94*                                                                *ELCCERTS
    95*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    96*                                                                *ELCCERTS
    97*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
    98******************************************************************ELCCERTS
    99                                                                  ELCCERTS
   100         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   101         ORGANIZATION IS INDEXED                                  ELCCERTS
   102         ACCESS IS DYNAMIC                                        ELCCERTS
   103         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   104         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   105                                                                  ELCCERTS
   106
   107     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   108                             ORGANIZATION IS INDEXED
   109                             ACCESS IS DYNAMIC
   110                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   111                             FILE STATUS IS ELMSTR-FILE-STATUS.
   112
   113     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   114                             ORGANIZATION IS INDEXED
   115                             ACCESS IS DYNAMIC
   116                             RECORD KEY IS CT-CONTROL-PRIMARY
   117                             FILE STATUS IS ERCTBL-FILE-STATUS.
   118
   119     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   120                             ORGANIZATION IS INDEXED
   121                             ACCESS IS DYNAMIC
   122                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   123                             FILE STATUS IS ERACCT-FILE-STATUS.
   124
   125     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   126                             ORGANIZATION IS INDEXED
   127                             ACCESS IS DYNAMIC
   128                             RECORD KEY IS EM-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   4
* EL517.cbl
   129                             FILE STATUS IS ELCERR-FILE-STATUS.
   130
   131     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   132                             ORGANIZATION IS INDEXED
   133                             ACCESS IS DYNAMIC
   134                             RECORD KEY IS PM-CONTROL-PRIMARY
   135                             FILE STATUS IS ERPNDM-FILE-STATUS.
   136
   137     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   138                             ORGANIZATION IS INDEXED
   139                             ACCESS IS DYNAMIC
   140                             RECORD KEY IS MA-CONTROL-PRIMARY
   141                             FILE STATUS IS ERMAIL-FILE-STATUS.
   142
   143     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   144                             ORGANIZATION IS INDEXED
   145                             ACCESS IS DYNAMIC
   146                             RECORD KEY IS PL-CONTROL-PRIMARY
   147                             FILE STATUS IS ERPLAN-FILE-STATUS.
   148
   149     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   150                             ORGANIZATION IS INDEXED
   151                             ACCESS IS DYNAMIC
   152                             RECORD KEY IS FO-CONTROL-PRIMARY
   153                             FILE STATUS IS ERFORM-FILE-STATUS.
   154
   155     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   156
   157     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   158
   159     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   160                             ORGANIZATION IS INDEXED
   161                             ACCESS IS DYNAMIC
   162                             RECORD KEY IS RF-CONTROL-PRIMARY
   163                             FILE STATUS IS DTE-VSAM-FLAGS.
   164
   165     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   166                             ORGANIZATION IS INDEXED
   167                             ACCESS IS DYNAMIC
   168                             RECORD KEY IS ERRESS-PRIMARY-KEY
   169                             FILE STATUS IS ERRESS-FILE-STATUS.
   170
   171     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   172                             ORGANIZATION IS INDEXED
   173                             ACCESS IS DYNAMIC
   174                             RECORD KEY IS ERRESC-RECORD-KEY
   175                             FILE STATUS IS ERRESC-FILE-STATUS.
   176
   177     SELECT ERCOMP           ASSIGN TO             ERCOMP
   178                             ORGANIZATION IS INDEXED
   179                             ACCESS IS DYNAMIC
   180                             RECORD KEY IS CO-CONTROL-PRIMARY
   181                             FILE STATUS IS ERCOMP-FILE-STATUS.
   182
   183     SELECT ERLOFC           ASSIGN TO             ERLOFC
   184                             ORGANIZATION IS INDEXED
   185                             ACCESS IS DYNAMIC
   186                             RECORD KEY IS LO-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   5
* EL517.cbl
   187                             FILE STATUS IS ERLOFC-FILE-STATUS.
   188
   189     SELECT ERBXRF           ASSIGN TO             ERBXRF
   190                             ORGANIZATION IS INDEXED
   191                             ACCESS IS DYNAMIC
   192                             RECORD KEY IS BK-CONTROL-PRIMARY
   193                             FILE STATUS IS ERBXRF-FILE-STATUS.
   194
   195     SELECT ERAGTC           ASSIGN TO             ERAGTC
   196                             ORGANIZATION IS INDEXED
   197                             ACCESS IS DYNAMIC
   198                             RECORD KEY IS AG-CONTROL-PRIMARY
   199                             FILE STATUS IS ERAGTC-FILE-STATUS.
   200
   201     SELECT ELCRTT           ASSIGN TO             ELCRTT
   202                             ORGANIZATION IS INDEXED
   203                             ACCESS IS DYNAMIC
   204                             RECORD KEY IS CS-CONTROL-PRIMARY
   205                             FILE STATUS IS ELCRTT-FILE-STATUS.
   206
   207     SELECT ERPDEF           ASSIGN TO ERPDEF
   208                             ACCESS IS DYNAMIC
   209                             ORGANIZATION IS INDEXED
   210                             FILE STATUS IS ERPDEF-FILE-STATUS
   211                             RECORD KEY IS PD-CONTROL-PRIMARY.
   212
   213     SELECT ELSTAT           ASSIGN TO ELSTAT
   214                             ACCESS IS DYNAMIC
   215                             ORGANIZATION IS INDEXED
   216                             FILE STATUS IS ELSTAT-FILE-STATUS
   217                             RECORD KEY IS SF-CONTROL-PRIMARY.
   218
   219     SELECT ELCRTO           ASSIGN TO ELCRTO
   220                             ACCESS IS DYNAMIC
   221                             ORGANIZATION IS INDEXED
   222                             FILE STATUS IS ELCRTO-FILE-STATUS
   223                             RECORD KEY IS OC-CONTROL-PRIMARY.
   224
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   6
* EL517.cbl
   226 DATA DIVISION.
   227
   228 FILE SECTION.
   229
   230 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   231******************************************************************04/15/98
   232*                                                                *ELCDTEFD
   233*                                                                *ELCDTEFD
   234*                            ELCDTEFD.                           *   LV002
   235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   236*                            VMOD=2.007                          *   CL**2
   237*                                                                *ELCDTEFD
   238******************************************************************ELCDTEFD
   239     BLOCK CONTAINS 0 RECORDS
   240     RECORDING MODE F.                                            ELCDTEFD
   241                                                                  ELCDTEFD
   242 01  DATE-DISK.                                                   ELCDTEFD
   243     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   244     12  FILLER                      PIC  X(14).                  ELCDTEFD
   245     12  DD-CR1                      PIC  9.                      ELCDTEFD
   246     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   247     12  DD-CR2                      PIC  9.                      ELCDTEFD
   248     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   249     12  FILLER                      PIC  X(20).                  ELCDTEFD
   250                                                                  ELCDTEFD
   251 01  DATE-DISK-R.                                                 ELCDTEFD
   252     12  FILLER                      PIC  X(4).                   ELCDTEFD
   253     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   254                                     PIC  X(32).                  ELCDTEFD
   255                                                                  ELCDTEFD
   256 01  DATE-DISK-T.                                                 ELCDTEFD
   257     12  FILLER                      PIC  X(4).                   ELCDTEFD
   258     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   259                                     PIC  X(48).                  ELCDTEFD
   260                                                                  ELCDTEFD
   261 01  DATE-DISK-M.                                                 ELCDTEFD
   262     12  FILLER                      PIC  X(4).                   ELCDTEFD
   263     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   264                                     PIC  X(48).                  ELCDTEFD
   265                                                                  ELCDTEFD
   266 01  DATE-DISK-P.                                                 ELCDTEFD
   267     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   268     12  DD-IDX                      PIC  99.                     ELCDTEFD
   269     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   270     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   271         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   272                                     PIC  X.                      ELCDTEFD
   273         16  FILLER                  PIC  X(46).                  ELCDTEFD
   274     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   275         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   276             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   277             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   278             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   279             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   280         16  FILLER                  PIC  X(16).                  ELCDTEFD
   281                                                                  ELCDTEFD
   282 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   283     12  FILLER                      PIC  X(4).                   ELCDTEFD
   284     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   285                                     PIC  X(4).                   ELCDTEFD
   286                                                                  ELCDTEFD
   287 01  DATE-DISK-C.                                                 ELCDTEFD
   288     12  FILLER                      PIC  X(7).                   ELCDTEFD
   289     12  DD-CARR1-SECPAY-SW          PIC  X.
   290     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   291     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   292     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   293     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   294     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   295     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   296     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   297     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   298     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   299     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   300     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   301     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   302     12  DD-CARR2-SECPAY-SW          PIC  X.
   303     12  FILLER                      PIC  X(7).                   ELCDTEFD
   304                                                                  ELCDTEFD
   305 01  DATE-DISK-OPT.                                               ELCDTEFD
   306     12  FILLER                      PIC  X(04).                  ELCDTEFD
   307     12  DD-TLR-DATA.                                             ELCDTEFD
   308         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   309                                     PIC  X(03).                  ELCDTEFD
   310     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   311         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   312                                     PIC  X(06).                  ELCDTEFD
   313     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   314         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   315                                     PIC  X(07).                  ELCDTEFD
   316         16  FILLER                  PIC  X(05).                  ELCDTEFD
   317     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   318                                     PIC  X(96).                  ELCDTEFD
   319******************************************************************ELCDTEFD
   320
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   8
* EL517.cbl
   322 FD  ELCNTL.
*  323                                 COPY ELCCNTL.
   324******************************************************************
   325*                                                                *
   326*                                                                *
   327*                            ELCCNTL.                            *
   328*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   329*                            VMOD=2.059                          *
   330*                                                                *
   331*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   332*                                                                *
   333*   FILE TYPE = VSAM,KSDS                                        *
   334*   RECORD SIZE = 750  RECFORM = FIXED                           *
   335*                                                                *
   336*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   337*       ALTERNATE INDEX = NONE                                   *
   338*                                                                *
   339*   LOG = YES                                                    *
   340*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   341******************************************************************
   342*                   C H A N G E   L O G
   343*
   344* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   345*-----------------------------------------------------------------
   346*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   347* EFFECTIVE    NUMBER
   348*-----------------------------------------------------------------
   349* 082503                   PEMA  ADD BENEFIT GROUP
   350* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   351* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   352* 092705    2005050300006  PEMA  ADD SPP LEASES
   353* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   354* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   355* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   356* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   357* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   358* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   359* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   360* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   361* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   362******************************************************************
   363*
   364 01  CONTROL-FILE.
   365     12  CF-RECORD-ID                       PIC XX.
   366         88  VALID-CF-ID                        VALUE 'CF'.
   367
   368     12  CF-CONTROL-PRIMARY.
   369         16  CF-COMPANY-ID                  PIC XXX.
   370         16  CF-RECORD-TYPE                 PIC X.
   371             88  CF-COMPANY-MASTER              VALUE '1'.
   372             88  CF-PROCESSOR-MASTER            VALUE '2'.
   373             88  CF-STATE-MASTER                VALUE '3'.
   374             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   375             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   376             88  CF-CARRIER-MASTER              VALUE '6'.
   377             88  CF-MORTALITY-MASTER            VALUE '7'.
   378             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   379             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page   9
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   380             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   381             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   382             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   383             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   384             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   385             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   386             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   387             88  CF-REMINDERS-MASTER            VALUE 'R'.
   388             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   389         16  CF-ACCESS-CD-GENL              PIC X(4).
   390         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   391             20  CF-PROCESSOR               PIC X(4).
   392         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   393             20  CF-STATE-CODE              PIC XX.
   394             20  FILLER                     PIC XX.
   395         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   396             20  FILLER                     PIC XX.
   397             20  CF-HI-BEN-IN-REC           PIC XX.
   398         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   399             20  FILLER                     PIC XXX.
   400             20  CF-CARRIER-CNTL            PIC X.
   401         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   402             20  FILLER                     PIC XX.
   403             20  CF-HI-TYPE-IN-REC          PIC 99.
   404         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   405             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   406                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   407             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   408             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   409         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   410             20  FILLER                     PIC X.
   411             20  CF-CUSTOM-REPORT-NO        PIC 999.
   412         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   413             20  FILLER                     PIC XX.
   414             20  CF-MORTGAGE-PLAN           PIC XX.
   415         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   416
   417     12  CF-LAST-MAINT-DT                   PIC XX.
   418     12  CF-LAST-MAINT-BY                   PIC X(4).
   419     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   420
   421     12  CF-RECORD-BODY                     PIC X(728).
   422
   423
   424****************************************************************
   425*             COMPANY MASTER RECORD                            *
   426****************************************************************
   427
   428     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   429         16  CF-COMPANY-ADDRESS.
   430             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   431             20  CF-CL-IN-CARE-OF           PIC X(30).
   432             20  CF-CL-ADDR-LINE-1          PIC X(30).
   433             20  CF-CL-ADDR-LINE-2          PIC X(30).
   434             20  CF-CL-CITY-STATE           PIC X(30).
   435             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   436             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   437         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  10
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   438         16  CF-COMPANY-PASSWORD            PIC X(8).
   439         16  CF-SECURITY-OPTION             PIC X.
   440             88  ALL-SECURITY                   VALUE '1'.
   441             88  COMPANY-VERIFY                 VALUE '2'.
   442             88  PROCESSOR-VERIFY               VALUE '3'.
   443             88  NO-SECURITY                    VALUE '4'.
   444             88  ALL-BUT-TERM                   VALUE '5'.
   445         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   446             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   447         16  CF-LGX-INTERFACE-CNTL          PIC X.
   448             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   449         16  CF-INFORCE-LOCATION            PIC X.
   450             88  CERTS-ARE-ONLINE               VALUE '1'.
   451             88  CERTS-ARE-OFFLINE              VALUE '2'.
   452             88  NO-CERTS-AVAILABLE             VALUE '3'.
   453         16  CF-LOWER-CASE-LETTERS          PIC X.
   454         16  CF-CERT-ACCESS-CONTROL         PIC X.
   455             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   456             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   457             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   458             88  CF-ACCNT-CNTL                  VALUE '3'.
   459             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   460
   461         16  CF-FORMS-PRINTER-ID            PIC X(4).
   462         16  CF-CHECK-PRINTER-ID            PIC X(4).
   463
   464         16  CF-LGX-CREDIT-USER             PIC X.
   465             88  CO-IS-NOT-USER                 VALUE 'N'.
   466             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   467
   468         16 CF-CREDIT-CALC-CODES.
   469             20  CF-CR-REM-TERM-CALC PIC X.
   470               88  CR-EARN-AFTER-15TH           VALUE '1'.
   471               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   472               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   473               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   474               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   475               88  CR-EARN-AFTER-14TH           VALUE '6'.
   476               88  CR-EARN-AFTER-16TH           VALUE '7'.
   477             20  CF-CR-R78-METHOD           PIC X.
   478               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   479               88  DONT-USE-PLUS-ONE            VALUE '1'.
   480
   481         16  CF-CLAIM-CONTROL-COUNTS.
   482             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   483                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   484
   485             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   486                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   487
   488             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   489                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   490
   491             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   492                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   493
   494         16  CF-CURRENT-MONTH-END           PIC XX.
   495
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  11
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   496         16  CF-CO-CALC-QUOTE-TOLERANCE.
   497             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   498             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   499             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   500             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   501                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   502                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   503             20  CF-CO-PREM-REJECT-SW       PIC X.
   504                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   505                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   506             20  CF-CO-REF-REJECT-SW        PIC X.
   507                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   508                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   509
   510         16  CF-CO-REPORTING-DT             PIC XX.
   511         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   512         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   513           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   514           88  CF-CO-MONTH-END                  VALUE '1'.
   515
   516         16  CF-LGX-CLAIM-USER              PIC X.
   517             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   518             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   519
   520         16  CF-CREDIT-EDIT-CONTROLS.
   521             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   522             20  CF-MIN-AGE                 PIC 99.
   523             20  CF-DEFAULT-AGE             PIC 99.
   524             20  CF-MIN-TERM                PIC S999      COMP-3.
   525             20  CF-MAX-TERM                PIC S999      COMP-3.
   526             20  CF-DEFAULT-SEX             PIC X.
   527             20  CF-JOINT-AGE-INPUT         PIC X.
   528                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   529             20  CF-BIRTH-DATE-INPUT        PIC X.
   530                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   531             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   532                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   533                 88  CF-ZERO-CARRIER            VALUE '1'.
   534                 88  CF-ZERO-GROUPING           VALUE '2'.
   535                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   536             20  CF-EDIT-SW                 PIC X.
   537                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   538             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   539             20  CF-CR-PR-METHOD            PIC X.
   540               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   541               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   542             20  FILLER                     PIC X.
   543
   544         16  CF-CREDIT-MISC-CONTROLS.
   545             20  CF-REIN-TABLE-SW           PIC X.
   546                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   547             20  CF-COMP-TABLE-SW           PIC X.
   548                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   549             20  CF-EXPERIENCE-RETENTION-AGE
   550                                            PIC S9        COMP-3.
   551             20  CF-CONVERSION-DT           PIC XX.
   552             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   553             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  12
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   554                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   555                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   556
   557             20  CF-CR-CHECK-NO-CONTROL.
   558                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   559                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   560                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   561                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   562                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   563                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   564
   565                 24  CF-CR-CHECK-COUNT       REDEFINES
   566                     CF-CR-CHECK-COUNTER      PIC X(4).
   567
   568                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   569                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   570
   571                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   572                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   573                 24  CF-MAIL-PROCESSING       PIC X.
   574                     88  MAIL-PROCESSING          VALUE 'Y'.
   575
   576         16  CF-MISC-SYSTEM-CONTROL.
   577             20  CF-SYSTEM-C                 PIC X.
   578                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   579             20  CF-SYSTEM-D                 PIC X.
   580                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   581             20  CF-SOC-SEC-NO-SW            PIC X.
   582                 88  SOC-SEC-NO-USED             VALUE '1'.
   583             20  CF-MEMBER-NO-SW             PIC X.
   584                 88  MEMBER-NO-USED              VALUE '1'.
   585             20  CF-TAX-ID-NUMBER            PIC X(11).
   586             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   587             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   588                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   589                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   590                 88  CF-ALL-APPROVED             VALUE 'Y'.
   591                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   592             20  CF-SYSTEM-E                 PIC X.
   593                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   594
   595         16  CF-LGX-LIFE-USER               PIC X.
   596             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   597             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   598
   599         16  CF-CR-MONTH-END-DT             PIC XX.
   600
   601         16  CF-FILE-MAINT-DATES.
   602             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   603                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   604             20  CF-LAST-BATCH       REDEFINES
   605                 CF-LAST-BATCH-NO               PIC X(4).
   606             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   607             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   608             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   609             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   610             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   611             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  13
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   612             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   613             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   614             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   615             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   616
   617         16  CF-NEXT-COMPANY-ID             PIC XXX.
   618         16  FILLER                         PIC X.
   619
   620         16  CF-ALT-MORT-CODE               PIC X(4).
   621         16  CF-MEMBER-CAPTION              PIC X(10).
   622
   623         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   624             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   625             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   626             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   627             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   628             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   629
   630         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   631
   632         16  CF-LIFE-OVERRIDE-L1            PIC X.
   633         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   634         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   635         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   636
   637         16  CF-AH-OVERRIDE-L1              PIC X.
   638         16  CF-AH-OVERRIDE-L2              PIC XX.
   639         16  CF-AH-OVERRIDE-L6              PIC X(6).
   640         16  CF-AH-OVERRIDE-L12             PIC X(12).
   641
   642         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   643         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   644
   645         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   646         16  CF-AR-LAST-EL860-DT            PIC XX.
   647         16  CF-MP-MONTH-END-DT             PIC XX.
   648
   649         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   650         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   651             88  CF-CLAIM-PAID-TO               VALUE '1'.
   652
   653         16  CF-AR-MONTH-END-DT             PIC XX.
   654
   655         16  CF-CRDTCRD-USER                PIC X.
   656             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   657             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   658
   659         16  CF-CC-MONTH-END-DT             PIC XX.
   660
   661         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   662
   663         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   664             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   665             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   666             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   667         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   668         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   669         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  14
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   670         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   671             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   672             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   673         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   674         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   675         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   676             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   677         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   678
   679         16  CF-CL-ZIP-CODE.
   680             20  CF-CL-ZIP-PRIME.
   681                 24  CF-CL-ZIP-1ST          PIC X.
   682                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   683                 24  FILLER                 PIC X(4).
   684             20  CF-CL-ZIP-PLUS4            PIC X(4).
   685         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   686             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   687             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   688             20  FILLER                     PIC XXX.
   689
   690         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   691         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   692         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   693         16  CF-CO-OPTION-START-DATE        PIC XX.
   694         16  CF-REM-TRM-CALC-OPTION         PIC X.
   695           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   696                                                      '3' '4'.
   697           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   698           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   699           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   700           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   701           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   702           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   703
   704         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   705
   706         16  CF-PAYMENT-APPROVAL-LEVELS.
   707             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   708             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   709             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   710             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   711             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   712             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   713
   714         16  CF-END-USER-REPORTING-USER     PIC X.
   715             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   716             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   717
   718         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   719             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   720             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   721
   722         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   723
   724         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   725         16  FILLER                         PIC X.
   726
   727         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  15
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   728             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   729             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   730             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   731
   732         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   733
   734         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   735             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   736             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   737
   738         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   739             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   740             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   741
   742         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   743
   744         16  CF-CO-ACH-ID-CODE              PIC  X.
   745             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   746             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   747             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   748         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   749         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   750         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   751         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   752         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   753         16  CF-CO-ACH-RECV-NO              PIC X(08).
   754         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   755         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   756         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   757                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   758         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   759                 CF-CO-ACH-TRACE-NO         PIC X(4).
   760
   761         16  CF-CO-OVER-SHORT.
   762             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   763             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   764
   765*         16  FILLER                         PIC X(102).
   766         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   767             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   768             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   769
   770         16  CF-AH-APPROVAL-DAYS.
   771             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   772             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   773             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   774             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   775
   776         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   777
   778         16  CF-APPROV-LEV-5.
   779             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   780             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   781             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   782
   783         16  FILLER                         PIC X(68).
   784****************************************************************
   785*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  16
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   786****************************************************************
   787
   788     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   789         16  CF-PROCESSOR-NAME              PIC X(30).
   790         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   791         16  CF-PROCESSOR-TITLE             PIC X(26).
   792         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   793                 88  MESSAGE-YES                VALUE 'Y'.
   794                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   795
   796*****************************************************
   797****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   798****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   799****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   800****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   801*****************************************************
   802
   803         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   804             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   805             20  CF-APPLICATION-FORCE       PIC X.
   806             20  CF-INDIVIDUAL-APP.
   807                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   808                     28  CF-BROWSE-APP      PIC X.
   809                     28  CF-UPDATE-APP      PIC X.
   810
   811         16  CF-CURRENT-TERM-ON             PIC X(4).
   812         16  CF-PROCESSOR-LIMITS-CLAIMS.
   813             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   814             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   815             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   816             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   817             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   818             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   819             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   820         16  CF-PROCESSOR-CARRIER           PIC X.
   821             88  NO-CARRIER-SECURITY            VALUE ' '.
   822         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   823             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   824         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   825             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   826         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   827             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   828
   829         16  CF-PROC-SYS-ACCESS-SW.
   830             20  CF-PROC-CREDIT-CLAIMS-SW.
   831                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   832                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   833                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   834                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   835             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   836                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   837                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   838             20  CF-PROC-LIFE-GNRLDGR-SW.
   839                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   840                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   841                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   842                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   843             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  17
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   844                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   845                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   846         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   847             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   848             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   849         16  CF-PROCESSOR-PRINTER               PIC X(4).
   850
   851         16  CF-APPROVAL-LEVEL                  PIC X.
   852             88  APPROVAL-LEVEL-1                   VALUE '1'.
   853             88  APPROVAL-LEVEL-2                   VALUE '2'.
   854             88  APPROVAL-LEVEL-3                   VALUE '3'.
   855             88  APPROVAL-LEVEL-4                   VALUE '4'.
   856             88  APPROVAL-LEVEL-5                   VALUE '5'.
   857
   858         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   859
   860         16  CF-LANGUAGE-TYPE                   PIC X.
   861             88  CF-LANG-IS-ENG                     VALUE 'E'.
   862             88  CF-LANG-IS-FR                      VALUE 'F'.
   863
   864         16  CF-CSR-IND                         PIC X.
   865         16  FILLER                             PIC X(239).
   866
   867****************************************************************
   868*             PROCESSOR/REMINDERS RECORD                       *
   869****************************************************************
   870
   871     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   872         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   873             20  CF-START-REMIND-DT         PIC XX.
   874             20  CF-END-REMIND-DT           PIC XX.
   875             20  CF-REMINDER-TEXT           PIC X(50).
   876         16  FILLER                         PIC X(296).
   877
   878
   879****************************************************************
   880*             STATE MASTER RECORD                              *
   881****************************************************************
   882
   883     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   884         16  CF-STATE-ABBREVIATION          PIC XX.
   885         16  CF-STATE-NAME                  PIC X(25).
   886         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   887         16  CF-ST-CALC-QUOTE-TOLERANCE.
   888             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   889             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   890             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   891             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   892                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   893                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   894             20  CF-ST-PREM-REJECT-SW       PIC X.
   895                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   896                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   897             20  CF-ST-REF-REJECT-SW        PIC X.
   898                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   899                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   900         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   901         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  18
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   902         16  CF-ST-REFUND-RULES.
   903             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   904             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   905             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   906         16  CF-ST-FST-PMT-EXTENSION.
   907             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   908             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   909                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   910                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   911                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   912                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   913         16  CF-ST-STATE-CALL.
   914             20  CF-ST-CALL-UNEARNED        PIC X.
   915             20  CF-ST-CALL-RPT-CNTL        PIC X.
   916             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   917         16  CF-REPLACEMENT-LAW-SW          PIC X.
   918             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   919             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   920         16  CF-REPLACEMENT-LETTER          PIC X(4).
   921         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   922         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   923         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   924         16  CF-ST-SPLIT-PAYMENT            PIC X.
   925         16  FILLER                         PIC X.
   926         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   927             20  CF-ST-BENEFIT-CD           PIC XX.
   928             20  CF-ST-BENEFIT-KIND         PIC X.
   929                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   930                 88  CF-ST-AH-KIND              VALUE 'A'.
   931             20  CF-ST-REM-TERM-CALC        PIC X.
   932                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   933                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   934                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   935                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   936                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   937                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   938                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   939                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   940
   941             20  CF-ST-REFUND-CALC          PIC X.
   942                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   943                 88  ST-REFD-BY-R78             VALUE '1'.
   944                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   945                 88  ST-REFD-AS-CALIF           VALUE '3'.
   946                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   947                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   948                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   949                 88  ST-REFD-UTAH               VALUE '7'.
   950                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   951                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   952                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   953
   954             20  CF-ST-EARNING-CALC         PIC X.
   955                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   956                 88  ST-EARN-BY-R78             VALUE '1'.
   957                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   958                 88  ST-EARN-AS-CALIF           VALUE '3'.
   959                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  19
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   960                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   961                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   962                 88  ST-EARN-MEAN               VALUE '8'.
   963                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   964
   965             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   966                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   967                 88  ST-OVRD-BY-R78             VALUE '1'.
   968                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   969                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   970                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   971                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   972                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   973                 88  ST-OVRD-MEAN               VALUE '8'.
   974                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   975             20  FILLER                     PIC X.
   976
   977         16  CF-ST-COMMISSION-CAPS.
   978             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   979             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   980             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   981             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   982         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   983                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   984
   985         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   986
   987         16  CF-ST-STATUTORY-INTEREST.
   988             20  CF-ST-STAT-DATE-FROM       PIC X.
   989                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   990                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   991             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   992             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   993             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   994             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   995             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   996
   997         16  CF-ST-OVER-SHORT.
   998             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   999             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1000
  1001         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1002
  1003         16  CF-ST-RT-CALC                  PIC X.
  1004
  1005         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1006         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1007         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1008         16  CF-ST-RF-LR-CALC               PIC X.
  1009         16  CF-ST-RF-LL-CALC               PIC X.
  1010         16  CF-ST-RF-LN-CALC               PIC X.
  1011         16  CF-ST-RF-AH-CALC               PIC X.
  1012         16  CF-ST-RF-CP-CALC               PIC X.
  1013*        16  FILLER                         PIC X(206).
  1014*CIDMOD         16  FILLER                         PIC X(192).
  1015         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1016             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1017         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  20
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1018         16  CF-ST-VFY-2ND-BENE             PIC X.
  1019         16  CF-ST-CAUSAL-STATE             PIC X.
  1020         16  FILLER                         PIC X(185).
  1021
  1022****************************************************************
  1023*             BENEFIT MASTER RECORD                            *
  1024****************************************************************
  1025
  1026     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1027         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1028             20  CF-BENEFIT-CODE            PIC XX.
  1029             20  CF-BENEFIT-NUMERIC  REDEFINES
  1030                 CF-BENEFIT-CODE            PIC XX.
  1031             20  CF-BENEFIT-ALPHA           PIC XXX.
  1032             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1033             20  CF-BENEFIT-COMMENT         PIC X(10).
  1034
  1035             20  CF-LF-COVERAGE-TYPE        PIC X.
  1036                 88  CF-REDUCING                VALUE 'R'.
  1037                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1038
  1039             20  CF-SPECIAL-CALC-CD         PIC X.
  1040                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1041                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1042                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1043                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1044                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1045                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1046                 88  CF-FARM-PLAN               VALUE 'F'.
  1047                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1048                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1049                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1050                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1051                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1052                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1053                 88  CF-PRUDENTIAL              VALUE 'P'.
  1054                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1055                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1056                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1057                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1058                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1059                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1060
  1061             20  CF-JOINT-INDICATOR         PIC X.
  1062                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1063
  1064*            20  FILLER                     PIC X(12).
  1065             20  FILLER                     PIC X(11).
  1066             20  CF-BENEFIT-CATEGORY        PIC X.
  1067             20  CF-LOAN-TYPE               PIC X(8).
  1068
  1069             20  CF-CO-REM-TERM-CALC        PIC X.
  1070                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1071                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1072                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1073                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1074                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1075
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  21
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1076             20  CF-CO-EARNINGS-CALC        PIC X.
  1077                 88  CO-EARN-BY-R78             VALUE '1'.
  1078                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1079                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1080                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1081                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1082                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1083                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1084                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1085
  1086             20  CF-CO-REFUND-CALC          PIC X.
  1087                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1088                 88  CO-REFD-BY-R78             VALUE '1'.
  1089                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1090                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1091                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1092                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1093                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1094                 88  CO-REFD-MEAN               VALUE '8'.
  1095                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1096                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1097                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1098
  1099             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1100                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1101                 88  CO-OVRD-BY-R78             VALUE '1'.
  1102                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1103                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1104                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1105                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1106                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1107                 88  CO-OVRD-MEAN               VALUE '8'.
  1108                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1109
  1110             20  CF-CO-BEN-I-G-CD           PIC X.
  1111                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1112                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1113                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1114
  1115         16  FILLER                         PIC X(304).
  1116
  1117
  1118****************************************************************
  1119*             CARRIER MASTER RECORD                            *
  1120****************************************************************
  1121
  1122     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1123         16  CF-ADDRESS-DATA.
  1124             20  CF-MAIL-TO-NAME            PIC X(30).
  1125             20  CF-IN-CARE-OF              PIC X(30).
  1126             20  CF-ADDRESS-LINE-1          PIC X(30).
  1127             20  CF-ADDRESS-LINE-2          PIC X(30).
  1128             20  CF-CITY-STATE              PIC X(30).
  1129             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1130             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1131
  1132         16  CF-CLAIM-NO-CONTROL.
  1133             20  CF-CLAIM-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  22
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1134                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1135                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1136                 88  CLAIM-NO-SEQ               VALUE '3'.
  1137                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1138             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1139                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1140                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1141                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1142
  1143         16  CF-CHECK-NO-CONTROL.
  1144             20  CF-CHECK-NO-METHOD         PIC X.
  1145                 88  CHECK-NO-MANUAL            VALUE '1'.
  1146                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1147                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1148                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1149             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1150                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1151
  1152         16  CF-DOMICILE-STATE              PIC XX.
  1153
  1154         16  CF-EXPENSE-CONTROLS.
  1155             20  CF-EXPENSE-METHOD          PIC X.
  1156                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1157                 88  DOLLARS-PER-PMT            VALUE '2'.
  1158                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1159                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1160             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1161             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1162
  1163         16  CF-CORRESPONDENCE-CONTROL.
  1164             20  CF-LETTER-RESEND-OPT       PIC X.
  1165                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1166                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1167             20  FILLER                     PIC X(4).
  1168
  1169         16  CF-RESERVE-CONTROLS.
  1170             20  CF-MANUAL-SW               PIC X.
  1171                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1172             20  CF-FUTURE-SW               PIC X.
  1173                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1174             20  CF-PTC-SW                  PIC X.
  1175                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1176             20  CF-IBNR-SW                 PIC X.
  1177                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1178             20  CF-PTC-LF-SW               PIC X.
  1179                 88  CF-LF-PTC-USED             VALUE '1'.
  1180             20  CF-CDT-ACCESS-METHOD       PIC X.
  1181                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1182                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1183                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1184             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1185
  1186         16  CF-CLAIM-CALC-METHOD           PIC X.
  1187             88  360-PLUS-MONTHS                VALUE '1'.
  1188             88  365-PLUS-MONTHS                VALUE '2'.
  1189             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1190             88  360-DAILY                      VALUE '4'.
  1191             88  365-DAILY                      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  23
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1192
  1193         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1194         16  FILLER                         PIC X(11).
  1195
  1196         16  CF-LIMIT-AMOUNTS.
  1197             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1198             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1199             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1200             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1201             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1202             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1203             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1204             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1205             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1206             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1207
  1208         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1209         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1210         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1211
  1212         16  CF-ZIP-CODE.
  1213             20  CF-ZIP-PRIME.
  1214                 24  CF-ZIP-1ST             PIC X.
  1215                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1216                 24  FILLER                 PIC X(4).
  1217             20  CF-ZIP-PLUS4               PIC X(4).
  1218         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1219             20  CF-CAN-POSTAL-1            PIC XXX.
  1220             20  CF-CAN-POSTAL-2            PIC XXX.
  1221             20  FILLER                     PIC XXX.
  1222
  1223         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1224         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1225         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1226
  1227         16  CF-RATING-SWITCH               PIC X.
  1228             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1229             88  CF-NO-RATING                   VALUE 'N'.
  1230
  1231         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1232
  1233         16  CF-CARRIER-OVER-SHORT.
  1234             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1235             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1236
  1237         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1238         16  CF-SECPAY-SWITCH               PIC X.
  1239             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1240             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1241         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1242         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1243         16  FILLER                         PIC X(444).
  1244*        16  FILLER                         PIC X(452).
  1245
  1246
  1247****************************************************************
  1248*             MORTALITY MASTER RECORD                          *
  1249****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  24
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1250
  1251     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1252         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1253                                INDEXED BY CF-MORT-NDX.
  1254             20  CF-MORT-TABLE              PIC X(5).
  1255             20  CF-MORT-TABLE-TYPE         PIC X.
  1256                 88  CF-MORT-JOINT              VALUE 'J'.
  1257                 88  CF-MORT-SINGLE             VALUE 'S'.
  1258                 88  CF-MORT-COMBINED           VALUE 'C'.
  1259                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1260                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1261             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1262             20  CF-MORT-AGE-METHOD         PIC XX.
  1263                 88  CF-AGE-LAST                VALUE 'AL'.
  1264                 88  CF-AGE-NEAR                VALUE 'AN'.
  1265             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1266             20  CF-MORT-ADJUSTMENT-DIRECTION
  1267                                            PIC X.
  1268                 88  CF-MINUS                   VALUE '-'.
  1269                 88  CF-PLUS                    VALUE '+'.
  1270             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1271             20  CF-MORT-JOINT-CODE         PIC X.
  1272                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1273             20  CF-MORT-PC-Q               PIC X.
  1274                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1275             20  CF-MORT-TABLE-CODE         PIC X(4).
  1276             20  CF-MORT-COMMENTS           PIC X(15).
  1277             20  FILLER                     PIC X(14).
  1278
  1279         16  FILLER                         PIC X(251).
  1280
  1281
  1282****************************************************************
  1283*             BUSSINESS TYPE MASTER RECORD                     *
  1284****************************************************************
  1285
  1286     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1287* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1288* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1289* AND RECORD 05 IS TYPES 81-99
  1290         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1291             20  CF-BUSINESS-TITLE          PIC  X(19).
  1292             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1293                                            PIC S9V9(4) COMP-3.
  1294             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1295             20  FILLER                     PIC  X.
  1296         16  FILLER                         PIC  X(248).
  1297
  1298
  1299****************************************************************
  1300*             TERMINAL MASTER RECORD                           *
  1301****************************************************************
  1302
  1303     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1304
  1305         16  CF-COMPANY-TERMINALS.
  1306             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1307                                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  25
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1308         16  FILLER               PIC X(248).
  1309
  1310
  1311****************************************************************
  1312*             LIFE EDIT MASTER RECORD                          *
  1313****************************************************************
  1314
  1315     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1316         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1317             20  CF-LIFE-CODE-IN            PIC XX.
  1318             20  CF-LIFE-CODE-OUT           PIC XX.
  1319         16  FILLER                         PIC X(248).
  1320
  1321
  1322****************************************************************
  1323*             AH EDIT MASTER RECORD                            *
  1324****************************************************************
  1325
  1326     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1327         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1328             20  CF-AH-CODE-IN              PIC XXX.
  1329             20  CF-AH-CODE-OUT             PIC XX.
  1330         16  FILLER                         PIC X(248).
  1331
  1332
  1333****************************************************************
  1334*             CREDIBILITY TABLES                               *
  1335****************************************************************
  1336
  1337     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1338         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1339                             INDEXED BY CF-CRDB-NDX.
  1340             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1341             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1342             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1343         16  FILLER                         PIC  X(332).
  1344
  1345
  1346****************************************************************
  1347*             REPORT CUSTOMIZATION RECORD                      *
  1348****************************************************************
  1349
  1350     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1351         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1352             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1353             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1354             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1355**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1356****       A T-TRANSFER.                                   ****
  1357             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1358
  1359         16  FILLER                         PIC XX.
  1360
  1361         16  CF-CARRIER-CNTL-OPT.
  1362             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1363                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1364                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1365             20  CF-CARRIER-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  26
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1366                                            PIC X.
  1367         16  CF-GROUP-CNTL-OPT.
  1368             20  CF-GROUP-OPT-SEQ           PIC 9.
  1369                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1370                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1371             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1372                                            PIC X(6).
  1373         16  CF-STATE-CNTL-OPT.
  1374             20  CF-STATE-OPT-SEQ           PIC 9.
  1375                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1376                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1377             20  CF-STATE-SELECT OCCURS 3 TIMES
  1378                                            PIC XX.
  1379         16  CF-ACCOUNT-CNTL-OPT.
  1380             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1381                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1382                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1383             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1384                                            PIC X(10).
  1385         16  CF-BUS-TYP-CNTL-OPT.
  1386             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1387                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1388                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1389             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1390                                            PIC XX.
  1391         16  CF-LF-TYP-CNTL-OPT.
  1392             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1393                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1394                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1395             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1396                                            PIC XX.
  1397         16  CF-AH-TYP-CNTL-OPT.
  1398             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1399                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1400                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1401             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1402                                            PIC XX.
  1403         16  CF-REPTCD1-CNTL-OPT.
  1404             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1405                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1406                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1407             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1408                                            PIC X(10).
  1409         16  CF-REPTCD2-CNTL-OPT.
  1410             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1411                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1412                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1413             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1414                                            PIC X(10).
  1415         16  CF-USER1-CNTL-OPT.
  1416             20  CF-USER1-OPT-SEQ           PIC 9.
  1417                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1418                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1419             20  CF-USER1-SELECT OCCURS 3 TIMES
  1420                                            PIC X(10).
  1421         16  CF-USER2-CNTL-OPT.
  1422             20  CF-USER2-OPT-SEQ           PIC 9.
  1423                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  27
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1424                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1425             20  CF-USER2-SELECT OCCURS 3 TIMES
  1426                                            PIC X(10).
  1427         16  CF-USER3-CNTL-OPT.
  1428             20  CF-USER3-OPT-SEQ           PIC 9.
  1429                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1430                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1431             20  CF-USER3-SELECT OCCURS 3 TIMES
  1432                                            PIC X(10).
  1433         16  CF-USER4-CNTL-OPT.
  1434             20  CF-USER4-OPT-SEQ           PIC 9.
  1435                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1436                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1437             20  CF-USER4-SELECT OCCURS 3 TIMES
  1438                                            PIC X(10).
  1439         16  CF-USER5-CNTL-OPT.
  1440             20  CF-USER5-OPT-SEQ           PIC 9.
  1441                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1442                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1443             20  CF-USER5-SELECT OCCURS 3 TIMES
  1444                                            PIC X(10).
  1445         16  CF-REINS-CNTL-OPT.
  1446             20  CF-REINS-OPT-SEQ           PIC 9.
  1447                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1448                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1449             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1450                 24  CF-REINS-PRIME         PIC XXX.
  1451                 24  CF-REINS-SUB           PIC XXX.
  1452
  1453         16  CF-AGENT-CNTL-OPT.
  1454             20  CF-AGENT-OPT-SEQ           PIC 9.
  1455                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1456                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1457             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1458                                            PIC X(10).
  1459
  1460         16  FILLER                         PIC X(43).
  1461
  1462         16  CF-LOSS-RATIO-SELECT.
  1463             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1464             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1465         16  CF-ENTRY-DATE-SELECT.
  1466             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1467             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1468         16  CF-EFFECTIVE-DATE-SELECT.
  1469             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1470             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1471
  1472         16  CF-EXCEPTION-LIST-IND          PIC X.
  1473             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1474
  1475         16  FILLER                         PIC X(318).
  1476
  1477****************************************************************
  1478*                  EXCEPTION REPORTING RECORD                  *
  1479****************************************************************
  1480
  1481     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  28
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1482         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1483             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1484
  1485         16  CF-COMBINED-LIFE-AH-OPT.
  1486             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1487             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1488             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1489             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1490
  1491         16  CF-LIFE-OPT.
  1492             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1493             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1494             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1495             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1496             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1497             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1498             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1499             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1500             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1501             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1502
  1503         16  CF-AH-OPT.
  1504             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1505             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1506             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1507             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1508             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1509             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1510             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1511             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1512             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1513             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1514
  1515         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1516             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1517             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1518             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1519
  1520         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1521
  1522         16  FILLER                         PIC X(673).
  1523
  1524
  1525****************************************************************
  1526*             MORTGAGE SYSTEM PLAN RECORD                      *
  1527****************************************************************
  1528
  1529     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1530         16  CF-PLAN-TYPE                   PIC X.
  1531             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1532             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1533             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1534         16  CF-PLAN-ABBREV                 PIC XXX.
  1535         16  CF-PLAN-DESCRIPT               PIC X(10).
  1536         16  CF-PLAN-NOTES                  PIC X(20).
  1537         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1538         16  CF-PLAN-UNDERWRITING.
  1539             20  CF-PLAN-TERM-DATA.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  29
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1540                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1541                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1542             20  CF-PLAN-AGE-DATA.
  1543                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1544                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1545                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1546             20  CF-PLAN-BENEFIT-DATA.
  1547                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1548                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1549                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1550                                            PIC S9(7)V99  COMP-3.
  1551         16  CF-PLAN-POLICY-FORMS.
  1552             20  CF-POLICY-FORM             PIC X(12).
  1553             20  CF-MASTER-APPLICATION      PIC X(12).
  1554             20  CF-MASTER-POLICY           PIC X(12).
  1555         16  CF-PLAN-RATING.
  1556             20  CF-RATE-CODE               PIC X(5).
  1557             20  CF-SEX-RATING              PIC X.
  1558                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1559                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1560             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1561             20  CF-SUB-STD-TYPE            PIC X.
  1562                 88  CF-PCT-OF-PREM            VALUE '1'.
  1563                 88  CF-PCT-OF-BENE            VALUE '2'.
  1564         16  CF-PLAN-PREM-TOLERANCES.
  1565             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1566             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1567         16  CF-PLAN-PYMT-TOLERANCES.
  1568             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1569             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1570         16  CF-PLAN-MISC-DATA.
  1571             20  FILLER                     PIC X.
  1572             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1573             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1574         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1575         16  CF-PLAN-IND-GRP                PIC X.
  1576             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1577                                                     '1'.
  1578             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1579                                                     '2'.
  1580         16  CF-MIB-SEARCH-SW               PIC X.
  1581             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1582             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1583             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1584             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1585         16  CF-ALPHA-SEARCH-SW             PIC X.
  1586             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1587             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1588             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1589             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1590             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1591             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1592             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1593             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1594             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1595             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1596                                                     'A' 'B' 'C'
  1597                                                     'X' 'Y' 'Z'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  30
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1598         16  CF-EFF-DT-RULE-SW              PIC X.
  1599             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1600             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1601             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1602             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1603             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1604         16  FILLER                         PIC X(4).
  1605         16  CF-HEALTH-QUESTIONS            PIC X.
  1606             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1607         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1608         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1609         16  CF-PLAN-SNGL-JNT               PIC X.
  1610             88  CF-COMBINED-PLAN              VALUE 'C'.
  1611             88  CF-JNT-PLAN                   VALUE 'J'.
  1612             88  CF-SNGL-PLAN                  VALUE 'S'.
  1613         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1614         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1615         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1616         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1617         16  CF-RERATE-CNTL                 PIC  X.
  1618             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1619             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1620             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1621             88  CF-AUTO-RECALC                 VALUE '4'.
  1622         16  CF-BENEFIT-TYPE                PIC  X.
  1623             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1624             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1625         16  CF-POLICY-FEE                  PIC S999V99
  1626                                                    COMP-3.
  1627         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1628         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1629         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1630         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1631         16  FILLER                         PIC  X(32).
  1632         16  CF-TERMINATION-FORM            PIC  X(04).
  1633         16  FILLER                         PIC  X(08).
  1634         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1635                                                       COMP-3.
  1636         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1637         16  CF-ISSUE-LETTER                PIC  X(4).
  1638         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1639         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1640             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1641             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1642         16  CF-MP-REFUND-CALC              PIC X.
  1643             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1644             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1645             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1646             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1647             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1648             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1649             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1650             88  CF-MP-REFD-MEAN                VALUE '8'.
  1651         16  CF-ALT-RATE-CODE               PIC  X(5).
  1652
  1653
  1654         16  FILLER                         PIC X(498).
  1655****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  31
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1656*             MORTGAGE COMPANY MASTER RECORD                   *
  1657****************************************************************
  1658
  1659     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1660         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1661         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1662             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1663             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1664             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1665             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1666             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1667
  1668         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1669         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1670         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1671         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1672         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1673
  1674         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1675             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1676         16  CF-MP-RECON-USE-IND            PIC X(1).
  1677             88  CF-MP-USE-RECON             VALUE 'Y'.
  1678         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1679             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1680         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1681             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1682             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1683         16  FILLER                         PIC X(1).
  1684         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1685             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1686         16  CF-MORTG-MIB-VERSION           PIC X.
  1687             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1688             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1689             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1690         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1691             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1692                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1693             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1694                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1695             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1696                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1697             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1698                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1699             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1700                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1701             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1702                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1703         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1704         16  FILLER                         PIC X(7).
  1705         16  CF-MORTG-DESTINATION-SYMBOL.
  1706             20  CF-MORTG-MIB-COMM          PIC X(5).
  1707             20  CF-MORTG-MIB-TERM          PIC X(5).
  1708         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1709             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1710         16  FILLER                         PIC X(03).
  1711         16  CF-MP-CHECK-NO-CONTROL.
  1712             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1713                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  32
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1714                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1715                                                ' ' LOW-VALUES.
  1716                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1717                                               VALUE '3'.
  1718         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1719         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1720         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1721             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1722                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1723             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1724                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1725             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1726                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1727             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1728                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1729             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1730                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1731             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1732                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1733         16  CF-MORTG-BILLING-AREA.
  1734             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1735                                            PIC X.
  1736         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1737         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1738         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1739         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1740             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1741             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1742         16  FILLER                         PIC X.
  1743         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1744             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1745             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1746         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1747         16  FILLER                         PIC X(8).
  1748         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1749         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1750         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1751         16  CF-ACH-COMPANY-ID.
  1752             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1753                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1754                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1755                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1756             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1757         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1758             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1759         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1760             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1761             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1762         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1763         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1764         16  FILLER                         PIC X(536).
  1765
  1766****************************************************************
  1767*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1768****************************************************************
  1769
  1770     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1771         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  33
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1772             20  CF-FEMALE-HEIGHT.
  1773                 24  CF-FEMALE-FT           PIC 99.
  1774                 24  CF-FEMALE-IN           PIC 99.
  1775             20  CF-FEMALE-MIN-WT           PIC 999.
  1776             20  CF-FEMALE-MAX-WT           PIC 999.
  1777         16  FILLER                         PIC X(428).
  1778
  1779     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1780         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1781             20  CF-MALE-HEIGHT.
  1782                 24  CF-MALE-FT             PIC 99.
  1783                 24  CF-MALE-IN             PIC 99.
  1784             20  CF-MALE-MIN-WT             PIC 999.
  1785             20  CF-MALE-MAX-WT             PIC 999.
  1786         16  FILLER                         PIC X(428).
  1787******************************************************************
  1788*             AUTOMATIC ACTIVITY RECORD                          *
  1789******************************************************************
  1790     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1791         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1792             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1793             20  CF-SYS-LETTER-ID           PIC X(04).
  1794             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1795             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1796             20  CF-SYS-RESET-SW            PIC X(01).
  1797             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1798             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1799
  1800         16  FILLER                         PIC X(50).
  1801
  1802         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1803             20  CF-USER-ACTIVE-SW          PIC X(01).
  1804             20  CF-USER-LETTER-ID          PIC X(04).
  1805             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1806             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1807             20  CF-USER-RESET-SW           PIC X(01).
  1808             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1809             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1810             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1811
  1812         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  34
* EL517.cbl
  1814 FD  ERPNDB.
* 1815                                  COPY ERCPNDB.
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*                            ERCPNDB.                            *
  1820*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1821*                            VMOD=2.025                          *
  1822*                                                                *
  1823*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1824*                                                                *
  1825******************************************************************
  1826*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1827*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1828******************************************************************
  1829*                                                                *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1833*                                                                *
  1834*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1835*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1836*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1837*                                                 RKP=13,LEN=36  *
  1838*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1839*                                      AND CHG-SEQ.)             *
  1840*                                                RKP=49,LEN=11   *
  1841*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1842*                                      AND CHG-SEQ.)             *
  1843*                                                RKP=60,LEN=15   *
  1844*                                                                *
  1845*   LOG = NO                                                     *
  1846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1847******************************************************************
  1848******************************************************************
  1849*                   C H A N G E   L O G
  1850*
  1851* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1852*-----------------------------------------------------------------
  1853*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1854* EFFECTIVE    NUMBER
  1855*-----------------------------------------------------------------
  1856* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1857* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1858* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1859* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1860* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1861* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1862* 032306                   PEMA  ADD BOW LOAN NUMBER
  1863* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1864* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1865* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1866* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1867* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1868* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1869* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1870* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1871******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1872
  1873 01  PENDING-BUSINESS.
  1874     12  PB-RECORD-ID                     PIC XX.
  1875         88  VALID-PB-ID                        VALUE 'PB'.
  1876
  1877     12  PB-CONTROL-PRIMARY.
  1878         16  PB-COMPANY-CD                PIC X.
  1879         16  PB-ENTRY-BATCH               PIC X(6).
  1880         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1881         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1882
  1883     12  PB-CONTROL-BY-ACCOUNT.
  1884         16  PB-COMPANY-CD-A1             PIC X.
  1885         16  PB-CARRIER                   PIC X.
  1886         16  PB-GROUPING.
  1887             20  PB-GROUPING-PREFIX       PIC XXX.
  1888             20  PB-GROUPING-PRIME        PIC XXX.
  1889         16  PB-STATE                     PIC XX.
  1890         16  PB-ACCOUNT.
  1891             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1892             20  PB-ACCOUNT-PRIME         PIC X(6).
  1893         16  PB-CERT-EFF-DT               PIC XX.
  1894         16  PB-CERT-NO.
  1895             20  PB-CERT-PRIME            PIC X(10).
  1896             20  PB-CERT-SFX              PIC X.
  1897         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1898
  1899         16  PB-RECORD-TYPE               PIC X.
  1900             88  PB-MAILING-DATA                VALUE '0'.
  1901             88  PB-ISSUE                       VALUE '1'.
  1902             88  PB-CANCELLATION                VALUE '2'.
  1903             88  PB-BATCH-TRAILER               VALUE '9'.
  1904
  1905     12  PB-CONTROL-BY-ORIG-BATCH.
  1906         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1907         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1908         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1909         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1910
  1911     12  PB-CONTROL-BY-CSR.
  1912         16  PB-CSR-COMPANY-CD            PIC X.
  1913         16  PB-CSR-ID                    PIC X(4).
  1914         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1915         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1916         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1917******************************************************************
  1918*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1919******************************************************************
  1920
  1921     12  PB-LAST-MAINT-DT                 PIC XX.
  1922     12  PB-LAST-MAINT-BY                 PIC X(4).
  1923     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1924
  1925     12  PB-RECORD-BODY                   PIC X(375).
  1926
  1927     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1928         16  PB-CERT-ORIGIN               PIC X.
  1929             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1930         16  PB-I-NAME.
  1931             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1932             20  PB-I-INSURED-FIRST-NAME.
  1933                 24  PB-I-INSURED-1ST-INIT PIC X.
  1934                 24  FILLER                PIC X(9).
  1935             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1936         16  PB-I-AGE                     PIC S99   COMP-3.
  1937         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1938         16  PB-I-BIRTHDAY                PIC XX.
  1939         16  PB-I-INSURED-SEX             PIC X.
  1940             88  PB-SEX-MALE     VALUE 'M'.
  1941             88  PB-SEX-FEMALE   VALUE 'F'.
  1942
  1943         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1944         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1945         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1946         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1947         16  PB-I-SKIP-CODE               PIC X.
  1948             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1949             88  PB-SKIP-JULY              VALUE '1'.
  1950             88  PB-SKIP-AUGUST            VALUE '2'.
  1951             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1952             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1953             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1954             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1955             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1956             88  PB-SKIP-JUNE              VALUE '8'.
  1957             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1958             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1959             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1960         16  PB-I-TERM-TYPE               PIC X.
  1961             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1962             88  PB-PAID-WEEKLY            VALUE 'W'.
  1963             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1964             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1965             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1966         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1967         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1968         16  PB-I-DATA-ENTRY-SW           PIC X.
  1969             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1970             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1971             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1972             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1973         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1974         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1975*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1976         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1977         16  FILLER                       PIC X.
  1978
  1979         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1980             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1981             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1982                                                   '90' THRU '99'.
  1983         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1984                                          PIC XX.
  1985         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1986         16  PB-I-AMOUNT-FINANCED REDEFINES
  1987                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1988         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1989         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1990                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1991         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1992         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1993         16  PB-I-CLP-AMOUNT REDEFINES
  1994                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1995         16  PB-I-LF-CALC-FLAG            PIC X.
  1996             88 PB-COMP-LF-PREM               VALUE '?'.
  1997         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1998         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1999         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2000         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2001         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2002         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2003         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2004         16  PB-I-LF-ABBR                 PIC XXX.
  2005         16  PB-I-LF-INPUT-CD             PIC XX.
  2006
  2007         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2008             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2009             88  PB-INVALID-AH               VALUE '  ' '00'
  2010                                                   '90' THRU '99'.
  2011         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2012         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2013         16  PB-I-AH-CALC-FLAG            PIC X.
  2014             88 PB-COMP-AH-PREM                  VALUE '?'.
  2015         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2016         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2017         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2018         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2019         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2020         16  PB-I-AH-ABBR                 PIC XXX.
  2021         16  PB-I-AH-INPUT-CD             PIC XXX.
  2022
  2023         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2024         16  PB-I-REIN-TABLE              PIC XXX.
  2025         16  PB-I-BUSINESS-TYPE           PIC 99.
  2026         16  PB-I-INDV-GRP-CD             PIC X.
  2027         16  PB-I-MORT-CODE.
  2028             20  PB-I-TABLE               PIC X.
  2029             20  PB-I-INTEREST            PIC XX.
  2030             20  PB-I-MORT-TYP            PIC X.
  2031         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2032         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2033         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2034         16  PB-I-INDV-GRP-OVRD           PIC X.
  2035         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2036         16  PB-I-SIG-SW                  PIC X.
  2037             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2038         16  PB-I-RATE-CLASS              PIC XX.
  2039         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2040         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2041         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2042         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2043         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2044         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2045         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2046         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2047         16  PB-I-OB-FLAG                 PIC X.
  2048             88  PB-I-OB                      VALUE 'B'.
  2049             88  PB-I-SUMMARY                 VALUE 'Z'.
  2050         16  PB-I-ENTRY-STATUS            PIC X.
  2051             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2052                                              'M' '5' '9' '2'.
  2053             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2054             88  PB-I-POLICY-PENDING          VALUE '2'.
  2055             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2056             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2057             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2058             88  PB-I-REIN-ONLY               VALUE '9'.
  2059             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2060             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2061             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2062             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2063         16  PB-I-INT-CODE                PIC X.
  2064             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2065             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2066         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2067         16  PB-I-SOC-SEC-NO              PIC X(11).
  2068         16  PB-I-MEMBER-NO               PIC X(12).
  2069         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2070*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2071         16  PB-I-OLD-LOF                 PIC XXX.
  2072         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2073         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2074         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2075         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2076         16  PB-I-LIFE-INDICATOR          PIC X.
  2077             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2078         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2079         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2080                                          PIC S9(5)V99    COMP-3.
  2081         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2082             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2083             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2084         16  PB-I-1ST-PMT-DT              PIC XX.
  2085         16  PB-I-JOINT-INSURED.
  2086             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2087             20 PB-I-JOINT-FIRST-NAME.
  2088                24  PB-I-JOINT-FIRST-INIT PIC X.
  2089                24  FILLER                PIC X(9).
  2090             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2091*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2092         16  PB-I-BENEFICIARY-NAME.
  2093             20  PB-I-BANK-NUMBER         PIC X(10).
  2094             20  FILLER                   PIC X(15).
  2095         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2096         16  PB-I-REFERENCE               PIC X(12).
  2097         16  FILLER REDEFINES PB-I-REFERENCE.
  2098             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2099             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2100             20  PB-I-CLP-STATE           PIC XX.
  2101         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2102             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2103             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2104             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2105         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2106         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2107         16  PB-I-RESIDENT-STATE          PIC XX.
  2108         16  PB-I-RATE-CODE               PIC X(4).
  2109         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2110         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2111         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2112         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2113         16  PB-I-BANK-NOCHRGB            PIC 99.
  2114         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2115         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2116
  2117     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2118         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2119             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2120         16  PB-C-CANCEL-ORIGIN           PIC X.
  2121             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2122         16  PB-C-LF-CANCEL-DT            PIC XX.
  2123         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2124         16  PB-C-LF-CALC-REQ             PIC X.
  2125             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2126         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2127         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2128         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2129             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2130         16  PB-C-AH-CANCEL-DT            PIC XX.
  2131         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2132         16  PB-C-AH-CALC-REQ             PIC X.
  2133             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2134         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2135         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2136         16  PB-C-LAST-NAME               PIC X(15).
  2137         16  PB-C-REFUND-SW               PIC X.
  2138             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2139             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2140         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2141         16  PB-C-PAYEE-CODE              PIC X(6).
  2142         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2143         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2144         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2145         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2146         16  PB-C-REFERENCE               PIC X(12).
  2147         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2148         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2149         16  PB-C-POST-CARD-IND           PIC X.
  2150         16  PB-C-CANCEL-REASON           PIC X.
  2151         16  PB-C-REF-INTERFACE-SW        PIC X.
  2152         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2153         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2154         16  FILLER                       PIC X(01).
  2155*        16  FILLER                       PIC X(18).
  2156         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2157*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2158         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2159         16  PB-CANCELED-CERT-DATA.
  2160             20  PB-CI-INSURED-NAME.
  2161                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2162                 24  PB-CI-INITIALS       PIC XX.
  2163             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2164             20  PB-CI-INSURED-SEX        PIC X.
  2165             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2166             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2167             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2168             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2169             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2170             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2171             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2172             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2173             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2174             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2175             20  PB-CI-RATE-CLASS         PIC XX.
  2176             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2177             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2178             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2179             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2180             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2181             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2182             20  PB-CI-LF-ABBR            PIC X(3).
  2183             20  PB-CI-AH-ABBR            PIC X(3).
  2184             20  PB-CI-OB-FLAG            PIC X.
  2185                 88  PB-CI-OB                VALUE 'B'.
  2186             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2187                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2188                                           'M' '4' '5' '9' '2'.
  2189                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2190                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2191                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2192                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2193                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2194                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2195                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2196                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2197                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2198                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2199                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2200                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2201             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2202                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2203                                           'M' '4' '5' '9' '2'.
  2204                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2205                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2206                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2207                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2208                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2209                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2210                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2211                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2212                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2213                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2214                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2215                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2216             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2217             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2218             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2219             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2220             20  PB-CI-INT-CODE           PIC X.
  2221                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2222                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2223             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2224             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2225             20  PB-CI-COMP-EXCP-SW       PIC X.
  2226                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2227                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2228             20  PB-CI-ENTRY-STATUS       PIC X.
  2229             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2230             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2231             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2232             20  PB-CI-DEATH-DT           PIC XX.
  2233             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2234             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2235             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2236             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2237             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2238             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2239             20  PB-CI-ENTRY-DT              PIC XX.
  2240             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2241             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2242             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2243             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2244             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2245             20  PB-CI-OLD-LOF               PIC XXX.
  2246*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2247             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2248             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2249             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2250             20  PB-CI-INDV-GRP-CD           PIC X.
  2251             20  PB-CI-BENEFICIARY-NAME.
  2252                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2253                 24  FILLER                  PIC X(15).
  2254             20  PB-CI-NOTE-SW               PIC X.
  2255             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2256             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2257             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2258             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2259             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2260             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2261             20  PB-CI-FIRST-NAME            PIC X(10).
  2262             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2263
  2264         16  FILLER                       PIC X(13).
  2265*032306  16  FILLER                       PIC X(27).
  2266*        16  FILLER                       PIC X(46).
  2267
  2268     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2269         16  FILLER                       PIC X(10).
  2270         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2271         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2272         16  PB-M-INSURED-MID-INIT        PIC X.
  2273         16  PB-M-INSURED-AGE             PIC 99.
  2274         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2275         16  PB-M-INSURED-SEX             PIC X.
  2276         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2277         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2278         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2279         16  PB-M-INSURED-CITY-STATE.
  2280             20  PB-M-INSURED-CITY        PIC X(28).
  2281             20  PB-M-INSURED-STATE       PIC XX.
  2282         16  PB-M-INSURED-ZIP-CODE.
  2283             20  PB-M-INSURED-ZIP-PRIME.
  2284                 24  PB-M-INSURED-ZIP-1   PIC X.
  2285                     88  PB-M-CANADIAN-POST-CODE
  2286                                             VALUE 'A' THRU 'Z'.
  2287                 24  FILLER               PIC X(4).
  2288             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2289         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2290                                        PB-M-INSURED-ZIP-CODE.
  2291             20  PM-M-INS-CAN-POST1       PIC XXX.
  2292             20  PM-M-INS-CAN-POST2       PIC XXX.
  2293             20  FILLER                   PIC XXX.
  2294         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2295         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2296         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2297         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2298         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2299         16  PB-M-CRED-BENE-CITYST.
  2300             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2301             20  PB-M-CRED-BENE-STATE     PIC XX.
  2302
  2303         16  FILLER                       PIC X(92).
  2304
  2305     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2306         16  FILLER                       PIC X(10).
  2307         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2308         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2309         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2310         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2311         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2312         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2313         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2314         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2315         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2316         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2317         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2318         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2319         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2320         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2321         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2322         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2323         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2324         16  PB-ACCOUNT-NAME              PIC X(30).
  2325         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2326         16  PB-REFERENCE                 PIC X(12).
  2327         16  PB-B-RECEIVED-DT             PIC XX.
  2328         16  FILLER                       PIC X(234).
  2329
  2330     12  PB-RECORD-STATUS.
  2331         16  PB-CREDIT-SELECT-DT          PIC XX.
  2332         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2333         16  PB-BILLED-DT                 PIC XX.
  2334         16  PB-BILLING-STATUS            PIC X.
  2335             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2336             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2337             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2338         16  PB-RECORD-BILL               PIC X.
  2339             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2340             88  PB-RECORD-RETURNED           VALUE 'R'.
  2341             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2342             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2343             88  PB-OVERRIDE-AH               VALUE 'A'.
  2344             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2345         16  PB-BATCH-ENTRY               PIC X.
  2346             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2347             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2348             88  PB-REISSUED-CERT             VALUE 'E'.
  2349             88  PB-MONTHLY-CERT              VALUE 'M'.
  2350             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2351             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2352             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2353         16  PB-FORCE-CODE                PIC X.
  2354             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2355             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2356             88  PB-CANCEL-FORCE              VALUE '8'.
  2357             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2358             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2359             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2360             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2361             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2362             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2363             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2364         16  PB-FATAL-FLAG                PIC X.
  2365             88  PB-FATAL-ERRORS              VALUE 'X'.
  2366         16  PB-FORCE-ER-CD               PIC X.
  2367             88  PB-FORCE-ERRORS              VALUE 'F'.
  2368             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2369         16  PB-WARN-ER-CD                PIC X.
  2370             88  PB-WARNING-ERRORS            VALUE 'W'.
  2371         16  FILLER                       PIC X.
  2372         16  PB-OUT-BAL-CD                PIC X.
  2373             88  PB-OUT-OF-BAL                VALUE 'O'.
  2374         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2375         16  PB-AH-OVERRIDE-L1            PIC X.
  2376         16  PB-INPUT-DT                  PIC XX.
  2377         16  PB-INPUT-BY                  PIC X(4).
  2378         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2379         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2380         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2381         16  PB-LF-EARNING-METHOD         PIC X.
  2382         16  PB-AH-EARNING-METHOD         PIC X.
  2383         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2384         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2385         16  PB-REIN-CD                   PIC XXX.
  2386         16  PB-LF-REFUND-TYPE            PIC X.
  2387         16  PB-AH-REFUND-TYPE            PIC X.
  2388         16  PB-ACCT-EFF-DT               PIC XX.
  2389         16  PB-ACCT-EXP-DT               PIC XX.
  2390         16  PB-COMPANY-ID                PIC X(3).
  2391         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2392         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2393         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2394         16  PB-SV-GROUPING               PIC X(6).
  2395         16  PB-SV-STATE                  PIC XX.
  2396         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2397         16  PB-GA-BILLING-INFO.
  2398             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2399                                          PIC XX.
  2400         16  PB-SV-REMIT-TO  REDEFINES
  2401             PB-GA-BILLING-INFO           PIC X(10).
  2402         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2403         16  PB-I-LOAN-OFFICER            PIC X(5).
  2404         16  PB-I-VIN                     PIC X(17).
  2405
  2406         16  FILLER                       PIC X(04).
  2407         16  IMNET-BYPASS-SW              PIC X.
  2408
  2409******************************************************************
  2410*                COMMON EDIT ERRORS                              *
  2411******************************************************************
  2412
  2413     12  PB-COMMON-ERRORS.
  2414         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2415                                           PIC S9(4)     COMP.
  2416
  2417******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  45
* EL517.cbl
  2419 FD  ERREIN.
* 2420                                  COPY ERCREIN.
  2421******************************************************************07/27/93
  2422*                                                                *ERCREIN
  2423*                            ERCREIN                             *   LV009
  2424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2425*                            VMOD=2.010                          *   CL**9
  2426*                                                                *ERCREIN
  2427*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2428*                                                                *ERCREIN
  2429*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2430*                                                                *ERCREIN
  2431*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2432*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2433*                                                                *ERCREIN
  2434*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2435*       ALTERNATE PATH = NONE                                    *ERCREIN
  2436*                                                                *ERCREIN
  2437*   LOG = NO                                                     *ERCREIN
  2438*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2439*                                                                *ERCREIN
  2440******************************************************************ERCREIN
  2441*                   C H A N G E   L O G
  2442*
  2443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2444*-----------------------------------------------------------------
  2445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2446* EFFECTIVE    NUMBER
  2447*-----------------------------------------------------------------
  2448* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2449* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2450******************************************************************
  2451 01  REINSURANCE-RECORD.                                          ERCREIN
  2452     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2453         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2454                                                                  ERCREIN
  2455     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2456         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2457         16  RE-KEY.                                              ERCREIN
  2458             20  RE-CODE                   PIC X.                 ERCREIN
  2459                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2460                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2461             20  RE-TABLE                  PIC XXX.               ERCREIN
  2462             20  FILLER                    PIC XXX.               ERCREIN
  2463         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2464             20  FILLER                    PIC X.                 ERCREIN
  2465             20  RE-COMPANY.                                      ERCREIN
  2466                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2467                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2468                                                                  ERCREIN
  2469     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2470         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2471         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2472         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2473         16  FILLER                        PIC X(10).             ERCREIN
  2474                                                                  ERCREIN
  2475     12  RE-TABLE-DATA.                                           ERCREIN
  2476         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2477                                                                  ERCREIN
  2478         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2479             20  RE-REI-COMP-NO.                                  ERCREIN
  2480                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2481                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2482             20  RE-LF-QC                  PIC X.                 ERCREIN
  2483             20  RE-AH-QC                  PIC X.                 ERCREIN
  2484             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2485             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2486             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2487             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2488             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2489             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2490             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2491             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2492             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2493             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2494             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2495             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2496             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2497             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2498             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2499             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2500             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2501             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2502             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2503             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2504             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2505             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2506             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2507             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2508             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2509             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2510             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2511             20  RE-REMAINING              PIC X.                 ERCREIN
  2512             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2513             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2514             20  FILLER                    PIC X(19).                  000
  2515                                                                  ERCREIN
  2516         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2517         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2518         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2519         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2520             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2521                                                                  ERCREIN
  2522         16  FILLER                        PIC X(27).             ERCREIN
  2523                                                                  ERCREIN
  2524     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2525         16  RE-NAME                       PIC X(30).             ERCREIN
  2526         16  RE-LF-PE                      PIC X.                 ERCREIN
  2527         16  RE-AH-PE                      PIC X.                 ERCREIN
  2528         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2529         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2530         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2531         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2532         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2533         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2534         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2535         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2536         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2537         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2538         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2539         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2540         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2541         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2542         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2543         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2544         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2545         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2546                                                                  ERCREIN
  2547         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2548             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2549                                                                  ERCREIN
  2550         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2551             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2552                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2553                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2554                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2555                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2556             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2557                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2558                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2559                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2560                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2561                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2562                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2563                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2564                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2565             20  FILLER                    PIC XXX.               ERCREIN
  2566             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2567                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2568                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2569                                                                  ERCREIN
  2570         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2571             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2572                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2573                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2574                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2575                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2576             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2577                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2578                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2579                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2580                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2581                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2582                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2583                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2584                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2585             20  FILLER                    PIC XXX.               ERCREIN
  2586             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2587                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2588                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2589                                                                  ERCREIN
  2590         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2591                                                                  ERCREIN
  2592         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2593                                                                  ERCREIN
  2594         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2595         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2596         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2597         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2598         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2599         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2600         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2601         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2602         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2603             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2604             88  RE-CEDED                          VALUE 'C'.        CL**2
  2605             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2606             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2607                                                                  ERCREIN
  2608         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2609             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2610         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2611             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2612         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2613             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2614         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2615             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2616         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2617             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2618                                                                     CL**3
  2619         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2620                                                                     CL**5
  2621         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2622                                                                     CL**8
  2623         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2624                                                                     CL**8
  2625         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2626                                                                     CL**9
  2627         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2628             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2629             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2630
  2631         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2632             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2633                                                                     CL**9
  2634         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2635         16  FILLER                        PIC X(2281).              CL**9
  2636                                                                  ERCREIN
  2637         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2638                                                                  ERCREIN
  2639******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  49
* EL517.cbl
  2641 FD  ELCERT.
* 2642                                  COPY ELCCERT.
  2643******************************************************************04/15/98
  2644*                                                                *ELCCERT
  2645*                            ELCCERT.                            *   LV002
  2646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2647*                            VMOD=2.013                          *   CL**2
  2648*                                                                *ELCCERT
  2649*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2650*                                                                *ELCCERT
  2651*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2652*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2653*                                                                *ELCCERT
  2654*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2655*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2656*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2657*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2658*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2659*                                                                *ELCCERT
  2660*   LOG = YES                                                    *ELCCERT
  2661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2662******************************************************************
  2663*                   C H A N G E   L O G
  2664*
  2665* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2666*-----------------------------------------------------------------
  2667*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2668* EFFECTIVE    NUMBER
  2669*-----------------------------------------------------------------
  2670* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2671* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2672* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2673* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2674* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2675* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2676* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2677* 032612  CR2011110200001  PEMA  AHL CHANGES
  2678******************************************************************
  2679                                                                  ELCCERT
  2680 01  CERTIFICATE-MASTER.                                          ELCCERT
  2681     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2682         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2683                                                                  ELCCERT
  2684     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2685         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2686         16  CM-CARRIER                    PIC X.                 ELCCERT
  2687         16  CM-GROUPING.                                         ELCCERT
  2688             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2689             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2690         16  CM-STATE                      PIC XX.                ELCCERT
  2691         16  CM-ACCOUNT.                                          ELCCERT
  2692             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2693             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2694         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2695         16  CM-CERT-NO.                                          ELCCERT
  2696             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2697             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2698                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2699     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2700         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2701         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2702         16  CM-INSURED-INITIALS.                                 ELCCERT
  2703             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2704             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2705                                                                  ELCCERT
  2706     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2707         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2708         16  CM-SOC-SEC-NO.                                       ELCCERT
  2709             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2710             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2711             20  CM-SSN-LN3.                                      ELCCERT
  2712                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2713                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2714                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2715                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2716                                                                  ELCCERT
  2717     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2718         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2719         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2720                                                                  ELCCERT
  2721     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2722         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2723         16  CM-MEMBER-NO.                                        ELCCERT
  2724             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2725             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2726             20  CM-MEMB-LN4.                                     ELCCERT
  2727                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2728                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2729                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2730                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2731                                                                  ELCCERT
  2732     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2733         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2734             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2735             20  FILLER                    PIC X(9).              ELCCERT
  2736         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2737         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2738             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2739             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2740         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2741         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2742             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2743             20  CM-JT-FIRST-NAME.                                ELCCERT
  2744                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2745                 24  FILLER                PIC X(9).              ELCCERT
  2746             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2747                                                                  ELCCERT
  2748     12  CM-LIFE-DATA.                                            ELCCERT
  2749         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2750         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2751         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2752         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2753         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2754         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2755         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2756         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2757         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2758         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2759         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2760         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2761         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2762         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2763         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2764         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2765         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2766         16  FILLER                        PIC XX.                ELCCERT
  2767                                                                  ELCCERT
  2768     12  CM-AH-DATA.                                              ELCCERT
  2769         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2770         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2771         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2772         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2773         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2774         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2775         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2776         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2777         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2778         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2779         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2780         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2781             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2782         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2783         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2784         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2785         16  FILLER                        PIC X.                 ELCCERT
  2786                                                                  ELCCERT
  2787     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2788         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2789         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2790                                           PIC S9(5)V99  COMP-3.
  2791         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2792         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2793         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2794         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2795         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2796         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2797         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2798         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2799         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2800         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2801             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2802             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2803         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2804             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2805             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2806             20  FILLER                    PIC XX.                ELCCERT
  2807         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2808             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2809             20  FILLER                    PIC XXX.               ELCCERT
  2810         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2811         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2812             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2813         16  CM-POST-CARD-IND              PIC X.
  2814         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2815         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2816             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2817             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2818             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2819         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2820             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2821             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2822         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2823             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2824             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2825             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2826             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2827             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2828             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2829             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2830             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2831             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2832             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2833             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2834             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2835         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2836             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2837             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2838             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2839             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2840             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2841         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2842         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2843         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2844*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2845         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2846         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2847         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2848         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2849         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2850                                                                  ELCCERT
  2851     12  CM-STATUS-DATA.                                          ELCCERT
  2852         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2853         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2854                                                                  ELCCERT
  2855         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2856         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2857         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2858                                                                  ELCCERT
  2859         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2860         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2861         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2862                                                                  ELCCERT
  2863         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2864             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2865                                                'M' '4' '5' '9'.  ELCCERT
  2866             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2867             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2868             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2869             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2870             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2871             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2872             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2873             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2874             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2875             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2876             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2877             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2878                                                                  ELCCERT
  2879         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2880         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2881         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2882                                                                  ELCCERT
  2883         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2884         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2885         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2886                                                                  ELCCERT
  2887         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2888             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2889                                                'M' '4' '5' '9'.  ELCCERT
  2890             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2891             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2892             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2893             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2894             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2895             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2896             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2897             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2898             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2899             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2900             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2901             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2902                                                                  ELCCERT
  2903         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2904             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2905             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2906             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2907         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2908                                                                  ELCCERT
  2909         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2910         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2911         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2912         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2913                                                                  ELCCERT
  2914     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2915         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2916         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2917         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2918         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2919         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2920         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2921         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2922         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2923     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2924         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2925         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2926     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2927         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2928         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2929                                                                  ELCCERT
  2930*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2931     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2932     12  FILLER                            PIC X.
  2933                                                                  ELCCERT
  2934*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2935     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2936     12  FILLER                            PIC X.
  2937*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2938     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2939                                                                  ELCCERT
  2940     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2941         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2942         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2943         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2944         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2945         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2946     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2947         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2948         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2949         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2950         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2951         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2952         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2953         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2954         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2955                                                                  ELCCERT
  2956     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2957         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2958         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2959                                                                  ELCCERT
  2960     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2961     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2962     12  CM-CLP-STATE                      PIC XX.
  2963     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2964     12  CM-USER-RESERVED                  PIC XXX.
  2965     12  FILLER REDEFINES CM-USER-RESERVED.
  2966         16  CM-AH-CLASS-CD                PIC XX.
  2967         16  F                             PIC X.
  2968******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  55
* EL517.cbl
  2970 FD  ELMSTR.
* 2971                                  COPY ELCMSTR.
  2972******************************************************************04/15/98
  2973*                                                                *ELCMSTR
  2974*                            ELCMSTR.                            *   LV002
  2975*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2976*                            VMOD=2.012                          *   CL**2
  2977*                                                                *ELCMSTR
  2978*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2979*                                                                *ELCMSTR
  2980*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2981*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2982*                                                                *ELCMSTR
  2983*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2984*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2985*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2986*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2987*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2988*                                                 RKP=75,LEN=21  *ELCMSTR
  2989*                                                                *ELCMSTR
  2990*   **** NOTE ****                                               *ELCMSTR
  2991*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2992*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2993*                                                                *ELCMSTR
  2994*   LOG = YES                                                    *ELCMSTR
  2995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2996******************************************************************
  2997*                   C H A N G E   L O G
  2998*
  2999* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3000*-----------------------------------------------------------------
  3001*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3002* EFFECTIVE    NUMBER
  3003*-----------------------------------------------------------------
  3004* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3005* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3006* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3007******************************************************************ELCMSTR
  3008 01  CLAIM-MASTER.                                                ELCMSTR
  3009     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  3010         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  3011                                                                  ELCMSTR
  3012     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3013         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3014         16  CL-CARRIER              PIC X.                       ELCMSTR
  3015         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3016         16  CL-CERT-NO.                                          ELCMSTR
  3017             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3018             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3019                                                                  ELCMSTR
  3020     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3021         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3022         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3023         16  CL-INSURED-NAME.                                     ELCMSTR
  3024             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3025             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3026                                                                  ELCMSTR
  3027     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3028         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  3029         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3030             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3031             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3032             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3033                                                                  ELCMSTR
  3034     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3035         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3036         16  CL-CERT-NO-A4.                                       ELCMSTR
  3037             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3038             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3039                                                                  ELCMSTR
  3040     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3041         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3042         16  CL-CCN-A5.                                           ELCMSTR
  3043             20  CL-CCN.                                          ELCMSTR
  3044                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3045                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3046             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3047                                                                  ELCMSTR
  3048     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3049         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3050         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3051             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3052             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3053             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3054         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3055         16  FILLER                  PIC X(5).                    ELCMSTR
  3056                                                                  ELCMSTR
  3057     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3058         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3059         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3060             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3061             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3062         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3063*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3064*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3065*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3066*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3067*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3068         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3069             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3070             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3071             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3072         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3073         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3074         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3075         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3076         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3077         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3078         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3079         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3080         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3081         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3082         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3083             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3084             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3085             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3086         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  3087                                                                  ELCMSTR
  3088         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3089             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3090             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3091                                                                  ELCMSTR
  3092         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3093             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3094             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3095                                                                  ELCMSTR
  3096         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3097         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3098         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3099                                                                  ELCMSTR
  3100         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3101         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3102         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3103             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3104             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3105             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3106             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3107             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3108             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3109         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3110         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3111         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3112             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3113         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3114         16  FILLER                  PIC X.
  3115                                                                  ELCMSTR
  3116     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3117         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3118             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3119             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3120             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3121         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3122             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3123             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3124             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3125             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3126                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3127                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3128             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3129                                                                  ELCMSTR
  3130     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3131         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3132             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3133             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3134         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3135             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3136             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3137         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3138         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3139         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3140         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3141         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3142         16  CL-CRITICAL-PERIOD      PIC 99.
  3143*        16  FILLER                  PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3144         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3145         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  3146         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3147         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3148             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3149             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3150             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3151             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3152             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3153             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3154             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3155             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3156             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3157         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3158         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3159         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3160         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3161         16  CL-DENIAL-TYPE          PIC X.
  3162             88  CL-TYPE-DENIAL          VALUE '1'.
  3163             88  CL-TYPE-RESCISSION      VALUE '2'.
  3164             88  CL-TYPE-REFORMATION     VALUE '3'.
  3165             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3166             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3167         16  CL-CRIT-PER-RECURRENT   PIC X.
  3168         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3169         16  CL-RTW-DT               PIC XX.
  3170                                                                  ELCMSTR
  3171     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3172         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3173             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3174             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3175             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3176         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3177         16  FILLER                  PIC XX.                      ELCMSTR
  3178         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3179         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3180             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3181                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3182             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3183                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3184             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3185                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3186             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3187                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3188             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3189                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3190             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3191                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3192             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3193                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3194                                                                  ELCMSTR
  3195     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3196         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3197         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3198                                                                  ELCMSTR
  3199     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3200                                                                  ELCMSTR
  3201     12  CL-PROCESS-ERRORS.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3202         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3203             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3204         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3205             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  3206                                                                  ELCMSTR
  3207     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3208                                                                  ELCMSTR
  3209     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3210         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3211         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3212         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3213         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3214                                                                  ELCMSTR
  3215     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3216         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3217         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3218         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3219         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3220                                                                  ELCMSTR
  3221     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3222     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3223     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3224                                                                  ELCMSTR
  3225     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3226     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3227     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3228     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3229                                                                  ELCMSTR
  3230     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3231     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3232         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3233         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3234         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3235     12  cl-insured-claim            pic x.
  3236         88  cl-claim-on-primary         value 'P'.
  3237         88  cl-claim-on-secondary       value 'S'.
  3238     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  60
* EL517.cbl
  3240 FD  ERCTBL.
* 3241                                 COPY ERCCTBL.
  3242******************************************************************04/29/98
  3243*                                                                *ERCCTBL
  3244*                                                                *ERCCTBL
  3245*                            ERCCTBL                             *   LV002
  3246*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3247*                            VMOD=2.003                              CL**2
  3248*                                                                *ERCCTBL
  3249*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3250*                                                                *ERCCTBL
  3251*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3252*                                                                *ERCCTBL
  3253*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3254*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3255*                                                                *ERCCTBL
  3256*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3257*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3258*                                                                *ERCCTBL
  3259*   LOG = NO                                                     *ERCCTBL
  3260*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3261*                                                                *ERCCTBL
  3262*                                                                *ERCCTBL
  3263******************************************************************ERCCTBL
  3264                                                                  ERCCTBL
  3265 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3266     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3267         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3268                                                                  ERCCTBL
  3269     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3270         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3271         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3272         16  CT-CNTRL-2.                                          ERCCTBL
  3273             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3274             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3275                                                                  ERCCTBL
  3276     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3277         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3278         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3279         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3280         16  FILLER                        PIC X(31).             ERCCTBL
  3281                                                                  ERCCTBL
  3282     12  CT-LIMITS.                                               ERCCTBL
  3283         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3284                                                                  ERCCTBL
  3285         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3286                                                                  ERCCTBL
  3287         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3288                                                                  ERCCTBL
  3289     12  CT-RATES.                                                ERCCTBL
  3290         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3291             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3292             20  CT-RT-R   REDEFINES                              ERCCTBL
  3293                 CT-RT                     PIC XXX.               ERCCTBL
  3294                                                                  ERCCTBL
  3295     12  FILLER                            PIC  X(42).            ERCCTBL
  3296                                                                  ERCCTBL
  3297******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  61
* EL517.cbl
  3298
  3299 FD  ERACCT.
* 3300                                 COPY ERCACCT.
  3301******************************************************************04/19/98
  3302*                                                                *ERCACCT
  3303*                                                                *ERCACCT
  3304*                            ERCACCT                             *   LV031
  3305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3306*                            VMOD=2.031                          *ERCACCT
  3307*                                                                *ERCACCT
  3308*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3309*                                                                *ERCACCT
  3310*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3311*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3312*                                                                *ERCACCT
  3313*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3314*                                                                *ERCACCT
  3315*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3316*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3317*                                                                *ERCACCT
  3318*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3319*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3320*                                                                *ERCACCT
  3321*   LOG = NO                                                     *ERCACCT
  3322*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3323*                                                                *ERCACCT
  3324*                                                                *ERCACCT
  3325******************************************************************ERCACCT
  3326*                   C H A N G E   L O G
  3327*
  3328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3329*-----------------------------------------------------------------
  3330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3331* EFFECTIVE    NUMBER
  3332*-----------------------------------------------------------------
  3333* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3334* 092705    2005050300006  PEMA  ADD SPP LEASES
  3335* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3336* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3337* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3338* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3339* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3340******************************************************************
  3341                                                                  ERCACCT
  3342 01  ACCOUNT-MASTER.                                              ERCACCT
  3343     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3344         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3345                                                                  ERCACCT
  3346     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3347         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3348         16  AM-MSTR-CNTRL.                                       ERCACCT
  3349             20  AM-CONTROL-A.                                    ERCACCT
  3350                 24  AM-CARRIER            PIC X.                 ERCACCT
  3351                 24  AM-GROUPING.                                 ERCACCT
  3352                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3353                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3354                 24  AM-STATE              PIC XX.                ERCACCT
  3355                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3356                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3357                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3358             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3359                                           PIC X(19).             ERCACCT
  3360             20  AM-CNTRL-B.                                      ERCACCT
  3361                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3362                 24  FILLER                PIC X(4).              ERCACCT
  3363             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3364                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3365                                                                  ERCACCT
  3366     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3367         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3368         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3369         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3370         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3371         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3372         16  AM-VG-DATE.                                          ERCACCT
  3373             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3374             20  FILLER                    PIC X(4).              ERCACCT
  3375         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3376                                           PIC 9(11)      COMP-3. ERCACCT
  3377     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3378         16  FILLER                        PIC X(10).
  3379         16  AM-VG-KEY3.
  3380             20  AM-VG3-ACCOUNT            PIC X(10).
  3381             20  AM-VG3-EXP-DT             PIC XX.
  3382         16  FILLER                        PIC X(4).
  3383     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3384         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3385         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3386         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3387         16  FILLER                        PIC XX.                ERCACCT
  3388                                                                  ERCACCT
  3389     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3390     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3391                                                                  ERCACCT
  3392     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3393         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3394         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3395                                                                  ERCACCT
  3396     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3397     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3398                                                                  ERCACCT
  3399     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3400     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3401                                                                  ERCACCT
  3402     12  AM-NAME                           PIC X(30).             ERCACCT
  3403     12  AM-PERSON                         PIC X(30).             ERCACCT
  3404     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3405     12  AM-CITY.
  3406         16  AM-ADDR-CITY                  PIC X(28).
  3407         16  AM-ADDR-STATE                 PIC XX.
  3408     12  AM-ZIP.                                                  ERCACCT
  3409         16  AM-ZIP-PRIME.                                        ERCACCT
  3410             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3411                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3412             20  FILLER                    PIC X(4).              ERCACCT
  3413         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3414     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3415         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3416         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3417         16  FILLER                        PIC XXX.               ERCACCT
  3418     12  AM-TEL-NO.                                               ERCACCT
  3419         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3420         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3421         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3422     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3423         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3424         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3425                                                                  ERCACCT
  3426     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3427         16  AM-DEFN-1.                                           ERCACCT
  3428             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3429                 24  AM-AGT.                                      ERCACCT
  3430                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3431                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3432                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3433                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3434                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3435                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3436                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3437                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3438                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3439                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3440                 24  FILLER                PIC X(01).             ERCACCT
  3441         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3442             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3443                 24  FILLER                PIC X(11).             ERCACCT
  3444                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3445                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3446                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3447                 24  FILLER                PIC X(6).              ERCACCT
  3448                                                                  ERCACCT
  3449     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3450         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3451                                                                  ERCACCT
  3452     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3453                                                                  ERCACCT
  3454     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3455         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3456         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3457     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3458         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3459         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3460     12  AM-GPCD                           PIC 99.                ERCACCT
  3461     12  AM-IG                             PIC X.                 ERCACCT
  3462         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3463         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3464     12  AM-STATUS                         PIC X.                 ERCACCT
  3465         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3466         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3467         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3468         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3469         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3470         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3471     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3472     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3473                                                                  ERCACCT
  3474     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3475     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3476     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3477     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3478     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3479     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3480     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3481     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3482     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3483                                                                  ERCACCT
  3484     12  AM-USER-FIELDS.                                          ERCACCT
  3485         16  AM-FLD-1                      PIC XX.                ERCACCT
  3486         16  AM-FLD-2                      PIC XX.                ERCACCT
  3487         16  AM-FLD-3                      PIC XX.                ERCACCT
  3488         16  AM-FLD-4                      PIC XX.                ERCACCT
  3489         16  AM-FLD-5                      PIC XX.                ERCACCT
  3490                                                                  ERCACCT
  3491     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3492         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3493         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3494         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3495     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3496     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3497         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3498         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3499         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3500     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3501     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3502     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3503     12  AM-INACTIVE-DATE.                                        ERCACCT
  3504         16  AM-INA-MO                     PIC 99.                ERCACCT
  3505         16  AM-INA-DA                     PIC 99.                ERCACCT
  3506         16  AM-INA-YR                     PIC 99.                ERCACCT
  3507     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3508                                                                  ERCACCT
  3509     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3510     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3511                                                                  ERCACCT
  3512     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3513         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3514         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3515         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3516         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3517                                                                  ERCACCT
  3518     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3519         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3520         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3521                                                                  ERCACCT
  3522     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3523                                                                  ERCACCT
  3524     12  AM-OVER-SHORT.                                           ERCACCT
  3525         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3526         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3527                                                                  ERCACCT
  3528     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3529     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3530                                                                  ERCACCT
  3531     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3532     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3533                                                                  ERCACCT
  3534     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3535     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3536     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3537     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3538     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3539     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3540     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3541     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3542     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3543     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3544     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3545     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3546     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3547     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3548     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3549     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3550                                                                  ERCACCT
  3551     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3552                                                                  ERCACCT
  3553     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3554     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3555                                                                  ERCACCT
  3556     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3557     12  AM-EARN-METHODS.                                         ERCACCT
  3558         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3559             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3560             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3561             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3562             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3563         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3564             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3565             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3566             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3567             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3568         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3569             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3570             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3571             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3572             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3573             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3574             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3575                                                                  ERCACCT
  3576     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3577     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3578     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3579                                                                  ERCACCT
  3580     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3581     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3582     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3583     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3584     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3585     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3586         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3587         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3588     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3589         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3590         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3591         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3592     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3593         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3594         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3595     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3596         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3597         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3598         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3599     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3600     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3601                                                                  ERCACCT
  3602     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3603         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3604         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3605         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3606         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3607         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3608                                                                  ERCACCT
  3609     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3610                                                                  ERCACCT
  3611     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3612                                                                  ERCACCT
  3613     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3614         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3615                                                                  ERCACCT
  3616     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3617         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3618         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3619                                                                  ERCACCT
  3620     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3621         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3622                                                                  ERCACCT
  3623     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3624         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3625         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3626                                                                  ERCACCT
  3627     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3628                                                                  ERCACCT
  3629     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3630     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3631     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3632     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3633     12  AM-DCC-UEF-STATE                  PIC XX.
  3634     12  FILLER                            PIC XXX.
  3635     12  AM-REPORT-CODE-3                  PIC X(10).
  3636*    12  FILLER                            PIC X(22).             ERCACCT
  3637                                                                  ERCACCT
  3638     12  AM-RESERVE-DATE.                                         ERCACCT
  3639         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3640         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3641         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3642                                                                  ERCACCT
  3643     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3644     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3645         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3646         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3647         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3648         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3649                                                                  ERCACCT
  3650     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3651         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3652         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3653         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3654         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3655                                                                  ERCACCT
  3656     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3657         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3658             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3659             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3660             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3661             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3662             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3663             20  FILLER                    PIC XX.                ERCACCT
  3664         16  FILLER                        PIC X(80).             ERCACCT
  3665                                                                  ERCACCT
  3666     12  AM-TRANSFER-DATA.                                        ERCACCT
  3667         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3668             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3669             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3670                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3671                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3672             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3673             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3674                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3675                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3676             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3677         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3678             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3679             20  AM-TRNTO-GROUPING.                               ERCACCT
  3680                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3681                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3682             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3683             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3684                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3685                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3686             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3687         16  FILLER                        PIC X(10).             ERCACCT
  3688                                                                  ERCACCT
  3689     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3690                                                                  ERCACCT
  3691     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3692         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3693             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3694                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3695                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3696                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3697                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3698                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3699                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3700                 24  FILLER                PIC X.                 ERCACCT
  3701                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3702                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3703                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3704         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3705             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3706                 24  FILLER                PIC X(11).             ERCACCT
  3707                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3708                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3709                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3710                 24  FILLER                PIC X(6).              ERCACCT
  3711                                                                  ERCACCT
  3712     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3713         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3714            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3715            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3716            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3717                                                                  ERCACCT
  3718     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3719     12  FILLER                            PIC X(120).            ERCACCT
  3720                                                                  ERCACCT
  3721     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3722         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3723         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3724             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3725             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3726                                                          COMP-3. ERCACCT
  3727             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3728                                                          COMP-3. ERCACCT
  3729         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3730             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3731             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3732                                                          COMP-3. ERCACCT
  3733             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3734                                                          COMP-3. ERCACCT
  3735                                                                  ERCACCT
  3736     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3737         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3738         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3739         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3740         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3741             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3742                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3743                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3744             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3745                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3746                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3747             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3748                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3749                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3750         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3751             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3752                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3753                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3754                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3755             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3756                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3757                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3758             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3759                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3760                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3761                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3762     12  AM-COMMENTS.                                             ERCACCT
  3763         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3764                                                                  ERCACCT
  3765     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3766         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3767         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3768         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3769         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3770         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3771             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3772             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3773             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3774             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3775         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3776             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3777             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3778             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3779         16  FILLER                        PIC X(102).            ERCACCT
  3780                                                                  ERCACCT
  3781     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3782         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3783             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3784             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3785             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3786             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3787             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3788         16  FILLER                          PIC X(10).           ERCACCT
  3789******************************************************************ERCACCT
  3790
  3791 FD  ELCERR.
* 3792                                 COPY ELCERRS.
  3793******************************************************************04/15/98
  3794*                                                                *ELCERRS
  3795*                                                                *ELCERRS
  3796*                            ELCERRS.                            *   LV002
  3797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3798*                            VMOD 2.002                          *   CL**2
  3799*                                                                *ELCERRS
  3800*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3801*                                                                *ELCERRS
  3802*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3803*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3804*                                                                *ELCERRS
  3805*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3806*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3807*                                                                *ELCERRS
  3808*   LOG = NO                                                     *ELCERRS
  3809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3810******************************************************************ELCERRS
  3811 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3812     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3813         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3814                                                                  ELCERRS
  3815     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3816         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3817                                                                  ELCERRS
  3818     12  EM-ERROR-TEXT.                                           ELCERRS
  3819         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3820         16  FILLER                  PIC X(59).                   ELCERRS
  3821                                                                  ELCERRS
  3822     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3823         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3824         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3825         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3826         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3827                                                                  ELCERRS
  3828******************************************************************ELCERRS
  3829
  3830 FD  ERPNDM.
* 3831                                 COPY ERCPNDM.
  3832******************************************************************
  3833*                                                                *
  3834*                                                                *
  3835*                            ERCPNDM                             *
  3836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3837*                            VMOD=2.003                          *
  3838*                                                                *
  3839*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3840*                                                                *
  3841*   FILE TYPE = VSAM,KSDS                                        *
  3842*   RECORD SIZE = 374   RECFORM = FIX                            *
  3843*                                                                *
  3844*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3845*   ALTERNATE PATH    = NOT USED                                 *
  3846*                                                                *
  3847*   LOG = YES                                                    *
  3848*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3849******************************************************************
  3850*                   C H A N G E   L O G
  3851*
  3852* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3853*-----------------------------------------------------------------
  3854*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3855* EFFECTIVE    NUMBER
  3856*-----------------------------------------------------------------
  3857* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3858* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3859* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3860******************************************************************
  3861
  3862 01  PENDING-MAILING-DATA.
  3863     12  PM-RECORD-ID                      PIC XX.
  3864         88  VALID-MA-ID                       VALUE 'PM'.
  3865
  3866     12  PM-CONTROL-PRIMARY.
  3867         16  PM-COMPANY-CD                 PIC X.
  3868         16  PM-ENTRY-BATCH                PIC X(6).
  3869         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3870         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3871
  3872     12  FILLER                            PIC X(14).
  3873
  3874     12  PM-ACCESS-CONTROL.
  3875         16  PM-SOURCE-SYSTEM              PIC XX.
  3876             88  PM-FROM-CREDIT                VALUE 'CR'.
  3877             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3878             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3879             88  PM-FROM-OTHER                 VALUE 'OT'.
  3880         16  PM-RECORD-ADD-DT              PIC XX.
  3881         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3882         16  PM-LAST-MAINT-DT              PIC XX.
  3883         16  PM-LAST-MAINT-BY              PIC XXXX.
  3884         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3885
  3886     12  PM-PROFILE-INFO.
  3887         16  PM-QUALIFY-CODE-1             PIC XX.
  3888         16  PM-QUALIFY-CODE-2             PIC XX.
  3889         16  PM-QUALIFY-CODE-3             PIC XX.
  3890         16  PM-QUALIFY-CODE-4             PIC XX.
  3891         16  PM-QUALIFY-CODE-5             PIC XX.
  3892
  3893         16  PM-INSURED-LAST-NAME          PIC X(15).
  3894         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3895         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3896         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3897         16  PM-INSURED-BIRTH-DT           PIC XX.
  3898         16  PM-INSURED-SEX                PIC X.
  3899             88  PM-SEX-MALE                   VALUE 'M'.
  3900             88  PM-SEX-FEMALE                 VALUE 'F'.
  3901         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3902
  3903         16  PM-ADDRESS-CORRECTED          PIC X.
  3904         16  PM-JOINT-BIRTH-DT             PIC XX.
  3905*        16  FILLER                        PIC X(12).
  3906
  3907         16  PM-ADDRESS-LINE-1             PIC X(30).
  3908         16  PM-ADDRESS-LINE-2             PIC X(30).
  3909         16  PM-CITY-STATE.
  3910             20  PM-CITY                   PIC X(28).
  3911             20  PM-STATE                  PIC XX.
  3912         16  PM-ZIP.
  3913             20  PM-ZIP-CODE.
  3914                 24  PM-ZIP-1              PIC X.
  3915                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3916                 24  FILLER                PIC X(4).
  3917             20  PM-ZIP-PLUS4              PIC X(4).
  3918         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3919             20  PM-CAN-POST1              PIC XXX.
  3920             20  PM-CAN-POST2              PIC XXX.
  3921             20  FILLER                    PIC XXX.
  3922
  3923         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3924
  3925         16  FILLER                        PIC X(03).
  3926
  3927     12  PM-CRED-BENE-INFO.
  3928         16  PM-CRED-BENE-NAME             PIC X(25).
  3929         16  PM-CRED-BENE-ADDR             PIC X(30).
  3930         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3931         16  PM-CRED-BENE-CTYST.
  3932             20  PM-CRED-BENE-CITY         PIC X(28).
  3933             20  PM-CRED-BENE-STATE        PIC XX.
  3934         16  PM-CRED-BENE-ZIP.
  3935             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3936                 24  PM-CB-ZIP-1           PIC X.
  3937                     88  PM-CB-CANADIAN-POST-CODE
  3938                                  VALUE 'A' THRU 'Z'.
  3939                 24  FILLER                PIC X(4).
  3940             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3941         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3942             20  PM-CB-CAN-POST1           PIC XXX.
  3943             20  PM-CB-CAN-POST2           PIC XXX.
  3944             20  FILLER                    PIC XXX.
  3945     12  PM-POST-CARD-MAIL-DATA.
  3946         16  PM-MAIL-DATA OCCURS 7.
  3947             20  PM-MAIL-TYPE              PIC X.
  3948                 88  PM-12MO-MAILING           VALUE '1'.
  3949                 88  PM-EXP-MAILING            VALUE '2'.
  3950             20  PM-MAIL-STATUS            PIC X.
  3951                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3952                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3953                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3954             20  PM-MAIL-DATE              PIC XX.
  3955     12  FILLER                            PIC XX.
  3956     12  FILLER                            PIC X(12).
  3957*    12  FILLER                            PIC X(30).
  3958
  3959******************************************************************
  3960
  3961 FD  ERMAIL.
* 3962                                 COPY ERCMAIL.
  3963******************************************************************
  3964*                                                                *
  3965*                                                                *
  3966*                            ERCMAIL                             *
  3967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3968*                            VMOD=2.003                          *
  3969*                                                                *
  3970*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3971*                                                                *
  3972*   FILE TYPE = VSAM,KSDS                                        *
  3973*   RECORD SIZE = 374   RECFORM = FIX                            *
  3974*                                                                *
  3975*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3976*   ALTERNATE PATH    = NOT USED                                 *
  3977*                                                                *
  3978*   LOG = YES                                                    *
  3979*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3980******************************************************************
  3981*                   C H A N G E   L O G
  3982*
  3983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3984*-----------------------------------------------------------------
  3985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3986* EFFECTIVE    NUMBER
  3987*-----------------------------------------------------------------
  3988* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3989* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3990* 111108                   PEMA  ADD CRED BENE ADDR2
  3991******************************************************************
  3992
  3993 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3994     12  MA-RECORD-ID                      PIC XX.
  3995         88  VALID-MA-ID                       VALUE 'MA'.
  3996
  3997     12  MA-CONTROL-PRIMARY.
  3998         16  MA-COMPANY-CD                 PIC X.
  3999         16  MA-CARRIER                    PIC X.
  4000         16  MA-GROUPING.
  4001             20  MA-GROUPING-PREFIX        PIC XXX.
  4002             20  MA-GROUPING-PRIME         PIC XXX.
  4003         16  MA-STATE                      PIC XX.
  4004         16  MA-ACCOUNT.
  4005             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4006             20  MA-ACCOUNT-PRIME          PIC X(6).
  4007         16  MA-CERT-EFF-DT                PIC XX.
  4008         16  MA-CERT-NO.
  4009             20  MA-CERT-PRIME             PIC X(10).
  4010             20  MA-CERT-SFX               PIC X.
  4011
  4012     12  FILLER                            PIC XX.
  4013
  4014     12  MA-ACCESS-CONTROL.
  4015         16  MA-SOURCE-SYSTEM              PIC XX.
  4016             88  MA-FROM-CREDIT                VALUE 'CR'.
  4017             88  MA-FROM-VSI                   VALUE 'VS'.
  4018             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4019             88  MA-FROM-OTHER                 VALUE 'OT'.
  4020         16  MA-RECORD-ADD-DT              PIC XX.
  4021         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4022         16  MA-LAST-MAINT-DT              PIC XX.
  4023         16  MA-LAST-MAINT-BY              PIC XXXX.
  4024         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4025
  4026     12  MA-PROFILE-INFO.
  4027         16  MA-QUALIFY-CODE-1             PIC XX.
  4028         16  MA-QUALIFY-CODE-2             PIC XX.
  4029         16  MA-QUALIFY-CODE-3             PIC XX.
  4030         16  MA-QUALIFY-CODE-4             PIC XX.
  4031         16  MA-QUALIFY-CODE-5             PIC XX.
  4032
  4033         16  MA-INSURED-LAST-NAME          PIC X(15).
  4034         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4035         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4036         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4037         16  MA-INSURED-BIRTH-DT           PIC XX.
  4038         16  MA-INSURED-SEX                PIC X.
  4039             88  MA-SEX-MALE                   VALUE 'M'.
  4040             88  MA-SEX-FEMALE                 VALUE 'F'.
  4041         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4042
  4043         16  MA-ADDRESS-CORRECTED          PIC X.
  4044         16  MA-JOINT-BIRTH-DT             PIC XX.
  4045*        16  FILLER                        PIC X(12).
  4046
  4047         16  MA-ADDRESS-LINE-1             PIC X(30).
  4048         16  MA-ADDRESS-LINE-2             PIC X(30).
  4049         16  MA-CITY-STATE.
  4050             20  MA-CITY                   PIC X(28).
  4051             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4052         16  MA-ZIP.
  4053             20  MA-ZIP-CODE.
  4054                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4055                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4056                 24  FILLER                PIC X(4).
  4057             20  MA-ZIP-PLUS4              PIC X(4).
  4058         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4059             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4060             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4061             20  FILLER                    PIC X(3).
  4062
  4063         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4064
  4065         16  FILLER                        PIC XXX.
  4066*        16  FILLER                        PIC X(10).
  4067
  4068
  4069     12  MA-CRED-BENE-INFO.
  4070         16  MA-CRED-BENE-NAME                 PIC X(25).
  4071         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4072         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4073         16  MA-CRED-BENE-CTYST.
  4074             20  MA-CRED-BENE-CITY             PIC X(28).
  4075             20  MA-CRED-BENE-STATE            PIC XX.
  4076         16  MA-CRED-BENE-ZIP.
  4077             20  MA-CB-ZIP-CODE.
  4078                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4079                     88  MA-CB-CANADIAN-POST-CODE
  4080                                           VALUE 'A' THRU 'Z'.
  4081                 24  FILLER                    PIC X(4).
  4082             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4083         16  MA-CB-CANADIAN-POSTAL-CODE
  4084                            REDEFINES MA-CRED-BENE-ZIP.
  4085             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4086             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4087             20  FILLER                        PIC X(3).
  4088     12  MA-POST-CARD-MAIL-DATA.
  4089         16  MA-MAIL-DATA OCCURS 7.
  4090             20  MA-MAIL-TYPE              PIC X.
  4091                 88  MA-12MO-MAILING           VALUE '1'.
  4092                 88  MA-EXP-MAILING            VALUE '2'.
  4093             20  MA-MAIL-STATUS            PIC X.
  4094                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4095                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4096                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4097             20  MA-MAIL-DATE              PIC XX.
  4098     12  FILLER                            PIC XX.
  4099     12  FILLER                            PIC XX.
  4100*    12  FILLER                            PIC X(30).
  4101******************************************************************
  4102
  4103 FD  ERPLAN.
* 4104                                 COPY ERCPLAN.
  4105******************************************************************04/29/98
  4106*                                                                *ERCPLAN
  4107*                                                                *ERCPLAN
  4108*                            ERCPLAN                             *   LV003
  4109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4110*                            VMOD=2.003                          *   CL**2
  4111*                                                                *ERCPLAN
  4112*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4113*                                                                *ERCPLAN
  4114*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4115*   PLAN MASTER                                                  *ERCPLAN
  4116*                                                                *ERCPLAN
  4117*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4118*                                                                *ERCPLAN
  4119*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4120*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4121*                                                                *ERCPLAN
  4122*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4123*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4124*                                                                *ERCPLAN
  4125*   LOG = NO                                                     *ERCPLAN
  4126*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4127*                                                                *ERCPLAN
  4128*                                                                *ERCPLAN
  4129******************************************************************ERCPLAN
  4130                                                                  ERCPLAN
  4131 01  PLAN-MASTER.                                                 ERCPLAN
  4132     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4133         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4134                                                                  ERCPLAN
  4135     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4136         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4137         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4138             20  PL-CONTROL-A.                                    ERCPLAN
  4139                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4140                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4141                 24  PL-STATE              PIC XX.                ERCPLAN
  4142                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4143             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4144             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4145             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4146                                                                  ERCPLAN
  4147     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4148         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4149         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4150         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4151         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4152         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4153         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4154         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4155         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4156                                                                  ERCPLAN
  4157     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4158         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4159         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4160         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4161         16  FILLER                        PIC XX.                ERCPLAN
  4162                                                                  ERCPLAN
  4163     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4164         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4165         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4166             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4167             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4168             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4169             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4170                                                                  ERCPLAN
  4171     12  FILLER                            PIC X(30).             ERCPLAN
  4172                                                                  ERCPLAN
  4173     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4174         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4175         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4176         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4177     12  FILLER                            PIC X(24).             ERCPLAN
  4178     12  PL-TOLERANCES.                                           ERCPLAN
  4179         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4180         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4181         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4182         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4183         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4184         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4185     12  PL-OVER-SHORT.                                           ERCPLAN
  4186         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4187         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4188     12  FILLER                            PIC X(24).             ERCPLAN
  4189     12  PLAN-MISC.                                               ERCPLAN
  4190         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4191         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4192         16  PL-IG                         PIC X.                 ERCPLAN
  4193         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4194         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4195         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4196         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4197         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4198         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4199         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4200         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4201                                                                  ERCPLAN
  4202         16  FILLER                        PIC X(99).             ERCPLAN
  4203******************************************************************ERCPLAN
  4204 FD  ERFORM.
* 4205                                 COPY ERCFORM.
  4206******************************************************************04/29/98
  4207*                                                                *ERCFORM
  4208*                                                                *ERCFORM
  4209*                            ERCFORM.                            *   LV002
  4210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4211*                            VMOD=2.003                          *   CL**2
  4212*                                                                *ERCFORM
  4213*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4214*                                                                *ERCFORM
  4215*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4216*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4217*                                                                *ERCFORM
  4218*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4219*                                                                *ERCFORM
  4220*    LOG = YES                                                   *ERCFORM
  4221*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4222******************************************************************ERCFORM
  4223 01  FORM-MASTER.                                                 ERCFORM
  4224    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4225        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4226                                                                  ERCFORM
  4227    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4228        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4229        16  FO-STATE                 PIC X(02).                   ERCFORM
  4230        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4231        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4232                                                                  ERCFORM
  4233    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4234        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4235        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4236        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4237        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4238        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4239        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4240        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4241        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4242        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4243        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4244        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4245        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4246        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4247        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4248        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4249        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4250                                                                  ERCFORM
  4251    12  FILLER                       PIC X(29).                   ERCFORM
  4252                                                                  ERCFORM
  4253    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4254        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4255            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4256            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4257            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4258            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4259                                     PIC X.                       ERCFORM
  4260                                                                  ERCFORM
  4261    12  FILLER                       PIC X(30).                   ERCFORM
  4262                                                                  ERCFORM
  4263    12  FO-COMMENTS-AREA.                                         ERCFORM
  4264        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4265                                                                  ERCFORM
  4266    12  FILLER                       PIC X(20).                   ERCFORM
  4267                                                                  ERCFORM
  4268    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4269        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4270        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4271        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4272
  4273 FD  PRINT-FILE
* 4274                                 COPY ELCPRTFD.
  4275******************************************************************04/15/98
  4276*                                                                *ELCPRTFD
  4277*                                                                *ELCPRTFD
  4278*                            ELCPRTFD.                           *   LV003
  4279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4280*                            VMOD=2.006                          *ELCPRTFD
  4281******************************************************************ELCPRTFD
  4282     RECORDING MODE F                                             ELCPRTFD
  4283     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4284     BLOCK CONTAINS 0 RECORDS
  4285     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4286 01  PRT.                                                         ELCPRTFD
  4287     12  P-CTL               PIC  X.                                 CL**2
  4288     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4289******************************************************************ELCPRTFD
  4290 FD  FICH
* 4291                                 COPY ELCFCHFD.
  4292******************************************************************04/15/98
  4293*                                                                *ELCFCHFD
  4294*                            ELCFCHFD.                           *   LV003
  4295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4296*                            VMOD=2.004                          *   CL**3
  4297*                                                                *ELCFCHFD
  4298******************************************************************ELCFCHFD
  4299     BLOCK CONTAINS 0 RECORDS
  4300     RECORDING MODE F.                                            ELCFCHFD
  4301                                                                  ELCFCHFD
  4302 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4303******************************************************************ELCFCHFD
  4304
  4305 FD  ELREPT.
* 4306                                 COPY ELCREPT.
  4307******************************************************************04/15/98
  4308*                                                                *ELCREPT
  4309*                                                                *ELCREPT
  4310*                            ELCREPT.                            *   LV002
  4311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4312*                            VMOD=2.002                          *   CL**2
  4313*                                                                *ELCREPT
  4314*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4315*                                                                *ELCREPT
  4316*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4317*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4318*                                                                *ELCREPT
  4319*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4320*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4321*                                                                *ELCREPT
  4322*   LOG = NO                                                     *ELCREPT
  4323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4324******************************************************************ELCREPT
  4325 01  REPORT-SAVE-FILE.                                            ELCREPT
  4326     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4327         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4328                                                                  ELCREPT
  4329     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4330         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4331         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4332             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4333             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4334         16  RF-REPORT-ID.                                        ELCREPT
  4335             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4336                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4337                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4338             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4339         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4340     12  RF-REPORT-LINE-133.                                      ELCREPT
  4341         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4342         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4343         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4344             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4345             20  FILLER              PIC X(52).                   ELCREPT
  4346         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4347             20  FILLER              PIC X(53).                   ELCREPT
  4348             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4349     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4350         16  FILLER                  PIC X.                       ELCREPT
  4351         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4352         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4353         16  FILLER                  PIC X(115).                  ELCREPT
  4354         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4355******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  80
* EL517.cbl
  4357
  4358 FD  ERRESS.
* 4359                                 COPY ERCRESS.
  4360******************************************************************04/29/98
  4361*                                                                *ERCRESS
  4362*                            ERCRESS                             *   LV002
  4363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4364*                            VMOD=2.002                          *   CL**2
  4365*                                                                *ERCRESS
  4366*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4367*                                                                *ERCRESS
  4368*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4369*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4370*                                                                *ERCRESS
  4371*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4372*                                                                *ERCRESS
  4373*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4374*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4375*                                                                *ERCRESS
  4376*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4377*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4378*                                                                *ERCRESS
  4379*   LOG = NO                                                     *ERCRESS
  4380*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4381*                                                                *ERCRESS
  4382*                                                                *ERCRESS
  4383******************************************************************ERCRESS
  4384                                                                  ERCRESS
  4385 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4386                                                                  ERCRESS
  4387     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4388         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4389         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4390         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4391         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4392*                                      YYYYMMDD                   ERCRESS
  4393*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4394                                                                  ERCRESS
  4395     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4396                                                                  ERCRESS
  4397         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4398         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4399         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4400         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4401                                                                  ERCRESS
  4402     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4403         88 RECALC                VALUE 'Y'.                      ERCRESS
  4404         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4405     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4406     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4407     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4408*                                      YYYYMMDD                   ERCRESS
  4409
  4410 FD  ERRESC.
* 4411                                 COPY ERCRESC.
  4412******************************************************************04/29/98
  4413*                                                                *ERCRESC
  4414*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4416*                            VMOD=2.003                          *   CL**2
  4417*                                                                *ERCRESC
  4418*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4419*                                                                *ERCRESC
  4420*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4421*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4422*                                                                *ERCRESC
  4423*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4424*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4425*                                                                *ERCRESC
  4426*   LOG = NO                                                     *ERCRESC
  4427*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4428*                                                                *ERCRESC
  4429******************************************************************ERCRESC
  4430                                                                  ERCRESC
  4431 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4432                                                                  ERCRESC
  4433     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4434         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4435         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4436         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4437         15  RESC-STATE                PIC   XX.                  ERCRESC
  4438         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4439         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4440         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4441         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4442*                                           YYYYMMDD              ERCRESC
  4443     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4444                                                                  ERCRESC
  4445     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4446         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4447             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4448             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4449             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4450                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4451                                                                  ERCRESC
  4452     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4453     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4454     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4455*                                          YYYYMMDD               ERCRESC
  4456
  4457 FD  ERCOMP.
* 4458                                 COPY ERCCOMP.
  4459******************************************************************
  4460*                                                                *
  4461*                                                                *
  4462*                            ERCCOMP                             *
  4463*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4464*                            VMOD=2.019                          *
  4465*                                                                *
  4466*   ONLINE CREDIT SYSTEM                                         *
  4467*                                                                *
  4468*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4469*                                                                *
  4470*   FILE TYPE = VSAM,KSDS                                        *
  4471*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4472*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4473*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4474*       ALTERNATE PATH = NONE                                    *
  4475*                                                                *
  4476*   LOG = NO                                                     *
  4477*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4478*                                                                *
  4479******************************************************************
  4480*                   C H A N G E   L O G
  4481*
  4482* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4483*-----------------------------------------------------------------
  4484*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4485* EFFECTIVE    NUMBER
  4486*-----------------------------------------------------------------
  4487* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4488* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4489* 092205    2005050300006  PEMA  ADD LEASE FEE
  4490* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4491* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4492* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4493* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4494* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4495* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4496******************************************************************
  4497
  4498 01  COMPENSATION-MASTER.
  4499     12  CO-RECORD-ID                          PIC XX.
  4500         88  VALID-CO-ID                          VALUE 'CO'.
  4501
  4502     12  CO-CONTROL-PRIMARY.
  4503         16  CO-COMPANY-CD                     PIC X.
  4504         16  CO-CONTROL.
  4505             20  CO-CTL-1.
  4506                 24  CO-CARR-GROUP.
  4507                     28  CO-CARRIER            PIC X.
  4508                     28  CO-GROUPING.
  4509                         32  CO-GROUP-PREFIX   PIC XXX.
  4510                         32  CO-GROUP-PRIME    PIC XXX.
  4511                 24  CO-RESP-NO.
  4512                     28  CO-RESP-PREFIX        PIC X(4).
  4513                     28  CO-RESP-PRIME         PIC X(6).
  4514             20  CO-CTL-2.
  4515                 24  CO-ACCOUNT.
  4516                     28  CO-ACCT-PREFIX        PIC X(4).
  4517                     28  CO-ACCT-PRIME         PIC X(6).
  4518         16  CO-TYPE                           PIC X.
  4519             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4520             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4521             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4522
  4523     12  CO-MAINT-INFORMATION.
  4524         16  CO-LAST-MAINT-DT                  PIC XX.
  4525         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4526         16  CO-LAST-MAINT-USER                PIC X(4).
  4527     12  FILLER                                PIC XX.
  4528     12  CO-STMT-TYPE                          PIC XXX.
  4529     12  CO-COMP-TYPE                          PIC X.
  4530         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4531     12  CO-STMT-OWNER                         PIC X(4).
  4532     12  CO-BALANCE-CONTROL                    PIC X.
  4533         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4534         88  CO-NO-BALANCE                        VALUE 'N'.
  4535
  4536     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4537         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4538         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4539         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4540
  4541     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4542         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4543         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4544
  4545     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4546     12  CO-GA-DIRECT-DEP                      PIC X.
  4547     12  CO-FUTURE-SPACE                       PIC X.
  4548         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4549
  4550     12  CO-ACCT-NAME                          PIC X(30).
  4551     12  CO-MAIL-NAME                          PIC X(30).
  4552     12  CO-ADDR-1                             PIC X(30).
  4553     12  CO-ADDR-2                             PIC X(30).
  4554     12  CO-ADDR-3.
  4555         16  CO-ADDR-CITY                      PIC X(27).
  4556         16  CO-ADDR-STATE                     PIC XX.
  4557     12  CO-CSO-1099                           PIC X.
  4558     12  CO-ZIP.
  4559         16  CO-ZIP-PRIME.
  4560             20  CO-ZIP-PRI-1ST                PIC X.
  4561                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4562             20  FILLER                        PIC X(4).
  4563         16  CO-ZIP-PLUS4                      PIC X(4).
  4564     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4565         16  CO-CAN-POSTAL-1                   PIC XXX.
  4566         16  CO-CAN-POSTAL-2                   PIC XXX.
  4567         16  FILLER                            PIC XXX.
  4568     12  CO-SOC-SEC                            PIC X(13).
  4569     12  CO-TELEPHONE.
  4570         16  CO-AREA-CODE                      PIC XXX.
  4571         16  CO-PREFIX                         PIC XXX.
  4572         16  CO-PHONE                          PIC X(4).
  4573
  4574     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4575
  4576     12  CO-AR-BAL-LEVEL                       PIC X.
  4577         88  CO-AR-REF-LVL                        VALUE '1'.
  4578         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4579         88  CO-AR-BILL-LVL                       VALUE '2'.
  4580         88  CO-AR-AGT-LVL                        VALUE '3'.
  4581         88  CO-AR-FR-LVL                         VALUE '4'.
  4582
  4583     12  CO-AR-NORMAL-PRINT                    PIC X.
  4584         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4585         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4586
  4587     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4588
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4589     12  CO-AR-REPORTING                       PIC X.
  4590         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4591         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4592
  4593     12  CO-AR-PULL-CHECK                      PIC X.
  4594         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4595         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4596
  4597     12  CO-AR-BALANCE-PRINT                   PIC X.
  4598         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4599
  4600     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4601         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4602         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4603         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4604
  4605     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4606
  4607     12  CO-USER-CODE                          PIC X.
  4608     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4609
  4610******************************************************************
  4611*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4612*    THE LAST MONTH END RUN.
  4613******************************************************************
  4614
  4615     12  CO-LAST-ACTIVITY-DATE.
  4616         16  CO-ACT-YEAR                       PIC 99.
  4617         16  CO-ACT-MONTH                      PIC 99.
  4618         16  CO-ACT-DAY                        PIC 99.
  4619
  4620     12  CO-LAST-STMT-DT.
  4621         16  CO-LAST-STMT-YEAR                 PIC 99.
  4622         16  CO-LAST-STMT-MONTH                PIC 99.
  4623         16  CO-LAST-STMT-DAY                  PIC 99.
  4624
  4625     12  CO-MO-END-TOTALS.
  4626         16  CO-MONTHLY-TOTALS.
  4627             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4628             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4629             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4630             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4631             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4632
  4633         16  CO-AGING-TOTALS.
  4634             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4635             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4636             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4637             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4638
  4639         16  CO-YTD-TOTALS.
  4640             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4641             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4642
  4643         16  CO-OVER-UNDER-TOTALS.
  4644             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4645             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4646
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4647     12  CO-MISCELLANEOUS-TOTALS.
  4648         16  CO-FICA-TOTALS.
  4649             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4650             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4651
  4652         16  CO-CLAIM-TOTALS.
  4653             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4654             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4655
  4656******************************************************************
  4657*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4658*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4659******************************************************************
  4660
  4661     12  CO-CURRENT-TOTALS.
  4662         16  CO-CURRENT-LAST-STMT-DT.
  4663             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4664             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4665             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4666
  4667         16  CO-CURRENT-MONTHLY-TOTALS.
  4668             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4669             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4670             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4671             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4672             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4673
  4674         16  CO-CURRENT-AGING-TOTALS.
  4675             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4676             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4677             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4678             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4679
  4680         16  CO-CURRENT-YTD-TOTALS.
  4681             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4682             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4683
  4684     12  CO-PAID-COMM-TOTALS.
  4685         16  CO-YTD-PAID-COMMS.
  4686             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4687             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4688
  4689     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4690         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4691         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4692
  4693     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4694         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4695         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4696         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4697         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4698         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4699         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4700         88  CO-FINAL-LETTER                  VALUE 'F'.
  4701         88  CO-RECONCILING                   VALUE 'R'.
  4702         88  CO-PHONE-CALL                    VALUE 'P'.
  4703         88  CO-LEGAL                         VALUE 'L'.
  4704         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4705         88  CO-WRITE-OFF                     VALUE 'W'.
  4706         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4707
  4708     12  CO-CSR-CODE                       PIC X(4).
  4709
  4710     12  CO-GA-STATUS-INFO.
  4711         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4712         16  CO-GA-TERMINATION-DT          PIC XX.
  4713         16  CO-GA-STATUS-CODE             PIC X.
  4714             88  CO-GA-ACTIVE                 VALUE 'A'.
  4715             88  CO-GA-INACTIVE               VALUE 'I'.
  4716             88  CO-GA-PENDING                VALUE 'P'.
  4717         16  CO-GA-COMMENTS.
  4718             20  CO-GA-COMMENT-1           PIC X(40).
  4719             20  CO-GA-COMMENT-2           PIC X(40).
  4720             20  CO-GA-COMMENT-3           PIC X(40).
  4721             20  CO-GA-COMMENT-4           PIC X(40).
  4722
  4723     12  CO-RPTCD2                         PIC X(10).
  4724     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4725         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4726         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4727
  4728     12  CO-TYPE-AGENT                     PIC X(01).
  4729         88  CO-CORPORATION                   VALUE 'C'.
  4730         88  CO-PARTNERSHIP                   VALUE 'P'.
  4731         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4732         88  CO-TRUST                         VALUE 'T'.
  4733         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4734
  4735     12  CO-FAXNO.
  4736         16  CO-FAX-AREA-CODE                  PIC XXX.
  4737         16  CO-FAX-PREFIX                     PIC XXX.
  4738         16  CO-FAX-PHONE                      PIC X(4).
  4739
  4740     12  CO-BANK-INFORMATION.
  4741         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4742         16  CO-BANK-TRANSIT-NON REDEFINES
  4743             CO-BANK-TRANSIT-NO                PIC 9(8).
  4744
  4745         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4746     12  CO-MISC-DEDUCT-INFO REDEFINES
  4747                  CO-BANK-INFORMATION.
  4748         16  CO-MD-GL-ACCT                     PIC X(10).
  4749         16  CO-MD-DIV                         PIC XX.
  4750         16  CO-MD-CENTER                      PIC X(4).
  4751         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4752         16  CO-CREATE-AP-CHECK                PIC X.
  4753         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4754         16  FILLER                            PIC XXX.
  4755     12  CO-ACH-STATUS                         PIC X.
  4756         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4757         88  CO-ACH-PENDING                        VALUE 'P'.
  4758
  4759     12  CO-BILL-SW                            PIC X.
  4760     12  CO-CONTROL-NAME                       PIC X(30).
  4761     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4762     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4763     12  CO-CLP-STATE                          PIC XX.
  4764     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4765     12  CO-SPP-REFUND-EDIT                    PIC X.
  4766
  4767******************************************************************
  4768
  4769 FD  ERLOFC.
* 4770                                 COPY ERCLOFC.
  4771******************************************************************12/04/92
  4772*                                                                *ERCLOFC
  4773*                                                                *ERCLOFC
  4774*                            ERCLOFC                             *   LV002
  4775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4776*                            VMOD=2.003                          *   CL**2
  4777*                                                                *ERCLOFC
  4778*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4779*                                                                *ERCLOFC
  4780*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4781*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4782*                                                                *ERCLOFC
  4783*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4784*                                                                *ERCLOFC
  4785*   LOG = YES                                                    *ERCLOFC
  4786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4787*                                                                *ERCLOFC
  4788******************************************************************ERCLOFC
  4789                                                                  ERCLOFC
  4790 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4791     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4792         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4793                                                                  ERCLOFC
  4794     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4795         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4796         16  LO-CARRIER              PIC X.                       ERCLOFC
  4797         16  LO-GROUPING.                                         ERCLOFC
  4798             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4799             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4800         16  LO-STATE                PIC XX.                      ERCLOFC
  4801         16  LO-ACCOUNT.                                          ERCLOFC
  4802             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4803             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4804         16  LO-OFFICER-CODE         PIC X(5).
  4805                                                                  ERCLOFC
  4806     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4807                                                                  ERCLOFC
  4808     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4809     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4810     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4811                                                                  ERCLOFC
  4812     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4813             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4814             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4815     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4816             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4817             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4818                                                                  ERCLOFC
  4819     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4820     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4821     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4822                                                                  ERCLOFC
  4823     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4824     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4825                                                                  ERCLOFC
  4826     12  LO-OFFICER-INFO.                                         ERCLOFC
  4827         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4828             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4829             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4830             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4831             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4832             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4833             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4834             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4835             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4836     12  FILLER                      PIC X(198).
  4837******************************************************************ERCLOFC
  4838
  4839 FD  ERBXRF.
* 4840                                 COPY ERCBXRF.
  4841******************************************************************04/29/98
  4842*                                                                *ERCBXRF
  4843*                                                                *ERCBXRF
  4844*                            ERCBXRF                             *   LV002
  4845*                                                                *ERCBXRF
  4846*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4847*                                                                *ERCBXRF
  4848*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4849*                                                                *ERCBXRF
  4850*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4851*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4852*                                                                *ERCBXRF
  4853*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4854*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4855*                                                                *ERCBXRF
  4856*   LOG = NO                                                     *ERCBXRF
  4857*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4858*                                                                *ERCBXRF
  4859******************************************************************ERCBXRF
  4860                                                                  ERCBXRF
  4861 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4862     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4863         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4864                                                                  ERCBXRF
  4865     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4866         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4867         16  BK-CARRIER              PIC X.                       ERCBXRF
  4868         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4869         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4870                                                                  ERCBXRF
  4871     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4872         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4873         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4874         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4875         16  FILLER                  PIC X(9).                    ERCBXRF
  4876                                                                  ERCBXRF
  4877     12  FILLER                      PIC X(37).                   ERCBXRF
  4878                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4879     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4880                                                                  ERCBXRF
  4881     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4882                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4883         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4884         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4885         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4886         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4887         16  FILLER                  PIC X(20).                   ERCBXRF
  4888                                                                  ERCBXRF
  4889******************************************************************ERCBXRF
  4890
  4891 FD  ERAGTC.
* 4892                                 COPY ERCAGTC.
  4893******************************************************************
  4894*                                                                *
  4895*                                                                *
  4896*                            ERCAGTC                             *
  4897*                            VMOD=2.001                          *
  4898*                                                                *
  4899*   ONLINE CREDIT SYSTEM                                         *
  4900*                                                                *
  4901*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4902*                                                                *
  4903*   FILE TYPE = VSAM,KSDS                                        *
  4904*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4905*                                                                *
  4906*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4907*       ALTERNATE PATH = NONE                                    *
  4908*                                                                *
  4909*   LOG = NO                                                     *
  4910*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4911*                                                                *
  4912******************************************************************
  4913*                   C H A N G E   L O G
  4914*
  4915* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4916*-----------------------------------------------------------------
  4917*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4918* EFFECTIVE    NUMBER
  4919*-----------------------------------------------------------------
  4920* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4921* 111004                         NEW FILE AND COPYBOOK
  4922* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4923******************************************************************
  4924
  4925 01  AGENT-COMMISSIONS.
  4926     12  AG-RECORD-ID                          PIC XX.
  4927         88  VALID-CO-ID                          VALUE 'AG'.
  4928
  4929     12  AG-CONTROL-PRIMARY.
  4930         16  AG-COMPANY-CD                     PIC X.
  4931         16  AG-CONTROL.
  4932             20  AG-CTL-1.
  4933                 24  AG-CARR-GROUP.
  4934                     28  AG-CARRIER            PIC X.
  4935                     28  AG-GROUPING           PIC X(6).
  4936                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4937             20  AG-CTL-2.
  4938                 24  AG-EXP-DT                 PIC XX.
  4939         16  AG-TYPE                           PIC X.
  4940             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4941             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4942
  4943     12  AG-MAINT-INFORMATION.
  4944         16  AG-LAST-MAINT-DT                  PIC XX.
  4945         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4946         16  AG-LAST-MAINT-USER                PIC X(4).
  4947         16  FILLER                            PIC X(10).
  4948
  4949     12  AG-EFF-DT                             PIC XX.
  4950     12  AG-COMM-STRUCTURE.
  4951         16  AG-AGT-COMMS OCCURS 10.
  4952             20  AG-AGT                PIC X(10).
  4953             20  AG-COM-TYP            PIC X.
  4954             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4955             20  AG-RECALC-LV-INDIC    PIC X.
  4956             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4957             20  AG-LRCALC-LV-INDIC    PIC X.
  4958             20  FILLER                PIC X(05).
  4959
  4960     12  FILLER                  PIC X(145).
  4961******************************************************************
  4962
  4963 FD  ELCRTT.
* 4964                                 COPY ELCCRTT.
  4965******************************************************************
  4966*                                                                *ELCCRTT
  4967*                            ELCCRTT.                            *
  4968*                                                                *ELCCRTT
  4969*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4970*                                                                *ELCCRTT
  4971*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4972*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4973*                                                                *ELCCRTT
  4974*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4975*                                                                *ELCCRTT
  4976*   LOG = YES                                                    *ELCCRTT
  4977*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4978******************************************************************
  4979*                   C H A N G E   L O G
  4980*
  4981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4982*-----------------------------------------------------------------
  4983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4984* EFFECTIVE    NUMBER
  4985*-----------------------------------------------------------------
  4986* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4987* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4988* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4989* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4990* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4991******************************************************************
  4992                                                                  ELCCRTT
  4993 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4994     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4995         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  4996                                                                  ELCCRTT
  4997     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  4998         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  4999         16  CS-CARRIER                    PIC X.                 ELCCRTT
  5000         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  5001         16  CS-STATE                      PIC XX.                ELCCRTT
  5002         16  CS-ACCOUNT                    PIC X(10).
  5003         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  5004         16  CS-CERT-NO.                                          ELCCRTT
  5005             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  5006             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  5007         16  CS-TRAILER-TYPE               PIC X.
  5008             88  COMM-TRLR           VALUE 'A'.
  5009             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5010             88  CERT-DATA-TRLR      VALUE 'C'.
  5011                                                                  ELCCRTT
  5012     12  CS-DATA-AREA                      PIC X(516).
  5013
  5014     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5015         16  CS-BANK-COMMISSION-AREA.
  5016             20  CS-BANK-COMMS       OCCURS 10.
  5017                 24  CS-AGT                PIC X(10).
  5018                 24  CS-COM-TYP            PIC X.
  5019                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5020                 24  CS-RECALC-LV-INDIC    PIC X.
  5021                 24  FILLER                PIC X(10).
  5022
  5023         16  FILLER                        PIC X(256).
  5024
  5025     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5026****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5027****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5028         16  CS-MB-CLAIM-DATA OCCURS 2.
  5029             20  FILLER OCCURS 10.
  5030                 24  CS-CLAIM-TYPE         PIC X.
  5031                     88  CS-AH-CLM           VALUE 'A'.
  5032                     88  CS-IU-CLM           VALUE 'I'.
  5033                     88  CS-GP-CLM           VALUE 'G'.
  5034                     88  CS-LF-CLM           VALUE 'L'.
  5035                     88  CS-PR-CLM           VALUE 'P'.
  5036                 24  CS-BANK               PIC S999 COMP-3.
  5037                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5038                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5039                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5040         16  FILLER                        PIC X(216).
  5041
  5042     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5043         16  CS-VIN-NUMBER                 PIC X(17).
  5044         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5045         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5046         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5047         16  FILLER                        PIC X(496).
  5048
  5049******************************************************************ELCCRTT
  5050
  5051 FD  ERPDEF.
  5052
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  92
* EL517.cbl
* 5053                                 COPY ERCPDEF.
  5054******************************************************************
  5055*                                                                *
  5056*                                                                *
  5057*                            ERCPDEF.                            *
  5058*                                                                *
  5059*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5060*                                                                *
  5061*    FILE TYPE = VSAM,KSDS                                       *
  5062*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5063*                                                                *
  5064*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5065*                                                                *
  5066*    LOG = YES                                                   *
  5067*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5068******************************************************************
  5069 01  PRODUCT-MASTER.
  5070    12  PD-RECORD-ID                 PIC X(02).
  5071        88  VALID-PD-ID                  VALUE 'PD'.
  5072
  5073    12  PD-CONTROL-PRIMARY.
  5074        16  PD-COMPANY-CD            PIC X.
  5075        16  PD-STATE                 PIC XX.
  5076        16  PD-PRODUCT-CD            PIC XXX.
  5077        16  PD-FILLER                PIC X(7).
  5078        16  PD-BEN-TYPE              PIC X.
  5079        16  PD-BEN-CODE              PIC XX.
  5080        16  PD-PROD-EXP-DT           PIC XX.
  5081
  5082    12  FILLER                       PIC X(50).
  5083
  5084    12  PD-PRODUCT-DATA OCCURS 8.
  5085        16  PD-PROD-CODE             PIC X.
  5086            88  PD-PROD-LIFE           VALUE 'L'.
  5087            88  PD-PROD-PROP           VALUE 'P'.
  5088            88  PD-PROD-AH             VALUE 'A'.
  5089            88  PD-PROD-IU             VALUE 'I'.
  5090            88  PD-PROD-GAP            VALUE 'G'.
  5091        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5092        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5093        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5094        16  PD-MAX-TERM              PIC S999        COMP-3.
  5095        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5096        16  FILLER                   PIC X.
  5097        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5098        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5099        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5100        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5101        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5102        16  PD-REC-CRIT-PERIOD       PIC X.
  5103        16  PD-RTW-MOS               PIC 99.
  5104        16  FILLER                   PIC X(5).
  5105
  5106    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5107
  5108    12  PD-TERM-LIMITS OCCURS 15.
  5109        16  PD-LOW-TERM              PIC S999        COMP-3.
  5110        16  PD-HI-TERM               PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  93
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5111
  5112*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5113    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5114        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5115        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5116
  5117    12  PD-EARN-FACTORS.
  5118        16  FILLER OCCURS 15.
  5119            20  FILLER OCCURS 15.
  5120                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5121
  5122    12  PD-PRODUCT-DESC              PIC X(80).
  5123    12  PD-TRUNCATED                 PIC X.
  5124    12  FILLER                       PIC X(59).
  5125
  5126    12  PD-MAINT-INFORMATION.
  5127        16  PD-LAST-MAINT-DT         PIC X(02).
  5128        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5129        16  PD-LAST-MAINT-BY         PIC X(04).
  5130
  5131 FD  ELSTAT.
  5132
* 5133                                 COPY ELCSTATE.
  5134******************************************************************
  5135*                                                                *
  5136*                                                                *
  5137*                            ELCSTATE.                           *
  5138*                                                                *
  5139*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5140*                                                                *
  5141*   FILE TYPE = VSAM,KSDS                                        *
  5142*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5143*                                                                *
  5144*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5145*       ALTERNATE INDEX = NONE                                   *
  5146*                                                                *
  5147*   LOG = YES                                                    *
  5148*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5149******************************************************************
  5150*                   C H A N G E   L O G
  5151*
  5152* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5153*-----------------------------------------------------------------
  5154*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5155* EFFECTIVE    NUMBER
  5156*-----------------------------------------------------------------
  5157* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5158******************************************************************
  5159*
  5160 01  STATE-FILE.
  5161     12  SF-RECORD-ID                       PIC XX.
  5162         88  VALID-CF-ID                        VALUE 'SF'.
  5163
  5164     12  SF-CONTROL-PRIMARY.
  5165         16  SF-COMPANY-ID                  PIC XXX.
  5166         16  SF-CARRIER-CODE                PIC X.
  5167         16  SF-GROUPING                    PIC X(6).
  5168         16  SF-STATE-CODE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5169         16  SF-EXPIRE-DATE                 PIC 9(8).
  5170
  5171****************************************************************
  5172*             STATE CONTROLS
  5173****************************************************************
  5174
  5175     12  SF-LAST-MAINT-DT                   PIC XX.
  5176     12  SF-LAST-MAINT-BY                   PIC X(4).
  5177     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5178
  5179     12  SF-STATE-RT-CONTROLS.
  5180         16  SF-ST-RT-CALC                  PIC X.
  5181
  5182     12  SF-ST-TAX-CONTROLS.
  5183         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5184         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5185         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5186
  5187     12  SF-ST-REFUND-OPTIONS.
  5188         16  SF-ST-RF-LR-CALC               PIC X.
  5189         16  SF-ST-RF-LL-CALC               PIC X.
  5190         16  SF-ST-RF-LN-CALC               PIC X.
  5191         16  SF-ST-RF-AH-CALC               PIC X.
  5192         16  SF-ST-RF-CP-CALC               PIC X.
  5193
  5194     12  SF-ST-UNEARN-PREM-OPTIONS.
  5195         16  SF-ST-LUEP-R78                 PIC X.
  5196         16  SF-ST-LUEP-PRO                 PIC X.
  5197         16  SF-ST-LUEP-ST                  PIC X.
  5198         16  SF-ST-LUEP-DOM                 PIC X.
  5199         16  SF-ST-AUEP-R78                 PIC X.
  5200         16  SF-ST-AUEP-PRO                 PIC X.
  5201         16  SF-ST-AUEP-ST                  PIC X.
  5202         16  SF-ST-AUEP-DOM                 PIC X.
  5203         16  SF-ST-CUEP-R78                 PIC X.
  5204         16  SF-ST-CUEP-PRO                 PIC X.
  5205         16  SF-ST-CUEP-ST                  PIC X.
  5206         16  SF-ST-CUEP-DOM                 PIC X.
  5207
  5208     12  SF-ST-EARN-PREM-OPTIONS.
  5209         16  SF-ST-LEP-R78                  PIC X.
  5210         16  SF-ST-LEP-PRO                  PIC X.
  5211         16  SF-ST-LEP-ST                   PIC X.
  5212         16  SF-ST-LEP-DOM                  PIC X.
  5213         16  SF-ST-AEP-R78                  PIC X.
  5214         16  SF-ST-AEP-PRO                  PIC X.
  5215         16  SF-ST-AEP-ST                   PIC X.
  5216         16  SF-ST-AEP-DOM                  PIC X.
  5217         16  SF-ST-CEP-R78                  PIC X.
  5218         16  SF-ST-CEP-PRO                  PIC X.
  5219         16  SF-ST-CEP-ST                   PIC X.
  5220         16  SF-ST-CEP-DOM                  PIC X.
  5221
  5222     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5223
  5224 FD  ELCRTO.
  5225
* 5226                                 COPY ELCCRTO.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5227******************************************************************
  5228*                                                                *
  5229*                            ELCCRTO.                            *
  5230*                                                                *
  5231*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5232*                                                                *
  5233*   FILE TYPE = VSAM,KSDS                                        *
  5234*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5235*                                                                *
  5236*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5237*                                                                *
  5238*   LOG = YES                                                    *
  5239*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5240******************************************************************
  5241*                   C H A N G E   L O G
  5242*
  5243* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5244*-----------------------------------------------------------------
  5245*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5246* EFFECTIVE    NUMBER
  5247*-----------------------------------------------------------------
  5248* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5249* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5250* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5251* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5252* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5253******************************************************************
  5254
  5255 01  ORIGINAL-CERTIFICATE.
  5256     12  OC-RECORD-ID                      PIC XX.
  5257         88  VALID-OC-ID                      VALUE 'OC'.
  5258
  5259     12  OC-CONTROL-PRIMARY.
  5260         16  OC-COMPANY-CD                 PIC X.
  5261         16  OC-CARRIER                    PIC X.
  5262         16  OC-GROUPING                   PIC X(6).
  5263         16  OC-STATE                      PIC XX.
  5264         16  OC-ACCOUNT                    PIC X(10).
  5265         16  OC-CERT-EFF-DT                PIC XX.
  5266         16  OC-CERT-NO.
  5267             20  OC-CERT-PRIME             PIC X(10).
  5268             20  OC-CERT-SFX               PIC X.
  5269         16  OC-RECORD-TYPE                PIC X.
  5270         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5271
  5272     12  OC-LAST-MAINT-DT                  PIC XX.
  5273     12  OC-LAST-MAINT-BY                  PIC X(4).
  5274     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5275
  5276     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5277     12  FILLER                            PIC X(49).
  5278
  5279     12  OC-ORIG-REC.
  5280         16  OC-INS-LAST-NAME              PIC X(15).
  5281         16  OC-INS-FIRST-NAME             PIC X(10).
  5282         16  OC-INS-MIDDLE-INIT            PIC X.
  5283         16  OC-INS-AGE                    PIC S999     COMP-3.
  5284         16  OC-JNT-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5285         16  OC-JNT-FIRST-NAME             PIC X(10).
  5286         16  OC-JNT-MIDDLE-INIT            PIC X.
  5287         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5288         16  OC-LF-BENCD                   PIC XX.
  5289         16  OC-LF-TERM                    PIC S999      COMP-3.
  5290         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5291         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5292         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5293         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5294         16  OC-LF-EXP-DT                  PIC XX.
  5295         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5296         16  OC-LF-CANCEL-DT               PIC XX.
  5297         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5298         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5299         16  OC-AH-BENCD                   PIC XX.
  5300         16  OC-AH-TERM                    PIC S999      COMP-3.
  5301         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5302         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5303         16  OC-AH-EXP-DT                  PIC XX.
  5304         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5305         16  OC-AH-CP                      PIC 99.
  5306         16  OC-AH-CANCEL-DT               PIC XX.
  5307         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5308         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5309         16  OC-CRED-BENE-NAME             PIC X(25).
  5310         16  OC-1ST-PMT-DT                 PIC XX.
  5311         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5312         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5313         16  OC-ISSUE-TRAN-IND             PIC X.
  5314         16  OC-CANCEL-TRAN-IND            PIC X.
  5315         16  FILLER                        PIC X(211).
  5316
  5317     12  FILLER                            PIC X(50).
  5318
  5319******************************************************************
  5320
  5321 WORKING-STORAGE SECTION.
  5322 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5323 77  FILLER   PIC X(32) VALUE '********************************'.
  5324 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5325 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5326
  5327 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5328 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5329 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5330 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5331
  5332 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5333 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5334 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5335 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5336 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5337 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5338 77  X                      PIC X                  VALUE ' '.
  5339 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5340
  5341 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5342 01  TRAN-CX REDEFINES TRAN-CT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  97
* EL517.cbl
  5343     12  FILLER             PIC XX.
  5344     12  TCX                PIC 999.
  5345 01  SEQ-NO                 PIC 9999               VALUE 0.
  5346 01  RPND                   PIC 9(5)               VALUE 0.
  5347 01  WPND                   PIC 9(5)               VALUE 0.
  5348 01  RREI                   PIC 9(5)               VALUE 0.
  5349 01  RCTB                   PIC 9(5)               VALUE 0.
  5350 01  RACC                   PIC 9(5)               VALUE 0.
  5351 01  RCER                   PIC 9(5)               VALUE 0.
  5352 01  RCNT                   PIC 9(5)               VALUE 0.
  5353 01  WCER                   PIC 9(5)               VALUE 0.
  5354 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5355 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5356 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5357 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5358 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5359 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5360 01  EMSG.
  5361     12  WS-FILE-ERROR-MESSAGE.
  5362         16  FILLER              PIC X(24)   VALUE
  5363             'ERROR OCCURED OPENING - '.
  5364         16  WS-FEM-FILE-NAME    PIC X(8).
  5365
  5366 01  CMSG.
  5367     12  WS-FILE-ERROR-MESSAGE.
  5368         16  FILLER              PIC X(24)   VALUE
  5369             'ERROR OCCURED CLOSING - '.
  5370         16  WS-CEM-FILE-NAME    PIC X(8).
  5371
  5372 01  RMSG.
  5373     12  WS-FILE-ERROR-MESSAGE.
  5374         16  FILLER              PIC X(24)   VALUE
  5375             'ERROR OCCURED READING - '.
  5376         16  WS-REM-FILE-NAME    PIC X(8).
  5377
  5378 01  HDG1.
  5379     12  FILLER                  PIC X(50)       VALUE ' '.
  5380     12  FILLER                  PIC X(28)       VALUE
  5381                   'PENDING BUSINESS FILE EDIT '.
  5382     12  ER-ONLY                 PIC X(47)       VALUE
  5383          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5384     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5385
  5386 01  HDG2.
  5387     12  FILLER              PIC X(52)              VALUE SPACE.
  5388     12  H2-COMP             PIC X(30).
  5389     12  FILLER              PIC X(42)              VALUE SPACE.
  5390     12  H2-DATE             PIC X(8).
  5391
  5392 01  HDG3.
  5393     12  FILLER              PIC X(54)              VALUE SPACE.
  5394     12  H3-DATE             PIC X(18).
  5395     12  FILLER              PIC X(49)              VALUE SPACE.
  5396
  5397 01  SUM1.
  5398     12  FILLER              PIC XX                 VALUE ' '.
  5399     12  SUM-TOT             PIC ZZ,ZZZ.
  5400     12  FILLER              PIC X(3)               VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  98
* EL517.cbl
  5401     12  FILLER              PIC X(30)              VALUE
  5402          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page  99
* EL517.cbl
  5404
  5405 01  WX-AREA.
  5406     12  PH-COBOL            PIC X.
  5407     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5408
  5409 01  STATUS-SWITCH.
  5410     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5411     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5412     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5413     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5414     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5415     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5416     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5417     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5418     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5419     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5420     12  ERACCT-FILE-STATUS.
  5421         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5422         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5423     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5424     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5425     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5426     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5427     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5428     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5429     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5430     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5431     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5432     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5433     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5434
  5435     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5436     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5437     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5438     12  WS-SW-1                  PIC X  VALUE ' '.
  5439     12  WS-SW-2                  PIC X  VALUE ' '.
  5440
  5441     12  WS-COMPUTED-TOTALS      COMP-3.
  5442         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5443         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5444         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5445         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5446         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5447         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5448         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5449         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5450         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5451         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5452     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5453         88  CO-HAS-CLAIMS                     VALUE '2'.
  5454
  5455     12  EIBDATE                 PIC S9(7)     COMP-3.
  5456
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 100
* EL517.cbl
  5458
  5459* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5460     COPY ELC50W1.
  5461******************************************************************04/19/98
  5462*                                                                *ELC50W1
  5463*                                                                *ELC50W1
  5464*                             ELC50W1                            *   LV005
  5465*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5466*                            VMOD=2.004                          *   CL**5
  5467*                                                                *ELC50W1
  5468*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5469*                                                                *ELC50W1
  5470*                                                                *ELC50W1
  5471******************************************************************ELC50W1
  5472                                                                  ELC50W1
  5473     12  WK-WORK-AREA.                                            ELC50W1
  5474         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5475         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5476         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5477         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5478         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5479         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5480         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5481         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5482         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5483         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5484         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5485         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5486         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5487         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5488         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5489         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5490             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5491             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5492             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5493             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5494             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5495             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5496         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5497         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5498             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5499             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5500             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5501         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5502             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5503         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5504         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5505     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5506         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5507         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5508         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5509         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5510         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5511         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5512         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5513         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5514     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5515         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5516         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5517         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5518             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5519         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5520
  5521         16  WK-CONV-GREG.
  5522             24  WCG-CENT             PIC XX.
  5523             24  WCG-REST             PIC X(4).
  5524         16  WORK-GREGORIAN-DATE.
  5525             24  WK-GREG-CENT         PIC XX.
  5526             24  WK-GREG-DATE-YYMMDD.
  5527                 28  WK-GREG-YYMM     PIC X(4).
  5528                 28  WK-GREG-DD       PIC XX.
  5529
  5530         16  WORK-SELECT-DATE.
  5531             24  WK-SELECT-CENT           PIC XX.
  5532             24  WK-SELECT-DATE-YYMMDD.
  5533                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5534                 28  FILLER               PIC XX.
  5535
  5536         16  WK-FORM-NO.
  5537             24  WK-FORM-BANK-ID       PIC X(5).
  5538             24  WK-FORM-UNDRWRTR      PIC X(1).
  5539             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5540
  5541         16  WK-MEMBER-NO.
  5542             24  WK-MEMBER-1-6        PIC X(6).
  5543             24  WK-MEMBER-7-12       PIC X(6).
  5544
  5545         16  WK-FULL-CERT-NO.
  5546             24  WK-CERT-POS-1-2      PIC X(2).
  5547             24  WK-CERT-POS-3        PIC X(1).
  5548             24  WK-CERT-POS-4        PIC X(1).
  5549             24  WK-CERT-POS-5-6      PIC X(2).
  5550             24  WK-CERT-POS-7        PIC X(1).
  5551             24  WK-CERT-POS-8-11     PIC X(4).
  5552
  5553         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5554             88  VALID-RATE-CODE     VALUE 'Y'.
  5555             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5556
  5557     12  WK-BATCH-NO.
  5558         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5559         16  FILLER                   PIC XXX       VALUE SPACES.
  5560
* 5561                                  COPY ELCEDITC.
  5562******************************************************************04/15/98
  5563*                                                                *ELCEDITC
  5564*                                                                *ELCEDITC
  5565*                            ELCEDITC                            *   LV002
  5566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5567*                            VMOD=2.012                          *   CL**2
  5568*                                                                *ELCEDITC
  5569*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5570*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5571*                                                                *ELCEDITC
  5572******************************************************************ELCEDITC
  5573******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5574*                   C H A N G E   L O G
  5575*
  5576* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5577*-----------------------------------------------------------------
  5578*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5579* EFFECTIVE    NUMBER
  5580*-----------------------------------------------------------------
  5581* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5582******************************************************************
  5583                                                                  ELCEDITC
  5584     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5585         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5586         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5587         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5588         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5589         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5590         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5591         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5592         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5593         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5594         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5595               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5596               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5597               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5598               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5599                                                                  ELCEDITC
  5600         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5601               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5602               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5603               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5604               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5605               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5606               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5607               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5608               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5609               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5610               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5611                                                                  ELCEDITC
  5612         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5613               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5614               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5615               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5616               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5617               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5618               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5619               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5620               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5621                                                                  ELCEDITC
  5622         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5623                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5624                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5625                                                                  ELCEDITC
  5626         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5627                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5628                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5629                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5630                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5631                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5632                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5633                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5634                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5635                                                                  ELCEDITC
  5636         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5637               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5638               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5639                                                                  ELCEDITC
  5640         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5641         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5642         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5643         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5644         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5645                                                                  ELCEDITC
  5646         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5647               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5648               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5649               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5650               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5651                                                                  ELCEDITC
  5652         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5653               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5654               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5655               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5656               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5657                                                                  ELCEDITC
  5658         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5659                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5660                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5661                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5662                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5663                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5664                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5665                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5666                                                                  ELCEDITC
  5667         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5668                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5669                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5670                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5671                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5672                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5673                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5674                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5675                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5676                                                                  ELCEDITC
  5677         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5678                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5679                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5680                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5681                                                                  ELCEDITC
  5682         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5683                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5684                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5685                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5686                                                                  ELCEDITC
  5687         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5688         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5689         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5690         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5691                                                                  ELCEDITC
  5692         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5693         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5694                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5695                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5696                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5697                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5698                                                                  ELCEDITC
  5699         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5700               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5701               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5702               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5703               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5704               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5705                                                                  ELCEDITC
  5706         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5707               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5708               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5709               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5710               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5711               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5712                                                                  ELCEDITC
  5713         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5714                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5715                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5716                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5717                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5718                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5719                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5720                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5721                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5722                                                                  ELCEDITC
  5723         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5724                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5725                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5726                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5727                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5728                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5729                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5730                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5731                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5732                                                                  ELCEDITC
  5733         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5734         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5735         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5736         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5737         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5738         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5739         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5740         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5741         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5742         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5743         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5744         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5745                                                                  ELCEDITC
  5746         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5747                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5748                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5749                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5750                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5751                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5752                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5753                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5754                                                                  ELCEDITC
  5755         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5756                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5757                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5758                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5759                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5760                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5761                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5762                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5763                                                                  ELCEDITC
  5764         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5765                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5766                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5767                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5768                                                                  ELCEDITC
  5769         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5770         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5771         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5772         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5773         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5774         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5775         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5776         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5777         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5778                                                                  ELCEDITC
  5779         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5780         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5781         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5782         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5783         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5784         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5785         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5786         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5787         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5788         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5789         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5790         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5791         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5792         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5793         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5794                                                                  ELCEDITC
  5795         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5796             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5797                                             'M' '5' '9' '2'.     ELCEDITC
  5798             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5799             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5800             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5801             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5802             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5803             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5804             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5805             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 106
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5806             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5807             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5808                                                                  ELCEDITC
  5809         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5810             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5811                                             'M' '5' '9' '2'.     ELCEDITC
  5812             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5813             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5814             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5815             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5816             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5817             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5818             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5819             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5820             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5821             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5822                                                                  ELCEDITC
  5823         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5824         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5825         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5826         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5827         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5828                                                                  ELCEDITC
  5829*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5830*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5831         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5832                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5833                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5834                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5835                                                                  ELCEDITC
  5836         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5837         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5838         16  FILLER                    PIC X.                     ELCEDITC
  5839*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5840         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5841             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5842             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5843             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5844             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5845             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5846             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5847             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5848             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5849             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5850         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 107
* EL517.cbl
* 5852                                  COPY ELC50WS.
  5853*****************************************************************
  5854*                                                               *
  5855*                            ELC50WS.                           *
  5856*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5857*                            VMOD=2.061.                        *
  5858*                                                               *
  5859*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5860*                                   EL517                       *
  5861*****************************************************************
  5862******************************************************************
  5863*                   C H A N G E   L O G
  5864*
  5865* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5866*-----------------------------------------------------------------
  5867*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5868* EFFECTIVE    NUMBER
  5869*-----------------------------------------------------------------
  5870* 123102                   PEMA  ADD DCC PROCESSING
  5871* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5872* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5873* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5874* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5875* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5876* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5877* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5878* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5879* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5880* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5881* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5882* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5883* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5884* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5885* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5886* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5887* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5888* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5889* 030309  CR2009021700001  PEMA  ADD ER-2883
  5890* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5891* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5892* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5893* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5894* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5895* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5896* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5897* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5898* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5899* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5900* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5901* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5902* 061412  CR2011022800001  AJRA  NAPERSOFT
  5903* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5904* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5905* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5906* 101314  IR2013100100002  PEMA  ADD ERROR 1572
  5907* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  5908* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
  5909*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 108
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5910
  5911 01  WORK-AREAS.
  5912
  5913*****************************************************************
  5914*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5915*****************************************************************
  5916
  5917     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5918     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5919     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5920     12  WS-NAME-EDIT-WORK-AREA.
  5921         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5922         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5923             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5924         16  WS-WORK-NAME.
  5925             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5926             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5927             20  FILLER           PIC X(10)     VALUE SPACES.
  5928         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5929             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5930
  5931*****************************************************************
  5932*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5933*****************************************************************
  5934
  5935     12  WS-ERRESC-KEY.
  5936         16 WS-ERRESC-SEARCH-KEY.
  5937             20  WS-ERRESC-COMPANY-CD PIC  X.
  5938             20  WS-ERRESC-CARRIER    PIC  X.
  5939             20  WS-ERRESC-GROUP      PIC X(6).
  5940             20  WS-ERRESC-STATE      PIC XX.
  5941             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5942         16 WS-ERRESC-RESIDUAL-KEY.
  5943             20  WS-ERRESC-AGENT      PIC X(10).
  5944             20  WS-ERRESC-RES-STATE  PIC XX.
  5945             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5946*                                          YYYYMMDD
  5947     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5948     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5949
  5950*RESIDENT STATE TAX MASTER(ERRESS)
  5951*
  5952     12  WS-ERRESS-KEY.
  5953         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5954         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5955         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5956         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5957*                                          YYYYMMDD
  5958
  5959     12  WS-CONTRACT-DATE              PIC 9(8).
  5960*                                          YYYYMMDD
  5961     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5962     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5963         16 WS-YEAR-YY                 PIC   9999.
  5964         16 FILLER                     PIC 9(4).
  5965*                                          YYYYMMDD
  5966     12  WS-SAVE-ERRESS-KEY            PIC X(9).
  5967     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 109
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5968     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5969     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5970
  5971     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5972         88  DPRB-1ST-TIME                      VALUE ' '.
  5973
  5974*****************************************************************
  5975*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5976*****************************************************************
  5977
  5978     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5979     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5980     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5981     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5982     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5983     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5984     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5985     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5986     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5987     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5988         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5989         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5990     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5991         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5992         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5993     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5994
  5995     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5996     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  5997
  5998     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  5999     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  6000     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6001     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6002     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6003     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6004     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6005     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6006     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6007     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6008     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6009     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6010     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  6011     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  6012     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  6013     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  6014     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6015     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6016     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6017     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6018     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6019     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6020     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6021     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6022     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6023     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6024     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6025     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 110
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6026     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6027     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6028     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6029     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6030     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6031     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6032     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  6033     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  6034     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  6035     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  6036     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  6037     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  6038     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  6039     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  6040     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  6041     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  6042     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6043     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6044     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6045     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6046     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6047     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6048     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6049     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6050     12  WS-2671-SW               PIC X         VALUE SPACE.
  6051     12  WS-2672-SW               PIC X         VALUE SPACE.
  6052     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6053         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6054     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6055         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6056     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6057
  6058     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6059         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6060         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6061         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6062         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6063
  6064     12  WS-CREDIT-EDIT-CONTROLS.
  6065         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6066         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6067         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6068         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6069         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6070         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6071
  6072     12  WS-AGE-FIELDS.
  6073         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6074         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6075         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6076         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6077
  6078     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6079         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6080         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6081         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6082         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
  6083         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 111
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6084         16  FILLER                      PIC XX.
  6085
  6086     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
  6087     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6088     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6089     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6090     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6091     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6092     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6093     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6094     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6095     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6096
  6097     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6098     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6099     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6100     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6101     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6102     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6103     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6104     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6105         88  WS-REDUCING              VALUE 'R'.
  6106         88  WS-LEVEL                 VALUE 'L' 'P'.
  6107     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6108
  6109     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6110     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6111     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6112     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6113     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6114     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6115     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6116     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6117     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6118
  6119     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6120     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6121     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6122     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6123     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6124     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6125     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6126     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6127     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6128     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6129     12  WS-ACCT-SIG-SW.
  6130         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6131         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6132     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6133     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6134     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6135     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6136     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6137     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6138     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6139     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6140     12  WS-INITIALS.
  6141         16  WS-INIT-1            PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 112
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6142         16  WS-INIT-2            PIC X         VALUE SPACES.
  6143
  6144     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
  6145     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6146     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6147     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6148     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6149*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6150     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6151     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6152     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6153     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6154     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6155     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6156     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6157     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6158     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6159     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6160     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6161     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6162     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6163     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6164     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6165     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6166     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6167     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6168     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6169     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6170     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6171     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6172******** FLA
  6173     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6174     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6175     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6176     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6177     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6178********
  6179     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6180     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6181     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6182     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6183     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6184     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6185     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6186     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6187     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6188     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6189
  6190     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6191         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6192                                         '0' THRU '9'.
  6193
  6194     12  NUMBER-OF-MONTHS.
  6195         16  SK-MO OCCURS 12 TIMES PIC X.
  6196
  6197     12  WS-WORK-DATE.
  6198         16  WS-YEAR            PIC 99    VALUE 00.
  6199         16  WS-MONTH           PIC 99    VALUE 00.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 113
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6200         16  WS-DAY             PIC 99    VALUE 00.
  6201
  6202     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
  6203     12  WS-WORK-CRIT-DEV       REDEFINES
  6204         WS-WORK-LF-CRIT-PER    PIC X(03).
  6205
  6206     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6207     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6208
  6209     12  WS-WORK-DATE-FROM.
  6210         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6211         16  FILLER             PIC X  VALUE SPACE.
  6212         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6213         16  FILLER             PIC X         VALUE SPACE.
  6214         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6215
  6216     12  WS-WORK-DATE-THRU.
  6217         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6218         16  FILLER             PIC X         VALUE SPACE.
  6219         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6220         16  FILLER             PIC X         VALUE SPACE.
  6221         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6222
  6223     12  WS-LF-INPUT-CD.
  6224         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6225         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6226
  6227     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6228     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6229         16  WS-AH-INPUT-CD-1   PIC X.
  6230         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6231
  6232     12  WS-SWITCHES.
  6233         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6234         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6235             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6236         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6237             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6238         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6239             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6240         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6241             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6242         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6243             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6244         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6245             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6246         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6247             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6248         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6249             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6250         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6251             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6252         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6253             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6254         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6255             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6256         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
  6257             88  FORM-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 114
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6258         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6259             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6260         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
  6261             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6262         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6263             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6264         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6265             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6266         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6267             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6268         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6269             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6270         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6271             88  AH-BENEFIT-FOUND         VALUE ' '.
  6272             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6273         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6274             88  LF-BENEFIT-FOUND         VALUE ' '.
  6275             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6276         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6277             88  NO-STATE-RECORD          VALUE '1'.
  6278         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6279             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6280         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6281             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6282         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6283             88  CERT-WAS-FOUND           VALUE ' '.
  6284             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6285         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6286             88  BROWSE-STARTED           VALUE 'Y'.
  6287         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6288             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6289         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6290             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6291         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6292             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6293         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6294             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6295         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6296             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6297         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6298             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6299         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6300             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6301             88  FIRST-TIME-THROUGH       VALUE '1'.
  6302             88  CTBL-NOT-FOUND           VALUE '2'.
  6303
  6304         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6305             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6306
  6307         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6308             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6309
  6310********FLA
  6311     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6312     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6313********
  6314     12  RC-SW-1                  PIC X           VALUE '0'.
  6315     12  RC-SW-2                  PIC X           VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 115
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6316     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6317     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6318     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
  6319     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6320     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6321     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6322     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6323     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6324     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6325     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6326     12  LIT-SPACES               PIC X           VALUE SPACES.
  6327     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6328     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6329     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6330     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6331     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6332     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6333     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6334         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6335         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6336     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6337         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6338
  6339 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6340     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6341     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6342 01  WS-CRI-SSN-WORK-AREA.
  6343     05  WS-CRI-SOC-SEC-NO.
  6344         10  WS-SS-REPT-CD       PIC X(5).
  6345         10  WS-SS-LAST-NAME     PIC X(5).
  6346         10  WS-SS-INITIAL       PIC X.
  6347
  6348     05  WS-CRI-REPORT-CODE.
  6349         10  FILLER              PIC X(5).
  6350         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6351
  6352     05  WS-CRI-LAST-NAME.
  6353         10  WS-CRI-NAME-MOVE    PIC X(5).
  6354         10  FILLER              PIC X(10).
  6355
  6356 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6357     '12345678012345070923456789'.
  6358 01  FILLER REDEFINES WS-NUM-TABLE.
  6359     05  WS-NUM OCCURS 26        PIC 9.
  6360 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6361 01  V1                          PIC S999 COMP-3.
  6362 01  V2                          PIC S999 COMP-3.
  6363 01  V3                          PIC S999 COMP-3.
  6364 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6365 01  FILLER REDEFINES WS-WORK-VIN.
  6366     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6367 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6368 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6369 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6370 01  WS-HEX-WORK.
  6371     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6372     05  WS-HEX-BYTE             PIC X.
  6373 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 116
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6374 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6375
  6376 01  WS-WORK-HIN-ROW-B.
  6377     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6378
  6379 01  ws-benefit-cd-chg-sw      pic x value spaces.
  6380     88  benefit-code-chg           value 'Y'.
  6381 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6382 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6383     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6384 01  WS-ROW-D-TABLE.
  6385     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6386
  6387 01  WS-HIN-TABLE-B.
  6388     05  F                       PIC XX VALUE 'A2'.
  6389     05  F                       PIC XX VALUE 'B3'.
  6390     05  F                       PIC XX VALUE 'C4'.
  6391     05  F                       PIC XX VALUE 'D5'.
  6392     05  F                       PIC XX VALUE 'E6'.
  6393     05  F                       PIC XX VALUE 'F7'.
  6394     05  F                       PIC XX VALUE 'G8'.
  6395     05  F                       PIC XX VALUE 'H9'.
  6396     05  F                       PIC XX VALUE 'I1'.
  6397     05  F                       PIC XX VALUE 'J2'.
  6398     05  F                       PIC XX VALUE 'K3'.
  6399     05  F                       PIC XX VALUE 'L4'.
  6400     05  F                       PIC XX VALUE 'M5'.
  6401     05  F                       PIC XX VALUE 'N6'.
  6402     05  F                       PIC XX VALUE 'O0'.
  6403     05  F                       PIC XX VALUE 'P7'.
  6404     05  F                       PIC XX VALUE 'Q0'.
  6405     05  F                       PIC XX VALUE 'R8'.
  6406     05  F                       PIC XX VALUE 'S9'.
  6407     05  F                       PIC XX VALUE 'T2'.
  6408     05  F                       PIC XX VALUE 'U3'.
  6409     05  F                       PIC XX VALUE 'V4'.
  6410     05  F                       PIC XX VALUE 'W5'.
  6411     05  F                       PIC XX VALUE 'X6'.
  6412     05  F                       PIC XX VALUE 'Y7'.
  6413     05  F                       PIC XX VALUE 'Z8'.
  6414 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6415     05  WS-VAL-IN               PIC X.
  6416     05  WS-VAL-OUT              PIC 9.
  6417 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6418
  6419 01  WS-COMPARE-BINARY-DATES.
  6420     05  WS-971231                PIC XX VALUE X'92FF'.
  6421     05  WS-931231                PIC XX VALUE X'8CFF'.
  6422     05  WS-791231                PIC XX VALUE X'77FF'.
  6423     05  WS-771001                PIC XX VALUE X'74A1'.
  6424     05  WS-820301                PIC XX VALUE X'7B41'.
  6425     05  WS-831031                PIC XX VALUE X'7DBF'.
  6426     05  WS-831231                PIC XX VALUE X'7DFF'.
  6427     05  WS-810831                PIC XX VALUE X'7A7F'.
  6428     05  WS-830901                PIC XX VALUE X'7D81'.
  6429
  6430 01  FILE-ACCESS-IDS.
  6431     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 117
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6432     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6433     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6434     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6435     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6436     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
  6437     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6438     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6439     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6440     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6441     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6442     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6443     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6444     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6445     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6446     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6447     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6448
  6449 01  DD-IU-SW                    PIC X   VALUE ' '.
  6450     88  DD-IU-PRESENT                 VALUE 'Y'.
  6451
  6452 01  ACCESS-KEYS.
  6453     12  ELMSTR-KEY.
  6454         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6455         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6456     12  W-CLAIM-KEY.
  6457         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6458         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6459
  6460     12  ELCNTL-KEY.
  6461         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6462         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6463         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6464         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6465
  6466     12  ELCERT-KEY.
  6467         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6468         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6469         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6470         16  CERT-STATE           PIC XX      VALUE SPACES.
  6471         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6472         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6473         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6474
  6475     12  ELCERT2-KEY.
  6476         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6477         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6478
  6479     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6480
  6481     12  ELCERT-SAVE.
  6482         16  FILLER                      PIC XX    VALUE SPACES.
  6483
  6484         16  WCS-CONTROL-PRIMARY.
  6485             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6486             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6487             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6488             20  WCS-STATE               PIC XX    VALUE SPACES.
  6489             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 118
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6490             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6491             20  WCS-CERT-NO.
  6492                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6493                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6494
  6495         16  CS-CONTROL-BY-NAME.
  6496             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6497             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6498             20  CS-INSURED-INITIALS.
  6499                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6500                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6501
  6502         16  CS-CONTROL-BY-SSN.
  6503             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6504             20  CS-SOC-SEC-NO.
  6505                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6506                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6507                 24  CS-SSN-LN3.
  6508                     28 CS-INSURED-INITIALS-A2   PIC XX
  6509                                     VALUE SPACES.
  6510                     28 CS-PART-LAST-NAME-A2     PIC X
  6511                                     VALUE SPACE.
  6512
  6513         16  CS-CONTROL-BY-CERT-NO.
  6514             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6515             20  CS-CERT-NO-A4           PIC X(11)
  6516                                     VALUE SPACES.
  6517
  6518         16  CS-CONTROL-BY-MEMB.
  6519             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6520             20  CS-MEMBER-NO.
  6521                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6522                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6523                 24  CS-MEMB-LN4.
  6524                     28 CS-INSURED-INITIALS-A5   PIC XX
  6525                                      VALUE SPACES.
  6526                     28 CS-PART-LAST-NAME-A5     PIC XX
  6527                                      VALUE SPACES.
  6528
  6529         16  FILLER              PIC X(360) VALUE SPACES.
  6530
  6531     12  ERACCT-KEY.
  6532         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6533         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6534         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6535         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6536         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6537         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6538
  6539     12  ERCOMP-KEY.
  6540         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6541         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6542         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6543         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6544         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6545         16  COMP-TYPE            PIC X     VALUE SPACES.
  6546
  6547     12  ERLOFC-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 119
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6548         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6549         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6550         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6551         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6552         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
  6553         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6554
  6555     12  WS-ELCRTT-KEY.
  6556         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6557         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6558
  6559     12  ERBXRF-KEY.
  6560         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6561         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6562         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6563         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6564
  6565     12  ERAGTC-KEY.
  6566         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6567         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6568         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6569         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6570         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6571         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6572
  6573     12  ERPLAN-KEY.
  6574         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6575         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6576         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6577         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6578         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6579         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6580         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6581         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6582
  6583     12  ERFORM-KEY.
  6584         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6585         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6586         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6587         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6588
  6589     12  ERREIN-KEY.
  6590         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6591         16  REIN-TYPE            PIC X     VALUE SPACES.
  6592         16  REIN-TABLE-CO.
  6593             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6594             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6595             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6596         16  FILLER               PIC X(3)  VALUE SPACES.
  6597
  6598     12  ERCTBL-KEY.
  6599         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6600         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6601         16  CTBL-CNTRL-2.
  6602             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6603             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6604
  6605     12  ELCRTO-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 120
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6606         16  ELCRTO-COMPANY-CD       PIC X.
  6607         16  ELCRTO-CARRIER          PIC X.
  6608         16  ELCRTO-GROUPING         PIC X(6).
  6609         16  ELCRTO-STATE            PIC XX.
  6610         16  ELCRTO-ACCOUNT          PIC X(10).
  6611         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6612         16  ELCRTO-CERT-NO.
  6613             20  ELCRTO-CERT-PRIME   PIC X(10).
  6614             20  ELCRTO-CERT-SFX     PIC X.
  6615         16  ELCRTO-RECORD-TYPE      PIC X.
  6616         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6617
  6618
  6619     12  WS-ACCESS.
  6620         16  FILLER               PIC XX    VALUE SPACES.
  6621         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6622
  6623     12  WS-CARR-ACCESS.
  6624         16  FILLER               PIC X(3)  VALUE SPACES.
  6625         16  WS-CARR              PIC X     VALUE SPACE.
  6626*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6627*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6628     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6629         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6630         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6631         88  WS-DMD-NO-RATING   VALUE 'N'.
  6632
  6633
  6634     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6635         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6636                                         'NJ' 'NL'
  6637                                         'PJ' 'PL'
  6638                                         'SJ' 'SL'.
  6639     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6640         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6641                                         'NI' 'NJ' 'NL' 'NU'
  6642                                         'PJ' 'PL' 'PI' 'PU'
  6643                                         'SI' 'SJ' 'SL' 'SU'
  6644                                         'MX' 'MY' 'MZ'.
  6645
  6646 01  ERPDEF-KEY-SAVE             PIC X(18).
  6647 01  ERPDEF-KEY.
  6648     12  ERPDEF-COMPANY-CD       PIC X.
  6649     12  ERPDEF-STATE            PIC XX.
  6650     12  ERPDEF-PROD-CD          PIC XXX.
  6651     12  F                       PIC X(7).
  6652     12  ERPDEF-BEN-TYPE         PIC X.
  6653     12  ERPDEF-BEN-CODE         PIC XX.
  6654     12  ERPDEF-EXP-DT           PIC XX.
  6655
  6656 01  ELSTAT-KEY-SAVE             PIC X(20).
  6657 01  ELSTAT-KEY.
  6658     12  ELSTAT-COMPANY-ID       PIC XXX.
  6659     12  ELSTAT-CARRIER          PIC X.
  6660     12  ELSTAT-GROUP            PIC X(6).
  6661     12  ELSTAT-STATE            PIC XX.
  6662     12  ELSTAT-EXP-DT           PIC 9(8).
  6663
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 121
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6664 01  WS-ERROR-VALUES.
  6665     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6666     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6667     12  er-1572                     pic s9(4)   value +1572.
  6668     12  er-1573                     pic s9(4)   value +1573.
  6669     12  er-1574                     pic s9(4)   value +1574.
  6670     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6671     12  ER-1891                     PIC S9(4)   VALUE +1891.
  6672     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6673     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6674     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6675     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6676     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6677     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6678     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6679     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6680     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6681     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6682     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6683     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6684     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6685     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6686     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6687     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6688     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6689     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6690     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6691     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6692     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6693     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6694     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6695     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6696     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6697     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6698     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6699     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6700     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6701     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6702     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6703     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6704     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6705     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6706     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6707     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6708     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6709     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6710     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6711     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6712     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6713     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6714     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6715     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6716     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6717     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6718     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6719     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6720     12  ER-2612                     PIC S9(4)   VALUE +2612.
  6721     12  ER-2613                     PIC S9(4)   VALUE +2613.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 122
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6722     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6723     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6724     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6725     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6726     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6727     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6728     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6729     12  ER-2621                     PIC S9(4)   VALUE +2621.
  6730     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6731     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6732     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6733     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6734     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6735     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6736     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6737     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6738     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6739     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6740     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6741     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6742     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6743     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6744     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6745     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6746     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6747     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6748     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6749     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6750     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6751     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6752     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6753     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6754     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6755     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6756     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6757     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6758     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6759     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6760     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6761     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6762     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6763     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6764     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6765     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6766     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6767     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6768     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6769     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6770     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6771     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6772     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6773     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6774     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6775     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6776     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6777     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6778     12  ER-2670                     PIC S9(4)   VALUE +2670.
  6779     12  ER-2671                     PIC S9(4)   VALUE +2671.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 123
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6780     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6781     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6782     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6783     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6784     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6785     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6786     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6787     12  ER-2679                     PIC S9(4)   VALUE +2679.
  6788     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6789     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6790     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6791     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6792     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6793     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6794     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6795     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6796     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6797     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6798     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6799     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6800     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6801     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6802     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6803     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6804     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6805     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6806     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6807     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6808     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6809     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6810     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6811     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6812     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6813     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6814     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6815     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6816     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6817     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6818     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6819     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6820     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6821     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6822     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6823     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6824     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6825     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6826     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6827     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6828     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6829     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6830     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6831     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6832     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6833     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6834     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6835     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6836     12  ER-2738                     PIC S9(4)   VALUE +2738.
  6837     12  ER-2739                     PIC S9(4)   VALUE +2739.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 124
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6838     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6839     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6840     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6841     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6842     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6843     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6844     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6845     12  ER-2747                     PIC S9(4)   VALUE +2747.
  6846     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6847     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6848     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6849     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6850     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6851     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6852     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6853     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6854     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6855     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6856     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6857     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6858     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6859     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6860     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6861     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6862     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6863     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6864     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6865     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6866     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6867     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6868     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6869     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6870     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6871     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6872     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6873     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6874     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6875     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6876     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6877     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6878     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6879     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6880     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6881     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6882     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6883     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6884     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6885     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6886     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6887     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6888     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6889     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6890     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6891     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6892     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6893     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6894     12  ER-2879                     PIC S9(4)   VALUE +2879.
  6895     12  ER-2881                     PIC S9(4)   VALUE +2881.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 125
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6896     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6897     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6898     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6899     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6900     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6901     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6902     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6903     12  ER-2889                     PIC S9(4)   VALUE +2889.
  6904     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6905     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6906     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6907     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6908     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6909     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6910     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6911     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6912     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6913     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6914     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6915     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6916     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6917     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6918     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6919     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6920     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6921     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6922     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6923     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6924     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6925     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6926     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6927     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6928     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6929     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6930     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6931     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6932     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6933     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6934     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6935     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6936     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6937     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6938     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6939     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6940     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6941     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6942     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6943     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6944     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6945     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6946     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6947     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6948     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6949     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6950     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6951     12  ER-8067                     PIC S9(4)   VALUE +8067.
  6952     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6953     12  ER-8069                     PIC S9(4)   VALUE +8069.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 126
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6954     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6955     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6956     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6957     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6958     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6959     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6960     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6961     12  ER-8078                     PIC S9(4)   VALUE +8078.
  6962     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6963     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6964     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6965     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6966     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6967     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6968     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6969     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6970     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6971     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6972     12  ER-8089                     PIC S9(4)   VALUE +8089.
  6973     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6974     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6975     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6976     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6977     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6978     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6979     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6980     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6981     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6982     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6983     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6984     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6985     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6986     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6987     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6988     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6989     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6990     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6991     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6992     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6993     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6994     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6995     12  ER-8303                     PIC S9(4)   VALUE +8303.
  6996     12  ER-8304                     PIC S9(4)   VALUE +8304.
  6997     12  ER-8310                     PIC S9(4)   VALUE +8310.
  6998     12  ER-8311                     PIC S9(4)   VALUE +8311.
  6999     12  ER-8312                     PIC S9(4)   VALUE +8312.
  7000     12  ER-8313                     PIC S9(4)   VALUE +8313.
  7001     12  ER-8314                     PIC S9(4)   VALUE +8314.
  7002     12  ER-8315                     PIC S9(4)   VALUE +8315.
  7003     12  ER-8316                     PIC S9(4)   VALUE +8316.
  7004     12  ER-8317                     PIC S9(4)   VALUE +8317.
  7005     12  ER-9236                     PIC S9(4)   VALUE +9236.
  7006     12  ER-9501                     PIC S9(4)   VALUE +9501.
  7007     12  ER-9503                     PIC S9(4)   VALUE +9503.
  7008     12  ER-9263                     PIC S9(4)   VALUE +9263.
  7009     12  ER-9999                     PIC S9(4)   VALUE +9999.
  7010******************************************************************
  7011***************   END OF ELC50WS     ****************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 127
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  7012******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 128
* EL517.cbl
  7014 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 129
* EL517.cbl
  7016*DLB001
  7017 01  WS-DLB-MASTER-POLICY-FORM.
  7018     12  DMPF-PROCESS-TYPE         PIC X.
  7019         88  DMPF-OPEN-FILES                   VALUE 'O'.
  7020         88  DMPF-REG-PROCESS                  VALUE 'P'.
  7021         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  7022     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  7023     12  DMPF-RETURN-CODE          PIC XX.
  7024         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7025         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  7026         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  7027         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  7028         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7029         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  7030         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  7031
  7032*DLB002
  7033 01  WS-DLB-INTERNAL-POLICY-FORM.
  7034     12  DIPF-PROCESS-TYPE         PIC X.
  7035         88  DIPF-OPEN-FILES                   VALUE 'O'.
  7036         88  DIPF-REG-PROCESS                  VALUE 'P'.
  7037         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  7038     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  7039     12  DIPF-RETURN-CODE          PIC XX.
  7040         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7041         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  7042         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  7043         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  7044         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7045         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  7046         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  7047
  7048*DLB003
  7049 01  WS-DLB-VALID-BANK-ID.
  7050     12  DVBI-PROCESS-TYPE         PIC X.
  7051         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7052         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7053         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7054     12  DVBI-BANK-ID              PIC X(5).
  7055     12  DVBI-BANK-ID-TYPE         PIC X.
  7056         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7057         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7058         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7059         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7060         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7061     12  DVBI-RETURN-CODE          PIC XX.
  7062         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7063         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7064         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7065         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7066         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7067         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7068         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7069         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7070         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7071         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7072
  7073*DLB007
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 130
* EL517.cbl
  7074 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7075     12  DCUA-PROCESS-TYPE         PIC X.
  7076         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7077         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7078         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7079     12  DCUA-RES-STATE            PIC XX.
  7080     12  DCUA-BEN-TYPE             PIC XX.
  7081     12  DCUA-SYS-IDENT            PIC X.
  7082         88  DCUA-CLAIM                        VALUE 'C'.
  7083         88  DCUA-PREMIUM                      VALUE 'P'.
  7084     12  DCUA-COVERAGE-RULE        PIC X.
  7085     12  DCUA-CLIENT-ID            PIC X(10).
  7086     12  DCUA-EFF-DATE             PIC X(8).
  7087     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7088     12  DCUA-RETURN-CODE          PIC XX.
  7089         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7090         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7091         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7092     12  DCUA-CERT-NUMBER          PIC X(11).
  7093     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7094     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7095
  7096*DLB011
  7097 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7098     12  DPRB-PROCESS-TYPE         PIC X.
  7099         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7100         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7101         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7102     12  DPRB-RATE-CODE            PIC X(4).
  7103     12  DPRB-COVERAGE-CATEG       PIC X.
  7104     12  DPRB-RETURN-CODE          PIC XX.
  7105         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7106         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7107         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7108         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7109         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7110         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7111         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7112         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7113     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7114     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7115     12  DPRB-BEN-TYPE             PIC XX.
  7116
  7117*DLB017
  7118 01  WS-DLB-VALID-RATE-CODE.
  7119     12  DVRC-PROCESS-TYPE         PIC X.
  7120         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7121         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7122         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7123     12  DVRC-RATE-CODE            PIC X(4).
  7124     12  DVRC-RETURN-CODE          PIC XX.
  7125         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7126         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7127         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7128         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7129         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7130         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7131         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 131
* EL517.cbl
  7132
  7133*DLB019
  7134 01  WS-DLB-ORIG-COV-CAT.
  7135     12  DOCC-PROCESS-TYPE         PIC X.
  7136         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7137         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7138         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7139     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7140     12  DOCC-RETURN-CODE          PIC XX.
  7141     12  DOCC-ORIG-COV-CAT         PIC X.
  7142     12  DOCC-UNDERWRITER          PIC XX.
  7143     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7144     12  DOCC-CREDIT-IND           PIC X.
  7145     12  DOCC-PRODUCT-CD           PIC XX.
  7146     12  DOCC-TERM                 PIC XXX.
  7147
  7148*DLB021
  7149 01  WS-DLB-VALID-LOAN-OFFICER.
  7150     12  DVLO-LOAN-OFFICER         PIC X(3).
  7151     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7152         16  DVLO-BILL-TYPE        PIC X.
  7153         16  DVLO-BILL-SOURCE      PIC X.
  7154         16  DVLO-BATCH-TYPE       PIC X.
  7155     12  DVLO-RETURN-CODE          PIC XX.
  7156         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7157         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7158         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7159         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7160         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7161         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7162
  7163*DLB022
  7164 01  WS-DLB-VALID-STATE-CODE.
  7165     12  DVSC-PROCESS-TYPE         PIC X.
  7166         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7167         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7168         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7169     12  DVSC-STATE-CODE           PIC XX.
  7170     12  DVSC-RETURN-CODE          PIC XX.
  7171         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7172         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7173         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7174         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7175         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7176         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7177         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7178
  7179*DLB023
  7180 01  WS-DLB-VALID-CODE-VALUES.
  7181     12  DVCV-PROCESS-TYPE         PIC X.
  7182         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7183         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7184         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7185     12  DVCV-SYSTEM-ID            PIC XX.
  7186         88  DVCV-CLAIMS                       VALUE 'CL'.
  7187         88  DVCV-CREDIT                       VALUE 'CR'.
  7188     12  DVCV-RECORD-TYPE          PIC XX.
  7189         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 132
* EL517.cbl
  7190         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7191         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7192         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7193         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7194         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7195         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7196         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7197     12  DVCV-RECORD-KEY           PIC X(6).
  7198     12  DVCV-RETURN-CODE          PIC XX.
  7199         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7200         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7201         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7202         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7203         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7204         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7205         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7206         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7207         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7208         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7209     12  DVCV-CODE-DESC            PIC X(60).
  7210     12  DVCV-GEN-DESC-1           PIC X(20).
  7211     12  DVCV-GEN-DESC-2           PIC X(20).
  7212     12  DVCV-GEN-DESC-3           PIC X(20).
  7213
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 133
* EL517.cbl
  7215
  7216 01  PARMLIST.
  7217     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7218     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7219     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7220**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7221**
  7222**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7223     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7224
  7225 01  PLAN-RECORDS.
  7226     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7227     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7228
* 7229                                  COPY ELCDATE.
  7230******************************************************************06/11/98
  7231*                                                                *ELCDATE
  7232*                                                                *ELCDATE
  7233*                            ELCDATE.                            *   LV023
  7234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7235*                            VMOD=2.003                           ELCDATE
  7236*                                                                *ELCDATE
  7237*                                                                *ELCDATE
  7238*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7239*                 LENGTH = 200                                   *   CL*19
  7240******************************************************************ELCDATE
  7241                                                                  ELCDATE
  7242 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7243     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7244     12  DC-OPTION-CODE                PIC X.                        CL*15
  7245         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7246         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7247         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7248         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7249         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7250         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7251         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7252         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7253         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7254         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7255         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7256         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7257         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7258         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7259         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7260         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7261         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7262         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7263         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7264         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7265         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7266         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7267         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7268         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7269         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7270         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7271         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7272         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7273         88  THREE-CHARACTER-BIN                                  ELCDATE
  7274                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7275         88  GREGORIAN-TO-BIN                                        CL**2
  7276                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7277         88  BIN-TO-GREGORIAN                                        CL**2
  7278                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7279         88  JULIAN-TO-BINARY                                        CL**2
  7280                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7281     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7282         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7283         88  DATE-CONVERSION-ERROR                                ELCDATE
  7284                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7285         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7286         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7287         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7288         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7289         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7290         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7291         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7292         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7293         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7294         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7295     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7296         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7297     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7298         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7299         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7300         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7301     12  FILLER                        PIC X.                        CL*15
  7302     12  DC-CONVERSION-DATES.                                        CL*15
  7303         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7304         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7305         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7306         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7307                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7308             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7309             20  SLASH1-1              PIC X.                        CL*15
  7310             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7311             20  SLASH1-2              PIC X.                        CL*15
  7312             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7313         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7314         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7315                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7316             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7317             20  SLASH2-1              PIC X.                        CL*15
  7318             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7319             20  SLASH2-2              PIC X.                        CL*15
  7320             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7321         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7322         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7323                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7324             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7325             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7326             20  DC-YMD-DAY            PIC 99.                       CL*15
  7327         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7328         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7329                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7330             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 135
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7331             20  DC-MDY-DAY            PIC 99.                       CL*15
  7332             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7333         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7334             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7335             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7336             20  FILLER                PIC XX.                       CL*15
  7337             20  DC-ALPHA-CENTURY.                                   CL*15
  7338                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7339             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7340         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7341         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7342         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7343         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7344         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7345                                       PIC 9(05).                    CL*20
  7346         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7347             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7348             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7349         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7350         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7351         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7352     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7353         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7354         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7355             20  FILLER                PIC 9(3).                     CL*15
  7356             20  HOLD-CEN-1-CCYY.                                    CL*15
  7357                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7358                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7359             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7360             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7361         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7362             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7363             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7364             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7365                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7366                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7367             20  FILLER                PIC 9(3).                     CL*15
  7368         16  HOLD-CENTURY-1-X.                                       CL*15
  7369             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7370             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7371                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7372                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7373             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7374             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7375         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7376             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7377             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7378             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7379                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7380                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7381             20  FILLER                PIC XXX.                      CL*23
  7382         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7383         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7384         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7385         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7386             20  DC-JULIAN-1-CCYY.                                   CL*15
  7387                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7388                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7389             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7390         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7391         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7392             20  DC-JULIAN-2-CCYY.                                   CL*15
  7393                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7394                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7395             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7396         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7397             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7398             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7399             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7400             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7401             20  DC-EDITA-CCYY.                                      CL*15
  7402                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7403                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7404         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7405             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7406             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7407             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7408             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7409             20  DC-EDITB-CCYY.                                      CL*15
  7410                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7411                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7412         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7413         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7414                              DC-GREG-DATE-CYMD.                  ELCDATE
  7415             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7416             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7417             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7418             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7419         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7420         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7421                              DC-GREG-DATE-MDCY.                  ELCDATE
  7422             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7423             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7424             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7425             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7426    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7427        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7428    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7429    12  FILLER                         PIC X(28).                    CL*26
  7430
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 137
* EL517.cbl
* 7432                                  COPY ELCCALC.
  7433******************************************************************04/15/98
  7434*                                                                *ELCCALC
  7435*                           ELCCALC.                            *    LV003
  7436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7437*                            VMOD=2.025                          *   CL**3
  7438*                                                                *   CL**2
  7439*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7440*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7441*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7442*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7443*                                                                *   CL**2
  7444*  PASSED TO ELRTRM                                              *   CL**2
  7445*  -----------------                                             *   CL**2
  7446*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7447*  ORIGINAL TERM                                                 *   CL**2
  7448*  BEGINNING DATE                                                *   CL**2
  7449*  ENDING DATE                                                   *   CL**2
  7450*  COMPANY I.D.                                                  *   CL**2
  7451*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7452*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7453*  FREE LOOK DAYS                                                *   CL**2
  7454*                                                                *   CL**2
  7455*  RETURNED FROM ELRTRM                                          *   CL**2
  7456*  ---------------------                                         *   CL**2
  7457*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7458*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7459*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7460*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7461*----------------------------------------------------------------*   CL**2
  7462*  PASSED TO ELRAMT                                              *   CL**2
  7463*  ----------------                                              *   CL**2
  7464*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7465*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7466*  ORIGINAL AMOUNT                                               *   CL**2
  7467*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7468*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7469*  METHOD                                                            CL**2
  7470*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7471*  COMPANY I.D.                                                  *   CL**2
  7472*  BENEFIT TYPE                                                  *   CL**2
  7473*                                                                *   CL**2
  7474*  RETURNED FROM ELRAMT                                          *   CL**2
  7475*  --------------------                                          *   CL**2
  7476*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7477*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7478*  REMAINING AMOUNT FACTOR                                           CL**2
  7479*----------------------------------------------------------------*   CL**2
  7480*  PASSED TO ELRESV                                              *   CL**2
  7481*  -----------------                                             *   CL**2
  7482*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7483*  VALUATION DATE                                                *   CL**2
  7484*  PAID THRU DATE                                                *   CL**2
  7485*  BENEFIT                                                       *   CL**2
  7486*  INCURRED DATE                                                 *   CL**2
  7487*  REPORTED DATE                                                 *   CL**2
  7488*  ISSUE AGE                                                     *   CL**2
  7489*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7490*  CDT PERCENT                                                   *   CL**2
  7491*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7492* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7493* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7494* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7495*                                                                *   CL**2
  7496*  RETURNED FROM ELRESV                                          *   CL**2
  7497*  --------------------                                          *   CL**2
  7498*  CDT TABLE USED                                                *   CL**2
  7499*  CDT FACTOR USED                                               *   CL**2
  7500*  PAY TO CURRENT RESERVE                                        *   CL**2
  7501*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7502*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7503*----------------------------------------------------------------*   CL**2
  7504*  PASSED TO ELRATE                                              *   CL**2
  7505*  ----------------                                              *   CL**2
  7506*  CERT ISSUE DATE                                               *   CL**2
  7507*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7508*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7509*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7510*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7511*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7512*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7513*  DEVIATION CODE                                                *   CL**2
  7514*  ISSUE AGE                                                     *   CL**2
  7515*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7516*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7517*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7518*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7519*  A.P.R.                                                        *   CL**2
  7520*  METHOD                                                            CL**2
  7521*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7522*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7523*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7524*  BENEFIT CODE                                                  *   CL**2
  7525*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7526*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7527*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7528*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7529*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7530*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7531*                                                                *   CL**2
  7532*  RETURNED FROM ELRATE                                          *   CL**2
  7533*  --------------------                                          *   CL**2
  7534*  CALCULATED PREMIUM                                            *   CL**2
  7535*  PREMIUM RATE                                                  *   CL**2
  7536*  MORTALITY CODE                                                *   CL**2
  7537*  MAX ATTAINED AGE                                              *   CL**2
  7538*  MAX AGE                                                       *   CL**2
  7539*  MAX TERM                                                      *   CL**2
  7540*  MAX MONTHLY BENEFIT                                           *   CL**2
  7541*  MAX TOTAL BENIFIT                                             *   CL**2
  7542*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7543*----------------------------------------------------------------*   CL**2
  7544*  PASSED TO ELRFND                                              *   CL**2
  7545*  ----------------                                              *   CL**2
  7546*  CERT ISSUE DATE                                               *   CL**2
  7547*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7548*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7549*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7550*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7551*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7552*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7553*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7554*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7555*  DEVIATION CODE                                                *   CL**2
  7556*  ISSUE AGE                                                     *   CL**2
  7557*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7558*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7559*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7560*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7561*  A.P.R.                                                        *   CL**2
  7562*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7563*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7564*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7565*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7566*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7567*  BENEFIT CODE                                                  *   CL**2
  7568*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7569*                                                                *   CL**2
  7570*  RETURNED FROM ELRFND                                          *   CL**2
  7571*  --------------------                                          *   CL**2
  7572*  CALCULATED REFUND                                             *   CL**2
  7573*----------------------------------------------------------------*   CL**2
  7574*  PASSED TO ELEARN                                              *   CL**2
  7575*  ----------------                                              *   CL**2
  7576*  CERT ISSUE DATE                                               *   CL**2
  7577*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7578*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7579*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7580*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7581*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7582*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7583*  DEVIATION CODE                                                *   CL**2
  7584*  ISSUE AGE                                                     *   CL**2
  7585*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7586*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7587*  A.P.R.                                                        *   CL**2
  7588*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7589*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7590*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7591*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7592*  BENEFIT CODE                                                  *   CL**2
  7593*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7594*                                                                *   CL**2
  7595*  RETURNED FROM ELEARN                                          *   CL**2
  7596*  --------------------                                          *   CL**2
  7597*  INDICATED  EARNINGS                                           *   CL**2
  7598*----------------------------------------------------------------*   CL**2
  7599*                 LENGTH = 450                                   *   CL**2
  7600*                                                                *   CL**2
  7601******************************************************************   CL**2
  7602******************************************************************
  7603*                   C H A N G E   L O G
  7604*
  7605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7606*-----------------------------------------------------------------
  7607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7608* EFFECTIVE    NUMBER
  7609*-----------------------------------------------------------------
  7610* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7611* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7612* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7613* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7614* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7615* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7616* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7617* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7618* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7619******************************************************************
  7620                                                                     CL**2
  7621 01  CALCULATION-PASS-AREA.                                          CL**2
  7622     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7623                                     COMP.                           CL**2
  7624                                                                     CL**2
  7625     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7626       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7627       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7628                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7629       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7630       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7631       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7632       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7633       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7634       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7635       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7636       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7637       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7638       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7639       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7640       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7641       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7642       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7643       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7644       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7645       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7646                                                                     CL**2
  7647     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7648       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7649***********************  INPUT AREAS ****************************    CL**2
  7650                                                                     CL**2
  7651     12  CP-CALCULATION-AREA.                                        CL**2
  7652         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7653         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7654         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7655         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7656         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7657           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7658                                                   'I' 'U'.          CL**2
  7659           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7660           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7661         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7662         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7663         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7664         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7665         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7666                                     COMP-3.                         CL**2
  7667         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7668                                     COMP-3.                         CL**2
  7669         16  CP-CDT-METHOD         PIC X.                            CL**2
  7670           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7671           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7672           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7673         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7674           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7675           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7676         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7677                                     COMP-3.                         CL**2
  7678         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7679                                     COMP-3.                         CL**2
  7680         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7681                                     COMP-3.                         CL**2
  7682         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7683                                     COMP-3.                         CL**2
  7684         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7685                                     COMP-3.                         CL**2
  7686         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7687                                     COMP-3.                         CL**2
  7688         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7689                                     COMP-3.                         CL**2
  7690         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7691           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7692           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7693           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7694           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7695           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7696           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7697           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7698         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7699           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7700           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7701           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7702           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7703           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7704           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7705           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7706           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7707           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7708           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7709           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7710           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7711           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7712           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7713         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7714           88  CP-CLAIM                            VALUE '1'.        CL**2
  7715           88  CP-CANCEL                           VALUE '2'.        CL**2
  7716           88  CP-ISSUE                            VALUE '3'.        CL**2
  7717         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7718           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7719           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7720           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7721           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7722           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7723           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7724           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7725           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7726           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7727           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7728           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7729           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7730           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7731           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7732           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7733           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7734           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7735           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7736                                                     'W' 'X'.        CL**2
  7737           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7738           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7739           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7740           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7741           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7742           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7743           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7744           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7745           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7746           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7747           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7748           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7749           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7750                                                                     CL**2
  7751         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7752                                     COMP-3.                         CL**2
  7753         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7754         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7755         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7756         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7757         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7758           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7759               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7760         16  CP-R78-OPTION         PIC X.                            CL**2
  7761           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7762           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7763                                                                     CL**2
  7764         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7765         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7766         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7767         16  CP-RATE-FILE          PIC X.                            CL**2
  7768         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7769                                     COMP-3.                         CL**2
  7770                                                                     CL**2
  7771         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7772         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7773                                                                     CL**2
  7774         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7775                                     COMP-3.
  7776         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7777                                   PIC S9(5)V99 COMP-3.
  7778         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7779                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7780         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7781                                     COMP-3.                         CL**2
  7782         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7783                                     COMP-3.
  7784         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7785                                  PIC S9(7)V99 COMP-3.
  7786                                                                     CL**2
  7787         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7788         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7789         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7790           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7791           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7792           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7793           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7794         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7795         16  CP-CARRIER            PIC X.                            CL**2
  7796         16  CP-REIN-FLAG          PIC X.                            CL**2
  7797         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7798           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7799                      '2' '3' '4' '5'.                               CL**2
  7800           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7801           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7802           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7803           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7804           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7805           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7806           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7807           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7808         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7809         16  CP-RATING-METHOD      PIC X.                            CL**2
  7810           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7811           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7812           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7813           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7814           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7815           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7816           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7817           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7818           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7819         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7820                                     COMP-3.                         CL**2
  7821         16  CP-BEN-CATEGORY       PIC X.
  7822         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7823         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7824                                   PIC S99V9(5) COMP-3.
  7825         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7826         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7827                                   PIC S99V9(5) COMP-3.
  7828         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7829         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7830         16  CP-EXPIRE-DT          PIC XX.
  7831         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7832         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7833         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7834         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7835         16  CP-DDF-SPEC-CALC      PIC X.
  7836             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7837             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7838         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7839         16  CP-CANCEL-REASON      PIC X.
  7840         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7841         16  CP-PMT-MODE           PIC X.
  7842         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7843         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7844         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7845         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7846         16  FILLER                PIC X.
  7847                                                                     CL**2
  7848***************    OUTPUT FROM ELRESV   ************************     CL**2
  7849                                                                     CL**2
  7850         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7851                                                                     CL**2
  7852         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7853                                     COMP-3.                         CL**2
  7854         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7855                                     COMP-3.                         CL**2
  7856         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7857                                     COMP-3.                         CL**2
  7858         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7859                                     COMP-3.                         CL**2
  7860         16  FILLER                PIC X(09).                        CL**2
  7861***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7862                                                                     CL**2
  7863         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7864                                     COMP-3.                         CL**2
  7865         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7866                                     COMP-3.                         CL**2
  7867         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7868                                     COMP-3.                         CL**2
  7869         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7870                                     COMP-3.                         CL**2
  7871         16  FILLER                PIC X(12).                        CL**2
  7872                                                                     CL**2
  7873***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7874                                                                     CL**2
  7875         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7876                                     COMP-3.                         CL**2
  7877         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7878                                     COMP-3.                         CL**2
  7879         16  FILLER                PIC X(12).                        CL**2
  7880                                                                     CL**2
  7881***************    OUTPUT FROM ELRATE   *************************    CL**2
  7882                                                                     CL**2
  7883         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7884                                     COMP-3.                         CL**2
  7885         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7886                                     COMP-3.                         CL**2
  7887         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7888         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7889             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7890         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7891                                     COMP-3.                         CL**2
  7892         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7893         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7894         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7895                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 145
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7896         16  FILLER                PIC X(07).                        CL**2
  7897                                                                     CL**2
  7898***************    OUTPUT FROM ELRFND   *************************    CL**2
  7899                                                                     CL**2
  7900         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7901                                     COMP-3.                         CL**2
  7902         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7903           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7904           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7905           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7906           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7907           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7908           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7909           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7910           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7911           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7912           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7913           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7914           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7915           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7916           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7917         16  FILLER                PIC X(12).                        CL**2
  7918                                                                     CL**2
  7919***************    OUTPUT FROM ELEARN   *************************    CL**2
  7920                                                                     CL**2
  7921         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7922                                     COMP-3.                         CL**2
  7923         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7924                                     COMP-3.                         CL**2
  7925         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7926                                     COMP-3.                         CL**2
  7927         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7928                                     COMP-3.                         CL**2
  7929         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7930                                     COMP-3.                         CL**2
  7931         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7932                                     COMP-3.                         CL**2
  7933         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7934           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7935           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7936           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7937           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7938           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7939           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7940           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7941           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7942           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7943         16  FILLER                PIC X(12).                        CL**2
  7944                                                                     CL**2
  7945***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7946                                                                     CL**2
  7947         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7948                                     COMP-3.                         CL**2
  7949         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7950                                     COMP-3.                         CL**2
  7951         16  FILLER                PIC X(12).                        CL**2
  7952                                                                     CL**2
  7953***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7954         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7955                                     COMP-3.                         CL**2
  7956         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7957                                     COMP-3.                         CL**2
  7958         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7959                                     COMP-3.                         CL**2
  7960         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7961                                     COMP-3.                         CL**2
  7962         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7963                                     COMP-3.                         CL**2
  7964         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7965                                     COMP-3.                         CL**2
  7966         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7967             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7968             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7969             88  IO-ERROR                         VALUE 'E'.         CL**2
  7970                                                                     CL**2
  7971         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7972                                                                     CL**2
  7973         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7974                                                                     CL**2
  7975         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7976                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7977                                     COMP-3.                         CL**2
  7978                                                                     CL**2
  7979         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7980                                                                     CL**2
  7981         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7982                                     COMP-3.                         CL**2
  7983                                                                     CL**2
  7984         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7985                                     COMP-3.                         CL**2
  7986                                                                     CL**2
  7987         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7988                                     COMP-3.                         CL**2
  7989                                                                     CL**2
  7990         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7991                                     COMP-3.                         CL**2
  7992                                                                     CL**2
  7993         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7994                                     COMP-3.                         CL**2
  7995                                                                     CL**2
  7996         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  7997                                     COMP-3.                         CL**2
  7998                                                                     CL**2
  7999         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  8000                                     COMP-3.                         CL**2
  8001                                                                     CL**2
  8002         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  8003             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  8004                                                                     CL**2
  8005         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  8006                                     COMP-3.                         CL**2
  8007         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  8008                                     COMP-3.
  8009         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  8010         16  FILLER                PIC X(15).                        CL**2
  8011******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 147
* EL517.cbl
  8012
* 8013                                  COPY ELCDTECX.
  8014******************************************************************06/05/98
  8015*                                                                *ELCDTECX
  8016*                            ELCDTECX.                           *   LV005
  8017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8018*                            VMOD=2.015                          *ELCDTECX
  8019*                                                                *ELCDTECX
  8020*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  8021*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  8022*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  8023*                                                                *ELCDTECX
  8024******************************************************************ELCDTECX
  8025******************************************************************
  8026*                   C H A N G E   L O G
  8027*
  8028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8029*-----------------------------------------------------------------
  8030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8031* EFFECTIVE    NUMBER
  8032*-----------------------------------------------------------------
  8033* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  8034*                                  BENEFIT CODES FROM 300 TO 900
  8035* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  8036* 051304    2003080800002  SMVA  ADD REFUND METHOD
  8037******************************************************************
  8038 01  DATE-CARD.                                                   ELCDTECX
  8039     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  8040     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  8041     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  8042     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  8043     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  8044     12  EP-SW                       PIC  X.                      ELCDTECX
  8045         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  8046     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  8047         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8048     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8049     12  RUN-CENTURY.                                             ELCDTECX
  8050         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8051     12  FILLER                      PIC  X.                         CL**4
  8052     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8053     12  FILLER                      PIC  XXX.                    ELCDTECX
  8054     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8055                                                                  ELCDTECX
  8056 01  FILLER                          PIC  X(7)                       CL**6
  8057                                          VALUE 'OPTIONS'.        ELCDTECX
  8058 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8059     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8060     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8061     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8062         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8063         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8064     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8065     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8066     12  FILLER                      PIC  X.                      ELCDTECX
  8067     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8068     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8069     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8070     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8071     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8072     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8073     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8074     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8075     12  FILLER                      PIC  X.                      ELCDTECX
  8076     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8077     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8078     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8079     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8080     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8081     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8082     12  FILLER                      PIC  X.                      ELCDTECX
  8083     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8084     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8085     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8086     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8087     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8088     12  DTE-R78                     PIC  X.                      ELCDTECX
  8089     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8090     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8091     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8092     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8093     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8094     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8095     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8096                                     PIC  X.                      ELCDTECX
  8097         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8098                                                 ' '.             ELCDTECX
  8099         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8100         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8101     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8102         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8103         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8104     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8105     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8106                                     PIC  9.                         CL**4
  8107     12  DTE-SYSTEM.                                              ELCDTECX
  8108         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8109         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8110         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8111         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8112         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8113         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8114         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8115         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8116         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8117         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8118         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8119         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8120         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8121         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8122         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8123         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8124         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8125         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8126         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8127         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8128         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8129         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8130         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8131         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8132         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8133         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8134     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8135         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8136                                     PIC  X.                      ELCDTECX
  8137     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8138                                                                  ELCDTECX
  8139 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8140     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8141     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8142     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8143*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8144     12  FILLER                      PIC  X.                      ELCDTECX
  8145     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8146     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8147     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8148     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8149     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8150     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8151     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8152                                                                  ELCDTECX
  8153     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8154     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8155     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8156     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8157                                                                  ELCDTECX
  8158     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8159     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8160     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8161     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8162                                                                  ELCDTECX
  8163     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8164     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8165                                                                  ELCDTECX
  8166     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8167     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8168                                                                  ELCDTECX
  8169     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8170                                                                  ELCDTECX
  8171 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8172     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8173     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8174     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8175     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8176     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8177     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8178     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8179                                                                  ELCDTECX
  8180 01  FILLER                          PIC  X(12)                   ELCDTECX
  8181                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8182 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8183     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8184         16  CNT-ID                  PIC  X.                      ELCDTECX
  8185         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8186                                                                  ELCDTECX
  8187 01  FILLER                          PIC  X(11)                   ELCDTECX
  8188                                          VALUE 'STATE NAMES'.    ELCDTECX
  8189 01  STATE-NAMES.                                                 ELCDTECX
  8190     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8191         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8192         16  STATE-PIC1.                                          ELCDTECX
  8193             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8194             20  FILLER              PIC  XXX.                    ELCDTECX
  8195             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8196             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8197             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8198             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8199                                                                  ELCDTECX
  8200 01  FILLER                          PIC  X(13)                   ELCDTECX
  8201                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8202 01  CARRIER-NAMES.                                               ELCDTECX
  8203     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8204         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8205         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8206         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8207         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8208         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8209         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8210*        16  FILLER                  PIC  X.                      ELCDTECX
  8211         16  CARRIER-SEC-PAY         PIC  X.
  8212             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8213                                                                  ELCDTECX
  8214 01  FILLER                          PIC  X(9)                       CL**6
  8215                                          VALUE 'INS TYPES'.      ELCDTECX
  8216 01  CLAS-INS-TYPES.                                              ELCDTECX
  8217*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8218     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8219         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8220         16  CLAS-I-AB3.                                          ELCDTECX
  8221             20  FILLER              PIC  X.                      ELCDTECX
  8222             20  CLAS-I-AB2.                                      ELCDTECX
  8223                 24  FILLER          PIC  X.                      ELCDTECX
  8224                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8225         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8226             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8227             20  FILLER              PIC  X.                         CL**4
  8228         16  CLAS-I-AB10.                                         ELCDTECX
  8229             20  FILLER              PIC  X(9).                   ELCDTECX
  8230             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8231         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8232         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8233         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8234         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8235             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8236         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8237         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8238         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8239         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8240         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8241         16  FILLER                  PIC  X(05).
  8242                                                                  ELCDTECX
  8243 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8244                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8245 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8246     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8247                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8248         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8249         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8250         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8251         16  CLAS-MORT-DESC.                                      ELCDTECX
  8252             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8253             20  FILLER              PIC  XX.                        CL**5
  8254             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8255             20  FILLER              PIC  X.                         CL**5
  8256             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8257             20  FILLER              PIC  X.                         CL**5
  8258             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8259             20  FILLER              PIC  X.                         CL**5
  8260             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8261             20  FILLER              PIC  X(5).                      CL**6
  8262                                                                  ELCDTECX
  8263 01  FILLER                          PIC  X(15)                   ELCDTECX
  8264                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8265 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8266     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8267         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8268         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8269         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8270         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8271         16  FILLER                  PIC  X(4).                      CL**6
  8272                                                                  ELCDTECX
  8273 01  FILLER                          PIC  X(7)                       CL**6
  8274                                     VALUE 'INDEXES'.             ELCDTECX
  8275 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8276     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8277     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8278     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8279     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8280     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8281     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8282     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8283     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8284     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8285     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8286     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8287     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8288     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8289     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8290     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8291     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8292     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8293                                                                  ELCDTECX
  8294 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8295     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8296     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8297     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8298     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8299     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8300     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8301     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8302     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8303     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8304     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8305     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8306                                                                  ELCDTECX
  8307 01  FILLER                          PIC  X(13)                   ELCDTECX
  8308                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8309 01  CLAS-MISC.                                                   ELCDTECX
  8310     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8311         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8312         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8313         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8314     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8315     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8316     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8317     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8318     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8319     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8320     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8321     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8322     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8323     12  STATE-L                     PIC  XX.                     ELCDTECX
  8324     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8325     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8326     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8327         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8328         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8329     12  DTE-ABEND-WORK.                                          ELCDTECX
  8330         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8331         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8332                                                                  ELCDTECX
  8333 01  FILLER                          PIC  X(12)                   ELCDTECX
  8334                                     VALUE 'WORKING DATE'.        ELCDTECX
  8335 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8336     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8337         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8338         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8339         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8340     12  WS-CURRENT-DATE.                                         ELCDTECX
  8341         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8342         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8343         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8344         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8345         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8346     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8347         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8348         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8349                                                                  ELCDTECX
  8350 01  FILLER                          PIC  X(12)                   ELCDTECX
  8351                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8352 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8353     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8354         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8355         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8356         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8357                                                                  ELCDTECX
  8358 01  FILLER                          PIC  X(10)                   ELCDTECX
  8359                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8360 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8361     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8362         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8363         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8364                                                                  ELCDTECX
  8365 01  FILLER                          PIC  X(13)                   ELCDTECX
  8366                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8367 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8368     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8369         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8370                                                                  ELCDTECX
  8371 01  FILLER                          PIC  X(13)                   ELCDTECX
  8372                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8373 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8374     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8375     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8376     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8377                                     PIC  X.                         CL**5
  8378     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8379     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8380     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8381     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8382     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8383     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8384     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8385     12  FILLER                      PIC  X(75).                  ELCDTECX
  8386******************************************************************ELCDTECX
  8387*01  MISC-CARR-PCT-DATA.                                          00001521
  8388*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8389*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8390*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8391*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8392*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8393*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8394******************************************************************ELCDTECX
  8395
* 8396                                  COPY ELCDTEVR.
  8397***************************************************************** 04/15/98
  8398*                                                                *ELCDTEVR
  8399*                                                                *ELCDTEVR
  8400*                            ELCDTEVR.                           *   LV003
  8401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8402*                            VMOD=2.001                          *   CL**2
  8403*                                                                *ELCDTEVR
  8404*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8405*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8406*                                                                *ELCDTEVR
  8407******************************************************************ELCDTEVR
  8408 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8409     05  WS-RUN-DATE.                                             ELCDTEVR
  8410         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8411         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8412         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8413             15  RUN-CC              PIC  99.                     ELCDTEVR
  8414             15  RUN-YR              PIC  99.                     ELCDTEVR
  8415         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8416         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8417     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8418            WS-RUN-DATE              PIC 9(11).                      CL**2
  8419     05  WS-EP-DT.                                                ELCDTEVR
  8420         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8421         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8422         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8423             15  EP-CC               PIC  99.                     ELCDTEVR
  8424             15  EP-YR               PIC  99.                     ELCDTEVR
  8425         10  EP-MO                   PIC  99.                     ELCDTEVR
  8426         10  EP-DA                   PIC  99.                     ELCDTEVR
  8427     05  WS-EP-DT-N REDEFINES                                        CL**2
  8428            WS-EP-DT                 PIC 9(11).                      CL**2
  8429     05  WS-DTE-CONV-DT.                                             CL**4
  8430         10  FILLER                  PIC  9(03).                     CL**4
  8431         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8432         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8433             15  DTE-CONV-CC         PIC  99.                        CL**4
  8434             15  DTE-CONV-YR         PIC  99.                        CL**4
  8435         10  DTE-CONV-MO             PIC  99.                        CL**4
  8436         10  DTE-CONV-DA             PIC  99.                        CL**4
  8437     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8438            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8439 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8440     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8441         10  FILLER                            PIC 999.           ELCDTEVR
  8442         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8443         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8444             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8445             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8446         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8447         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8448     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8449            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8450     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8451         10  FILLER                            PIC 999.           ELCDTEVR
  8452         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8453         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8454         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8455         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8456     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8457            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8458 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8459     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8460         10  FILLER                            PIC 999.           ELCDTEVR
  8461         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8462         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8463             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8464             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8465         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8466         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8467     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8468            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8469     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8470         10  FILLER                            PIC 999.           ELCDTEVR
  8471         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8472         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8473             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8474             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8475         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8476         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8477     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8478            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8479     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8480         10  FILLER                            PIC 999.           ELCDTEVR
  8481         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8482         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8483             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8484             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8485         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8486         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8487     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8488            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8489 01  WS-RATE-RECORD.                                              ELCDTEVR
  8490         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8491             10  FILLER                        PIC 999.           ELCDTEVR
  8492             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8493             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8494                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8495                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8496             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8497             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8498         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8499                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8500
* 8501                                  COPY ELCREINV.
  8502******************************************************************04/18/98
  8503*                                                                *ELCREINV
  8504*                                                                *ELCREINV
  8505*                            ELCREINV                            *   LV003
  8506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8507*                            VMOD=2.001                          *ELCREINV
  8508*                                                                *ELCREINV
  8509*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8510*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8511*                                                                *ELCREINV
  8512******************************************************************ELCREINV
  8513                                                                  ELCREINV
  8514 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8515     05  WS-RE-LO-DATE.                                              CL**3
  8516         10 FILLER                     PIC 999.                      CL**3
  8517         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8518         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8519            15 RE-LO-CC                PIC 99.                       CL**3
  8520            15 RE-LO-YR                PIC 99.                       CL**3
  8521         10 RE-LO-MO                   PIC 99.                       CL**3
  8522         10 RE-LO-DA                   PIC 99.                       CL**3
  8523     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8524            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8525     05  WS-RE-HI-DATE.                                              CL**3
  8526         10 FILLER                     PIC 999.                      CL**3
  8527         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8528         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8529            15 RE-HI-CC                PIC 99.                       CL**3
  8530            15 RE-HI-YR                PIC 99.                       CL**3
  8531         10 RE-HI-MO                   PIC 99.                       CL**3
  8532         10 RE-HI-DA                   PIC 99.                       CL**3
  8533     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8534            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8535     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8536         10 FILLER                     PIC 999.                   ELCREINV
  8537         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8538         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8539            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8540            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8541         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8542         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8543     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8544            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8545     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8546         10  FILLER                    PIC 999.                   ELCREINV
  8547         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8548         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8549             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8550             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8551         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8552         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8553     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8554            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8555     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8556         10  FILLER                    PIC 999.                   ELCREINV
  8557         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8558         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8559             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8560             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8561         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8562         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8563     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8564            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8565
* 8566                                  COPY ELCACCTV.
  8567******************************************************************04/14/98
  8568*                                                                *ELCACCTV
  8569*                            ELCACCTV                            *   LV002
  8570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8571*                            VMOD=2.001                          *ELCACCTV
  8572*                                                                *ELCACCTV
  8573*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8574*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8575*                                                                *ELCACCTV
  8576*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8577*                                                                *ELCACCTV
  8578******************************************************************ELCACCTV
  8579                                                                  ELCACCTV
  8580 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8581                                                                  ELCACCTV
  8582     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8583         10  FILLER            PIC 999.                           ELCACCTV
  8584         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8585         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8586             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8587             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8588         10  AM-EXP-MO         PIC 99.                               CL**5
  8589         10  AM-EXP-DA         PIC 99.                               CL**5
  8590     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8591            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 157
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8592     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8593         10  FILLER                    PIC 999.                   ELCACCTV
  8594         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8595         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8596             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8597             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8598         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8599         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8600     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8601            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8602     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8603         10  FILLER                    PIC 999.                   ELCACCTV
  8604         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8605         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8606             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8607             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8608         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8609         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8610     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8611            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8612     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8613         10 FILLER                     PIC 999.                   ELCACCTV
  8614         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8615         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8616            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8617            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8618         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8619         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8620     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8621            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8622     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8623         10 FILLER                     PIC 999.                   ELCACCTV
  8624         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8625         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8626            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8627            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8628         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8629         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8630     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8631            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8632     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8633         10  FILLER                    PIC 999.                   ELCACCTV
  8634         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8635         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8636             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8637             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8638         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8639         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8640     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8641            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8642     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8643         10  FILLER                    PIC 999.                   ELCACCTV
  8644         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8645         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8646             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8647             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8648         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8649         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 158
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8650     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8651            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8652     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8653         10  FILLER                    PIC 999.                   ELCACCTV
  8654         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8655         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8656             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8657             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8658         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8659         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8660     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8661            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8662     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8663         10  FILLER                    PIC 999.                   ELCACCTV
  8664         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8665         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8666             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8667             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8668         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8669         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8670     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8671            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 159
* EL517.cbl
* 8673                                  COPY ELCDIFRD.
  8674******************************************************************04/15/98
  8675*                                                                *ELCDIFRD
  8676*                                                                *ELCDIFRD
  8677*                            ELCDIFRD.                           *   LV003
  8678*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8679*                            VMOD=2.004                          *   CL**3
  8680*                                                                *ELCDIFRD
  8681*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8682*                                                                *ELCDIFRD
  8683******************************************************************ELCDIFRD
  8684*                                                                 ELCDIFRD
  8685  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8686        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8687        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8688        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8689        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8690        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8691        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8692        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8693        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8694        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8695        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8696        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 160
* EL517.cbl
* 8698                                  COPY ELCERRWS.
  8699******************************************************************04/15/98
  8700*                                                                *ELCERRWS
  8701*                                                                *ELCERRWS
  8702*                            ELCERRWS                            *   LV002
  8703*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8704*                            VMOD=2.005                          *   CL**2
  8705*                                                                *ELCERRWS
  8706*                                                                *ELCERRWS
  8707*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8708*                                                                *ELCERRWS
  8709******************************************************************ELCERRWS
  8710                                                                  ELCERRWS
  8711 01  W-ERROR-WORK.                                                ELCERRWS
  8712     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8713     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8714     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8715     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8716     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8717     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8718     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8719     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8720     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8721     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8722     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8723     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8724     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8725     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8726     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8727     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8728     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8729                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 161
* EL517.cbl
  8731
  8732 PROCEDURE DIVISION.
  8733
  8734 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8735******************************************************************04/15/98
  8736*                                                                *ELCDTERX
  8737*                                                                *ELCDTERX
  8738*                            ELCDTERX.                           *   LV002
  8739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8740*                            VMOD=2.007                          *ELCDTERX
  8741*                                                                *ELCDTERX
  8742*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8743*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8744*      = ELCDTEFD)                                               *ELCDTERX
  8745*                                                                *ELCDTERX
  8746******************************************************************ELCDTERX
  8747                                                                  ELCDTERX
  8748     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8749                                                                  ELCDTERX
  8750     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8751     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8752     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8753                                                                  ELCDTERX
  8754     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8755                                                                  ELCDTERX
  8756******************************************************************ELCDTERX
  8757*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8758*          WARNING MESSAGES.                                      ELCDTERX
  8759******************************************************************ELCDTERX
  8760     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8761         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8762                                                                  ELCDTERX
  8763     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8764                                                                  ELCDTERX
  8765     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8766                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8767                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8768                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8769                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8770                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8771                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8772                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8773                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8774                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8775                                                                  ELCDTERX
  8776     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8777                                                                  ELCDTERX
  8778     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8779                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8780                                                                  ELCDTERX
  8781     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8782     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8783     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8784     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8785                                                                  ELCDTERX
  8786     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8787         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8788     ELSE                                                         ELCDTERX
  8789         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8790                                                                  ELCDTERX
  8791     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8792         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8793     ELSE                                                         ELCDTERX
  8794         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8795                                                                  ELCDTERX
  8796 0005-READ--CARD.                                                 ELCDTERX
  8797     READ DISK-DATE                                               ELCDTERX
  8798         AT END CLOSE DISK-DATE                                   ELCDTERX
  8799             GO TO 0060-READ--TEST.                               ELCDTERX
  8800                                                                  ELCDTERX
  8801     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8802                                                                  ELCDTERX
  8803     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8804         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8805         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8806         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8807         GO TO 0005-READ--CARD.                                   ELCDTERX
  8808                                                                  ELCDTERX
  8809     IF DD-ID = 'CLAD'                                            ELCDTERX
  8810         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8811         GO TO 0005-READ--CARD.                                   ELCDTERX
  8812                                                                  ELCDTERX
  8813     IF DD-ID = 'CLAX'                                            ELCDTERX
  8814         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8815         GO TO 0005-READ--CARD.                                   ELCDTERX
  8816                                                                  ELCDTERX
  8817     IF DD-ID = 'CLAF'                                            ELCDTERX
  8818         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8819         GO TO 0005-READ--CARD.                                   ELCDTERX
  8820                                                                  ELCDTERX
  8821     IF DD-ID = 'CLAC'                                            ELCDTERX
  8822         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8823                                                                  ELCDTERX
  8824     IF DD-ID = 'CARR'                                            ELCDTERX
  8825         GO TO 0015-READ--CARR.                                   ELCDTERX
  8826                                                                  ELCDTERX
  8827     IF DD-ID = 'STAT'                                            ELCDTERX
  8828         GO TO 0020-READ--STAT.                                   ELCDTERX
  8829                                                                  ELCDTERX
  8830     IF DD-ID = 'BUSC'                                            ELCDTERX
  8831         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8832                                                                  ELCDTERX
  8833     IF DD-ID = 'MORT'                                            ELCDTERX
  8834         GO TO 0030-READ--MORT.                                   ELCDTERX
  8835                                                                  ELCDTERX
  8836     IF DD-ID = 'CLAI'                                            ELCDTERX
  8837         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8838                                                                  ELCDTERX
  8839     IF DD-ID = 'COLC'                                            ELCDTERX
  8840         GO TO 0065-READ--COLC.                                   ELCDTERX
  8841                                                                  ELCDTERX
  8842     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8843        DD-IDA = 'CL'                                             ELCDTERX
  8844         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8845                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8846     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8847        DD-IDA = 'PO'                                             ELCDTERX
  8848         GO TO 0050-READ--POXX.                                   ELCDTERX
  8849                                                                  ELCDTERX
  8850     IF DD-ID = 'OPCA'                                            ELCDTERX
  8851         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8852                                                                  ELCDTERX
  8853     IF DD-ID = 'OPST'                                            ELCDTERX
  8854         GO TO 0072-READ--OPST.                                   ELCDTERX
  8855                                                                  ELCDTERX
  8856     IF DD-ID = 'OPBS'                                            ELCDTERX
  8857         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8858                                                                  ELCDTERX
  8859     IF DD-ID = 'OPMS'                                            ELCDTERX
  8860         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8861                                                                  ELCDTERX
  8862     GO TO 0005-READ--CARD.                                       ELCDTERX
  8863                                                                  ELCDTERX
  8864 0010-READ--CLAC.                                                 ELCDTERX
  8865     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8866     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8867     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8868     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8869     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8870     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8871     GO TO 0005-READ--CARD.                                       ELCDTERX
  8872                                                                  ELCDTERX
  8873 0015-READ--CARR.                                                 ELCDTERX
  8874     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8875     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8876        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8877        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8878        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8879        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8880        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8881        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8882        MOVE DD-CARR1-SECPAY-SW
  8883                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8884     END-IF
  8885                                                                  ELCDTERX
  8886     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8887     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8888        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8889        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8890        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8891        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8892        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8893        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8894        MOVE DD-CARR2-SECPAY-SW
  8895                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8896     END-IF
  8897                                                                  ELCDTERX
  8898                                                                  ELCDTERX
  8899     GO TO 0005-READ--CARD.                                       ELCDTERX
  8900                                                                  ELCDTERX
  8901 0020-READ--STAT.                                                 ELCDTERX
  8902     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8903     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8904        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8905         GO TO 0005-READ--CARD.                                   ELCDTERX
  8906                                                                  ELCDTERX
  8907     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8908     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8909     GO TO 0020-READ--STAT.                                       ELCDTERX
  8910                                                                  ELCDTERX
  8911 0025-READ--BUSC.                                                 ELCDTERX
  8912     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8913     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8914        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8915         GO TO 0005-READ--CARD.                                   ELCDTERX
  8916                                                                  ELCDTERX
  8917     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8918     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8919     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8920                                                                  ELCDTERX
  8921 0030-READ--MORT.                                                 ELCDTERX
  8922     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8923     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8924        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8925         GO TO 0005-READ--CARD.                                   ELCDTERX
  8926                                                                  ELCDTERX
  8927     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8928     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8929     GO TO 0030-READ--MORT.                                       ELCDTERX
  8930                                                                  ELCDTERX
  8931 0035-READ--CLXX.                                                 ELCDTERX
  8932     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8933          GO TO 0005-READ--CARD.                                  ELCDTERX
  8934                                                                  ELCDTERX
  8935     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8936         DISPLAY '***********************************************'ELCDTERX
  8937         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8938         DISPLAY '***********************************************'ELCDTERX
  8939         GO TO 0055-READ--STOP.                                   ELCDTERX
  8940                                                                  ELCDTERX
  8941     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8942        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8943         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8944                                                                  ELCDTERX
  8945     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8946        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8947         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8948                                                                  ELCDTERX
  8949*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8950     GO TO 0005-READ--CARD.                                       ELCDTERX
  8951                                                                  ELCDTERX
  8952 0040-READ--CLAI.                                                 ELCDTERX
  8953     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8954     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8955        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8956         GO TO 0005-READ--CARD.                                   ELCDTERX
  8957                                                                  ELCDTERX
  8958     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8959     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8960     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8961                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 165
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8962 0045-READ--DUMP.                                                 ELCDTERX
  8963     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8964     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8965                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8966     PERFORM ABEND-PGM.                                           ELCDTERX
  8967                                                                  ELCDTERX
  8968 0050-READ--POXX.                                                 ELCDTERX
  8969     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8970         GO TO 0005-READ--CARD.                                   ELCDTERX
  8971                                                                  ELCDTERX
  8972     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8973         DISPLAY '***********************************************'ELCDTERX
  8974         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8975         DISPLAY '***********************************************'ELCDTERX
  8976         GO TO 0055-READ--STOP.                                   ELCDTERX
  8977                                                                  ELCDTERX
  8978     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8979     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8980     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8981     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8982                                                                  ELCDTERX
  8983     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8984         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8985     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8986         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8987                                                                  ELCDTERX
  8988     GO TO 0005-READ--CARD.                                       ELCDTERX
  8989                                                                  ELCDTERX
  8990 0055-READ--STOP.                                                 ELCDTERX
  8991     GOBACK.                                                      ELCDTERX
  8992                                                                  ELCDTERX
  8993 0060-READ--TEST.                                                 ELCDTERX
  8994     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8995        CLAX-ID         = SPACE  OR                               ELCDTERX
  8996        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  8997         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8998                                                                  ELCDTERX
  8999     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  9000     GO TO 0079-READ--EXIT.                                       ELCDTERX
  9001                                                                  ELCDTERX
  9002 0065-READ--COLC.                                                 ELCDTERX
  9003     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  9004     GO TO 0005-READ--CARD.                                       ELCDTERX
  9005                                                                  ELCDTERX
  9006 0070-READ--OPCA.                                                 ELCDTERX
  9007                                                                  ELCDTERX
  9008     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9009                                                                  ELCDTERX
  9010     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  9011             OR                                                   ELCDTERX
  9012         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  9013         GO TO 0005-READ--CARD.                                   ELCDTERX
  9014                                                                  ELCDTERX
  9015     ADD 1                       TO INDEXCA.                      ELCDTERX
  9016     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  9017                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  9018     GO TO 0070-READ--OPCA.                                       ELCDTERX
  9019                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 166
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  9020 0072-READ--OPST.                                                 ELCDTERX
  9021                                                                  ELCDTERX
  9022     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9023                                                                  ELCDTERX
  9024     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  9025             OR                                                   ELCDTERX
  9026         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9027         GO TO 0005-READ--CARD.                                   ELCDTERX
  9028                                                                  ELCDTERX
  9029     ADD 1                       TO INDEXST.                      ELCDTERX
  9030     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  9031                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  9032     GO TO 0072-READ--OPST.                                       ELCDTERX
  9033                                                                  ELCDTERX
  9034 0074-READ--OPBS.                                                 ELCDTERX
  9035                                                                  ELCDTERX
  9036     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9037                                                                  ELCDTERX
  9038     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  9039             OR                                                   ELCDTERX
  9040         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9041         GO TO 0005-READ--CARD.                                   ELCDTERX
  9042                                                                  ELCDTERX
  9043     ADD 1                       TO INDEXBS.                      ELCDTERX
  9044     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  9045     GO TO 0074-READ--OPBS.                                       ELCDTERX
  9046                                                                  ELCDTERX
  9047 0079-READ--EXIT.                                                 ELCDTERX
  9048*    EXIT.                                                        ELCDTERX
  9049******************************************************************ELCDTERX
  9050
  9051     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9052
  9053     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9054     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9055     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9056
  9057     MOVE 4                      TO DC-OPTION-CODE.
  9058     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9059     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9060     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9061     MOVE WORK-AREAS             TO HOLD-WORK.
  9062
  9063     IF DTE-PRC-OPT = '2'
  9064         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9065
  9066     OPEN INPUT ELCNTL.
  9067     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9068         NEXT SENTENCE
  9069       ELSE
  9070         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9071         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9072         MOVE EMSG               TO WS-ABEND-MESSAGE
  9073         GO TO ABEND-PGM.
  9074
  9075     OPEN  I-O ERPNDB.
  9076     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9077         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 167
* EL517.cbl
  9078       ELSE
  9079         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9080         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9081         MOVE EMSG               TO WS-ABEND-MESSAGE
  9082         GO TO ABEND-PGM.
  9083
  9084     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9085     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9086
  9087     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9088
  9089     IF ERPNDB-FILE-STATUS NOT = '00'
  9090         GO TO 9999-DONE.
  9091
  9092     OPEN INPUT ERREIN.
  9093     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9094         NEXT SENTENCE
  9095       ELSE
  9096         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9097         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9098         MOVE EMSG               TO WS-ABEND-MESSAGE
  9099         GO TO ABEND-PGM.
  9100
  9101     IF DTE-CLIENT = 'DCC'
  9102        OPEN INPUT ERPDEF ELSTAT
  9103        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9104           CONTINUE
  9105        ELSE
  9106           MOVE ERPDEF-FILE-STATUS
  9107                                 TO WS-ABEND-FILE-STATUS
  9108           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9109           MOVE EMSG             TO WS-ABEND-MESSAGE
  9110           GO TO ABEND-PGM
  9111        END-IF
  9112        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9113           CONTINUE
  9114        ELSE
  9115           MOVE ELSTAT-FILE-STATUS
  9116                                 TO WS-ABEND-FILE-STATUS
  9117           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9118           MOVE EMSG             TO WS-ABEND-MESSAGE
  9119           GO TO ABEND-PGM
  9120        END-IF
  9121     END-IF
  9122
  9123     OPEN I-O   ELCERT.
  9124******************************************************************
  9125*                                                                *
  9126*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9127*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9128*                                                                *
  9129*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9130*                                                                *
  9131*               EL631 - EL6311 - EL6312 - EL6313                 *
  9132*                                                                *
  9133******************************************************************
  9134
  9135     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 168
* EL517.cbl
  9136         NEXT SENTENCE
  9137       ELSE
  9138         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9139         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9140         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9141         GO TO ABEND-PGM.
  9142
  9143     OPEN INPUT ERCTBL.
  9144     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9145         NEXT SENTENCE
  9146       ELSE
  9147         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9148         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9149         MOVE EMSG               TO WS-ABEND-MESSAGE
  9150         GO TO ABEND-PGM.
  9151
  9152     OPEN INPUT ERACCT.
  9153     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9154         NEXT SENTENCE
  9155       ELSE
  9156         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9157         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9158         MOVE EMSG               TO WS-ABEND-MESSAGE
  9159         GO TO ABEND-PGM.
  9160
  9161     OPEN INPUT ERCOMP.
  9162     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9163         NEXT SENTENCE
  9164       ELSE
  9165         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9166         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9167         MOVE EMSG               TO WS-ABEND-MESSAGE
  9168         GO TO ABEND-PGM.
  9169
  9170     OPEN INPUT ERLOFC
  9171     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9172        CONTINUE
  9173     ELSE
  9174        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9175        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9176        MOVE EMSG                TO WS-ABEND-MESSAGE
  9177        GO TO ABEND-PGM
  9178     END-IF
  9179
  9180     OPEN INPUT ERBXRF.
  9181     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9182         NEXT SENTENCE
  9183       ELSE
  9184         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9185         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9186         MOVE EMSG               TO WS-ABEND-MESSAGE
  9187         GO TO ABEND-PGM.
  9188
  9189     OPEN INPUT ERAGTC.
  9190     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9191         NEXT SENTENCE
  9192       ELSE
  9193         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 169
* EL517.cbl
  9194         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9195         MOVE EMSG               TO WS-ABEND-MESSAGE
  9196         GO TO ABEND-PGM.
  9197
  9198     OPEN INPUT ERPLAN.
  9199     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9200        NEXT SENTENCE
  9201     ELSE
  9202        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9203        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9204        MOVE EMSG                TO WS-ABEND-MESSAGE
  9205        GO TO ABEND-PGM.
  9206
  9207     OPEN INPUT ERFORM.
  9208     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9209        OR '9%'
  9210        NEXT SENTENCE
  9211     ELSE
  9212        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9213        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9214        MOVE EMSG                TO WS-ABEND-MESSAGE
  9215        GO TO ABEND-PGM.
  9216
  9217     OPEN INPUT ELCERR.
  9218     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9219         NEXT SENTENCE
  9220       ELSE
  9221         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9222         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9223         MOVE EMSG               TO WS-ABEND-MESSAGE
  9224         GO TO ABEND-PGM.
  9225
  9226     MOVE 'R'                     TO CP-RATE-FILE.
  9227     MOVE 'O'                     TO CP-IO-FUNCTION.
  9228     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9229
  9230     IF IO-ERROR
  9231        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9232        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9233        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9234        GO TO ABEND-PGM.
  9235
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 170
* EL517.cbl
  9237*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9238*
  9239     IF DTE-CLIENT NOT = 'DMD'
  9240         GO TO 0100-READ-PENDING.
  9241
  9242     OPEN INPUT ERRESS ERRESC.
  9243
  9244     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9245         NEXT SENTENCE
  9246     ELSE
  9247         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9248         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9249         MOVE EMSG               TO WS-ABEND-MESSAGE
  9250         GO TO ABEND-PGM.
  9251
  9252     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9253         NEXT SENTENCE
  9254     ELSE
  9255         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9256         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9257         MOVE EMSG               TO WS-ABEND-MESSAGE
  9258         GO TO ABEND-PGM.
  9259
  9260     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9261     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9262     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9263     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9264         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9265         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9266         MOVE EMSG               TO WS-ABEND-MESSAGE
  9267         GO TO ABEND-PGM.
  9268
  9269     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9270     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9271     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9272     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9273         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9274         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9275         MOVE EMSG               TO WS-ABEND-MESSAGE
  9276         GO TO ABEND-PGM.
  9277
  9278     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9279     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9280     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9281     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9282         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9283         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9284         MOVE EMSG               TO WS-ABEND-MESSAGE
  9285         GO TO ABEND-PGM.
  9286
  9287     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9288     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9289     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9290     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9291         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9292         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9293         MOVE EMSG               TO WS-ABEND-MESSAGE
  9294         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 171
* EL517.cbl
  9295
  9296     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9297     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9298     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9299     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9300         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9301         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9302         MOVE EMSG               TO WS-ABEND-MESSAGE
  9303         GO TO ABEND-PGM.
  9304
  9305     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9306     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9307     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9308     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9309         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9310         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9311         MOVE EMSG               TO WS-ABEND-MESSAGE
  9312         GO TO ABEND-PGM.
  9313
  9314     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9315     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9316     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9317     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9318         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9319         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9320         MOVE EMSG               TO WS-ABEND-MESSAGE
  9321         GO TO ABEND-PGM.
  9322
  9323*
  9324*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9325*
  9326 0100-READ-PENDING.
  9327
  9328     MOVE HOLD-WORK TO WORK-AREAS.
  9329
  9330     MOVE ZEROS                  TO EMI-WARNING-CTR
  9331                                    EMI-FORCABLE-CTR
  9332                                    EMI-FATAL-CTR.
  9333 0101-READ-PENDING.
  9334     READ ERPNDB.
  9335     ADD 1 TO RPND.
  9336
  9337     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9338         GO TO 9999-DONE.
  9339
  9340     IF ERPNDB-FILE-STATUS NOT = '00'
  9341         GO TO 9999-DONE.
  9342
  9343     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9344     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9345     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9346
  9347     IF PB-BATCH-TRAILER
  9348         GO TO 9999-REWRITE-RECORD.
  9349
  9350     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9351        GO TO 0100-READ-PENDING.
  9352
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 172
* EL517.cbl
  9353     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9354        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9355        GO TO 0100-READ-PENDING.
  9356
  9357     IF WK-BATCH-PREFIX = '#CL'
  9358        GO TO 0100-READ-PENDING.
  9359
  9360     IF DTE-PRC-OPT = '2'
  9361         NEXT SENTENCE
  9362     ELSE
  9363         IF NOT PB-FATAL-ERRORS
  9364             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9365             GO TO 0100-READ-PENDING.
  9366
  9367     ADD 1 TO TRAN-CT.
  9368
  9370 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 173
* EL517.cbl
*                           COPY ELC50PD.
  9371******************************************************************04/22/98
  9372*                                                                *ELC50PD
  9373*                            ELC50PD                             *   LV012
  9374*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9375*                            VMOD=2.188                          *   CL**7
  9376*                                                                *ELC50PD
  9377******************************************************************
  9378*                   C H A N G E   L O G
  9379*
  9380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9381*-----------------------------------------------------------------
  9382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9383* EFFECTIVE    NUMBER
  9384*-----------------------------------------------------------------
  9385* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9386* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9387* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9388*                             2709 AND 2718
  9389* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9390* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9391* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9392* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9393* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9394*                                IS OPEN OR CNC DT < PD THRU
  9395* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9396* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9397* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9398* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9399* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9400* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9401* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9402* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9403* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9404* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9405* 020906                   PEMA  EXPAND LOAN OFFICER
  9406* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9407* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9408* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9409* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9410* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9411* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9412* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9413* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9414* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9415* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9416* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9417* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9418* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9419* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9420* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9421* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9422* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9423* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9424* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9425* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9426* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9427* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9428* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9429* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9430* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9431*                                UPDATE VIN ON CERT TRAILER
  9432* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9433* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9434* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9435* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9436* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9437* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9438* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9439* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9440* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9441* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9442* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9443* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9444* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9445* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9446* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9447* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9448* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9449* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9450* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9451* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9452* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9453* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9454* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9455* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9456* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9457* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9458* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9459* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9460* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9461* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9462* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9463* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9464* 032912  CR2011110200001  PEMA  AHL CHANGES
  9465* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9466* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9467* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9468* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9469* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  9470* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9471* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9472* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9473* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9474* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9475* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9476* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9477* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9478* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9479* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  9480* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  9481* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  9482* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  9483* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  9484* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  9485******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9486************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9487******************************************************************ELC50PD
  9488                                                                  ELC50PD
  9489     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9490                                                                  ELC50PD
  9491     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9492                                    PB-FORCE-ER-CD                ELC50PD
  9493                                    PB-WARN-ER-CD                 ELC50PD
  9494                                    PB-OUT-BAL-CD.                ELC50PD
  9495                                                                  ELC50PD
  9496     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9497                                    WS-IG-OVRD-LF                 ELC50PD
  9498                                    WS-IG-OVRD-AM                 ELC50PD
  9499                                    WS-IG-OVRD                    ELC50PD
  9500                                    WS-IG-OVRD-AH-PL              ELC50PD
  9501                                    WS-IG-OVRD-LF-PL              ELC50PD
  9502                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9503                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9504                                                                  ELC50PD
  9505******************************************************************ELC50PD
  9506*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9507******************************************************************ELC50PD
  9508                                                                  ELC50PD
  9509     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9510     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9511                                                                  ELC50PD
  9512******************************************************************ELC50PD
  9513                                                                  ELC50PD
  9514     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9515     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9516*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9517     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9518     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9519                                                                  ELC50PD
  9520     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9521                                                                  ELC50PD
  9522 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9523                                                                  ELC50PD
  9524     ADD +1                      TO  SUB4.                        ELC50PD
  9525                                                                  ELC50PD
  9526     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9527         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9528                                                                  ELC50PD
  9529     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9530         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9531                                                                  ELC50PD
  9532     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9533                                                                  ELC50PD
  9534 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9535                                                                  ELC50PD
  9536     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9537        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9538                                         WS-AH-REM-TERM-CALC      ELC50PD
  9539                                         EC-CO-REM-TERM-CALC      ELC50PD
  9540        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9541        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9542        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9543                                         WS-TOL-AH-CLAIM          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9544        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9545                                         WS-TOL-AH-PREM           ELC50PD
  9546                                         EC-CO-TOL-PREM           ELC50PD
  9547        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9548                                         WS-TOL-AH-REFUND         ELC50PD
  9549                                         EC-CO-TOL-REFUND         ELC50PD
  9550        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9551                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9552                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9553        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9554                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9555                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9556        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9557                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9558                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9559        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9560                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9561                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9562        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9563        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9564        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9565        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9566        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9567        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9568        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9569        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9570        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9571        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9572        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9573        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9574                                         EC-CO-MONTH-END-DT       ELC50PD
  9575        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9576          GO TO 0100-READ-ACCT.                                   ELC50PD
  9577                                                                  ELC50PD
  9578     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9579     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9580     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9581     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9582                                                                  ELC50PD
  9583     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9584     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9585     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9586         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9587                                   WK-CO-TOL-CLAIM                ELC50PD
  9588                                   WK-CO-TOL-REFUND               ELC50PD
  9589                                   WK-REFUND-OVS-AMT              ELC50PD
  9590                                   WK-REFUND-OVS-PCT              ELC50PD
  9591                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9592                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9593                                   WK-DEFAULT-APR                 ELC50PD
  9594                                   WK-CO-MAX-CAP                  ELC50PD
  9595        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9596                                   WK-CR-R78-METHOD               ELC50PD
  9597                                   WK-CO-REF-REJECT-SW            ELC50PD
  9598                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9599                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9600                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9601                                   WK-JOINT-AGE-INPUT             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9602        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9603        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9604        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9605        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9606          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9607                                                                  ELC50PD
  9608     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9609        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9610     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9611        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9612     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9613        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9614     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9615        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9616                                                                  ELC50PD
  9617     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9618     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9619     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9620     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9621     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9622     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9623     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9624     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9625     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9626     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9627     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9628     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9629                                                                  ELC50PD
  9630     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9631          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9632        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9633                                                                  ELC50PD
  9634     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9635          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9636        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9637                                                                  ELC50PD
  9638     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9639         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9640     ELSE                                                         ELC50PD
  9641         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9642                                                                  ELC50PD
  9643     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9644     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9645     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9646     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9647                                                                  ELC50PD
  9648     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9649                                                                  ELC50PD
  9650 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9651                                                                  ELC50PD
  9652     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9653     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9654                                                                  ELC50PD
  9655 0100-READ-ACCT.                                                  ELC50PD
  9656                                                                  ELC50PD
  9657     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9658                                                                  ELC50PD
  9659     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9660        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9661                                                                  ELC50PD
  9662     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9663     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9664     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9665                                                                  ELC50PD
  9666     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9667        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9668        GO TO 0105-READ-ACCT
  9669     END-IF
  9670                                                                  ELC50PD
  9671     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9672        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9673           GO TO 0105-READ-ACCT.                                  ELC50PD
  9674                                                                  ELC50PD
  9675     IF PB-STATE NOT = SPACES                                     ELC50PD
  9676        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9677           GO TO 0105-READ-ACCT.                                  ELC50PD
  9678                                                                  ELC50PD
  9679     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9680        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9681           GO TO 0105-READ-ACCT.                                  ELC50PD
  9682                                                                  ELC50PD
  9683     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9684                                                                  ELC50PD
  9685     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9686        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9687        GO TO 0105-READ-ACCT.                                     ELC50PD
  9688                                                                  ELC50PD
  9689     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9690        GO TO 0105-READ-ACCT.                                     ELC50PD
  9691                                                                  ELC50PD
  9692     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9693                                                                  ELC50PD
  9694 0102-ACCT-GETMAIN.                                               ELC50PD
  9695     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9696     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9697                                                                  ELC50PD
  9698 0105-READ-ACCT.                                                  ELC50PD
  9699     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9700     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9701     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9702     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9703     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9704     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9705                                                                  ELC50PD
  9706     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9707                                                                  ELC50PD
  9708     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9709                                                                  ELC50PD
  9710 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9711
  9712     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9713                                                                  ELC50PD
  9714     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9715        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9716        GO TO 0199-ACCT-NOT-FOUND
  9717     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9718     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9719        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9720           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9721                                                                  ELC50PD
  9722     IF PB-STATE NOT = SPACES                                     ELC50PD
  9723        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9724           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9725                                                                  ELC50PD
  9726     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9727        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9728           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9729                                                                  ELC50PD
  9730     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9731                                                                  ELC50PD
  9732     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9733        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9734        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9735                                                                  ELC50PD
  9736     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9737        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9738                                                                  ELC50PD
  9739 0180-ACCOUNT-FOUND.                                              ELC50PD
  9740
  9741     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9742     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9743     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9744     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9745                                                                  ELC50PD
  9746     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9747        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9748                                                                  ELC50PD
  9749     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9750        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9751                                                                  ELC50PD
  9752     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9753        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9754                                                                  ELC50PD
  9755     IF AM-CLP-TOL-PCT NOT NUMERIC
  9756        MOVE +0                  TO AM-CLP-TOL-PCT
  9757     END-IF
  9758     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9759        MOVE +0                  TO AM-SPP-LEASE-COMM
  9760     END-IF
  9761     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9762        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9764                                                                  ELC50PD
  9765     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9766        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9768                                                                  ELC50PD
  9769     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9770        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9771        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9772        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9773         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9774                                                                  ELC50PD
  9775     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9776     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9777     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9778     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9779     IF AM-CLP-TOL-PCT NOT = ZEROS
  9780        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9781     END-IF
  9782     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9783        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9784     END-IF
  9785
  9786
  9787
  9788
  9789*    IF PB-COMPANY-ID = 'DCC'
  9790*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9791*                                   WS-ADMIN-FEES
  9792*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9793*          (SUB5 > +10)
  9794*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9795*             AND (AM-A-COM (SUB5) NUMERIC)
  9796*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9797*                + (AM-A-COM (SUB5) * 1000)
  9798*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9799*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9800*                + (AM-A-COM (SUB5) * 1000)
  9801*             END-IF
  9802*             IF AM-COM-TYP (SUB5) = 'N'
  9803*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9804*                + (AM-A-COM (SUB5) * 1000)
  9805*             END-IF
  9806*          END-IF
  9807*       END-PERFORM
  9808*    END-IF
  9809
  9810     IF (PB-COMPANY-ID = 'DCC')
  9811        AND (PB-ISSUE)
  9812        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9813        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9814           (SUB5 > +10)
  9815           MOVE +0 TO WS-WK-RATE
  9816           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9817              IF (AM-A-COM (SUB5) NUMERIC)
  9818                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9819                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9820              ELSE
  9821                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9822                 IF PB-ISSUE
  9823                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9824                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9825                 ELSE
  9826                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9827                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9828                 END-IF
  9829                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9830                 MOVE ZEROS             TO WS-SUB1
  9831                                           WS-COMMISSION
  9832                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9833                 MOVE '0530'               TO CTBL-SW
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9834                 MOVE ' '                  TO WS-CTBL-READ-SW
  9835                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9836                 IF FIRST-TIME-THROUGH
  9837                    MOVE 'AA'              TO CTBL-BEN-CODE
  9838                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9839                 END-IF
  9840                 IF CTBL-TABLE-FOUND
  9841                    IF PB-ISSUE
  9842                       COMPUTE WS-COMM-CK-AMT =
  9843                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9844                    ELSE
  9845                       COMPUTE WS-COMM-CK-AMT =
  9846                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9847                    END-IF
  9848                    PERFORM 8800-GET-COMP-RATE
  9849                              THRU 8800-EXIT
  9850                 END-IF
  9851              END-IF
  9852              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9853                + (WS-WK-RATE * 1000)
  9854           END-IF
  9855        END-PERFORM
  9856     END-IF
  9857
  9858     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9859         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9860                                                                  ELC50PD
  9861     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9862         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9863     END-IF
  9864                                                                  ELC50PD
  9865     GO TO 0200-READ-CERT.                                        ELC50PD
  9866                                                                  ELC50PD
  9867 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9868                                                                  ELC50PD
  9869     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9870                                                                  ELC50PD
  9871     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9872        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9874     ELSE                                                         ELC50PD
  9875        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9877                                                                  ELC50PD
  9878     GO TO 9990-RETURN.                                           ELC50PD
  9879                                                                  ELC50PD
  9880 0200-READ-CERT.                                                  ELC50PD
  9881                                                                  ELC50PD
  9882     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9883     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9884     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9885     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9886     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9887     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9888     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9889                                                                  ELC50PD
  9890     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9891                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9892     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9893        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9894                                                                  ELC50PD
  9895     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9896        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9897        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9898        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9899                                                                  ELC50PD
  9900     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9901         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9903         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9904                                                                  ELC50PD
  9905     IF PB-ISSUE                                                  ELC50PD
  9906        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9907           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9908              NEXT SENTENCE                                       ELC50PD
  9909            ELSE                                                  ELC50PD
  9910              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9911              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9912              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9913                                                                  ELC50PD
  9914     IF NOT PB-CANCELLATION                                       ELC50PD
  9915        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9916                                                                  ELC50PD
  9917     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9918     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9919     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9920     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9921     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9922     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9923                                                                  ELC50PD
  9924     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9925     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9926     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9927     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9928     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9929     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9930     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9931     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9932     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9933                                                                  ELC50PD
  9934     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9935     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9936     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9937     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9938     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9939     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9940     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9941                                                                  ELC50PD
  9942     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9943     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9944                                                                  ELC50PD
  9945     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9946                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9947     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9948                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9949                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9950     IF CM-O-B-COVERAGE                                           ELC50PD
  9951         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9952                                                                  ELC50PD
  9953     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9954         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9955                                                                  ELC50PD
  9956     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9957         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9958                                                                  ELC50PD
  9959     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9960         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9961         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9962         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9963         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9964         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9965         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9966         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9967*The next line causes a problem with my change  I dont think it is needed
  9968*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9969                                                                  ELC50PD
  9970     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9971     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9972     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9973     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9974     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9975     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9976                                                                  ELC50PD
  9977     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9978     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9979     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9980     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9981                                                                  ELC50PD
  9982     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9983         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9984     ELSE                                                         ELC50PD
  9985         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9986                                                                  ELC50PD
  9987     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9988         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9989     ELSE                                                         ELC50PD
  9990         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9991                                                                  ELC50PD
  9992     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9993                                                                  ELC50PD
  9994     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
  9995           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
  9996                                                                  ELC50PD
  9997     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
  9998           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
  9999                                                                  ELC50PD
 10000     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
 10001           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
 10002                                                                  ELC50PD
 10003     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
 10004           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
 10005                                                                  ELC50PD
 10006     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
 10007           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10008                                                                  ELC50PD
 10009     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
 10010     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
 10011     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
 10012     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
 10013     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
 10014     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
 10015     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
 10016     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
 10017     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
 10018     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
 10019     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
 10020     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
 10021                                                                  ELC50PD
 10022     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
 10023         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
 10024                                                                  ELC50PD
 10025     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
 10026         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
 10027                                                                  ELC50PD
 10028     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
 10029                                                                  ELC50PD
 10030     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
 10031        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
 10032        IF CM-ADDL-CLP NOT NUMERIC
 10033           MOVE +0               TO CM-ADDL-CLP
 10034        END-IF
 10035        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
 10036        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10037           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
 10038        END-IF
 10039     END-IF
 10040
 10041     IF PB-COMPANY-ID = 'DCC'
 10042        MOVE +0                  TO WS-ADMIN-FEES
 10043                                    WS-CSO-ADMIN-FEE
 10044                                    WS-COMM-AND-MFEE
 10045                                    WS-1ST-YR-ALLOW
 10046        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
 10047           (SUB5 > +10)
 10048           MOVE +0 TO WS-WK-RATE
 10049           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
 10050              IF (AM-A-COM (SUB5) NUMERIC)
 10051                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
 10052                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
 10053              ELSE
 10054                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10055                 IF PB-ISSUE
 10056                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10057                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10058                 ELSE
 10059                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10060                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10061                 END-IF
 10062                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10063                 MOVE ZEROS             TO WS-SUB1
 10064                                           WS-COMMISSION
 10065                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10066                 MOVE '0530'               TO CTBL-SW
 10067                 MOVE ' '                  TO WS-CTBL-READ-SW
 10068                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10069                 IF FIRST-TIME-THROUGH
 10070                    MOVE 'AA'              TO CTBL-BEN-CODE
 10071                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10072                 END-IF
 10073                 IF CTBL-TABLE-FOUND
 10074                    IF PB-ISSUE
 10075                       COMPUTE WS-COMM-CK-AMT =
 10076                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10077                    ELSE
 10078                       COMPUTE WS-COMM-CK-AMT =
 10079                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10080                    END-IF
 10081                    PERFORM 8800-GET-COMP-RATE
 10082                              THRU 8800-EXIT
 10083                 END-IF
 10084              END-IF
 10085              IF AM-COM-TYP (SUB5) = 'I'
 10086                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10087                   + (WS-WK-RATE * 1000)
 10088              END-IF
 10089              IF AM-COM-TYP (SUB5) = 'N'
 10090                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10091                   + (WS-WK-RATE * 1000)
 10092              END-IF
 10093              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10094                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10095                   + (WS-WK-RATE * 1000)
 10096              END-IF
 10097              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10098                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10099                   + (WS-WK-RATE * 1000)
 10100              END-IF
 10101           END-IF
 10102        END-PERFORM
 10103     END-IF
 10104
 10105     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10106                                                                  ELC50PD
 10107 0298-UNLOCK-RETURN.                                              ELC50PD
 10108      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10109      GO TO 9990-RETURN.                                          ELC50PD
 10110                                                                  ELC50PD
 10111 0299-CERT-NOT-FOUND.                                             ELC50PD
 10112                                                                  ELC50PD
 10113     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10114                                                                  ELC50PD
 10115     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10116         IF WS-ERROR = ER-2799                                    ELC50PD
 10117             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10118                                                                  ELC50PD
 10119     IF NOT PB-CANCELLATION                                       ELC50PD
 10120         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10121                                                                  ELC50PD
 10122     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10123     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10124     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10125     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10126                                    PB-CI-LF-TERM                 ELC50PD
 10127                                    PB-C-LF-REM-TERM              ELC50PD
 10128                                    PB-CI-AH-TERM                 ELC50PD
 10129                                    PB-C-AH-REM-TERM              ELC50PD
 10130                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10131                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10132                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10133                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10134                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10135                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10136                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10137                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10138                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10139                                    PB-CI-LOAN-APR                ELC50PD
 10140                                    PB-CI-LOAN-TERM               ELC50PD
 10141                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10142                                    PB-CI-AH-COMMISSION           ELC50PD
 10143                                    PB-CI-CURR-SEQ                ELC50PD
 10144                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10145                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10146                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10147                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10148                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10149                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10150                                    PB-CI-LIVES                   ELC50PD
 10151                                    PB-CI-LF-CRIT-PER             ELC50PD
 10152                                    PB-CI-AH-CRIT-PER
 10153                                    PB-CI-ADDL-CLP
 10154                                    PB-CI-DDF-IU-RATE-UP.
 10155                                                                  ELC50PD
 10156     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10157                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10158                                    PB-CI-DEATH-DT                ELC50PD
 10159                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10160                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10161                                    PB-CI-ENTRY-DT                ELC50PD
 10162                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10163                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10164                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10165                                                                  ELC50PD
 10166     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10167        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10168        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10169                                                                  ELC50PD
 10170                                                                  ELC50PD
 10171 0300-CONTINUE-EDIT.                                              ELC50PD
 10172                                                                  ELC50PD
 10173     IF PB-ISSUE                                                  ELC50PD
 10174        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10175            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10176                                                                  ELC50PD
 10177     IF PB-ISSUE                                                  ELC50PD
 10178        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10179            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10180                                                                  ELC50PD
 10181     IF PB-ISSUE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10182       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10183          (AM-NO-AH-ONLY)                                         ELC50PD
 10184           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10185               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10186                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10187                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10188                                                                  ELC50PD
 10189     IF PB-ISSUE                                                  ELC50PD
 10190        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10191        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10192        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10193     ELSE                                                         ELC50PD
 10194        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10195        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10196        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10197                                                                  ELC50PD
 10198     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10199                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10200                                    FORM-MASTER-SW                ELC50PD
 10201                                    WS-APP-CERT-SW.               ELC50PD
 10202                                                                  ELC50PD
 10203     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10204                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10205                                    WS-PL-REF-OVS-AMT             ELC50PD
 10206                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10207                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10208                                    WS-PL-REF-OVS-PCT             ELC50PD
 10209                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10210                                                                  ELC50PD
 10211     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10212       IF PB-ISSUE                                                ELC50PD
 10213         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10214             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10215             IF FORM-MASTER-FOUND                                 ELC50PD
 10216                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10217                                                                  ELC50PD
 10218     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10219        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10220                                                                  ELC50PD
 10221********************** MON CODE **********************            ELC50PD
 10222     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10223     IF PB-ISSUE                                                  ELC50PD
 10224     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10225        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10226             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10227               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
 10228******************************************************            ELC50PD
 10229                                                                  ELC50PD
 10230     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10231       IF PB-ISSUE                                                ELC50PD
 10232           IF FORM-MASTER-FOUND                                   ELC50PD
 10233             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10234                AM-DISMBR-COVERAGE                                ELC50PD
 10235                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10236                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10237                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10238                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10239                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10240                                                                  ELC50PD
 10241     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10242                                                                  ELC50PD
 10243     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10244         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10245         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10246         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10247         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10248         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10249           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10250             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10251         ELSE                                                     ELC50PD
 10252             NEXT SENTENCE                                        ELC50PD
 10253     ELSE                                                         ELC50PD
 10254         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10255                                                                  ELC50PD
 10256     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10257     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10258     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10259     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10260                                                                  ELC50PD
 10261     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10262     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10263                                                                  ELC50PD
 10264     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10265        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10266         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10267                                                                  ELC50PD
 10268     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10269                                                                  ELC50PD
 10270 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10271                                                                  ELC50PD
 10272     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10273                                                                  ELC50PD
 10274     IF NO-BENEFIT-FOUND                                          ELC50PD
 10275        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10276                                                                  ELC50PD
 10277     IF WS-BEN-CD = '99'                                          ELC50PD
 10278        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10279                                                                  ELC50PD
 10280     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10281         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10282             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10283                                                                  ELC50PD
 10284     MOVE +1                     TO SUB5.                         ELC50PD
 10285     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10286                                                                  ELC50PD
 10287* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10288* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10289     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10290         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10291                                                                  ELC50PD
 10292 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10293                                                                  ELC50PD
 10294     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10295        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10296           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10297                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10298           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10299                                                                  ELC50PD
 10300     IF SUB5 LESS THAN +20                                        ELC50PD
 10301        ADD +1                   TO SUB5                          ELC50PD
 10302        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10303                                                                  ELC50PD
 10304     MOVE +1                     TO SUB5.                         ELC50PD
 10305                                                                  ELC50PD
 10306     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10307        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10308                                                                  ELC50PD
 10309 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10310                                                                  ELC50PD
 10311     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10312        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10313           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10314                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10315           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10316                                                                  ELC50PD
 10317     IF SUB5 LESS THAN +30                                        ELC50PD
 10318        ADD +1                   TO SUB5                          ELC50PD
 10319        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10320                                                                  ELC50PD
 10321     MOVE +1                     TO SUB5.                         ELC50PD
 10322                                                                  ELC50PD
 10323 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10324                                                                  ELC50PD
 10325***************************************************************   ELC50PD
 10326*                                                             *   ELC50PD
 10327*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10328*                                                             *   ELC50PD
 10329*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10330*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10331*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10332*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10333*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10334*           BENEFIT CONTROLS.                                 *   ELC50PD
 10335*      99 = ALL BENEFITS                                      *   ELC50PD
 10336*                                                             *   ELC50PD
 10337***************************************************************   ELC50PD
 10338                                                                  ELC50PD
 10339     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10340                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10341                                                                  ELC50PD
 10342     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10343       AND                                                        ELC50PD
 10344        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10345        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10346                                                                  ELC50PD
 10347     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10348       AND                                                        ELC50PD
 10349        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10350        IF CF-REDUCING (SUB3)                                     ELC50PD
 10351           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10352              OR                                                  ELC50PD
 10353           ((AM-IG = '1') AND                                     ELC50PD
 10354           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10355              OR                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10356           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10357           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10358           (AM-IG NOT = '2'))                                     ELC50PD
 10359              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10360                                                                  ELC50PD
 10361     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10362       AND                                                        ELC50PD
 10363        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10364        IF CF-REDUCING (SUB3)                                     ELC50PD
 10365           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10366              OR                                                  ELC50PD
 10367           ((AM-IG = '2') AND                                     ELC50PD
 10368           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10369              OR                                                  ELC50PD
 10370           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10371           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10372           (AM-IG NOT = '1'))                                     ELC50PD
 10373              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10374                                                                  ELC50PD
 10375     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10376       AND                                                        ELC50PD
 10377        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10378        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10379           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10380              OR                                                  ELC50PD
 10381           ((AM-IG = '1') AND                                     ELC50PD
 10382           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10383              OR                                                  ELC50PD
 10384           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10385           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10386            (AM-IG NOT = '2'))                                    ELC50PD
 10387              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10388                                                                  ELC50PD
 10389     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10390       AND                                                        ELC50PD
 10391        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10392        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10393           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10394              OR                                                  ELC50PD
 10395           ((AM-IG = '2') AND                                     ELC50PD
 10396           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10397              OR                                                  ELC50PD
 10398           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10399           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10400           (AM-IG NOT = '1'))                                     ELC50PD
 10401              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10402                                                                  ELC50PD
 10403     IF SUB5 LESS THAN +20                                        ELC50PD
 10404        ADD +1                   TO SUB5                          ELC50PD
 10405        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10406                                                                  ELC50PD
 10407     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10408                                                                  ELC50PD
 10409     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10410        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10411                                                                  ELC50PD
 10412     MOVE +1                     TO SUB5.                         ELC50PD
 10413                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10414 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10415                                                                  ELC50PD
 10416     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10417                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10418                                                                  ELC50PD
 10419     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10420       AND                                                        ELC50PD
 10421        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10422        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10423                                                                  ELC50PD
 10424     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10425       AND                                                        ELC50PD
 10426        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10427        IF CF-REDUCING (SUB3)                                     ELC50PD
 10428           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10429              OR                                                  ELC50PD
 10430           ((AM-IG = '1') AND                                     ELC50PD
 10431           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10432              OR                                                  ELC50PD
 10433           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10434           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10435           (AM-IG NOT = '2'))                                     ELC50PD
 10436              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10437                                                                  ELC50PD
 10438     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10439       AND                                                        ELC50PD
 10440        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10441        IF CF-REDUCING (SUB3)                                     ELC50PD
 10442           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10443              OR                                                  ELC50PD
 10444           ((AM-IG = '2') AND                                     ELC50PD
 10445           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10446              OR                                                  ELC50PD
 10447           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10448           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10449           (AM-IG NOT = '1'))                                     ELC50PD
 10450              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10451                                                                  ELC50PD
 10452     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10453       AND                                                        ELC50PD
 10454        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10455        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10456           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10457              OR                                                  ELC50PD
 10458           ((AM-IG = '1') AND                                     ELC50PD
 10459           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10460              OR                                                  ELC50PD
 10461           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10462           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10463            (AM-IG NOT = '2'))                                    ELC50PD
 10464              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10465                                                                  ELC50PD
 10466     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10467       AND                                                        ELC50PD
 10468        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10469        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10470           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10471              OR                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10472           ((AM-IG = '2') AND                                     ELC50PD
 10473           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10474              OR                                                  ELC50PD
 10475           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10476           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10477           (AM-IG NOT = '1'))                                     ELC50PD
 10478              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10479                                                                  ELC50PD
 10480     IF SUB5 LESS THAN +30                                        ELC50PD
 10481        ADD +1                   TO SUB5                          ELC50PD
 10482        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10483                                                                  ELC50PD
 10484     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10485                                                                  ELC50PD
 10486 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10487                                                                  ELC50PD
 10488     MOVE +99                    TO SUB5.                         ELC50PD
 10489                                                                  ELC50PD
 10490     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10491        IF PB-ISSUE                                               ELC50PD
 10492           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10493           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10494                                                                  ELC50PD
 10495     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10496                                                                  ELC50PD
 10497 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10498                                                                  ELC50PD
 10499     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10500        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10501                                                                  ELC50PD
 10502     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10503     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10504     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10505     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10506     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10507                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10508     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10509                                                                  ELC50PD
 10510 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10511                                                                  ELC50PD
 10512     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10513     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10514                                                                  ELC50PD
 10515 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10516                                                                  ELC50PD
 10517     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10518     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10519     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10520     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10521     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10522     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10523     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10524     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10525                                 TO PLAN-REVISION-NO.             ELC50PD
 10526                                                                  ELC50PD
 10527     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10528     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10529                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10530     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10531       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10532         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10533            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10534             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10535             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10536             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10537                                                                  ELC50PD
 10538     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10539        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10540                                                                  ELC50PD
 10541 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10542                                                                  ELC50PD
 10543     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10544        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10545        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10546        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10547        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10548        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10549        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10550        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10551        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10552          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10553                                                                  ELC50PD
 10554     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10555                                                                  ELC50PD
 10556     IF  PB-CANCELLATION                                          ELC50PD
 10557         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10558                                                                  ELC50PD
 10559     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10560        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10561           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10562           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10563              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10564              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10565           ELSE                                                   ELC50PD
 10566              NEXT SENTENCE                                       ELC50PD
 10567        ELSE                                                      ELC50PD
 10568           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10569              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10570                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10571                                                                  ELC50PD
 10572 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10573                                                                  ELC50PD
 10574     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10575                                                                  ELC50PD
 10576     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10577        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10578                                                                  ELC50PD
 10579     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10580        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10581        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10582                                                                  ELC50PD
 10583     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10584        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10585                                                                  ELC50PD
 10586     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10587        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10588                                                                  ELC50PD
 10589     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10590        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10591                                                                  ELC50PD
 10592     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10593        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10594                                                                  ELC50PD
 10595     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10596        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10597                                                                  ELC50PD
 10598     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10599                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10600        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10601                                                                  ELC50PD
 10602     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10603                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10604        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10605                                                                  ELC50PD
 10606     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10607                          PL-SALES-TAX > +0                       ELC50PD
 10608         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10609                                                                  ELC50PD
 10610     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10611        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10612                                    WS-IG-OVRD-AM.                ELC50PD
 10613                                                                  ELC50PD
 10614 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10615                                                                  ELC50PD
 10616     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10617                                                                  ELC50PD
 10618     IF PB-ISSUE                                                  ELC50PD
 10619        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10620     ELSE                                                         ELC50PD
 10621        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10622                                                                  ELC50PD
 10623     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10624     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10625     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10626     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10627     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10628                                         WS-LF-REFUND-CALC.       ELC50PD
 10629     if (ws-lf-earnings-calc = '5')
 10630        and (pb-i-loan-apr = zeros)
 10631        and (benefit-code-chg)
 10632        move +99.9999 to pb-i-loan-apr
 10633     end-if
 10634                                                                  ELC50PD
 10635     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10636        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10637                                                                  ELC50PD
 10638     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10639        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10640
 10641     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10642                                                                  ELC50PD
 10643     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10644     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10645     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10646     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10647     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10648     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10649                                                                  ELC50PD
 10650     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10651        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10652         NEXT SENTENCE                                            ELC50PD
 10653     ELSE                                                         ELC50PD
 10654         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10655            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10656               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10657                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10658                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10659                                                                  ELC50PD
 10660     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10661     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10662                                                                  ELC50PD
 10663     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10664                                                                  ELC50PD
 10665 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10666                                                                  ELC50PD
 10667     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10668     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10669     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10670                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10672                                                                  ELC50PD
 10673 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10674                                                                  ELC50PD
 10675     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10676                                    PLAN-MASTER-AH-SW.            ELC50PD
 10677                                                                  ELC50PD
 10678     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10679                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10680                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10681                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10682                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10683                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10684                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10685     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10686                                                                  ELC50PD
 10687                                                                  ELC50PD
 10688     if pb-issue
 10689        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10690           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10691        end-if
 10692        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10693           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10694           GO TO 0399-BENEFIT-NOT-FOUND
 10695        end-if
 10696     end-if
 10697                                                                  ELC50PD
 10698     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10699        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10700                                                                  ELC50PD
 10701     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10702                                                                  ELC50PD
 10703     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10704         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10705         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10706         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10707         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10708           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10709             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10710         ELSE                                                     ELC50PD
 10711             NEXT SENTENCE                                        ELC50PD
 10712     ELSE                                                         ELC50PD
 10713         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10714                                                                  ELC50PD
 10715     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10716     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10717     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10718     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10719                                                                  ELC50PD
 10720     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10721     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10722                                                                  ELC50PD
 10723     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10724        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10725          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10726                                                                  ELC50PD
 10727     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10728                                                                  ELC50PD
 10729 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10730                                                                  ELC50PD
 10731     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10732                                                                  ELC50PD
 10733     IF NO-BENEFIT-FOUND                                          ELC50PD
 10734         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10735                                                                  ELC50PD
 10736     IF WS-BEN-CD = '99'                                          ELC50PD
 10737        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10738                                                                  ELC50PD
 10739     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10740         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10741             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10742                                                                  ELC50PD
 10743     MOVE +1                     TO SUB5.                         ELC50PD
 10744     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10745                                                                  ELC50PD
 10746* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10747* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10748     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10749         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10750                                                                  ELC50PD
 10751 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10752                                                                  ELC50PD
 10753     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10754        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10755           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10756                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10757           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10758                                                                  ELC50PD
 10759     IF SUB5 LESS THAN +20                                        ELC50PD
 10760        ADD +1                   TO SUB5                          ELC50PD
 10761        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10762                                                                  ELC50PD
 10763     MOVE +1                     TO SUB5.                         ELC50PD
 10764                                                                  ELC50PD
 10765     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10766        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10767                                                                  ELC50PD
 10768 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10769                                                                  ELC50PD
 10770     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10771        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10772           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10773                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10774           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10775                                                                  ELC50PD
 10776     IF SUB5 LESS THAN +30                                        ELC50PD
 10777        ADD +1                   TO SUB5                          ELC50PD
 10778        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10779                                                                  ELC50PD
 10780     MOVE +1                     TO SUB5.                         ELC50PD
 10781                                                                  ELC50PD
 10782 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10783                                                                  ELC50PD
 10784***************************************************************   ELC50PD
 10785*                                                             *   ELC50PD
 10786*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10787*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10788*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10789*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10790*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10791*           BENEFIT CONTROLS.                                 *   ELC50PD
 10792*      99 = ALL BENEFITS.                                     *   ELC50PD
 10793*                                                             *   ELC50PD
 10794***************************************************************   ELC50PD
 10795                                                                  ELC50PD
 10796     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10797                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10798                                                                  ELC50PD
 10799     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10800       AND                                                        ELC50PD
 10801        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10802        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10803                                                                  ELC50PD
 10804     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10805       AND                                                        ELC50PD
 10806        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10807           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10808              OR                                                  ELC50PD
 10809           ((AM-IG = '1') AND                                     ELC50PD
 10810           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10811              OR                                                  ELC50PD
 10812           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10813           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10814           (AM-IG NOT = '2'))                                     ELC50PD
 10815              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10816                                                                  ELC50PD
 10817     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10818       AND                                                        ELC50PD
 10819        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10820           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10821              OR                                                  ELC50PD
 10822           ((AM-IG = '2') AND                                     ELC50PD
 10823           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10824              OR                                                  ELC50PD
 10825           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10826           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10827           (AM-IG NOT = '1'))                                     ELC50PD
 10828              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10829                                                                  ELC50PD
 10830     IF SUB5 LESS THAN +20                                        ELC50PD
 10831        ADD +1                   TO SUB5                          ELC50PD
 10832        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10833                                                                  ELC50PD
 10834     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10835        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10836                                                                  ELC50PD
 10837     MOVE +1                    TO SUB5.                          ELC50PD
 10838                                                                  ELC50PD
 10839 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10840                                                                  ELC50PD
 10841     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10842                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10843                                                                  ELC50PD
 10844     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10845       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10846        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10847        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10848                                                                  ELC50PD
 10849     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10850       AND                                                        ELC50PD
 10851        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10852           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10853              OR                                                  ELC50PD
 10854           ((AM-IG = '1') AND                                     ELC50PD
 10855           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10856              OR                                                  ELC50PD
 10857           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10858           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10859           (AM-IG NOT = '2'))                                     ELC50PD
 10860              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10861                                                                  ELC50PD
 10862     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10863       AND                                                        ELC50PD
 10864        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10865           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10866              OR                                                  ELC50PD
 10867           ((AM-IG = '2') AND                                     ELC50PD
 10868           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10869              OR                                                  ELC50PD
 10870           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10871           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10872           (AM-IG NOT = '1'))                                     ELC50PD
 10873              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10874                                                                  ELC50PD
 10875     IF SUB5 LESS THAN +30                                        ELC50PD
 10876        ADD +1                   TO SUB5                          ELC50PD
 10877        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10878                                                                  ELC50PD
 10879 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10880                                                                  ELC50PD
 10881     MOVE +99                    TO SUB5.                         ELC50PD
 10882                                                                  ELC50PD
 10883     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10884                                                                  ELC50PD
 10885     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10886        IF PB-ISSUE                                               ELC50PD
 10887           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10888           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10889                                                                  ELC50PD
 10890     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10891                                                                  ELC50PD
 10892 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10893                                                                  ELC50PD
 10894     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10895         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10896                                                                  ELC50PD
 10897     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10898     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10899     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10900     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10901     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10902                                    PLAN-MASTER-AH-SW.            ELC50PD
 10903*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10904     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10905                                                                  ELC50PD
 10906 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10907                                                                  ELC50PD
 10908     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10909     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10910                                                                  ELC50PD
 10911 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10912                                                                  ELC50PD
 10913     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10914     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10915     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10916     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10917     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10918     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10919     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10920     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10921                                 TO PLAN-REVISION-NO.             ELC50PD
 10922                                                                  ELC50PD
 10923     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10924     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10925                                                                  ELC50PD
 10926     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10927       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10928         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10929            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10930             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10931             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10932             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10933                                                                  ELC50PD
 10934     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10935        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10936                                                                  ELC50PD
 10937 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10938                                                                  ELC50PD
 10939     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10940        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10941        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10942        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10943        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10944        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10945        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10946        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10947        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10948          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10949                                                                  ELC50PD
 10950     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10951                                                                  ELC50PD
 10952     IF  PB-CANCELLATION                                          ELC50PD
 10953         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10954                                                                  ELC50PD
 10955     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10956       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10957          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10958          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10959             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10960             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10961          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10962             NEXT SENTENCE                                        ELC50PD
 10963       ELSE                                                       ELC50PD
 10964          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10965             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10966                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10967                                                                  ELC50PD
 10968 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10969                                                                  ELC50PD
 10970     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10971                                                                  ELC50PD
 10972     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10973        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10974                                                                  ELC50PD
 10975     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10976        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10977        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10978                                                                  ELC50PD
 10979     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10980        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10981                                                                  ELC50PD
 10982     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10983        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10984                                                                  ELC50PD
 10985     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10986        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10987                                                                  ELC50PD
 10988     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10989        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10990                                                                  ELC50PD
 10991     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10992        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10993                                                                  ELC50PD
 10994     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 10995                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10996        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 10997                                                                  ELC50PD
 10998     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 10999                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 11000        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 11001                                                                  ELC50PD
 11002     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 11003        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 11004        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 11005            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 11006                                                                  ELC50PD
 11007 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 11008                                                                  ELC50PD
 11009     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 11010                                                                  ELC50PD
 11011     IF PB-ISSUE                                                  ELC50PD
 11012        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 11013       ELSE                                                       ELC50PD
 11014        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 11015                                                                  ELC50PD
 11016     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 11017     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 11018     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 11019     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11020                                         WS-AH-REFUND-CALC.       ELC50PD
 11021                                                                  ELC50PD
 11022     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 11023        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 11024                                                                  ELC50PD
 11025     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 11026        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 11027
 11028     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 11029                                                                  ELC50PD
 11030     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 11031     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 11032     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 11033     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 11034     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 11035     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11036                                                                  ELC50PD
 11037     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 11038        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 11039         NEXT SENTENCE                                            ELC50PD
 11040     ELSE                                                         ELC50PD
 11041         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 11042            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 11043                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 11044                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 11045                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11046                                                                  ELC50PD
 11047     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 11048     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 11049                                                                  ELC50PD
 11050     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 11051                                                                  ELC50PD
 11052 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 11053                                                                  ELC50PD
 11054     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 11055     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 11056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11057                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11059                                                                  ELC50PD
 11060 0400-FIND-CARRIER.                                               ELC50PD
 11061                                                                  ELC50PD
 11062     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11063                                                                  ELC50PD
 11064     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11065     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11066     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11067     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11068                                                                  ELC50PD
 11069*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11070     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11071                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11072                                                                  ELC50PD
 11073     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11074     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11075                                                                  ELC50PD
 11076     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11077        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11078                                                                  ELC50PD
 11079 0400-BUILD-CARR-TOL.                                             ELC50PD
 11080                                                                  ELC50PD
 11081     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11082        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11083        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11084                                    WS-TOL-AH-PREM.               ELC50PD
 11085                                                                  ELC50PD
 11086     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11087        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11088        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11089                                    WS-TOL-AH-REFUND.             ELC50PD
 11090                                                                  ELC50PD
 11091     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11092        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11093        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11094                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11095                                                                  ELC50PD
 11096     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11097        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11098        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11099                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11100                                                                  ELC50PD
 11101     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11102        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11103        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11104                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11105                                                                  ELC50PD
 11106     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11107        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11108        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11109                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11110                                                                  ELC50PD
 11111     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11112         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11113                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11114                                                                  ELC50PD
 11115     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11116     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11117        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11118     END-IF
 11119     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11120        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11121     END-IF
 11122     IF WS-TOL-CLP-PCT = ZEROS
 11123        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11124     END-IF
 11125
 11126     IF WS-SPP-LEASE-COMM = ZEROS
 11127        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11128     END-IF
 11129
 11130     GO TO 0400-FIND-ERPDEF.
 11131                                                                  ELC50PD
 11132 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11133                                                                  ELC50PD
 11134     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11135     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11136                                                                  ELC50PD
 11137 0400-FIND-ERPDEF.
 11138
 11139     IF PB-COMPANY-ID = 'DCC'
 11140        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11141        CONTINUE
 11142     ELSE
 11143        GO TO 0400-FIND-ERCOMP
 11144     END-IF
 11145
 11146     MOVE ' '                    TO PDEF-MASTER-SW
 11147     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11148     MOVE PB-STATE               TO ERPDEF-STATE
 11149     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11150     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11151     IF PB-ISSUE
 11152        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11153     ELSE
 11154        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11155     END-IF
 11156     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11157     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11158     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11159     IF PDEF-MASTER-FOUND
 11160        MOVE 'N'                 TO PDEF-MASTER-SW
 11161        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11162        IF PDEF-MASTER-FOUND
 11163           IF (ERPDEF-KEY-SAVE (1:16) =
 11164                        PD-CONTROL-PRIMARY (1:16))
 11165              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11166              CONTINUE
 11167           ELSE
 11168              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11169              IF (ERPDEF-KEY-SAVE (1:16) =
 11170                        PD-CONTROL-PRIMARY (1:16))
 11171                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11172                 CONTINUE
 11173              ELSE
 11174                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11175              END-IF
 11176           END-IF
 11177        END-IF
 11178        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11179     END-IF
 11180     IF PDEF-MASTER-FOUND
 11181        IF PD-TRUNCATED = 'Y'
 11182           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11183        END-IF
 11184     END-IF
 11185
 11186     .
 11187 0400-FIND-ERCOMP.
 11188
 11189     IF PB-COMPANY-ID = 'DCC'
 11190        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11191           (WS-SUB1 > +10)
 11192           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11193                 OR 'A' OR 'N'
 11194              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11195              MOVE PB-CARRIER    TO COMP-CARRIER
 11196              MOVE PB-GROUPING   TO COMP-GROUPING
 11197              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11198              MOVE AM-AGT (WS-SUB1)
 11199                                 TO COMP-FIN-RESP
 11200              MOVE 'G'           TO COMP-TYPE
 11201              PERFORM 8582-READ-COMPENSATION-MASTER
 11202                                 THRU 8582-EXIT
 11203              IF COMP-MASTER-FOUND
 11204                 IF CO-GA-INACTIVE
 11205                    MOVE ER-2763 TO WS-ERROR
 11206                    PERFORM 9900-ERROR-FORMAT
 11207                                 THRU 9900-EXIT
 11208                    MOVE +11     TO WS-SUB1
 11209                 END-IF
 11210                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11211                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11212                    MOVE ER-2788 TO WS-ERROR
 11213                    PERFORM 9900-ERROR-FORMAT
 11214                                 THRU 9900-EXIT
 11215                    MOVE +11     TO WS-SUB1
 11216                 END-IF
 11217              END-IF
 11218           END-IF
 11219        END-PERFORM
 11220     END-IF
 11221
 11222     IF PB-COMPANY-ID = 'DCC'
 11223        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11224           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11225                                    WS-CLP-STATE
 11226        ELSE
 11227           MOVE SPACES           TO PB-I-CLP-STATE
 11228                                    WS-CLP-STATE
 11229        END-IF
 11230     END-IF
 11231
 11232     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11233        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11234        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11235        CONTINUE
 11236     ELSE
 11237        GO TO 0400-FIND-STATE-RECORD
 11238     END-IF
 11239
 11240     MOVE SPACES                 TO WS-CLP-STATE
 11241     MOVE +0                     TO WS-BANK-FEE
 11242                                    WS-BANK-LFEE
 11243                                    WS-BANK-NOCHRGB
 11244
 11245     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11246
 11247     IF (PB-ISSUE)
 11248        AND (PB-I-BANK-NUMBER NOT =
 11249            SPACES AND ZEROS AND LOW-VALUES)
 11250        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11251     ELSE
 11252        IF (PB-CANCELLATION)
 11253           AND (PB-CI-BANK-NUMBER NOT =
 11254                SPACES AND ZEROS AND LOW-VALUES)
 11255           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11256        END-IF
 11257     END-IF
 11258
 11259     IF COMP-FIN-RESP NOT = LOW-VALUES
 11260        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11261        MOVE PB-CARRIER          TO COMP-CARRIER
 11262        MOVE PB-GROUPING         TO COMP-GROUPING
 11263        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11264        MOVE 'B'                 TO COMP-TYPE
 11265        PERFORM 8582-READ-COMPENSATION-MASTER
 11266                                 THRU 8582-EXIT
 11267        IF COMP-MASTER-FOUND
 11268           IF CO-MAX-BANK-FEE NOT NUMERIC
 11269              MOVE +0            TO CO-MAX-BANK-FEE
 11270           END-IF
 11271           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11272              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11273           END-IF
 11274           IF CO-GA-INACTIVE
 11275              MOVE ER-2763       TO WS-ERROR
 11276              PERFORM 9900-ERROR-FORMAT
 11277                                 THRU 9900-EXIT
 11278           END-IF
 11279           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11280              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11281              MOVE ER-2788 TO WS-ERROR
 11282              PERFORM 9900-ERROR-FORMAT
 11283                                 THRU 9900-EXIT
 11284              MOVE +11     TO WS-SUB1
 11285           END-IF
 11286           IF WS-AH-BEN-CATEGORY = 'G'
 11287              MOVE CO-MAX-BANK-FEE
 11288                                 TO WS-BANK-FEE
 11289                                    PB-I-BANK-FEE
 11290           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11291              MOVE CO-MAX-BANK-FEE-LEASE
 11292                                 TO WS-BANK-LFEE
 11293                                    PB-I-BANK-FEE
 11294           END-IF
 11295           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11296              AND (WS-AH-REFUND-CALC = 'G'))
 11297                        OR
 11298              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11299              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11300              CONTINUE
 11301           ELSE
 11302              MOVE ER-2789 TO WS-ERROR
 11303              PERFORM 9900-ERROR-FORMAT
 11304                                 THRU 9900-EXIT
 11305           END-IF
 11306           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11307                                    PB-I-CLP-STATE
 11308           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11309           MOVE CO-CARRIER       TO BXRF-CARRIER
 11310           MOVE CO-GROUPING      TO BXRF-GROUPING
 11311           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11312           MOVE BXRF-MAX-REC-LENGTH
 11313                                 TO BXRF-REC-LENGTH
 11314           PERFORM 8584-READ-BANK-CROSS-REF
 11315                                 THRU 8584-EXIT
 11316           IF BXRF-MASTER-FOUND
 11317              MOVE ' '           TO BANK-ACCT-SW
 11318              MOVE BK-BANK-POINTER-CNT
 11319                                 TO BK-BANK-POINTER-CNT
 11320              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11321                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11322                 OR (BANK-ACCT-FOUND)
 11323                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11324                    AND (BK-AM-EXP-DT (WS-SUB1)
 11325                                 > PB-CERT-EFF-DT)
 11326                    AND (BK-AM-EFF-DT (WS-SUB1)
 11327                                 NOT > PB-CERT-EFF-DT)
 11328                    SET BANK-ACCT-FOUND TO TRUE
 11329                 END-IF
 11330              END-PERFORM
 11331              IF NOT BANK-ACCT-FOUND
 11332                 MOVE ZEROS      TO WS-BANK-FEE
 11333                                    WS-BANK-LFEE
 11334                 MOVE ER-2869    TO WS-ERROR
 11335                 PERFORM 9900-ERROR-FORMAT
 11336                                 THRU 9900-EXIT
 11337              ELSE
 11338                 PERFORM 5000-PROCESS-REPS
 11339                                 THRU 5000-EXIT
 11340                 IF AGENT-MASTER-FOUND
 11341                    MOVE +0      TO WS-BANK-FEE
 11342                                    WS-BANK-LFEE
 11343*                   MOVE AG-SPP-FEES (1)
 11344*                                TO PB-I-BANK-FEE
 11345*                                   WS-BANK-FEE
 11346                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11347                       (WS-SUB1 > +10)
 11348                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11349                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11350                       END-IF
 11351                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11352                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11353                       END-IF
 11354                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11355                          AG-SPP-FEES (WS-SUB1)
 11356                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11357                          AG-SPP-LFEES (WS-SUB1)
 11358                    END-PERFORM
 11359                    IF WS-AH-BEN-CATEGORY = 'G'
 11360                       MOVE WS-BANK-FEE
 11361                                 TO PB-I-BANK-FEE
 11362                    ELSE
 11363                       MOVE WS-BANK-LFEE
 11364                                 TO PB-I-BANK-FEE
 11365                    END-IF
 11366                 END-IF
 11367              END-IF
 11368           END-IF
 11369        ELSE
 11370           MOVE ER-2879          TO WS-ERROR
 11371           PERFORM 9900-ERROR-FORMAT
 11372                                 THRU 9900-EXIT
 11373        END-IF
 11374     ELSE
 11375        MOVE ER-2879             TO WS-ERROR
 11376        PERFORM 9900-ERROR-FORMAT
 11377                                 THRU 9900-EXIT
 11378     END-IF
 11379
 11380     IF WS-AH-BEN-CATEGORY = 'G'
 11381        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11382        + WS-BANK-FEE
 11383     ELSE
 11384        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11385        + WS-BANK-LFEE
 11386     END-IF
 11387
 11388     .
 11389 0400-FIND-STATE-RECORD.                                          ELC50PD
 11390                                                                  ELC50PD
 11391     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11392         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11393         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11394         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11395         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11396         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11397             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11398         ELSE                                                     ELC50PD
 11399             NEXT SENTENCE                                        ELC50PD
 11400     ELSE                                                         ELC50PD
 11401         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11402                                                                  ELC50PD
 11403     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11404     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11405     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11406     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11407                                                                  ELC50PD
 11408     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11409     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11410                                                                  ELC50PD
 11411     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11412        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11413        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11414        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11415                                    WS-TOL-AH-CLAIM               ELC50PD
 11416                                    WS-MINIMUM-REFUND             ELC50PD
 11417                                    WS-TOL-LF-PREM                ELC50PD
 11418                                    WS-TOL-AH-PREM                ELC50PD
 11419                                    WS-TOL-LF-REFUND              ELC50PD
 11420                                    WS-TOL-AH-REFUND              ELC50PD
 11421                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11422                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11423                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11424                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11425                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11426                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11427                                    EC-ST-TOL-PREM                ELC50PD
 11428                                    EC-ST-TOL-REFUND              ELC50PD
 11429                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11430                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11431                                    WS-ST-LF-PREM-TAX
 11432                                    WS-ST-AH-PREM-TAX-I
 11433                                    WS-ST-AH-PREM-TAX-G
 11434                                    WS-BANK-FEE
 11435                                    WS-BANK-LFEE
 11436                                    WS-TOL-CLP-PCT
 11437                                    WS-SPP-LEASE-COMM
 11438        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11439                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11440                                    WS-LF-REM-TERM-CALC           ELC50PD
 11441                                    WS-LF-REFUND-CALC             ELC50PD
 11442                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11443                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11444                                    WS-AH-REM-TERM-CALC           ELC50PD
 11445                                    WS-AH-REFUND-CALC
 11446                                    WS-LF-BEN-CATEGORY
 11447                                    WS-AH-BEN-CATEGORY
 11448                                    WS-CLP-STATE
 11449                                    WS-ST-REFUND-CLAIM-FLAG
 11450                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11451                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11452          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11453                                                                  ELC50PD
 11454     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11455                                                                  ELC50PD
 11456 0405-CONTINUE-EDIT.                                              ELC50PD
 11457
 11458     if pb-company-id = 'AHL'
 11459        continue
 11460     else
 11461        IF PB-CERT-PRIME NOT NUMERIC
 11462           MOVE ER-2722          TO WS-ERROR
 11463           PERFORM 9900-ERROR-FORMAT
 11464                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11465        end-if
 11466     END-IF
 11467
 11468*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11469*       MOVE +0                  TO SUB3
 11470*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11471*       IF SUB3 > +0
 11472*          MOVE ER-2722          TO WS-ERROR
 11473*          PERFORM 9900-ERROR-FORMAT
 11474*                                THRU 9900-EXIT
 11475*       END-IF
 11476*    END-IF
 11477
 11478
 11479*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11480*       IF PB-CERT-PRIME NOT NUMERIC
 11481*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11482*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11483*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11484*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11485*
 11486*          MOVE ER-2722          TO WS-ERROR
 11487*          PERFORM 9900-ERROR-FORMAT
 11488*                                THRU 9900-EXIT
 11489*       END-IF
 11490*    END-IF
 11491
 11492     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11493                                                                  ELC50PD
 11494     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11495        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11496                                    WS-TOL-AH-CLAIM.              ELC50PD
 11497                                                                  ELC50PD
 11498     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11499        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11500                                                                  ELC50PD
 11501     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11502        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11503                                                                  ELC50PD
 11504     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11505        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11506                                    WS-TOL-AH-PREM                ELC50PD
 11507        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11508                                                                  ELC50PD
 11509     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11510        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11511                                    WS-TOL-AH-REFUND              ELC50PD
 11512        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11513                                                                  ELC50PD
 11514     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11515        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11516        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11517                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11518                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11519                                                                  ELC50PD
 11520     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11521        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11522        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11523                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11524                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11525                                                                  ELC50PD
 11526     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11527        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11528        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11529                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11530                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11531                                                                  ELC50PD
 11532     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11533        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11534        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11535                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11536                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11537                                                                  ELC50PD
 11538     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11539     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11540                                                                  ELC50PD
 11541     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11542          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11543                                                                  ELC50PD
 11544     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11545     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11546
 11547     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11548                                                                  ELC50PD
 11549     IF CF-ST-LF-PREM-TAX NUMERIC
 11550        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11551     END-IF
 11552     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11553        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11554     END-IF
 11555     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11556        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11557     END-IF
 11558
 11559     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11560         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11561     END-IF.
 11562
 11563     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11564        GO TO 0410-CHECK-AH.                                      ELC50PD
 11565                                                                  ELC50PD
 11566     IF CF-ST-RT-CALC NOT = SPACES
 11567        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11568                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11569     END-IF
 11570
 11571     IF WS-LF-COVERAGE-TYPE = 'R'
 11572        IF WS-LF-EARNINGS-CALC = '5'
 11573           IF CF-ST-RF-LN-CALC > '0'
 11574              MOVE CF-ST-RF-LN-CALC
 11575                                 TO WS-LF-REFUND-CALC
 11576                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11577           END-IF
 11578        ELSE
 11579           IF CF-ST-RF-LR-CALC > '0'
 11580              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11581                                 TO WS-LF-REFUND-CALC
 11582                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11583           END-IF
 11584        END-IF
 11585     ELSE
 11586        IF CF-ST-RF-LL-CALC > '0'
 11587           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11588                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11589        END-IF
 11590     END-IF
 11591
 11592     IF CF-ST-RT-CALC NOT = SPACES
 11593        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11594                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11595     END-IF
 11596
 11597     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11598     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11599                                                                  ELC50PD
 11600     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11601                                                                  ELC50PD
 11602     IF NO-BENEFIT-FOUND                                          ELC50PD
 11603        GO TO 0410-CHECK-AH.                                      ELC50PD
 11604                                                                  ELC50PD
 11605     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11606        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11607                                 TO EC-ST-LF-REM-TERM-CALC
 11608                                    WS-LF-REM-TERM-CALC           ELC50PD
 11609     END-IF
 11610                                                                  ELC50PD
 11611     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11612        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11613                                 TO WS-LF-REFUND-CALC             ELC50PD
 11614                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11615     END-IF
 11616*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11617                                                                  ELC50PD
 11618     .                                                            ELC50PD
 11619 0410-CHECK-AH.                                                   ELC50PD
 11620                                                                  ELC50PD
 11621     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11622        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11623                                                                  ELC50PD
 11624     IF CF-ST-RT-CALC NOT = SPACES
 11625        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11626                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11627     END-IF
 11628
 11629     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11630        IF CF-ST-RF-CP-CALC > '0'
 11631           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11632                                    EC-ST-AH-REFUND-CALC
 11633        END-IF
 11634     ELSE
 11635        IF CF-ST-RF-AH-CALC > '0'
 11636           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11637                                    EC-ST-AH-REFUND-CALC
 11638        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11639     END-IF
 11640     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11641     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11642                                                                  ELC50PD
 11643     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11644                                                                  ELC50PD
 11645     IF NO-BENEFIT-FOUND                                          ELC50PD
 11646        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11647                                                                  ELC50PD
 11648     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11649        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11650                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11651                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11652     END-IF
 11653                                                                  ELC50PD
 11654     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11655        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11656                                 TO WS-AH-REFUND-CALC             ELC50PD
 11657                                    EC-ST-AH-REFUND-CALC
 11658     END-IF
 11659                                                                  ELC50PD
 11660*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11661                                                                  ELC50PD
 11662     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11663                                                                  ELC50PD
 11664 0499-STATE-NOT-FOUND.                                            ELC50PD
 11665                                                                  ELC50PD
 11666     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11667     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11668                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11670                                                                  ELC50PD
 11671 0500-SET-ACCOUNT.                                                ELC50PD
 11672
 11673*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11674
 11675     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11676        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11677        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11678        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11679        MOVE '3'                 TO CNTL-REC-TYPE
 11680        MOVE +0                  TO CNTL-SEQ-NO
 11681
 11682        MOVE '3'                 TO RC-SW-2
 11683        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11684
 11685        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11686           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11687           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11688           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11689                                    WS-ST-AH-PREM-TAX-I
 11690                                    WS-ST-AH-PREM-TAX-G
 11691        ELSE
 11692           IF CF-ST-LF-PREM-TAX NUMERIC
 11693              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11694           END-IF
 11695           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11696              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11697           END-IF
 11698           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11699              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11700           END-IF
 11701        END-IF
 11702        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11703     END-IF
 11704
 11705*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11706*  FOR DCC ONLY
 11707
 11708     IF PB-COMPANY-ID = 'DCC'
 11709
 11710     MOVE ' '                    TO STAT-MASTER-SW
 11711     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11712     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11713     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11714     MOVE PB-STATE               TO ELSTAT-STATE
 11715     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11716        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11717     END-IF
 11718
 11719     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11720     SET BIN-TO-GREG             TO TRUE
 11721     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11722     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11723     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11724
 11725     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11726     IF STAT-MASTER-FOUND
 11727        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11728        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11729        IF STAT-MASTER-FOUND
 11730           IF (ELSTAT-KEY-SAVE (1:12) =
 11731                        SF-CONTROL-PRIMARY (1:12))
 11732              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11733                 MOVE 'F'        TO STAT-MASTER-SW
 11734              ELSE
 11735                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11736                 IF (STAT-MASTER-FOUND)
 11737                    AND (ELSTAT-KEY-SAVE (1:12) =
 11738                        SF-CONTROL-PRIMARY (1:12))
 11739                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11740                    MOVE 'F'     TO STAT-MASTER-SW
 11741                 END-IF
 11742              END-IF
 11743           END-IF
 11744        END-IF
 11745     END-IF
 11746
 11747     IF STAT-MASTER-SW = 'F'
 11748        IF SF-ST-LF-PREM-TAX NUMERIC
 11749           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11750        END-IF
 11751        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11752           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11753        END-IF
 11754        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11755           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11756        END-IF
 11757     END-IF
 11758
 11759     END-IF
 11760
 11761     IF (PB-COMPANY-ID = 'DCC')
 11762        AND (PB-ISSUE)
 11763        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11764        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11765        AND (AM-GPCD = 06)
 11766        MOVE 'Y'                 TO WS-GOOD-HIN
 11767        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11768           MOVE PB-I-VIN         TO WS-WORK-VIN
 11769           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11770              (V1 > 16)
 11771              IF WS-WORK-VIN (V1:1) NUMERIC
 11772                 MOVE WS-WORK-VIN-N (V1)
 11773                                 TO WS-ROW-B-VAL (V1)
 11774              ELSE
 11775                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11776                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11777                    OR (V2 > 26)
 11778                 END-PERFORM
 11779                 IF V2 < 27
 11780                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11781                 ELSE
 11782                    MOVE 'N'     TO WS-GOOD-HIN
 11783                 END-IF
 11784              END-IF
 11785              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11786                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11787              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11788                 WS-ROW-D-VAL (V1)
 11789           END-PERFORM
 11790           MOVE ZEROS            TO WS-VIN-REMAINDER
 11791           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11792             REMAINDER WS-VIN-REMAINDER
 11793           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11794              CONTINUE
 11795           ELSE
 11796              MOVE 'N'           TO WS-GOOD-HIN
 11797           END-IF
 11798        ELSE
 11799           MOVE 'N'              TO WS-GOOD-HIN
 11800        END-IF
 11801        IF WS-GOOD-HIN NOT = 'Y'
 11802           MOVE ER-3826           TO WS-ERROR
 11803           PERFORM 9900-ERROR-FORMAT
 11804                                 THRU 9900-EXIT
 11805        END-IF
 11806     END-IF
 11807
 11808     IF (PB-COMPANY-ID = 'DCC')
 11809        AND (PB-ISSUE)
 11810        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11811        AND (AM-GPCD NOT = 06)
 11812        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11813          MOVE PB-I-VIN          TO WS-WORK-VIN
 11814          MOVE +8                TO V2
 11815          MOVE ZEROS             TO WS-VIN-TOTAL
 11816          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11817           (V1 > 17)
 11818             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11819                MOVE ER-3825     TO WS-ERROR
 11820                PERFORM 9900-ERROR-FORMAT
 11821                                 THRU 9900-EXIT
 11822             ELSE
 11823                IF V1 = 8
 11824                   MOVE 10       TO V2
 11825                END-IF
 11826                IF V1 = 9
 11827                   MOVE 0        TO V2
 11828                END-IF
 11829                IF V1 = 10
 11830                   MOVE 9        TO V2
 11831                END-IF
 11832                IF WS-WORK-VIN (V1:1) NUMERIC
 11833                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11834                    + (WS-WORK-VIN-N (V1) * V2)
 11835                ELSE
 11836                   MOVE WS-WORK-VIN (V1:1)
 11837                                 TO WS-HEX-BYTE
 11838                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11839                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11840                    + (WS-NUM (V3) * V2)
 11841                END-IF
 11842                COMPUTE V2 = V2 - 1
 11843             END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11844          END-PERFORM
 11845          MOVE ZEROS TO WS-VIN-REMAINDER
 11846          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11847             REMAINDER WS-VIN-REMAINDER
 11848          IF ((WS-WORK-VIN (9:1) = 'X')
 11849             AND (WS-VIN-REMAINDER = 10))
 11850                     OR
 11851             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11852             CONTINUE
 11853          ELSE
 11854             MOVE ER-3826        TO WS-ERROR
 11855             PERFORM 9900-ERROR-FORMAT
 11856                                 THRU 9900-EXIT
 11857          END-IF
 11858        ELSE
 11859          MOVE ER-3826           TO WS-ERROR
 11860          PERFORM 9900-ERROR-FORMAT
 11861                                 THRU 9900-EXIT
 11862        END-IF
 11863     END-IF
 11864
 11865
 11866
 11867******************************************************************ELC50PD
 11868******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11869******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11870******* METHODS.                                                  ELC50PD
 11871******************************************************************ELC50PD
 11872     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11873        IF PB-CANCELLATION                                        ELC50PD
 11874           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11875              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11876                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11877                IF FORM-MASTER-FOUND                              ELC50PD
 11878                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11879******************************************************************ELC50PD
 11880                                                                  ELC50PD
 11881     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11882     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11883                                                                  ELC50PD
 11884     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11885     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11886     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11887     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11888                                                                  ELC50PD
 11889                                                                  ELC50PD
 11890     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11891     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11892     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11893                                                                  ELC50PD
 11894     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11895         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11896                                                                  ELC50PD
 11897     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11898         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11899                                                                  ELC50PD
 11900     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11901         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11902                                                                  ELC50PD
 11903     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11904         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11905     ELSE                                                         ELC50PD
 11906         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11907                                                                  ELC50PD
 11908     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11909                                                                  ELC50PD
 11910     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11911         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11912                                                                  ELC50PD
 11913     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11914         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11915                                       WS-IG-OVRD                 ELC50PD
 11916     ELSE                                                         ELC50PD
 11917         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11918             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11919                                       WS-IG-OVRD                 ELC50PD
 11920         ELSE                                                     ELC50PD
 11921             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11922                                       WS-IG-OVRD.                ELC50PD
 11923                                                                  ELC50PD
 11924     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11925         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11926                                       WS-IG-OVRD                 ELC50PD
 11927     ELSE                                                         ELC50PD
 11928         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11929             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11930                                       WS-IG-OVRD                 ELC50PD
 11931         ELSE                                                     ELC50PD
 11932             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11933                                       WS-IG-OVRD.                ELC50PD
 11934                                                                  ELC50PD
 11935     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11936     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11937     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11938     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11939     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11940                                                                  ELC50PD
 11941     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11942     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11943     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11944     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11945                                                                  ELC50PD
 11946     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11947     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11948     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11949     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11950     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11951     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11952     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11953                                                                  ELC50PD
 11954     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11955        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11956     ELSE                                                         ELC50PD
 11957        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11958                                                                  ELC50PD
 11959     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11960        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11961     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11962        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11963                                                                  ELC50PD
 11964        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11965            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11966                                        WS-LF-REFUND-CALC.        ELC50PD
 11967                                                                  ELC50PD
 11968        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11969            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11970                                        WS-LF-REFUND-CALC.        ELC50PD
 11971                                                                  ELC50PD
 11972     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11973         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11974            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11975                                    WS-LF-REFUND-CALC.            ELC50PD
 11976     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11977         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11978            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11979                                    WS-LF-REFUND-CALC.            ELC50PD
 11980     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11981         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11982            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11983                                    WS-LF-REFUND-CALC.            ELC50PD
 11984     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11985         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11986            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11987                                    WS-LF-REFUND-CALC.            ELC50PD
 11988     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11989         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11990            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11991                                    WS-LF-REFUND-CALC.            ELC50PD
 11992     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11993         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11994            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11995                                    WS-LF-REFUND-CALC.            ELC50PD
 11996     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11997         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 11998            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11999                                    WS-LF-REFUND-CALC.            ELC50PD
 12000     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12001         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 12002            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12003                                    WS-LF-REFUND-CALC.            ELC50PD
 12004                                                                  ELC50PD
 12005     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 12006        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12007                                    WS-AH-REFUND-CALC.            ELC50PD
 12008     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 12009        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12010                                    WS-AH-REFUND-CALC.            ELC50PD
 12011     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 12012        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12013                                    WS-AH-REFUND-CALC.            ELC50PD
 12014     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 12015        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12016                                    WS-AH-REFUND-CALC.            ELC50PD
 12017     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12018        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12019                                    WS-AH-REFUND-CALC.            ELC50PD
 12020     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 12021        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12022                                    WS-AH-REFUND-CALC.            ELC50PD
 12023     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 12024        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12025                                    WS-AH-REFUND-CALC.            ELC50PD
 12026                                                                  ELC50PD
 12027     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 12028        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 12029                                    WS-TOL-AH-PREM.               ELC50PD
 12030                                                                  ELC50PD
 12031     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 12032                  AM-OVR-SHT-AMT > 0                              ELC50PD
 12033        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 12034                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 12035                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 12036                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 12037                                                                  ELC50PD
 12038     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 12039                    AM-OVR-SHT-PCT > 0                            ELC50PD
 12040        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 12041                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 12042                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 12043                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 12044                                                                  ELC50PD
 12045     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 12046                  AM-TOL-REF-PCT > 0                              ELC50PD
 12047        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 12048                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 12049                                                                  ELC50PD
 12050     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 12051                  AM-TOL-REF NUMERIC                              ELC50PD
 12052        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 12053                                    EC-AM-LF-TOL-REFUND           ELC50PD
 12054                                    WS-TOL-AH-REFUND              ELC50PD
 12055                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 12056                                                                  ELC50PD
 12057     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12058        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12059                                    WS-TOL-AH-CLAIM.              ELC50PD
 12060                                                                  ELC50PD
 12061     IF AM-CLP-TOL-PCT NOT NUMERIC
 12062        MOVE +0                  TO AM-CLP-TOL-PCT
 12063     END-IF
 12064
 12065     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12066        MOVE +0                  TO AM-SPP-LEASE-COMM
 12067     END-IF
 12068
 12069     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12070        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12071                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12072                                                                  ELC50PD
 12073     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12074        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12075                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12076                                                                  ELC50PD
 12077     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12078        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12079                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12080                                                                  ELC50PD
 12081     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12082        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12083                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12084                                                                  ELC50PD
 12085     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12086        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12087                                                                  ELC50PD
 12088     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12089        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12090                                                                  ELC50PD
 12091     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12092        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12093     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12094        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12095     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12096        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12097     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12098        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12099     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12100        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12101     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12102        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12103                                                                  ELC50PD
 12104     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12105        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12106                                                                  ELC50PD
 12107     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12108        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12109                                                                  ELC50PD
 12110     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12111     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12112                                                                  ELC50PD
 12113     IF PB-CANCELLATION                                           ELC50PD
 12114        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12115                                                                  ELC50PD
 12116     MOVE +1 TO SUB1.                                             ELC50PD
 12117     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12118     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12119                                                                  ELC50PD
 12120     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12121       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12122         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12123        ELSE                                                      ELC50PD
 12124         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12125                                                                  ELC50PD
 12126  0525-FIND-ACCT-COMM.                                            ELC50PD
 12127     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12128        NEXT SENTENCE                                             ELC50PD
 12129      ELSE                                                        ELC50PD
 12130         ADD +1 TO SUB1                                           ELC50PD
 12131         IF SUB1 LESS +11                                         ELC50PD
 12132            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12133          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12134             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12135                                                                  ELC50PD
 12136     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12137     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12138                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12139***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12140     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12141         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12142                                                                  ELC50PD
 12143     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12144     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12145                                                                  ELC50PD
 12146                                                                  ELC50PD
 12147 0530-GET-AH-COMP.                                                ELC50PD
 12148     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12149        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12150           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12151                                                                  ELC50PD
 12152     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12153        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12154         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12155         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12156         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12157         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12158     ELSE                                                         ELC50PD
 12159          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12160          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12161          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12162          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12163                                    WS-COMMISSION                 ELC50PD
 12164          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12165          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12166          IF WS-COMMISSION > ZEROS                                ELC50PD
 12167             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12168             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12169          END-IF                                                  ELC50PD
 12170          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12171          IF CTBL-TABLE-FOUND                                     ELC50PD
 12172             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12173                                        PB-I-AH-TERM              ELC50PD
 12174             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12175             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12176             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12177          ELSE                                                    ELC50PD
 12178             IF FIRST-TIME-THROUGH                                ELC50PD
 12179                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12180             ELSE                                                 ELC50PD
 12181                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12182                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12183                                                                  ELC50PD
 12184 0540-NEXT-READ-STEP.                                             ELC50PD
 12185     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12186     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12187                                                                  ELC50PD
 12188 0540-GET-LF-COMP.                                                ELC50PD
 12189     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12190        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12191           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12192                                                                  ELC50PD
 12193     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12194        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12195           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12196           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12197           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12198           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12199           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12200        ELSE                                                      ELC50PD
 12201           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12202           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12203           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12204           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12205                                        WS-COMMISSION             ELC50PD
 12206           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12207           IF WS-COMMISSION > ZEROS                               ELC50PD
 12208              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12209              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12210           END-IF                                                 ELC50PD
 12211           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12212           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12213           IF CTBL-TABLE-FOUND                                    ELC50PD
 12214              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12215              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12216              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12217              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12218           ELSE                                                   ELC50PD
 12219              IF FIRST-TIME-THROUGH                               ELC50PD
 12220                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12221              ELSE                                                ELC50PD
 12222                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12223                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12224                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12225                                                                  ELC50PD
 12226     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12227        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12228           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12229           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12230           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12231           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12232           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12233        ELSE                                                      ELC50PD
 12234           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12235           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12236           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12237           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12238                                        WS-COMMISSION             ELC50PD
 12239           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12240           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12241              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12242              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12243           END-IF                                                 ELC50PD
 12244           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12245           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12246           IF CTBL-TABLE-FOUND                                    ELC50PD
 12247              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12248              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12249              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12250              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12251           ELSE                                                   ELC50PD
 12252              IF FIRST-TIME-THROUGH                               ELC50PD
 12253                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12254              ELSE                                                ELC50PD
 12255                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12256                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12257                                                                  ELC50PD
 12258*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12259                                                                  ELC50PD
 12260 0560-EDIT-CONTINUE.                                              ELC50PD
 12261
 12262     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12263                                    WS-AH-PMF-COMM
 12264*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12265*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12266
 12267     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12268        (SUB1 > +10)
 12269        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12270           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12271           MOVE '0530'           TO CTBL-SW
 12272           MOVE ' '              TO WS-CTBL-READ-SW
 12273           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12274           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12275           MOVE '0540'           TO CTBL-SW
 12276           MOVE ' '              TO WS-CTBL-READ-SW
 12277           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12278        END-IF
 12279     END-PERFORM
 12280
 12281     GO TO 0564-EDIT-CONTINUE
 12282
 12283     .
 12284 0561-CHECK-AH.
 12285
 12286     IF (NO-AH-COVERAGE)
 12287        OR (NO-AH-BENEFIT-MATCH)
 12288        CONTINUE
 12289     ELSE
 12290        IF (AM-A-COM (SUB1) NUMERIC)
 12291           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12292           IF (AM-COM-TYP (SUB1) = 'A')
 12293              AND (WS-AH-PMF-COMM = ZEROS)
 12294              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12295           END-IF
 12296           CONTINUE
 12297        ELSE
 12298           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12299           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12300           MOVE PB-AH-OVERRIDE-L1
 12301                                 TO CTBL-BEN-TYPE
 12302           MOVE ZEROS            TO WS-SUB1
 12303                                    WS-COMMISSION
 12304           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12305           PERFORM 8300-READ-CTBL-TABLE
 12306                                 THRU 8300-EXIT
 12307           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12308              IF (AM-COM-TYP (SUB1) = 'A')
 12309                 AND (WS-AH-PMF-COMM = ZEROS)
 12310                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12311                                        PB-I-AH-TERM
 12312                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12313                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12314              END-IF
 12315              CONTINUE
 12316           ELSE
 12317              IF FIRST-TIME-THROUGH
 12318                 GO TO 0561-CHECK-AH
 12319              ELSE
 12320                 MOVE ER-2609    TO WS-ERROR
 12321                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12322              END-IF
 12323           END-IF
 12324        END-IF
 12325     END-IF
 12326
 12327     .
 12328 0561-EXIT.
 12329     EXIT.
 12330
 12331 0563-CHECK-LF.
 12332
 12333     IF (NO-LIFE-COVERAGE)
 12334        OR (NO-LF-BENEFIT-MATCH)
 12335        CONTINUE
 12336     ELSE
 12337        IF WS-LF-JOINT-INDICATOR = 'J'
 12338           IF AM-J-COM (SUB1) NUMERIC
 12339              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12340              IF (AM-COM-TYP (SUB1) = 'A')
 12341                 AND (WS-LF-PMF-COMM = ZEROS)
 12342                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12343              END-IF
 12344              CONTINUE
 12345           ELSE
 12346              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12347              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12348              MOVE PB-LIFE-OVERRIDE-L1
 12349                                 TO CTBL-BEN-TYPE
 12350              MOVE ZEROS         TO WS-SUB1
 12351                                    WS-COMMISSION
 12352              MOVE AM-J-COMA (SUB1)
 12353                                 TO CTBL-TABLE
 12354              PERFORM 8300-READ-CTBL-TABLE
 12355                                 THRU 8300-EXIT
 12356              IF CTBL-TABLE-FOUND
 12357                 IF (AM-COM-TYP (SUB1) = 'A')
 12358                    AND (WS-LF-PMF-COMM = ZEROS)
 12359                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12360                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12361                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12362                 END-IF
 12363                 CONTINUE
 12364              ELSE
 12365                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12366                    GO TO 0563-CHECK-LF
 12367                 ELSE
 12368                    MOVE ER-2609 TO WS-ERROR
 12369                    PERFORM 9900-ERROR-FORMAT
 12370                                 THRU 9900-EXIT
 12371*                   GO TO 0560-EDIT-CONTINUE
 12372                 END-IF
 12373              END-IF
 12374           END-IF
 12375        ELSE
 12376           IF AM-L-COM (SUB1) NUMERIC
 12377              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12378              IF (AM-COM-TYP (SUB1) = 'A')
 12379                 AND (WS-LF-PMF-COMM = ZEROS)
 12380                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12381              END-IF
 12382              CONTINUE
 12383           ELSE
 12384              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12385              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12386              MOVE PB-LIFE-OVERRIDE-L1
 12387                                 TO CTBL-BEN-TYPE
 12388              MOVE ZEROS         TO WS-SUB1
 12389                                    WS-COMMISSION
 12390              MOVE AM-L-COMA (SUB1)
 12391                                 TO CTBL-TABLE
 12392              PERFORM 8300-READ-CTBL-TABLE
 12393                                 THRU 8300-EXIT
 12394              IF CTBL-TABLE-FOUND
 12395                 CONTINUE
 12396              ELSE
 12397                 IF FIRST-TIME-THROUGH
 12398                    GO TO 0563-CHECK-LF
 12399                 ELSE
 12400                    MOVE ER-2609 TO WS-ERROR
 12401                    PERFORM 9900-ERROR-FORMAT
 12402                                 THRU 9900-EXIT
 12403                 END-IF
 12404              END-IF
 12405           END-IF
 12406        END-IF
 12407     END-IF
 12408
 12409     .
 12410 0563-EXIT.
 12411     EXIT.
 12412
 12413 0564-EDIT-CONTINUE.
 12414                                                                  ELC50PD
 12415     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12416         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12417            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12418            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12419                                                                  ELC50PD
 12420*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12421*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12422*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12423*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12424*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12425*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12426*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12427*         ELSE                                                    ELC50PD
 12428*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12429*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12430
 12431     IF PB-I-BIRTHDAY > LOW-VALUES
 12432        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12433        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12434        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12435        PERFORM 8500-DATE-CONVERT
 12436                                 THRU 8500-EXIT
 12437        IF NO-CONVERSION-ERROR
 12438           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12439           IF PB-I-AGE > ZEROS
 12440              IF WS-WORK-AGE NOT = PB-I-AGE
 12441                 MOVE ER-9501    TO WS-ERROR
 12442                 PERFORM 9900-ERROR-FORMAT
 12443                                 THRU 9900-EXIT
 12444              END-IF
 12445           ELSE
 12446              MOVE WS-WORK-AGE   TO PB-I-AGE
 12447           END-IF
 12448        END-IF
 12449     END-IF
 12450
 12451     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12452                                   WS-INS-AGE-SET
 12453     IF PB-I-AGE = ZEROS                                          ELC50PD
 12454        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12455           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12456                                   WS-INS-AGE-SET
 12457           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12458                                                                  ELC50PD
 12459     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12460                                   WS-AH-EDIT-AGE.                ELC50PD
 12461                                                                  ELC50PD
 12462     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12463        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12464        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12465        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12466        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12467        IF NO-CONVERSION-ERROR
 12468           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12469           IF PB-I-JOINT-AGE > 0
 12470              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12471                 MOVE ER-9503    TO WS-ERROR
 12472                 PERFORM 9900-ERROR-FORMAT
 12473                                 THRU 9900-EXIT
 12474              END-IF
 12475           ELSE
 12476              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12477           END-IF
 12478        ELSE
 12479           MOVE ZEROS            TO PB-I-JOINT-AGE
 12480        END-IF
 12481     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12482
 12483     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12484        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12485                                                                  ELC50PD
 12486     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12487                                   WS-JNT-AGE-SET
 12488     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12489        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12490           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12491           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12492               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12493                                          WS-JNT-AGE-SET
 12494               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12495           END-IF
 12496        END-IF
 12497     END-IF
 12498                                                                  ELC50PD
 12499     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12500     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12501        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12502        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12503            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12504                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12505                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12506            ELSE                                                  ELC50PD
 12507                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12508                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12509                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12510                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12511                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12512                                                                  ELC50PD
 12513     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12514        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12515            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12516                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12517                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12518            ELSE                                                  ELC50PD
 12519                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12520                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12521                                           WS-EDIT-AGE
 12522                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12523                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12524                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12525                                                                  ELC50PD
 12526******************************************************************ELC50PD
 12527*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12528******************************************************************ELC50PD
 12529                                                                  ELC50PD
 12530     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12531        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12532        NEXT SENTENCE                                             ELC50PD
 12533     ELSE                                                         ELC50PD
 12534        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12535          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12536           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12537            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12538           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12539            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12540            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12541                                                                  ELC50PD
 12542     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12543        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12544         NEXT SENTENCE                                            ELC50PD
 12545     ELSE                                                         ELC50PD
 12546         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12547            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12548             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12549                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12550                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12551                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12552                                                                  ELC50PD
 12553     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12554        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12555           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12556           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12557               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12558                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12559                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12560                                                                  ELC50PD
 12561     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12562        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12563           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12564            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12565                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12566                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12567                                                                  ELC50PD
 12568     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12569        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12570           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12571              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12572              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12573              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12574                                                                  ELC50PD
 12575     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12576        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12577           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12578              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12579              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12580              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12581                                                                  ELC50PD
 12582     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12583         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12584            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12585              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12586              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12587
 12588     IF (WS-LF-JOINT-INDICATOR = 'J')
 12589        AND (WS-AH-JOINT-INDICATOR = 'J')
 12590        AND (PB-I-LF-TERM > 120)
 12591        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12592        MOVE ER-2783             TO WS-ERROR
 12593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12594     END-IF
 12595
 12596     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12597                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12598     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12599        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12601        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12602                                                                  ELC50PD
 12603     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12604        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12606        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12607                                                                  ELC50PD
 12608     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12609        NEXT SENTENCE                                             ELC50PD
 12610     ELSE                                                         ELC50PD
 12611        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12612                                                                  ELC50PD
 12613     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12614        IF WS-ERROR = ER-2666                                     ELC50PD
 12615           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12616           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12617
 12618     IF PB-COMPANY-ID = 'CID'
 12619        IF PB-STATE = 'UT' OR 'MO'
 12620           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12621                 OR '76' OR '77')
 12622                      OR
 12623               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12624                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12625                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12626                   OR '2K' OR '2L'))
 12627              AND PB-I-INDV-GRP-CD = 'I'
 12628              MOVE ER-2721             TO WS-ERROR
 12629              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12630           END-IF
 12631        END-IF
 12632     END-IF
 12633                                                                  ELC50PD
 12634     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12635     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12636        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12637     ELSE
 12638        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12639     END-IF
 12640
 12641*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12642*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12643     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12644                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12645                                                                  ELC50PD
 12646     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12647        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12648        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12649        PB-POLICY-IS-VOIDED                                       ELC50PD
 12650*       OR PB-MONTHLY-CERT
 12651         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12652                                                                  ELC50PD
 12653     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12654        IF WS-EDIT-AGE           > +65
 12655           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12656           PERFORM 9900-ERROR-FORMAT
 12657                                 THRU 9900-EXIT
 12658        ELSE
 12659           IF WS-EDIT-AGE        > +55
 12660              MOVE ER-2718       TO WS-ERROR
 12661              PERFORM 9900-ERROR-FORMAT
 12662                                 THRU 9900-EXIT
 12663           END-IF
 12664        END-IF
 12665
 12666     IF PB-COMPANY-ID = 'DCC'
 12667        IF WS-EDIT-AGE           > +65
 12668           MOVE ER-2709          TO WS-ERROR
 12669           PERFORM 9900-ERROR-FORMAT
 12670                                 THRU 9900-EXIT
 12671        END-IF
 12672     END-IF
 12673     .
 12674
 12675 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12676                                                                  ELC50PD
 12677     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12678        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12679                                    EC-AM-LF-MAX-TOT-BEN
 12680        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12681                                                                  ELC50PD
 12682     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12683                                                                  ELC50PD
 12684     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12685         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12686             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12687                                                                  ELC50PD
 12688     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12689        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12690        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12691        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12692                                                                  ELC50PD
 12693     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12694     MOVE +1                     TO SUB2.                         ELC50PD
 12695                                                                  ELC50PD
 12696     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12697        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12698           MOVE +5   TO SUB2                                      ELC50PD
 12699           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12700              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12701              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12702              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12703              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12704                                                                  ELC50PD
 12705     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12706                                                                  ELC50PD
 12707     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12708                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12709                                                                  ELC50PD
 12710 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12711                                                                  ELC50PD
 12712
 12713     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12714        PL-ATT-AGE > +0
 12715        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12716     END-IF
 12717
 12718
 12719
 12720*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12721*       PL-ATT-AGE > +0
 12722*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12723*       IF PB-I-BIRTHDAY > LOW-VALUES
 12724*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12725*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12726*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12727*          SET BIN-PLUS-ELAPSED  TO TRUE
 12728*          PERFORM 8500-DATE-CONVERT
 12729*                                THRU 8500-EXIT
 12730*          IF NO-CONVERSION-ERROR
 12731*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12732*             MOVE ER-2669       TO WS-ERROR
 12733*             PERFORM 9900-ERROR-FORMAT
 12734*                                THRU 9900-EXIT
 12735*          END-IF
 12736*       ELSE
 12737*          IF WS-ATT-AGE >= PL-ATT-AGE
 12738*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12739*             PERFORM 9900-ERROR-FORMAT
 12740*                                THRU 9900-EXIT
 12741*          END-IF
 12742*       END-IF
 12743*    END-IF
 12744
 12745     .
 12746 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12747                                                                  ELC50PD
 12748     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12749        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12750           IF SUB2 GREATER THAN +4                                ELC50PD
 12751              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12752              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12753              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12754                                                                  ELC50PD
 12755     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12756        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12757            SUB2 GREATER THAN +8                                  ELC50PD
 12758             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12759             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12760             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12761             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12762                                                                  ELC50PD
 12763     IF SUB2 > +8
 12764        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12765           AND (PB-I-SIG-SW = 'Y')
 12766           CONTINUE
 12767        ELSE
 12768           MOVE ER-2637          TO WS-ERROR
 12769           PERFORM 9900-ERROR-FORMAT
 12770                                 THRU 9900-EXIT
 12771        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12772        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12773     END-IF
 12774
 12775     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12776     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12777     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12778                                                                  ELC50PD
 12779     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12780        ADD +1  TO SUB2                                           ELC50PD
 12781        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12782                                                                  ELC50PD
 12783     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12784         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12785                                                                  ELC50PD
 12786     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12787        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12788        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12789           AND (PB-I-SIG-SW = 'Y')
 12790           CONTINUE
 12791        ELSE
 12792           MOVE ER-2637          TO WS-ERROR
 12793           PERFORM 9900-ERROR-FORMAT
 12794                                 THRU 9900-EXIT
 12795        END-IF
 12796     END-IF
 12797
 12798     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12799                                                                  ELC50PD
 12800                                                                  ELC50PD
 12801 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12802                                                                  ELC50PD
 12803     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12804        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12805         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12806                                                                  ELC50PD
 12807     IF APP-CERT-USED                                             ELC50PD
 12808         IF SUB2  LESS THAN  +5                                   ELC50PD
 12809             MOVE +5          TO SUB2                             ELC50PD
 12810             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12811                                                                  ELC50PD
 12812     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12813     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12814                                                                  ELC50PD
 12815     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12816                                                                  ELC50PD
 12817 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12818                                                                  ELC50PD
 12819     IF NOT APP-CERT-USED                                         ELC50PD
 12820         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12821                                                                  ELC50PD
 12822     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12823        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12824        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12825        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12826         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12827                                                                  ELC50PD
 12828     IF SUB2 GREATER THAN +4                                      ELC50PD
 12829         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12830            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12831            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12832            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12833             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12834             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12835             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12836         ELSE                                                     ELC50PD
 12837             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12838                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12839                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12840                                                                  ELC50PD
 12841     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12842       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12843          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12844           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12845           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12846           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12847                                                                  ELC50PD
 12848                                                                  ELC50PD
 12849 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12850                                                                  ELC50PD
 12851     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12852        IF PB-I-AH-BENEFIT-AMT > +1250
 12853           MOVE ER-2702          TO WS-ERROR
 12854           PERFORM 9900-ERROR-FORMAT
 12855                                 THRU 9900-EXIT
 12856        END-IF
 12857     END-IF
 12858
 12859     IF (PB-COMPANY-ID = 'DCC')
 12860        AND (PB-MONTHLY-CERT)
 12861        IF PB-I-AH-BENEFIT-AMT > +3000
 12862           MOVE ER-2881          TO WS-ERROR
 12863           PERFORM 9900-ERROR-FORMAT
 12864                                 THRU 9900-EXIT
 12865        END-IF
 12866     END-IF
 12867
 12868     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12869        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12870        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12871                                                                  ELC50PD
 12872     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12873                                                                  ELC50PD
 12874     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12875         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12876             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12877                                                                  ELC50PD
 12878     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12879        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12880        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12881        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12882                                                                  ELC50PD
 12883     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12884     MOVE +1                     TO SUB2.                         ELC50PD
 12885                                                                  ELC50PD
 12886     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12887        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12888           MOVE +5 TO SUB2                                        ELC50PD
 12889           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12890              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12891              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12892              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12893              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12894              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12895                                                                  ELC50PD
 12896     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12897                                                                  ELC50PD
 12898 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12899                                                                  ELC50PD
 12900     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12901        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12902        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12903     END-IF
 12904*       IF WS-ATT-AGE >= PL-ATT-AGE
 12905*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12906*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12907     .
 12908 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12909                                                                  ELC50PD
 12910     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12911        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12912           IF SUB2 GREATER THAN +4                                ELC50PD
 12913              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12914              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12915              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12916                                                                  ELC50PD
 12917     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12918        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12919            SUB2 GREATER THAN +8                                  ELC50PD
 12920             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12921             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12923             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12924                                                                  ELC50PD
 12925     IF SUB2 > +8
 12926        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12927           AND (PB-I-SIG-SW = 'Y')
 12928           CONTINUE
 12929        ELSE
 12930           MOVE ER-2638          TO WS-ERROR
 12931           PERFORM 9900-ERROR-FORMAT
 12932                                 THRU 9900-EXIT
 12933        END-IF
 12934        GO TO 3000-CONTINUE-EDIT
 12935     END-IF
 12936                                                                  ELC50PD
 12937     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12938        IF WS-ERROR = ER-2638                                     ELC50PD
 12939           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12940                                                                  ELC50PD
 12941     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12942     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12943     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12944     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12945                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12946     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12947        ADD +1                   TO SUB2                          ELC50PD
 12948        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12949                                                                  ELC50PD
 12950     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12951         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12952                                                                  ELC50PD
 12953     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12954        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12955        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12956                                 > PL-LM-AMT (SUB2))
 12957        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12958           AND (PB-I-SIG-SW = 'Y')
 12959           CONTINUE
 12960        ELSE
 12961           MOVE ER-2638          TO WS-ERROR
 12962           PERFORM 9900-ERROR-FORMAT
 12963                                 THRU 9900-EXIT
 12964        END-IF
 12965     END-IF
 12966                                                                  ELC50PD
 12967     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12968         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12969             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12970                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12971                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12972                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12973                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12974                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12975                                                                  ELC50PD
 12976     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12977        IF WS-ERROR = ER-2638                                     ELC50PD
 12978            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12979            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12980            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12981                                                                  ELC50PD
 12982     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12983                                                                  ELC50PD
 12984 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12985                                                                  ELC50PD
 12986     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12987        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12988        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12989                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12990         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12991                                                                  ELC50PD
 12992     IF APP-CERT-USED                                             ELC50PD
 12993         IF SUB2  LESS THAN  +5                                   ELC50PD
 12994             MOVE +5             TO SUB2                          ELC50PD
 12995             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 12996                                                                  ELC50PD
 12997     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 12998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12999                                                                  ELC50PD
 13000     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 13001                                                                  ELC50PD
 13002 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 13003                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13004     IF NOT APP-CERT-USED                                         ELC50PD
 13005         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13006                                                                  ELC50PD
 13007     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 13008        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 13009        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 13010        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 13011         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13012                                                                  ELC50PD
 13013     IF SUB2 GREATER THAN +4                                      ELC50PD
 13014         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 13015            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 13016            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 13017            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 13018             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 13019             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13020             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 13021         ELSE                                                     ELC50PD
 13022             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 13023                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 13024                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 13025                                                                  ELC50PD
 13026     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 13027       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 13028          NOT PB-I-POLICY-DECLINED                                ELC50PD
 13029           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 13030           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 13031           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 13032                                                                  ELC50PD
 13033******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13035                                                                  ELC50PD
 13036 3000-CONTINUE-EDIT.                                              ELC50PD
 13037                                                                  ELC50PD
 13038     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 13039     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 13040     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 13041     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 13042     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 13043                                                                  ELC50PD
 13044     IF BROWSE-STARTED                                            ELC50PD
 13045        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 13046        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 13047                                                                  ELC50PD
 13048     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 13049        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 13050        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 13051        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 13052*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 13053        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13054        IF DATE-CONVERSION-ERROR                                  ELC50PD
 13055           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 13056           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13057        ELSE                                                      ELC50PD
 13058           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13059              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13060              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13061           ELSE                                                   ELC50PD
 13062              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13063              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13064                                                                  ELC50PD
 13065     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13066     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13067     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13068*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13069     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13070     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13071        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13072     ELSE                                                         ELC50PD
 13073        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13074           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13076        ELSE                                                      ELC50PD
 13077           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13078              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13079              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13080           ELSE                                                   ELC50PD
 13081             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13082                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13083                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13084                                                                  ELC50PD
 13085 3005-EDIT-CONTINUE.                                              ELC50PD
 13086                                                                  ELC50PD
 13087     IF PB-CANCELLATION                                           ELC50PD
 13088         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13089                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13091******************************************************************ELC50PD
 13092*                  E D I T   I S S U E                           *ELC50PD
 13093******************************************************************ELC50PD
 13094                                                                  ELC50PD
 13095 3020-EDIT-ISSUE.                                                 ELC50PD
 13096                                                                  ELC50PD
 13097      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13098      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13099      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13100      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13101      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13102                                                                  ELC50PD
 13103     IF PB-ISSUE-FORCE
 13104        OR PB-ISSUE-DATE-FORCED
 13105        OR PB-FORCE-OFF
 13106        OR PB-OVERCHARGE-FORCE
 13107        CONTINUE
 13108     ELSE
 13109        MOVE ER-2670             TO WS-ERROR
 13110        PERFORM 9900-ERROR-FORMAT
 13111                                 THRU 9900-EXIT
 13112     END-IF
 13113
 13114     .
 13115 3022-SET-POLICY-STATUS.                                          ELC50PD
 13116                                                                  ELC50PD
 13117     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13118                                                                  ELC50PD
 13119     IF (PB-REISSUED-CERT)
 13120             OR
 13121        ((PB-COMPANY-ID NOT = 'DCC')
 13122         AND (PB-MONTHLY-CERT))
 13123         MOVE '5'                TO PB-I-ENTRY-STATUS
 13124         MOVE 'E'                TO PB-BATCH-ENTRY
 13125     END-IF
 13126
 13127     IF PB-COMPANY-ID = 'DCC'
 13128        IF PB-MONTHLY-CERT
 13129           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13130        END-IF
 13131     END-IF
 13132     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13133         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13134     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13135         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13136     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13137         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13138     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13139         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13140     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13141         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13142                                                                  ELC50PD
 13143     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13144                                                                  ELC50PD
 13145     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13146         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13147         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13148         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13149                                                                  ELC50PD
 13150     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13151        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13152           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13153                                                                  ELC50PD
 13154     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13155        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13156           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13157                                                                  ELC50PD
 13158     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13159         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13160         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13161         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13162         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13163         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13164         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13165         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13166     END-IF
 13167                                                                  ELC50PD
 13168     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13169        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13170         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13171                                                                  ELC50PD
 13172     IF (ACCOUNT-MAST-FOUND)
 13173        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13174        IF PB-REISSUED-CERT
 13175           CONTINUE
 13176        ELSE
 13177           MOVE ER-2608          TO WS-ERROR
 13178           PERFORM 9900-ERROR-FORMAT
 13179                                 THRU 9900-EXIT
 13180         END-IF
 13181     END-IF
 13182                                                                  ELC50PD
 13183     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13184        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13185        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13186                                                                  ELC50PD
 13187**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13188 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13189     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13190        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13191                                                                  ELC50PD
 13192*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13193*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13194*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13195                                                                  ELC50PD
 13196     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13197     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13198     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13199     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13200**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13201                                                                  ELC50PD
 13202     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13203     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13204     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13205     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13206**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13207                                                                  ELC50PD
 13208     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13209        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13211                                                                  ELC50PD
 13212     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13213                                                                  ELC50PD
 13214     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13215                                      WK-FULL-CERT-NO.            ELC50PD
 13216     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13217                                                                  ELC50PD
 13218     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13219                                                                  ELC50PD
 13220     IF PB-VALID-LIFE                                             ELC50PD
 13221        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13222     ELSE                                                         ELC50PD
 13223        IF PB-VALID-AH                                            ELC50PD
 13224          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13225                                                                  ELC50PD
 13226                                                                  ELC50PD
 13227     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13228     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13229     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13230                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13231                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13232                                      DCUA-RETURN-CODE.           ELC50PD
 13233                                                                  ELC50PD
 13234****************************************************************  ELC50PD
 13235*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13236***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13237***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13238***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13239***   TO THIS RECORD.                                        ***  ELC50PD
 13240****************************************************************  ELC50PD
 13241     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13242     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13243     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13244        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13245                                                                  ELC50PD
 13246     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13247        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13248        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13250        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13251                                                                  ELC50PD
 13252     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13253        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13254        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13256        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13257                                                                  ELC50PD
 13258     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13259        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13260        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13262        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13263                                                                  ELC50PD
 13264     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13265        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13266        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13268        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13269                                                                  ELC50PD
 13270     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13271        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13272        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13274        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13275                                                                  ELC50PD
 13276     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13277        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13278        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13280        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13281                                                                  ELC50PD
 13282     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13283        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13284        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13286        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13287                                                                  ELC50PD
 13288     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13289        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13290        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13292        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13293                                                                  ELC50PD
 13294     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13295        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13296        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13298        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13299                                                                  ELC50PD
 13300     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13301        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13302        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13304        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13305                                                                  ELC50PD
 13306     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13307        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13308        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13310        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13311                                                                  ELC50PD
 13312     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13313        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13314        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13316        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13317                                                                  ELC50PD
 13318     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13319        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13320        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13322        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13323                                                                  ELC50PD
 13324     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13325        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13326        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13328        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13329                                                                  ELC50PD
 13330     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13331        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13332        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13334        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13335                                                                  ELC50PD
 13336     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13337     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13338     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13339     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13340                                                                  ELC50PD
 13341 3024-EDIT-DL7-CONT.                                              ELC50PD
 13342                                                                  ELC50PD
 13343     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13344     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13345     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13346        NEXT SENTENCE                                             ELC50PD
 13347     ELSE                                                         ELC50PD
 13348        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13349        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13350                                                                  ELC50PD
 13351******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13352******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13353     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13354        NEXT SENTENCE                                             ELC50PD
 13355     ELSE                                                         ELC50PD
 13356        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13358                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13360****************************************************************  ELC50PD
 13361*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13362****************************************************************  ELC50PD
 13363     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13364     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13365                                                                  ELC50PD
 13366     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13367     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13368        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13369                                                                  ELC50PD
 13370     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13371        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13373        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13374                                                                  ELC50PD
 13375     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13376        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13378        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13379                                                                  ELC50PD
 13380     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13381        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13383        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13384                                                                  ELC50PD
 13385     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13386        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13388        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13389                                                                  ELC50PD
 13390     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13392                                                                  ELC50PD
 13393 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13395****************************************************************  ELC50PD
 13396*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13397****************************************************************  ELC50PD
 13398                                                                  ELC50PD
 13399     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13400     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13401     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13402     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13403        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13404                                                                  ELC50PD
 13405     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13406        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13408        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13409                                                                  ELC50PD
 13410     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13411        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13413        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13414                                                                  ELC50PD
 13415     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13416        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13418        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13419                                                                  ELC50PD
 13420     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13421        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13423        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13424                                                                  ELC50PD
 13425     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13426        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13428        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13429                                                                  ELC50PD
 13430     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13431     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13432     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13433                                                                  ELC50PD
 13434 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13436                                                                  ELC50PD
 13437****************************************************************  ELC50PD
 13438*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13439****************************************************************  ELC50PD
 13440                                                                  ELC50PD
 13441     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13442     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13443     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13444     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13445     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13446        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13447                                                                  ELC50PD
 13448     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13449        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13451        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13452                                                                  ELC50PD
 13453     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13454        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13456        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13457                                                                  ELC50PD
 13458     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13459        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13461        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13462                                                                  ELC50PD
 13463     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13464     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13465     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13466                                                                  ELC50PD
 13467 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13469                                                                  ELC50PD
 13470****************************************************************  ELC50PD
 13471*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13472****************************************************************  ELC50PD
 13473                                                                  ELC50PD
 13474     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13475     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13476     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13477        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13479                                                                  ELC50PD
 13480     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13481     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13482     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13483     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13484     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13485     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13486        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13487                                                                  ELC50PD
 13488     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13489        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13491        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13492                                                                  ELC50PD
 13493     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13494        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13496        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13497                                                                  ELC50PD
 13498     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13499        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13501        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13502                                                                  ELC50PD
 13503     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13504        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13506        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13507                                                                  ELC50PD
 13508     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13509        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13511        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13512                                                                  ELC50PD
 13513     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13514        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13516        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13517                                                                  ELC50PD
 13518     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13519     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13520     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13521                                                                  ELC50PD
 13522 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13524                                                                  ELC50PD
 13525     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13526        NEXT SENTENCE                                             ELC50PD
 13527     ELSE                                                         ELC50PD
 13528        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13530                                                                  ELC50PD
 13531     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13532     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13533     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13534                                                                  ELC50PD
 13535     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13536        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13538        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13539                                                                  ELC50PD
 13540     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13541        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13543        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13544                                                                  ELC50PD
 13545     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13546        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13548        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13549                                                                  ELC50PD
 13550     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13551        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13553        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13554                                                                  ELC50PD
 13555     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13556        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13558        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13559                                                                  ELC50PD
 13560     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13561        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13563                                                                  ELC50PD
 13564 3024-EDIT-DL01-CONT.                                             ELC50PD
 13565******************************************************************ELC50PD
 13566***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13567******************************************************************ELC50PD
 13568                                                                  ELC50PD
 13569      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13570      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13571      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13572      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13573        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13574        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13575                                                                  ELC50PD
 13576      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13577                                                                  ELC50PD
 13578      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13579         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13581         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13582                                                                  ELC50PD
 13583      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13584         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13586         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13587                                                                  ELC50PD
 13588      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13589         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13591         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13592                                                                  ELC50PD
 13593       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13594       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13595       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13596                                                                  ELC50PD
 13597******************************************************************ELC50PD
 13598***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13599******************************************************************ELC50PD
 13600                                                                  ELC50PD
 13601 3024-CHECK-VALID-RATE.                                           ELC50PD
 13602                                                                  ELC50PD
 13603     IF VALID-RATE-CODE                                           ELC50PD
 13604        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13605        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13606        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13607        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13608     ELSE                                                         ELC50PD
 13609         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13610                                                                  ELC50PD
 13611      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13612         IF PB-VALID-LIFE                                         ELC50PD
 13613             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13614             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13615         ELSE                                                     ELC50PD
 13616             IF PB-VALID-AH                                       ELC50PD
 13617                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13618                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13619                                                                  ELC50PD
 13620      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13621         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13623         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13624                                                                  ELC50PD
 13625      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13626         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13628         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13629                                                                  ELC50PD
 13630      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13631         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13632         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13633         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13634                                                                  ELC50PD
 13635      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13636         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13637            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13638            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13639            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13640          ELSE                                                    ELC50PD
 13641         IF PB-VALID-LIFE                                         ELC50PD
 13642            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13643          ELSE                                                    ELC50PD
 13644            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13645         END-IF                                                   ELC50PD
 13646         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13647         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13648         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13649         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13650             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13651             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13652           ELSE                                                   ELC50PD
 13653             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13654             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13655             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13656                                                                  ELC50PD
 13657       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13658       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13659       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13660                                                                  ELC50PD
 13661**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13662                                                                  ELC50PD
 13663 3025-EDIT-REINSURANCE.                                           ELC50PD
 13664     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13665         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13666                                                                  ELC50PD
 13667     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13668     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13669     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13670                                      REIN-CODE-2                 ELC50PD
 13671                                      REIN-CODE-3.                ELC50PD
 13672     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13673                                                                  ELC50PD
 13674     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13675                                                                  ELC50PD
 13676     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13677     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13678                                                                  ELC50PD
 13679     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13680     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13681         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13682                                                                  ELC50PD
 13683     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13684     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13685                                   WS-NSP-ST-CD-LF.               ELC50PD
 13686     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13687                                   WS-NSP-ST-CD-AH.               ELC50PD
 13688                                                                  ELC50PD
 13689     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13690                                                                  ELC50PD
 13691 3026-NO-SPEC-TABLE.                                              ELC50PD
 13692                                                                  ELC50PD
 13693     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13694     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13695     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13696                                                                  ELC50PD
 13697 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13698                                                                  ELC50PD
 13699     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13700       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13701                                                                  ELC50PD
 13702     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13703          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13704          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13705           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13706                                                                  ELC50PD
 13707     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13708     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13709     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13710     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13711                                                                  ELC50PD
 13712     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13713     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13714                                                                  ELC50PD
 13715     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13716     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13717         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13718                                                                  ELC50PD
 13719     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13720     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13721                                   WS-NSP-ST-CD-LF.               ELC50PD
 13722     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13723                                   WS-NSP-ST-CD-AH.               ELC50PD
 13724                                                                  ELC50PD
 13725     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13726                                                                  ELC50PD
 13727 3028-NO-REIN-TABLE.                                              ELC50PD
 13728                                                                  ELC50PD
 13729     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13730     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13731     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13732                                                                  ELC50PD
 13733 3040-EDIT-CONTINUE.                                              ELC50PD
 13734                                                                  ELC50PD
 13735     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13736         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13737                                                                  ELC50PD
 13738     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13739         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13740                                                                  ELC50PD
 13741     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13742        AND (NOT PB-MONTHLY-CERT)
 13743        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13744            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13745            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13746                                                                  ELC50PD
 13747     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13748        AND (NOT PB-MONTHLY-CERT)
 13749        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13750            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13751            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13752                                                                  ELC50PD
 13753 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13754
 13755     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13756     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13757         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13758                                                                  ELC50PD
 13759******************************************************************ELC50PD
 13760*                                                                *ELC50PD
 13761*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13762*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13763*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13764*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13765*                                                                *ELC50PD
 13766******************************************************************ELC50PD
 13767                                                                  ELC50PD
 13768     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13769        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13770                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13771                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13772        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13773        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13774        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13775        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13776        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13777*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13778        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13779        IF NO-CONVERSION-ERROR                                    ELC50PD
 13780           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13781                                                                  ELC50PD
 13782******************************************************************ELC50PD
 13783*                                                                *ELC50PD
 13784*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13785*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13786*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13787*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13788*                                                                *ELC50PD
 13789******************************************************************ELC50PD
 13790                                                                  ELC50PD
 13791     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13792          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13793                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13794                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13795          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13796          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13797          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13798          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13799          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13800*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13801          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13802          IF NO-CONVERSION-ERROR                                  ELC50PD
 13803             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13804                                                                  ELC50PD
 13805******************************************************************ELC50PD
 13806*                                                                *ELC50PD
 13807*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13808*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13809*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13810*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13811*                                                                *ELC50PD
 13812******************************************************************ELC50PD
 13813                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13814     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13815        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13816           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13817              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13818              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13819           ELSE                                                   ELC50PD
 13820              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13821              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13822        ELSE                                                      ELC50PD
 13823           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13824              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13825              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13826           ELSE                                                   ELC50PD
 13827              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13828              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13829                                                                  ELC50PD
 13830     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13831        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13832        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13833        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13834        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13835                                    DC-ODD-DAYS-OVER              ELC50PD
 13836          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13837          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13838*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13839          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13840          IF NO-CONVERSION-ERROR                                  ELC50PD
 13841             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13842                                                                  ELC50PD
 13843******************************************************************ELC50PD
 13844*                                                                *ELC50PD
 13845*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13846*                                                                *ELC50PD
 13847******************************************************************ELC50PD
 13848                                                                  ELC50PD
 13849     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13850        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13851                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13852        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13853                                                                  ELC50PD
 13854     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13855         NEXT SENTENCE                                            ELC50PD
 13856     ELSE                                                         ELC50PD
 13857         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13859         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13860                                                                  ELC50PD
 13861     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13862     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13863     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13864*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13865     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13866                                    DC-ELAPSED-DAYS               ELC50PD
 13867                                    DC-ODD-DAYS-OVER.             ELC50PD
 13868                                                                  ELC50PD
 13869     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13870                                                                  ELC50PD
 13871     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13872        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13873                                                                  ELC50PD
 13874     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13875
 13876     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13877        AND (WS-LF-COVERAGE-TYPE = 'L')
 13878        IF (DC-ELAPSED-MONTHS > 1)
 13879                      OR
 13880           ((DC-ELAPSED-MONTHS = 1)
 13881           AND (DC-ODD-DAYS-OVER > 0))
 13882           MOVE ER-2882          TO WS-ERROR
 13883           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13884        END-IF
 13885     END-IF
 13886
 13887     if dc-elapsed-months > 0
 13888        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13889        + dc-odd-days-over
 13890     end-if
 13891
 13892     IF PB-EXT-DAYS-PROCESSING
 13893        CONTINUE
 13894     ELSE
 13895        IF DC-ELAPSED-MONTHS = +0
 13896           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13897        ELSE
 13898           IF (WS-LF-EARNINGS-CALC = '4')
 13899              AND (DC-ELAPSED-MONTHS > ZERO)
 13900              AND (DC-ELAPSED-DAYS > ZERO)
 13901              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13902           ELSE
 13903              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13904                                 THRU 6499-EXIT
 13905              MOVE WS-ODD-DAYS-OVER
 13906                                 TO PB-I-EXTENTION-DAYS
 13907           END-IF
 13908        END-IF
 13909     END-IF
 13910
 13911******************************************************************ELC50PD
 13912*                                                                *ELC50PD
 13913*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13914*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13915*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13916*            AND ANY ODD DAYS.                                   *ELC50PD
 13917*                                                                *ELC50PD
 13918******************************************************************ELC50PD
 13919                                                                  ELC50PD
 13920     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13921                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13922     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13923        IF DC-ELAPSED-DAYS > ZEROS
 13924           MOVE ER-2681          TO WS-ERROR
 13925           PERFORM 9900-ERROR-FORMAT
 13926                                 THRU 9900-EXIT
 13927        END-IF
 13928     END-IF
 13929                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13930     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13931        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13932           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13933           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13934                                                                  ELC50PD
 13935     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13936        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13937         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13938          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13939          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13940          IF WS-LF-EARNINGS-CALC = '4'
 13941             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13942             PB-I-PAY-FREQUENCY
 13943          END-IF
 13944          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13945                                    DC-ODD-DAYS-OVER              ELC50PD
 13946          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13947          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13948*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13949          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13950          IF NO-CONVERSION-ERROR                                  ELC50PD
 13951             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13952             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13953                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13954                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13955                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13956                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13957                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13958*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13959                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13960                  IF NO-CONVERSION-ERROR                          ELC50PD
 13961                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13962                                                                  ELC50PD
 13963* okay, i had to move the new att age edit down here because the
 13964* expiration date could get recalculated and i need the exp date
 13965
 13966
 13967     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13968        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13969        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13970        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13971           AND ZEROS
 13972           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13973           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13974           SET ELAPSED-BETWEEN-BIN TO TRUE
 13975           PERFORM 8500-DATE-CONVERT
 13976                                 THRU 8500-EXIT
 13977           IF NO-CONVERSION-ERROR
 13978              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13979                 MOVE ER-2669       TO WS-ERROR
 13980*                PERFORM 9900-ERROR-FORMAT
 13981*                                THRU 9900-EXIT
 13982              END-IF
 13983           END-IF
 13984        ELSE
 13985           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13986           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13987              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13988*             PERFORM 9900-ERROR-FORMAT
 13989*                                THRU 9900-EXIT
 13990           ELSE
 13991              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13992                 MOVE ER-1570    TO WS-ERROR
 13993                 PERFORM 9900-ERROR-FORMAT
 13994                                 THRU 9900-EXIT
 13995              END-IF
 13996           END-IF
 13997        END-IF
 13998
 13999        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14000           AND ZEROS
 14001           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14002           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14003           SET ELAPSED-BETWEEN-BIN TO TRUE
 14004           PERFORM 8500-DATE-CONVERT
 14005                                 THRU 8500-EXIT
 14006           IF NO-CONVERSION-ERROR
 14007              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 14008                 MOVE ER-2669       TO WS-ERROR
 14009*                PERFORM 9900-ERROR-FORMAT
 14010*                                THRU 9900-EXIT
 14011              END-IF
 14012           END-IF
 14013        ELSE
 14014           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14015             (PB-I-LF-TERM / 12)
 14016           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14017              MOVE ER-2669       TO WS-ERROR
 14018*             PERFORM 9900-ERROR-FORMAT
 14019*                                THRU 9900-EXIT
 14020           ELSE
 14021              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14022                 MOVE ER-1571    TO WS-ERROR
 14023                 PERFORM 9900-ERROR-FORMAT
 14024                                 THRU 9900-EXIT
 14025              END-IF
 14026           END-IF
 14027        END-IF
 14028        IF WS-ERROR = ER-2669
 14029           PERFORM 9900-ERROR-FORMAT
 14030                                 THRU 9900-EXIT
 14031        END-IF
 14032
 14033     END-IF
 14034
 14035     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 14036        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 14037         NOT NO-AH-COVERAGE                                       ELC50PD
 14038          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 14039             AND (PB-COMPANY-ID = 'DCC')
 14040             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 14041             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 14042          ELSE
 14043             IF WS-LF-EARNINGS-CALC = '4'
 14044                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 14045                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14046                PB-I-PAY-FREQUENCY
 14047             ELSE
 14048                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 14049                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 14050             END-IF
 14051          END-IF
 14052          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 14053                                         DC-ODD-DAYS-OVER         ELC50PD
 14054          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 14055          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 14056*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14057          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14058          IF NO-CONVERSION-ERROR                                  ELC50PD
 14059             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14060
 14061     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14062        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14063        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14064        IF PB-I-BIRTHDAY > LOW-VALUES
 14065           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14066           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14067           SET ELAPSED-BETWEEN-BIN TO TRUE
 14068           PERFORM 8500-DATE-CONVERT
 14069                                 THRU 8500-EXIT
 14070           IF NO-CONVERSION-ERROR
 14071              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14072                 MOVE ER-3054       TO WS-ERROR
 14073*                PERFORM 9900-ERROR-FORMAT
 14074*                                THRU 9900-EXIT
 14075              END-IF
 14076           END-IF
 14077        ELSE
 14078           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14079           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14080              MOVE ER-3054       TO WS-ERROR
 14081*             PERFORM 9900-ERROR-FORMAT
 14082*                                THRU 9900-EXIT
 14083           END-IF
 14084        END-IF
 14085
 14086        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14087           AND ZEROS
 14088           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14089           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14090           SET ELAPSED-BETWEEN-BIN TO TRUE
 14091           PERFORM 8500-DATE-CONVERT
 14092                                 THRU 8500-EXIT
 14093           IF NO-CONVERSION-ERROR
 14094              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14095                 MOVE ER-3054       TO WS-ERROR
 14096*                PERFORM 9900-ERROR-FORMAT
 14097*                                THRU 9900-EXIT
 14098              END-IF
 14099           END-IF
 14100        ELSE
 14101           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14102             (PB-I-AH-TERM / 12)
 14103           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14104              MOVE ER-3054       TO WS-ERROR
 14105*             PERFORM 9900-ERROR-FORMAT
 14106*                                THRU 9900-EXIT
 14107           END-IF
 14108        END-IF
 14109        IF WS-ERROR = ER-3054
 14110           PERFORM 9900-ERROR-FORMAT
 14111                                 THRU 9900-EXIT
 14112        END-IF
 14113
 14114     END-IF
 14115
 14116     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14117                                                                  ELC50PD
 14118     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14119        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14120                                                                     CL**6
 14121     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14122       AND                                                        ELC50PD
 14123        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14124        NEXT SENTENCE                                             ELC50PD
 14125     ELSE                                                            CL**6
 14126        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14127                                                                     CL**6
 14128     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14129        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14130        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14131     ELSE                                                         ELC50PD
 14132        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14133        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14134                                                                  ELC50PD
 14135     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14136*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14137     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14138     IF (NO-CONVERSION-ERROR)
 14139        AND (DC-ELAPSED-MONTHS > +1)
 14140        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14141        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14143                                                                  ELC50PD
 14144 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14145                                                                  ELC50PD
 14146     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14147        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14148         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14149     ELSE                                                         ELC50PD
 14150         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14151                                                                  ELC50PD
 14152     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14153         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14154     ELSE                                                         ELC50PD
 14155        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14156           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14157           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14158           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14159                                                                  ELC50PD
 14160     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14161        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14162        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14163         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14164                                                                  ELC50PD
 14165     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14166                                                                  ELC50PD
 14167 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14168                                                                  ELC50PD
 14169     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14170                                                                  ELC50PD
 14171     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14172         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14173     ELSE                                                         ELC50PD
 14174         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14175            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14176            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14177                                                                  ELC50PD
 14178     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14179                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14180     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14181         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14182                                                                  ELC50PD
 14183     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14184         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14186                                                                  ELC50PD
 14187                                                                  ELC50PD
 14188 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14189                                                                  ELC50PD
 14190******************************************************************ELC50PD
 14191*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14192******************************************************************ELC50PD
 14193                                                                  ELC50PD
 14194     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14195        NEXT SENTENCE                                             ELC50PD
 14196     ELSE                                                         ELC50PD
 14197        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14198           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14199              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14200              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14201              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14202                  NEXT SENTENCE                                   ELC50PD
 14203           ELSE                                                   ELC50PD
 14204              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14205              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14206                                                                  ELC50PD
 14207     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14208         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14209            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14210            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14211            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14212             NEXT SENTENCE                                        ELC50PD
 14213          ELSE                                                    ELC50PD
 14214              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14215              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14216                                                                  ELC50PD
 14217     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14218        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14219                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14220     IF POLICY-HAS-AH                                             ELC50PD
 14221       AND                                                        ELC50PD
 14222        POLICY-HAS-LIFE                                           ELC50PD
 14223       AND                                                        ELC50PD
 14224        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14225       AND                                                        ELC50PD
 14226        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14227        NEXT SENTENCE                                             ELC50PD
 14228     ELSE                                                         ELC50PD
 14229        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14230                                                                  ELC50PD
 14231     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14232     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14233        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14234                                                                  ELC50PD
 14235     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14236        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14238                                                                  ELC50PD
 14239 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14240                                                                  ELC50PD
 14241     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14242         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14243            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14244
 14245*    IF PB-COMPANY-ID NOT = 'DCC'
 14246*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14247*          AND 'V' AND 'W' AND 'X'
 14248*          GO TO 3125-EDIT-PMT-FREQ
 14249*       END-IF
 14250*    ELSE
 14251*       IF WS-AH-DCC-TRUNC = 'T'
 14252*          CONTINUE
 14253*       ELSE
 14254*          GO TO 3125-EDIT-PMT-FREQ
 14255*       END-IF
 14256*    END-IF
 14257
 14258
 14259
 14260     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14261                    OR
 14262        ((PB-COMPANY-ID = 'DCC')
 14263        AND (WS-AH-DCC-TRUNC = 'T'))
 14264        CONTINUE
 14265     ELSE
 14266        GO TO 3125-EDIT-PMT-FREQ
 14267     END-IF
 14268
 14269     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14270         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14271                                                                  ELC50PD
 14272     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14273        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14274*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14275        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14276         NEXT SENTENCE                                            ELC50PD
 14277     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14278         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14279         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14280                                                                  ELC50PD
 14281     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14282        MOVE ER-3058             TO WS-ERROR
 14283        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14284     end-if
 14285                                                                  ELC50PD
 14286     IF WS-STATE-ABBREVIATION = 'NC'
 14287        IF PB-I-LOAN-TERM > +59
 14288           CONTINUE
 14289        ELSE
 14290           MOVE ER-2792          TO WS-ERROR
 14291           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14292        END-IF
 14293     END-IF
 14294                                                                  ELC50PD
 14295     .
 14296 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14297
 14298     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14299         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14300            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14301
 14302     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14303                    OR
 14304        ((PB-COMPANY-ID = 'DCC')
 14305        AND (WS-AH-DCC-TRUNC = 'T'))
 14306                    OR
 14307         (PB-COMPANY-ID = 'AHL')
 14308        CONTINUE
 14309     ELSE
 14310        IF (PB-I-LOAN-TERM > ZEROS)
 14311           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14312           MOVE ER-1575          TO WS-ERROR
 14313           PERFORM 9900-ERROR-FORMAT
 14314                                 THRU 9900-EXIT
 14315        END-IF
 14316     END-IF
 14317
 14318     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14319         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14320            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14321            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14322            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14323         ELSE                                                     ELC50PD
 14324            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14325                                                                  ELC50PD
 14326     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14327         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14329         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14330                                                                  ELC50PD
 14331     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14332         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14333         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14334         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14335                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14336     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14337         GIVING WS-TEX-FACT-2                                     ELC50PD
 14338             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14339                                                                  ELC50PD
 14340*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14341*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14342*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14343                                                                  ELC50PD
 14344                                                                  ELC50PD
 14345 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14346                                                                  ELC50PD
 14347     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14348        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14349           MOVE ER-2690          TO WS-ERROR
 14350           PERFORM 9900-ERROR-FORMAT
 14351                                 THRU 9900-EXIT
 14352        ELSE
 14353           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14354           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14355           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14356           MOVE PB-SV-STATE      TO LOFC-STATE
 14357           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14358           MOVE PB-I-LOAN-OFFICER
 14359                                 TO LOFC-CODE
 14360           PERFORM 8586-READ-LOAN-OFFICER
 14361                                 THRU 8586-EXIT
 14362           IF (NOT LOFC-MASTER-FOUND)
 14363              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14364              MOVE ER-3006       TO WS-ERROR
 14365              PERFORM 9900-ERROR-FORMAT
 14366                                 THRU 9900-EXIT
 14367           END-IF
 14368        END-IF
 14369     END-IF
 14370
 14371     .
 14372 3129-EDIT-APR.                                                   ELC50PD
 14373                                                                  ELC50PD
 14374     IF (WS-LF-BENEFIT-CD = ZERO)
 14375        OR (NO-LF-BENEFIT-MATCH)
 14376        IF PB-COMPANY-ID NOT = 'DCC'
 14377           GO TO 3130-EDIT-AGE
 14378*       ELSE
 14379*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14380*             GO TO 3130-EDIT-AGE
 14381*          END-IF
 14382        END-IF
 14383     END-IF
 14384                                                                  ELC50PD
 14385     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14386         AND (PB-I-RATE-CLASS NOT = 'L ')
 14387         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14388         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14389         GO TO 3129-APR-CONT.                                     ELC50PD
 14390                                                                  ELC50PD
 14391     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14392         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14393         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14394         GO TO 3129-APR-CONT.                                     ELC50PD
 14395                                                                  ELC50PD
 14396     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14397         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14398         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14399         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14400         GO TO 3129-APR-CONT.                                     ELC50PD
 14401                                                                  ELC50PD
 14402     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14403        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14404           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14405              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14406              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14407              GO TO 3130-EDIT-AGE.                                ELC50PD
 14408                                                                  ELC50PD
 14409     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14410        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14411        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14412        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14413        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14414        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14415         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14416                                                                  ELC50PD
 14417 3129-APR-CONT.                                                   ELC50PD
 14418     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14419         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14420         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14421                                                                  ELC50PD
 14422     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14423         WS-AH-BENEFIT-CD (1:1) = 'S')
 14424        AND (PB-COMPANY-ID = 'DCC')
 14425        AND (PB-I-LOAN-APR = ZERO)
 14426        MOVE ER-2657             TO WS-ERROR
 14427        PERFORM 9900-ERROR-FORMAT
 14428                                 THRU 9900-EXIT
 14429        GO TO 3130-EDIT-AGE
 14430     END-IF
 14431
 14432*    IF PB-I-LOAN-APR = ZERO
 14433*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14434*    END-IF
 14435                                                                  ELC50PD
 14436     if pb-i-loan-apr = +99.9999
 14437        move er-2656             to ws-error
 14438        PERFORM 9900-ERROR-FORMAT
 14439                                 THRU 9900-EXIT
 14440        GO TO 3130-EDIT-AGE
 14441     end-if
 14442
 14443*    IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14444*       MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14445*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14446*       GO TO 3130-EDIT-AGE.                                      ELC50PD
 14447                                                                  ELC50PD
 14448*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14449     if pb-i-loan-apr not = +99.9999
 14450        IF PB-I-LOAN-APR > +30.000
 14451           MOVE ER-2657          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14452           PERFORM 9900-ERROR-FORMAT
 14453                                 THRU 9900-EXIT
 14454        end-if
 14455     end-if
 14456
 14457     .
 14458 3130-EDIT-AGE.                                                   ELC50PD
 14459                                                                  ELC50PD
 14460******************************************************************ELC50PD
 14461*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14462******************************************************************ELC50PD
 14463                                                                  ELC50PD
 14464     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14465        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14466           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14467               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14468               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14469                                                                  ELC50PD
 14470     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14471        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14472           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14473               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14474               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14475                                                                  ELC50PD
 14476 3133-SEX-CODE.                                                   ELC50PD
 14477     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14478         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14479             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14480          ELSE                                                    ELC50PD
 14481             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14482             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14483                                                                  ELC50PD
 14484     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14485         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14486                                                                  ELC50PD
 14487     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14488         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14489                                                                  ELC50PD
 14490 3134-SIG-SW-EDIT.                                                ELC50PD
 14491     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14492         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14493                                                                  ELC50PD
 14494     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14495         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14496             NEXT SENTENCE                                        ELC50PD
 14497         ELSE                                                     ELC50PD
 14498             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14500     ELSE                                                         ELC50PD
 14501     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14502         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14503             NEXT SENTENCE                                        ELC50PD
 14504         ELSE                                                     ELC50PD
 14505             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14506             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14507     ELSE                                                         ELC50PD
 14508     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14509         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14510             NEXT SENTENCE                                        ELC50PD
 14511         ELSE                                                     ELC50PD
 14512             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14513             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14514     ELSE                                                         ELC50PD
 14515         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14516             NEXT SENTENCE                                        ELC50PD
 14517         ELSE                                                     ELC50PD
 14518             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14519             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14520                                                                  ELC50PD
 14521     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
 14522         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14523             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14524            PB-I-SIG-SW = 'N'                                     ELC50PD
 14525            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14526            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14527                                                                  ELC50PD
 14528 3135-NAME-EDIT.                                                  ELC50PD
 14529                                                                  ELC50PD
 14530     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14531        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14532        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14533           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14534                                 TO PB-I-JOINT-FIRST-NAME
 14535        END-PERFORM
 14536     END-IF
 14537
 14538     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14539        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14540        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14541           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14542                                 TO PB-I-JOINT-LAST-NAME
 14543        END-PERFORM
 14544     END-IF
 14545
 14546     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14547        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14548        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14549           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14550                                 TO PB-I-INSURED-FIRST-NAME
 14551        END-PERFORM
 14552     END-IF
 14553
 14554     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14555        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14556        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14557           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14558                                 TO PB-I-INSURED-LAST-NAME
 14559        END-PERFORM
 14560     END-IF
 14561
 14562     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14563       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14564       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14565           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14566           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14567                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14568 3136-EDIT-SEX.                                                   ELC50PD
 14569                                                                  ELC50PD
 14570******************************************************************ELC50PD
 14571*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14572******************************************************************ELC50PD
 14573                                                                  ELC50PD
 14574     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14575        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14576        NEXT SENTENCE                                             ELC50PD
 14577     ELSE                                                         ELC50PD
 14578        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14579           NEXT SENTENCE                                          ELC50PD
 14580        ELSE                                                      ELC50PD
 14581           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14583                                                                  ELC50PD
 14584 3137-EDIT-EFF-DATE.                                              ELC50PD
 14585                                                                  ELC50PD
 14586     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14587        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14588        PB-POLICY-IS-VOIDED                                       ELC50PD
 14589         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14590                                                                  ELC50PD
 14591     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14592                                    WS-2672-SW.                   ELC50PD
 14593                                                                  ELC50PD
 14594     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14595         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14596             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14598             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14599                                                                  ELC50PD
 14600     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14601         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14602                                                                  ELC50PD
 14603     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14604     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14605*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14606     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14607     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14608                                    DC-ELAPSED-DAYS.              ELC50PD
 14609     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14610                                                                  ELC50PD
 14611     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14612         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14613                                                                  ELC50PD
 14614     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14615         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14616         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14618     END-IF
 14619                                                                  ELC50PD
 14620     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14621        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14622        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14623        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14624        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14625                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14626     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14627      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14628         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14629         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14631         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14632                                    WS-2672-SW.                   ELC50PD
 14633                                                                  ELC50PD
 14634     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14635         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14636             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14638         ELSE                                                     ELC50PD
 14639             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14640             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14641                                                                  ELC50PD
 14642                                                                  ELC50PD
 14643 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14644                                                                  ELC50PD
 14645     if pb-company-id not = 'AHL'
 14646        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14647           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14648           MOVE ER-2787          TO WS-ERROR
 14649           PERFORM 9900-ERROR-FORMAT
 14650                                 THRU 9900-EXIT
 14651        END-IF
 14652     end-if
 14653
 14654     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14655        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14656                                 > 250000.00
 14657           MOVE ER-2719          TO WS-ERROR
 14658           PERFORM 9900-ERROR-FORMAT
 14659                                 THRU 9900-EXIT
 14660        END-IF
 14661     END-IF
 14662
 14663     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14664        PB-POLICY-IS-VOIDED                                       ELC50PD
 14665         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14666                                                                  ELC50PD
 14667     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14668        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14669         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14671                                                                  ELC50PD
 14672     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14673        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14674        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14675         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14676                                                                  ELC50PD
 14677     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14678        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14679        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14680         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14681                                                                  ELC50PD
 14682     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14683        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14684        MOVE ER-2631             TO WS-ERROR
 14685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14686     END-IF
 14687                                                                  ELC50PD
 14688                                                                  ELC50PD
 14689******************************************************************ELC50PD
 14690*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14691******************************************************************ELC50PD
 14692                                                                  ELC50PD
 14693     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14694        NEXT SENTENCE                                             ELC50PD
 14695     ELSE                                                         ELC50PD
 14696        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14697           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14698           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14699                                                                  ELC50PD
 14700                                                                  ELC50PD
 14701******************************************************************ELC50PD
 14702*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14703******************************************************************ELC50PD
 14704                                                                  ELC50PD
 14705     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14706        CONTINUE                                                  ELC50PD
 14707     ELSE                                                         ELC50PD
 14708        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14709           IF (NOT PB-COMP-LF-PREM)
 14710              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14711              MOVE ER-2633       TO WS-ERROR
 14712              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14713           END-IF
 14714        END-IF
 14715     END-IF
 14716
 14717     .                                                            ELC50PD
 14718 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14719                                                                  ELC50PD
 14720     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14721        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14722        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14723         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14724                                                                  ELC50PD
 14725     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14726        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14727        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14728        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14729         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14730                                                                  ELC50PD
 14731     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14732        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14733        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14734         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14735                                                                  ELC50PD
 14736     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14737         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14739                                                                  ELC50PD
 14740******************************************************************ELC50PD
 14741*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14742******************************************************************ELC50PD
 14743                                                                  ELC50PD
 14744     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14745        NEXT SENTENCE                                             ELC50PD
 14746     ELSE                                                         ELC50PD
 14747        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14748           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14749           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14750                                                                  ELC50PD
 14751******************************************************************ELC50PD
 14752*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14753******************************************************************ELC50PD
 14754                                                                  ELC50PD
 14755     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14756        NEXT SENTENCE                                             ELC50PD
 14757     ELSE                                                         ELC50PD
 14758        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14759            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14760                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14761                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14762                                                                  ELC50PD
 14763                                                                  ELC50PD
 14764 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14765* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14766     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14767                                     WS-RES-MUNI-TAX              ELC50PD
 14768                                     PB-I-STATE-TAX               ELC50PD
 14769                                     PB-I-MUNI-TAX.               ELC50PD
 14770                                                                  ELC50PD
 14771     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14772                                                                  ELC50PD
 14773     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14774        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14775                                                                  ELC50PD
 14776     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14777        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14778                                                                  ELC50PD
 14779     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14780        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14781                                                                  ELC50PD
 14782     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14783                             OR 'RIC')                            ELC50PD
 14784        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14785                                                                  ELC50PD
 14786     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14787        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14788            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14789        ELSE                                                      ELC50PD
 14790           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14791               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14792                                                                  ELC50PD
 14793     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14794        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14795                                                                  ELC50PD
 14796     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14797        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14798                                                                  ELC50PD
 14799     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14800        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14801           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14802             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14803           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14804           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14805              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14806              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14807              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14808           ELSE                                                   ELC50PD
 14809              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14810                                                                  ELC50PD
 14811 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
 14812                                                                  ELC50PD
 14813* DMD RATING TEST                                                 ELC50PD
 14814     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14815         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14816         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14817         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14819         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14820         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14821                                                                  ELC50PD
 14822     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14823         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14824             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14825                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14826                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14827                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14828                                                                  ELC50PD
 14829     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14830         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14831             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14832                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14833                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14834                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14835                                                                  ELC50PD
 14836     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14837        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14838            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14839              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14840                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14841                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14842                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14843                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14844                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14845                                                                  ELC50PD
 14846     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14847        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14848            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14849               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14850               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14851               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14852                                                                  ELC50PD
 14853     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14854        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14855            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14856                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14857                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14858                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14859                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14860                                                                  ELC50PD
 14861     IF WS-ERROR = ER-2693                                        ELC50PD
 14862        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14863           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14864           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14865           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14866                                                                  ELC50PD
 14867     IF WS-ERROR = ER-2693                                        ELC50PD
 14868        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14869           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
 14870           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14871           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14872                                                                  ELC50PD
 14873     IF WS-ERROR = ER-2693                                        ELC50PD
 14874        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14875           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14876           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14877           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14878                                                                  ELC50PD
 14879     IF WS-ERROR = ER-2693                                        ELC50PD
 14880        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14881           IF WS-LEVEL                                            ELC50PD
 14882              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14883              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14884                                                                  ELC50PD
 14885     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14886         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14887         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14888       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14889             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14890             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14891         NEXT SENTENCE                                            ELC50PD
 14892     ELSE                                                         ELC50PD
 14893         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14894                                                                  ELC50PD
 14895     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14896        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14897           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14898           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14899           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14900                                                                  ELC50PD
 14901     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14902        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14903           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14904           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14905           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14906                                                                  ELC50PD
 14907     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14908                                                                  ELC50PD
 14909     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14910         NEXT SENTENCE                                            ELC50PD
 14911     ELSE                                                         ELC50PD
 14912         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14913             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14914                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14915                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14916                                                                  ELC50PD
 14917     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14918       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14919         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14920         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14921         IF WS-ERROR = ER-2675                                    ELC50PD
 14922            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14923            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14924            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14925         ELSE                                                     ELC50PD
 14926            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14927            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14928                                                                  ELC50PD
 14929                                                                  ELC50PD
 14930     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14931         NEXT SENTENCE                                            ELC50PD
 14932     ELSE                                                         ELC50PD
 14933       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14934            NEXT SENTENCE
 14935       ELSE
 14936         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14937             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14938                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14939                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14940                                                                  ELC50PD
 14941     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14942       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14943         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14944         IF WS-ERROR = ER-2676                                    ELC50PD
 14945            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14946            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14947            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14948         ELSE                                                     ELC50PD
 14949            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14950            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14951                                                                  ELC50PD
 14952     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14953         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14954            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14955     ELSE                                                         ELC50PD
 14956         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14957             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14958                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14959                                                                  ELC50PD
 14960     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14961         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14962            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14963     ELSE                                                         ELC50PD
 14964         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14965             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14966                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14967                                                                  ELC50PD
 14968     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14969                                                                  ELC50PD
 14970     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14971                                                                  ELC50PD
 14972                                                                  ELC50PD
 14973 3215-EDIT-RATES.                                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14974     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14975         NEXT SENTENCE                                            ELC50PD
 14976     ELSE                                                         ELC50PD
 14977         GO TO 3999-END-EDIT.                                     ELC50PD
 14978                                                                  ELC50PD
 14979 3220-CHECK-LF-RATES.                                             ELC50PD
 14980                                                                  ELC50PD
 14981     IF PB-COMPANY-ID = 'DCC'
 14982        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14983        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14984        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14985           AND (NOT WS-LF-CASH))
 14986                           OR
 14987           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14988           AND (NOT WS-AH-CASH)))
 14989                       AND
 14990           (PB-I-ENTRY-STATUS NOT = '5')
 14991           MOVE 'M'              TO PB-BATCH-ENTRY
 14992                                    PB-I-ENTRY-STATUS
 14993        END-IF
 14994     END-IF
 14995
 14996
 14997
 14998     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 14999                                    PB-I-AH-PREM-CALC             ELC50PD
 15000                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 15001                                    PB-I-LF-ALT-RATE              ELC50PD
 15002                                    PB-I-LF-REI-RATE              ELC50PD
 15003                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 15004                                    PB-I-AH-REI-RATE
 15005                                    PB-I-TOT-FEES-CALC.
 15006                                                                  ELC50PD
 15007     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15008        NEXT SENTENCE                                             ELC50PD
 15009     ELSE                                                         ELC50PD
 15010        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 15011                                    PB-I-AH-RATE.                 ELC50PD
 15012                                                                  ELC50PD
 15013     IF PB-I-TOT-FEES NOT NUMERIC
 15014        MOVE ZEROS               TO PB-I-TOT-FEES
 15015     END-IF
 15016
 15017     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 15018         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 15019                                                                  ELC50PD
 15020     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 15021         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 15022                                                                  ELC50PD
 15023     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 15024        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 15025     END-IF
 15026                                                                  ELC50PD
 15027     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 15028        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 15029     END-IF
 15030                                                                  ELC50PD
 15031     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15032        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 15033            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 15034     ELSE                                                         ELC50PD
 15035            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 15036                                                                  ELC50PD
 15037     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 15038         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 15039                                                                  ELC50PD
 15040     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 15041         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 15042                                                                  ELC50PD
 15043     MOVE SPACES                 TO CP-BEN-CATEGORY
 15044     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 15045        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 15046        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 15047             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 15048        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 15049             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 15050        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 15051             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 15052        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 15053           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 15054           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 15055        ELSE                                                      ELC50PD
 15056           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 15057              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 15058               AM-MAX-TOT-BEN                                     ELC50PD
 15059               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 15060           ELSE                                                   ELC50PD
 15061              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 15062                 AM-MAX-TOT-BEN) AND                              ELC50PD
 15063                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 15064                 AM-MAX-TOT-BEN)                                  ELC50PD
 15065                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 15066              ELSE                                                ELC50PD
 15067                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 15068                                                                  ELC50PD
 15069     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15070         NEXT SENTENCE                                            ELC50PD
 15071     ELSE                                                         ELC50PD
 15072         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15073                                                                  ELC50PD
 15074*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15075                                                                  ELC50PD
 15076     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15077        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15078              OR                                                  ELC50PD
 15079           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15080           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15082           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15083                                                                  ELC50PD
 15084     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15085           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15086                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15087                                                                  ELC50PD
 15088     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15089         MOVE ER-2687             TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15090         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15091         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15092         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15093         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15094                                                                  ELC50PD
 15095     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15096        IF PB-I-LIVES = ZERO                                      ELC50PD
 15097           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15098           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15099                                                                  ELC50PD
 15100     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15101                                                                  ELC50PD
 15102     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15103     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15104     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15105     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15106     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15107     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15108     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15109     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15110     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15111     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15112                                                                  ELC50PD
 15113******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15114     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15115         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15116            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15117             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15118                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15119*******                                                           ELC50PD
 15120                                                                  ELC50PD
 15121     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15122     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15123     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15124     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15125     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15126     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15127                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15128     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15129         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15130                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15131     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15132     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15133     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15134     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15135     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15136     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15137     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15138     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15139     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15140                                    CP-REMAINING-TERM             ELC50PD
 15141                                    CP-LOAN-TERM.                 ELC50PD
 15142                                                                  ELC50PD
 15143     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15144         NEXT SENTENCE                                            ELC50PD
 15145     ELSE                                                         ELC50PD
 15146         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15147             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15148                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15149                                                                  ELC50PD
 15150     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15151        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15152           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15153                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15154                                                                  ELC50PD
 15155     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15156         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15157            CP-EARN-AS-NET-PAY                                    ELC50PD
 15158             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15159                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15160                                                                  ELC50PD
 15161     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15162        or ((pb-company-id = 'AHL')
 15163           and (pb-i-loan-term > pb-i-lf-term))
 15164        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15165                                                                  ELC50PD
 15166     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15167        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15168                                                                  ELC50PD
 15169     IF CP-TERM-IS-DAYS                                           ELC50PD
 15170         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15171     ELSE                                                         ELC50PD
 15172         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15173
 15174     IF PB-COMPANY-ID = 'DCC'
 15175        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15176        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15177        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15178        IF WS-LF-BEN-CATEGORY = 'D'
 15179           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15180           MOVE PB-I-LIFE-COMMISSION
 15181                                 TO CP-DCC-ACT-COMM
 15182           MOVE WS-LF-BEN-CATEGORY
 15183                                 TO CP-BEN-CATEGORY
 15184        END-IF
 15185        IF (CP-BENEFIT-CD (1:1) = 'P')
 15186           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15187           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15188           add pb-i-ah-premium-amt to cp-original-premium
 15189        END-IF
 15190     END-IF
 15191
 15192     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15193         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15194         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15195         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15196                                                                  ELC50PD
 15197     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15198        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15199                                                                  ELC50PD
 15200     IF (CP-SPECIAL-CALC-CD = 'H')
 15201        OR (PB-COMPANY-ID = 'DCC')
 15202         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15203                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15204         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15205                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15206
 15207     IF (PB-COMPANY-ID = 'CID')
 15208        AND (WS-LF-EARNINGS-CALC = 'B')
 15209        AND (CP-STATE-STD-ABBRV = 'MN')
 15210        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15211                                 TO CP-ALTERNATE-BENEFIT
 15212        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15213     END-IF
 15214
 15215     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15216     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15217     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15218                                                                  ELC50PD
 15219     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15220        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15222        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15223                                                                  ELC50PD
 15224     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15225        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15226           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15227              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15228              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15229                                                                  ELC50PD
 15230
 15231******************************************************************ELC50PD
 15232*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15233*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15234******************************************************************ELC50PD
 15235                                                                  ELC50PD
 15236* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15237                                                                  00031343
 15238     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15239          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15240                                                                  00031346
 15241*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15242*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15243*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15244*        MOVE ER-2709        TO WS-ERROR                          00031349
 15245*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15246*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15247                                                                  00031352
 15248*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15249*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15250*        MOVE ER-2718        TO WS-ERROR                          00031349
 15251*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15252*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15253                                                                  00031352
 15254* CALC A & H AGE AT EXPIRATION.                                   00031353
 15255                                                                  00031354
 15256     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15257          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15258                                                                  00031357
 15259*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15260*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15261*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15262*        MOVE ER-2709        TO WS-ERROR                          00031349
 15263*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15264*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15265                                                                  00031352
 15266*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15267*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15268*        MOVE ER-2718        TO WS-ERROR                          00031360
 15269*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15270*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15271
 15272     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15273        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15274                                                                  ELC50PD
 15275     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
 15276        GO TO 3221-CHECK-ERROR-RATE-OPEN
 15277     end-if
 15278                                                                  ELC50PD
 15279     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15280        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15281                                                                  ELC50PD
 15282     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15283         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15284         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15286                                                                  ELC50PD
 15287                                                                  00031363
 15288******************************************************************ELC50PD
 15289*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15290******************************************************************ELC50PD
 15291                                                                  ELC50PD
 15292 PREMIUM-EDITING-IS-BYPASSED.
 15293
 15294     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15295        AND (CP-R-MAX-ATT-AGE > +0)
 15296        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15297        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15298           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15299           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15300           MOVE '1'              TO DC-OPTION-CODE
 15301           PERFORM 8500-DATE-CONVERT
 15302                                 THRU 8500-EXIT
 15303           IF NO-CONVERSION-ERROR
 15304              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15305                 MOVE ER-2661       TO WS-ERROR
 15306*                PERFORM 9900-ERROR-FORMAT
 15307*                                THRU 9900-EXIT
 15308              END-IF
 15309           END-IF
 15310        ELSE
 15311           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15312           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15313              MOVE ER-2661       TO WS-ERROR
 15314*             PERFORM 9900-ERROR-FORMAT
 15315*                                THRU 9900-EXIT
 15316           ELSE
 15317              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15318                 MOVE ER-1570    TO WS-ERROR
 15319                 PERFORM 9900-ERROR-FORMAT
 15320                                 THRU 9900-EXIT
 15321              END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15322           END-IF
 15323        END-IF
 15324
 15325        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15326           MOVE PB-I-JOINT-BIRTHDAY
 15327                                 TO DC-BIN-DATE-1
 15328           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15329           MOVE '1'              TO DC-OPTION-CODE
 15330           PERFORM 8500-DATE-CONVERT
 15331                                 THRU 8500-EXIT
 15332           IF NO-CONVERSION-ERROR
 15333              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15334                 MOVE ER-2661       TO WS-ERROR
 15335*                PERFORM 9900-ERROR-FORMAT
 15336*                                THRU 9900-EXIT
 15337              END-IF
 15338           ELSE
 15339              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15340           END-IF
 15341        ELSE
 15342           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15343             (PB-I-LF-TERM / 12)
 15344           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15345              MOVE ER-2661       TO WS-ERROR
 15346*             PERFORM 9900-ERROR-FORMAT
 15347*                                THRU 9900-EXIT
 15348           ELSE
 15349              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15350                 MOVE ER-1571    TO WS-ERROR
 15351                 PERFORM 9900-ERROR-FORMAT
 15352                                 THRU 9900-EXIT
 15353              END-IF
 15354           END-IF
 15355        END-IF
 15356        IF WS-ERROR = ER-2661
 15357           PERFORM 9900-ERROR-FORMAT
 15358                                 THRU 9900-EXIT
 15359        END-IF
 15360     END-IF
 15361
 15362*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15363*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15364*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15365                                                                  ELC50PD
 15366     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15367        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15369                                                                  ELC50PD
 15370     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15371        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15373                                                                  ELC50PD
 15374     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15375        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15377                                                                  ELC50PD
 15378 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15379                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15380     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15381         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15382                                                                  ELC50PD
 15383     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15384        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15385     END-IF
 15386
 15387     .
 15388 3221-CONTINUE.                                                   ELC50PD
 15389     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15390                                    WS-DCC-AH-RATE
 15391
 15392     IF PB-COMPANY-ID = 'DCC'
 15393        IF WS-LF-BEN-CATEGORY = 'D'
 15394           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15395              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15396        END-IF
 15397     END-IF
 15398
 15399     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15400
 15401*   X'A4FF' = 12/31/2009
 15402     IF (PB-COMPANY-ID = 'CID')
 15403        AND (WS-LF-EARNINGS-CALC = 'B')
 15404        AND (CP-STATE-STD-ABBRV = 'MN')
 15405        AND (PB-CERT-EFF-DT > X'A4FF')
 15406        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15407     END-IF
 15408
 15409     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15410                                                                  ELC50PD
 15411     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15412     IF (PB-COMPANY-ID = 'DCC')
 15413        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15414        AND (PB-I-POLICY-IS-MONTHLY)
 15415        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15416        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15417     END-IF
 15418     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15419     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15420     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15421     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15422
 15423     IF (PB-COMPANY-ID = 'DCC')
 15424        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15425        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15426        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15427        MOVE ER-2786             TO WS-ERROR
 15428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15429     END-IF
 15430                                                                  ELC50PD
 15431     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15432                                                                  ELC50PD
 15433******************************************************************ELC50PD
 15434*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15435******************************************************************ELC50PD
 15436     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15437        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15438                                                                  ELC50PD
 15439     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15440        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15441     ELSE                                                         ELC50PD
 15442       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15443          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15444          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15445                                                                  ELC50PD
 15446 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15447                                                                  ELC50PD
 15448     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15449        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15450        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15451         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15452                                                                  ELC50PD
 15453     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15454         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15455             AND PB-COMPANY-ID NOT = 'DCC')
 15456                   OR
 15457
 15458              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15459              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15460              AND PB-COMPANY-ID NOT = 'DCC')
 15461             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15462             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15463             GO TO 3225-RATING-CONT                               ELC50PD
 15464         ELSE                                                     ELC50PD
 15465             GO TO 3225-RATING-CONT.                              ELC50PD
 15466
 15467     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15468        AND (AM-GPCD = 01 OR 06 OR 15)
 15469        MOVE ER-2798             TO WS-ERROR
 15470        PERFORM 9900-ERROR-FORMAT
 15471                                 THRU 9900-EXIT
 15472*       GO TO 3225-RATING-CONT
 15473     END-IF
 15474
 15475     IF (PB-COMPANY-ID = 'CID')
 15476        AND (WS-LF-EARNINGS-CALC = 'B')
 15477        AND (CP-STATE-STD-ABBRV = 'MN')
 15478        AND (PB-CERT-EFF-DT > X'A4FF')
 15479        GO TO 3225-RATING-CONT
 15480     END-IF
 15481
 15482     IF PB-COMPANY-ID = 'DCC'
 15483        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15484           AND (PB-I-POLICY-IS-MONTHLY)
 15485           GO TO 3225-RATING-CONT
 15486        END-IF
 15487     END-IF
 15488
 15489     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15490        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15491        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15492        NEXT SENTENCE                                             ELC50PD
 15493     ELSE                                                         ELC50PD
 15494        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15495                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15496 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15497                                                                  ELC50PD
 15498     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15499                                                                  ELC50PD
 15500     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15501        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15502        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15503         NEXT SENTENCE                                            ELC50PD
 15504     ELSE                                                         ELC50PD
 15505         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15506                                                                  ELC50PD
 15507     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15508     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15509     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15510                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15511     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15512         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15513                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15514
 15515     IF PB-COMPANY-ID = 'DCC'
 15516        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15517     END-IF
 15518
 15519     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15520     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15521     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15522                                    CP-REMAINING-TERM             ELC50PD
 15523                                    CP-LOAN-TERM.                 ELC50PD
 15524     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15525        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15526                                    CP-REMAINING-TERM             ELC50PD
 15527                                    CP-LOAN-TERM.                 ELC50PD
 15528                                                                  ELC50PD
 15529     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15530     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15531                                                                  ELC50PD
 15532     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15533         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15535         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15536                                                                  ELC50PD
 15537     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15538     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15539                                                                  ELC50PD
 15540     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15541         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15542                                                                  ELC50PD
 15543     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15544                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15545                                                                  ELC50PD
 15546     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15547        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15548        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 15549        GO TO 3225-CONTINUE.                                      ELC50PD
 15550                                                                  ELC50PD
 15551     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15552        GO TO 3225-CONTINUE.                                      ELC50PD
 15553                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15554     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15555                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15556        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15557        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15559                                                                  ELC50PD
 15560 3225-CONTINUE.                                                   ELC50PD
 15561     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15562         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15564                                                                  ELC50PD
 15565     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15566        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
 15567        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15569                                                                  ELC50PD
 15570 3225-RATING-CONT.                                                ELC50PD
 15571                                                                  ELC50PD
 15572     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15573         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15574         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15575         IF (PB-COMPANY-ID = 'DCC')
 15576            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15577            CONTINUE
 15578         ELSE
 15579            MOVE ER-2687         TO WS-ERROR
 15580            PERFORM 9900-ERROR-FORMAT
 15581                                 THRU 9900-EXIT
 15582         END-IF
 15583         GO TO 3290-EDIT-LF-REIN-RATE
 15584     END-IF
 15585                                                                  ELC50PD
 15586* DMD RATING TEST                                                 ELC50PD
 15587     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15588         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15589         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15590         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15592         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15593                                                                  ELC50PD
 15594 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15595                                                                  ELC50PD
 15596     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15597     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15598*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15599     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15600     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15601                                                                  ELC50PD
 15602 C-POS-3230-MORT-CD.                                              ELC50PD
 15603     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15604        PB-SV-CARRIER = '2'                                       ELC50PD
 15605         NEXT SENTENCE                                            ELC50PD
 15606     ELSE                                                         ELC50PD
 15607         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15608                                                                  ELC50PD
 15609     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15610        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15611         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15612      ELSE                                                        ELC50PD
 15613         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15614                                                                  ELC50PD
 15615                                                                  ELC50PD
 15616 C-POS-3240-MORT-CD.                                              ELC50PD
 15617     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15618        PB-SV-CARRIER = '1'                                       ELC50PD
 15619         NEXT SENTENCE                                            ELC50PD
 15620     ELSE                                                         ELC50PD
 15621         GO TO 3230-CONTINUE.                                     ELC50PD
 15622                                                                  ELC50PD
 15623     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15624        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
 15625         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15626     ELSE                                                         ELC50PD
 15627         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15628                                                                  ELC50PD
 15629 3230-CONTINUE.                                                   ELC50PD
 15630
 15631     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15632        GO TO 3240-CONTINUE                                       00033065
 15633     END-IF
 15634
 15635     IF PB-CERT-EFF-DT > WS-971231
 15636        GO TO 3240-CONTINUE                                       00033065
 15637     END-IF
 15638
 15639     IF LF-BENEFIT-FOUND AND                                      00033066
 15640        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15641         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15642     ELSE                                                         00033069
 15643         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15644             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15645         ELSE                                                     00033072
 15646             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15647         END-IF
 15648     END-IF
 15649                                                                  00033074
 15650     .
 15651 3240-CONTINUE.                                                   ELC50PD
 15652
 15653     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15654         GO TO 3256-CONTINUE.                                     ELC50PD
 15655                                                                  ELC50PD
 15656     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15657         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15658     ELSE                                                         ELC50PD
 15659         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15660                                                                  ELC50PD
 15661 3256-CONTINUE.                                                   ELC50PD
 15662     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15663         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15664                                                                  ELC50PD
 15665     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15666         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15667     ELSE                                                         ELC50PD
 15668         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15669                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15670 3260-EDIT-CONTINUE.                                              ELC50PD
 15671     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15672                                                                  ELC50PD
 15673 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15674     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15675         GO TO 3290-RATING-CONT.                                  ELC50PD
 15676                                                                  ELC50PD
 15677     IF PB-COMPANY-ID = 'DCC'
 15678        GO TO 3290-RATING-CONT.
 15679
 15680     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15681     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15682     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
 15683     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15684     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15685                                                                  ELC50PD
 15686******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15687     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15688         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15689            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15690             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15691*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15692             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15693             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15694***  Y2K PROJ 7744                                                   CL*11
 15695             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15696                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15697***  Y2K PROJ 7744                                                   CL*11
 15698*******                                                           ELC50PD
 15699                                                                  ELC50PD
 15700     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15701     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15702     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15703     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15704                                   CP-RATE-DEV-PCT.               ELC50PD
 15705     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15706     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15707                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15708                                                                  ELC50PD
 15709************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15710     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15711         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15712            CP-EARN-AS-NET-PAY                                    ELC50PD
 15713             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15714                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15715************                                                      ELC50PD
 15716                                                                  ELC50PD
 15717     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15718         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15719                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15720     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15721     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15722     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15723     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15724     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15725     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15726     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15727     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15728                                   CP-REMAINING-TERM              ELC50PD
 15729                                   CP-LOAN-TERM.                  ELC50PD
 15730     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15731        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15732                                                                  ELC50PD
 15733     IF CP-TERM-IS-DAYS                                           ELC50PD
 15734         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15735     ELSE                                                         ELC50PD
 15736         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15737                                                                  ELC50PD
 15738
 15739     IF PB-COMPANY-ID = 'DCC'
 15740        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15741     END-IF
 15742
 15743     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15744          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15745                                                                  ELC50PD
 15746     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15747                                                                  ELC50PD
 15748     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15749     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15750                                                                  ELC50PD
 15751     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15752        IF PB-I-OB                                                ELC50PD
 15753           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15755           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15756        ELSE                                                      ELC50PD
 15757           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15758           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15759           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15760                                                                  ELC50PD
 15761     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15762                                                                  ELC50PD
 15763     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15764     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15765                                                                  ELC50PD
 15766     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15767         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15769                                                                  ELC50PD
 15770 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15771                                                                  ELC50PD
 15772     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15773        GO TO 3290-RATING-CONT.                                   ELC50PD
 15774                                                                  ELC50PD
 15775     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15776     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15777     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15778     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15779     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15780     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15781                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15782     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15783         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15784                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15785
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15786     IF PB-COMPANY-ID = 'DCC'
 15787        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15788     END-IF
 15789
 15790     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15791     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15792     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15793                                    CP-REMAINING-TERM             ELC50PD
 15794                                    CP-LOAN-TERM.                 ELC50PD
 15795     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15796        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15797                                    CP-REMAINING-TERM             ELC50PD
 15798                                    CP-LOAN-TERM.                 ELC50PD
 15799                                                                  ELC50PD
 15800     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15801     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15802                                                                  ELC50PD
 15803     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15804                                                                  ELC50PD
 15805     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15806         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15808                                                                  ELC50PD
 15809 3290-RATING-CONT.                                                ELC50PD
 15810                                                                  ELC50PD
 15811     IF PB-I-OB                                                   ELC50PD
 15812*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15813        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15814                                                                  ELC50PD
 15815 3299-EDIT-CONTINUE.                                              ELC50PD
 15816                                                                  ELC50PD
 15817     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15818         NEXT SENTENCE                                            ELC50PD
 15819     ELSE                                                         ELC50PD
 15820         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15822                                                                  ELC50PD
 15823 3300-CHECK-AH-RATES.                                             ELC50PD
 15824     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15825         NEXT SENTENCE                                            ELC50PD
 15826     ELSE                                                         ELC50PD
 15827         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15828                                                                  ELC50PD
 15829     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15830        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15831                (NO-DMD-RATING))                                  ELC50PD
 15832         IF (PB-COMPANY-ID = 'DCC')
 15833            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15834            CONTINUE
 15835         ELSE
 15836            MOVE ER-2687         TO WS-ERROR
 15837            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15838         END-IF
 15839         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15840         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15841     END-IF
 15842                                                                  ELC50PD
 15843     IF PB-I-OB                                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15844        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15845                                                                  ELC50PD
 15846     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15847         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15849         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15850         GO TO 3999-END-EDIT.                                     ELC50PD
 15851                                                                  ELC50PD
 15852*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15853
 15854     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15855        IF PB-I-AH-CRIT-PER = ZERO
 15856           IF PB-COMPANY-ID = 'DCC'
 15857              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15858              CONTINUE
 15859           ELSE
 15860              MOVE ER-2618       TO WS-ERROR
 15861              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15862              GO TO 3999-END-EDIT
 15863           END-IF
 15864        END-IF
 15865     END-IF
 15866
 15867     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15868     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15869     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15870     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15871     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15872     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15873     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15874     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15875     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15876*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15877     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15878     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15879     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15880     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15881                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15882     IF PB-COMPANY-ID = 'CID'
 15883               OR
 15884        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15885         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15886                                         PB-I-AH-TERM.            ELC50PD
 15887     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15888        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15889           AND (PB-I-POLICY-IS-MONTHLY)
 15890           MOVE PB-I-LF-BENEFIT-AMT
 15891                                 TO CP-NET-BENEFIT-AMT
 15892           move pb-i-ah-premium-amt to cp-original-premium
 15893           add pb-i-lf-premium-amt to cp-original-premium
 15894        END-IF
 15895     END-IF
 15896
 15897     MOVE SPACES                 TO CP-BEN-CATEGORY
 15898
 15899     IF PB-COMPANY-ID = 'DCC'
 15900        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15901        EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15902           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15903              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15904              MOVE PB-I-LF-BENEFIT-AMT
 15905                                 TO CP-RATING-BENEFIT-AMT
 15906              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15907           WHEN WS-AH-BEN-CATEGORY = 'G'
 15908              MOVE PB-I-UNPAID-CASH-PRICE
 15909                                 TO CP-RATING-BENEFIT-AMT
 15910           WHEN WS-AH-BEN-CATEGORY = 'D'
 15911              MOVE WS-AH-PMF-COMM
 15912                                 TO CP-DCC-PMF-COMM
 15913              MOVE PB-I-AH-COMMISSION
 15914                                 TO CP-DCC-ACT-COMM
 15915        END-EVALUATE
 15916     END-IF
 15917
 15918     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15919     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15920     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15921     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15922     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15923     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15924     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15925                                    CP-REMAINING-TERM             ELC50PD
 15926                                    WS-WORK-TERM.                 ELC50PD
 15927     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15928                                                                  ELC50PD
 15929     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15930     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15931*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15932     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15933     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15934                                                                  ELC50PD
 15935     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15936     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15937         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15939         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15940                                                                  ELC50PD
 15941     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15942         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15943                                                                  ELC50PD
 15944     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15945                                                                  ELC50PD
 15946     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15947         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15948     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15949         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15950     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15951         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15952     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15953         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15954     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15955         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15956                                                                  ELC50PD
 15957     MOVE 1                      TO SUB2.                         ELC50PD
 15958     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15959     MOVE WS-MONTH               TO SUB1.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15960     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15961     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15962                                                                  ELC50PD
 15963 3310-GET-SKIP-MO.                                                ELC50PD
 15964     IF SUB1 = 13                                                 ELC50PD
 15965         MOVE 1                  TO SUB1.                         ELC50PD
 15966                                                                  ELC50PD
 15967     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15968         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15969                                                                  ELC50PD
 15970     ADD 1 TO SUB2                                                ELC50PD
 15971              SUB1.                                               ELC50PD
 15972                                                                  ELC50PD
 15973 3320-RATE-CONTINUE.                                              ELC50PD
 15974                                                                  ELC50PD
 15975     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15976         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15977                                                                  ELC50PD
 15978     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15979                                    CP-LOAN-TERM.                 ELC50PD
 15980                                                                  ELC50PD
 15981     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15982         NEXT SENTENCE                                            ELC50PD
 15983     ELSE                                                         ELC50PD
 15984         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15985                                    PB-I-AH-REI-RATE.             ELC50PD
 15986                                                                  ELC50PD
 15987                                                                  ELC50PD
 15988     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15989        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15990                                                                  ELC50PD
 15991     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15992         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15993         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15994         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15995         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 15996                                                                  ELC50PD
 15997     IF PB-COMPANY-ID = 'DCC'
 15998        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15999           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16000              PB-I-RATE-DEV-PCT-LF
 16001        END-IF
 16002        MOVE PB-I-LF-ALT-BENEFIT-AMT
 16003                                 TO CP-ALTERNATE-BENEFIT
 16004        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16005        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 16006        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 16007     END-IF
 16008
 16009     IF (PB-COMPANY-ID = 'CID')
 16010        AND (WS-LF-EARNINGS-CALC = 'B')
 16011        AND (CP-STATE-STD-ABBRV = 'MN')
 16012        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 16013     ELSE
 16014        MOVE ' '                 TO CP-AH-BALLOON-SW
 16015     END-IF
 16016
 16017     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16018     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16019     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16020                                                                  ELC50PD
 16021     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16022        IF PB-I-OB                                                ELC50PD
 16023           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 16024           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16025           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 16026        ELSE                                                      ELC50PD
 16027          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16028              NEXT SENTENCE
 16029          ELSE
 16030           MOVE ER-2642          TO WS-ERROR                      ELC50PD
 16031           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16032           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 16033                                                                  ELC50PD
 16034     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 16035        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 16036           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 16037           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16038                                                                  ELC50PD
 16039     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16040        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 16041           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 16042              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 16043              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 16044                                                                  ELC50PD
 16045     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16046        NEXT SENTENCE                                             ELC50PD
 16047     ELSE                                                         ELC50PD
 16048       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 16049          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 16050          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 16051                                                                  ELC50PD
 16052     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16053         IF WS-ERROR = ER-2640                                    ELC50PD
 16054             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16055
 16056     IF ACCOUNT-AH-CHECKED
 16057        CONTINUE
 16058     ELSE
 16059        IF (CP-R-MAX-ATT-AGE NUMERIC)
 16060           AND (CP-R-MAX-ATT-AGE > +0)
 16061           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 16062           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 16063              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 16064              MOVE PB-I-AH-EXPIRE-DT
 16065                                 TO DC-BIN-DATE-2
 16066              MOVE '1'           TO DC-OPTION-CODE
 16067              PERFORM 8500-DATE-CONVERT
 16068                                 THRU 8500-EXIT
 16069              IF NO-CONVERSION-ERROR
 16070                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16071                    MOVE ER-2661       TO WS-ERROR
 16072*                   PERFORM 9900-ERROR-FORMAT
 16073*                                THRU 9900-EXIT
 16074                 END-IF
 16075              END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16076           ELSE
 16077              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16078              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16079                 MOVE ER-2661    TO WS-ERROR
 16080*                PERFORM 9900-ERROR-FORMAT
 16081*                                THRU 9900-EXIT
 16082              ELSE
 16083                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16084                    MOVE ER-1570 TO WS-ERROR
 16085                    PERFORM 9900-ERROR-FORMAT
 16086                                 THRU 9900-EXIT
 16087                 END-IF
 16088              END-IF
 16089           END-IF
 16090
 16091           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16092              MOVE PB-I-JOINT-BIRTHDAY
 16093                                    TO DC-BIN-DATE-1
 16094              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16095              MOVE '1'              TO DC-OPTION-CODE
 16096              PERFORM 8500-DATE-CONVERT
 16097                                    THRU 8500-EXIT
 16098              IF NO-CONVERSION-ERROR
 16099                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16100                    MOVE ER-2661       TO WS-ERROR
 16101*                   PERFORM 9900-ERROR-FORMAT
 16102*                                   THRU 9900-EXIT
 16103                 END-IF
 16104              END-IF
 16105           ELSE
 16106              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16107                (PB-I-AH-TERM / 12)
 16108              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16109                 MOVE ER-2661       TO WS-ERROR
 16110*                PERFORM 9900-ERROR-FORMAT
 16111*                                   THRU 9900-EXIT
 16112              ELSE
 16113                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16114                    MOVE ER-1571 TO WS-ERROR
 16115                    PERFORM 9900-ERROR-FORMAT
 16116                                 THRU 9900-EXIT
 16117                 END-IF
 16118              END-IF
 16119           END-IF
 16120           IF WS-ERROR = ER-2661
 16121              PERFORM 9900-ERROR-FORMAT
 16122                                    THRU 9900-EXIT
 16123           END-IF
 16124        END-IF
 16125     END-IF
 16126
 16127*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16128*       NEXT SENTENCE                                             ELC50PD
 16129*    ELSE                                                         ELC50PD
 16130*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16131*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16132*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16133                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16134     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16135        NEXT SENTENCE                                             ELC50PD
 16136     ELSE                                                         ELC50PD
 16137        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16138           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16139           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16140                                                                  ELC50PD
 16141     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16142        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16143         PB-POLICY-IS-VOIDED                                      ELC50PD
 16144        NEXT SENTENCE                                             ELC50PD
 16145     ELSE                                                         ELC50PD
 16146        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
 16147           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16148           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16149                                                                  ELC50PD
 16150     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16151         IF WS-ERROR = ER-2667                                    ELC50PD
 16152             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16153                                                                  ELC50PD
 16154     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16155        NEXT SENTENCE                                             ELC50PD
 16156     ELSE                                                         ELC50PD
 16157        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16158           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16160                                                                  ELC50PD
 16161     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16162         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16163                                                                  ELC50PD
 16164 3321-CONTINUE.                                                   ELC50PD
 16165     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16166     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16167
 16168     IF (PB-COMPANY-ID = 'DCC')
 16169        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16170        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16171                                    PB-I-LF-ALT-PREM-CALC
 16172        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16173        IF WS-AH-BEN-CATEGORY = 'G'
 16174           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16175           + PB-I-ADDL-CLP)
 16176           * (1 + WS-TOL-CLP-PCT)
 16177*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16178        ELSE
 16179           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16180           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16181*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16182        END-IF
 16183        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16184                                 TO PB-I-AH-PREM-CALC
 16185        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16186           MOVE ER-8152          TO WS-ERROR
 16187           PERFORM 9900-ERROR-FORMAT
 16188                                 THRU 9900-EXIT
 16189        ELSE
 16190           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16191                 PB-I-ADDL-CLP)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16192              MOVE ER-8148       TO WS-ERROR
 16193              PERFORM 9900-ERROR-FORMAT
 16194                                 THRU 9900-EXIT
 16195           END-IF
 16196        END-IF
 16197     END-IF
 16198     IF (PB-COMPANY-ID = 'DCC')
 16199        AND (PB-I-POLICY-IS-MONTHLY)
 16200        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16201        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16202        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16203           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16204        END-IF
 16205     END-IF
 16206
 16207     IF (PB-COMPANY-ID = 'DCC')
 16208        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16209        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16210        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16211        MOVE ER-2786             TO WS-ERROR
 16212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16213     END-IF
 16214
 16215     MOVE +0                     TO PB-I-AH-CLP
 16216     IF PB-COMPANY-ID = 'DCC'
 16217        IF WS-AH-BEN-CATEGORY = 'D'
 16218           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16219              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16220        ELSE
 16221           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16222              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16223           END-IF
 16224        END-IF
 16225     END-IF
 16226
 16227     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16228                                                                  ELC50PD
 16229     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16230         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16231                                                                  ELC50PD
 16232     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16233         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16234                                                                  ELC50PD
 16235     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16236         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16237            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16238             NEXT SENTENCE                                        ELC50PD
 16239         ELSE                                                     ELC50PD
 16240             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16241                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16242                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16243             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16244                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16245                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16246                                                                  ELC50PD
 16247     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16248       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16249           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16250       ELSE
 16251         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16253                                                                  ELC50PD
 16254     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16255     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16256     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16257     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16258     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16259     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16260                                                                  ELC50PD
 16261     IF (PB-COMPANY-ID = 'DCC')
 16262        AND (WS-AH-BEN-CATEGORY = 'G')
 16263        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16264        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16265        IF CP-DEVIATION-CODE NOT = '000'
 16266           MOVE '000'            TO CP-DEVIATION-CODE
 16267           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16268           IF NO-CP-ERROR
 16269              COMPUTE PB-I-DDF-IU-RATE-UP =
 16270              PB-I-AH-CLP - CP-CALC-PREMIUM
 16271           ELSE
 16272              MOVE ER-3057        TO WS-ERROR
 16273              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16274           END-IF
 16275        END-IF
 16276     END-IF
 16277
 16278     .
 16279 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16280     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16281         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16282                                                                  ELC50PD
 16283     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16284     IF PB-COMPANY-ID = 'DCC'
 16285         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16286
 16287     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16288     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16289     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16290     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16291     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16292     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16293                                    CP-RATE-DEV-PCT.              ELC50PD
 16294*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16295     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16296     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16297     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16298     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16299                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16300     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16301         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16302                                         PB-I-AH-TERM.            ELC50PD
 16303     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16304     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16305     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16306     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16307     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16308     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16309                                    CP-REMAINING-TERM             ELC50PD
 16310                                    WS-WORK-TERM.                 ELC50PD
 16311     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16312
 16313     IF PB-COMPANY-ID = 'DCC'
 16314        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16315     END-IF
 16316
 16317     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16318         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16319            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16320                                                                  ELC50PD
 16321     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16322          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16323                                                                  ELC50PD
 16324     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16325                                                                  ELC50PD
 16326     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16327                                                                  ELC50PD
 16328     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16329                                                                  ELC50PD
 16330     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16331     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16332                                                                  ELC50PD
 16333     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16334         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16335         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16336         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16337                                                                  ELC50PD
 16338     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16339                                                                  ELC50PD
 16340     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16341     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16342                                                                  ELC50PD
 16343     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16344         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16346                                                                  ELC50PD
 16347                                                                  ELC50PD
 16348 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16349                                                                  ELC50PD
 16350     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16351         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16352             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16353             GO TO 3999-END-EDIT.                                 ELC50PD
 16354                                                                  ELC50PD
 16355     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16356                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16357                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16358                         OR 'AHL'
 16359         NEXT SENTENCE                                            ELC50PD
 16360     ELSE                                                         ELC50PD
 16361         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16362             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16363                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16364                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16365                                     PB-I-LF-PREM-CALC * .90      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16366                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16367                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16368                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16369                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16370                                                                  ELC50PD
 16371     IF PB-COMP-LF-PREM                                           ELC50PD
 16372        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16373        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16374                                                                  ELC50PD
 16375     IF PB-COMP-AH-PREM                                           ELC50PD
 16376        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16377                                                                  ELC50PD
 16378 3340-CHECK-DCC-TOT-FEES.
 16379
 16380     IF (PB-COMPANY-ID = 'DCC')
 16381        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16382        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16383        AND (PB-I-POLICY-IS-MONTHLY)
 16384        CONTINUE
 16385     ELSE
 16386        GO TO 3340-EDIT-LF-AH-TOL
 16387     END-IF
 16388
 16389     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16390     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16391
 16392     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16393        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16394           PB-I-RATE-DEV-PCT-LF
 16395     END-IF
 16396     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16397        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16398           PB-I-RATE-DEV-PCT-AH
 16399     END-IF
 16400     MOVE 'N'                    TO CP-BEN-CATEGORY
 16401
 16402     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16403                                                                  ELC50PD
 16404     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16405     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16406     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16407     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16408     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16409     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16410     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16411     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16412     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16413     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16414                                                                  ELC50PD
 16415     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16416     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16417     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16418     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16419     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16420     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16421                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16422     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16423         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16424                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16425     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16426     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16427     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16428     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16429     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16430     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16431     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16432     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16433     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16434                                    CP-REMAINING-TERM             ELC50PD
 16435                                    CP-LOAN-TERM.                 ELC50PD
 16436
 16437     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 16438        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 16439           PB-I-LF-PREMIUM-AMT
 16440     end-if
 16441                                                                  ELC50PD
 16442     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16443        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16444                                                                  ELC50PD
 16445     IF CP-TERM-IS-DAYS                                           ELC50PD
 16446         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16447     ELSE                                                         ELC50PD
 16448         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16449                                                                  ELC50PD
 16450
 16451     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16452
 16453     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16454         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16455                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16456         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16457
 16458     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16459     MOVE 'R'                    TO CP-RATE-FILE
 16460     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16461
 16462     IF NOT CP-ERROR-RATE-NOT-FOUND
 16463        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16464        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16465           AND (CP-BENEFIT-CD (1:1) = 'S')
 16466           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16467                                    PB-I-LF-PREMIUM-AMT
 16468        END-IF
 16469     ELSE
 16470        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16471     END-IF
 16472
 16473     .
 16474 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16475                                                                  ELC50PD
 16476***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16477***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16478***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16479***                                                               ELC50PD
 16480     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16481         PB-I-AH-PREMIUM-AMT                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16482          GIVING WS-CALC-WORK.                                    ELC50PD
 16483                                                                  ELC50PD
 16484     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16485        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16486         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16488                                                                  ELC50PD
 16489     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16490             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16491                 GIVING WS-UNSIGN-WRK1.                              CL**2
 16492                                                                     CL**2
 16493     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16494             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16495                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16496                                                                     CL**2
 16497     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16498                                + WS-UNSIGN-WRK4.                    CL**2
 16499                                                                     CL**2
 16500     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16501             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16502                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16503                                                                  ELC50PD
 16504******************************************************************ELC50PD
 16505*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16506******************************************************************ELC50PD
 16507                                                                  ELC50PD
 16508     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16509         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16510                                                                  ELC50PD
 16511     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16512         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16513                                                                  ELC50PD
 16514     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16515             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16516                                                                  ELC50PD
 16517 3342-CONTINUE.                                                   ELC50PD
 16518                                                                  ELC50PD
 16519     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16520         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16521         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16522            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16523              NEXT SENTENCE                                       ELC50PD
 16524         ELSE                                                     ELC50PD
 16525             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16526                                                                  ELC50PD
 16527     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16528         NEXT SENTENCE                                            ELC50PD
 16529     ELSE                                                         ELC50PD
 16530     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16531        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16532           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16533               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16534               PB-POLICY-IS-VOIDED)                               ELC50PD
 16535              NEXT SENTENCE                                       ELC50PD
 16536           ELSE                                                   ELC50PD
 16537              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16538                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16539                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16540                 GO TO 3344-CHECK-AH                              ELC50PD
 16541              ELSE                                                ELC50PD
 16542                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16544                 GO TO 3344-CHECK-AH.                             ELC50PD
 16545                                                                  ELC50PD
 16546***                                                               ELC50PD
 16547***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16548***                                                               ELC50PD
 16549                                                                  ELC50PD
 16550     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16551         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16552            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16553             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16554         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16555            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16556             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16557     ELSE                                                         ELC50PD
 16558         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16559         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16560                                                                  ELC50PD
 16561***                                                               ELC50PD
 16562***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16563***                                                               ELC50PD
 16564                                                                  ELC50PD
 16565     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16566         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16567          WS-TOL-LF-PREM.                                         ELC50PD
 16568                                                                  ELC50PD
 16569     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16570         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16571          WS-TOL-LF-PREM.                                         ELC50PD
 16572                                                                  ELC50PD
 16573     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16574        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16575                                                                  ELC50PD
 16576     IF PB-REISSUED-CERT
 16577        or PB-POLICY-IS-DECLINED
 16578        or PB-POLICY-IS-VOIDED
 16579        continue
 16580     ELSE
 16581        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16582              > WS-TOL-LF-HIGH-PREM-AMT)
 16583           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16584              < WS-TOL-LF-LOW-PREM-AMT))
 16585                      or
 16586           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16587              > WS-TOL-LF-HIGH-PREM-PCT)
 16588           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16589              < WS-TOL-LF-LOW-PREM-PCT))
 16590           IF WS-PREM-REJECT-SW = SPACE
 16591              MOVE ER-2652       TO WS-ERROR
 16592              PERFORM 9900-ERROR-FORMAT
 16593                                 THRU 9900-EXIT
 16594           ELSE
 16595              MOVE ER-2650       TO WS-ERROR
 16596              PERFORM 9900-ERROR-FORMAT
 16597                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16598           end-if
 16599        end-if
 16600     end-if
 16601                                                                  ELC50PD
 16602*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16603*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16604*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16605*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16606                                                                  ELC50PD
 16607     IF WS-ERROR  =  ER-2650  OR  ER-2652
 16608        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16609                      OR
 16610           ((PB-COMPANY-ID = 'DCC')
 16611           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16612           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16613           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16614        END-IF
 16615     END-IF
 16616                                                                  ELC50PD
 16617     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16618        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16619           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16620              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16621                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16622                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16623                 NEXT SENTENCE                                    ELC50PD
 16624              ELSE                                                ELC50PD
 16625                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16626                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16627                                                                  ELC50PD
 16628 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16629                                                                  ELC50PD
 16630      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16631          GO TO 3344-CHECK-AH.                                    ELC50PD
 16632                                                                  ELC50PD
 16633      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16634          GO TO 3344-CHECK-AH.                                    ELC50PD
 16635                                                                  ELC50PD
 16636      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16637                                     WS-UNSIGN-WRK6.              ELC50PD
 16638                                                                  ELC50PD
 16639      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16640          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16641                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16642                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16643                                                                  ELC50PD
 16644      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16645          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16646                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16647                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16648                                                                  ELC50PD
 16649      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16650          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16651              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16652                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16653                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16654              ELSE                                                ELC50PD
 16655                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16656                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16657                                                                  ELC50PD
 16658      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16659          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16660              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16661                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16662                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16663              ELSE                                                ELC50PD
 16664                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16665                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16666                                                                  ELC50PD
 16667 3344-CHECK-AH.                                                   ELC50PD
 16668                                                                  ELC50PD
 16669****************************************************************  ELC50PD
 16670***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16671***                                                               ELC50PD
 16672                                                                  ELC50PD
 16673     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16674         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16675             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16676         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16677             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16678     ELSE                                                         ELC50PD
 16679         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16680         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16681                                                                  ELC50PD
 16682***                                                               ELC50PD
 16683***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16684***                                                               ELC50PD
 16685                                                                  ELC50PD
 16686     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16687         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16688                                                                  ELC50PD
 16689     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16690         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16691                                                                  ELC50PD
 16692     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16693        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16694                                                                  ELC50PD
 16695     IF (PB-REISSUED-CERT)
 16696        OR (PB-POLICY-IS-DECLINED)
 16697        OR (PB-POLICY-IS-VOIDED)
 16698        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16699        CONTINUE
 16700     ELSE
 16701        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16702              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16703                          or
 16704           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16705              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16706           IF WS-PREM-REJECT-SW = SPACE
 16707              MOVE ER-3052       TO WS-ERROR
 16708              PERFORM 9900-ERROR-FORMAT
 16709                                 THRU 9900-EXIT
 16710           ELSE
 16711              MOVE ER-3050       TO WS-ERROR
 16712              PERFORM 9900-ERROR-FORMAT
 16713                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16714           END-IF
 16715        END-IF
 16716     END-IF
 16717
 16718     if (pb-company-id = 'DCC')
 16719        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16720        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16721        and (pb-i-policy-is-monthly)
 16722        compute ws-tol-ah-high-prem-amt =
 16723           pb-i-tot-fees-calc + ws-tol-ah-prem
 16724        compute ws-tol-ah-low-prem-amt =
 16725           pb-i-tot-fees-calc - ws-tol-ah-prem
 16726        if ws-tol-ah-prem-pct > zeros
 16727           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16728              (1 + ws-tol-ah-prem-pct)
 16729           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16730              (1 - ws-tol-ah-prem-pct)
 16731        else
 16732           move +9999999.99      to ws-tol-ah-high-prem-pct
 16733           move +0               to ws-tol-ah-low-prem-pct
 16734        end-if
 16735        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16736            or
 16737           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16738                          or
 16739           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16740           or
 16741           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16742            move er-3049         to ws-error
 16743           perform 9900-error-format
 16744                                 thru 9900-exit
 16745
 16746        end-if
 16747     end-if
 16748
 16749     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16750         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16751             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16752             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16753                                                                  ELC50PD
 16754     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16755        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16756           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16757              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16758                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16759                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16760                 NEXT SENTENCE                                    ELC50PD
 16761              ELSE                                                ELC50PD
 16762                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16763                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16764                                                                  ELC50PD
 16765     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16766        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16767           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16768                                                                  ELC50PD
 16769     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16770        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16771           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16772           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16773                                                                  ELC50PD
 16774 3345-EDIT-CONTINUE.                                              ELC50PD
 16775                                                                  ELC50PD
 16776*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16777*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16778*          IF PB-ISSUE                                            ELC50PD
 16779*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16780*          ELSE                                                   ELC50PD
 16781*              IF PB-CANCELLATION                                 ELC50PD
 16782*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16783                                                                  ELC50PD
 16784*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16785*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16786*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16787*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16788*        ELSE                                                     ELC50PD
 16789*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16790*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16791                                                                  ELC50PD
 16792     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16793        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16794           PB-REISSUED-CERT  OR                                   ELC50PD
 16795           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16796           PB-POLICY-IS-VOIDED                                    ELC50PD
 16797            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16798            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16799        ELSE                                                      ELC50PD
 16800            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16801            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16802                                                                  ELC50PD
 16803     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16804        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16805           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16806           PB-POLICY-IS-VOIDED                                    ELC50PD
 16807            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16808            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16809        ELSE                                                      ELC50PD
 16810            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16811                                      PB-I-ENTRY-STATUS.          ELC50PD
 16812                                                                  ELC50PD
 16813     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16814        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16815           PB-REISSUED-CERT  OR                                   ELC50PD
 16816           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16817           PB-POLICY-IS-VOIDED                                    ELC50PD
 16818            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16819            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16820        ELSE                                                      ELC50PD
 16821            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16822                                      PB-I-ENTRY-STATUS.          ELC50PD
 16823                                                                  ELC50PD
 16824     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16825        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16826        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16827
 16828     IF PB-COMPANY-ID = 'DCC'
 16829        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16830        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16831        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16832           AND (NOT WS-LF-CASH))
 16833                           OR
 16834           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16835           AND (NOT WS-AH-CASH)))
 16836                       AND
 16837           (PB-I-ENTRY-STATUS NOT = '5')
 16838           MOVE 'M'              TO PB-BATCH-ENTRY
 16839                                    PB-I-ENTRY-STATUS
 16840        END-IF
 16841     END-IF
 16842
 16843     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16844         GO TO 3999-END-EDIT.                                     ELC50PD
 16845                                                                  ELC50PD
 16846     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16847        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16848        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16849        PB-I-OB                                                   ELC50PD
 16850         GO TO 3999-END-EDIT.                                     ELC50PD
 16851                                                                  ELC50PD
 16852     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16853         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16854         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16855         GO TO 3999-END-EDIT.                                     ELC50PD
 16856                                                                  ELC50PD
 16857     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16858     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16859                                                                  ELC50PD
 16860     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16861         GO TO 3999-END-EDIT.                                     ELC50PD
 16862                                                                  ELC50PD
 16863     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16864                                      FORM-MASTER-AH-SW.          ELC50PD
 16865                                                                  ELC50PD
 16866     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16867         MOVE  +1                 TO SUB6                         ELC50PD
 16868         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16869                                                                  ELC50PD
 16870     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16871         MOVE  +1                 TO SUB6                         ELC50PD
 16872         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16873                                                                  ELC50PD
 16874     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16875        AH-FORM-MASTER-FOUND                                      ELC50PD
 16876         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16877     ELSE                                                         ELC50PD
 16878         GO TO 3999-END-EDIT.                                     ELC50PD
 16879                                                                  ELC50PD
 16880******************************************************************ELC50PD
 16881*                  3350-GET-ERFORM                               *ELC50PD
 16882*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16883*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16884******************************************************************ELC50PD
 16885                                                                  ELC50PD
 16886 3350-GET-ERFORM.                                                 ELC50PD
 16887                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16888     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16889         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16890                                                                  ELC50PD
 16891     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16892     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16893     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16894     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16895                                                                  ELC50PD
 16896     IF PB-CANCELLATION                                           ELC50PD
 16897         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16898            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16899            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16900              GO TO 3350-EXIT                                     ELC50PD
 16901         ELSE                                                     ELC50PD
 16902             NEXT SENTENCE                                        ELC50PD
 16903     ELSE                                                         ELC50PD
 16904         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16905            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16906            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16907              GO TO 3350-EXIT.                                    ELC50PD
 16908                                                                  ELC50PD
 16909 3350-ERFORM-GETMAIN.                                             ELC50PD
 16910                                                                  ELC50PD
 16911     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16912     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16913                                                                  ELC50PD
 16914 3350-ERFORM-READ.                                                ELC50PD
 16915                                                                  ELC50PD
 16916     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16917     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16918     IF PB-CANCELLATION                                           ELC50PD
 16919         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16920     ELSE                                                         ELC50PD
 16921         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16922     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16923                                                                  ELC50PD
 16924     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16925                                                                  ELC50PD
 16926     IF FORM-MASTER-FOUND                                         ELC50PD
 16927       IF PB-CANCELLATION                                         ELC50PD
 16928          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16929             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16930             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16931              GO  TO 3350-EXIT                                    ELC50PD
 16932          ELSE                                                    ELC50PD
 16933              NEXT SENTENCE                                       ELC50PD
 16934       ELSE                                                       ELC50PD
 16935          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16936             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16937             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16938              GO  TO 3350-EXIT.                                   ELC50PD
 16939                                                                  ELC50PD
 16940     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16941     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16942     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16943                                                                  ELC50PD
 16944 3350-EXIT.                                                       ELC50PD
 16945      EXIT.                                                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16946                                                                  ELC50PD
 16947******************************************************************ELC50PD
 16948*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16949*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16950*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16951******************************************************************ELC50PD
 16952                                                                  ELC50PD
 16953 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16954                                                                  ELC50PD
 16955     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
 16956        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16957         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16958         GO TO   3355-EXIT.                                       ELC50PD
 16959                                                                  ELC50PD
 16960     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16961         ADD  +1      TO  SUB6                                    ELC50PD
 16962         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16963                                                                  ELC50PD
 16964     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16965     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16966                                                                  ELC50PD
 16967 3355-EXIT.                                                       ELC50PD
 16968      EXIT.                                                       ELC50PD
 16969                                                                  ELC50PD
 16970******************************************************************ELC50PD
 16971*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16972*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16973*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16974******************************************************************ELC50PD
 16975                                                                  ELC50PD
 16976 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16977                                                                  ELC50PD
 16978     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16979        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16980         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16981         GO TO  3356-EXIT.                                        ELC50PD
 16982                                                                  ELC50PD
 16983      IF  SUB6    LESS THAN     +40                               ELC50PD
 16984          ADD  +1      TO  SUB6                                   ELC50PD
 16985          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16986                                                                  ELC50PD
 16987     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16988     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16989                                                                  ELC50PD
 16990 3356-EXIT.                                                       ELC50PD
 16991      EXIT.                                                       ELC50PD
 16992                                                                  ELC50PD
 16993******************************************************************ELC50PD
 16994*                  3357-BENEFIT-SEARCH                           *ELC50PD
 16995*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 16996*   CANCELLATIONS ONLY.                                          *ELC50PD
 16997******************************************************************ELC50PD
 16998 3357-BENEFIT-SEARCH.                                             ELC50PD
 16999     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 17000         MOVE +1                          TO SUB6                 ELC50PD
 17001         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 17002                                                                  ELC50PD
 17003     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17004         MOVE +1                          TO SUB6                 ELC50PD
 17005         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 17006                                                                  ELC50PD
 17007 3357-EXIT.                                                       ELC50PD
 17008     EXIT.                                                        ELC50PD
 17009                                                                  ELC50PD
 17010******************************************************************ELC50PD
 17011*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 17012*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17013*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17014*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17015******************************************************************ELC50PD
 17016 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 17017     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 17018       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 17019         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17020           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17021              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17022                     IS GREATER THAN SPACES                       ELC50PD
 17023                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17024                                          WS-LF-REFUND-CALC       ELC50PD
 17025                 GO TO 3358-EXIT.                                 ELC50PD
 17026                                                                  ELC50PD
 17027     IF SUB6 LESS THAN +40                                        ELC50PD
 17028         ADD +1                 TO SUB6                           ELC50PD
 17029         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 17030                                                                  ELC50PD
 17031 3358-EXIT.                                                       ELC50PD
 17032     EXIT.                                                        ELC50PD
 17033******************************************************************ELC50PD
 17034*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 17035*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17036*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17037*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17038******************************************************************ELC50PD
 17039 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 17040     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 17041       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 17042         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17043           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17044              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17045                      IS GREATER THAN SPACES                      ELC50PD
 17046                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17047                                          WS-AH-REFUND-CALC       ELC50PD
 17048                 GO TO 3359-EXIT.                                 ELC50PD
 17049                                                                  ELC50PD
 17050     IF SUB6 LESS THAN +40                                        ELC50PD
 17051         ADD +1                 TO SUB6                           ELC50PD
 17052         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 17053                                                                  ELC50PD
 17054 3359-EXIT.                                                       ELC50PD
 17055     EXIT.                                                        ELC50PD
 17056                                                                  ELC50PD
 17057******************************************************************ELC50PD
 17058*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 17059*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17060*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17061******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17062                                                                  ELC50PD
 17063 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 17064                                                                  ELC50PD
 17065     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 17066         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17067                                                                  ELC50PD
 17068     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17069         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17070                                                                  ELC50PD
 17071 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
 17072                                                                  ELC50PD
 17073     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17074       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17075        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17076        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17077         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17078            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17079            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17080         ELSE                                                     ELC50PD
 17081            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17082            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17083                                                                  ELC50PD
 17084 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17085                                                                  ELC50PD
 17086     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17087                                                                  ELC50PD
 17088     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17089         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17090         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17091            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17092                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17093                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17094            ELSE                                                  ELC50PD
 17095                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17096                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17097                                                                  ELC50PD
 17098 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17099                                                                  ELC50PD
 17100     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17101         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17102         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17103            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17104                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17105                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17106            ELSE                                                  ELC50PD
 17107                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17108                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17109                                                                  ELC50PD
 17110 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17111                                                                  ELC50PD
 17112     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17113         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17114         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17115           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17116               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17117               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17118           ELSE                                                   ELC50PD
 17119               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17120               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17121                                                                  ELC50PD
 17122     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17123                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17124                                                                  ELC50PD
 17125     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17126         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17127         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17128             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17129                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
 17130                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17131             ELSE                                                 ELC50PD
 17132                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17133                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17134                                                                  ELC50PD
 17135******************************************************************ELC50PD
 17136*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17137*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17138*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17139******************************************************************ELC50PD
 17140                                                                  ELC50PD
 17141 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17142                                                                  ELC50PD
 17143     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17144         GO TO 3999-END-EDIT.                                     ELC50PD
 17145                                                                  ELC50PD
 17146 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17147                                                                  ELC50PD
 17148     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17149       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17150        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17151        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17152         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17153            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17154            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17155         ELSE                                                     ELC50PD
 17156            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17157            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17158                                                                  ELC50PD
 17159 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17160                                                                  ELC50PD
 17161     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17162                                                                  ELC50PD
 17163     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17164         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17165         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17166            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17167                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17168                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17169            ELSE                                                  ELC50PD
 17170                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17171                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17172                                                                  ELC50PD
 17173 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17174                                                                  ELC50PD
 17175     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17176         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17177         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17178            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17179                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17180                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17181            ELSE                                                  ELC50PD
 17182                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17183                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17184                                                                  ELC50PD
 17185 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17186                                                                  ELC50PD
 17187     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
 17188         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17189         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17190             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17191                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17192                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17193             ELSE                                                 ELC50PD
 17194                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17195                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17196                                                                  ELC50PD
 17197     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17198         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17199         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17200             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17201                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17202                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17203             ELSE                                                 ELC50PD
 17204                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17205                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17206                                                                  ELC50PD
 17207     GO TO 3999-END-EDIT.                                         ELC50PD
 17208                                                                  ELC50PD
 17209******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17211******************************************************************ELC50PD
 17212*                  E D I T   C A N C E L                         *ELC50PD
 17213******************************************************************ELC50PD
 17214                                                                  ELC50PD
 17215 3700-EDIT-CANCEL.                                                ELC50PD
 17216     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17217         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17218                                         WS-RES-MUNI-TAX          ELC50PD
 17219                                         PB-CI-STATE-TAX          ELC50PD
 17220                                         PB-CI-MUNI-TAX           ELC50PD
 17221         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17222                                                                  ELC50PD
 17223*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17224*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17225*          IF PB-CANCELLATION                                     ELC50PD
 17226*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17227*          ELSE                                                   ELC50PD
 17228*             IF PB-ISSUE                                         ELC50PD
 17229*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17230                                                                  ELC50PD
 17231     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17232        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17233     END-IF
 17234
 17235*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17236*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17237                                                                  ELC50PD
 17238     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17239        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17241        GO TO 3999-END-EDIT.                                      ELC50PD
 17242                                                                  ELC50PD
 17243     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17244        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17246        GO TO 3999-END-EDIT.                                      ELC50PD
 17247                                                                  ELC50PD
 17248     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17249        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17251                                                                  ELC50PD
 17252***************************************************************   ELC50PD
 17253*                                                             *   ELC50PD
 17254*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17255*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17256*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17257*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17258*                                                             *   ELC50PD
 17259***************************************************************   ELC50PD
 17260                                                                  ELC50PD
 17261     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17262                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17263                                                                  ELC50PD
 17264     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17265        NEXT SENTENCE                                             ELC50PD
 17266     ELSE                                                         ELC50PD
 17267        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17268           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17269           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17270               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17271               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17272               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17273                                                                  ELC50PD
 17274     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17275        NEXT SENTENCE                                             ELC50PD
 17276     ELSE                                                         ELC50PD
 17277        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17278           AND                                                    ELC50PD
 17279           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17280               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17281               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17282               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17283                                                                  ELC50PD
 17284     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17285        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17286                                                                  ELC50PD
 17287     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17288     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17289     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17290     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17291     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17292     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17293                                                                  ELC50PD
 17294     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17295                                      PB-C-AH-REF-CALC.           ELC50PD
 17296     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17297                                                                  ELC50PD
 17298******************************************************************ELC50PD
 17299*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17300*             TO VALIDATE COVERAGE.                              *ELC50PD
 17301******************************************************************ELC50PD
 17302                                                                  ELC50PD
 17303     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17304        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17305          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17306      ELSE                                                        ELC50PD
 17307          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17308                                                                  ELC50PD
 17309     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17310        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17311          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17312      ELSE                                                        ELC50PD
 17313          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17314                                                                  ELC50PD
 17315     EVALUATE TRUE                                                ELC50PD
 17316         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17317              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17318              PB-FORCE-OFF                                        ELC50PD
 17319                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17320                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17321                  END-IF                                          ELC50PD
 17322         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17323               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17324              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17325                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17326         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17327              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17328                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17329              ELSE                                                ELC50PD
 17330                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17331              END-IF                                              ELC50PD
 17332              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17333     END-EVALUATE.                                                ELC50PD
 17334                                                                  ELC50PD
 17335                                                                  ELC50PD
 17336*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17337*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17338*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17339*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17340*        ELSE                                                     ELC50PD
 17341*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17342                                                                  ELC50PD
 17343     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17344     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17345        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17346     ELSE
 17347        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17348     END-IF
 17349     .
 17350 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17351                                                                  ELC50PD
 17352     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17353        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17354         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17355         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17356                                 TO DC-BIN-DATE-2                 ELC50PD
 17357         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17358*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17359         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17360         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17361            NEXT SENTENCE                                         ELC50PD
 17362          ELSE                                                    ELC50PD
 17363             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17364                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17365                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17366                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17367                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17368                 ELSE                                             ELC50PD
 17369                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17370                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17371                                                                  ELC50PD
 17372     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17373        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17374         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17375         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17376                                 TO DC-BIN-DATE-2                 ELC50PD
 17377         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17378*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17379         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17380         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17381            NEXT SENTENCE                                         ELC50PD
 17382          ELSE                                                    ELC50PD
 17383             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17384                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17385                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17386                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17387                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17388                 ELSE                                             ELC50PD
 17389                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17390                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17391                                                                  ELC50PD
 17392     IF WS-ERROR = ER-2752                                        ELC50PD
 17393        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17394         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17395         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17396         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17397         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17398         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17399         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17400         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17401         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17402         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17403         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17404         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17405         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17406         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17407         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17408            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17409            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17410            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17411                                                                  ELC50PD
 17412     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17413        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17414        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17415             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17417                                                                  ELC50PD
 17418     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17419        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17420        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17421              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17422              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17423                                                                  ELC50PD
 17424     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17425        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17426        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17427           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17428            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17429              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17430               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17431               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17432                                                                  ELC50PD
 17433     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17434         GO TO 3999-END-EDIT.                                     ELC50PD
 17435                                                                  ELC50PD
 17436     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17437        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17438           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17439            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17440            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17441                                 TO DC-BIN-DATE-2                 ELC50PD
 17442            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17443*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17444            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17445            IF DATE-CONVERSION-ERROR                              ELC50PD
 17446               NEXT SENTENCE                                      ELC50PD
 17447             ELSE                                                 ELC50PD
 17448                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17449                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17450                                                                  ELC50PD
 17451     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17452        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17453           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17454            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17455            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17456                                 TO DC-BIN-DATE-2                 ELC50PD
 17457            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17458                                    DC-ELAPSED-MONTHS             ELC50PD
 17459            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17460*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17461            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17462            IF DATE-CONVERSION-ERROR                              ELC50PD
 17463               NEXT SENTENCE                                      ELC50PD
 17464             ELSE                                                 ELC50PD
 17465                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17466                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17467                                                                  ELC50PD
 17468     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17469                                    DC-ELAPSED-MONTHS.            ELC50PD
 17470                                                                  ELC50PD
 17471     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17472        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17473          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17474          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17475          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17476          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17477          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17478          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17479        ELSE                                                      ELC50PD
 17480          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17481                                     PB-C-LIVES                   ELC50PD
 17482          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17483             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17484                                                                  ELC50PD
 17485     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17486         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17487     ELSE                                                         ELC50PD
 17488         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17489                                                                  ELC50PD
 17490     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17491        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17492            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17493            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17494                                                                  ELC50PD
 17495     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17496        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17497         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17498            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17499               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17500               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17501                                                                  ELC50PD
 17502     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17503        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17504         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17505            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17506               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17507               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17508                                                                  ELC50PD
 17509     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17510        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17511         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17512            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17513            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17514                                                                  ELC50PD
 17515     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17516        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17517         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17518            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17519            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17520                                                                  ELC50PD
 17521     IF LF-COVERAGE-CANCELLED
 17522        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17523        if pb-ci-lf-expire-dt = low-values or spaces
 17524           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17525           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 17526           MOVE PB-CI-EXTENTION-DAYS
 17527                                 TO DC-ELAPSED-DAYS
 17528           SET BIN-PLUS-ELAPSED  TO TRUE
 17529           PERFORM 8500-DATE-CONVERT
 17530                                 THRU 8500-EXIT
 17531           IF DATE-CONVERSION-ERROR
 17532              move low-values    to dc-bin-date-2
 17533           end-if
 17534        else
 17535           move pb-ci-lf-expire-dt
 17536                                 to dc-bin-date-2
 17537        end-if
 17538        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 17539           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17540                             OR  'FIA'
 17541              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 17542           ELSE
 17543              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17544              MOVE ER-2731       TO WS-ERROR
 17545              PERFORM 9900-ERROR-FORMAT
 17546                                 THRU 9900-EXIT
 17547           end-if
 17548        end-if
 17549     end-if
 17550
 17551*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17552*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17553*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17554*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17555*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17556*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17557*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17558*        IF DATE-CONVERSION-ERROR                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17559*           NEXT SENTENCE                                         ELC50PD
 17560*         ELSE                                                    ELC50PD
 17561*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17562*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17563*                            OR  'FIA'                            ELC50PD
 17564*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17565*              ELSE                                               ELC50PD
 17566*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17567*               MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17568*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17569     .
 17570 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17571
 17572     IF AH-COVERAGE-CANCELLED
 17573        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 17574        if pb-ci-AH-expire-dt = low-values or spaces
 17575           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17576           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 17577           MOVE PB-CI-EXTENTION-DAYS
 17578                                 TO DC-ELAPSED-DAYS
 17579           SET BIN-PLUS-ELAPSED  TO TRUE
 17580           PERFORM 8500-DATE-CONVERT
 17581                                 THRU 8500-EXIT
 17582           IF DATE-CONVERSION-ERROR
 17583              move low-values    to dc-bin-date-2
 17584           end-if
 17585        else
 17586           move pb-ci-ah-expire-dt
 17587                                 to dc-bin-date-2
 17588        end-if
 17589        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 17590           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17591                             OR  'FIA'
 17592              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 17593           ELSE
 17594              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17595              MOVE ER-2771       TO WS-ERROR
 17596              PERFORM 9900-ERROR-FORMAT
 17597                                 THRU 9900-EXIT
 17598           end-if
 17599        end-if
 17600     end-if
 17601
 17602*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17603*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17604*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17605*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17606*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17607**       MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17608*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17609*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17610*        IF DATE-CONVERSION-ERROR                                 ELC50PD
 17611*           NEXT SENTENCE                                         ELC50PD
 17612*         ELSE                                                    ELC50PD
 17613*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17614*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17615*                             OR 'FIA'                            ELC50PD
 17616*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17617*             ELSE                                                ELC50PD
 17618*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17619*              MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17620*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17621     .
 17622 3705-EDIT-CONTINUED.                                             ELC50PD
 17623                                                                  ELC50PD
 17624*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17625*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17626*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17627*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17628*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17629*                                                                 ELC50PD
 17630*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17631*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17632*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17633*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17634*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17635*        ELSE                                                     ELC50PD
 17636*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17637*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17638*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17639                                                                  ELC50PD
 17640     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17641       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17642         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17643           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17644              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17645              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17646                                                                  ELC50PD
 17647     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17648        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17649            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17650            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17651            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17652                                                                  ELC50PD
 17653     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17654            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17655            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17656                                                                  ELC50PD
 17657     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17658         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17659            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17660            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17661                                                                  ELC50PD
 17662 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17663                                                                  ELC50PD
 17664     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17665         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17666             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17667                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17668                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17669                                                                  ELC50PD
 17670     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17671         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17672             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17673                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17674                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17675                                                                  ELC50PD
 17676 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17677                                                                  ELC50PD
 17678*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17679*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17680*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17681*           (NOT PB-CI-OB)                                        ELC50PD
 17682*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17683*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17684*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17685*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17686*                                                                 ELC50PD
 17687*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17688*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17689*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17690*           (NOT PB-CI-OB)                                        ELC50PD
 17691*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17692*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17693*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17694*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17695                                                                  ELC50PD
 17696     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17697         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17698            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17699             NEXT SENTENCE                                        ELC50PD
 17700         ELSE                                                     ELC50PD
 17701           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17702              NEXT SENTENCE                                       ELC50PD
 17703           ELSE                                                   ELC50PD
 17704              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17705              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17706                                                                  ELC50PD
 17707     IF CANCEL-FUTURE-DT                                          ELC50PD
 17708         GO TO 3999-END-EDIT.                                     ELC50PD
 17709                                                                  ELC50PD
 17710 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17711                                                                  ELC50PD
 17712     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17713        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17714        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17715                                                                  ELC50PD
 17716     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17717     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17718     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17719     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17720     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17721     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17722     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17723     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17724     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17725     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17726     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17727     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17728
 17729     IF (PB-COMPANY-ID = 'CID')
 17730        AND (CP-STATE-STD-ABBRV = 'WI')
 17731        MOVE '7'                 TO CP-REM-TERM-METHOD
 17732        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17733     ELSE
 17734        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17735        MOVE WS-REM-TRM-CALC-OPTION
 17736                                 TO CP-REM-TRM-CALC-OPTION
 17737     END-IF
 17738
 17739**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17740     IF (PB-COMPANY-ID = 'CID')
 17741        AND (CP-STATE-STD-ABBRV = 'MO')
 17742        AND (PB-CERT-EFF-DT >= X'9B41')
 17743        AND (PB-CERT-EFF-DT <= X'A2FB')
 17744        MOVE '7'                 TO CP-REM-TERM-METHOD
 17745        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17746     END-IF
 17747
 17748     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17749                                    CP-LOAN-TERM.                 ELC50PD
 17750     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17751        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17752                                                                  ELC50PD
 17753     IF CP-TERM-IS-DAYS                                           ELC50PD
 17754         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17755     ELSE                                                         ELC50PD
 17756         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17757                                                                  ELC50PD
 17758     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17759                                                                  ELC50PD
 17760     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17761                                                                  ELC50PD
 17762     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17763        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17764        NEXT SENTENCE                                             ELC50PD
 17765      ELSE                                                        ELC50PD
 17766          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17767                                                                  ELC50PD
 17768 3720-GET-LF-REFUND.                                              ELC50PD
 17769                                                                  ELC50PD
 17770     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17771        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17772        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17773                                                                  ELC50PD
 17774     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17775         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17776         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17777         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17778                                                                  ELC50PD
 17779     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17780        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17781         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17783         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17784         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17785         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17786                                                                  ELC50PD
 17787*    if (ws-lf-earnings-calc = '6')
 17788*       or (pb-c-lf-refund-override = '6')
 17789*       move cp-remaining-term-1 to cp-remaining-term-2
 17790*    end-if
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17791     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17792                                                                     CL**2
 17793     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17794     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17795     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17796     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17797     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17798     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17799
 17800     IF (PB-COMPANY-ID = 'DCC')
 17801        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17802
 17803        IF PDEF-MASTER-FOUND
 17804           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17805              (V1 > +8)
 17806              OR (PD-PROD-CODE (V1) = 'L')
 17807           END-PERFORM
 17808           IF V1 < +9
 17809              MOVE PD-MAX-AMT (V1)
 17810                           TO CP-R-MAX-TOT-BEN
 17811                              EC-AM-LF-MAX-TOT-BEN
 17812           END-IF
 17813        ELSE
 17814
 17815        MOVE ' '                 TO PDEF-MASTER-SW
 17816        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17817        MOVE PB-STATE            TO ERPDEF-STATE
 17818        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17819        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17820        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17821        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17822        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17823        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17824        IF PDEF-MASTER-FOUND
 17825           MOVE 'N'              TO PDEF-MASTER-SW
 17826           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17827           IF PDEF-MASTER-FOUND
 17828              IF (ERPDEF-KEY-SAVE (1:16) =
 17829                           PD-CONTROL-PRIMARY (1:16))
 17830                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17831                 CONTINUE
 17832              ELSE
 17833                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17834                 IF (ERPDEF-KEY-SAVE (1:16) =
 17835                           PD-CONTROL-PRIMARY (1:16))
 17836                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17837                    CONTINUE
 17838                 ELSE
 17839                    MOVE 'N'     TO PDEF-MASTER-SW
 17840                 END-IF
 17841              END-IF
 17842              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17843
 17844              IF PDEF-MASTER-FOUND
 17845                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17846                    (V1 > +8)
 17847                    OR (PD-PROD-CODE (V1) = 'L')
 17848                 END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17849                 IF V1 < +9
 17850                    MOVE PD-MAX-AMT (V1)
 17851                                 TO CP-R-MAX-TOT-BEN
 17852                                    EC-AM-LF-MAX-TOT-BEN
 17853                 END-IF
 17854              END-IF
 17855           END-IF
 17856           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17857        END-IF
 17858        END-IF
 17859     END-IF
 17860
 17861     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17862                                                                  ELC50PD
 17863     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17864                                                                  ELC50PD
 17865     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17866                                    PB-C-LF-REM-TERM.                CL**2
 17867                                                                     CL**2
 17868     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17869     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17870                                                                  ELC50PD
 17871     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17872        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17873           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17874           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17875                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17876                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17877           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17878              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17879              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17880           ELSE                                                   ELC50PD
 17881              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17882                                                                  ELC50PD
 17883     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17884                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17885                            OR '9' OR 'G'
 17886        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17887                                 TO CP-EARNING-METHOD.            ELC50PD
 17888                                                                  ELC50PD
 17889     if pb-company-id = 'AHL'
 17890        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17891        if cp-class-code = spaces
 17892           move zeros            to cp-class-code
 17893        end-if
 17894     ELSE
 17895        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17896     END-IF
 17897
 17898*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17899     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17900     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17901                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17902     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17903         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17904                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17905     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17906     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17907     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17908     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17909     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17910     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17911     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17912     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17913         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17914                                                                  ELC50PD
 17915****   N O T E   ****
 17916*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17917*      THE OH HARD CODING IN ELCRFNDP
 17918
 17919     IF PB-COMPANY-ID = 'CID'
 17920        IF CP-STATE-STD-ABBRV = 'OH'
 17921           MOVE WS-LF-EARNINGS-CALC
 17922                                 TO CP-EARNING-METHOD
 17923        END-IF
 17924     END-IF
 17925
 17926****   N O T E   ****
 17927
 17928     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17929         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17930            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17931                MOVE WS-DEFAULT-APR                               ELC50PD
 17932                                 TO  CP-LOAN-APR                  ELC50PD
 17933                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17934                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17935            ELSE                                                  ELC50PD
 17936                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17937                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17938
 17939*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17940
 17941     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17942                                                                  ELC50PD
 17943     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17944         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17945                                                                  ELC50PD
 17946     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17947        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17948        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17949        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17950                                                                  ELC50PD
 17951     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17952        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17954                                                                  ELC50PD
 17955     IF PB-COMPANY-ID = 'DCC'
 17956        AND PB-CI-ENTRY-STATUS = 'M'
 17957        MOVE +0                  TO PB-C-LF-REF-CALC
 17958     ELSE
 17959        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17960     END-IF
 17961                                                                  ELC50PD
 17962     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17963         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17964                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17965*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17966*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17967*                                   CP-REMAINING-TERM             ELC50PD
 17968*                                   CP-ORIGINAL-TERM.             ELC50PD
 17969                                                                  ELC50PD
 17970     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17971     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17972                                    CP-RATING-METHOD.             ELC50PD
 17973
 17974     IF PB-COMPANY-ID = 'CID'
 17975        IF (CP-STATE-STD-ABBRV = 'MN')
 17976           AND (PB-CERT-EFF-DT > X'A4FF')
 17977           AND (WS-LF-EARNINGS-CALC = 'B')
 17978           MOVE '5'              TO CP-EARNING-METHOD
 17979           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17980        END-IF
 17981     END-IF
 17982
 17983     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17984                                        CP-REMAINING-BENEFIT      ELC50PD
 17985                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17986     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17987         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17988                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17989     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17990     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17991                                                                  ELC50PD
 17992     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17993                                                                  ELC50PD
 17994     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17995        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17996        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17998                                                                  ELC50PD
 17999     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18000        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18002                                                                  ELC50PD
 18003     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 18004                                                                  ELC50PD
 18005******************************************************************ELC50PD
 18006                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18008 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 18009     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 18010        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 18011         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18012                                                                  ELC50PD
 18013     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 18014         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 18015            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 18016             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 18017                                                                  ELC50PD
 18018     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 18019     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 18020     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 18021     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 18022     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 18023     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 18024     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 18025     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 18026     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 18027     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 18028     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 18029     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 18030
 18031     IF (PB-COMPANY-ID = 'CID')
 18032        AND (CP-STATE-STD-ABBRV = 'WI')
 18033        MOVE '7'                 TO CP-REM-TERM-METHOD
 18034        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18035     ELSE
 18036        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 18037        MOVE WS-REM-TRM-CALC-OPTION
 18038                                 TO CP-REM-TRM-CALC-OPTION
 18039     END-IF
 18040
 18041     IF (PB-COMPANY-ID = 'CID')
 18042        AND (CP-STATE-STD-ABBRV = 'MO')
 18043        AND (PB-CERT-EFF-DT >= X'9B41')
 18044        AND (PB-CERT-EFF-DT <= X'A2FB')
 18045        MOVE '7'                 TO CP-REM-TERM-METHOD
 18046        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18047     END-IF
 18048
 18049     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 18050                                    CP-LOAN-TERM.                 ELC50PD
 18051     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 18052         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 18053                                                                  ELC50PD
 18054     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 18055                                                                  ELC50PD
 18056     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 18057                                                                  ELC50PD
 18058     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 18059        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 18060        NEXT SENTENCE                                             ELC50PD
 18061      ELSE                                                        ELC50PD
 18062         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18063                                                                  ELC50PD
 18064 3740-GET-AH-REFUND.                                              ELC50PD
 18065                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18066     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 18067        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18068        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18069                                                                  ELC50PD
 18070     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 18071         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 18072         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18073                                                                  ELC50PD
 18074     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 18075*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 18076     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 18077     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 18078     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 18079                                    PB-C-AH-REM-TERM.             ELC50PD
 18080     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 18081     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 18082                                                                  ELC50PD
 18083     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 18084        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 18085           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 18086           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 18087                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 18088           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 18089              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 18090              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 18091           ELSE                                                   ELC50PD
 18092              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 18093                                                                  ELC50PD
 18094     IF PB-COMPANY-ID = 'DCC'
 18095        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18096            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 18097           MOVE 'S'              TO CP-EARNING-METHOD
 18098        END-IF
 18099     END-IF
 18100
 18101     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 18102                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 18103                            OR '9' OR 'G' OR 'S'
 18104        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 18105                                 TO CP-EARNING-METHOD.            ELC50PD
 18106                                                                  ELC50PD
 18107     if pb-company-id = 'AHL'
 18108        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 18109        if cp-class-code = spaces
 18110           move zeros            to cp-class-code
 18111        end-if
 18112     ELSE
 18113        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 18114     END-IF
 18115*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 18116     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 18117     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 18118                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 18119     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18120         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 18121                                         PB-CI-AH-TERM.           ELC50PD
 18122     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 18123     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18124     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 18125     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 18126     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 18127     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 18128                                                                  ELC50PD
 18129     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18130        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18131                                AND 'CID' AND 'DCC' AND 'AHL')
 18132           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18133              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18134              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18135              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18136           END-IF
 18137        END-IF
 18138        IF PB-COMPANY-ID = 'CID'
 18139           IF NO-LIFE-COVERAGE
 18140              IF CP-CRITICAL-PERIOD
 18141                 MOVE '2'       TO CP-EARNING-METHOD
 18142              ELSE
 18143                 MOVE '6'       TO CP-EARNING-METHOD
 18144              END-IF
 18145           ELSE
 18146              IF WS-LF-COVERAGE-TYPE = 'L'
 18147                 MOVE '2'       TO CP-EARNING-METHOD
 18148              ELSE
 18149                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18150                    (WS-LF-EARNINGS-CALC = '5')
 18151                    IF CP-CRITICAL-PERIOD
 18152                       MOVE '2'  TO CP-EARNING-METHOD
 18153                    ELSE
 18154                       MOVE '6'  TO CP-EARNING-METHOD
 18155                    END-IF
 18156                 ELSE
 18157                    MOVE '1'     TO CP-EARNING-METHOD
 18158                 END-IF
 18159              END-IF
 18160           END-IF
 18161        END-IF
 18162     END-IF
 18163                                                                  ELC50PD
 18164*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18165*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18166*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18167*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18168*          ELSE                                                   ELC50PD
 18169*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18170                                                                  ELC50PD
 18171     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18172         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18173                                                                  ELC50PD
 18174     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18175         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18176            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18177                MOVE WS-DEFAULT-APR                               ELC50PD
 18178                                 TO  CP-LOAN-APR                  ELC50PD
 18179                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18180                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18181            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18182                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18183                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18184
 18185     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18186
 18187
 18188     IF PB-COMPANY-ID = 'DCC'
 18189        AND CP-CANCEL-REASON = 'R'
 18190        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18191        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18192     END-IF
 18193
 18194     IF PB-COMPANY-ID = 'DCC'
 18195        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18196        AND (CP-EARNING-METHOD = 'D')
 18197        AND (CP-CANCEL-REASON NOT = 'R')
 18198        CONTINUE
 18199     ELSE
 18200        GO TO 3750-CONTINUE
 18201     END-IF
 18202
 18203     MOVE ' '                    TO DD-IU-SW
 18204     IF NOT PDEF-MASTER-FOUND
 18205        MOVE ' '                 TO PDEF-MASTER-SW
 18206        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18207        MOVE PB-STATE            TO ERPDEF-STATE
 18208        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18209        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18210        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18211        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18212        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18213        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18214        IF PDEF-MASTER-FOUND
 18215           MOVE 'N'              TO PDEF-MASTER-SW
 18216           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18217           IF PDEF-MASTER-FOUND
 18218              IF (ERPDEF-KEY-SAVE (1:16) =
 18219                           PD-CONTROL-PRIMARY (1:16))
 18220                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18221                 CONTINUE
 18222              ELSE
 18223                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18224                 IF (ERPDEF-KEY-SAVE (1:16) =
 18225                           PD-CONTROL-PRIMARY (1:16))
 18226                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18227                    CONTINUE
 18228                 ELSE
 18229                    MOVE ER-2740 TO WS-ERROR
 18230                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18231                    GO TO 3770-CHECK-REFUNDS
 18232                 END-IF
 18233              END-IF
 18234           END-IF
 18235           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18236        END-IF
 18237     END-IF
 18238
 18239     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18240        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18241           (V1 > +8)
 18242           OR (PD-PROD-CODE (V1) = 'I')
 18243        END-PERFORM
 18244        IF V1 < +9
 18245           SET DD-IU-PRESENT        TO TRUE
 18246        END-IF
 18247        IF WS-AH-DCC-TRUNC = 'T'
 18248           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18249        ELSE
 18250           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18251        END-IF
 18252        EVALUATE TRUE
 18253           WHEN WS-TERM > +168
 18254              MOVE 15               TO V1
 18255           WHEN WS-TERM > +156
 18256              MOVE 14               TO V1
 18257           WHEN WS-TERM > +144
 18258              MOVE 13               TO V1
 18259           WHEN WS-TERM > +132
 18260              MOVE 12               TO V1
 18261           WHEN WS-TERM > +120
 18262              MOVE 11               TO V1
 18263           WHEN WS-TERM > +108
 18264              MOVE 10               TO V1
 18265           WHEN WS-TERM > +96
 18266              MOVE 9                TO V1
 18267           WHEN WS-TERM > +84
 18268              MOVE 8                TO V1
 18269           WHEN WS-TERM > +72
 18270              MOVE 7                TO V1
 18271           WHEN WS-TERM > +60
 18272              MOVE 6                TO V1
 18273           WHEN WS-TERM > +48
 18274              MOVE 5                TO V1
 18275           WHEN WS-TERM > +36
 18276              MOVE 4                TO V1
 18277           WHEN WS-TERM > +24
 18278              MOVE 3                TO V1
 18279           WHEN WS-TERM > +12
 18280              MOVE 2                TO V1
 18281           WHEN OTHER
 18282              MOVE 1                TO V1
 18283        END-EVALUATE
 18284
 18285        EVALUATE TRUE
 18286*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18287*             < +13)
 18288*             AND (DD-IU-PRESENT)
 18289*             MOVE 2                TO V2
 18290*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18291*             MOVE 1                TO V2
 18292           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18293              MOVE 2                TO V2
 18294           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18295              MOVE 3                TO V2
 18296           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18297              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18298           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18299              MOVE 5                TO V2
 18300           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18301              MOVE 6                TO V2
 18302           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18303              MOVE 7                TO V2
 18304           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18305              MOVE 8                TO V2
 18306           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18307              MOVE 9                TO V2
 18308           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18309              MOVE 10               TO V2
 18310           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18311              MOVE 11               TO V2
 18312           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18313              MOVE 12               TO V2
 18314           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18315              MOVE 13               TO V2
 18316           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18317              MOVE 14               TO V2
 18318           WHEN OTHER
 18319              MOVE 15               TO V2
 18320        END-EVALUATE
 18321
 18322        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18323                                 TO CP-DDF-LO-FACT
 18324        MOVE PD-UEP-FACTOR (V1 V2)
 18325                                 TO CP-DDF-HI-FACT
 18326
 18327        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18328        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18329
 18330        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18331           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18332        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18333        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18334
 18335        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18336           + PD-1ST-YR-ADMIN-ALLOW
 18337
 18338        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18339*       IF PI-CLP-YN = 'Y'
 18340*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18341*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18342*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18343*       END-IF
 18344
 18345        IF DD-IU-PRESENT
 18346           MOVE 'I'              TO CP-EARNING-METHOD
 18347        END-IF
 18348        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18349                                     CP-CLP-RATE-UP
 18350        IF CP-IU-RATE-UP NOT = ZEROS
 18351           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18352              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18353           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18354              / (1 - WS-WORK-FACT)
 18355        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18356     END-IF
 18357
 18358     .
 18359 3750-CONTINUE.
 18360
 18361     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18362                                                                  ELC50PD
 18363     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18364         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18365                                                                  ELC50PD
 18366     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18367        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18368        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18370                                                                  ELC50PD
 18371     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18372        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18374
 18375     IF PB-COMPANY-ID = 'DCC'
 18376        AND PB-CI-ENTRY-STATUS = 'M'
 18377        MOVE +0                  TO PB-C-AH-REF-CALC
 18378     ELSE
 18379        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18380     END-IF
 18381
 18382     IF PB-COMPANY-ID = 'DCC'
 18383        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18384        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18385        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18386        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18387        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18388        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18389        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18390        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18391        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18392     END-IF
 18393
 18394     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18396                                                                  ELC50PD
 18397 3770-CHECK-REFUNDS.                                              ELC50PD
 18398                                                                  ELC50PD
 18399     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18400        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18401           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18403           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18404           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18405              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18406                                                                  ELC50PD
 18407     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18408        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18409           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18410           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18411           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18412           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18413              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18414                                                                  ELC50PD
 18415     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18416        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18417        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18418           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18419              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18420                                                                  ELC50PD
 18421     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18422        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18423        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18424           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18425              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18426                                                                  ELC50PD
 18427     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18428             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18429     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18430             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18431                                                                  ELC50PD
 18432     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18433         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18434                                                                  ELC50PD
 18435     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18436         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18437                                                                  ELC50PD
 18438     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18439                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18441                                                                  ELC50PD
 18442 3772-CONTINUE.                                                   ELC50PD
 18443                                                                  ELC50PD
 18444**********************************                                ELC50PD
 18445*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18446*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18447*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18448***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18449**********************************                                ELC50PD
 18450     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18451     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18452         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18453             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18454             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18455           ELSE                                                   ELC50PD
 18456             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18457             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18458**********************************                                ELC50PD
 18459                                                                  ELC50PD
 18460 3773-CONTINUE.                                                   ELC50PD
 18461                                                                  ELC50PD
 18462     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18463        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18464           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18465           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18466                                                                  ELC50PD
 18467     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18468        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18469           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18471                                                                  ELC50PD
 18472     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18473         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18474             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18475     ELSE                                                         ELC50PD
 18476         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18477                                                                  ELC50PD
 18478     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18479         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18480             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18481     ELSE                                                         ELC50PD
 18482         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18483                                                                  ELC50PD
 18484     IF (PB-COMPANY-ID = 'DCC')
 18485        AND (PB-CI-ENTRY-STATUS = 'M')
 18486        AND (PB-C-LF-CANCEL-AMT > +0)
 18487        MOVE ER-3843             TO WS-ERROR
 18488        PERFORM 9900-ERROR-FORMAT
 18489                                 THRU 9900-EXIT
 18490     END-IF
 18491     EVALUATE TRUE                                                ELC50PD
 18492        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18493           CONTINUE                                               ELC50PD
 18494        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18495                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18496           CONTINUE                                               ELC50PD
 18497        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18498                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18499           CONTINUE                                               ELC50PD
 18500        WHEN OTHER                                                ELC50PD
 18501           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18502              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18503           END-IF                                                 ELC50PD
 18504           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18505                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18506                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18507              CONTINUE                                            ELC50PD
 18508           ELSE                                                   ELC50PD
 18509              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18510                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18511              END-IF                                              ELC50PD
 18512              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18513                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18514                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18515                 CONTINUE                                         ELC50PD
 18516              ELSE                                                ELC50PD
 18517                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18518                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18519                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18520                 ELSE                                             ELC50PD
 18521                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18522                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18523                 END-IF                                           ELC50PD
 18524              END-IF                                              ELC50PD
 18525           END-IF                                                 ELC50PD
 18526     END-EVALUATE.                                                ELC50PD
 18527                                                                  ELC50PD
 18528     EVALUATE TRUE                                                ELC50PD
 18529        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18530           CONTINUE                                               ELC50PD
 18531        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18532                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18533           CONTINUE                                               ELC50PD
 18534        WHEN OTHER                                                ELC50PD
 18535           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18536               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18537              CONTINUE                                            ELC50PD
 18538           ELSE                                                   ELC50PD
 18539              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18540               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18541                CONTINUE                                          ELC50PD
 18542              ELSE                                                ELC50PD
 18543                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18544                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18545                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18546                 ELSE                                             ELC50PD
 18547                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18548                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18549                 END-IF                                           ELC50PD
 18550              END-IF                                              ELC50PD
 18551           END-IF                                                 ELC50PD
 18552     END-EVALUATE.                                                ELC50PD
 18553                                                                  ELC50PD
 18554     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18555         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18556             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18557     ELSE                                                         ELC50PD
 18558         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18559                                                                  ELC50PD
 18560     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18561         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18562             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18563     ELSE                                                         ELC50PD
 18564         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18565                                                                  ELC50PD
 18566     IF (PB-COMPANY-ID = 'DCC')
 18567        AND (PB-CI-ENTRY-STATUS = 'M')
 18568        AND (PB-C-AH-CANCEL-AMT > +0)
 18569        MOVE ER-3843             TO WS-ERROR
 18570        PERFORM 9900-ERROR-FORMAT
 18571                                 THRU 9900-EXIT
 18572     END-IF
 18573     EVALUATE TRUE                                                ELC50PD
 18574        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18575           CONTINUE                                               ELC50PD
 18576*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18577*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18578        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18579                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18580           CONTINUE                                               ELC50PD
 18581        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18582                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18583           CONTINUE                                               ELC50PD
 18584        WHEN OTHER                                                ELC50PD
 18585           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18586              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18587           END-IF                                                 ELC50PD
 18588           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18589               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18590                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18591              CONTINUE                                            ELC50PD
 18592           ELSE                                                   ELC50PD
 18593              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18594                 MOVE +9999999.99 TO                              ELC50PD
 18595                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18596              END-IF                                              ELC50PD
 18597              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18598                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18599                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18600                 CONTINUE                                         ELC50PD
 18601              ELSE                                                ELC50PD
 18602                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18603                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18604                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18605                 ELSE                                             ELC50PD
 18606                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18607                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18608                 END-IF                                           ELC50PD
 18609              END-IF                                              ELC50PD
 18610           END-IF                                                 ELC50PD
 18611     END-EVALUATE.                                                ELC50PD
 18612                                                                  ELC50PD
 18613     EVALUATE TRUE                                                ELC50PD
 18614        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18615           CONTINUE                                               ELC50PD
 18616*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18617*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18618        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18619                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18620           CONTINUE                                               ELC50PD
 18621        WHEN OTHER                                                ELC50PD
 18622           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18623               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18624              CONTINUE                                            ELC50PD
 18625           ELSE                                                   ELC50PD
 18626              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18627                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18628                 CONTINUE                                         ELC50PD
 18629              ELSE                                                ELC50PD
 18630                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18631                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18632                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18633                 ELSE                                             ELC50PD
 18634                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18635                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18636                 END-IF                                           ELC50PD
 18637              END-IF                                              ELC50PD
 18638           END-IF                                                 ELC50PD
 18639     END-EVALUATE.                                                ELC50PD
 18640                                                                  ELC50PD
 18641     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18642        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18643        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18644           AND  PB-C-LF-REF-CALC < +1.00
 18645           AND  PB-C-AH-REF-CALC < +1.00
 18646           CONTINUE
 18647        ELSE
 18648           IF (PB-COMPANY-ID = 'DCC')
 18649              AND (PB-CI-ENTRY-STATUS = 'M')
 18650              CONTINUE
 18651           ELSE
 18652              MOVE ER-2741       TO WS-ERROR
 18653              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18654           END-IF
 18655        END-IF
 18656     END-IF
 18657                                                                  ELC50PD
 18658     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18659        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18660        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18661        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18662        OR                                                        ELC50PD
 18663        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18664        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18665        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18666             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18667                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18668                NEXT SENTENCE                                     ELC50PD
 18669             ELSE                                                 ELC50PD
 18670                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18671                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18672                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18673     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18674        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18675        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18676        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18677        OR                                                        ELC50PD
 18678        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18679        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18680        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18681             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18682                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18683                NEXT SENTENCE                                     ELC50PD
 18684             ELSE                                                 ELC50PD
 18685                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18686                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18687                                                                  ELC50PD
 18688 3775-OVER-REF-CHK.                                               ELC50PD
 18689                                                                  ELC50PD
 18690     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18691        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18692                                                                  ELC50PD
 18693     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18694                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18695                                                                  ELC50PD
 18696     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18697        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18698                                 PB-C-LF-REF-CALC                 ELC50PD
 18699      ELSE                                                        ELC50PD
 18700        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18701                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18702                                                                  ELC50PD
 18703     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18704        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18706                                                                  ELC50PD
 18707     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18708                                                                  ELC50PD
 18709     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18710        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18711                                 PB-C-AH-REF-CALC                 ELC50PD
 18712      ELSE                                                        ELC50PD
 18713        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18714                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18715                                                                  ELC50PD
 18716     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18717        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18719                                                                  ELC50PD
 18720     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18721        NEXT SENTENCE                                             ELC50PD
 18722       ELSE                                                       ELC50PD
 18723         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18724            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18725            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18726                                                                  ELC50PD
 18727 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18728                                                                  ELC50PD
 18729     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18730        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18732                                                                  ELC50PD
 18733     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18734         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18736                                                                  ELC50PD
 18737     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18738         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18739                                                                  ELC50PD
 18740     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18741         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18742                                                                  ELC50PD
 18743     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18744       AND                                                        ELC50PD
 18745        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18746       AND                                                        ELC50PD
 18747        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18748       AND                                                        ELC50PD
 18749        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18750            NEXT SENTENCE                                         ELC50PD
 18751       ELSE                                                       ELC50PD
 18752        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18753          AND                                                     ELC50PD
 18754***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18755***       AND                                                     ELC50PD
 18756           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18757            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18758               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18759               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18760               GO TO 3999-END-EDIT                                ELC50PD
 18761            ELSE                                                  ELC50PD
 18762               GO TO 3999-END-EDIT                                ELC50PD
 18763        ELSE                                                      ELC50PD
 18764            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18765               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18766               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18767               GO TO 3785-CHECK-NH.
 18768*              GO TO 3999-END-EDIT.                               ELC50PD
 18769                                                                  ELC50PD
 18770 3780-UPDATE-CONT-1.                                              ELC50PD
 18771     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18772                                                                  ELC50PD
 18773     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18774         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18775                                                                  ELC50PD
 18776     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18777         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18778
 18779     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18780                                                                  ELC50PD
 18781     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18782       AND                                                        ELC50PD
 18783        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18784       AND                                                        ELC50PD
 18785        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18786       AND                                                        ELC50PD
 18787        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18788            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18789       ELSE                                                       ELC50PD
 18790        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18791          AND                                                     ELC50PD
 18792***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18793***       AND                                                     ELC50PD
 18794           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18795           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18796            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18797               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18798               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18799               GO TO 3999-END-EDIT                                ELC50PD
 18800            ELSE                                                  ELC50PD
 18801               GO TO 3999-END-EDIT                                ELC50PD
 18802            END-IF
 18803           ELSE
 18804             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18805                MOVE ER-2890 TO WS-ERROR
 18806                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18807                GO TO 3999-END-EDIT
 18808             ELSE
 18809                GO TO 3785-CHECK-NH
 18810             END-IF
 18811           END-IF
 18812          ELSE                                                    ELC50PD
 18813            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18814              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18815                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18816                   MOVE ER-2890 TO WS-ERROR
 18817                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18818                   GO TO 3999-END-EDIT
 18819                ELSE
 18820                   MOVE ER-2765 TO WS-ERROR
 18821                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18822                   GO TO 3785-CHECK-NH
 18823                END-IF
 18824              ELSE
 18825               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18826               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18827               GO TO 3785-CHECK-NH.
 18828*              GO TO 3999-END-EDIT.                               ELC50PD
 18829                                                                  ELC50PD
 18830 3780-UPDATE-CONT-2.                                              ELC50PD
 18831                                                                  ELC50PD
 18832     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18833        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18834           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18835           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18836                                                                  ELC50PD
 18837     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18838        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18839           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18841                                                                  ELC50PD
 18842     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18843        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18844        AND                                                       ELC50PD
 18845        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18846         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18847           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18848           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18849                                                                  ELC50PD
 18850     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18851       AND                                                        ELC50PD
 18852        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18853             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18854             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18855                                                                  ELC50PD
 18856     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18857       AND                                                        ELC50PD
 18858        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18859             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18860             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18861                                                                  ELC50PD
 18862     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18863         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18864             OR 'CID' OR 'DCC' OR 'AHL'
 18865             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18866         ELSE                                                     ELC50PD
 18867             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18868                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18869                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18870             ELSE                                                 ELC50PD
 18871                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18872                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18873                                                                  ELC50PD
 18874     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18875        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18877
 18878 3785-CHECK-NH.
 18879
 18880     IF PB-STATE NOT = 'NH'
 18881        GO TO 3999-END-EDIT
 18882     END-IF
 18883
 18884     MOVE ER-2796                TO WS-ERROR
 18885     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18886
 18887     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18888        OR (CM-NH-INTERFACE-SW = 'Y')
 18889        MOVE ER-2793             TO WS-ERROR
 18890        PERFORM 9900-ERROR-FORMAT
 18891                                 THRU 9900-EXIT
 18892     END-IF
 18893
 18894     MOVE +0                     TO WS-PAYMENT-AMT
 18895     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18896        GO TO 3999-END-EDIT
 18897     END-IF
 18898
 18899     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18900        GO TO 3999-END-EDIT
 18901     END-IF
 18902
 18903     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18904     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18905
 18906     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18907        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18908     END-IF
 18909     MOVE '1'                    TO DC-OPTION-CODE
 18910     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18911     IF NO-CONVERSION-ERROR
 18912        IF DC-ELAPSED-DAYS < +16
 18913           GO TO 3999-END-EDIT
 18914        END-IF
 18915     END-IF
 18916
 18917     MOVE +0                     TO DC-ELAPSED-DAYS
 18918     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18919     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18920     MOVE '1'                    TO DC-OPTION-CODE
 18921     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18922     IF NO-CONVERSION-ERROR
 18923        IF DC-ELAPSED-DAYS > +30
 18924           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18925        ELSE
 18926           GO TO 3999-END-EDIT
 18927        END-IF
 18928     ELSE
 18929        GO TO 3999-END-EDIT
 18930     END-IF
 18931
 18932     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18933        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18934           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18935
 18936     IF WS-PAYMENT-AMT < 600.00
 18937        GO TO 3999-END-EDIT
 18938     END-IF
 18939
 18940     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18941                                                                  ELC50PD
 18942     IF (ERMAIL-FOUND = ' ')
 18943         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18944         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18945        GO TO 3999-END-EDIT
 18946     END-IF
 18947
 18948     MOVE ER-2795                TO WS-ERROR
 18949     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18950                                                                  ELC50PD
 18951     GO TO 3999-END-EDIT.                                         ELC50PD
 18952******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18954 3990-FILES-NOT-OPEN.                                             ELC50PD
 18955                                                                  ELC50PD
 18956     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18958     GO TO 9990-RETURN.                                           ELC50PD
 18959                                                                  ELC50PD
 18960 3999-END-EDIT.                                                   ELC50PD
 18961
 18962                                                                  ELC50PD
 18963     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18964                                                                  ELC50PD
 18965     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18966         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18967         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18968             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18969             GO TO 9990-RETURN                                    ELC50PD
 18970          ELSE                                                    ELC50PD
 18971             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18972             GO TO 9990-RETURN.                                   ELC50PD
 18973                                                                  ELC50PD
 18974     IF PB-CANCELLATION                                           ELC50PD
 18975          GO TO 9990-RETURN.                                      ELC50PD
 18976                                                                  ELC50PD
 18977     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18978        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18979                                                                  ELC50PD
 18980     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18981                                                                  ELC50PD
 18982     IF CERT-WAS-FOUND                                            ELC50PD
 18983         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18984             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18985          ELSE                                                    ELC50PD
 18986            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18987      ELSE                                                        ELC50PD
 18988         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18989
 18990     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18991        IF PB-COMPANY-ID = 'DCC' AND
 18992           (PB-CARRIER = '2' OR '4' OR '6')
 18993              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18994        END-IF
 18995     END-IF.
 18996
 18997     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 18998         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 18999     END-IF.
 19000
 19001     move ' '                    to ws-ins-age-defaulted
 19002     perform 8150-read-elcrtt    thru 8150-exit
 19003     if ws-ins-age-defaulted = 'Y'
 19004        move er-1573             to ws-error
 19005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19006     end-if
 19007
 19008     if ws-jnt-age-defaulted = 'Y'
 19009        move er-1574             to ws-error
 19010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19011     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19012
 19013     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 19014     IF ((PB-COMPANY-ID = 'DCC')
 19015        AND (WS-NO-SECURE-PAY))
 19016                  OR
 19017        (WS-LF-SPECIAL-CALC-CD = 'O'
 19018        OR WS-AH-SPECIAL-CALC-CD = 'O')
 19019        SET SKIP-ADDR-EDIT       TO TRUE
 19020     END-IF
 19021
 19022     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 19023        AND (NOT SKIP-ADDR-EDIT)
 19024        MOVE ER-2963             TO WS-ERROR
 19025        PERFORM 9900-ERROR-FORMAT
 19026                                 THRU 9900-EXIT
 19027        GO TO 9990-RETURN
 19028     END-IF
 19029
 19030     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 19031
 19032     IF ERPNDM-FOUND NOT = 'X'
 19033        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19034           OR (PM-CITY        = SPACES OR LOW-VALUES)
 19035           OR (PM-STATE       = SPACES OR LOW-VALUES)
 19036           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 19037           AND (NOT SKIP-ADDR-EDIT)
 19038           MOVE ER-2694          TO WS-ERROR
 19039           PERFORM 9900-ERROR-FORMAT
 19040                                 THRU 9900-EXIT
 19041        END-IF
 19042        MOVE ' '                 TO STATE-RECORD-ERROR
 19043        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19044        MOVE PM-STATE            TO CNTL-ACCESS
 19045        MOVE '3'                 TO CNTL-REC-TYPE
 19046        MOVE +0                  TO CNTL-SEQ-NO
 19047        MOVE '0'                 TO RC-SW-2
 19048        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19049        IF (NO-STATE-RECORD)
 19050           OR (CF-RECORD-TYPE NOT = '3')
 19051           OR (PM-STATE NOT = CF-STATE-CODE)
 19052           IF (PM-STATE = SPACES)
 19053              AND (SKIP-ADDR-EDIT)
 19054              CONTINUE
 19055           ELSE
 19056              MOVE ER-2963       TO WS-ERROR
 19057              PERFORM 9900-ERROR-FORMAT
 19058                                 THRU 9900-EXIT
 19059           END-IF
 19060        END-IF
 19061        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 19062           MOVE ER-2883          TO WS-ERROR
 19063           PERFORM 9900-ERROR-FORMAT
 19064                                 THRU 9900-EXIT
 19065        END-IF
 19066        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 19067           MOVE ' '                 TO STATE-RECORD-ERROR
 19068           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19069           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19070           MOVE '3'                 TO CNTL-REC-TYPE
 19071           MOVE +0                  TO CNTL-SEQ-NO
 19072           MOVE '0'                 TO RC-SW-2
 19073           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19074           IF NO-STATE-RECORD
 19075              OR (CF-RECORD-TYPE NOT = '3')
 19076              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 19077              MOVE ER-2964          TO WS-ERROR
 19078              PERFORM 9900-ERROR-FORMAT
 19079                                    THRU 9900-EXIT
 19080           END-IF
 19081        END-IF
 19082     ELSE
 19083        IF NOT SKIP-ADDR-EDIT
 19084           MOVE ER-2393          TO WS-ERROR
 19085           PERFORM 9900-ERROR-FORMAT
 19086                                 THRU 9900-EXIT
 19087        END-IF
 19088     END-IF
 19089                                                                  ELC50PD
 19090     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 19091                                                                  ELC50PD
 19092     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 19093        ERPNDM-FOUND = ' ')                                       ELC50PD
 19094        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 19095           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 19096           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 19097          OR                                                      ELC50PD
 19098           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 19099          OR                                                      ELC50PD
 19100           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 19101           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 19102           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 19103                                                                  ELC50PD
 19104
 19105     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 19106        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 19107                                                                  ELC50PD
 19108     IF PM-INSURED-LAST-NAME      = SPACES
 19109        AND PM-INSURED-FIRST-NAME = SPACES
 19110        AND PM-ADDRESS-LINE-1     = SPACES
 19111        AND PM-ADDRESS-LINE-2     = SPACES
 19112        AND PM-CITY-STATE         = SPACES
 19113        AND PM-CRED-BENE-NAME     = SPACES
 19114        AND PM-CRED-BENE-ADDR     = SPACES
 19115        AND PM-CRED-BENE-CTYST    = SPACES
 19116        GO TO 3999-UNLOCK-ERMAIL
 19117     END-IF
 19118                                                                  ELC50PD
 19119     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 19120                                                                  ELC50PD
 19121     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 19122     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 19123     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 19124     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 19125     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 19126     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 19127     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19128     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 19129                                                                  ELC50PD
 19130     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 19131     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 19132                                                                  ELC50PD
 19133     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19134        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 19135     ELSE                                                         ELC50PD
 19136        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 19137        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 19138        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 19139                                                                  ELC50PD
 19140
 19141     GO TO 9990-RETURN.                                           ELC50PD
 19142                                                                  ELC50PD
 19143 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19144     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19145        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19146                                                                  ELC50PD
 19147     GO TO 9990-RETURN.                                           ELC50PD
 19148******************************************************************ELC50PD
 19149                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19151 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19152     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19153        GO TO 4299-EXIT.                                          ELC50PD
 19154                                                                  ELC50PD
 19155*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19156
 19157     IF PB-C-NH-INT-ON-REFS > ZEROS
 19158        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19159     END-IF
 19160     IF PB-C-REF-INTERFACE-SW = 'Y'
 19161        MOVE PB-C-REF-INTERFACE-SW
 19162                                 TO CM-NH-INTERFACE-SW
 19163     END-IF
 19164
 19165     IF PB-C-POST-CARD-IND = 'Y'
 19166        MOVE +8                  TO SUB
 19167        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19168        IF ERMAIL-FOUND = ' '
 19169           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19170              (SUB > +7)
 19171              OR (MA-MAIL-STATUS (SUB) = '1')
 19172           END-PERFORM
 19173        END-IF
 19174        IF (SUB > +7)
 19175           OR (ERMAIL-FOUND = 'X')
 19176           MOVE ER-3789          TO WS-ERROR
 19177           PERFORM 9900-ERROR-FORMAT
 19178                                 THRU 9900-EXIT
 19179        END-IF
 19180     ELSE
 19181        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19182     END-IF
 19183
 19184     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19185                                                                  ELC50PD
 19186     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19187        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19188                                                                  ELC50PD
 19189     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19190         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19191     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19192         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19193                                                                  ELC50PD
 19194 4100-APPLY-LF-CANCEL.                                            ELC50PD
 19195                                                                  ELC50PD
 19196     MOVE +0                     TO WS-SUB.                       ELC50PD
 19197                                                                  ELC50PD
 19198 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19199                                                                  ELC50PD
 19200     ADD +1                       TO WS-SUB.                      ELC50PD
 19201                                                                  ELC50PD
 19202     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19203        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19204           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19205        ELSE                                                      ELC50PD
 19206           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19207                                                                  ELC50PD
 19208     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19209                                   ER-2729 OR                     ELC50PD
 19210                                   ER-2730 OR                     ELC50PD
 19211                                   ER-2731 OR                     ELC50PD
 19212                                   ER-2732 OR                     ELC50PD
 19213                                   ER-2737 OR                     ELC50PD
 19214                                   ER-2740 OR                     ELC50PD
 19215                                   ER-2743 OR                     ELC50PD
 19216                                   ER-2749 OR                     ELC50PD
 19217                                   ER-2750 OR                     ELC50PD
 19218                                   ER-2755 OR                     ELC50PD
 19219                                   ER-2757 OR                     ELC50PD
 19220                                   ER-2760 OR                     ELC50PD
 19221                                   ER-2772 OR                     ELC50PD
 19222                                   ER-2774 OR                     ELC50PD
 19223                                   ER-2776 OR                     ELC50PD
 19224                                   ER-2794                        ELC50PD
 19225        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19226                                                                  ELC50PD
 19227     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19228                                                                  ELC50PD
 19229 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19230                                                                  ELC50PD
 19231     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19232     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19233     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19234        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19235     END-IF
 19236     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19237                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19238     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19239         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19240                                                                  ELC50PD
 19241     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19242         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19243                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19244                                                                  ELC50PD
 19245     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19246                                                                  ELC50PD
 19247 4100-LF-CANCEL-CONT.                                             ELC50PD
 19248     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19249         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19250                                                                  ELC50PD
 19251     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19252         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19253                                                                  ELC50PD
 19254     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19255        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19256           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19257        ELSE                                                      ELC50PD
 19258           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19259                                                                  ELC50PD
 19260     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19261     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19262                                                                  ELC50PD
 19263     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19264         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19265                                                                  ELC50PD
 19266     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19267        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19268         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19269         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19270                                                                  ELC50PD
 19271     IF PB-RECORD-RETURNED                                        ELC50PD
 19272        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19273      ELSE                                                        ELC50PD
 19274        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19275                                                                  ELC50PD
 19276 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19277                                                                  ELC50PD
 19278     MOVE +0                      TO WS-SUB.                      ELC50PD
 19279                                                                  ELC50PD
 19280 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19281                                                                  ELC50PD
 19282     ADD +1                       TO WS-SUB.                      ELC50PD
 19283                                                                  ELC50PD
 19284     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19285        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19286           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19287        ELSE                                                      ELC50PD
 19288           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19289                                                                  ELC50PD
 19290     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19291                                   ER-2729 OR                     ELC50PD
 19292                                   ER-2732 OR                     ELC50PD
 19293                                   ER-2737 OR                     ELC50PD
 19294                                   ER-2740 OR                     ELC50PD
 19295                                   ER-2744 OR                     ELC50PD
 19296                                   ER-2749 OR                     ELC50PD
 19297                                   ER-2750 OR                     ELC50PD
 19298                                   ER-2755 OR                     ELC50PD
 19299                                   ER-2757 OR                     ELC50PD
 19300                                   ER-2760 OR                     ELC50PD
 19301                                   ER-2771 OR                     ELC50PD
 19302                                   ER-2772 OR                     ELC50PD
 19303                                   ER-2773 OR                     ELC50PD
 19304                                   ER-2775 OR                     ELC50PD
 19305                                   ER-2777 OR                     ELC50PD
 19306                                   ER-2794                        ELC50PD
 19307        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19308                                                                  ELC50PD
 19309     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19310                                                                  ELC50PD
 19311 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19312                                                                  ELC50PD
 19313     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19314     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19315     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19316     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19317                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19318     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19319         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19320                                                                  ELC50PD
 19321     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19322         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19323                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19324                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19325     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19326         IF PB-RECORD-RETURNED                                    ELC50PD
 19327              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19328          ELSE                                                    ELC50PD
 19329              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19330                                                                  ELC50PD
 19331     GO TO 4299-EXIT.                                             ELC50PD
 19332                                                                  ELC50PD
 19333 4100-AH-CANCEL-CONT.                                             ELC50PD
 19334     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19335         GO TO 4299-EXIT.                                         ELC50PD
 19336                                                                  ELC50PD
 19337     if cm-credit-interface-sw-2 = ' '
 19338        if pb-fatal-errors or pb-unforced-errors
 19339           move '4'              to cm-credit-interface-sw-2
 19340        else
 19341           move '1'              to cm-credit-interface-sw-2
 19342        end-if
 19343     end-if
 19344
 19345     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19346         GO TO 4299-EXIT.                                         ELC50PD
 19347                                                                  ELC50PD
 19348     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19349        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19350           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19351        ELSE                                                      ELC50PD
 19352           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19353                                                                  ELC50PD
 19354     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19355     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19356                                                                  ELC50PD
 19357     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19358         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19359                                                                  ELC50PD
 19360     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19361         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19362         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19363                                                                  ELC50PD
 19364     IF PB-RECORD-RETURNED                                        ELC50PD
 19365        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19366      ELSE                                                        ELC50PD
 19367        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19368                                                                  ELC50PD
 19369     GO TO 4299-EXIT.                                             ELC50PD
 19370                                                                  ELC50PD
 19371 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19372     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19373                                                                  ELC50PD
 19374     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19375        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19376                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19377     ELSE                                                         ELC50PD
 19378        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19379                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19380                                                                  ELC50PD
 19381     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19382        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19383                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19384     ELSE                                                         ELC50PD
 19385        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19386                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19387                                                                  ELC50PD
 19388     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19389        NEXT SENTENCE                                             ELC50PD
 19390     ELSE                                                         ELC50PD
 19391        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19392                                                                  ELC50PD
 19393     GO TO 4299-EXIT.                                             ELC50PD
 19394                                                                  ELC50PD
 19395 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19396     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19397                                                                  ELC50PD
 19398     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19399        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19400        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19401        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19402                                                                  ELC50PD
 19403     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19404                                                                  ELC50PD
 19405     IF PB-RECORD-RETURNED                                        ELC50PD
 19406        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19407       ELSE                                                       ELC50PD
 19408        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19409                                                                  ELC50PD
 19410 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19411       EXIT.                                                      ELC50PD
 19412                                                                  ELC50PD
 19413 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19414     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19415                                                                  ELC50PD
 19416     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19417        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19418        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19419        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19420                                                                  ELC50PD
 19421     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19422                                                                  ELC50PD
 19423     IF PB-RECORD-RETURNED                                        ELC50PD
 19424        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19425       ELSE                                                       ELC50PD
 19426        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19427                                                                  ELC50PD
 19428 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19429       EXIT.                                                      ELC50PD
 19430                                                                  ELC50PD
 19431 4299-EXIT.                                                       ELC50PD
 19432       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19434                                                                  ELC50PD
 19435 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19436     IF CERT-WAS-FOUND                                            ELC50PD
 19437         NEXT SENTENCE                                            ELC50PD
 19438       ELSE                                                       ELC50PD
 19439         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19440                                                                  ELC50PD
 19441     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19442         GO TO 4999-EXIT.                                         ELC50PD
 19443                                                                  ELC50PD
 19444     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19445         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19446                                                                  ELC50PD
 19447     IF CERT-ADDED-BATCH                                          ELC50PD
 19448        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19449            GO TO 4999-EXIT.                                      ELC50PD
 19450                                                                  ELC50PD
 19451 4520-BUILD-NEW-KEY.                                              ELC50PD
 19452* BUILD CONTROL PRIMARY                                           ELC50PD
 19453                                                                  ELC50PD
 19454     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19455                                       CM-COMPANY-CD-A1           ELC50PD
 19456                                       CM-COMPANY-CD-A2           ELC50PD
 19457                                       CM-COMPANY-CD-A4           ELC50PD
 19458                                       CM-COMPANY-CD-A5.          ELC50PD
 19459                                                                  ELC50PD
 19460     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19461     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19462     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19463     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19464     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19465     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19466     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19467                                                                  ELC50PD
 19468     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19469                                                                  ELC50PD
 19470     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19471     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19472     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19473     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19474                                                                  ELC50PD
 19475     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19476        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19477                                                                  ELC50PD
 19478     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19479         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19480         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19481         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19482         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19483     ELSE                                                         ELC50PD
 19484         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19485                                                                  ELC50PD
 19486     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19487         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19488         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19489         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19490         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19491         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19492                                                                  ELC50PD
 19493     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19494        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19495         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19496                                                                  ELC50PD
 19497     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19498        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19499            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19500                                           PB-I-MEMBER-NO         ELC50PD
 19501            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19502                                                                  ELC50PD
 19503     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19504        NEXT SENTENCE                                             ELC50PD
 19505     ELSE                                                         ELC50PD
 19506        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19507                                                                  ELC50PD
 19508******************************************************************ELC50PD
 19509*                                                                *ELC50PD
 19510*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19511*    FOR 'MON'.                                                  *ELC50PD
 19512*                                                                *ELC50PD
 19513******************************************************************ELC50PD
 19514                                                                  ELC50PD
 19515     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19516     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19517     MOVE +1                     TO WS-SUB1                       ELC50PD
 19518                                    WS-SUB2.                      ELC50PD
 19519                                                                  ELC50PD
 19520 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19521                                                                  ELC50PD
 19522     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19523        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19524        ADD +1                       TO WS-SUB2.                  ELC50PD
 19525                                                                  ELC50PD
 19526     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19527        ADD +1                       TO WS-SUB1                   ELC50PD
 19528        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19529                                                                  ELC50PD
 19530     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19531     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19532     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19533*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19534     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19535     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19536     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19537                                                                  ELC50PD
 19538     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19539                                                                  ELC50PD
 19540******************************************************************ELC50PD
 19541*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19542******************************************************************ELC50PD
 19543                                                                  ELC50PD
 19544 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19545                                                                  ELC50PD
 19546     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19547         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19548         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19549         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19550         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19551     ELSE                                                         ELC50PD
 19552         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19553                                                                  ELC50PD
 19554     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19555        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19556         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19557                                                                  ELC50PD
 19558 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19559                                                                  ELC50PD
 19560*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19561*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19562*    ELSE                                                         ELC50PD
 19563*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19564                                                                  ELC50PD
 19565     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19566        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19567        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19568                                                                  ELC50PD
 19569     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19570        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19571        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19572                                                                  ELC50PD
 19573     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19574     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19575                                                                  ELC50PD
 19576     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19577        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19578        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19579     ELSE                                                         ELC50PD
 19580        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19581        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19582                                                                  ELC50PD
 19583     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19584     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19585     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19586     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19587     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19588     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19589     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19590                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19591                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19592                                      CM-AH-ITD-AH-PMT            ELC50PD
 19593                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19594                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19595                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19596                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19597*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19598*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19599     if pb-i-loan-apr = +99.9999
 19600        move zeros                 to cm-loan-apr
 19601     else
 19602        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 19603     end-if
 19604     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19605     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19606     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19607     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19608     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19609     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19610     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19611     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
 19612     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19613     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19614     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19615                                                                  ELC50PD
 19616     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19617         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19618                                                                  ELC50PD
 19619     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19620         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19621                                                                  ELC50PD
 19622     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19623     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19624                                                                  ELC50PD
 19625     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19626         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19627         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19628                                                                  ELC50PD
 19629     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19630     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19631     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19632     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19633     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19634     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19635                                                                  ELC50PD
 19636     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19637        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19638     ELSE                                                         ELC50PD
 19639        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19640                                                                  ELC50PD
 19641     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19642        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19643        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19644     ELSE                                                         ELC50PD
 19645        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19646                                                                  ELC50PD
 19647     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19648     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19649     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19650     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19651     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19652     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19653     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19654     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19655     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19656                                                                  ELC50PD
 19657     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19658        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19659     ELSE                                                         ELC50PD
 19660        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19661                                                                  ELC50PD
 19662     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19663        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19664     ELSE                                                         ELC50PD
 19665        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19666                                                                  ELC50PD
 19667     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19668     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19669                                                                  ELC50PD
 19670     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19671                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19672                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19673                                                                  ELC50PD
 19674*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19675*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19676*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19677*                       'NCL'                                     ELC50PD
 19678     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19679                                                                  ELC50PD
 19680     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19681         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19682            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19683                                                                  ELC50PD
 19684     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19685         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19686            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19687                                                                  ELC50PD
 19688     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19689         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19690     ELSE                                                         ELC50PD
 19691         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19692         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19693                                                                  ELC50PD
 19694     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19695     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19696     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19697     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19698     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19699     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19700     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19701     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19702                                                                  ELC50PD
 19703     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19704         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19705     ELSE                                                         ELC50PD
 19706         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19707                                                                  ELC50PD
 19708     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19709     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19710                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19711                                                                  ELC50PD
 19712     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19713     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19714                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19715                                                                  ELC50PD
 19716     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19717                                                                  ELC50PD
 19718     IF PB-REISSUED-CERT                                          ELC50PD
 19719        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19720                                                                  ELC50PD
 19721     IF PB-MONTHLY-CERT                                           ELC50PD
 19722        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19723                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19724     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19725     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19726     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19727        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
 19728                                                                  ELC50PD
 19729     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19730        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19731                                                                  ELC50PD
 19732     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19733        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19734                                                                  ELC50PD
 19735     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19736        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19737                                                                  ELC50PD
 19738     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19739         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19740     ELSE                                                         ELC50PD
 19741         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19742                                                                  ELC50PD
 19743     IF PB-RECORD-RETURNED                                        ELC50PD
 19744        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19745      ELSE                                                        ELC50PD
 19746        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19747                                                                  ELC50PD
 19748     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19749        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19750                                                                  ELC50PD
 19751     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19752                                       CM-ENTRY-DT.               ELC50PD
 19753                                                                  ELC50PD
 19754 4999-EXIT.                                                       ELC50PD
 19755     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19757                                                                  ELC50PD
 19758 5000-PROCESS-REPS.
 19759
 19760     MOVE ' '                    TO AGTC-MASTER-SW
 19761     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19762     MOVE CO-TYPE                TO AGTC-TYPE
 19763     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19764     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19765
 19766     IF (AGTC-MASTER-SW NOT = 'N')
 19767        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19768        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19769        PERFORM 8583-READ-ERAGTC-NEXT
 19770                                 THRU 8583-EXIT
 19771     END-IF
 19772
 19773     IF AGTC-MASTER-SW = 'N'
 19774        CONTINUE
 19775     ELSE
 19776        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19777           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19778              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19779              MOVE 'Y'           TO AGTC-MASTER-SW
 19780           END-IF
 19781        END-IF
 19782     END-IF
 19783
 19784     .
 19785 5000-EXIT.
 19786     EXIT.
 19787
 19788
 19789 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19790     move ' ' to ws-benefit-cd-chg-sw
 19791     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19792        MOVE +1                  TO SUB                           ELC50PD
 19793        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19794        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19795        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19796        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19797        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19798                                                                  ELC50PD
 19799     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19800                                                                  ELC50PD
 19801     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19802     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19803*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19804     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19805     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19806     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19807     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19808                                                                  ELC50PD
 19809     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19810        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19811        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19812                                                                  ELC50PD
 19813     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19814     MOVE +1                     TO SUB.                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19815                                                                  ELC50PD
 19816 6370-SEARCH-LOOP.                                                ELC50PD
 19817     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19818         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19819                                                                  ELC50PD
 19820     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19821        if (pb-i-lf-benefit-cd not = zeros and spaces)
 19822           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 19823           set benefit-code-chg to true
 19824        end-if
 19825        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 19826        GO TO 6370-HER-NET-PAY-CHECK.
 19827                                                                  ELC50PD
 19828     ADD 1   TO SUB.                                              ELC50PD
 19829*    IF SUB GREATER 120                                           ELC50PD
 19830     IF SUB GREATER 200                                           ELC50PD
 19831         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19832                                                                  ELC50PD
 19833     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19834                                                                  ELC50PD
 19835 6370-NO-LF-FOUND.                                                ELC50PD
 19836                                                                  ELC50PD
 19837     if (pb-i-lf-benefit-cd not = zeros and spaces)
 19838        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 19839        set benefit-code-chg to true
 19840     end-if
 19841     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19842                                                                  ELC50PD
 19843 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19844                                                                  ELC50PD
 19845     IF PB-COMPANY-ID = 'CID'
 19846        IF PB-SV-STATE = 'CA' OR 'MN'
 19847           IF PB-I-LF-BENEFIT-CD = '02'
 19848              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19849           ELSE
 19850              IF PB-I-LF-BENEFIT-CD = '04'
 19851                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19852              END-IF
 19853           END-IF
 19854        END-IF
 19855     END-IF
 19856
 19857     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19858         GO TO 6370-EXIT.                                         ELC50PD
 19859                                                                  ELC50PD
 19860     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19861         GO TO 6370-EXIT.                                         ELC50PD
 19862                                                                  ELC50PD
 19863     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19864         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19865                                                                  ELC50PD
 19866     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19867         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19868                                                                  ELC50PD
 19869     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19870         GO TO 6370-EXIT.                                         ELC50PD
 19871                                                                  ELC50PD
 19872     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 360
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19873         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19874                                                                  ELC50PD
 19875     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19876         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19877                                                                  ELC50PD
 19878 6370-EXIT.                                                       ELC50PD
 19879     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 361
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19881                                                                  ELC50PD
 19882 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19883     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19884        MOVE +1                  TO SUB                           ELC50PD
 19885        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19886        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19887        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19888        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19889        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19890                                                                  ELC50PD
 19891     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19892                                                                  ELC50PD
 19893     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19894     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19895     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19896*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19897     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19898     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19899     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19900                                                                  ELC50PD
 19901     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19902        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19903        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19904                                                                  ELC50PD
 19905     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19906     MOVE +1 TO SUB.                                              ELC50PD
 19907                                                                  ELC50PD
 19908 6380-SEARCH-LOOP.                                                ELC50PD
 19909     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19910         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19911                                                                  ELC50PD
 19912     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19913         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19914         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19915                                                                  ELC50PD
 19916     ADD 1   TO SUB.                                              ELC50PD
 19917     IF SUB GREATER THAN 96                                       ELC50PD
 19918*    IF SUB GREATER THAN 300                                      ELC50PD
 19919         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19920                                                                  ELC50PD
 19921     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19922                                                                  ELC50PD
 19923 6380-NO-AH-FOUND.                                                ELC50PD
 19924                                                                  ELC50PD
 19925     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19926                                                                  ELC50PD
 19927     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19928         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19929     ELSE                                                         ELC50PD
 19930         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19931                                                                  ELC50PD
 19932 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19933                                                                  ELC50PD
 19934     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19935        NEXT SENTENCE                                             ELC50PD
 19936      ELSE                                                        ELC50PD
 19937        GO TO 6380-EXIT.                                          ELC50PD
 19938                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 362
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19939     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19940         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19941                                                                  ELC50PD
 19942                                                                  00041198
 19943     GO TO 6380-EXIT                                              00041198
 19944     .
 19945 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19946                                                                  00041203
 19947                                                                  ELC50PD
 19948     .                                                            ELC50PD
 19949 6380-EXIT.                                                       ELC50PD
 19950     EXIT.                                                        ELC50PD
 19951                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 363
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19953                                                                  ELC50PD
 19954 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19955                                                                  ELC50PD
 19956******************************************************************ELC50PD
 19957*                                                                *ELC50PD
 19958*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19959*                                                                *ELC50PD
 19960*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19961*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19962*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19963*    THE EXTENSION DAYS.                                         *ELC50PD
 19964*                                                                *ELC50PD
 19965******************************************************************ELC50PD
 19966                                                                  ELC50PD
 19967     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19968     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19969                                                                  ELC50PD
 19970******************************************************************ELC50PD
 19971*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19972*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19973******************************************************************ELC50PD
 19974                                                                  ELC50PD
 19975     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19976        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19977               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19978     ELSE                                                         ELC50PD
 19979        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19980                                                                  ELC50PD
 19981     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 19982           GO TO 6499-EXIT                                        ELC50PD
 19983     ELSE                                                         ELC50PD
 19984        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 19985           IF WS-WDF-MONTH = 02                                   ELC50PD
 19986              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 19987              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 19988              GO TO 6499-EXIT                                     ELC50PD
 19989           ELSE                                                   ELC50PD
 19990              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 19991                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 19992                 GO TO 6499-EXIT                                  ELC50PD
 19993               ELSE                                               ELC50PD
 19994                 GO TO 6499-EXIT                                  ELC50PD
 19995        ELSE                                                      ELC50PD
 19996           GO TO 6499-EXIT.                                       ELC50PD
 19997                                                                  ELC50PD
 19998 6412-CHECK-TO-DAY.                                               ELC50PD
 19999                                                                  ELC50PD
 20000        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 20001           IF WS-WDT-DAY = 28                                     ELC50PD
 20002              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 20003           ELSE                                                   ELC50PD
 20004              IF WS-WDT-DAY = 29                                  ELC50PD
 20005                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 20006              ELSE                                                ELC50PD
 20007                 NEXT SENTENCE                                    ELC50PD
 20008        ELSE                                                      ELC50PD
 20009           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 20010              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 364
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 20011                                                                  ELC50PD
 20012     GO TO 6499-EXIT.                                             ELC50PD
 20013                                                                  ELC50PD
 20014                                                                  ELC50PD
 20015 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 20016                                                                  ELC50PD
 20017     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 20018        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 20019                                                                  ELC50PD
 20020 6415-EXIT.                                                       ELC50PD
 20021     EXIT.                                                        ELC50PD
 20022                                                                  ELC50PD
 20023 6499-EXIT.                                                       ELC50PD
 20024      EXIT.                                                       ELC50PD
 20025                                                                  ELC50PD
 20026 6500-END.                                                        ELC50PD
 20027     EXIT.
 20028
 20029                                                                  ELC50PD
 20030******************************************************************ELC50PD
 20031************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 20032********************** ELC50PD END *******************************ELC50PD
 20033                                                                  ELC50PD
 20034*
 20035*
 20036**START***********************************************************
 20037*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20038*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 20039******************************************************************
 20040*
 20041 6600-GET-STATE-MUNICIPAL-TAX.
 20042
 20043     IF PB-COMPANY-ID NOT = 'DMD'
 20044         GO TO 6640-EXIT.
 20045
 20046     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 20047     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 20048     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 20049
 20050*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20051     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20052     MOVE SPACES TO DC-ALPHA-CENTURY.
 20053     SET BIN-TO-GREG          TO TRUE.
 20054     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20055
 20056     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20057     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20058
 20059     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 20060     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 20061                                 WS-SAVE-ERRESS-KEY.
 20062
 20063*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 20064*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 20065
 20066     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 20067
 20068     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 365
* EL517.cbl
 20069         MOVE ER-8002        TO WS-ERROR
 20070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20071         GO TO 6640-EXIT.
 20072
 20073*GET RECORD WHERE POSITIONED
 20074
 20075 6600-READ-ERRESS-NEXT.
 20076     READ ERRESS NEXT RECORD.
 20077
 20078     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 20079         MOVE ER-8002        TO WS-ERROR
 20080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20081         GO TO 6640-EXIT.
 20082
 20083*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 20084
 20085     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 20086        NEXT SENTENCE
 20087     ELSE
 20088        MOVE ER-8002        TO WS-ERROR
 20089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20090        GO TO 6640-EXIT.
 20091
 20092     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 20093        NEXT SENTENCE
 20094     ELSE
 20095        GO TO 6600-READ-ERRESS-NEXT.
 20096
 20097*IS IT LIFE(1) OR IS IT P&C(2) ?????
 20098*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 20099
 20100     MOVE +2                     TO WS-SUB1.
 20101
 20102     IF PB-CANCELLATION
 20103        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 20104           MOVE +1               TO WS-SUB1.
 20105
 20106     IF PB-ISSUE
 20107        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 20108           MOVE +1               TO WS-SUB1.
 20109
 20110*
 20111*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 20112*
 20113     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 20114     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 20115     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 20116     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 20117
 20118
 20119*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 20120*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 20121*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 20122
 20123     ADD 1                    TO WS-YEAR-YY.
 20124
 20125     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 20126         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 366
* EL517.cbl
 20127                              TO WS-RES-STATE-TAX
 20128         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 20129                              TO WS-RES-MUNI-TAX
 20130     ELSE
 20131         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 20132                              TO WS-RES-STATE-TAX
 20133         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 20134                              TO WS-RES-MUNI-TAX.
 20135
 20136*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 20137
 20138     IF PB-CANCELLATION
 20139         GO TO 6640-CANCEL-TAX.
 20140
 20141     IF PB-I-LF-PREMIUM-AMT > ZEROS
 20142          COMPUTE PB-I-STATE-TAX ROUNDED =
 20143                                    PB-I-LF-PREMIUM-AMT
 20144                                  * WS-RES-STATE-TAX
 20145          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20146                                    PB-I-LF-PREMIUM-AMT
 20147                                  * WS-RES-MUNI-TAX
 20148     ELSE
 20149     IF PB-I-AH-PREMIUM-AMT > ZEROS
 20150          COMPUTE PB-I-STATE-TAX ROUNDED =
 20151                                    PB-I-AH-PREMIUM-AMT
 20152                                  * WS-RES-STATE-TAX
 20153          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20154                                    PB-I-AH-PREMIUM-AMT
 20155                                  * WS-RES-MUNI-TAX.
 20156
 20157     GO TO 6640-EXIT.
 20158
 20159 6640-CANCEL-TAX.
 20160     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 20161
 20162     IF PB-C-LF-CANCEL-AMT > ZEROS
 20163          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20164                                    PB-C-LF-CANCEL-AMT
 20165                                  * WS-RES-STATE-TAX
 20166          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20167                                    PB-C-LF-CANCEL-AMT
 20168                                  * WS-RES-MUNI-TAX
 20169     ELSE
 20170     IF PB-C-AH-CANCEL-AMT > ZEROS
 20171          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20172                                    PB-C-AH-CANCEL-AMT
 20173                                  * WS-RES-STATE-TAX
 20174          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20175                                    PB-C-AH-CANCEL-AMT
 20176                                  * WS-RES-MUNI-TAX.
 20177
 20178 6640-EXIT.
 20179     EXIT.
 20180
 20181 6650-GET-RES-STATE-COMM.
 20182
 20183     IF PB-COMPANY-ID NOT = 'DMD'
 20184         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 367
* EL517.cbl
 20185
 20186     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20187     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20188     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20189     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20190     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20191     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20192     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20193
 20194*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20195
 20196     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20197     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20198     SET BIN-TO-GREG          TO TRUE.
 20199     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20200
 20201     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20202     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20203
 20204     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20205
 20206*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20207*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20208*VALUE OF PB-CERT-EFF-DT
 20209
 20210     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20211     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20212
 20213     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20214         GO TO 6700-COMM-EXIT.
 20215
 20216*GET RECORD WHERE POSITIONED
 20217
 20218 6650-READ-ERRESC-NEXT.
 20219     READ ERRESC NEXT RECORD.
 20220
 20221     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20222         GO TO 6700-COMM-EXIT.
 20223
 20224     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20225        NEXT SENTENCE
 20226     ELSE
 20227         GO TO 6700-COMM-EXIT.
 20228
 20229     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20230         NEXT SENTENCE
 20231       ELSE
 20232         GO TO 6650-READ-ERRESC-NEXT.
 20233
 20234*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20235*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20236
 20237     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20238         GO TO 6700-COMM-EXIT.
 20239
 20240* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20241
 20242     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 368
* EL517.cbl
 20243
 20244     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20245
 20246     IF WS-SUB1 > ZERO
 20247         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20248             PERFORM 6680-SET-COMMISSION
 20249         ELSE
 20250             PERFORM 6680-SET-TABLE-CODE.
 20251
 20252     GO TO 6700-COMM-EXIT.
 20253
 20254 6680-SET-TABLE-CODE.
 20255     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20256        MOVE ZEROS             TO WS-SUB1
 20257     ELSE
 20258* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20259* TO COMPUTE AH COMMISSION.
 20260        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20261        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20262        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20263        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20264        PERFORM 6680-READ-CTBL-TABLE
 20265        IF ERCTBL-FILE-STATUS NOT = '00'
 20266           MOVE ZEROS          TO WS-SUB1.
 20267
 20268 6680-READ-CTBL-TABLE.
 20269*
 20270* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20271* TO COMPUTE LIFE COMMISSION
 20272
 20273     IF CTBL-SW = '0540'
 20274        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20275        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20276        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20277
 20278     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20279
 20280     IF CTBL-TABLE-FOUND
 20281        IF CTBL-SW = '0530'
 20282             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20283                                        PB-I-AH-TERM
 20284             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20285             MOVE WS-WK-RATE        TO WS-COMMISSION
 20286                                       PB-I-AH-COMMISSION
 20287        ELSE
 20288             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20289             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20290             MOVE WS-WK-RATE        TO WS-COMMISSION
 20291                                       PB-I-LIFE-COMMISSION
 20292     ELSE
 20293        IF FIRST-TIME-THROUGH
 20294            GO TO 6680-READ-CTBL-TABLE
 20295        ELSE
 20296            MOVE ZEROS         TO WS-SUB1.
 20297
 20298 6680-SET-COMMISSION.
 20299     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20300           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 369
* EL517.cbl
 20301       ELSE
 20302           MOVE RESC-COMMISSION-PER (WS-SUB)
 20303                             TO WS-COMMISSION
 20304           IF CTBL-SW = '0540'
 20305               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20306           ELSE
 20307               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20308
 20309 6680-SEARCH-CATEGORY.
 20310     ADD +1                   TO WS-SUB.
 20311     IF WS-SUB > +12
 20312         GO TO 6680-EXIT.
 20313
 20314     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20315          MOVE WS-SUB         TO WS-SUB1
 20316          GO TO 6680-EXIT.
 20317
 20318     GO TO 6680-SEARCH-CATEGORY.
 20319
 20320 6680-EXIT.
 20321     EXIT.
 20322
 20323 6700-COMM-EXIT.
 20324     EXIT.
 20325**END*************************************************************
 20326*      CUSTOM CODING FOR CLIENT "DMD"
 20327******************************************************************
 20328*
 20329 7000-GET-RATE.
 20330     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20331
 20332 7000-EXIT.
 20333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 370
* EL517.cbl
 20335
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 371
* EL517.cbl
 20337 7100-FIND-BENEFIT-IN-STATE.
 20338     MOVE 'N'                    TO BEN-SEARCH-SW.
 20339
 20340     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20341         VARYING SUB3 FROM 1 BY 1 UNTIL
 20342            ((SUB3 GREATER 50) OR
 20343              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20344               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20345
 20346     IF SUB3 NOT = 51
 20347         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20348             MOVE 'Y'            TO BEN-SEARCH-SW.
 20349
 20350     GO TO 7199-EXIT.
 20351
 20352 7100-BENEFIT-DUMMY.
 20353
 20354 7100-DUMMY-EXIT.
 20355     EXIT.
 20356
 20357 7199-EXIT.
 20358     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 372
* EL517.cbl
 20360 7200-FIND-BENEFIT.
 20361     MOVE 'N'                    TO BEN-SEARCH-SW.
 20362
 20363     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20364         VARYING SUB3 FROM 1 BY 1 UNTIL
 20365            ((SUB3 GREATER 8) OR
 20366            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20367
 20368     IF SUB3 NOT = 9
 20369         MOVE 'Y'                TO BEN-SEARCH-SW.
 20370
 20371     GO TO 7200-EXIT.
 20372
 20373 7200-BENEFIT-DUMMY.
 20374
 20375     EXIT.
 20376 7200-DUMMY-EXIT.
 20377     EXIT.
 20378
 20379 7200-EXIT.
 20380     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 373
* EL517.cbl
 20382 7250-LOOK-FOR-RESCINDED-CLAIM.
 20383
 20384     IF ELMSTR-OPEN = ' '
 20385         OPEN INPUT ELMSTR
 20386         MOVE 'X'                TO ELMSTR-OPEN
 20387         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20388             NEXT SENTENCE
 20389         ELSE
 20390             MOVE ELMSTR-FILE-STATUS
 20391                                 TO WS-ABEND-FILE-STATUS
 20392             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20393             MOVE EMSG           TO WS-ABEND-MESSAGE
 20394             GO TO ABEND-PGM.
 20395
 20396     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20397                                    W-CL-COMP-CD.
 20398     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20399                                    W-CL-CERT-NO.
 20400     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20401
 20402     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20403
 20404     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20405         GO TO 7250-EXIT.
 20406
 20407     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20408         GO TO 7250-CLAIMS-ERROR.
 20409
 20410 7250-NEXT-CLAIM.
 20411
 20412     READ ELMSTR NEXT.
 20413
 20414     IF ELMSTR-FILE-STATUS = '10'
 20415         GO TO 7250-EXIT.
 20416
 20417     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20418         GO TO 7250-CLAIMS-ERROR.
 20419
 20420     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20421        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20422         GO TO 7250-EXIT.
 20423
 20424     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20425        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20426        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20427        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20428        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20429         GO TO 7250-NEXT-CLAIM.
 20430
 20431     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20432        OR (CL-CLAIM-TYPE = 'I')
 20433        OR (CL-CLAIM-TYPE = 'G')
 20434          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20435              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20436              GO TO 7250-EXIT
 20437          END-IF
 20438     END-IF.
 20439
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 374
* EL517.cbl
 20440     GO TO 7250-NEXT-CLAIM.
 20441
 20442 7250-CLAIMS-ERROR.
 20443
 20444     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20445     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20446     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20447     GO TO ABEND-PGM.
 20448
 20449 7250-EXIT.
 20450     EXIT.
 20451 7300-CHECK-FOR-OPEN-CLMS.
 20452
 20453     IF ELMSTR-OPEN = ' '
 20454         OPEN INPUT ELMSTR
 20455         MOVE 'X'                TO ELMSTR-OPEN
 20456         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20457             NEXT SENTENCE
 20458         ELSE
 20459             MOVE ELMSTR-FILE-STATUS
 20460                                 TO WS-ABEND-FILE-STATUS
 20461             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20462             MOVE EMSG           TO WS-ABEND-MESSAGE
 20463             GO TO ABEND-PGM.
 20464
 20465     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20466                                    W-CL-COMP-CD.
 20467     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20468                                    W-CL-CERT-NO.
 20469     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20470
 20471     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20472
 20473     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20474         GO TO 7300-EXIT.
 20475
 20476     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20477         GO TO 7300-CLAIMS-ERROR.
 20478
 20479     MOVE 'Y'                    TO W-BROWSE-SW.
 20480
 20481 7300-NEXT-CLAIM.
 20482
 20483     READ ELMSTR NEXT.
 20484
 20485     IF ELMSTR-FILE-STATUS = '10'
 20486         GO TO 7300-EXIT.
 20487
 20488     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20489         GO TO 7300-CLAIMS-ERROR.
 20490
 20491     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20492        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20493         GO TO 7300-EXIT.
 20494
 20495     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20496        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20497        PB-SV-STATE    NOT = CL-CERT-STATE    OR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 375
* EL517.cbl
 20498        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20499        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20500         GO TO 7300-NEXT-CLAIM.
 20501
 20502     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20503        OR 'I' OR 'G'
 20504        IF CLAIM-IS-OPEN
 20505           EVALUATE TRUE
 20506             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20507                 MOVE ER-2884      TO WS-ERROR
 20508             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20509                 MOVE ER-2887      TO WS-ERROR
 20510             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20511                 MOVE ER-2886      TO WS-ERROR
 20512             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20513                 MOVE ER-2888      TO WS-ERROR
 20514             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20515                 MOVE ER-2885      TO WS-ERROR
 20516             WHEN OTHER
 20517                 MOVE ER-2768      TO WS-ERROR
 20518           END-EVALUATE
 20519           IF PB-C-AH-CANCEL-VOIDED OR
 20520              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20521                NOT AH-COVERAGE-CANCELLED)
 20522               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20523               MOVE ER-2768      TO WS-ERROR
 20524           END-IF
 20525           PERFORM 9900-ERROR-FORMAT
 20526                                 THRU 9900-EXIT
 20527           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20528              PB-FORCE-CODE NOT EQUAL '8'
 20529               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20530           END-IF
 20531           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20532           GO TO 7300-EXIT
 20533        ELSE
 20534           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20535*****THIS IS A RESCISSION OR REFORMATION
 20536              IF (AH-COVERAGE-CANCELLED AND
 20537                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20538                    MOVE ER-2890 TO WS-ERROR
 20539                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20540                    GO TO 7300-EXIT
 20541              END-IF
 20542           ELSE
 20543              IF CL-DENIAL-TYPE = '1'  AND
 20544                 CL-TOTAL-PAID-AMT = 0
 20545                    GO TO 7300-NEXT-CLAIM
 20546              END-IF
 20547              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20548               AND PB-C-AH-CANCEL-DT > SPACES
 20549                 MOVE ER-2756       TO WS-ERROR
 20550                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20551                 GO TO 7300-EXIT
 20552              END-IF
 20553           END-IF
 20554        END-IF
 20555     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 376
* EL517.cbl
 20556        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20557           IF CLAIM-IS-OPEN
 20558              MOVE ER-2889    TO WS-ERROR
 20559              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20560              GO TO 7300-EXIT
 20561           ELSE
 20562              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20563*****THIS IS A RESCISSION OR REFORMATION
 20564                 IF (LF-COVERAGE-CANCELLED AND
 20565                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20566                       MOVE ER-2890 TO WS-ERROR
 20567                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20568                       GO TO 7300-EXIT
 20569                 END-IF
 20570              ELSE
 20571                 IF CL-DENIAL-TYPE = '1'  AND
 20572                    CL-TOTAL-PAID-AMT = 0
 20573                       GO TO 7300-NEXT-CLAIM
 20574                 END-IF
 20575                 IF (AH-COVERAGE-CANCELLED AND
 20576                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20577                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20578                    (LF-COVERAGE-CANCELLED AND
 20579                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20580                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20581                       MOVE ER-2965 TO WS-ERROR
 20582                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20583                       GO TO 7300-EXIT
 20584                 END-IF
 20585                 IF LF-COVERAGE-CANCELLED
 20586                  IF CL-TOTAL-PAID-AMT > 0
 20587                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20588                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20589                        MOVE ER-2891 TO WS-ERROR
 20590                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20591                        GO TO 7300-EXIT
 20592                      END-IF
 20593                    ELSE
 20594                      MOVE ER-2892 TO WS-ERROR
 20595                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20596                      GO TO 7300-EXIT
 20597                    END-IF
 20598                  END-IF
 20599                 END-IF
 20600              END-IF
 20601           END-IF
 20602        END-IF
 20603     END-IF
 20604
 20605     GO TO 7300-NEXT-CLAIM.
 20606
 20607 7300-CLAIMS-ERROR.
 20608
 20609     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20610     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20611     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20612     GO TO ABEND-PGM.
 20613
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 377
* EL517.cbl
 20614 7300-EXIT.
 20615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 378
* EL517.cbl
 20617
 20618 7400-GET-REMAIN-TERM.
 20619     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20620
 20621 7400-EXIT.
 20622     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 379
* EL517.cbl
 20624
 20625 7500-GET-REMAIN-AMOUNT.
 20626     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20627
 20628 7500-EXIT.
 20629     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 380
* EL517.cbl
 20631
 20632 7600-GET-REFUND.
 20633     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20634
 20635 7600-EXIT.
 20636     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 381
* EL517.cbl
 20638
 20639 7700-CALL-DL1.
 20640     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20641     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20642
 20643 7700-EXIT.
 20644     EXIT.
 20645
 20646 7710-CALL-DL2.
 20647     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20648     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20649
 20650 7710-EXIT.
 20651     EXIT.
 20652
 20653 7720-CALL-DL3.
 20654     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20655     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20656
 20657 7720-EXIT.
 20658     EXIT.
 20659
 20660 7730-CALL-DL7.
 20661     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20662     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20663
 20664 7730-EXIT.
 20665     EXIT.
 20666
 20667 7740-CALL-DL11.
 20668     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20669     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20670
 20671 7740-EXIT.
 20672     EXIT.
 20673
 20674 7750-CALL-DL17.
 20675     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20676     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20677
 20678 7750-EXIT.
 20679     EXIT.
 20680
 20681 7755-CALL-DL19.
 20682     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20683     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20684
 20685 7755-EXIT.
 20686     EXIT.
 20687
 20688 7760-CALL-DL21.
 20689     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20690
 20691 7760-EXIT.
 20692     EXIT.
 20693
 20694 7770-CALL-DL22.
 20695     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 382
* EL517.cbl
 20696     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20697
 20698 7770-EXIT.
 20699     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 383
* EL517.cbl
 20701
 20702 7800-REWRITE-CERT.
 20703     REWRITE CERTIFICATE-MASTER.
 20704     ADD 1 TO WCER.
 20705
 20706 7800-EXIT.
 20707      EXIT.
 20708     EXIT.
 20709
 20710 8000-WRITE-CERT.
 20711
 20712     WRITE CERTIFICATE-MASTER.
 20713     ADD 1 TO WCER.
 20714     IF ELCERT-FILE-STATUS NOT = '00'
 20715         GO TO 8000-FREE-MAIN.
 20716
 20717 8000-FREE-MAIN.
 20718
 20719 8000-EXIT.
 20720     EXIT.
 20721      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 384
* EL517.cbl
 20723
 20724 8100-READ-ERPNDM.
 20725     IF ERPNDM-OPEN = ' '
 20726        OPEN INPUT ERPNDM
 20727        MOVE 'X' TO ERPNDM-OPEN
 20728        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20729           NEXT SENTENCE
 20730        ELSE
 20731           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20732           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20733           MOVE EMSG TO WS-ABEND-MESSAGE
 20734           GO TO ABEND-PGM.
 20735
 20736     MOVE SPACES                 TO ERPNDM-FOUND.
 20737     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20738     READ ERPNDM.
 20739
 20740     IF ERPNDM-FILE-STATUS  = '00'
 20741        CONTINUE
 20742     ELSE
 20743        MOVE 'X'                 TO ERPNDM-FOUND
 20744        MOVE ER-2694             TO WS-ERROR
 20745        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20746        MOVE ER-2883             TO WS-ERROR
 20747        PERFORM 9900-ERROR-FORMAT
 20748                                 THRU 9900-EXIT
 20749     END-IF
 20750
 20751     .
 20752 8100-EXIT.
 20753     EXIT.
 20754
 20755 8110-READ-ERMAIL.
 20756     IF ERMAIL-OPEN = ' '
 20757        OPEN  I-O ERMAIL
 20758        MOVE 'X' TO ERMAIL-OPEN
 20759        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20760           NEXT SENTENCE
 20761        ELSE
 20762            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20763            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20764            MOVE EMSG TO WS-ABEND-MESSAGE
 20765            GO TO ABEND-PGM.
 20766
 20767     MOVE SPACES                 TO ERMAIL-FOUND.
 20768     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20769     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20770     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20771     MOVE PB-SV-STATE            TO MA-STATE.
 20772
 20773     READ ERMAIL.
 20774
 20775     IF ERMAIL-FILE-STATUS  = '00'
 20776         NEXT SENTENCE
 20777       ELSE
 20778        MOVE 'X'                 TO ERMAIL-FOUND.
 20779
 20780 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 385
* EL517.cbl
 20781     EXIT.
 20782
 20783 8120-REWRITE-ERMAIL.
 20784     REWRITE MAILING-DATA.
 20785
 20786 8120-EXIT.
 20787     EXIT.
 20788
 20789 8130-WRITE-ERMAIL.
 20790     WRITE MAILING-DATA.
 20791
 20792 8130-EXIT.
 20793     EXIT.
 20794
 20795 8140-UNLOCK-ERMAIL.
 20796     MOVE SPACES                 TO ERMAIL-FOUND.
 20797
 20798 8140-EXIT.
 20799     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 386
* EL517.cbl
 20801
 20802 8150-read-elcrtt.
 20803
 20804     IF ELCRTT-OPEN = ' '
 20805         OPEN input ELCRTT
 20806         MOVE 'X' TO ELCRTT-OPEN
 20807         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20808             continue
 20809         ELSE
 20810             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20811             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20812             MOVE EMSG               TO WS-ABEND-MESSAGE
 20813             GO TO ABEND-PGM
 20814         END-IF
 20815     END-IF
 20816
 20817     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20818     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20819     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20820
 20821     READ ELCRTT.
 20822
 20823     IF ELCRTT-FILE-STATUS  = '00'
 20824        move cs-ins-age-default-flag
 20825                                 to ws-ins-age-defaulted
 20826        move cs-jnt-age-default-flag
 20827                                 to ws-jnt-age-defaulted
 20828     END-IF
 20829
 20830     .
 20831 8150-exit.
 20832     exit.
 20833
 20834 8180-UPDATE-VIN-NUMBER.
 20835
 20836     IF ELCRTT-OPEN = ' '
 20837         OPEN I-O ELCRTT
 20838         MOVE 'X' TO ELCRTT-OPEN
 20839         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20840             NEXT SENTENCE
 20841         ELSE
 20842             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20843             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20844             MOVE EMSG               TO WS-ABEND-MESSAGE
 20845             GO TO ABEND-PGM
 20846         END-IF
 20847     END-IF.
 20848
 20849     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20850     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20851     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20852
 20853     READ ELCRTT.
 20854
 20855     IF ELCRTT-FILE-STATUS  = '00'
 20856        CONTINUE
 20857     ELSE
 20858        GO TO 8180-NOTFND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 387
* EL517.cbl
 20859     END-IF.
 20860
 20861     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20862         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20863         REWRITE CERTIFICATE-TRAILERS
 20864     END-IF.
 20865
 20866     GO TO 8180-EXIT.
 20867
 20868 8180-NOTFND.
 20869
 20870     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20871     MOVE 'CS'         TO CS-RECORD-ID.
 20872     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20873     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20874     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20875     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20876     WRITE CERTIFICATE-TRAILERS.
 20877
 20878 8180-EXIT.
 20879     EXIT.
 20880
 20881 8190-UPDATE-REFUND-CLAIM-FLAG.
 20882
 20883     IF ELCRTT-OPEN = ' '
 20884         OPEN I-O ELCRTT
 20885         MOVE 'X' TO ELCRTT-OPEN
 20886         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20887             NEXT SENTENCE
 20888         ELSE
 20889             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20890             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20891             MOVE EMSG               TO WS-ABEND-MESSAGE
 20892             GO TO ABEND-PGM
 20893         END-IF
 20894     END-IF.
 20895
 20896     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20897     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20898     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20899
 20900     READ ELCRTT.
 20901
 20902     IF ELCRTT-FILE-STATUS  = '00'
 20903        CONTINUE
 20904     ELSE
 20905        GO TO 8190-NOTFND
 20906     END-IF.
 20907
 20908     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20909     REWRITE CERTIFICATE-TRAILERS.
 20910
 20911     GO TO 8190-EXIT.
 20912
 20913 8190-NOTFND.
 20914
 20915     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20916     MOVE 'CS'         TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 388
* EL517.cbl
 20917     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20918     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20919     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20920     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20921     WRITE CERTIFICATE-TRAILERS.
 20922
 20923 8190-EXIT.
 20924     EXIT.
 20925
 20926 8195-UPDATE-AGE-FLAGS.
 20927     IF ELCRTT-OPEN = ' '
 20928         OPEN I-O ELCRTT
 20929         MOVE 'X' TO ELCRTT-OPEN
 20930         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20931             NEXT SENTENCE
 20932         ELSE
 20933             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20934             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20935             MOVE EMSG               TO WS-ABEND-MESSAGE
 20936             GO TO ABEND-PGM
 20937         END-IF
 20938     END-IF.
 20939
 20940     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20941     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20942     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20943
 20944     READ ELCRTT.
 20945
 20946     IF ELCRTT-FILE-STATUS  = '00'
 20947        CONTINUE
 20948     ELSE
 20949        GO TO 8195-NOTFND
 20950     END-IF.
 20951
 20952     IF WS-INS-AGE-SET = 'Y'
 20953        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20954     END-IF
 20955     IF WS-JNT-AGE-SET = 'Y'
 20956        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20957     END-IF
 20958
 20959     REWRITE CERTIFICATE-TRAILERS.
 20960
 20961     GO TO 8195-EXIT.
 20962
 20963 8195-NOTFND.
 20964
 20965     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20966     MOVE 'CS'         TO CS-RECORD-ID.
 20967     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20968     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20969     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20970     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20971     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20972     WRITE CERTIFICATE-TRAILERS.
 20973
 20974 8195-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 389
* EL517.cbl
 20975     EXIT.
 20976
 20977 8200-READ-REIN-TABLE.
 20978     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 20979     READ ERREIN.
 20980     ADD 1 TO RREI.
 20981
 20982     IF RE-CODE NOT = 'A'
 20983        PERFORM REIN-DATE-LOAD.
 20984
 20985     IF ERREIN-FILE-STATUS NOT = '00'
 20986          GO TO 8200-NOTFND.
 20987
 20988     GO TO 8200-EXIT.
 20989
 20990 8200-NOTFND.
 20991     MOVE 'N'                TO WS-REIN-READ-SW.
 20992
 20993 8200-EXIT.
 20994     EXIT.
 20995      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 390
* EL517.cbl
 20997
 20998 8300-READ-CTBL-TABLE.
 20999     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 21000     READ ERCTBL.
 21001     ADD 1 TO RCTB.
 21002
 21003     IF ERCTBL-FILE-STATUS NOT = '00'
 21004         GO TO 8300-NOTFND.
 21005
 21006     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21007
 21008     GO TO 8300-EXIT.
 21009
 21010 8300-NOTFND.
 21011     IF CTBL-SW = '0530'
 21012         MOVE 'AA'                     TO WS-AH-COMP-CD
 21013         MOVE '0550'                   TO CTBL-SW
 21014         MOVE '1'                      TO WS-CTBL-READ-SW
 21015         GO TO 8300-EXIT.
 21016
 21017     IF CTBL-SW = '0540'
 21018         MOVE 'AA'                     TO WS-LF-COMP-CD
 21019         MOVE '0550'                   TO CTBL-SW
 21020         MOVE '1'                      TO WS-CTBL-READ-SW
 21021         GO TO 8300-EXIT.
 21022
 21023     IF CTBL-SW = '0550'
 21024         MOVE '2'                      TO WS-CTBL-READ-SW
 21025         GO TO 8300-EXIT.
 21026
 21027 8300-EXIT.
 21028      EXIT.
 21029     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 391
* EL517.cbl
 21031
 21032 8400-GETMAIN-ERFORM.
 21033*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21034     EXIT.
 21035 8400-EXIT.
 21036     EXIT.
 21037
 21038 8450-READ-FORM-MASTER.
 21039
 21040     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 21041
 21042     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 21043
 21044     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21045        GO TO 8450-FORM-NOT-FOUND.
 21046
 21047     READ ERFORM NEXT.
 21048
 21049     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21050        GO TO 8450-FORM-NOT-FOUND.
 21051
 21052     MOVE 'Y'                    TO FORM-MASTER-SW.
 21053     GO TO 8450-EXIT.
 21054
 21055 8450-FORM-NOT-FOUND.
 21056
 21057     MOVE 'N'                    TO FORM-MASTER-SW.
 21058
 21059 8450-EXIT.
 21060     EXIT.
 21061
 21062 8500-DATE-CONVERT.
 21063     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 21064
 21065 8500-EXIT.
 21066     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 392
* EL517.cbl
 21068
 21069 8555-RELOAD-CONTROL-FILE.
 21070     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 21071
 21072 8555-EXIT.
 21073     EXIT.
 21074
 21075 8557-GETMAIN-ERPLAN.
 21076*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21077     EXIT.
 21078 8557-EXIT.
 21079     EXIT.
 21080
 21081 8560-GETMAIN.
 21082      MOVE 999 TO ERACCT-POINTER.
 21083
 21084 8560-EXIT.
 21085     EXIT.
 21086
 21087 8570-START-ACCOUNT-MASTER.
 21088     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21089
 21090 8570-EXIT.
 21091     EXIT.
 21092
 21093 8580-READ-ACCOUNT-MASTER.
 21094     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21095
 21096     IF WS-BROWSE-STARTED-SW = 'Y'
 21097         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 21098
 21099     IF ERACCT-FILE-STATUS = '23'
 21100         MOVE HIGH-VALUE TO ERACCT-KEY
 21101         GO TO 8580-EXIT.
 21102
 21103     IF ERACCT-FILE-STAT-1 = '9'
 21104         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21105         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21106         MOVE RMSG TO WS-ABEND-MESSAGE
 21107         GO TO ABEND-PGM.
 21108
 21109     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 21110
 21111     READ ERACCT NEXT.
 21112     ADD 1 TO RACC.
 21113
*21114     COPY ELCACCTI.
 21115******************************************************************04/14/98
 21116*                                                                *ELCACCTI
 21117*                            ELCACCTI                            *   LV003
 21118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21119*                            VMOD=2.001                          *ELCACCTI
 21120*                                                                *ELCACCTI
 21121*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 21122*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 21123*                                                                *ELCACCTI
 21124*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 21125*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 393
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 21126******************************************************************ELCACCTI
 21127     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 21128     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 21129     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 21130     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 21131     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 21132     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 21133     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 21134     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 21135     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 21136
 21137     IF ERACCT-FILE-STAT-1 = '9'
 21138         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21139         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21140         MOVE RMSG TO WS-ABEND-MESSAGE
 21141         GO TO ABEND-PGM.
 21142
 21143     IF ERACCT-FILE-STATUS NOT = '00'
 21144         MOVE HIGH-VALUE TO ERACCT-KEY
 21145         GO TO 8580-EXIT.
 21146
 21147     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 21148
 21149 8580-EXIT.
 21150     EXIT.
 21151
 21152 8582-READ-COMPENSATION-MASTER.
 21153     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 21154
 21155     READ ERCOMP
 21156
 21157     IF ERCOMP-FILE-STATUS NOT = '00'
 21158        GO TO 8582-COMP-NOT-FOUND
 21159     END-IF
 21160
 21161     MOVE 'Y'                    TO COMP-MASTER-SW.
 21162     GO TO 8582-EXIT
 21163     .
 21164 8582-COMP-NOT-FOUND.
 21165
 21166     MOVE 'N'                    TO COMP-MASTER-SW.
 21167
 21168 8582-EXIT.
 21169     EXIT.
 21170
 21171 8583-READ-ERAGTC.
 21172
 21173     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 21174
 21175     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 21176
 21177     IF ERAGTC-FILE-STATUS NOT = '00'
 21178        GO TO 8583-AGTC-NOT-FOUND
 21179     END-IF
 21180
 21181     .
 21182 8583-READ-ERAGTC-NEXT.
 21183
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 394
* EL517.cbl
 21184     READ ERAGTC NEXT RECORD
 21185
 21186     IF ERAGTC-FILE-STATUS NOT = '00'
 21187        GO TO 8583-AGTC-NOT-FOUND
 21188     END-IF
 21189
 21190*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 21191     GO TO 8583-EXIT
 21192     .
 21193 8583-AGTC-NOT-FOUND.
 21194
 21195     MOVE 'N'                    TO AGTC-MASTER-SW.
 21196
 21197 8583-EXIT.
 21198     EXIT.
 21199
 21200 8584-READ-BANK-CROSS-REF.
 21201     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 21202
 21203     READ ERBXRF
 21204
 21205     IF ERBXRF-FILE-STATUS NOT = '00'
 21206        GO TO 8584-BXRF-NOT-FOUND
 21207     END-IF
 21208
 21209     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21210     GO TO 8584-EXIT
 21211     .
 21212 8584-BXRF-NOT-FOUND.
 21213
 21214     MOVE 'N'                    TO BXRF-MASTER-SW.
 21215
 21216 8584-EXIT.
 21217     EXIT.
 21218
 21219 8585-READ-PLAN-MASTER.
 21220
 21221     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21222
 21223     READ ERPLAN.
 21224
 21225     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21226        GO TO 8585-PLAN-NOT-FOUND.
 21227
 21228     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21229     GO TO 8585-EXIT.
 21230
 21231 8585-PLAN-NOT-FOUND.
 21232
 21233     MOVE 'N'                    TO PLAN-MASTER-SW.
 21234
 21235 8585-EXIT.
 21236     EXIT.
 21237
 21238 8586-READ-LOAN-OFFICER.
 21239
 21240     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21241
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 395
* EL517.cbl
 21242     READ ERLOFC
 21243
 21244     IF ERLOFC-FILE-STATUS NOT = '00'
 21245        MOVE 'N'                 TO LOFC-MASTER-SW
 21246     ELSE
 21247        MOVE 'Y'                 TO LOFC-MASTER-SW
 21248     END-IF
 21249
 21250     .
 21251 8586-EXIT.
 21252     EXIT.
 21253
 21254
 21255 8587-START-ERPDEF.
 21256
 21257     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21258
 21259     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21260     IF ERPDEF-FILE-STATUS NOT = '00'
 21261        MOVE 'N'                 TO PDEF-MASTER-SW
 21262     ELSE
 21263        MOVE 'Y'                 TO PDEF-MASTER-SW
 21264     END-IF
 21265
 21266
 21267     .
 21268 8587-EXIT.
 21269     EXIT.
 21270
 21271 8588-READ-ERPDEF.
 21272
 21273     READ ERPDEF NEXT RECORD
 21274
 21275     IF ERPDEF-FILE-STATUS NOT = '00'
 21276        MOVE 'N'                 TO PDEF-MASTER-SW
 21277     ELSE
 21278        MOVE 'Y'                 TO PDEF-MASTER-SW
 21279     END-IF
 21280
 21281     .
 21282 8588-EXIT.
 21283     EXIT.
 21284
 21285 8589-ENDBR-ERPDEF.
 21286
 21287     .
 21288 8589-EXIT.
 21289     EXIT.
 21290
 21291 8590-READ-CERT-MASTER.
 21292     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21293     READ ELCERT.
 21294     ADD 1 TO RCER.
 21295
 21296     IF ELCERT-FILE-STATUS NOT = '00'
 21297         NEXT SENTENCE
 21298     ELSE
 21299         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 396
* EL517.cbl
 21300
 21301     MOVE '1'                     TO CERT-STATUS-SW.
 21302
 21303     IF PB-COMPANY-ID = 'UCL'
 21304         IF WS-ERROR = ER-2799
 21305             GO TO 8590-EXIT.
 21306
 21307     IF PB-CANCELLATION
 21308        MOVE ER-2726              TO  WS-ERROR
 21309        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21310        IF ACCOUNT-MAST-FOUND
 21311           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21312           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21313           GO TO 8590-EXIT
 21314        ELSE
 21315           GO TO 8590-EXIT.
 21316
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 397
* EL517.cbl
 21318
 21319 8590-EXIT.
 21320     EXIT.
 21321
 21322 8750-START-ELSTAT.
 21323
 21324     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21325
 21326     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21327     IF ELSTAT-FILE-STATUS NOT = '00'
 21328        MOVE 'N'                 TO STAT-MASTER-SW
 21329     ELSE
 21330        MOVE 'Y'                 TO STAT-MASTER-SW
 21331     END-IF
 21332
 21333     .
 21334 8750-EXIT.
 21335     EXIT.
 21336
 21337 8752-READ-ELSTAT.
 21338
 21339     READ ELSTAT NEXT RECORD
 21340
 21341     IF ELSTAT-FILE-STATUS NOT = '00'
 21342        MOVE 'N'                 TO STAT-MASTER-SW
 21343     ELSE
 21344        MOVE 'Y'                 TO STAT-MASTER-SW
 21345     END-IF
 21346
 21347     .
 21348 8752-EXIT.
 21349     EXIT.
 21350
 21351 8800-GET-COMP-RATE.
 21352     MOVE +1 TO IB.
 21353     IF WS-COMM-CK-AMT > CT-TBF (1)
 21354         ADD +9 TO IB
 21355         IF WS-COMM-CK-AMT > CT-TBF (2)
 21356             ADD +9 TO IB
 21357             IF WS-COMM-CK-AMT > CT-TBF (3)
 21358                MOVE ZEROS       TO WS-WK-RATE
 21359                GO TO 8800-EXIT.
 21360
 21361     IF PB-I-AGE > CT-AGE (1)
 21362         ADD +3 TO IB
 21363         IF PB-I-AGE > CT-AGE (2)
 21364             ADD +3 TO IB
 21365             IF PB-I-AGE > CT-AGE (3)
 21366                MOVE ZEROS       TO WS-WK-RATE
 21367                GO TO 8800-EXIT.
 21368
 21369     IF WS-WORK-TERM > CT-TRM (1)
 21370         ADD +1 TO IB
 21371         IF WS-WORK-TERM > CT-TRM (2)
 21372             ADD +1 TO IB
 21373             IF WS-WORK-TERM > CT-TRM (3)
 21374                MOVE ZEROS       TO WS-WK-RATE
 21375                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 398
* EL517.cbl
 21376
 21377     IF CT-RT (IB) NOT NUMERIC
 21378         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21379         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21380         GO TO 8800-GET-COMP-RATE.
 21381
 21382     MOVE CT-RT (IB) TO WS-WK-RATE.
 21383
 21384 8800-EXIT.
 21385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 399
* EL517.cbl
 21387
 21388 8900-ADDRESS-FILE.
 21389     EXIT.
 21390 8900-ADDRESS-EXIT.
 21391     EXIT.
 21392
 21393 9000-READ-CONTROL.
 21394     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21395     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21396
 21397     IF ELCNTL-FILE-STATUS NOT = '00'
 21398         GO TO 9000-NOTFND.
 21399
 21400     READ ELCNTL NEXT.
 21401     ADD 1 TO RCNT.
 21402
 21403     IF ELCNTL-FILE-STATUS NOT = '00'
 21404         GO TO 9000-NOTFND.
 21405
 21406     IF CNTL-REC-TYPE = '1'
 21407         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21408         MOVE 1            TO ELCNTL-POINTER.
 21409
 21410     IF CNTL-REC-TYPE = '6'
 21411         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21412         MOVE 6            TO ELCNTL-POINTER.
 21413
 21414     GO TO 9000-EXIT.
 21415
 21416 9000-NOTFND.
 21417     IF RC-SW-1 = '1'
 21418         MOVE ER-2616             TO WS-ERROR
 21419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21420         GO TO 9000-EXIT.
 21421
 21422     IF RC-SW-1 = '2'
 21423         MOVE ER-2602             TO WS-ERROR
 21424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21425         GO TO 9000-EXIT.
 21426
 21427     GO TO 9000-EXIT.
 21428
 21429 9000-EXIT.
 21430     EXIT.
 21431      EXIT.
 21432
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 400
* EL517.cbl
 21434 9100-READ-CONTROL.
 21435     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21436     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21437
 21438     IF ELCNTL-FILE-STATUS NOT = '00'
 21439         GO TO 9100-NOTFND.
 21440
 21441     READ ELCNTL NEXT.
 21442     ADD 1 TO RCNT.
 21443
 21444     IF ELCNTL-FILE-STATUS NOT = '00'
 21445         GO TO 9100-NOTFND.
 21446
 21447     IF CNTL-REC-TYPE = '3'
 21448         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21449         MOVE 3            TO ELCNTL-POINTER
 21450         GO TO 9100-EXIT.
 21451
 21452     IF CNTL-REC-TYPE = '4'
 21453         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21454         MOVE 4            TO ELCNTL-POINTER
 21455         GO TO 9100-EXIT.
 21456
 21457     IF CNTL-REC-TYPE = '5'
 21458         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21459         MOVE 5            TO ELCNTL-POINTER
 21460         GO TO 9100-EXIT.
 21461
 21462     IF CNTL-REC-TYPE = 'L'
 21463         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21464         MOVE 10           TO ELCNTL-POINTER
 21465         GO TO 9100-EXIT.
 21466
 21467     IF CNTL-REC-TYPE = 'A'
 21468         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21469         MOVE 11           TO ELCNTL-POINTER
 21470         GO TO 9100-EXIT.
 21471
 21472 9100-NOTFND.
 21473     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21474
 21475     IF RC-SW-2 = '1'
 21476        MOVE '1'                 TO LF-BENEFIT-ERROR
 21477        MOVE ER-2604             TO WS-ERROR
 21478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21479        GO TO 9100-EXIT.
 21480
 21481     IF RC-SW-2 = '2'
 21482        MOVE '1'                 TO AH-BENEFIT-ERROR
 21483        MOVE ER-2605             TO WS-ERROR
 21484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21485        GO TO 9100-EXIT.
 21486
 21487     IF RC-SW-2 = '3'
 21488        MOVE ER-2603             TO WS-ERROR
 21489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21490        GO TO 9100-EXIT.
 21491
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 401
* EL517.cbl
 21492     IF RC-SW-2 = '4'
 21493         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21494         GO TO 9100-EXIT.
 21495
 21496     IF RC-SW-2 = '5'
 21497         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21498         IF WS-AH-INPUT-CD-1 = SPACE
 21499             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21500         ELSE
 21501             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21502
 21503 9100-EXIT.
 21504     EXIT.
 21505      EXIT.
 21506
 21507 9200-CONTROL-GETMAIN.
 21508*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21509     EXIT.
 21510 9200-EXIT.
 21511     EXIT.
 21512
 21513 9250-UNLOCK-RETURN.
 21514*  DUMMIED IN THE BATCH EL517 ....
 21515     EXIT.
 21516 9250-UNLOCK-EXIT.
 21517     EXIT.
 21518      EXIT.
 21519
 21520 9300-ACCUM-BATCH-TOTALS.
 21521         IF PB-ISSUE
 21522             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21523             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21524             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21525             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21526             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21527             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21528             ADD 1                       TO WS-ISSUE-CNT
 21529         ELSE
 21530             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21531             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21532             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21533             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21534             ADD 1                       TO WS-CANCEL-CNT.
 21535
 21536 9400-EXIT.
 21537     EXIT.
 21538
 21539 9990-RETURN.
 21540*    END BROUSE OF ACCOUNT FILE
 21541     EXIT.
 21542
 21543 9990-EXIT.
 21544     EXIT.
 21545
 21546
 21547****Check for CRTO record, add one if not found.
 21548 9991-CHECK-FOR-ELCRTO.
 21549     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 402
* EL517.cbl
 21550         OPEN I-O ELCRTO
 21551         MOVE 'X' TO ELCRTO-OPEN
 21552         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21553             NEXT SENTENCE
 21554         ELSE
 21555             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21556             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21557             MOVE EMSG               TO WS-ABEND-MESSAGE
 21558             GO TO ABEND-PGM
 21559         END-IF
 21560     END-IF.
 21561     IF ELCRTT-OPEN = ' '
 21562         OPEN I-O ELCRTT
 21563         MOVE 'X' TO ELCRTT-OPEN
 21564         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21565             NEXT SENTENCE
 21566         ELSE
 21567             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21568             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21569             MOVE EMSG               TO WS-ABEND-MESSAGE
 21570             GO TO ABEND-PGM
 21571         END-IF
 21572     END-IF.
 21573     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21574     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21575     MOVE +0                     TO ELCRTO-SEQ-NO
 21576     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21577
 21578     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21579
 21580     IF ELCRTO-FILE-STATUS NOT = '00'
 21581         GO TO 9991-CRTO-NOT-FOUND
 21582     END-IF.
 21583
 21584     READ ELCRTO NEXT.
 21585     IF ELCRTO-FILE-STATUS = '00'
 21586        AND (OC-CONTROL-PRIMARY (1:33) =
 21587                 PB-CONTROL-BY-ACCOUNT (1:33))
 21588        AND (OC-RECORD-TYPE = 'I')
 21589           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21590               GO TO 9991-CHECK-INDICATORS
 21591           ELSE
 21592               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21593               GO TO 9991-CRTO-ADD-REC
 21594           END-IF
 21595     END-IF.
 21596
 21597 9991-CRTO-NOT-FOUND.
 21598
 21599     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21600     MOVE 'OC'                TO OC-RECORD-ID
 21601     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21602                              TO OC-CONTROL-PRIMARY (1:33)
 21603     MOVE +4096               TO OC-KEY-SEQ-NO.
 21604
 21605 9991-CRTO-ADD-REC.
 21606
 21607     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 403
* EL517.cbl
 21608     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21609     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21610     MOVE 'I'                 TO OC-RECORD-TYPE
 21611     IF PB-ISSUE
 21612         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21613         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21614         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21615         MOVE PB-I-AGE               TO OC-INS-AGE
 21616         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21617         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21618         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21619         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21620         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21621         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21622         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21623         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21624         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21625         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21626         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21627         IF PB-I-JOINT-COMMISSION > +0
 21628             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21629         ELSE
 21630             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21631         END-IF
 21632         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21633         MOVE +0                     TO OC-LF-CANCEL-AMT
 21634                                        OC-LF-ITD-CANCEL-AMT
 21635         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21636         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21637         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21638         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21639         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21640         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21641         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21642         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21643         MOVE +0                     TO OC-AH-CANCEL-AMT
 21644                                        OC-AH-ITD-CANCEL-AMT
 21645         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21646         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21647         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21648     ELSE
 21649         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21650         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21651         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21652         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21653         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21654         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21655         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21656         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21657         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21658          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21659             MOVE SPACES             TO OC-LF-BENCD
 21660             MOVE ZEROS              TO OC-LF-TERM
 21661                                        OC-LF-BEN-AMT
 21662                                        OC-LF-PRM-AMT
 21663                                        OC-LF-ALT-BEN-AMT
 21664                                        OC-LF-ALT-PRM-AMT
 21665                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 404
* EL517.cbl
 21666                                        OC-LF-CANCEL-AMT
 21667             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21668             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21669         ELSE
 21670             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21671             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21672             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21673             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21674             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21675             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21676             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21677             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21678             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21679             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21680         END-IF
 21681         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21682         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21683          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21684             MOVE SPACES             TO OC-AH-BENCD
 21685             MOVE ZEROS              TO OC-AH-TERM
 21686                                        OC-AH-BEN-AMT
 21687                                        OC-AH-PRM-AMT
 21688                                        OC-AH-COMM-PCT
 21689                                        OC-AH-CANCEL-AMT
 21690                                        OC-AH-CP
 21691             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21692             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21693         ELSE
 21694             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21695             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21696             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21697             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21698             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21699             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21700             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21701             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21702             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21703         END-IF
 21704         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21705         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21706         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21707         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21708     END-IF
 21709     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21710
 21711     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21712     IF ERMAIL-FOUND = ' '
 21713         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21714     END-IF.
 21715
 21716     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21717     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21718     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21719
 21720     READ ELCRTT
 21721
 21722     IF ELCRTT-FILE-STATUS  = '00'
 21723         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 405
* EL517.cbl
 21724         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21725     END-IF.
 21726
 21727     WRITE ORIGINAL-CERTIFICATE.
 21728
 21729     GO TO 9991-EXIT.
 21730
 21731 9991-CHECK-INDICATORS.
 21732
 21733     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21734         GO TO 9991-EXIT
 21735     END-IF.
 21736
 21737     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21738         GO TO 9991-EXIT
 21739     END-IF.
 21740
 21741     IF PB-ISSUE
 21742        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21743        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21744        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21745        MOVE PB-I-AGE               TO OC-INS-AGE
 21746        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21747        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21748        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21749        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21750        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21751        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21752        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21753        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21754        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21755        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21756        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21757        IF PB-I-JOINT-COMMISSION > +0
 21758            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21759        ELSE
 21760            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21761        END-IF
 21762        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21763        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21764        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21765        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21766        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21767        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21768        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21769        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21770        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21771
 21772        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21773        IF ERMAIL-FOUND = ' '
 21774           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21775        END-IF
 21776
 21777        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21778        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21779        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21780        READ ELCRTT
 21781        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 406
* EL517.cbl
 21782           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21783           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21784        END-IF
 21785
 21786     ELSE
 21787        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21788           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21789           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21790           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21791        END-IF
 21792        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21793           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21794           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21795           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21796        END-IF
 21797        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21798     END-IF
 21799
 21800     REWRITE ORIGINAL-CERTIFICATE.
 21801
 21802 9991-EXIT.
 21803     EXIT.
 21804
 21805
 21806 9999-SET-PNDB-ERROR-FLAGS.
 21807
 21808     IF PB-BATCH-TRAILER
 21809        GO TO 9999-REWRITE-RECORD.
 21810
 21811     IF PB-COMMON-ERRORS = LOW-VALUES
 21812        GO TO 9999-SET-ERROR-FLAGS.
 21813
 21814 9999-FORMAT-ERRORS.
 21815
 21816     MOVE +0                     TO SUB1.
 21817
 21818 9999-ERROR-LOOP.
 21819
 21820     ADD +1                      TO SUB1.
 21821
 21822     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21823        GO TO 9999-SET-ERROR-FLAGS.
 21824
 21825     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21826
 21827     READ ELCERR.
 21828
 21829     IF ELCERR-FILE-STATUS NOT = '00'
 21830        ADD +1                       TO EMI-FATAL-CTR
 21831        GO TO  9999-ERROR-LOOP.
 21832
*21833                                 COPY ELCERRPD.
 21834******************************************************************04/15/98
 21835*                                                                *ELCERRPD
 21836*                                                                *ELCERRPD
 21837*                            ELCERRPD                            *   LV002
 21838*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21839*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 407
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21840*                                                                *ELCERRPD
 21841*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21842*                                                                *ELCERRPD
 21843******************************************************************ELCERRPD
 21844                                                                  ELCERRPD
 21845     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21846         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21847                                                                  ELCERRPD
 21848     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21849                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21850        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21851            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21852                                                                  ELCERRPD
 21853     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21854        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21855            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21856                                                                  ELCERRPD
 21857     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21858        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21859            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21860                                                                  ELCERRPD
 21861     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21862        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21863            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21864                                                                  ELCERRPD
 21865     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21866        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21867            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21868                                                                  ELCERRPD
 21869     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21870        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21871            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21872                                                                  ELCERRPD
 21873     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21874        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21875            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21876                                                                  ELCERRPD
 21877     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21878        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21879            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21880                                                                  ELCERRPD
 21881     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21882        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21883            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21884                                                                  ELCERRPD
 21885     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21886        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21887            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21888                                                                  ELCERRPD
 21889     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21890             OR                                                   ELCERRPD
 21891         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21892                                                                  ELCERRPD
 21893         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21894             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21895                                                                  ELCERRPD
 21896     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21897         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 408
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21898             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21899
 21900     IF E-CLIENT-ID = CLIENT-DCC
 21901        IF EM-MESSAGE-NUMBER = 2719
 21902           MOVE 'W'              TO EM-ERROR-SEVERITY
 21903        END-IF
 21904     END-IF
 21905
 21906     .
 21907
 21908     IF EM-ERROR-SEVERITY = 'W'
 21909        ADD +1                   TO EMI-WARNING-CTR
 21910        GO TO  9999-ERROR-LOOP.
 21911
 21912     IF EM-ERROR-SEVERITY = 'F'
 21913        ADD +1                   TO EMI-FORCABLE-CTR
 21914        GO TO  9999-ERROR-LOOP.
 21915
 21916     IF EM-ERROR-SEVERITY = 'X'
 21917        ADD +1                   TO EMI-FATAL-CTR.
 21918
 21919     GO TO 9999-ERROR-LOOP.
 21920
 21921 9999-SET-ERROR-FLAGS.
 21922
 21923     IF EMI-FATAL-CTR NOT = ZEROS
 21924        MOVE 'X'                 TO PB-FATAL-FLAG
 21925        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21926
 21927     IF EMI-FORCABLE-CTR NOT = ZEROS
 21928        IF PB-ISSUE
 21929           IF PB-ISSUE-FORCE
 21930              MOVE 'F'           TO PB-FORCE-ER-CD
 21931             ELSE
 21932              MOVE 'X'           TO PB-FORCE-ER-CD
 21933          ELSE
 21934           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21935              MOVE 'F'           TO PB-FORCE-ER-CD
 21936             ELSE
 21937              MOVE 'X'           TO PB-FORCE-ER-CD.
 21938
 21939 9999-CONT-SET-ERROR-FLAGS.
 21940
 21941     IF EMI-WARNING-CTR NOT = ZEROS
 21942        MOVE 'W'                 TO PB-WARN-ER-CD.
 21943
 21944     IF PB-UNFORCED-ERRORS OR
 21945        PB-FATAL-ERRORS    OR
 21946        PB-RECORD-ON-HOLD  OR
 21947        PB-RECORD-RETURNED
 21948*        OR
 21949*       PB-CANCELLATION
 21950          NEXT SENTENCE
 21951        ELSE
 21952          GO TO 9999-REWRITE-RECORD.
 21953
 21954     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21955     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 409
* EL517.cbl
 21956     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21957     MOVE PB-SV-STATE            TO CERT-STATE.
 21958
 21959     READ ELCERT.
 21960
 21961     IF PB-ISSUE
 21962     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21963        GO TO 9999-REWRITE-CERT-MASTER.
 21964
 21965     IF PB-ISSUE
 21966        IF PB-RECORD-RETURNED
 21967            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21968        ELSE
 21969             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21970
 21971     IF PB-CANCELLATION
 21972        IF PB-RECORD-RETURNED
 21973            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 21974        ELSE
 21975            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 21976               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 21977            ELSE
 21978               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 21979
 21980 9999-REWRITE-CERT-MASTER.
 21981
 21982     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 21983        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 21984        GO TO 9999-REWRITE-RECORD.
 21985
 21986     REWRITE CERTIFICATE-MASTER.
 21987     ADD 1 TO WCER.
 21988
 21989 9999-REWRITE-RECORD.
 21990     IF NOT PB-BATCH-TRAILER
 21991         IF PB-ISSUE
 21992             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21993             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21994             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21995             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21996             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 21997             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 21998             ADD 1                   TO WS-ISSUE-CNT
 21999         ELSE
 22000             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 22001             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 22002             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 22003             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 22004             ADD 1                   TO WS-CANCEL-CNT
 22005     ELSE
 22006         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 22007         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 22008         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 22009         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 22010         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 22011         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 22012         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 22013         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 410
* EL517.cbl
 22014         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 22015         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 22016         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 22017                                        WS-LF-ISS-ENTERED
 22018                                        WS-AH-ISS-COMPUTED
 22019                                        WS-AH-ISS-ENTERED
 22020                                        WS-LF-CAN-COMPUTED
 22021                                        WS-LF-CAN-ENTERED
 22022                                        WS-AH-CAN-COMPUTED
 22023                                        WS-AH-CAN-ENTERED
 22024                                        WS-ISSUE-CNT
 22025                                        WS-CANCEL-CNT
 22026         MOVE SPACE                  TO PB-FATAL-FLAG.
 22027
 22028     IF PB-BATCH-TRAILER
 22029         IF PB-B-LF-ISS-PRM-REMITTED =
 22030            PB-B-LF-ISS-PRM-ENTERED   AND
 22031            PB-B-LF-CAN-PRM-REMITTED =
 22032            PB-B-LF-CAN-PRM-ENTERED   AND
 22033            PB-B-AH-ISS-PRM-REMITTED =
 22034            PB-B-AH-ISS-PRM-ENTERED   AND
 22035            PB-B-AH-CAN-PRM-REMITTED =
 22036            PB-B-AH-CAN-PRM-ENTERED   AND
 22037            PB-B-ISSUE-CNT-REMITTED  =
 22038            PB-B-ISSUE-CNT-ENTERED    AND
 22039            PB-B-CANCEL-CNT-REMITTED =
 22040            PB-B-CANCEL-CNT-ENTERED
 22041             MOVE SPACE          TO PB-OUT-BAL-CD
 22042           ELSE
 22043             MOVE 'O'            TO PB-OUT-BAL-CD.
 22044
 22045     REWRITE PENDING-BUSINESS.
 22046
 22047     ADD 1 TO WPND.
 22048
 22049     GO TO 0100-READ-PENDING.
 22050
 22051 9999-EXIT.
 22052     EXIT.
 22053
 22054******************************************************************
 22055*                                                                *
 22056*            E R R O R   F O R M A T   R O U T I N E             *
 22057*                                                                *
 22058******************************************************************
 22059
 22060 9900-ERROR-FORMAT.
 22061
 22062     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 22063                   PB-COMMON-ERROR (2)  OR
 22064                   PB-COMMON-ERROR (3)  OR
 22065                   PB-COMMON-ERROR (4)  OR
 22066                   PB-COMMON-ERROR (5)  OR
 22067                   PB-COMMON-ERROR (6)  OR
 22068                   PB-COMMON-ERROR (7)  OR
 22069                   PB-COMMON-ERROR (8)  OR
 22070                   PB-COMMON-ERROR (9)  OR
 22071                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 411
* EL517.cbl
 22072        GO TO 9900-EXIT.
 22073
 22074     IF PB-NO-OF-ERRORS = +10
 22075        GO TO 9900-EXIT.
 22076
 22077     ADD +1                      TO PB-NO-OF-ERRORS.
 22078     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22079                                       (PB-NO-OF-ERRORS).
 22080
 22081
 22082 9900-EXIT.
 22083     EXIT.
 22084
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 412
* EL517.cbl
 22086 9999-DONE.
 22087*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 22088
 22089     IF DTE-CLIENT NOT EQUAL 'DMD'
 22090          GO TO 9999-DONE-CONT.
 22091
 22092     CLOSE ERRESS
 22093           ERRESC.
 22094
 22095     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 22096     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 22097     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 22098     IF DMPF-RETURN-CODE EQUAL 'Z3'
 22099         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22100         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 22101         MOVE CMSG               TO WS-ABEND-MESSAGE
 22102         GO TO ABEND-PGM.
 22103
 22104     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 22105     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 22106     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 22107     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22108         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22109         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 22110         MOVE CMSG               TO WS-ABEND-MESSAGE
 22111         GO TO ABEND-PGM.
 22112
 22113     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 22114     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 22115     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 22116     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22117         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22118         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 22119         MOVE CMSG               TO WS-ABEND-MESSAGE
 22120         GO TO ABEND-PGM.
 22121
 22122     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22123     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 22124     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22125     IF DCUA-RETURN-CODE EQUAL 'Z3'
 22126         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22127         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 22128         MOVE CMSG               TO WS-ABEND-MESSAGE
 22129         GO TO ABEND-PGM.
 22130
 22131     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 22132     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 22133     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 22134     IF DPRB-RETURN-CODE EQUAL 'Z3'
 22135         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22136         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 22137         MOVE CMSG               TO WS-ABEND-MESSAGE
 22138         GO TO ABEND-PGM.
 22139
 22140     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 22141     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 22142     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 22143     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 413
* EL517.cbl
 22144         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22145         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 22146         MOVE CMSG               TO WS-ABEND-MESSAGE
 22147         GO TO ABEND-PGM.
 22148
 22149     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 22150     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 22151     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 22152     IF DVSC-RETURN-CODE EQUAL 'Z3'
 22153         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22154         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 22155         MOVE CMSG               TO WS-ABEND-MESSAGE
 22156         GO TO ABEND-PGM.
 22157
 22158*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22159
 22160 9999-DONE-CONT.
 22161
 22162     IF ERPNDM-OPEN = 'X'
 22163        CLOSE ERPNDM.
 22164
 22165     IF ERMAIL-OPEN = 'X'
 22166        CLOSE ERMAIL.
 22167
 22168     IF ELMSTR-OPEN = 'X'
 22169        CLOSE ELMSTR.
 22170
 22171     IF ELCRTT-OPEN = 'X'
 22172        CLOSE ELCRTT
 22173     END-IF.
 22174
 22175     IF ELCRTO-OPEN = 'X'
 22176        CLOSE ELCRTO
 22177     END-IF.
 22178
 22179     CLOSE      ELCNTL
 22180                ELCERR
 22181                ERPNDB
 22182                ERREIN
 22183                ELCERT
 22184                ERCTBL
 22185                ERPLAN
 22186                ERACCT
 22187                ERBXRF
 22188                ERAGTC
 22189                ERCOMP.
 22190
 22191     IF DTE-CLIENT = 'DCC'
 22192        CLOSE ERPDEF ELSTAT
 22193        IF ERPDEF-FILE-STATUS NOT = '00'
 22194            MOVE ERPDEF-FILE-STATUS
 22195                                 TO WS-ABEND-FILE-STATUS
 22196            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 22197            MOVE CMSG            TO WS-ABEND-MESSAGE
 22198            GO TO ABEND-PGM
 22199        END-IF
 22200        IF ELSTAT-FILE-STATUS NOT = '00'
 22201            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 414
* EL517.cbl
 22202                                 TO WS-ABEND-FILE-STATUS
 22203            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22204            MOVE CMSG            TO WS-ABEND-MESSAGE
 22205            GO TO ABEND-PGM
 22206        END-IF
 22207     END-IF
 22208
 22209     IF ELCNTL-FILE-STATUS NOT = '00'
 22210         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22211         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22212         MOVE CMSG TO WS-ABEND-MESSAGE
 22213         GO TO ABEND-PGM.
 22214
 22215     IF ERPNDB-FILE-STATUS NOT = '00'
 22216         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22217         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22218         MOVE CMSG TO WS-ABEND-MESSAGE
 22219         GO TO ABEND-PGM.
 22220
 22221     IF ERREIN-FILE-STATUS NOT = '00'
 22222         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22223         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22224         MOVE CMSG TO WS-ABEND-MESSAGE
 22225         GO TO ABEND-PGM.
 22226
 22227     IF ELCERT-FILE-STATUS NOT = '00'
 22228         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22229         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22230         MOVE CMSG TO WS-ABEND-MESSAGE
 22231         GO TO ABEND-PGM.
 22232
 22233     IF ERMAIL-OPEN   = 'X'
 22234       IF ERMAIL-FILE-STATUS NOT = '00'
 22235           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22236           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22237           MOVE CMSG TO WS-ABEND-MESSAGE
 22238           GO TO ABEND-PGM.
 22239
 22240     IF ERPNDM-OPEN   = 'X'
 22241       IF ERPNDM-FILE-STATUS NOT = '00'
 22242            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22243            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22244            MOVE CMSG TO WS-ABEND-MESSAGE
 22245            GO TO ABEND-PGM.
 22246
 22247     IF ELCRTT-OPEN = 'X'
 22248         IF ELCRTT-FILE-STATUS NOT = '00'
 22249             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22250             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22251             MOVE CMSG TO WS-ABEND-MESSAGE
 22252             GO TO ABEND-PGM
 22253         END-IF
 22254     END-IF.
 22255
 22256     IF ELCRTO-OPEN = 'X'
 22257         IF ELCRTO-FILE-STATUS NOT = '00'
 22258             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22259             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 415
* EL517.cbl
 22260             MOVE CMSG TO WS-ABEND-MESSAGE
 22261             GO TO ABEND-PGM
 22262         END-IF
 22263     END-IF.
 22264
 22265     IF ERCTBL-FILE-STATUS NOT = '00'
 22266         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22267         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22268         MOVE CMSG TO WS-ABEND-MESSAGE
 22269         GO TO ABEND-PGM.
 22270
 22271     IF ERPLAN-FILE-STATUS NOT = '00'
 22272        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22273        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22274        MOVE CMSG TO WS-ABEND-MESSAGE
 22275        GO TO ABEND-PGM.
 22276
 22277     IF ERACCT-FILE-STATUS NOT = '00'
 22278         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22279         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22280         MOVE CMSG TO WS-ABEND-MESSAGE
 22281         GO TO ABEND-PGM.
 22282
 22283     IF ERCOMP-FILE-STATUS NOT = '00'
 22284         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22285         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22286         MOVE CMSG TO WS-ABEND-MESSAGE
 22287         GO TO ABEND-PGM.
 22288
 22289     IF ERBXRF-FILE-STATUS NOT = '00'
 22290         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22291         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22292         MOVE CMSG TO WS-ABEND-MESSAGE
 22293         GO TO ABEND-PGM.
 22294
 22295     IF ERAGTC-FILE-STATUS NOT = '00'
 22296         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22297         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22298         MOVE CMSG TO WS-ABEND-MESSAGE
 22299         GO TO ABEND-PGM.
 22300
 22301     IF ELCERR-FILE-STATUS NOT = '00'
 22302         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22303         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22304         MOVE CMSG TO WS-ABEND-MESSAGE
 22305         GO TO ABEND-PGM.
 22306
 22307     MOVE 'C'                     TO CP-IO-FUNCTION.
 22308     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22309
 22310     IF IO-ERROR
 22311        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22312        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22313        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22314        GO TO ABEND-PGM.
 22315
 22316     OPEN OUTPUT PRINT-FILE.
 22317
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 416
* EL517.cbl
 22318     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22319     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22320     MOVE ALPH-DATE              TO H3-DATE.
 22321     MOVE TRAN-CT                TO SUM-TOT.
 22322
 22323 7000-PRT-HDG.
 22324     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22325     PERFORM 7000-PRINT-LINE.
 22326     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22327     PERFORM 7000-PRINT-LINE.
 22328     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22329     PERFORM 7000-PRINT-LINE.
 22330     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22331     PERFORM 7000-PRINT-LINE.
 22332     GO TO 9999-END-JOB.
 22333
 22334 7000-HDG-XIT.
 22335     EXIT.
 22336
 22337 7000-PRINT-LINE.
*22338                     COPY ELCPRT2X.
 22339******************************************************************04/15/98
 22340*                                                                *ELCPRT2X
 22341*                                                                *ELCPRT2X
 22342*                            ELCPRT2X.                           *   LV002
 22343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22344*                            VMOD=2.002                          *   CL**2
 22345*                                                                *ELCPRT2X
 22346*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22347*                                                                *ELCPRT2X
 22348*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22349*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22350*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22351*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22352*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22353*                                                                *ELCPRT2X
 22354*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22355*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22356******************************************************************ELCPRT2X
 22357                                                                  ELCPRT2X
 22358     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22359         FICH-OPEN   = SPACE                                      ELCPRT2X
 22360         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22361         OPEN OUTPUT FICH.                                        ELCPRT2X
 22362                                                                  ELCPRT2X
 22363     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22364         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22365             OPEN I-O ELREPT                                      ELCPRT2X
 22366             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22367                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22368                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22369                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22370                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22371                 GO TO ABEND-PGM                                  ELCPRT2X
 22372             ELSE                                                 ELCPRT2X
 22373                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22374                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22375                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 417
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22376                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22377                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22378                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22379                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22380                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22381                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22382                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22383                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22384                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22385                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22386                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22387                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22388                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22389                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22390                                                                  ELCPRT2X
 22391     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22392        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22393         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22394         GO TO ABEND-PGM.                                         ELCPRT2X
 22395                                                                  ELCPRT2X
 22396     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22397         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22398         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22399             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22400                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22401                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22402                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22403                     INVALID KEY                                  ELCPRT2X
 22404                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22405                         CLOSE ELREPT                             ELCPRT2X
 22406                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22407                                                                  ELCPRT2X
 22408     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22409         MOVE X                      TO  P-CTL                    ELCPRT2X
 22410         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22411                                                                  ELCPRT2X
 22412     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22413       MOVE X                        TO  P-CTL                    ELCPRT2X
 22414       IF P-CTL = ' '                                             ELCPRT2X
 22415         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22416       ELSE                                                       ELCPRT2X
 22417         IF P-CTL = '0'                                           ELCPRT2X
 22418           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22419         ELSE                                                     ELCPRT2X
 22420           IF P-CTL = '-'                                         ELCPRT2X
 22421             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22422           ELSE                                                   ELCPRT2X
 22423             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22424                                                                  ELCPRT2X
 22425     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22426                                                                  ELCPRT2X
 22427 DTE-REPORT-DELETE.                                               ELCPRT2X
 22428     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22429         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22430         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22431                                                                  ELCPRT2X
 22432     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22433           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 418
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22434                                                                  ELCPRT2X
 22435     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22436        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22437         DELETE ELREPT RECORD                                     ELCPRT2X
 22438         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22439                                                                  ELCPRT2X
 22440 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22441     EXIT.                                                        ELCPRT2X
 22442                                                                  ELCPRT2X
 22443 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22444     EXIT.                                                        ELCPRT2X
 22445******************************************************************ELCPRT2X
 22446
 22447 REIN-DATE-LOAD.
*22448     COPY ELCRENM1.
 22449******************************************************************04/15/98
 22450*                                                                *ELCRENM1
 22451*                                                                *ELCRENM1
 22452*                            ELCRENM1                            *   LV002
 22453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22454*                            VMOD=2.001                          *ELCRENM1
 22455*                                                                *ELCRENM1
 22456*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22457*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22458*                                                                *ELCRENM1
 22459******************************************************************ELCRENM1
 22460     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22461     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22462     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22463                                                                  ELCRENM1
 22464
 22465 7000-PRINT-LINE-XIT.
 22466      EXIT.
 22467
 22468 9999-END-JOB.
 22469     CLOSE PRINT-FILE.
*22470             COPY ELCPRTCX.
 22471******************************************************************04/15/98
 22472*                                                                *ELCPRTCX
 22473*                                                                *ELCPRTCX
 22474*                            ELCPRTCX.                           *   LV003
 22475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22476*                            VMOD=2.003                          *   CL**3
 22477*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22478*                                                                *ELCPRTCX
 22479* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22480******************************************************************ELCPRTCX
 22481                                                                  ELCPRTCX
 22482      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22483          CLOSE FICH.                                             ELCPRTCX
 22484                                                                  ELCPRTCX
 22485      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22486          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22487          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22488          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22489          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22490          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22491          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 419
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22492          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22493          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22494              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22495              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22496              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22497                  UPON CONSOLE                                    ELCPRTCX
 22498              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22499                  UPON CONSOLE                                    ELCPRTCX
 22500            ELSE                                                  ELCPRTCX
 22501              DISPLAY '***************************************'   ELCPRTCX
 22502              DISPLAY '***************************************'   ELCPRTCX
 22503              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22504              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22505              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22506              DISPLAY '**                                   **'   ELCPRTCX
 22507              DISPLAY '***************************************'   ELCPRTCX
 22508              DISPLAY '***************************************'   ELCPRTCX
 22509              CLOSE ELREPT.                                       ELCPRTCX
 22510                                                                  ELCPRTCX
 22511      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22512          DISPLAY '***************************************'       ELCPRTCX
 22513          DISPLAY '***************************************'       ELCPRTCX
 22514          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22515          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22516          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22517          DISPLAY '**                                   **'       ELCPRTCX
 22518          DISPLAY '***************************************'       ELCPRTCX
 22519          DISPLAY '***************************************'       ELCPRTCX
 22520          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22521                                                                  ELCPRTCX
 22522      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22523          DISPLAY '***************************************'       ELCPRTCX
 22524          DISPLAY '***************************************'       ELCPRTCX
 22525          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22526          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22527          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22528          DISPLAY '**                                   **'       ELCPRTCX
 22529          DISPLAY '***************************************'       ELCPRTCX
 22530          DISPLAY '***************************************'       ELCPRTCX
 22531          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22532                                                                  ELCPRTCX
 22533                                                                  ELCPRTCX
 22534******************************************************************ELCPRTCX
 22535
 22536     GOBACK.
 22537
 22538 ABEND-PGM.
*                   COPY ELCABEND.
 22539***************************************************************** 04/14/98
 22540*                                                               * ELCABEND
 22541*                            ELCABEND.                          *    LV003
 22542*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22543*                            VMOD 2.002                              CL**2
 22544*                                                               * ELCABEND
 22545*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22546*            AND THEN ABENDS.                                   * ELCABEND
 22547*                                                               * ELCABEND
 22548*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:31 Page 420
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22549*                                                               * ELCABEND
 22550***************************************************************** ELCABEND
 22551*APS-010.                                                         ELCABEND
 22552     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22553     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22554                                                                  ELCABEND
 22555     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22556         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22557         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22558                                 UPON CONSOLE.                    ELCABEND
 22559                                                                  ELCABEND
 22560     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22561         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22562         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22563                                 UPON CONSOLE.                    ELCABEND
 22564                                                                  ELCABEND
 22565     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22566     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22567                                 UPON CONSOLE.                    ELCABEND
 22568                                                                  ELCABEND
 22569     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22570     CALL 'ABORTME'.
 22571                                                                  ELCABEND
 22572 APS-EXIT.                                                        ELCABEND
 22573     EXIT.                                                        ELCABEND
 22574
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116664     Code:       91599
